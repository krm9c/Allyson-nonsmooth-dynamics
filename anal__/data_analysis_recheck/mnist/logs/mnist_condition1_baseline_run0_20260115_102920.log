JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition1_baseline.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: False

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run0
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run0/mnist_condition1_baseline_run0


############################################################
# Run ID: 0
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:19<06:12, 19.61s/it]  5%|▌         | 1/20 [00:24<06:12, 19.61s/it, CE=2.069583e+00 H=2.069169e+00 dV_dx=2.330975e-07 dV_dθ=-4.144679e-04 ||∇||=4.464402e-01 | Tr=0.4060] 10%|█         | 2/20 [00:24<03:18, 11.03s/it, CE=2.069583e+00 H=2.069169e+00 dV_dx=2.330975e-07 dV_dθ=-4.144679e-04 ||∇||=4.464402e-01 | Tr=0.4060] 10%|█         | 2/20 [00:29<03:18, 11.03s/it, CE=1.859556e+00 H=1.858748e+00 dV_dx=2.334996e-07 dV_dθ=-8.080597e-04 ||∇||=6.187098e-01 | Tr=0.4866] 15%|█▌        | 3/20 [00:29<02:20,  8.24s/it, CE=1.859556e+00 H=1.858748e+00 dV_dx=2.334996e-07 dV_dθ=-8.080597e-04 ||∇||=6.187098e-01 | Tr=0.4866] 15%|█▌        | 3/20 [00:34<02:20,  8.24s/it, CE=1.644422e+00 H=1.643374e+00 dV_dx=-2.880049e-07 dV_dθ=-1.047750e-03 ||∇||=7.068960e-01 | Tr=0.5287] 20%|██        | 4/20 [00:34<01:50,  6.94s/it, CE=1.644422e+00 H=1.643374e+00 dV_dx=-2.880049e-07 dV_dθ=-1.047750e-03 ||∇||=7.068960e-01 | Tr=0.5287] 20%|██        | 4/20 [00:39<01:50,  6.94s/it, CE=1.471355e+00 H=1.470347e+00 dV_dx=5.866001e-08 dV_dθ=-1.008203e-03 ||∇||=7.008886e-01 | Tr=0.5577]  25%|██▌       | 5/20 [00:39<01:33,  6.21s/it, CE=1.471355e+00 H=1.470347e+00 dV_dx=5.866001e-08 dV_dθ=-1.008203e-03 ||∇||=7.008886e-01 | Tr=0.5577] 25%|██▌       | 5/20 [00:47<01:33,  6.21s/it, CE=1.341691e+00 H=1.340829e+00 dV_dx=-2.287669e-06 dV_dθ=-8.598968e-04 ||∇||=6.589165e-01 | Tr=0.5825 Te/Cur=0.5870 Te/Exp=0.5805] 30%|███       | 6/20 [00:47<01:34,  6.74s/it, CE=1.341691e+00 H=1.340829e+00 dV_dx=-2.287669e-06 dV_dθ=-8.598968e-04 ||∇||=6.589165e-01 | Tr=0.5825 Te/Cur=0.5870 Te/Exp=0.5805] 30%|███       | 6/20 [00:52<01:34,  6.74s/it, CE=1.244461e+00 H=1.243747e+00 dV_dx=1.245765e-06 dV_dθ=-7.151251e-04 ||∇||=6.141149e-01 | Tr=0.6030]                              35%|███▌      | 7/20 [00:52<01:20,  6.19s/it, CE=1.244461e+00 H=1.243747e+00 dV_dx=1.245765e-06 dV_dθ=-7.151251e-04 ||∇||=6.141149e-01 | Tr=0.6030] 35%|███▌      | 7/20 [00:57<01:20,  6.19s/it, CE=1.170102e+00 H=1.169503e+00 dV_dx=2.341041e-07 dV_dθ=-5.999695e-04 ||∇||=5.768044e-01 | Tr=0.6213] 40%|████      | 8/20 [00:57<01:10,  5.87s/it, CE=1.170102e+00 H=1.169503e+00 dV_dx=2.341041e-07 dV_dθ=-5.999695e-04 ||∇||=5.768044e-01 | Tr=0.6213] 40%|████      | 8/20 [01:02<01:10,  5.87s/it, CE=1.112020e+00 H=1.111504e+00 dV_dx=2.033728e-06 dV_dθ=-5.180820e-04 ||∇||=5.500856e-01 | Tr=0.6374] 45%|████▌     | 9/20 [01:02<01:02,  5.70s/it, CE=1.112020e+00 H=1.111504e+00 dV_dx=2.033728e-06 dV_dθ=-5.180820e-04 ||∇||=5.500856e-01 | Tr=0.6374] 45%|████▌     | 9/20 [01:07<01:02,  5.70s/it, CE=1.063868e+00 H=1.063420e+00 dV_dx=1.061915e-06 dV_dθ=-4.484006e-04 ||∇||=5.276616e-01 | Tr=0.6512] 50%|█████     | 10/20 [01:07<00:55,  5.55s/it, CE=1.063868e+00 H=1.063420e+00 dV_dx=1.061915e-06 dV_dθ=-4.484006e-04 ||∇||=5.276616e-01 | Tr=0.6512] 50%|█████     | 10/20 [01:14<00:55,  5.55s/it, CE=1.023434e+00 H=1.023039e+00 dV_dx=1.221126e-06 dV_dθ=-3.963148e-04 ||∇||=5.113251e-01 | Tr=0.6638 Te/Cur=0.6598 Te/Exp=0.6604] 55%|█████▌    | 11/20 [01:14<00:52,  5.86s/it, CE=1.023434e+00 H=1.023039e+00 dV_dx=1.221126e-06 dV_dθ=-3.963148e-04 ||∇||=5.113251e-01 | Tr=0.6638 Te/Cur=0.6598 Te/Exp=0.6604] 55%|█████▌    | 11/20 [01:19<00:52,  5.86s/it, CE=9.889111e-01 H=9.885450e-01 dV_dx=-1.449966e-06 dV_dθ=-3.646724e-04 ||∇||=5.028322e-01 | Tr=0.6754]                            60%|██████    | 12/20 [01:19<00:45,  5.72s/it, CE=9.889111e-01 H=9.885450e-01 dV_dx=-1.449966e-06 dV_dθ=-3.646724e-04 ||∇||=5.028322e-01 | Tr=0.6754] 60%|██████    | 12/20 [01:24<00:45,  5.72s/it, CE=9.591048e-01 H=9.587604e-01 dV_dx=1.703894e-06 dV_dθ=-3.460337e-04 ||∇||=4.989153e-01 | Tr=0.6846]  65%|██████▌   | 13/20 [01:24<00:37,  5.39s/it, CE=9.591048e-01 H=9.587604e-01 dV_dx=1.703894e-06 dV_dθ=-3.460337e-04 ||∇||=4.989153e-01 | Tr=0.6846] 65%|██████▌   | 13/20 [01:29<00:37,  5.39s/it, CE=9.328408e-01 H=9.325061e-01 dV_dx=-1.135157e-06 dV_dθ=-3.336156e-04 ||∇||=4.972940e-01 | Tr=0.6940] 70%|███████   | 14/20 [01:29<00:31,  5.30s/it, CE=9.328408e-01 H=9.325061e-01 dV_dx=-1.135157e-06 dV_dθ=-3.336156e-04 ||∇||=4.972940e-01 | Tr=0.6940] 70%|███████   | 14/20 [01:34<00:31,  5.30s/it, CE=9.093440e-01 H=9.090108e-01 dV_dx=-2.134545e-07 dV_dθ=-3.330281e-04 ||∇||=5.005577e-01 | Tr=0.7007] 75%|███████▌  | 15/20 [01:34<00:25,  5.18s/it, CE=9.093440e-01 H=9.090108e-01 dV_dx=-2.134545e-07 dV_dθ=-3.330281e-04 ||∇||=5.005577e-01 | Tr=0.7007] 75%|███████▌  | 15/20 [01:41<00:25,  5.18s/it, CE=8.884713e-01 H=8.881469e-01 dV_dx=1.861487e-06 dV_dθ=-3.262189e-04 ||∇||=5.007253e-01 | Tr=0.7071 Te/Cur=0.7061 Te/Exp=0.7058] 80%|████████  | 16/20 [01:41<00:22,  5.66s/it, CE=8.884713e-01 H=8.881469e-01 dV_dx=1.861487e-06 dV_dθ=-3.262189e-04 ||∇||=5.007253e-01 | Tr=0.7071 Te/Cur=0.7061 Te/Exp=0.7058] 80%|████████  | 16/20 [01:46<00:22,  5.66s/it, CE=8.697136e-01 H=8.693852e-01 dV_dx=-3.313121e-07 dV_dθ=-3.280811e-04 ||∇||=5.045425e-01 | Tr=0.7126]                            85%|████████▌ | 17/20 [01:46<00:16,  5.45s/it, CE=8.697136e-01 H=8.693852e-01 dV_dx=-3.313121e-07 dV_dθ=-3.280811e-04 ||∇||=5.045425e-01 | Tr=0.7126] 85%|████████▌ | 17/20 [01:51<00:16,  5.45s/it, CE=8.525842e-01 H=8.522472e-01 dV_dx=-5.231628e-08 dV_dθ=-3.369414e-04 ||∇||=5.113309e-01 | Tr=0.7192] 90%|█████████ | 18/20 [01:51<00:10,  5.32s/it, CE=8.525842e-01 H=8.522472e-01 dV_dx=-5.231628e-08 dV_dθ=-3.369414e-04 ||∇||=5.113309e-01 | Tr=0.7192] 90%|█████████ | 18/20 [01:56<00:10,  5.32s/it, CE=8.368938e-01 H=8.365545e-01 dV_dx=1.954624e-06 dV_dθ=-3.412006e-04 ||∇||=5.154539e-01 | Tr=0.7241]  95%|█████████▌| 19/20 [01:56<00:05,  5.20s/it, CE=8.368938e-01 H=8.365545e-01 dV_dx=1.954624e-06 dV_dθ=-3.412006e-04 ||∇||=5.154539e-01 | Tr=0.7241] 95%|█████████▌| 19/20 [02:02<00:05,  5.20s/it, CE=8.223037e-01 H=8.219529e-01 dV_dx=6.156507e-07 dV_dθ=-3.514213e-04 ||∇||=5.216698e-01 | Tr=0.7288 Te/Cur=0.7282 Te/Exp=0.7293]100%|██████████| 20/20 [02:02<00:00,  5.48s/it, CE=8.223037e-01 H=8.219529e-01 dV_dx=6.156507e-07 dV_dθ=-3.514213e-04 ||∇||=5.216698e-01 | Tr=0.7288 Te/Cur=0.7282 Te/Exp=0.7293]100%|██████████| 20/20 [02:02<00:00,  6.12s/it, CE=8.223037e-01 H=8.219529e-01 dV_dx=6.156507e-07 dV_dθ=-3.514213e-04 ||∇||=5.216698e-01 | Tr=0.7288 Te/Cur=0.7282 Te/Exp=0.7293]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7284

============================================================
Task 1
============================================================
Initial loss on new task: 6.1728, previous: 0.8223, ratio: 7.51
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.51)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:00,  9.51s/it]  5%|▌         | 1/20 [00:14<03:00,  9.51s/it, CE=8.640435e-01 H=8.637130e-01 dV_dx=-4.233796e-06 dV_dθ=-3.261948e-04 ||∇||=7.430376e-01 | Tr=0.7810] 10%|█         | 2/20 [00:14<02:06,  7.01s/it, CE=8.640435e-01 H=8.637130e-01 dV_dx=-4.233796e-06 dV_dθ=-3.261948e-04 ||∇||=7.430376e-01 | Tr=0.7810] 10%|█         | 2/20 [00:19<02:06,  7.01s/it, CE=8.490324e-01 H=8.488605e-01 dV_dx=-2.830384e-05 dV_dθ=-1.435755e-04 ||∇||=5.788691e-01 | Tr=0.8304] 15%|█▌        | 3/20 [00:19<01:43,  6.11s/it, CE=8.490324e-01 H=8.488605e-01 dV_dx=-2.830384e-05 dV_dθ=-1.435755e-04 ||∇||=5.788691e-01 | Tr=0.8304] 15%|█▌        | 3/20 [00:24<01:43,  6.11s/it, CE=8.388711e-01 H=8.387016e-01 dV_dx=-5.553147e-05 dV_dθ=-1.139894e-04 ||∇||=5.329656e-01 | Tr=0.8552] 20%|██        | 4/20 [00:24<01:30,  5.64s/it, CE=8.388711e-01 H=8.387016e-01 dV_dx=-5.553147e-05 dV_dθ=-1.139894e-04 ||∇||=5.329656e-01 | Tr=0.8552] 20%|██        | 4/20 [00:29<01:30,  5.64s/it, CE=8.290251e-01 H=8.289282e-01 dV_dx=2.066984e-06 dV_dθ=-9.901388e-05 ||∇||=5.073127e-01 | Tr=0.8698]  25%|██▌       | 5/20 [00:29<01:20,  5.39s/it, CE=8.290251e-01 H=8.289282e-01 dV_dx=2.066984e-06 dV_dθ=-9.901388e-05 ||∇||=5.073127e-01 | Tr=0.8698] 25%|██▌       | 5/20 [00:36<01:20,  5.39s/it, CE=8.199249e-01 H=8.197941e-01 dV_dx=-4.154571e-05 dV_dθ=-8.919838e-05 ||∇||=4.891076e-01 | Tr=0.8796 Te/Cur=0.8819 Te/Exp=0.7304] 30%|███       | 6/20 [00:36<01:21,  5.82s/it, CE=8.199249e-01 H=8.197941e-01 dV_dx=-4.154571e-05 dV_dθ=-8.919838e-05 ||∇||=4.891076e-01 | Tr=0.8796 Te/Cur=0.8819 Te/Exp=0.7304] 30%|███       | 6/20 [00:41<01:21,  5.82s/it, CE=8.123963e-01 H=8.123041e-01 dV_dx=-8.271546e-06 dV_dθ=-8.400230e-05 ||∇||=4.774522e-01 | Tr=0.8864]                             35%|███▌      | 7/20 [00:41<01:12,  5.61s/it, CE=8.123963e-01 H=8.123041e-01 dV_dx=-8.271546e-06 dV_dθ=-8.400230e-05 ||∇||=4.774522e-01 | Tr=0.8864] 35%|███▌      | 7/20 [00:46<01:12,  5.61s/it, CE=8.052801e-01 H=8.052615e-01 dV_dx=6.157974e-05 dV_dθ=-8.013194e-05 ||∇||=4.692507e-01 | Tr=0.8925]  40%|████      | 8/20 [00:46<01:06,  5.52s/it, CE=8.052801e-01 H=8.052615e-01 dV_dx=6.157974e-05 dV_dθ=-8.013194e-05 ||∇||=4.692507e-01 | Tr=0.8925] 40%|████      | 8/20 [00:52<01:06,  5.52s/it, CE=7.988425e-01 H=7.988283e-01 dV_dx=6.155904e-05 dV_dθ=-7.580374e-05 ||∇||=4.616376e-01 | Tr=0.8974] 45%|████▌     | 9/20 [00:52<01:00,  5.46s/it, CE=7.988425e-01 H=7.988283e-01 dV_dx=6.155904e-05 dV_dθ=-7.580374e-05 ||∇||=4.616376e-01 | Tr=0.8974] 45%|████▌     | 9/20 [00:57<01:00,  5.46s/it, CE=7.928253e-01 H=7.927479e-01 dV_dx=-5.540735e-06 dV_dθ=-7.190103e-05 ||∇||=4.549643e-01 | Tr=0.9010] 50%|█████     | 10/20 [00:57<00:53,  5.34s/it, CE=7.928253e-01 H=7.927479e-01 dV_dx=-5.540735e-06 dV_dθ=-7.190103e-05 ||∇||=4.549643e-01 | Tr=0.9010] 50%|█████     | 10/20 [01:03<00:53,  5.34s/it, CE=7.871807e-01 H=7.870703e-01 dV_dx=-4.011504e-05 dV_dθ=-7.019649e-05 ||∇||=4.501076e-01 | Tr=0.9046 Te/Cur=0.9048 Te/Exp=0.7400] 55%|█████▌    | 11/20 [01:03<00:51,  5.72s/it, CE=7.871807e-01 H=7.870703e-01 dV_dx=-4.011504e-05 dV_dθ=-7.019649e-05 ||∇||=4.501076e-01 | Tr=0.9046 Te/Cur=0.9048 Te/Exp=0.7400] 55%|█████▌    | 11/20 [01:08<00:51,  5.72s/it, CE=7.817755e-01 H=7.817011e-01 dV_dx=-4.579885e-06 dV_dθ=-6.983604e-05 ||∇||=4.467118e-01 | Tr=0.9082]                             60%|██████    | 12/20 [01:08<00:43,  5.45s/it, CE=7.817755e-01 H=7.817011e-01 dV_dx=-4.579885e-06 dV_dθ=-6.983604e-05 ||∇||=4.467118e-01 | Tr=0.9082] 60%|██████    | 12/20 [01:13<00:43,  5.45s/it, CE=7.765451e-01 H=7.764755e-01 dV_dx=2.555257e-06 dV_dθ=-7.221072e-05 ||∇||=4.448422e-01 | Tr=0.9113]  65%|██████▌   | 13/20 [01:13<00:37,  5.32s/it, CE=7.765451e-01 H=7.764755e-01 dV_dx=2.555257e-06 dV_dθ=-7.221072e-05 ||∇||=4.448422e-01 | Tr=0.9113] 65%|██████▌   | 13/20 [01:18<00:37,  5.32s/it, CE=7.714136e-01 H=7.713518e-01 dV_dx=1.065281e-05 dV_dθ=-7.244462e-05 ||∇||=4.428625e-01 | Tr=0.9138] 70%|███████   | 14/20 [01:18<00:31,  5.17s/it, CE=7.714136e-01 H=7.713518e-01 dV_dx=1.065281e-05 dV_dθ=-7.244462e-05 ||∇||=4.428625e-01 | Tr=0.9138] 70%|███████   | 14/20 [01:23<00:31,  5.17s/it, CE=7.664723e-01 H=7.663499e-01 dV_dx=-5.025017e-05 dV_dθ=-7.218142e-05 ||∇||=4.405611e-01 | Tr=0.9162] 75%|███████▌  | 15/20 [01:23<00:25,  5.04s/it, CE=7.664723e-01 H=7.663499e-01 dV_dx=-5.025017e-05 dV_dθ=-7.218142e-05 ||∇||=4.405611e-01 | Tr=0.9162] 75%|███████▌  | 15/20 [01:30<00:25,  5.04s/it, CE=7.616566e-01 H=7.615985e-01 dV_dx=1.453517e-05 dV_dθ=-7.256358e-05 ||∇||=4.387604e-01 | Tr=0.9187 Te/Cur=0.9186 Te/Exp=0.7458] 80%|████████  | 16/20 [01:30<00:22,  5.59s/it, CE=7.616566e-01 H=7.615985e-01 dV_dx=1.453517e-05 dV_dθ=-7.256358e-05 ||∇||=4.387604e-01 | Tr=0.9187 Te/Cur=0.9186 Te/Exp=0.7458] 80%|████████  | 16/20 [01:35<00:22,  5.59s/it, CE=7.569304e-01 H=7.568265e-01 dV_dx=-2.962825e-05 dV_dθ=-7.432994e-05 ||∇||=4.381591e-01 | Tr=0.9211]                            85%|████████▌ | 17/20 [01:35<00:16,  5.45s/it, CE=7.569304e-01 H=7.568265e-01 dV_dx=-2.962825e-05 dV_dθ=-7.432994e-05 ||∇||=4.381591e-01 | Tr=0.9211] 85%|████████▌ | 17/20 [01:40<00:16,  5.45s/it, CE=7.522969e-01 H=7.522374e-01 dV_dx=1.645319e-05 dV_dθ=-7.595605e-05 ||∇||=4.377296e-01 | Tr=0.9234]  90%|█████████ | 18/20 [01:40<00:10,  5.28s/it, CE=7.522969e-01 H=7.522374e-01 dV_dx=1.645319e-05 dV_dθ=-7.595605e-05 ||∇||=4.377296e-01 | Tr=0.9234] 90%|█████████ | 18/20 [01:45<00:10,  5.28s/it, CE=7.476221e-01 H=7.475857e-01 dV_dx=4.186493e-05 dV_dθ=-7.822152e-05 ||∇||=4.376753e-01 | Tr=0.9254] 95%|█████████▌| 19/20 [01:45<00:05,  5.21s/it, CE=7.476221e-01 H=7.475857e-01 dV_dx=4.186493e-05 dV_dθ=-7.822152e-05 ||∇||=4.376753e-01 | Tr=0.9254] 95%|█████████▌| 19/20 [01:51<00:05,  5.21s/it, CE=7.430304e-01 H=7.429628e-01 dV_dx=1.238219e-05 dV_dθ=-8.001117e-05 ||∇||=4.377274e-01 | Tr=0.9271 Te/Cur=0.9239 Te/Exp=0.7517]100%|██████████| 20/20 [01:51<00:00,  5.52s/it, CE=7.430304e-01 H=7.429628e-01 dV_dx=1.238219e-05 dV_dθ=-8.001117e-05 ||∇||=4.377274e-01 | Tr=0.9271 Te/Cur=0.9239 Te/Exp=0.7517]100%|██████████| 20/20 [01:51<00:00,  5.57s/it, CE=7.430304e-01 H=7.429628e-01 dV_dx=1.238219e-05 dV_dθ=-8.001117e-05 ||∇||=4.377274e-01 | Tr=0.9271 Te/Cur=0.9239 Te/Exp=0.7517]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.7524
    Task 1: 0.9250

============================================================
Task 2
============================================================
Initial loss on new task: 4.6588, previous: 0.7430, ratio: 6.27
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=6.27)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:09,  9.99s/it]  5%|▌         | 1/20 [00:14<03:09,  9.99s/it, CE=6.727145e-01 H=6.745734e-01 dV_dx=-7.147761e-06 dV_dθ=1.866054e-03 ||∇||=7.425311e-01 | Tr=0.6322] 10%|█         | 2/20 [00:14<02:05,  6.99s/it, CE=6.727145e-01 H=6.745734e-01 dV_dx=-7.147761e-06 dV_dθ=1.866054e-03 ||∇||=7.425311e-01 | Tr=0.6322] 10%|█         | 2/20 [00:19<02:05,  6.99s/it, CE=6.318797e-01 H=6.329816e-01 dV_dx=-5.321945e-06 dV_dθ=1.107228e-03 ||∇||=6.748123e-01 | Tr=0.6824] 15%|█▌        | 3/20 [00:19<01:38,  5.82s/it, CE=6.318797e-01 H=6.329816e-01 dV_dx=-5.321945e-06 dV_dθ=1.107228e-03 ||∇||=6.748123e-01 | Tr=0.6824] 15%|█▌        | 3/20 [00:24<01:38,  5.82s/it, CE=6.060705e-01 H=6.067383e-01 dV_dx=-3.095819e-05 dV_dθ=6.988052e-04 ||∇||=6.443797e-01 | Tr=0.7110] 20%|██        | 4/20 [00:24<01:28,  5.52s/it, CE=6.060705e-01 H=6.067383e-01 dV_dx=-3.095819e-05 dV_dθ=6.988052e-04 ||∇||=6.443797e-01 | Tr=0.7110] 20%|██        | 4/20 [00:29<01:28,  5.52s/it, CE=5.905305e-01 H=5.910117e-01 dV_dx=-6.661631e-06 dV_dθ=4.879051e-04 ||∇||=6.270910e-01 | Tr=0.7320] 25%|██▌       | 5/20 [00:29<01:19,  5.31s/it, CE=5.905305e-01 H=5.910117e-01 dV_dx=-6.661631e-06 dV_dθ=4.879051e-04 ||∇||=6.270910e-01 | Tr=0.7320] 25%|██▌       | 5/20 [00:35<01:19,  5.31s/it, CE=5.800181e-01 H=5.803813e-01 dV_dx=4.131082e-06 dV_dθ=3.590139e-04 ||∇||=6.115598e-01 | Tr=0.7478 Te/Cur=0.7543 Te/Exp=0.8115] 30%|███       | 6/20 [00:35<01:20,  5.75s/it, CE=5.800181e-01 H=5.803813e-01 dV_dx=4.131082e-06 dV_dθ=3.590139e-04 ||∇||=6.115598e-01 | Tr=0.7478 Te/Cur=0.7543 Te/Exp=0.8115] 30%|███       | 6/20 [00:40<01:20,  5.75s/it, CE=5.713578e-01 H=5.716370e-01 dV_dx=7.305366e-06 dV_dθ=2.718624e-04 ||∇||=6.042408e-01 | Tr=0.7601]                             35%|███▌      | 7/20 [00:40<01:11,  5.53s/it, CE=5.713578e-01 H=5.716370e-01 dV_dx=7.305366e-06 dV_dθ=2.718624e-04 ||∇||=6.042408e-01 | Tr=0.7601] 35%|███▌      | 7/20 [00:46<01:11,  5.53s/it, CE=5.640463e-01 H=5.643018e-01 dV_dx=4.859120e-05 dV_dθ=2.068604e-04 ||∇||=5.994023e-01 | Tr=0.7692] 40%|████      | 8/20 [00:46<01:04,  5.37s/it, CE=5.640463e-01 H=5.643018e-01 dV_dx=4.859120e-05 dV_dθ=2.068604e-04 ||∇||=5.994023e-01 | Tr=0.7692] 40%|████      | 8/20 [00:50<01:04,  5.37s/it, CE=5.579295e-01 H=5.580509e-01 dV_dx=-3.116606e-05 dV_dθ=1.525812e-04 ||∇||=5.980494e-01 | Tr=0.7779] 45%|████▌     | 9/20 [00:50<00:55,  5.06s/it, CE=5.579295e-01 H=5.580509e-01 dV_dx=-3.116606e-05 dV_dθ=1.525812e-04 ||∇||=5.980494e-01 | Tr=0.7779] 45%|████▌     | 9/20 [00:55<00:55,  5.06s/it, CE=5.527659e-01 H=5.528644e-01 dV_dx=-1.641614e-05 dV_dθ=1.149531e-04 ||∇||=5.979063e-01 | Tr=0.7845] 50%|█████     | 10/20 [00:55<00:51,  5.13s/it, CE=5.527659e-01 H=5.528644e-01 dV_dx=-1.641614e-05 dV_dθ=1.149531e-04 ||∇||=5.979063e-01 | Tr=0.7845] 50%|█████     | 10/20 [01:02<00:51,  5.13s/it, CE=5.480438e-01 H=5.481651e-01 dV_dx=3.659432e-05 dV_dθ=8.470121e-05 ||∇||=5.934319e-01 | Tr=0.7910 Te/Cur=0.7897 Te/Exp=0.8143] 55%|█████▌    | 11/20 [01:02<00:50,  5.60s/it, CE=5.480438e-01 H=5.481651e-01 dV_dx=3.659432e-05 dV_dθ=8.470121e-05 ||∇||=5.934319e-01 | Tr=0.7910 Te/Cur=0.7897 Te/Exp=0.8143] 55%|█████▌    | 11/20 [01:07<00:50,  5.60s/it, CE=5.433901e-01 H=5.434648e-01 dV_dx=1.977825e-05 dV_dθ=5.500965e-05 ||∇||=5.921227e-01 | Tr=0.7967]                             60%|██████    | 12/20 [01:07<00:42,  5.33s/it, CE=5.433901e-01 H=5.434648e-01 dV_dx=1.977825e-05 dV_dθ=5.500965e-05 ||∇||=5.921227e-01 | Tr=0.7967] 60%|██████    | 12/20 [01:11<00:42,  5.33s/it, CE=5.388595e-01 H=5.388905e-01 dV_dx=-3.170734e-06 dV_dθ=3.410745e-05 ||∇||=5.900166e-01 | Tr=0.8019] 65%|██████▌   | 13/20 [01:11<00:36,  5.17s/it, CE=5.388595e-01 H=5.388905e-01 dV_dx=-3.170734e-06 dV_dθ=3.410745e-05 ||∇||=5.900166e-01 | Tr=0.8019] 65%|██████▌   | 13/20 [01:16<00:36,  5.17s/it, CE=5.344046e-01 H=5.343963e-01 dV_dx=-2.629915e-05 dV_dθ=1.807889e-05 ||∇||=5.885221e-01 | Tr=0.8056] 70%|███████   | 14/20 [01:16<00:30,  5.11s/it, CE=5.344046e-01 H=5.343963e-01 dV_dx=-2.629915e-05 dV_dθ=1.807889e-05 ||∇||=5.885221e-01 | Tr=0.8056] 70%|███████   | 14/20 [01:21<00:30,  5.11s/it, CE=5.300079e-01 H=5.300277e-01 dV_dx=1.378247e-05 dV_dθ=5.981242e-06 ||∇||=5.868190e-01 | Tr=0.8094]  75%|███████▌  | 15/20 [01:21<00:25,  5.06s/it, CE=5.300079e-01 H=5.300277e-01 dV_dx=1.378247e-05 dV_dθ=5.981242e-06 ||∇||=5.868190e-01 | Tr=0.8094] 75%|███████▌  | 15/20 [01:28<00:25,  5.06s/it, CE=5.259424e-01 H=5.258896e-01 dV_dx=-5.068997e-05 dV_dθ=-2.154698e-06 ||∇||=5.853342e-01 | Tr=0.8139 Te/Cur=0.8104 Te/Exp=0.8255] 80%|████████  | 16/20 [01:28<00:22,  5.69s/it, CE=5.259424e-01 H=5.258896e-01 dV_dx=-5.068997e-05 dV_dθ=-2.154698e-06 ||∇||=5.853342e-01 | Tr=0.8139 Te/Cur=0.8104 Te/Exp=0.8255] 80%|████████  | 16/20 [01:33<00:22,  5.69s/it, CE=5.222031e-01 H=5.222343e-01 dV_dx=3.927319e-05 dV_dθ=-8.098970e-06 ||∇||=5.846737e-01 | Tr=0.8178]                              85%|████████▌ | 17/20 [01:33<00:16,  5.44s/it, CE=5.222031e-01 H=5.222343e-01 dV_dx=3.927319e-05 dV_dθ=-8.098970e-06 ||∇||=5.846737e-01 | Tr=0.8178] 85%|████████▌ | 17/20 [01:38<00:16,  5.44s/it, CE=5.185584e-01 H=5.185498e-01 dV_dx=5.503704e-06 dV_dθ=-1.415874e-05 ||∇||=5.846218e-01 | Tr=0.8209] 90%|█████████ | 18/20 [01:38<00:10,  5.37s/it, CE=5.185584e-01 H=5.185498e-01 dV_dx=5.503704e-06 dV_dθ=-1.415874e-05 ||∇||=5.846218e-01 | Tr=0.8209] 90%|█████████ | 18/20 [01:43<00:10,  5.37s/it, CE=5.150083e-01 H=5.150378e-01 dV_dx=4.827409e-05 dV_dθ=-1.867778e-05 ||∇||=5.850391e-01 | Tr=0.8242] 95%|█████████▌| 19/20 [01:43<00:05,  5.07s/it, CE=5.150083e-01 H=5.150378e-01 dV_dx=4.827409e-05 dV_dθ=-1.867778e-05 ||∇||=5.850391e-01 | Tr=0.8242] 95%|█████████▌| 19/20 [01:50<00:05,  5.07s/it, CE=5.114557e-01 H=5.114066e-01 dV_dx=-2.584880e-05 dV_dθ=-2.323658e-05 ||∇||=5.858190e-01 | Tr=0.8272 Te/Cur=0.8228 Te/Exp=0.8305]100%|██████████| 20/20 [01:50<00:00,  5.62s/it, CE=5.114557e-01 H=5.114066e-01 dV_dx=-2.584880e-05 dV_dθ=-2.323658e-05 ||∇||=5.858190e-01 | Tr=0.8272 Te/Cur=0.8228 Te/Exp=0.8305]100%|██████████| 20/20 [01:50<00:00,  5.51s/it, CE=5.114557e-01 H=5.114066e-01 dV_dx=-2.584880e-05 dV_dθ=-2.323658e-05 ||∇||=5.858190e-01 | Tr=0.8272 Te/Cur=0.8228 Te/Exp=0.8305]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.7254
    Task 1: 0.9291
    Task 2: 0.8209

============================================================
Task 3
============================================================
Initial loss on new task: 4.2019, previous: 0.5115, ratio: 8.22
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=8.22)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:41, 11.66s/it]  5%|▌         | 1/20 [00:16<03:41, 11.66s/it, CE=5.804965e-01 H=5.804941e-01 dV_dx=-1.898440e-05 dV_dθ=1.656363e-05 ||∇||=7.675523e-01 | Tr=0.4269] 10%|█         | 2/20 [00:16<02:21,  7.86s/it, CE=5.804965e-01 H=5.804941e-01 dV_dx=-1.898440e-05 dV_dθ=1.656363e-05 ||∇||=7.675523e-01 | Tr=0.4269] 10%|█         | 2/20 [00:21<02:21,  7.86s/it, CE=5.648223e-01 H=5.647369e-01 dV_dx=1.024992e-05 dV_dθ=-9.567589e-05 ||∇||=6.727975e-01 | Tr=0.4660] 15%|█▌        | 3/20 [00:21<01:47,  6.30s/it, CE=5.648223e-01 H=5.647369e-01 dV_dx=1.024992e-05 dV_dθ=-9.567589e-05 ||∇||=6.727975e-01 | Tr=0.4660] 15%|█▌        | 3/20 [00:25<01:47,  6.30s/it, CE=5.560908e-01 H=5.559391e-01 dV_dx=-2.824226e-06 dV_dθ=-1.488669e-04 ||∇||=6.535661e-01 | Tr=0.4859] 20%|██        | 4/20 [00:25<01:29,  5.57s/it, CE=5.560908e-01 H=5.559391e-01 dV_dx=-2.824226e-06 dV_dθ=-1.488669e-04 ||∇||=6.535661e-01 | Tr=0.4859] 20%|██        | 4/20 [00:30<01:29,  5.57s/it, CE=5.491179e-01 H=5.489605e-01 dV_dx=2.857960e-05 dV_dθ=-1.859968e-04 ||∇||=6.550657e-01 | Tr=0.4989]  25%|██▌       | 5/20 [00:30<01:20,  5.36s/it, CE=5.491179e-01 H=5.489605e-01 dV_dx=2.857960e-05 dV_dθ=-1.859968e-04 ||∇||=6.550657e-01 | Tr=0.4989] 25%|██▌       | 5/20 [00:37<01:20,  5.36s/it, CE=5.436281e-01 H=5.434401e-01 dV_dx=1.257018e-05 dV_dθ=-2.005619e-04 ||∇||=6.503961e-01 | Tr=0.5080 Te/Cur=0.5113 Te/Exp=0.8215] 30%|███       | 6/20 [00:37<01:23,  5.97s/it, CE=5.436281e-01 H=5.434401e-01 dV_dx=1.257018e-05 dV_dθ=-2.005619e-04 ||∇||=6.503961e-01 | Tr=0.5080 Te/Cur=0.5113 Te/Exp=0.8215] 30%|███       | 6/20 [00:43<01:23,  5.97s/it, CE=5.393163e-01 H=5.390694e-01 dV_dx=-2.698885e-05 dV_dθ=-2.199032e-04 ||∇||=6.542691e-01 | Tr=0.5152]                            35%|███▌      | 7/20 [00:43<01:14,  5.71s/it, CE=5.393163e-01 H=5.390694e-01 dV_dx=-2.698885e-05 dV_dθ=-2.199032e-04 ||∇||=6.542691e-01 | Tr=0.5152] 35%|███▌      | 7/20 [00:48<01:14,  5.71s/it, CE=5.355961e-01 H=5.353248e-01 dV_dx=-3.318768e-05 dV_dθ=-2.381768e-04 ||∇||=6.575921e-01 | Tr=0.5210] 40%|████      | 8/20 [00:48<01:06,  5.52s/it, CE=5.355961e-01 H=5.353248e-01 dV_dx=-3.318768e-05 dV_dθ=-2.381768e-04 ||∇||=6.575921e-01 | Tr=0.5210] 40%|████      | 8/20 [00:53<01:06,  5.52s/it, CE=5.321302e-01 H=5.318231e-01 dV_dx=-4.961146e-05 dV_dθ=-2.574782e-04 ||∇||=6.636847e-01 | Tr=0.5269] 45%|████▌     | 9/20 [00:53<00:59,  5.40s/it, CE=5.321302e-01 H=5.318231e-01 dV_dx=-4.961146e-05 dV_dθ=-2.574782e-04 ||∇||=6.636847e-01 | Tr=0.5269] 45%|████▌     | 9/20 [00:58<00:59,  5.40s/it, CE=5.287200e-01 H=5.284629e-01 dV_dx=1.532528e-05 dV_dθ=-2.724353e-04 ||∇||=6.683112e-01 | Tr=0.5326]  50%|█████     | 10/20 [00:58<00:52,  5.28s/it, CE=5.287200e-01 H=5.284629e-01 dV_dx=1.532528e-05 dV_dθ=-2.724353e-04 ||∇||=6.683112e-01 | Tr=0.5326] 50%|█████     | 10/20 [01:05<00:52,  5.28s/it, CE=5.254866e-01 H=5.252153e-01 dV_dx=1.685997e-05 dV_dθ=-2.882123e-04 ||∇||=6.732867e-01 | Tr=0.5374 Te/Cur=0.5394 Te/Exp=0.8233] 55%|█████▌    | 11/20 [01:05<00:52,  5.82s/it, CE=5.254866e-01 H=5.252153e-01 dV_dx=1.685997e-05 dV_dθ=-2.882123e-04 ||∇||=6.732867e-01 | Tr=0.5374 Te/Cur=0.5394 Te/Exp=0.8233] 55%|█████▌    | 11/20 [01:10<00:52,  5.82s/it, CE=5.224023e-01 H=5.220972e-01 dV_dx=-5.748990e-06 dV_dθ=-2.992965e-04 ||∇||=6.777320e-01 | Tr=0.5416]                            60%|██████    | 12/20 [01:10<00:45,  5.68s/it, CE=5.224023e-01 H=5.220972e-01 dV_dx=-5.748990e-06 dV_dθ=-2.992965e-04 ||∇||=6.777320e-01 | Tr=0.5416] 60%|██████    | 12/20 [01:15<00:45,  5.68s/it, CE=5.193575e-01 H=5.190652e-01 dV_dx=1.647708e-05 dV_dθ=-3.087257e-04 ||∇||=6.809843e-01 | Tr=0.5449]  65%|██████▌   | 13/20 [01:15<00:38,  5.48s/it, CE=5.193575e-01 H=5.190652e-01 dV_dx=1.647708e-05 dV_dθ=-3.087257e-04 ||∇||=6.809843e-01 | Tr=0.5449] 65%|██████▌   | 13/20 [01:20<00:38,  5.48s/it, CE=5.163837e-01 H=5.160174e-01 dV_dx=-4.601584e-05 dV_dθ=-3.203213e-04 ||∇||=6.854410e-01 | Tr=0.5477] 70%|███████   | 14/20 [01:20<00:32,  5.37s/it, CE=5.163837e-01 H=5.160174e-01 dV_dx=-4.601584e-05 dV_dθ=-3.203213e-04 ||∇||=6.854410e-01 | Tr=0.5477] 70%|███████   | 14/20 [01:25<00:32,  5.37s/it, CE=5.134959e-01 H=5.131650e-01 dV_dx=1.371865e-07 dV_dθ=-3.310821e-04 ||∇||=6.903227e-01 | Tr=0.5507]  75%|███████▌  | 15/20 [01:25<00:26,  5.25s/it, CE=5.134959e-01 H=5.131650e-01 dV_dx=1.371865e-07 dV_dθ=-3.310821e-04 ||∇||=6.903227e-01 | Tr=0.5507] 75%|███████▌  | 15/20 [01:32<00:26,  5.25s/it, CE=5.106141e-01 H=5.102636e-01 dV_dx=-1.075429e-05 dV_dθ=-3.397791e-04 ||∇||=6.943786e-01 | Tr=0.5532 Te/Cur=0.5522 Te/Exp=0.8276] 80%|████████  | 16/20 [01:32<00:22,  5.74s/it, CE=5.106141e-01 H=5.102636e-01 dV_dx=-1.075429e-05 dV_dθ=-3.397791e-04 ||∇||=6.943786e-01 | Tr=0.5532 Te/Cur=0.5522 Te/Exp=0.8276] 80%|████████  | 16/20 [01:38<00:22,  5.74s/it, CE=5.077847e-01 H=5.074684e-01 dV_dx=3.014393e-05 dV_dθ=-3.464743e-04 ||∇||=6.973576e-01 | Tr=0.5552]                              85%|████████▌ | 17/20 [01:38<00:16,  5.63s/it, CE=5.077847e-01 H=5.074684e-01 dV_dx=3.014393e-05 dV_dθ=-3.464743e-04 ||∇||=6.973576e-01 | Tr=0.5552] 85%|████████▌ | 17/20 [01:43<00:16,  5.63s/it, CE=5.050177e-01 H=5.046767e-01 dV_dx=1.738752e-05 dV_dθ=-3.584053e-04 ||∇||=7.030948e-01 | Tr=0.5572] 90%|█████████ | 18/20 [01:43<00:11,  5.53s/it, CE=5.050177e-01 H=5.046767e-01 dV_dx=1.738752e-05 dV_dθ=-3.584053e-04 ||∇||=7.030948e-01 | Tr=0.5572] 90%|█████████ | 18/20 [01:47<00:11,  5.53s/it, CE=5.023857e-01 H=5.020407e-01 dV_dx=2.568880e-05 dV_dθ=-3.706675e-04 ||∇||=7.088912e-01 | Tr=0.5586] 95%|█████████▌| 19/20 [01:47<00:05,  5.22s/it, CE=5.023857e-01 H=5.020407e-01 dV_dx=2.568880e-05 dV_dθ=-3.706675e-04 ||∇||=7.088912e-01 | Tr=0.5586] 95%|█████████▌| 19/20 [01:54<00:05,  5.22s/it, CE=4.998490e-01 H=4.994499e-01 dV_dx=-2.574792e-05 dV_dθ=-3.734012e-04 ||∇||=7.102794e-01 | Tr=0.5602 Te/Cur=0.5604 Te/Exp=0.8317]100%|██████████| 20/20 [01:54<00:00,  5.62s/it, CE=4.998490e-01 H=4.994499e-01 dV_dx=-2.574792e-05 dV_dθ=-3.734012e-04 ||∇||=7.102794e-01 | Tr=0.5602 Te/Cur=0.5604 Te/Exp=0.8317]100%|██████████| 20/20 [01:54<00:00,  5.72s/it, CE=4.998490e-01 H=4.994499e-01 dV_dx=-2.574792e-05 dV_dθ=-3.734012e-04 ||∇||=7.102794e-01 | Tr=0.5602 Te/Cur=0.5604 Te/Exp=0.8317]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.7354
    Task 1: 0.9337
    Task 2: 0.8209
    Task 3: 0.5600

============================================================
Task 4
============================================================
Initial loss on new task: 1.2388, previous: 0.4998, ratio: 2.48
Standard CL training (lr=0.000100, adaptive_lr_min=6.56e-05, loss_ratio=2.48)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:52, 12.25s/it]  5%|▌         | 1/20 [00:17<03:52, 12.25s/it, CE=7.309365e-01 H=7.308361e-01 dV_dx=6.014470e-05 dV_dθ=-1.605869e-04 ||∇||=6.417506e-01 | Tr=0.9051] 10%|█         | 2/20 [00:17<02:24,  8.05s/it, CE=7.309365e-01 H=7.308361e-01 dV_dx=6.014470e-05 dV_dθ=-1.605869e-04 ||∇||=6.417506e-01 | Tr=0.9051] 10%|█         | 2/20 [00:21<02:24,  8.05s/it, CE=7.207873e-01 H=7.206800e-01 dV_dx=2.623546e-05 dV_dθ=-1.335503e-04 ||∇||=5.850849e-01 | Tr=0.9161] 15%|█▌        | 3/20 [00:21<01:50,  6.49s/it, CE=7.207873e-01 H=7.206800e-01 dV_dx=2.623546e-05 dV_dθ=-1.335503e-04 ||∇||=5.850849e-01 | Tr=0.9161] 15%|█▌        | 3/20 [00:26<01:50,  6.49s/it, CE=7.143958e-01 H=7.143483e-01 dV_dx=8.268574e-05 dV_dθ=-1.301106e-04 ||∇||=5.589904e-01 | Tr=0.9225] 20%|██        | 4/20 [00:26<01:31,  5.72s/it, CE=7.143958e-01 H=7.143483e-01 dV_dx=8.268574e-05 dV_dθ=-1.301106e-04 ||∇||=5.589904e-01 | Tr=0.9225] 20%|██        | 4/20 [00:31<01:31,  5.72s/it, CE=7.087163e-01 H=7.085211e-01 dV_dx=-8.214228e-05 dV_dθ=-1.130465e-04 ||∇||=5.343057e-01 | Tr=0.9278] 25%|██▌       | 5/20 [00:31<01:20,  5.36s/it, CE=7.087163e-01 H=7.085211e-01 dV_dx=-8.214228e-05 dV_dθ=-1.130465e-04 ||∇||=5.343057e-01 | Tr=0.9278] 25%|██▌       | 5/20 [00:37<01:20,  5.36s/it, CE=7.037935e-01 H=7.036320e-01 dV_dx=-5.352554e-05 dV_dθ=-1.079692e-04 ||∇||=5.207289e-01 | Tr=0.9315 Te/Cur=0.9314 Te/Exp=0.7531] 30%|███       | 6/20 [00:37<01:21,  5.79s/it, CE=7.037935e-01 H=7.036320e-01 dV_dx=-5.352554e-05 dV_dθ=-1.079692e-04 ||∇||=5.207289e-01 | Tr=0.9315 Te/Cur=0.9314 Te/Exp=0.7531] 30%|███       | 6/20 [00:42<01:21,  5.79s/it, CE=6.994574e-01 H=6.994035e-01 dV_dx=4.830328e-05 dV_dθ=-1.021343e-04 ||∇||=5.096822e-01 | Tr=0.9344]                              35%|███▌      | 7/20 [00:42<01:12,  5.56s/it, CE=6.994574e-01 H=6.994035e-01 dV_dx=4.830328e-05 dV_dθ=-1.021343e-04 ||∇||=5.096822e-01 | Tr=0.9344] 35%|███▌      | 7/20 [00:47<01:12,  5.56s/it, CE=6.953674e-01 H=6.952944e-01 dV_dx=2.404244e-05 dV_dθ=-9.704941e-05 ||∇||=5.004485e-01 | Tr=0.9371] 40%|████      | 8/20 [00:47<01:04,  5.34s/it, CE=6.953674e-01 H=6.952944e-01 dV_dx=2.404244e-05 dV_dθ=-9.704941e-05 ||∇||=5.004485e-01 | Tr=0.9371] 40%|████      | 8/20 [00:52<01:04,  5.34s/it, CE=6.916389e-01 H=6.915922e-01 dV_dx=4.937736e-05 dV_dθ=-9.603194e-05 ||∇||=4.941267e-01 | Tr=0.9395] 45%|████▌     | 9/20 [00:52<00:58,  5.27s/it, CE=6.916389e-01 H=6.915922e-01 dV_dx=4.937736e-05 dV_dθ=-9.603194e-05 ||∇||=4.941267e-01 | Tr=0.9395] 45%|████▌     | 9/20 [00:57<00:58,  5.27s/it, CE=6.881167e-01 H=6.880282e-01 dV_dx=4.013295e-06 dV_dθ=-9.256017e-05 ||∇||=4.866249e-01 | Tr=0.9416] 50%|█████     | 10/20 [00:57<00:50,  5.04s/it, CE=6.881167e-01 H=6.880282e-01 dV_dx=4.013295e-06 dV_dθ=-9.256017e-05 ||∇||=4.866249e-01 | Tr=0.9416] 50%|█████     | 10/20 [01:04<00:50,  5.04s/it, CE=6.847819e-01 H=6.846663e-01 dV_dx=-2.597507e-05 dV_dθ=-8.963844e-05 ||∇||=4.809815e-01 | Tr=0.9439 Te/Cur=0.9422 Te/Exp=0.7565] 55%|█████▌    | 11/20 [01:04<00:50,  5.58s/it, CE=6.847819e-01 H=6.846663e-01 dV_dx=-2.597507e-05 dV_dθ=-8.963844e-05 ||∇||=4.809815e-01 | Tr=0.9439 Te/Cur=0.9422 Te/Exp=0.7565] 55%|█████▌    | 11/20 [01:09<00:50,  5.58s/it, CE=6.816529e-01 H=6.815084e-01 dV_dx=-5.561820e-05 dV_dθ=-8.888225e-05 ||∇||=4.775287e-01 | Tr=0.9457]                             60%|██████    | 12/20 [01:09<00:44,  5.51s/it, CE=6.816529e-01 H=6.815084e-01 dV_dx=-5.561820e-05 dV_dθ=-8.888225e-05 ||∇||=4.775287e-01 | Tr=0.9457] 60%|██████    | 12/20 [01:15<00:44,  5.51s/it, CE=6.786204e-01 H=6.785751e-01 dV_dx=4.280848e-05 dV_dθ=-8.808573e-05 ||∇||=4.737076e-01 | Tr=0.9473]  65%|██████▌   | 13/20 [01:15<00:38,  5.47s/it, CE=6.786204e-01 H=6.785751e-01 dV_dx=4.280848e-05 dV_dθ=-8.808573e-05 ||∇||=4.737076e-01 | Tr=0.9473] 65%|██████▌   | 13/20 [01:20<00:38,  5.47s/it, CE=6.756865e-01 H=6.756090e-01 dV_dx=9.803985e-06 dV_dθ=-8.731944e-05 ||∇||=4.707938e-01 | Tr=0.9487] 70%|███████   | 14/20 [01:20<00:32,  5.34s/it, CE=6.756865e-01 H=6.756090e-01 dV_dx=9.803985e-06 dV_dθ=-8.731944e-05 ||∇||=4.707938e-01 | Tr=0.9487] 70%|███████   | 14/20 [01:24<00:32,  5.34s/it, CE=6.729168e-01 H=6.728179e-01 dV_dx=-1.156007e-05 dV_dθ=-8.729445e-05 ||∇||=4.677813e-01 | Tr=0.9499] 75%|███████▌  | 15/20 [01:24<00:26,  5.21s/it, CE=6.729168e-01 H=6.728179e-01 dV_dx=-1.156007e-05 dV_dθ=-8.729445e-05 ||∇||=4.677813e-01 | Tr=0.9499] 75%|███████▌  | 15/20 [01:32<00:26,  5.21s/it, CE=6.702371e-01 H=6.702284e-01 dV_dx=7.991846e-05 dV_dθ=-8.857284e-05 ||∇||=4.661013e-01 | Tr=0.9513 Te/Cur=0.9502 Te/Exp=0.7639] 80%|████████  | 16/20 [01:32<00:23,  5.78s/it, CE=6.702371e-01 H=6.702284e-01 dV_dx=7.991846e-05 dV_dθ=-8.857284e-05 ||∇||=4.661013e-01 | Tr=0.9513 Te/Cur=0.9502 Te/Exp=0.7639] 80%|████████  | 16/20 [01:37<00:23,  5.78s/it, CE=6.676588e-01 H=6.676017e-01 dV_dx=3.292081e-05 dV_dθ=-8.999216e-05 ||∇||=4.644704e-01 | Tr=0.9527]                             85%|████████▌ | 17/20 [01:37<00:17,  5.67s/it, CE=6.676588e-01 H=6.676017e-01 dV_dx=3.292081e-05 dV_dθ=-8.999216e-05 ||∇||=4.644704e-01 | Tr=0.9527] 85%|████████▌ | 17/20 [01:41<00:17,  5.67s/it, CE=6.651279e-01 H=6.650770e-01 dV_dx=4.002191e-05 dV_dθ=-9.091437e-05 ||∇||=4.626635e-01 | Tr=0.9538] 90%|█████████ | 18/20 [01:41<00:10,  5.26s/it, CE=6.651279e-01 H=6.650770e-01 dV_dx=4.002191e-05 dV_dθ=-9.091437e-05 ||∇||=4.626635e-01 | Tr=0.9538] 90%|█████████ | 18/20 [01:46<00:10,  5.26s/it, CE=6.626444e-01 H=6.625198e-01 dV_dx=-3.300603e-05 dV_dθ=-9.165035e-05 ||∇||=4.610988e-01 | Tr=0.9553] 95%|█████████▌| 19/20 [01:46<00:05,  5.03s/it, CE=6.626444e-01 H=6.625198e-01 dV_dx=-3.300603e-05 dV_dθ=-9.165035e-05 ||∇||=4.610988e-01 | Tr=0.9553] 95%|█████████▌| 19/20 [01:52<00:05,  5.03s/it, CE=6.601965e-01 H=6.600635e-01 dV_dx=-4.333377e-05 dV_dθ=-8.970350e-05 ||∇||=4.583288e-01 | Tr=0.9564 Te/Cur=0.9544 Te/Exp=0.7607]100%|██████████| 20/20 [01:52<00:00,  5.45s/it, CE=6.601965e-01 H=6.600635e-01 dV_dx=-4.333377e-05 dV_dθ=-8.970350e-05 ||∇||=4.583288e-01 | Tr=0.9564 Te/Cur=0.9544 Te/Exp=0.7607]100%|██████████| 20/20 [01:52<00:00,  5.64s/it, CE=6.601965e-01 H=6.600635e-01 dV_dx=-4.333377e-05 dV_dθ=-8.970350e-05 ||∇||=4.583288e-01 | Tr=0.9564 Te/Cur=0.9544 Te/Exp=0.7607]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7569
    Task 1: 0.9220
    Task 2: 0.8279
    Task 3: 0.5584
    Task 4: 0.9545

============================================================
Task 5
============================================================
Initial loss on new task: 6.6835, previous: 0.6602, ratio: 10.12
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=10.12)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:45, 11.85s/it]  5%|▌         | 1/20 [00:16<03:45, 11.85s/it, CE=6.661522e-01 H=6.661097e-01 dV_dx=-2.175319e-05 dV_dθ=-2.074696e-05 ||∇||=7.550757e-01 | Tr=0.8408] 10%|█         | 2/20 [00:16<02:15,  7.54s/it, CE=6.661522e-01 H=6.661097e-01 dV_dx=-2.175319e-05 dV_dθ=-2.074696e-05 ||∇||=7.550757e-01 | Tr=0.8408] 10%|█         | 2/20 [00:21<02:15,  7.54s/it, CE=6.427280e-01 H=6.426759e-01 dV_dx=-1.455181e-05 dV_dθ=-3.756514e-05 ||∇||=6.495769e-01 | Tr=0.8801] 15%|█▌        | 3/20 [00:21<01:48,  6.39s/it, CE=6.427280e-01 H=6.426759e-01 dV_dx=-1.455181e-05 dV_dθ=-3.756514e-05 ||∇||=6.495769e-01 | Tr=0.8801] 15%|█▌        | 3/20 [00:26<01:48,  6.39s/it, CE=6.312020e-01 H=6.311732e-01 dV_dx=2.510274e-05 dV_dθ=-5.394354e-05 ||∇||=6.145700e-01 | Tr=0.8978]  20%|██        | 4/20 [00:26<01:33,  5.83s/it, CE=6.312020e-01 H=6.311732e-01 dV_dx=2.510274e-05 dV_dθ=-5.394354e-05 ||∇||=6.145700e-01 | Tr=0.8978] 20%|██        | 4/20 [00:30<01:33,  5.83s/it, CE=6.233436e-01 H=6.233542e-01 dV_dx=6.698221e-05 dV_dθ=-5.636755e-05 ||∇||=5.856357e-01 | Tr=0.9093] 25%|██▌       | 5/20 [00:30<01:19,  5.27s/it, CE=6.233436e-01 H=6.233542e-01 dV_dx=6.698221e-05 dV_dθ=-5.636755e-05 ||∇||=5.856357e-01 | Tr=0.9093] 25%|██▌       | 5/20 [00:36<01:19,  5.27s/it, CE=6.172432e-01 H=6.172116e-01 dV_dx=2.620433e-05 dV_dθ=-5.777352e-05 ||∇||=5.635972e-01 | Tr=0.9171 Te/Cur=0.9134 Te/Exp=0.7931] 30%|███       | 6/20 [00:36<01:18,  5.63s/it, CE=6.172432e-01 H=6.172116e-01 dV_dx=2.620433e-05 dV_dθ=-5.777352e-05 ||∇||=5.635972e-01 | Tr=0.9171 Te/Cur=0.9134 Te/Exp=0.7931] 30%|███       | 6/20 [00:41<01:18,  5.63s/it, CE=6.121281e-01 H=6.121059e-01 dV_dx=3.627465e-05 dV_dθ=-5.843861e-05 ||∇||=5.462654e-01 | Tr=0.9229]                             35%|███▌      | 7/20 [00:41<01:10,  5.43s/it, CE=6.121281e-01 H=6.121059e-01 dV_dx=3.627465e-05 dV_dθ=-5.843861e-05 ||∇||=5.462654e-01 | Tr=0.9229] 35%|███▌      | 7/20 [00:47<01:10,  5.43s/it, CE=6.077014e-01 H=6.076539e-01 dV_dx=1.348937e-05 dV_dθ=-6.090947e-05 ||∇||=5.317501e-01 | Tr=0.9279] 40%|████      | 8/20 [00:47<01:03,  5.32s/it, CE=6.077014e-01 H=6.076539e-01 dV_dx=1.348937e-05 dV_dθ=-6.090947e-05 ||∇||=5.317501e-01 | Tr=0.9279] 40%|████      | 8/20 [00:52<01:03,  5.32s/it, CE=6.038825e-01 H=6.038536e-01 dV_dx=3.073957e-05 dV_dθ=-5.959560e-05 ||∇||=5.200271e-01 | Tr=0.9322] 45%|████▌     | 9/20 [00:52<00:57,  5.26s/it, CE=6.038825e-01 H=6.038536e-01 dV_dx=3.073957e-05 dV_dθ=-5.959560e-05 ||∇||=5.200271e-01 | Tr=0.9322] 45%|████▌     | 9/20 [00:57<00:57,  5.26s/it, CE=6.004269e-01 H=6.002845e-01 dV_dx=-8.341718e-05 dV_dθ=-5.896198e-05 ||∇||=5.102002e-01 | Tr=0.9352] 50%|█████     | 10/20 [00:57<00:51,  5.20s/it, CE=6.004269e-01 H=6.002845e-01 dV_dx=-8.341718e-05 dV_dθ=-5.896198e-05 ||∇||=5.102002e-01 | Tr=0.9352] 50%|█████     | 10/20 [01:04<00:51,  5.20s/it, CE=5.972896e-01 H=5.972228e-01 dV_dx=-1.026486e-05 dV_dθ=-5.652001e-05 ||∇||=5.009833e-01 | Tr=0.9383 Te/Cur=0.9316 Te/Exp=0.7991] 55%|█████▌    | 11/20 [01:04<00:51,  5.77s/it, CE=5.972896e-01 H=5.972228e-01 dV_dx=-1.026486e-05 dV_dθ=-5.652001e-05 ||∇||=5.009833e-01 | Tr=0.9383 Te/Cur=0.9316 Te/Exp=0.7991] 55%|█████▌    | 11/20 [01:09<00:51,  5.77s/it, CE=5.943970e-01 H=5.943689e-01 dV_dx=2.498146e-05 dV_dθ=-5.308439e-05 ||∇||=4.921922e-01 | Tr=0.9409]                              60%|██████    | 12/20 [01:09<00:44,  5.55s/it, CE=5.943970e-01 H=5.943689e-01 dV_dx=2.498146e-05 dV_dθ=-5.308439e-05 ||∇||=4.921922e-01 | Tr=0.9409] 60%|██████    | 12/20 [01:14<00:44,  5.55s/it, CE=5.917258e-01 H=5.916834e-01 dV_dx=7.597957e-06 dV_dθ=-5.003022e-05 ||∇||=4.855914e-01 | Tr=0.9434] 65%|██████▌   | 13/20 [01:14<00:37,  5.39s/it, CE=5.917258e-01 H=5.916834e-01 dV_dx=7.597957e-06 dV_dθ=-5.003022e-05 ||∇||=4.855914e-01 | Tr=0.9434] 65%|██████▌   | 13/20 [01:19<00:37,  5.39s/it, CE=5.892186e-01 H=5.891833e-01 dV_dx=1.253998e-05 dV_dθ=-4.785752e-05 ||∇||=4.794007e-01 | Tr=0.9458] 70%|███████   | 14/20 [01:19<00:31,  5.32s/it, CE=5.892186e-01 H=5.891833e-01 dV_dx=1.253998e-05 dV_dθ=-4.785752e-05 ||∇||=4.794007e-01 | Tr=0.9458] 70%|███████   | 14/20 [01:24<00:31,  5.32s/it, CE=5.868021e-01 H=5.867605e-01 dV_dx=4.740085e-06 dV_dθ=-4.632543e-05 ||∇||=4.742730e-01 | Tr=0.9477] 75%|███████▌  | 15/20 [01:24<00:26,  5.21s/it, CE=5.868021e-01 H=5.867605e-01 dV_dx=4.740085e-06 dV_dθ=-4.632543e-05 ||∇||=4.742730e-01 | Tr=0.9477] 75%|███████▌  | 15/20 [01:31<00:26,  5.21s/it, CE=5.844841e-01 H=5.844057e-01 dV_dx=-3.169518e-05 dV_dθ=-4.674913e-05 ||∇||=4.698062e-01 | Tr=0.9500 Te/Cur=0.9424 Te/Exp=0.7997] 80%|████████  | 16/20 [01:31<00:22,  5.64s/it, CE=5.844841e-01 H=5.844057e-01 dV_dx=-3.169518e-05 dV_dθ=-4.674913e-05 ||∇||=4.698062e-01 | Tr=0.9500 Te/Cur=0.9424 Te/Exp=0.7997] 80%|████████  | 16/20 [01:35<00:22,  5.64s/it, CE=5.822716e-01 H=5.822253e-01 dV_dx=-2.432384e-06 dV_dθ=-4.395201e-05 ||∇||=4.656478e-01 | Tr=0.9515]                             85%|████████▌ | 17/20 [01:35<00:16,  5.37s/it, CE=5.822716e-01 H=5.822253e-01 dV_dx=-2.432384e-06 dV_dθ=-4.395201e-05 ||∇||=4.656478e-01 | Tr=0.9515] 85%|████████▌ | 17/20 [01:40<00:16,  5.37s/it, CE=5.801184e-01 H=5.800838e-01 dV_dx=6.161918e-06 dV_dθ=-4.080403e-05 ||∇||=4.609600e-01 | Tr=0.9531]  90%|█████████ | 18/20 [01:40<00:10,  5.14s/it, CE=5.801184e-01 H=5.800838e-01 dV_dx=6.161918e-06 dV_dθ=-4.080403e-05 ||∇||=4.609600e-01 | Tr=0.9531] 90%|█████████ | 18/20 [01:44<00:10,  5.14s/it, CE=5.780228e-01 H=5.779774e-01 dV_dx=-7.750908e-06 dV_dθ=-3.758367e-05 ||∇||=4.565463e-01 | Tr=0.9547] 95%|█████████▌| 19/20 [01:44<00:04,  4.88s/it, CE=5.780228e-01 H=5.779774e-01 dV_dx=-7.750908e-06 dV_dθ=-3.758367e-05 ||∇||=4.565463e-01 | Tr=0.9547] 95%|█████████▌| 19/20 [01:51<00:04,  4.88s/it, CE=5.760025e-01 H=5.759645e-01 dV_dx=9.453510e-07 dV_dθ=-3.888670e-05 ||∇||=4.544009e-01 | Tr=0.9560 Te/Cur=0.9479 Te/Exp=0.8041]100%|██████████| 20/20 [01:51<00:00,  5.31s/it, CE=5.760025e-01 H=5.759645e-01 dV_dx=9.453510e-07 dV_dθ=-3.888670e-05 ||∇||=4.544009e-01 | Tr=0.9560 Te/Cur=0.9479 Te/Exp=0.8041]100%|██████████| 20/20 [01:51<00:00,  5.55s/it, CE=5.760025e-01 H=5.759645e-01 dV_dx=9.453510e-07 dV_dθ=-3.888670e-05 ||∇||=4.544009e-01 | Tr=0.9560 Te/Cur=0.9479 Te/Exp=0.8041]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7615
    Task 1: 0.9406
    Task 2: 0.8292
    Task 3: 0.5557
    Task 4: 0.9411
    Task 5: 0.9476

============================================================
Task 6
============================================================
Initial loss on new task: 6.0696, previous: 0.5760, ratio: 10.54
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=10.54)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<04:02, 12.78s/it]  5%|▌         | 1/20 [00:17<04:02, 12.78s/it, CE=5.524888e-01 H=5.524343e-01 dV_dx=1.529767e-05 dV_dθ=-6.987145e-05 ||∇||=7.236584e-01 | Tr=0.8395] 10%|█         | 2/20 [00:17<02:21,  7.85s/it, CE=5.524888e-01 H=5.524343e-01 dV_dx=1.529767e-05 dV_dθ=-6.987145e-05 ||∇||=7.236584e-01 | Tr=0.8395] 10%|█         | 2/20 [00:22<02:21,  7.85s/it, CE=5.375082e-01 H=5.375495e-01 dV_dx=1.195870e-04 dV_dθ=-7.826006e-05 ||∇||=6.393652e-01 | Tr=0.8754] 15%|█▌        | 3/20 [00:22<01:53,  6.66s/it, CE=5.375082e-01 H=5.375495e-01 dV_dx=1.195870e-04 dV_dθ=-7.826006e-05 ||∇||=6.393652e-01 | Tr=0.8754] 15%|█▌        | 3/20 [00:27<01:53,  6.66s/it, CE=5.294476e-01 H=5.293556e-01 dV_dx=-2.174456e-05 dV_dθ=-7.021801e-05 ||∇||=6.016537e-01 | Tr=0.8905] 20%|██        | 4/20 [00:27<01:33,  5.84s/it, CE=5.294476e-01 H=5.293556e-01 dV_dx=-2.174456e-05 dV_dθ=-7.021801e-05 ||∇||=6.016537e-01 | Tr=0.8905] 20%|██        | 4/20 [00:31<01:33,  5.84s/it, CE=5.235501e-01 H=5.235306e-01 dV_dx=4.385816e-05 dV_dθ=-6.339874e-05 ||∇||=5.762215e-01 | Tr=0.9014]  25%|██▌       | 5/20 [00:31<01:22,  5.48s/it, CE=5.235501e-01 H=5.235306e-01 dV_dx=4.385816e-05 dV_dθ=-6.339874e-05 ||∇||=5.762215e-01 | Tr=0.9014] 25%|██▌       | 5/20 [00:38<01:22,  5.48s/it, CE=5.187430e-01 H=5.186965e-01 dV_dx=1.210455e-05 dV_dθ=-5.855514e-05 ||∇||=5.545299e-01 | Tr=0.9098 Te/Cur=0.9149 Te/Exp=0.8256] 30%|███       | 6/20 [00:38<01:21,  5.80s/it, CE=5.187430e-01 H=5.186965e-01 dV_dx=1.210455e-05 dV_dθ=-5.855514e-05 ||∇||=5.545299e-01 | Tr=0.9098 Te/Cur=0.9149 Te/Exp=0.8256] 30%|███       | 6/20 [00:43<01:21,  5.80s/it, CE=5.146333e-01 H=5.146322e-01 dV_dx=4.938387e-05 dV_dθ=-5.051677e-05 ||∇||=5.376863e-01 | Tr=0.9157]                             35%|███▌      | 7/20 [00:43<01:12,  5.54s/it, CE=5.146333e-01 H=5.146322e-01 dV_dx=4.938387e-05 dV_dθ=-5.051677e-05 ||∇||=5.376863e-01 | Tr=0.9157] 35%|███▌      | 7/20 [00:48<01:12,  5.54s/it, CE=5.110955e-01 H=5.109871e-01 dV_dx=-5.617578e-05 dV_dθ=-5.217820e-05 ||∇||=5.283144e-01 | Tr=0.9199] 40%|████      | 8/20 [00:48<01:04,  5.39s/it, CE=5.110955e-01 H=5.109871e-01 dV_dx=-5.617578e-05 dV_dθ=-5.217820e-05 ||∇||=5.283144e-01 | Tr=0.9199] 40%|████      | 8/20 [00:53<01:04,  5.39s/it, CE=5.079022e-01 H=5.079229e-01 dV_dx=6.635728e-05 dV_dθ=-4.565900e-05 ||∇||=5.172178e-01 | Tr=0.9241]  45%|████▌     | 9/20 [00:53<00:58,  5.28s/it, CE=5.079022e-01 H=5.079229e-01 dV_dx=6.635728e-05 dV_dθ=-4.565900e-05 ||∇||=5.172178e-01 | Tr=0.9241] 45%|████▌     | 9/20 [00:58<00:58,  5.28s/it, CE=5.051582e-01 H=5.050778e-01 dV_dx=-3.523047e-05 dV_dθ=-4.521962e-05 ||∇||=5.093354e-01 | Tr=0.9271] 50%|█████     | 10/20 [00:58<00:52,  5.22s/it, CE=5.051582e-01 H=5.050778e-01 dV_dx=-3.523047e-05 dV_dθ=-4.521962e-05 ||∇||=5.093354e-01 | Tr=0.9271] 50%|█████     | 10/20 [01:05<00:52,  5.22s/it, CE=5.026451e-01 H=5.026310e-01 dV_dx=3.038030e-05 dV_dθ=-4.448337e-05 ||∇||=5.029545e-01 | Tr=0.9298 Te/Cur=0.9295 Te/Exp=0.8301] 55%|█████▌    | 11/20 [01:05<00:51,  5.74s/it, CE=5.026451e-01 H=5.026310e-01 dV_dx=3.038030e-05 dV_dθ=-4.448337e-05 ||∇||=5.029545e-01 | Tr=0.9298 Te/Cur=0.9295 Te/Exp=0.8301] 55%|█████▌    | 11/20 [01:10<00:51,  5.74s/it, CE=5.003330e-01 H=5.002547e-01 dV_dx=-3.387022e-05 dV_dθ=-4.443925e-05 ||∇||=4.980657e-01 | Tr=0.9330]                            60%|██████    | 12/20 [01:10<00:44,  5.53s/it, CE=5.003330e-01 H=5.002547e-01 dV_dx=-3.387022e-05 dV_dθ=-4.443925e-05 ||∇||=4.980657e-01 | Tr=0.9330] 60%|██████    | 12/20 [01:15<00:44,  5.53s/it, CE=4.981419e-01 H=4.980347e-01 dV_dx=-6.102561e-05 dV_dθ=-4.620101e-05 ||∇||=4.934900e-01 | Tr=0.9351] 65%|██████▌   | 13/20 [01:15<00:38,  5.50s/it, CE=4.981419e-01 H=4.980347e-01 dV_dx=-6.102561e-05 dV_dθ=-4.620101e-05 ||∇||=4.934900e-01 | Tr=0.9351] 65%|██████▌   | 13/20 [01:21<00:38,  5.50s/it, CE=4.960550e-01 H=4.959977e-01 dV_dx=-7.525432e-06 dV_dθ=-4.973501e-05 ||∇||=4.911846e-01 | Tr=0.9374] 70%|███████   | 14/20 [01:21<00:32,  5.41s/it, CE=4.960550e-01 H=4.959977e-01 dV_dx=-7.525432e-06 dV_dθ=-4.973501e-05 ||∇||=4.911846e-01 | Tr=0.9374] 70%|███████   | 14/20 [01:25<00:32,  5.41s/it, CE=4.940156e-01 H=4.939258e-01 dV_dx=-4.019931e-05 dV_dθ=-4.962782e-05 ||∇||=4.870642e-01 | Tr=0.9393] 75%|███████▌  | 15/20 [01:25<00:26,  5.25s/it, CE=4.940156e-01 H=4.939258e-01 dV_dx=-4.019931e-05 dV_dθ=-4.962782e-05 ||∇||=4.870642e-01 | Tr=0.9393] 75%|███████▌  | 15/20 [01:32<00:26,  5.25s/it, CE=4.920337e-01 H=4.919965e-01 dV_dx=1.335574e-05 dV_dθ=-5.053929e-05 ||∇||=4.836442e-01 | Tr=0.9410 Te/Cur=0.9386 Te/Exp=0.8257] 80%|████████  | 16/20 [01:32<00:22,  5.66s/it, CE=4.920337e-01 H=4.919965e-01 dV_dx=1.335574e-05 dV_dθ=-5.053929e-05 ||∇||=4.836442e-01 | Tr=0.9410 Te/Cur=0.9386 Te/Exp=0.8257] 80%|████████  | 16/20 [01:36<00:22,  5.66s/it, CE=4.901256e-01 H=4.900849e-01 dV_dx=1.079451e-05 dV_dθ=-5.154786e-05 ||∇||=4.812507e-01 | Tr=0.9426]                             85%|████████▌ | 17/20 [01:36<00:15,  5.25s/it, CE=4.901256e-01 H=4.900849e-01 dV_dx=1.079451e-05 dV_dθ=-5.154786e-05 ||∇||=4.812507e-01 | Tr=0.9426] 85%|████████▌ | 17/20 [01:41<00:15,  5.25s/it, CE=4.882757e-01 H=4.882503e-01 dV_dx=2.793334e-05 dV_dθ=-5.335808e-05 ||∇||=4.788314e-01 | Tr=0.9438] 90%|█████████ | 18/20 [01:41<00:10,  5.08s/it, CE=4.882757e-01 H=4.882503e-01 dV_dx=2.793334e-05 dV_dθ=-5.335808e-05 ||∇||=4.788314e-01 | Tr=0.9438] 90%|█████████ | 18/20 [01:45<00:10,  5.08s/it, CE=4.864336e-01 H=4.863898e-01 dV_dx=9.611844e-06 dV_dθ=-5.338818e-05 ||∇||=4.771033e-01 | Tr=0.9452] 95%|█████████▌| 19/20 [01:45<00:04,  4.88s/it, CE=4.864336e-01 H=4.863898e-01 dV_dx=9.611844e-06 dV_dθ=-5.338818e-05 ||∇||=4.771033e-01 | Tr=0.9452] 95%|█████████▌| 19/20 [01:51<00:04,  4.88s/it, CE=4.846306e-01 H=4.845817e-01 dV_dx=3.647128e-06 dV_dθ=-5.253243e-05 ||∇||=4.745862e-01 | Tr=0.9466 Te/Cur=0.9435 Te/Exp=0.8354]100%|██████████| 20/20 [01:51<00:00,  5.12s/it, CE=4.846306e-01 H=4.845817e-01 dV_dx=3.647128e-06 dV_dθ=-5.253243e-05 ||∇||=4.745862e-01 | Tr=0.9466 Te/Cur=0.9435 Te/Exp=0.8354]100%|██████████| 20/20 [01:51<00:00,  5.58s/it, CE=4.846306e-01 H=4.845817e-01 dV_dx=3.647128e-06 dV_dθ=-5.253243e-05 ||∇||=4.745862e-01 | Tr=0.9466 Te/Cur=0.9435 Te/Exp=0.8354]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7697
    Task 1: 0.9474
    Task 2: 0.8328
    Task 3: 0.5552
    Task 4: 0.9472
    Task 5: 0.9322
    Task 6: 0.9444

============================================================
Task 7
============================================================
Initial loss on new task: 5.6854, previous: 0.4846, ratio: 11.73
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=11.73)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:54, 12.35s/it]  5%|▌         | 1/20 [00:16<03:54, 12.35s/it, CE=5.709480e-01 H=5.709484e-01 dV_dx=-7.001888e-06 dV_dθ=7.383565e-06 ||∇||=6.985371e-01 | Tr=0.8820] 10%|█         | 2/20 [00:16<02:19,  7.73s/it, CE=5.709480e-01 H=5.709484e-01 dV_dx=-7.001888e-06 dV_dθ=7.383565e-06 ||∇||=6.985371e-01 | Tr=0.8820] 10%|█         | 2/20 [00:21<02:19,  7.73s/it, CE=5.387576e-01 H=5.388053e-01 dV_dx=1.999281e-05 dV_dθ=2.773199e-05 ||∇||=5.981710e-01 | Tr=0.9048]  15%|█▌        | 3/20 [00:21<01:49,  6.42s/it, CE=5.387576e-01 H=5.388053e-01 dV_dx=1.999281e-05 dV_dθ=2.773199e-05 ||∇||=5.981710e-01 | Tr=0.9048] 15%|█▌        | 3/20 [00:26<01:49,  6.42s/it, CE=5.228970e-01 H=5.228900e-01 dV_dx=-1.964658e-05 dV_dθ=1.268722e-05 ||∇||=5.643228e-01 | Tr=0.9170] 20%|██        | 4/20 [00:26<01:31,  5.74s/it, CE=5.228970e-01 H=5.228900e-01 dV_dx=-1.964658e-05 dV_dθ=1.268722e-05 ||∇||=5.643228e-01 | Tr=0.9170] 20%|██        | 4/20 [00:31<01:31,  5.74s/it, CE=5.121397e-01 H=5.121057e-01 dV_dx=-3.480128e-05 dV_dθ=8.232970e-07 ||∇||=5.419733e-01 | Tr=0.9255] 25%|██▌       | 5/20 [00:31<01:22,  5.50s/it, CE=5.121397e-01 H=5.121057e-01 dV_dx=-3.480128e-05 dV_dθ=8.232970e-07 ||∇||=5.419733e-01 | Tr=0.9255] 25%|██▌       | 5/20 [00:37<01:22,  5.50s/it, CE=5.040982e-01 H=5.040748e-01 dV_dx=-1.711823e-05 dV_dθ=-6.217784e-06 ||∇||=5.249811e-01 | Tr=0.9319 Te/Cur=0.9284 Te/Exp=0.8353] 30%|███       | 6/20 [00:37<01:21,  5.81s/it, CE=5.040982e-01 H=5.040748e-01 dV_dx=-1.711823e-05 dV_dθ=-6.217784e-06 ||∇||=5.249811e-01 | Tr=0.9319 Te/Cur=0.9284 Te/Exp=0.8353] 30%|███       | 6/20 [00:43<01:21,  5.81s/it, CE=4.977152e-01 H=4.977968e-01 dV_dx=8.973734e-05 dV_dθ=-8.139892e-06 ||∇||=5.113374e-01 | Tr=0.9363]                              35%|███▌      | 7/20 [00:43<01:12,  5.59s/it, CE=4.977152e-01 H=4.977968e-01 dV_dx=8.973734e-05 dV_dθ=-8.139892e-06 ||∇||=5.113374e-01 | Tr=0.9363] 35%|███▌      | 7/20 [00:48<01:12,  5.59s/it, CE=4.922511e-01 H=4.921843e-01 dV_dx=-5.706678e-05 dV_dθ=-9.743688e-06 ||∇||=5.004045e-01 | Tr=0.9404] 40%|████      | 8/20 [00:48<01:05,  5.49s/it, CE=4.922511e-01 H=4.921843e-01 dV_dx=-5.706678e-05 dV_dθ=-9.743688e-06 ||∇||=5.004045e-01 | Tr=0.9404] 40%|████      | 8/20 [00:52<01:05,  5.49s/it, CE=4.873095e-01 H=4.873635e-01 dV_dx=6.385046e-05 dV_dθ=-9.839050e-06 ||∇||=4.900697e-01 | Tr=0.9432]  45%|████▌     | 9/20 [00:52<00:57,  5.20s/it, CE=4.873095e-01 H=4.873635e-01 dV_dx=6.385046e-05 dV_dθ=-9.839050e-06 ||∇||=4.900697e-01 | Tr=0.9432] 45%|████▌     | 9/20 [00:58<00:57,  5.20s/it, CE=4.828368e-01 H=4.828399e-01 dV_dx=1.259865e-05 dV_dθ=-9.501156e-06 ||∇||=4.826254e-01 | Tr=0.9463] 50%|█████     | 10/20 [00:58<00:52,  5.25s/it, CE=4.828368e-01 H=4.828399e-01 dV_dx=1.259865e-05 dV_dθ=-9.501156e-06 ||∇||=4.826254e-01 | Tr=0.9463] 50%|█████     | 10/20 [01:04<00:52,  5.25s/it, CE=4.787662e-01 H=4.787263e-01 dV_dx=-2.945470e-05 dV_dθ=-1.047316e-05 ||∇||=4.765824e-01 | Tr=0.9488 Te/Cur=0.9439 Te/Exp=0.8422] 55%|█████▌    | 11/20 [01:04<00:51,  5.70s/it, CE=4.787662e-01 H=4.787263e-01 dV_dx=-2.945470e-05 dV_dθ=-1.047316e-05 ||∇||=4.765824e-01 | Tr=0.9488 Te/Cur=0.9439 Te/Exp=0.8422] 55%|█████▌    | 11/20 [01:09<00:51,  5.70s/it, CE=4.750213e-01 H=4.749915e-01 dV_dx=-1.914646e-05 dV_dθ=-1.072252e-05 ||∇||=4.716356e-01 | Tr=0.9511]                             60%|██████    | 12/20 [01:09<00:43,  5.46s/it, CE=4.750213e-01 H=4.749915e-01 dV_dx=-1.914646e-05 dV_dθ=-1.072252e-05 ||∇||=4.716356e-01 | Tr=0.9511] 60%|██████    | 12/20 [01:14<00:43,  5.46s/it, CE=4.715741e-01 H=4.714999e-01 dV_dx=-6.478380e-05 dV_dθ=-9.476319e-06 ||∇||=4.799087e-01 | Tr=0.9533] 65%|██████▌   | 13/20 [01:14<00:36,  5.25s/it, CE=4.715741e-01 H=4.714999e-01 dV_dx=-6.478380e-05 dV_dθ=-9.476319e-06 ||∇||=4.799087e-01 | Tr=0.9533] 65%|██████▌   | 13/20 [01:19<00:36,  5.25s/it, CE=4.682982e-01 H=4.682875e-01 dV_dx=-1.762271e-08 dV_dθ=-1.067300e-05 ||∇||=4.758635e-01 | Tr=0.9552] 70%|███████   | 14/20 [01:19<00:31,  5.17s/it, CE=4.682982e-01 H=4.682875e-01 dV_dx=-1.762271e-08 dV_dθ=-1.067300e-05 ||∇||=4.758635e-01 | Tr=0.9552] 70%|███████   | 14/20 [01:24<00:31,  5.17s/it, CE=4.652474e-01 H=4.652135e-01 dV_dx=-2.043496e-05 dV_dθ=-1.342985e-05 ||∇||=4.706130e-01 | Tr=0.9570] 75%|███████▌  | 15/20 [01:24<00:25,  5.13s/it, CE=4.652474e-01 H=4.652135e-01 dV_dx=-2.043496e-05 dV_dθ=-1.342985e-05 ||∇||=4.706130e-01 | Tr=0.9570] 75%|███████▌  | 15/20 [01:31<00:25,  5.13s/it, CE=4.623725e-01 H=4.623943e-01 dV_dx=3.814129e-05 dV_dθ=-1.634996e-05 ||∇||=4.681979e-01 | Tr=0.9589 Te/Cur=0.9527 Te/Exp=0.8360] 80%|████████  | 16/20 [01:31<00:22,  5.63s/it, CE=4.623725e-01 H=4.623943e-01 dV_dx=3.814129e-05 dV_dθ=-1.634996e-05 ||∇||=4.681979e-01 | Tr=0.9589 Te/Cur=0.9527 Te/Exp=0.8360] 80%|████████  | 16/20 [01:35<00:22,  5.63s/it, CE=4.596177e-01 H=4.596164e-01 dV_dx=1.661715e-05 dV_dθ=-1.797827e-05 ||∇||=4.652212e-01 | Tr=0.9600]                             85%|████████▌ | 17/20 [01:35<00:15,  5.24s/it, CE=4.596177e-01 H=4.596164e-01 dV_dx=1.661715e-05 dV_dθ=-1.797827e-05 ||∇||=4.652212e-01 | Tr=0.9600] 85%|████████▌ | 17/20 [01:39<00:15,  5.24s/it, CE=4.570638e-01 H=4.570545e-01 dV_dx=1.078320e-05 dV_dθ=-2.013046e-05 ||∇||=4.625493e-01 | Tr=0.9617] 90%|█████████ | 18/20 [01:39<00:09,  4.88s/it, CE=4.570638e-01 H=4.570545e-01 dV_dx=1.078320e-05 dV_dθ=-2.013046e-05 ||∇||=4.625493e-01 | Tr=0.9617] 90%|█████████ | 18/20 [01:44<00:09,  4.88s/it, CE=4.546666e-01 H=4.546439e-01 dV_dx=4.330502e-07 dV_dθ=-2.314391e-05 ||∇||=4.611077e-01 | Tr=0.9630] 95%|█████████▌| 19/20 [01:44<00:04,  4.70s/it, CE=4.546666e-01 H=4.546439e-01 dV_dx=4.330502e-07 dV_dθ=-2.314391e-05 ||∇||=4.611077e-01 | Tr=0.9630] 95%|█████████▌| 19/20 [01:50<00:04,  4.70s/it, CE=4.523455e-01 H=4.523601e-01 dV_dx=3.922822e-05 dV_dθ=-2.463011e-05 ||∇||=4.592475e-01 | Tr=0.9640 Te/Cur=0.9596 Te/Exp=0.8409]100%|██████████| 20/20 [01:50<00:00,  5.08s/it, CE=4.523455e-01 H=4.523601e-01 dV_dx=3.922822e-05 dV_dθ=-2.463011e-05 ||∇||=4.592475e-01 | Tr=0.9640 Te/Cur=0.9596 Te/Exp=0.8409]100%|██████████| 20/20 [01:50<00:00,  5.50s/it, CE=4.523455e-01 H=4.523601e-01 dV_dx=3.922822e-05 dV_dθ=-2.463011e-05 ||∇||=4.592475e-01 | Tr=0.9640 Te/Cur=0.9596 Te/Exp=0.8409]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7622
    Task 1: 0.9376
    Task 2: 0.8327
    Task 3: 0.5594
    Task 4: 0.9357
    Task 5: 0.9263
    Task 6: 0.9354
    Task 7: 0.9585

============================================================
Task 8
============================================================
Initial loss on new task: 4.7366, previous: 0.4523, ratio: 10.47
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=10.47)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:45, 11.89s/it]  5%|▌         | 1/20 [00:17<03:45, 11.89s/it, CE=5.540681e-01 H=5.542905e-01 dV_dx=9.350969e-06 dV_dθ=2.130519e-04 ||∇||=6.766310e-01 | Tr=0.8913] 10%|█         | 2/20 [00:17<02:23,  7.94s/it, CE=5.540681e-01 H=5.542905e-01 dV_dx=9.350969e-06 dV_dθ=2.130519e-04 ||∇||=6.766310e-01 | Tr=0.8913] 10%|█         | 2/20 [00:21<02:23,  7.94s/it, CE=5.164829e-01 H=5.165902e-01 dV_dx=-1.987737e-05 dV_dθ=1.271860e-04 ||∇||=6.068825e-01 | Tr=0.9109] 15%|█▌        | 3/20 [00:21<01:50,  6.53s/it, CE=5.164829e-01 H=5.165902e-01 dV_dx=-1.987737e-05 dV_dθ=1.271860e-04 ||∇||=6.068825e-01 | Tr=0.9109] 15%|█▌        | 3/20 [00:26<01:50,  6.53s/it, CE=5.007156e-01 H=5.007672e-01 dV_dx=-2.845021e-05 dV_dθ=8.005793e-05 ||∇||=5.797396e-01 | Tr=0.9214] 20%|██        | 4/20 [00:26<01:33,  5.82s/it, CE=5.007156e-01 H=5.007672e-01 dV_dx=-2.845021e-05 dV_dθ=8.005793e-05 ||∇||=5.797396e-01 | Tr=0.9214] 20%|██        | 4/20 [00:31<01:33,  5.82s/it, CE=4.895413e-01 H=4.895347e-01 dV_dx=-5.965377e-05 dV_dθ=5.313727e-05 ||∇||=5.601879e-01 | Tr=0.9289] 25%|██▌       | 5/20 [00:31<01:21,  5.46s/it, CE=4.895413e-01 H=4.895347e-01 dV_dx=-5.965377e-05 dV_dθ=5.313727e-05 ||∇||=5.601879e-01 | Tr=0.9289] 25%|██▌       | 5/20 [00:38<01:21,  5.46s/it, CE=4.806183e-01 H=4.806267e-01 dV_dx=-2.914540e-05 dV_dθ=3.756348e-05 ||∇||=5.446946e-01 | Tr=0.9349 Te/Cur=0.9341 Te/Exp=0.8380] 30%|███       | 6/20 [00:38<01:24,  6.05s/it, CE=4.806183e-01 H=4.806267e-01 dV_dx=-2.914540e-05 dV_dθ=3.756348e-05 ||∇||=5.446946e-01 | Tr=0.9349 Te/Cur=0.9341 Te/Exp=0.8380] 30%|███       | 6/20 [00:43<01:24,  6.05s/it, CE=4.730033e-01 H=4.730160e-01 dV_dx=-1.746356e-05 dV_dθ=3.025214e-05 ||∇||=5.314477e-01 | Tr=0.9392]                             35%|███▌      | 7/20 [00:43<01:12,  5.54s/it, CE=4.730033e-01 H=4.730160e-01 dV_dx=-1.746356e-05 dV_dθ=3.025214e-05 ||∇||=5.314477e-01 | Tr=0.9392] 35%|███▌      | 7/20 [00:47<01:12,  5.54s/it, CE=4.664868e-01 H=4.665708e-01 dV_dx=6.047507e-05 dV_dθ=2.354781e-05 ||∇||=5.203095e-01 | Tr=0.9432]  40%|████      | 8/20 [00:47<01:03,  5.28s/it, CE=4.664868e-01 H=4.665708e-01 dV_dx=6.047507e-05 dV_dθ=2.354781e-05 ||∇||=5.203095e-01 | Tr=0.9432] 40%|████      | 8/20 [00:52<01:03,  5.28s/it, CE=4.608336e-01 H=4.608415e-01 dV_dx=-1.206707e-05 dV_dθ=1.996758e-05 ||∇||=5.105918e-01 | Tr=0.9464] 45%|████▌     | 9/20 [00:52<00:57,  5.23s/it, CE=4.608336e-01 H=4.608415e-01 dV_dx=-1.206707e-05 dV_dθ=1.996758e-05 ||∇||=5.105918e-01 | Tr=0.9464] 45%|████▌     | 9/20 [00:58<00:57,  5.23s/it, CE=4.557646e-01 H=4.558220e-01 dV_dx=4.167727e-05 dV_dθ=1.567070e-05 ||∇||=5.025735e-01 | Tr=0.9491]  50%|█████     | 10/20 [00:58<00:52,  5.27s/it, CE=4.557646e-01 H=4.558220e-01 dV_dx=4.167727e-05 dV_dθ=1.567070e-05 ||∇||=5.025735e-01 | Tr=0.9491] 50%|█████     | 10/20 [01:05<00:52,  5.27s/it, CE=4.510872e-01 H=4.511043e-01 dV_dx=5.434024e-06 dV_dθ=1.163842e-05 ||∇||=4.965249e-01 | Tr=0.9515 Te/Cur=0.9471 Te/Exp=0.8430] 55%|█████▌    | 11/20 [01:05<00:52,  5.78s/it, CE=4.510872e-01 H=4.511043e-01 dV_dx=5.434024e-06 dV_dθ=1.163842e-05 ||∇||=4.965249e-01 | Tr=0.9515 Te/Cur=0.9471 Te/Exp=0.8430] 55%|█████▌    | 11/20 [01:10<00:52,  5.78s/it, CE=4.469002e-01 H=4.468637e-01 dV_dx=-4.358142e-05 dV_dθ=7.087772e-06 ||∇||=4.922530e-01 | Tr=0.9540]                            60%|██████    | 12/20 [01:10<00:44,  5.56s/it, CE=4.469002e-01 H=4.468637e-01 dV_dx=-4.358142e-05 dV_dθ=7.087772e-06 ||∇||=4.922530e-01 | Tr=0.9540] 60%|██████    | 12/20 [01:15<00:44,  5.56s/it, CE=4.430152e-01 H=4.430298e-01 dV_dx=1.041486e-05 dV_dθ=4.151476e-06 ||∇||=4.874334e-01 | Tr=0.9565]  65%|██████▌   | 13/20 [01:15<00:37,  5.40s/it, CE=4.430152e-01 H=4.430298e-01 dV_dx=1.041486e-05 dV_dθ=4.151476e-06 ||∇||=4.874334e-01 | Tr=0.9565] 65%|██████▌   | 13/20 [01:19<00:37,  5.40s/it, CE=4.393315e-01 H=4.393470e-01 dV_dx=1.428587e-05 dV_dθ=1.241455e-06 ||∇||=4.832186e-01 | Tr=0.9581] 70%|███████   | 14/20 [01:19<00:30,  5.16s/it, CE=4.393315e-01 H=4.393470e-01 dV_dx=1.428587e-05 dV_dθ=1.241455e-06 ||∇||=4.832186e-01 | Tr=0.9581] 70%|███████   | 14/20 [01:25<00:30,  5.16s/it, CE=4.358770e-01 H=4.359212e-01 dV_dx=4.489714e-05 dV_dθ=-7.542340e-07 ||∇||=4.793933e-01 | Tr=0.9596] 75%|███████▌  | 15/20 [01:25<00:25,  5.17s/it, CE=4.358770e-01 H=4.359212e-01 dV_dx=4.489714e-05 dV_dθ=-7.542340e-07 ||∇||=4.793933e-01 | Tr=0.9596] 75%|███████▌  | 15/20 [01:31<00:25,  5.17s/it, CE=4.326372e-01 H=4.326612e-01 dV_dx=2.933759e-05 dV_dθ=-5.326828e-06 ||∇||=4.763333e-01 | Tr=0.9618 Te/Cur=0.9565 Te/Exp=0.8445] 80%|████████  | 16/20 [01:31<00:22,  5.50s/it, CE=4.326372e-01 H=4.326612e-01 dV_dx=2.933759e-05 dV_dθ=-5.326828e-06 ||∇||=4.763333e-01 | Tr=0.9618 Te/Cur=0.9565 Te/Exp=0.8445] 80%|████████  | 16/20 [01:36<00:22,  5.50s/it, CE=4.295195e-01 H=4.294892e-01 dV_dx=-2.279821e-05 dV_dθ=-7.590959e-06 ||∇||=4.735584e-01 | Tr=0.9632]                            85%|████████▌ | 17/20 [01:36<00:16,  5.39s/it, CE=4.295195e-01 H=4.294892e-01 dV_dx=-2.279821e-05 dV_dθ=-7.590959e-06 ||∇||=4.735584e-01 | Tr=0.9632] 85%|████████▌ | 17/20 [01:41<00:16,  5.39s/it, CE=4.264831e-01 H=4.264863e-01 dV_dx=1.258713e-05 dV_dθ=-9.394964e-06 ||∇||=4.703188e-01 | Tr=0.9644]  90%|█████████ | 18/20 [01:41<00:10,  5.24s/it, CE=4.264831e-01 H=4.264863e-01 dV_dx=1.258713e-05 dV_dθ=-9.394964e-06 ||∇||=4.703188e-01 | Tr=0.9644] 90%|█████████ | 18/20 [01:45<00:10,  5.24s/it, CE=4.235528e-01 H=4.235460e-01 dV_dx=3.482002e-06 dV_dθ=-1.026449e-05 ||∇||=4.672263e-01 | Tr=0.9655] 95%|█████████▌| 19/20 [01:45<00:04,  4.90s/it, CE=4.235528e-01 H=4.235460e-01 dV_dx=3.482002e-06 dV_dθ=-1.026449e-05 ||∇||=4.672263e-01 | Tr=0.9655] 95%|█████████▌| 19/20 [01:50<00:04,  4.90s/it, CE=4.206577e-01 H=4.207594e-01 dV_dx=1.136580e-04 dV_dθ=-1.194679e-05 ||∇||=4.641081e-01 | Tr=0.9667 Te/Cur=0.9587 Te/Exp=0.8432]100%|██████████| 20/20 [01:50<00:00,  5.01s/it, CE=4.206577e-01 H=4.207594e-01 dV_dx=1.136580e-04 dV_dθ=-1.194679e-05 ||∇||=4.641081e-01 | Tr=0.9667 Te/Cur=0.9587 Te/Exp=0.8432]100%|██████████| 20/20 [01:50<00:00,  5.54s/it, CE=4.206577e-01 H=4.207594e-01 dV_dx=1.136580e-04 dV_dθ=-1.194679e-05 ||∇||=4.641081e-01 | Tr=0.9667 Te/Cur=0.9587 Te/Exp=0.8432]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.7718
    Task 1: 0.9450
    Task 2: 0.8350
    Task 3: 0.5688
    Task 4: 0.9433
    Task 5: 0.8966
    Task 6: 0.9215
    Task 7: 0.9088
    Task 8: 0.9596

============================================================
Task 9
============================================================
Initial loss on new task: 1.6469, previous: 0.4207, ratio: 3.92
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=3.92)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<04:00, 12.65s/it]  5%|▌         | 1/20 [00:17<04:00, 12.65s/it, CE=4.192006e-01 H=4.189698e-01 dV_dx=-5.563796e-05 dV_dθ=-1.751436e-04 ||∇||=7.452016e-01 | Tr=0.9067] 10%|█         | 2/20 [00:17<02:26,  8.16s/it, CE=4.192006e-01 H=4.189698e-01 dV_dx=-5.563796e-05 dV_dθ=-1.751436e-04 ||∇||=7.452016e-01 | Tr=0.9067] 10%|█         | 2/20 [00:22<02:26,  8.16s/it, CE=4.099689e-01 H=4.098423e-01 dV_dx=-3.063093e-06 dV_dθ=-1.235449e-04 ||∇||=6.642395e-01 | Tr=0.9204] 15%|█▌        | 3/20 [00:22<01:52,  6.60s/it, CE=4.099689e-01 H=4.098423e-01 dV_dx=-3.063093e-06 dV_dθ=-1.235449e-04 ||∇||=6.642395e-01 | Tr=0.9204] 15%|█▌        | 3/20 [00:26<01:52,  6.60s/it, CE=4.047954e-01 H=4.046999e-01 dV_dx=1.300943e-05 dV_dθ=-1.085357e-04 ||∇||=6.317296e-01 | Tr=0.9282]  20%|██        | 4/20 [00:26<01:32,  5.77s/it, CE=4.047954e-01 H=4.046999e-01 dV_dx=1.300943e-05 dV_dθ=-1.085357e-04 ||∇||=6.317296e-01 | Tr=0.9282] 20%|██        | 4/20 [00:31<01:32,  5.77s/it, CE=4.004951e-01 H=4.004043e-01 dV_dx=2.162599e-05 dV_dθ=-1.124757e-04 ||∇||=6.147365e-01 | Tr=0.9339] 25%|██▌       | 5/20 [00:31<01:21,  5.41s/it, CE=4.004951e-01 H=4.004043e-01 dV_dx=2.162599e-05 dV_dθ=-1.124757e-04 ||∇||=6.147365e-01 | Tr=0.9339] 25%|██▌       | 5/20 [00:38<01:21,  5.41s/it, CE=3.965808e-01 H=3.964444e-01 dV_dx=-2.933368e-05 dV_dθ=-1.070244e-04 ||∇||=6.017067e-01 | Tr=0.9389 Te/Cur=0.9403 Te/Exp=0.8589] 30%|███       | 6/20 [00:38<01:23,  5.98s/it, CE=3.965808e-01 H=3.964444e-01 dV_dx=-2.933368e-05 dV_dθ=-1.070244e-04 ||∇||=6.017067e-01 | Tr=0.9389 Te/Cur=0.9403 Te/Exp=0.8589] 30%|███       | 6/20 [00:43<01:23,  5.98s/it, CE=3.930525e-01 H=3.929419e-01 dV_dx=-1.107602e-05 dV_dθ=-9.951819e-05 ||∇||=5.915532e-01 | Tr=0.9423]                             35%|███▌      | 7/20 [00:43<01:12,  5.58s/it, CE=3.930525e-01 H=3.929419e-01 dV_dx=-1.107602e-05 dV_dθ=-9.951819e-05 ||∇||=5.915532e-01 | Tr=0.9423] 35%|███▌      | 7/20 [00:48<01:12,  5.58s/it, CE=3.896397e-01 H=3.895021e-01 dV_dx=-3.078378e-05 dV_dθ=-1.067623e-04 ||∇||=5.859328e-01 | Tr=0.9452] 40%|████      | 8/20 [00:48<01:04,  5.36s/it, CE=3.896397e-01 H=3.895021e-01 dV_dx=-3.078378e-05 dV_dθ=-1.067623e-04 ||∇||=5.859328e-01 | Tr=0.9452] 40%|████      | 8/20 [00:52<01:04,  5.36s/it, CE=3.864177e-01 H=3.862963e-01 dV_dx=-1.858456e-05 dV_dθ=-1.028582e-04 ||∇||=5.770553e-01 | Tr=0.9477] 45%|████▌     | 9/20 [00:52<00:54,  4.98s/it, CE=3.864177e-01 H=3.862963e-01 dV_dx=-1.858456e-05 dV_dθ=-1.028582e-04 ||∇||=5.770553e-01 | Tr=0.9477] 45%|████▌     | 9/20 [00:57<00:54,  4.98s/it, CE=3.832702e-01 H=3.832272e-01 dV_dx=6.236256e-05 dV_dθ=-1.053930e-04 ||∇||=5.720227e-01 | Tr=0.9496]  50%|█████     | 10/20 [00:57<00:50,  5.05s/it, CE=3.832702e-01 H=3.832272e-01 dV_dx=6.236256e-05 dV_dθ=-1.053930e-04 ||∇||=5.720227e-01 | Tr=0.9496] 50%|█████     | 10/20 [01:04<00:50,  5.05s/it, CE=3.803219e-01 H=3.801897e-01 dV_dx=-2.624320e-05 dV_dθ=-1.059044e-04 ||∇||=5.656191e-01 | Tr=0.9519 Te/Cur=0.9524 Te/Exp=0.8629] 55%|█████▌    | 11/20 [01:04<00:50,  5.65s/it, CE=3.803219e-01 H=3.801897e-01 dV_dx=-2.624320e-05 dV_dθ=-1.059044e-04 ||∇||=5.656191e-01 | Tr=0.9519 Te/Cur=0.9524 Te/Exp=0.8629] 55%|█████▌    | 11/20 [01:10<00:50,  5.65s/it, CE=3.775683e-01 H=3.774138e-01 dV_dx=-4.995383e-05 dV_dθ=-1.045927e-04 ||∇||=5.583107e-01 | Tr=0.9538]                             60%|██████    | 12/20 [01:10<00:44,  5.55s/it, CE=3.775683e-01 H=3.774138e-01 dV_dx=-4.995383e-05 dV_dθ=-1.045927e-04 ||∇||=5.583107e-01 | Tr=0.9538] 60%|██████    | 12/20 [01:15<00:44,  5.55s/it, CE=3.749500e-01 H=3.749415e-01 dV_dx=8.843661e-05 dV_dθ=-9.696880e-05 ||∇||=5.525413e-01 | Tr=0.9555]  65%|██████▌   | 13/20 [01:15<00:38,  5.52s/it, CE=3.749500e-01 H=3.749415e-01 dV_dx=8.843661e-05 dV_dθ=-9.696880e-05 ||∇||=5.525413e-01 | Tr=0.9555] 65%|██████▌   | 13/20 [01:20<00:38,  5.52s/it, CE=3.724501e-01 H=3.723751e-01 dV_dx=2.180737e-05 dV_dθ=-9.678057e-05 ||∇||=5.474061e-01 | Tr=0.9573] 70%|███████   | 14/20 [01:20<00:32,  5.41s/it, CE=3.724501e-01 H=3.723751e-01 dV_dx=2.180737e-05 dV_dθ=-9.678057e-05 ||∇||=5.474061e-01 | Tr=0.9573] 70%|███████   | 14/20 [01:25<00:32,  5.41s/it, CE=3.700158e-01 H=3.699734e-01 dV_dx=5.501746e-05 dV_dθ=-9.745624e-05 ||∇||=5.423757e-01 | Tr=0.9585] 75%|███████▌  | 15/20 [01:25<00:25,  5.12s/it, CE=3.700158e-01 H=3.699734e-01 dV_dx=5.501746e-05 dV_dθ=-9.745624e-05 ||∇||=5.423757e-01 | Tr=0.9585] 75%|███████▌  | 15/20 [01:31<00:25,  5.12s/it, CE=3.676531e-01 H=3.676585e-01 dV_dx=1.023047e-04 dV_dθ=-9.682990e-05 ||∇||=5.430259e-01 | Tr=0.9595 Te/Cur=0.9564 Te/Exp=0.8631] 80%|████████  | 16/20 [01:31<00:22,  5.60s/it, CE=3.676531e-01 H=3.676585e-01 dV_dx=1.023047e-04 dV_dθ=-9.682990e-05 ||∇||=5.430259e-01 | Tr=0.9595 Te/Cur=0.9564 Te/Exp=0.8631] 80%|████████  | 16/20 [01:37<00:22,  5.60s/it, CE=3.653446e-01 H=3.652224e-01 dV_dx=-3.251558e-05 dV_dθ=-8.965707e-05 ||∇||=5.326086e-01 | Tr=0.9609]                            85%|████████▌ | 17/20 [01:37<00:16,  5.47s/it, CE=3.653446e-01 H=3.652224e-01 dV_dx=-3.251558e-05 dV_dθ=-8.965707e-05 ||∇||=5.326086e-01 | Tr=0.9609] 85%|████████▌ | 17/20 [01:41<00:16,  5.47s/it, CE=3.631334e-01 H=3.630383e-01 dV_dx=-2.457491e-06 dV_dθ=-9.269586e-05 ||∇||=5.295718e-01 | Tr=0.9624] 90%|█████████ | 18/20 [01:41<00:10,  5.10s/it, CE=3.631334e-01 H=3.630383e-01 dV_dx=-2.457491e-06 dV_dθ=-9.269586e-05 ||∇||=5.295718e-01 | Tr=0.9624] 90%|█████████ | 18/20 [01:44<00:10,  5.10s/it, CE=3.608964e-01 H=3.607904e-01 dV_dx=-1.491336e-05 dV_dθ=-9.108673e-05 ||∇||=5.274270e-01 | Tr=0.9635] 95%|█████████▌| 19/20 [01:44<00:04,  4.57s/it, CE=3.608964e-01 H=3.607904e-01 dV_dx=-1.491336e-05 dV_dθ=-9.108673e-05 ||∇||=5.274270e-01 | Tr=0.9635] 95%|█████████▌| 19/20 [01:47<00:04,  4.57s/it, CE=3.587581e-01 H=3.586824e-01 dV_dx=1.467567e-05 dV_dθ=-9.046367e-05 ||∇||=5.220064e-01 | Tr=0.9648 Te/Cur=0.9614 Te/Exp=0.8604]100%|██████████| 20/20 [01:47<00:00,  4.20s/it, CE=3.587581e-01 H=3.586824e-01 dV_dx=1.467567e-05 dV_dθ=-9.046367e-05 ||∇||=5.220064e-01 | Tr=0.9648 Te/Cur=0.9614 Te/Exp=0.8604]100%|██████████| 20/20 [01:47<00:00,  5.40s/it, CE=3.587581e-01 H=3.586824e-01 dV_dx=1.467567e-05 dV_dθ=-9.046367e-05 ||∇||=5.220064e-01 | Tr=0.9648 Te/Cur=0.9614 Te/Exp=0.8604]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7764
    Task 1: 0.9487
    Task 2: 0.8400
    Task 3: 0.5715
    Task 4: 0.9464
    Task 5: 0.9301
    Task 6: 0.9245
    Task 7: 0.9354
    Task 8: 0.9135
    Task 9: 0.9620
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run0/mnist_condition1_baseline_run0_run0/classification_mnist_cnn_run0_records.pkl

Training complete!
