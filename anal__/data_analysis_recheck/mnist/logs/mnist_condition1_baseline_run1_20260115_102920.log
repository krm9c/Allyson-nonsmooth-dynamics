JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition1_baseline.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: False

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run1
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run1/mnist_condition1_baseline_run1


############################################################
# Run ID: 1
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:18<06:00, 18.99s/it]  5%|▌         | 1/20 [00:24<06:00, 18.99s/it, CE=2.068727e+00 H=2.068310e+00 dV_dx=-8.278585e-08 dV_dθ=-4.178367e-04 ||∇||=4.480012e-01 | Tr=0.4087] 10%|█         | 2/20 [00:24<03:14, 10.79s/it, CE=2.068727e+00 H=2.068310e+00 dV_dx=-8.278585e-08 dV_dθ=-4.178367e-04 ||∇||=4.480012e-01 | Tr=0.4087] 10%|█         | 2/20 [00:29<03:14, 10.79s/it, CE=1.854144e+00 H=1.853335e+00 dV_dx=-4.653864e-07 dV_dθ=-8.086640e-04 ||∇||=6.194232e-01 | Tr=0.4854] 15%|█▌        | 3/20 [00:29<02:18,  8.15s/it, CE=1.854144e+00 H=1.853335e+00 dV_dx=-4.653864e-07 dV_dθ=-8.086640e-04 ||∇||=6.194232e-01 | Tr=0.4854] 15%|█▌        | 3/20 [00:33<02:18,  8.15s/it, CE=1.638901e+00 H=1.637871e+00 dV_dx=4.199876e-07 dV_dθ=-1.030362e-03 ||∇||=7.032807e-01 | Tr=0.5291]  20%|██        | 4/20 [00:33<01:48,  6.79s/it, CE=1.638901e+00 H=1.637871e+00 dV_dx=4.199876e-07 dV_dθ=-1.030362e-03 ||∇||=7.032807e-01 | Tr=0.5291] 20%|██        | 4/20 [00:38<01:48,  6.79s/it, CE=1.459121e+00 H=1.458145e+00 dV_dx=-3.612981e-07 dV_dθ=-9.759036e-04 ||∇||=6.942819e-01 | Tr=0.5604] 25%|██▌       | 5/20 [00:38<01:32,  6.14s/it, CE=1.459121e+00 H=1.458145e+00 dV_dx=-3.612981e-07 dV_dθ=-9.759036e-04 ||∇||=6.942819e-01 | Tr=0.5604] 25%|██▌       | 5/20 [00:46<01:32,  6.14s/it, CE=1.325468e+00 H=1.324645e+00 dV_dx=2.518708e-07 dV_dθ=-8.229880e-04 ||∇||=6.508143e-01 | Tr=0.5874 Te/Cur=0.5919 Te/Exp=0.5949] 30%|███       | 6/20 [00:46<01:32,  6.64s/it, CE=1.325468e+00 H=1.324645e+00 dV_dx=2.518708e-07 dV_dθ=-8.229880e-04 ||∇||=6.508143e-01 | Tr=0.5874 Te/Cur=0.5919 Te/Exp=0.5949] 30%|███       | 6/20 [00:51<01:32,  6.64s/it, CE=1.227752e+00 H=1.227076e+00 dV_dx=-2.021430e-06 dV_dθ=-6.746229e-04 ||∇||=6.044015e-01 | Tr=0.6070]                            35%|███▌      | 7/20 [00:51<01:19,  6.11s/it, CE=1.227752e+00 H=1.227076e+00 dV_dx=-2.021430e-06 dV_dθ=-6.746229e-04 ||∇||=6.044015e-01 | Tr=0.6070] 35%|███▌      | 7/20 [00:56<01:19,  6.11s/it, CE=1.154692e+00 H=1.154130e+00 dV_dx=-9.327259e-07 dV_dθ=-5.612130e-04 ||∇||=5.670394e-01 | Tr=0.6260] 40%|████      | 8/20 [00:56<01:09,  5.81s/it, CE=1.154692e+00 H=1.154130e+00 dV_dx=-9.327259e-07 dV_dθ=-5.612130e-04 ||∇||=5.670394e-01 | Tr=0.6260] 40%|████      | 8/20 [01:01<01:09,  5.81s/it, CE=1.097648e+00 H=1.097172e+00 dV_dx=2.322999e-06 dV_dθ=-4.782992e-04 ||∇||=5.384092e-01 | Tr=0.6423]  45%|████▌     | 9/20 [01:01<01:01,  5.58s/it, CE=1.097648e+00 H=1.097172e+00 dV_dx=2.322999e-06 dV_dθ=-4.782992e-04 ||∇||=5.384092e-01 | Tr=0.6423] 45%|████▌     | 9/20 [01:06<01:01,  5.58s/it, CE=1.051745e+00 H=1.051320e+00 dV_dx=-2.970601e-06 dV_dθ=-4.220017e-04 ||∇||=5.188569e-01 | Tr=0.6554] 50%|█████     | 10/20 [01:06<00:54,  5.46s/it, CE=1.051745e+00 H=1.051320e+00 dV_dx=-2.970601e-06 dV_dθ=-4.220017e-04 ||∇||=5.188569e-01 | Tr=0.6554] 50%|█████     | 10/20 [01:13<00:54,  5.46s/it, CE=1.013762e+00 H=1.013381e+00 dV_dx=1.583022e-06 dV_dθ=-3.823378e-04 ||∇||=5.056534e-01 | Tr=0.6676 Te/Cur=0.6709 Te/Exp=0.6664] 55%|█████▌    | 11/20 [01:13<00:52,  5.87s/it, CE=1.013762e+00 H=1.013381e+00 dV_dx=1.583022e-06 dV_dθ=-3.823378e-04 ||∇||=5.056534e-01 | Tr=0.6676 Te/Cur=0.6709 Te/Exp=0.6664] 55%|█████▌    | 11/20 [01:18<00:52,  5.87s/it, CE=9.812729e-01 H=9.809152e-01 dV_dx=2.535912e-06 dV_dθ=-3.602664e-04 ||∇||=4.981366e-01 | Tr=0.6777]                             60%|██████    | 12/20 [01:18<00:45,  5.67s/it, CE=9.812729e-01 H=9.809152e-01 dV_dx=2.535912e-06 dV_dθ=-3.602664e-04 ||∇||=4.981366e-01 | Tr=0.6777] 60%|██████    | 12/20 [01:23<00:45,  5.67s/it, CE=9.529210e-01 H=9.525798e-01 dV_dx=3.015338e-06 dV_dθ=-3.441903e-04 ||∇||=4.933984e-01 | Tr=0.6869] 65%|██████▌   | 13/20 [01:23<00:38,  5.45s/it, CE=9.529210e-01 H=9.525798e-01 dV_dx=3.015338e-06 dV_dθ=-3.441903e-04 ||∇||=4.933984e-01 | Tr=0.6869] 65%|██████▌   | 13/20 [01:29<00:38,  5.45s/it, CE=9.276042e-01 H=9.272671e-01 dV_dx=2.730929e-07 dV_dθ=-3.373339e-04 ||∇||=4.928026e-01 | Tr=0.6955] 70%|███████   | 14/20 [01:29<00:32,  5.42s/it, CE=9.276042e-01 H=9.272671e-01 dV_dx=2.730929e-07 dV_dθ=-3.373339e-04 ||∇||=4.928026e-01 | Tr=0.6955] 70%|███████   | 14/20 [01:34<00:32,  5.42s/it, CE=9.048624e-01 H=9.045174e-01 dV_dx=-1.435787e-06 dV_dθ=-3.435467e-04 ||∇||=4.978764e-01 | Tr=0.7018] 75%|███████▌  | 15/20 [01:34<00:26,  5.31s/it, CE=9.048624e-01 H=9.045174e-01 dV_dx=-1.435787e-06 dV_dθ=-3.435467e-04 ||∇||=4.978764e-01 | Tr=0.7018] 75%|███████▌  | 15/20 [01:40<00:26,  5.31s/it, CE=8.844545e-01 H=8.841152e-01 dV_dx=-2.007346e-06 dV_dθ=-3.373047e-04 ||∇||=4.979344e-01 | Tr=0.7085 Te/Cur=0.7094 Te/Exp=0.7082] 80%|████████  | 16/20 [01:40<00:22,  5.71s/it, CE=8.844545e-01 H=8.841152e-01 dV_dx=-2.007346e-06 dV_dθ=-3.373047e-04 ||∇||=4.979344e-01 | Tr=0.7085 Te/Cur=0.7094 Te/Exp=0.7082] 80%|████████  | 16/20 [01:45<00:22,  5.71s/it, CE=8.659546e-01 H=8.656179e-01 dV_dx=-1.838583e-06 dV_dθ=-3.347887e-04 ||∇||=4.988188e-01 | Tr=0.7143]                             85%|████████▌ | 17/20 [01:45<00:16,  5.49s/it, CE=8.659546e-01 H=8.656179e-01 dV_dx=-1.838583e-06 dV_dθ=-3.347887e-04 ||∇||=4.988188e-01 | Tr=0.7143] 85%|████████▌ | 17/20 [01:50<00:16,  5.49s/it, CE=8.489732e-01 H=8.486357e-01 dV_dx=-2.513487e-06 dV_dθ=-3.349640e-04 ||∇||=5.009152e-01 | Tr=0.7201] 90%|█████████ | 18/20 [01:50<00:10,  5.23s/it, CE=8.489732e-01 H=8.486357e-01 dV_dx=-2.513487e-06 dV_dθ=-3.349640e-04 ||∇||=5.009152e-01 | Tr=0.7201] 90%|█████████ | 18/20 [01:55<00:10,  5.23s/it, CE=8.332994e-01 H=8.329662e-01 dV_dx=2.343238e-06 dV_dθ=-3.355362e-04 ||∇||=5.034537e-01 | Tr=0.7252]  95%|█████████▌| 19/20 [01:55<00:05,  5.17s/it, CE=8.332994e-01 H=8.329662e-01 dV_dx=2.343238e-06 dV_dθ=-3.355362e-04 ||∇||=5.034537e-01 | Tr=0.7252] 95%|█████████▌| 19/20 [02:01<00:05,  5.17s/it, CE=8.187829e-01 H=8.184496e-01 dV_dx=-4.082312e-07 dV_dθ=-3.329097e-04 ||∇||=5.055938e-01 | Tr=0.7301 Te/Cur=0.7271 Te/Exp=0.7265]100%|██████████| 20/20 [02:01<00:00,  5.45s/it, CE=8.187829e-01 H=8.184496e-01 dV_dx=-4.082312e-07 dV_dθ=-3.329097e-04 ||∇||=5.055938e-01 | Tr=0.7301 Te/Cur=0.7271 Te/Exp=0.7265]100%|██████████| 20/20 [02:01<00:00,  6.08s/it, CE=8.187829e-01 H=8.184496e-01 dV_dx=-4.082312e-07 dV_dθ=-3.329097e-04 ||∇||=5.055938e-01 | Tr=0.7301 Te/Cur=0.7271 Te/Exp=0.7265]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7269

============================================================
Task 1
============================================================
Initial loss on new task: 6.0389, previous: 0.8188, ratio: 7.38
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.38)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<02:59,  9.47s/it]  5%|▌         | 1/20 [00:14<02:59,  9.47s/it, CE=8.655953e-01 H=8.652877e-01 dV_dx=1.689315e-05 dV_dθ=-3.244562e-04 ||∇||=7.579624e-01 | Tr=0.7863] 10%|█         | 2/20 [00:14<02:00,  6.68s/it, CE=8.655953e-01 H=8.652877e-01 dV_dx=1.689315e-05 dV_dθ=-3.244562e-04 ||∇||=7.579624e-01 | Tr=0.7863] 10%|█         | 2/20 [00:18<02:00,  6.68s/it, CE=8.485482e-01 H=8.483555e-01 dV_dx=1.282965e-05 dV_dθ=-2.055025e-04 ||∇||=6.357717e-01 | Tr=0.8368] 15%|█▌        | 3/20 [00:18<01:38,  5.81s/it, CE=8.485482e-01 H=8.483555e-01 dV_dx=1.282965e-05 dV_dθ=-2.055025e-04 ||∇||=6.357717e-01 | Tr=0.8368] 15%|█▌        | 3/20 [00:24<01:38,  5.81s/it, CE=8.355590e-01 H=8.353654e-01 dV_dx=-2.629670e-05 dV_dθ=-1.672220e-04 ||∇||=5.779453e-01 | Tr=0.8604] 20%|██        | 4/20 [00:24<01:28,  5.50s/it, CE=8.355590e-01 H=8.353654e-01 dV_dx=-2.629670e-05 dV_dθ=-1.672220e-04 ||∇||=5.779453e-01 | Tr=0.8604] 20%|██        | 4/20 [00:28<01:28,  5.50s/it, CE=8.250659e-01 H=8.249310e-01 dV_dx=8.799306e-06 dV_dθ=-1.437061e-04 ||∇||=5.427768e-01 | Tr=0.8738]  25%|██▌       | 5/20 [00:28<01:17,  5.16s/it, CE=8.250659e-01 H=8.249310e-01 dV_dx=8.799306e-06 dV_dθ=-1.437061e-04 ||∇||=5.427768e-01 | Tr=0.8738] 25%|██▌       | 5/20 [00:35<01:17,  5.16s/it, CE=8.171227e-01 H=8.170064e-01 dV_dx=1.416543e-05 dV_dθ=-1.304567e-04 ||∇||=5.205533e-01 | Tr=0.8836 Te/Cur=0.8878 Te/Exp=0.7283] 30%|███       | 6/20 [00:35<01:20,  5.74s/it, CE=8.171227e-01 H=8.170064e-01 dV_dx=1.416543e-05 dV_dθ=-1.304567e-04 ||∇||=5.205533e-01 | Tr=0.8836 Te/Cur=0.8878 Te/Exp=0.7283] 30%|███       | 6/20 [00:40<01:20,  5.74s/it, CE=8.104419e-01 H=8.102960e-01 dV_dx=-2.365033e-05 dV_dθ=-1.222333e-04 ||∇||=5.065164e-01 | Tr=0.8906]                            35%|███▌      | 7/20 [00:40<01:10,  5.42s/it, CE=8.104419e-01 H=8.102960e-01 dV_dx=-2.365033e-05 dV_dθ=-1.222333e-04 ||∇||=5.065164e-01 | Tr=0.8906] 35%|███▌      | 7/20 [00:45<01:10,  5.42s/it, CE=8.043970e-01 H=8.042660e-01 dV_dx=-1.440842e-05 dV_dθ=-1.165848e-04 ||∇||=4.959341e-01 | Tr=0.8950] 40%|████      | 8/20 [00:45<01:03,  5.27s/it, CE=8.043970e-01 H=8.042660e-01 dV_dx=-1.440842e-05 dV_dθ=-1.165848e-04 ||∇||=4.959341e-01 | Tr=0.8950] 40%|████      | 8/20 [00:50<01:03,  5.27s/it, CE=7.986620e-01 H=7.985315e-01 dV_dx=-1.907183e-05 dV_dθ=-1.113678e-04 ||∇||=4.868354e-01 | Tr=0.8995] 45%|████▌     | 9/20 [00:50<00:56,  5.16s/it, CE=7.986620e-01 H=7.985315e-01 dV_dx=-1.907183e-05 dV_dθ=-1.113678e-04 ||∇||=4.868354e-01 | Tr=0.8995] 45%|████▌     | 9/20 [00:54<00:56,  5.16s/it, CE=7.931853e-01 H=7.930989e-01 dV_dx=2.007690e-05 dV_dθ=-1.065186e-04 ||∇||=4.798231e-01 | Tr=0.9033]  50%|█████     | 10/20 [00:54<00:50,  5.10s/it, CE=7.931853e-01 H=7.930989e-01 dV_dx=2.007690e-05 dV_dθ=-1.065186e-04 ||∇||=4.798231e-01 | Tr=0.9033] 50%|█████     | 10/20 [01:01<00:50,  5.10s/it, CE=7.876586e-01 H=7.875444e-01 dV_dx=-1.113788e-05 dV_dθ=-1.030214e-04 ||∇||=4.744226e-01 | Tr=0.9068 Te/Cur=0.9077 Te/Exp=0.7354] 55%|█████▌    | 11/20 [01:01<00:49,  5.53s/it, CE=7.876586e-01 H=7.875444e-01 dV_dx=-1.113788e-05 dV_dθ=-1.030214e-04 ||∇||=4.744226e-01 | Tr=0.9068 Te/Cur=0.9077 Te/Exp=0.7354] 55%|█████▌    | 11/20 [01:06<00:49,  5.53s/it, CE=7.819403e-01 H=7.818799e-01 dV_dx=4.057998e-05 dV_dθ=-1.009823e-04 ||∇||=4.704019e-01 | Tr=0.9103]                              60%|██████    | 12/20 [01:06<00:42,  5.30s/it, CE=7.819403e-01 H=7.818799e-01 dV_dx=4.057998e-05 dV_dθ=-1.009823e-04 ||∇||=4.704019e-01 | Tr=0.9103] 60%|██████    | 12/20 [01:11<00:42,  5.30s/it, CE=7.758804e-01 H=7.757117e-01 dV_dx=-6.765115e-05 dV_dθ=-1.010597e-04 ||∇||=4.683407e-01 | Tr=0.9130] 65%|██████▌   | 13/20 [01:11<00:37,  5.29s/it, CE=7.758804e-01 H=7.757117e-01 dV_dx=-6.765115e-05 dV_dθ=-1.010597e-04 ||∇||=4.683407e-01 | Tr=0.9130] 65%|██████▌   | 13/20 [01:16<00:37,  5.29s/it, CE=7.696925e-01 H=7.696895e-01 dV_dx=9.827016e-05 dV_dθ=-1.013476e-04 ||∇||=4.664689e-01 | Tr=0.9159]  70%|███████   | 14/20 [01:16<00:30,  5.13s/it, CE=7.696925e-01 H=7.696895e-01 dV_dx=9.827016e-05 dV_dθ=-1.013476e-04 ||∇||=4.664689e-01 | Tr=0.9159] 70%|███████   | 14/20 [01:21<00:30,  5.13s/it, CE=7.642286e-01 H=7.641420e-01 dV_dx=1.259154e-05 dV_dθ=-9.918607e-05 ||∇||=4.630921e-01 | Tr=0.9185] 75%|███████▌  | 15/20 [01:21<00:25,  5.17s/it, CE=7.642286e-01 H=7.641420e-01 dV_dx=1.259154e-05 dV_dθ=-9.918607e-05 ||∇||=4.630921e-01 | Tr=0.9185] 75%|███████▌  | 15/20 [01:28<00:25,  5.17s/it, CE=7.591710e-01 H=7.590719e-01 dV_dx=-2.391244e-06 dV_dθ=-9.666890e-05 ||∇||=4.592401e-01 | Tr=0.9210 Te/Cur=0.9201 Te/Exp=0.7451] 80%|████████  | 16/20 [01:28<00:22,  5.60s/it, CE=7.591710e-01 H=7.590719e-01 dV_dx=-2.391244e-06 dV_dθ=-9.666890e-05 ||∇||=4.592401e-01 | Tr=0.9210 Te/Cur=0.9201 Te/Exp=0.7451] 80%|████████  | 16/20 [01:32<00:22,  5.60s/it, CE=7.542331e-01 H=7.541478e-01 dV_dx=9.510145e-06 dV_dθ=-9.478865e-05 ||∇||=4.561706e-01 | Tr=0.9231]                              85%|████████▌ | 17/20 [01:32<00:15,  5.30s/it, CE=7.542331e-01 H=7.541478e-01 dV_dx=9.510145e-06 dV_dθ=-9.478865e-05 ||∇||=4.561706e-01 | Tr=0.9231] 85%|████████▌ | 17/20 [01:37<00:15,  5.30s/it, CE=7.494062e-01 H=7.492830e-01 dV_dx=-3.026379e-05 dV_dθ=-9.297577e-05 ||∇||=4.534388e-01 | Tr=0.9251] 90%|█████████ | 18/20 [01:37<00:10,  5.24s/it, CE=7.494062e-01 H=7.492830e-01 dV_dx=-3.026379e-05 dV_dθ=-9.297577e-05 ||∇||=4.534388e-01 | Tr=0.9251] 90%|█████████ | 18/20 [01:43<00:10,  5.24s/it, CE=7.447161e-01 H=7.446088e-01 dV_dx=-1.500557e-05 dV_dθ=-9.230916e-05 ||∇||=4.515071e-01 | Tr=0.9278] 95%|█████████▌| 19/20 [01:43<00:05,  5.24s/it, CE=7.447161e-01 H=7.446088e-01 dV_dx=-1.500557e-05 dV_dθ=-9.230916e-05 ||∇||=4.515071e-01 | Tr=0.9278] 95%|█████████▌| 19/20 [01:49<00:05,  5.24s/it, CE=7.401094e-01 H=7.400331e-01 dV_dx=1.699506e-05 dV_dθ=-9.324608e-05 ||∇||=4.505337e-01 | Tr=0.9294 Te/Cur=0.9270 Te/Exp=0.7528]100%|██████████| 20/20 [01:49<00:00,  5.62s/it, CE=7.401094e-01 H=7.400331e-01 dV_dx=1.699506e-05 dV_dθ=-9.324608e-05 ||∇||=4.505337e-01 | Tr=0.9294 Te/Cur=0.9270 Te/Exp=0.7528]100%|██████████| 20/20 [01:49<00:00,  5.48s/it, CE=7.401094e-01 H=7.400331e-01 dV_dx=1.699506e-05 dV_dθ=-9.324608e-05 ||∇||=4.505337e-01 | Tr=0.9294 Te/Cur=0.9270 Te/Exp=0.7528]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.7527
    Task 1: 0.9271

============================================================
Task 2
============================================================
Initial loss on new task: 4.6884, previous: 0.7401, ratio: 6.33
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=6.33)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:17, 10.41s/it]  5%|▌         | 1/20 [00:15<03:17, 10.41s/it, CE=6.642848e-01 H=6.660191e-01 dV_dx=-8.731654e-06 dV_dθ=1.742992e-03 ||∇||=7.995793e-01 | Tr=0.6367] 10%|█         | 2/20 [00:15<02:07,  7.11s/it, CE=6.642848e-01 H=6.660191e-01 dV_dx=-8.731654e-06 dV_dθ=1.742992e-03 ||∇||=7.995793e-01 | Tr=0.6367] 10%|█         | 2/20 [00:18<02:07,  7.11s/it, CE=6.250712e-01 H=6.261053e-01 dV_dx=9.531854e-06 dV_dθ=1.024525e-03 ||∇||=7.024296e-01 | Tr=0.6886]  15%|█▌        | 3/20 [00:18<01:34,  5.58s/it, CE=6.250712e-01 H=6.261053e-01 dV_dx=9.531854e-06 dV_dθ=1.024525e-03 ||∇||=7.024296e-01 | Tr=0.6886] 15%|█▌        | 3/20 [00:22<01:34,  5.58s/it, CE=6.026384e-01 H=6.032224e-01 dV_dx=-1.818362e-05 dV_dθ=6.021683e-04 ||∇||=6.756686e-01 | Tr=0.7196] 20%|██        | 4/20 [00:22<01:17,  4.82s/it, CE=6.026384e-01 H=6.032224e-01 dV_dx=-1.818362e-05 dV_dθ=6.021683e-04 ||∇||=6.756686e-01 | Tr=0.7196] 20%|██        | 4/20 [00:27<01:17,  4.82s/it, CE=5.881212e-01 H=5.884418e-01 dV_dx=-4.865199e-05 dV_dθ=3.692102e-04 ||∇||=6.608362e-01 | Tr=0.7402] 25%|██▌       | 5/20 [00:27<01:12,  4.81s/it, CE=5.881212e-01 H=5.884418e-01 dV_dx=-4.865199e-05 dV_dθ=3.692102e-04 ||∇||=6.608362e-01 | Tr=0.7402] 25%|██▌       | 5/20 [00:33<01:12,  4.81s/it, CE=5.787067e-01 H=5.788982e-01 dV_dx=-2.977199e-05 dV_dθ=2.212704e-04 ||∇||=6.498573e-01 | Tr=0.7555 Te/Cur=0.7588 Te/Exp=0.8098] 30%|███       | 6/20 [00:33<01:15,  5.36s/it, CE=5.787067e-01 H=5.788982e-01 dV_dx=-2.977199e-05 dV_dθ=2.212704e-04 ||∇||=6.498573e-01 | Tr=0.7555 Te/Cur=0.7588 Te/Exp=0.8098] 30%|███       | 6/20 [00:38<01:15,  5.36s/it, CE=5.715000e-01 H=5.716723e-01 dV_dx=4.178052e-05 dV_dθ=1.305253e-04 ||∇||=6.422913e-01 | Tr=0.7670]                              35%|███▌      | 7/20 [00:38<01:08,  5.25s/it, CE=5.715000e-01 H=5.716723e-01 dV_dx=4.178052e-05 dV_dθ=1.305253e-04 ||∇||=6.422913e-01 | Tr=0.7670] 35%|███▌      | 7/20 [00:43<01:08,  5.25s/it, CE=5.654101e-01 H=5.654826e-01 dV_dx=5.494799e-06 dV_dθ=6.707011e-05 ||∇||=6.368522e-01 | Tr=0.7762] 40%|████      | 8/20 [00:43<01:02,  5.18s/it, CE=5.654101e-01 H=5.654826e-01 dV_dx=5.494799e-06 dV_dθ=6.707011e-05 ||∇||=6.368522e-01 | Tr=0.7762] 40%|████      | 8/20 [00:48<01:02,  5.18s/it, CE=5.599348e-01 H=5.599768e-01 dV_dx=2.291220e-05 dV_dθ=1.905612e-05 ||∇||=6.351499e-01 | Tr=0.7846] 45%|████▌     | 9/20 [00:48<00:56,  5.13s/it, CE=5.599348e-01 H=5.599768e-01 dV_dx=2.291220e-05 dV_dθ=1.905612e-05 ||∇||=6.351499e-01 | Tr=0.7846] 45%|████▌     | 9/20 [00:53<00:56,  5.13s/it, CE=5.547459e-01 H=5.547364e-01 dV_dx=4.748046e-06 dV_dθ=-1.417764e-05 ||∇||=6.311646e-01 | Tr=0.7909] 50%|█████     | 10/20 [00:53<00:49,  4.99s/it, CE=5.547459e-01 H=5.547364e-01 dV_dx=4.748046e-06 dV_dθ=-1.417764e-05 ||∇||=6.311646e-01 | Tr=0.7909] 50%|█████     | 10/20 [01:00<00:49,  4.99s/it, CE=5.497961e-01 H=5.497627e-01 dV_dx=1.799868e-06 dV_dθ=-3.519936e-05 ||∇||=6.273848e-01 | Tr=0.7958 Te/Cur=0.7966 Te/Exp=0.8226] 55%|█████▌    | 11/20 [01:00<00:50,  5.58s/it, CE=5.497961e-01 H=5.497627e-01 dV_dx=1.799868e-06 dV_dθ=-3.519936e-05 ||∇||=6.273848e-01 | Tr=0.7958 Te/Cur=0.7966 Te/Exp=0.8226] 55%|█████▌    | 11/20 [01:05<00:50,  5.58s/it, CE=5.452087e-01 H=5.451321e-01 dV_dx=-1.982178e-05 dV_dθ=-5.683673e-05 ||∇||=6.250646e-01 | Tr=0.8011]                            60%|██████    | 12/20 [01:05<00:42,  5.36s/it, CE=5.452087e-01 H=5.451321e-01 dV_dx=-1.982178e-05 dV_dθ=-5.683673e-05 ||∇||=6.250646e-01 | Tr=0.8011] 60%|██████    | 12/20 [01:10<00:42,  5.36s/it, CE=5.407192e-01 H=5.406286e-01 dV_dx=-2.059238e-05 dV_dθ=-7.001686e-05 ||∇||=6.219253e-01 | Tr=0.8051] 65%|██████▌   | 13/20 [01:10<00:36,  5.24s/it, CE=5.407192e-01 H=5.406286e-01 dV_dx=-2.059238e-05 dV_dθ=-7.001686e-05 ||∇||=6.219253e-01 | Tr=0.8051] 65%|██████▌   | 13/20 [01:15<00:36,  5.24s/it, CE=5.364229e-01 H=5.363702e-01 dV_dx=3.203818e-05 dV_dθ=-8.473230e-05 ||∇||=6.214896e-01 | Tr=0.8096]  70%|███████   | 14/20 [01:15<00:30,  5.10s/it, CE=5.364229e-01 H=5.363702e-01 dV_dx=3.203818e-05 dV_dθ=-8.473230e-05 ||∇||=6.214896e-01 | Tr=0.8096] 70%|███████   | 14/20 [01:19<00:30,  5.10s/it, CE=5.322751e-01 H=5.321698e-01 dV_dx=-8.133160e-06 dV_dθ=-9.719070e-05 ||∇||=6.187927e-01 | Tr=0.8139] 75%|███████▌  | 15/20 [01:19<00:24,  4.99s/it, CE=5.322751e-01 H=5.321698e-01 dV_dx=-8.133160e-06 dV_dθ=-9.719070e-05 ||∇||=6.187927e-01 | Tr=0.8139] 75%|███████▌  | 15/20 [01:26<00:24,  4.99s/it, CE=5.282993e-01 H=5.282093e-01 dV_dx=1.350433e-05 dV_dθ=-1.035122e-04 ||∇||=6.160283e-01 | Tr=0.8176 Te/Cur=0.8139 Te/Exp=0.8235] 80%|████████  | 16/20 [01:26<00:22,  5.55s/it, CE=5.282993e-01 H=5.282093e-01 dV_dx=1.350433e-05 dV_dθ=-1.035122e-04 ||∇||=6.160283e-01 | Tr=0.8176 Te/Cur=0.8139 Te/Exp=0.8235] 80%|████████  | 16/20 [01:31<00:22,  5.55s/it, CE=5.244040e-01 H=5.242870e-01 dV_dx=-8.171282e-06 dV_dθ=-1.088093e-04 ||∇||=6.132185e-01 | Tr=0.8211]                            85%|████████▌ | 17/20 [01:31<00:16,  5.34s/it, CE=5.244040e-01 H=5.242870e-01 dV_dx=-8.171282e-06 dV_dθ=-1.088093e-04 ||∇||=6.132185e-01 | Tr=0.8211] 85%|████████▌ | 17/20 [01:36<00:16,  5.34s/it, CE=5.206179e-01 H=5.205040e-01 dV_dx=6.322386e-06 dV_dθ=-1.202403e-04 ||∇||=6.145635e-01 | Tr=0.8235]  90%|█████████ | 18/20 [01:36<00:10,  5.22s/it, CE=5.206179e-01 H=5.205040e-01 dV_dx=6.322386e-06 dV_dθ=-1.202403e-04 ||∇||=6.145635e-01 | Tr=0.8235] 90%|█████████ | 18/20 [01:41<00:10,  5.22s/it, CE=5.167778e-01 H=5.166454e-01 dV_dx=-3.678729e-06 dV_dθ=-1.286280e-04 ||∇||=6.146919e-01 | Tr=0.8267] 95%|█████████▌| 19/20 [01:41<00:05,  5.13s/it, CE=5.167778e-01 H=5.166454e-01 dV_dx=-3.678729e-06 dV_dθ=-1.286280e-04 ||∇||=6.146919e-01 | Tr=0.8267] 95%|█████████▌| 19/20 [01:47<00:05,  5.13s/it, CE=5.129996e-01 H=5.128540e-01 dV_dx=-1.093451e-05 dV_dθ=-1.347008e-04 ||∇||=6.145284e-01 | Tr=0.8288 Te/Cur=0.8215 Te/Exp=0.8296]100%|██████████| 20/20 [01:47<00:00,  5.53s/it, CE=5.129996e-01 H=5.128540e-01 dV_dx=-1.093451e-05 dV_dθ=-1.347008e-04 ||∇||=6.145284e-01 | Tr=0.8288 Te/Cur=0.8215 Te/Exp=0.8296]100%|██████████| 20/20 [01:47<00:00,  5.39s/it, CE=5.129996e-01 H=5.128540e-01 dV_dx=-1.093451e-05 dV_dθ=-1.347008e-04 ||∇||=6.145284e-01 | Tr=0.8288 Te/Cur=0.8215 Te/Exp=0.8296]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.7225
    Task 1: 0.9312
    Task 2: 0.8229

============================================================
Task 3
============================================================
Initial loss on new task: 4.1444, previous: 0.5130, ratio: 8.08
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=8.08)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:35, 11.37s/it]  5%|▌         | 1/20 [00:15<03:35, 11.37s/it, CE=5.626757e-01 H=5.625006e-01 dV_dx=2.580905e-05 dV_dθ=-2.009095e-04 ||∇||=8.682005e-01 | Tr=0.4347] 10%|█         | 2/20 [00:15<02:11,  7.33s/it, CE=5.626757e-01 H=5.625006e-01 dV_dx=2.580905e-05 dV_dθ=-2.009095e-04 ||∇||=8.682005e-01 | Tr=0.4347] 10%|█         | 2/20 [00:20<02:11,  7.33s/it, CE=5.459392e-01 H=5.458074e-01 dV_dx=7.927775e-06 dV_dθ=-1.397347e-04 ||∇||=7.397186e-01 | Tr=0.4729] 15%|█▌        | 3/20 [00:20<01:45,  6.21s/it, CE=5.459392e-01 H=5.458074e-01 dV_dx=7.927775e-06 dV_dθ=-1.397347e-04 ||∇||=7.397186e-01 | Tr=0.4729] 15%|█▌        | 3/20 [00:25<01:45,  6.21s/it, CE=5.368129e-01 H=5.365972e-01 dV_dx=-2.851164e-05 dV_dθ=-1.872049e-04 ||∇||=7.232354e-01 | Tr=0.4929] 20%|██        | 4/20 [00:25<01:30,  5.67s/it, CE=5.368129e-01 H=5.365972e-01 dV_dx=-2.851164e-05 dV_dθ=-1.872049e-04 ||∇||=7.232354e-01 | Tr=0.4929] 20%|██        | 4/20 [00:30<01:30,  5.67s/it, CE=5.306273e-01 H=5.304302e-01 dV_dx=7.399190e-06 dV_dθ=-2.044752e-04 ||∇||=7.154572e-01 | Tr=0.5038]  25%|██▌       | 5/20 [00:30<01:18,  5.23s/it, CE=5.306273e-01 H=5.304302e-01 dV_dx=7.399190e-06 dV_dθ=-2.044752e-04 ||∇||=7.154572e-01 | Tr=0.5038] 25%|██▌       | 5/20 [00:36<01:18,  5.23s/it, CE=5.259290e-01 H=5.257411e-01 dV_dx=2.453074e-05 dV_dθ=-2.124356e-04 ||∇||=7.081883e-01 | Tr=0.5124 Te/Cur=0.5080 Te/Exp=0.8255] 30%|███       | 6/20 [00:36<01:19,  5.66s/it, CE=5.259290e-01 H=5.257411e-01 dV_dx=2.453074e-05 dV_dθ=-2.124356e-04 ||∇||=7.081883e-01 | Tr=0.5124 Te/Cur=0.5080 Te/Exp=0.8255] 30%|███       | 6/20 [00:41<01:19,  5.66s/it, CE=5.219894e-01 H=5.217525e-01 dV_dx=-1.910616e-05 dV_dθ=-2.177961e-04 ||∇||=7.043173e-01 | Tr=0.5180]                            35%|███▌      | 7/20 [00:41<01:10,  5.42s/it, CE=5.219894e-01 H=5.217525e-01 dV_dx=-1.910616e-05 dV_dθ=-2.177961e-04 ||∇||=7.043173e-01 | Tr=0.5180] 35%|███▌      | 7/20 [00:46<01:10,  5.42s/it, CE=5.183961e-01 H=5.182008e-01 dV_dx=3.057812e-05 dV_dθ=-2.257920e-04 ||∇||=7.037350e-01 | Tr=0.5242]  40%|████      | 8/20 [00:46<01:03,  5.30s/it, CE=5.183961e-01 H=5.182008e-01 dV_dx=3.057812e-05 dV_dθ=-2.257920e-04 ||∇||=7.037350e-01 | Tr=0.5242] 40%|████      | 8/20 [00:51<01:03,  5.30s/it, CE=5.150849e-01 H=5.148231e-01 dV_dx=-3.155197e-05 dV_dθ=-2.301892e-04 ||∇||=7.004055e-01 | Tr=0.5290] 45%|████▌     | 9/20 [00:51<00:57,  5.24s/it, CE=5.150849e-01 H=5.148231e-01 dV_dx=-3.155197e-05 dV_dθ=-2.301892e-04 ||∇||=7.004055e-01 | Tr=0.5290] 45%|████▌     | 9/20 [00:56<00:57,  5.24s/it, CE=5.120220e-01 H=5.118241e-01 dV_dx=3.760160e-05 dV_dθ=-2.354400e-04 ||∇||=6.996817e-01 | Tr=0.5332]  50%|█████     | 10/20 [00:56<00:51,  5.15s/it, CE=5.120220e-01 H=5.118241e-01 dV_dx=3.760160e-05 dV_dθ=-2.354400e-04 ||∇||=6.996817e-01 | Tr=0.5332] 50%|█████     | 10/20 [01:03<00:51,  5.15s/it, CE=5.090292e-01 H=5.087664e-01 dV_dx=-2.382074e-05 dV_dθ=-2.389910e-04 ||∇||=6.993813e-01 | Tr=0.5370 Te/Cur=0.5364 Te/Exp=0.8293] 55%|█████▌    | 11/20 [01:03<00:50,  5.57s/it, CE=5.090292e-01 H=5.087664e-01 dV_dx=-2.382074e-05 dV_dθ=-2.389910e-04 ||∇||=6.993813e-01 | Tr=0.5370 Te/Cur=0.5364 Te/Exp=0.8293] 55%|█████▌    | 11/20 [01:08<00:50,  5.57s/it, CE=5.062481e-01 H=5.060253e-01 dV_dx=1.907534e-05 dV_dθ=-2.418087e-04 ||∇||=7.008413e-01 | Tr=0.5402]                              60%|██████    | 12/20 [01:08<00:43,  5.43s/it, CE=5.062481e-01 H=5.060253e-01 dV_dx=1.907534e-05 dV_dθ=-2.418087e-04 ||∇||=7.008413e-01 | Tr=0.5402] 60%|██████    | 12/20 [01:13<00:43,  5.43s/it, CE=5.035909e-01 H=5.033870e-01 dV_dx=4.309996e-05 dV_dθ=-2.469935e-04 ||∇||=7.028831e-01 | Tr=0.5429] 65%|██████▌   | 13/20 [01:13<00:37,  5.30s/it, CE=5.035909e-01 H=5.033870e-01 dV_dx=4.309996e-05 dV_dθ=-2.469935e-04 ||∇||=7.028831e-01 | Tr=0.5429] 65%|██████▌   | 13/20 [01:18<00:37,  5.30s/it, CE=5.009086e-01 H=5.006467e-01 dV_dx=-1.207496e-05 dV_dθ=-2.498131e-04 ||∇||=7.039117e-01 | Tr=0.5464] 70%|███████   | 14/20 [01:18<00:31,  5.26s/it, CE=5.009086e-01 H=5.006467e-01 dV_dx=-1.207496e-05 dV_dθ=-2.498131e-04 ||∇||=7.039117e-01 | Tr=0.5464] 70%|███████   | 14/20 [01:23<00:31,  5.26s/it, CE=4.982858e-01 H=4.980474e-01 dV_dx=1.562895e-05 dV_dθ=-2.540272e-04 ||∇||=7.063827e-01 | Tr=0.5490]  75%|███████▌  | 15/20 [01:23<00:25,  5.13s/it, CE=4.982858e-01 H=4.980474e-01 dV_dx=1.562895e-05 dV_dθ=-2.540272e-04 ||∇||=7.063827e-01 | Tr=0.5490] 75%|███████▌  | 15/20 [01:29<00:25,  5.13s/it, CE=4.957397e-01 H=4.954768e-01 dV_dx=-5.638110e-06 dV_dθ=-2.572662e-04 ||∇||=7.075017e-01 | Tr=0.5518 Te/Cur=0.5506 Te/Exp=0.8381] 80%|████████  | 16/20 [01:29<00:22,  5.56s/it, CE=4.957397e-01 H=4.954768e-01 dV_dx=-5.638110e-06 dV_dθ=-2.572662e-04 ||∇||=7.075017e-01 | Tr=0.5518 Te/Cur=0.5506 Te/Exp=0.8381] 80%|████████  | 16/20 [01:34<00:22,  5.56s/it, CE=4.931743e-01 H=4.929254e-01 dV_dx=1.637448e-05 dV_dθ=-2.652818e-04 ||∇||=7.112038e-01 | Tr=0.5533]                              85%|████████▌ | 17/20 [01:34<00:16,  5.40s/it, CE=4.931743e-01 H=4.929254e-01 dV_dx=1.637448e-05 dV_dθ=-2.652818e-04 ||∇||=7.112038e-01 | Tr=0.5533] 85%|████████▌ | 17/20 [01:39<00:16,  5.40s/it, CE=4.907065e-01 H=4.904362e-01 dV_dx=4.846706e-07 dV_dθ=-2.707271e-04 ||∇||=7.145240e-01 | Tr=0.5553] 90%|█████████ | 18/20 [01:39<00:10,  5.30s/it, CE=4.907065e-01 H=4.904362e-01 dV_dx=4.846706e-07 dV_dθ=-2.707271e-04 ||∇||=7.145240e-01 | Tr=0.5553] 90%|█████████ | 18/20 [01:44<00:10,  5.30s/it, CE=4.882607e-01 H=4.879850e-01 dV_dx=-9.372439e-07 dV_dθ=-2.746817e-04 ||∇||=7.174213e-01 | Tr=0.5568] 95%|█████████▌| 19/20 [01:44<00:05,  5.18s/it, CE=4.882607e-01 H=4.879850e-01 dV_dx=-9.372439e-07 dV_dθ=-2.746817e-04 ||∇||=7.174213e-01 | Tr=0.5568] 95%|█████████▌| 19/20 [01:51<00:05,  5.18s/it, CE=4.858352e-01 H=4.855336e-01 dV_dx=-2.045468e-05 dV_dθ=-2.811307e-04 ||∇||=7.195065e-01 | Tr=0.5584 Te/Cur=0.5588 Te/Exp=0.8381]100%|██████████| 20/20 [01:51<00:00,  5.77s/it, CE=4.858352e-01 H=4.855336e-01 dV_dx=-2.045468e-05 dV_dθ=-2.811307e-04 ||∇||=7.195065e-01 | Tr=0.5584 Te/Cur=0.5588 Te/Exp=0.8381]100%|██████████| 20/20 [01:51<00:00,  5.59s/it, CE=4.858352e-01 H=4.855336e-01 dV_dx=-2.045468e-05 dV_dθ=-2.811307e-04 ||∇||=7.195065e-01 | Tr=0.5584 Te/Cur=0.5588 Te/Exp=0.8381]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.7408
    Task 1: 0.9372
    Task 2: 0.8226
    Task 3: 0.5558

============================================================
Task 4
============================================================
Initial loss on new task: 1.2286, previous: 0.4858, ratio: 2.53
Standard CL training (lr=0.000100, adaptive_lr_min=6.89e-05, loss_ratio=2.53)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:57, 12.48s/it]  5%|▌         | 1/20 [00:16<03:57, 12.48s/it, CE=7.344665e-01 H=7.344965e-01 dV_dx=1.755432e-05 dV_dθ=1.245576e-05 ||∇||=5.709651e-01 | Tr=0.9086] 10%|█         | 2/20 [00:16<02:11,  7.33s/it, CE=7.344665e-01 H=7.344965e-01 dV_dx=1.755432e-05 dV_dθ=1.245576e-05 ||∇||=5.709651e-01 | Tr=0.9086] 10%|█         | 2/20 [00:21<02:11,  7.33s/it, CE=7.263024e-01 H=7.263388e-01 dV_dx=2.382685e-05 dV_dθ=1.265427e-05 ||∇||=5.275842e-01 | Tr=0.9189] 15%|█▌        | 3/20 [00:21<01:46,  6.26s/it, CE=7.263024e-01 H=7.263388e-01 dV_dx=2.382685e-05 dV_dθ=1.265427e-05 ||∇||=5.275842e-01 | Tr=0.9189] 15%|█▌        | 3/20 [00:26<01:46,  6.26s/it, CE=7.207966e-01 H=7.208114e-01 dV_dx=2.646238e-06 dV_dθ=1.212510e-05 ||∇||=5.055580e-01 | Tr=0.9256] 20%|██        | 4/20 [00:26<01:32,  5.79s/it, CE=7.207966e-01 H=7.208114e-01 dV_dx=2.646238e-06 dV_dθ=1.212510e-05 ||∇||=5.055580e-01 | Tr=0.9256] 20%|██        | 4/20 [00:31<01:32,  5.79s/it, CE=7.160776e-01 H=7.160863e-01 dV_dx=5.441577e-06 dV_dθ=3.290291e-06 ||∇||=4.931602e-01 | Tr=0.9303] 25%|██▌       | 5/20 [00:31<01:22,  5.48s/it, CE=7.160776e-01 H=7.160863e-01 dV_dx=5.441577e-06 dV_dθ=3.290291e-06 ||∇||=4.931602e-01 | Tr=0.9303] 25%|██▌       | 5/20 [00:37<01:22,  5.48s/it, CE=7.117774e-01 H=7.117578e-01 dV_dx=-1.356161e-05 dV_dθ=-6.067531e-06 ||∇||=4.863622e-01 | Tr=0.9343 Te/Cur=0.9322 Te/Exp=0.7518] 30%|███       | 6/20 [00:37<01:19,  5.71s/it, CE=7.117774e-01 H=7.117578e-01 dV_dx=-1.356161e-05 dV_dθ=-6.067531e-06 ||∇||=4.863622e-01 | Tr=0.9343 Te/Cur=0.9322 Te/Exp=0.7518] 30%|███       | 6/20 [00:42<01:19,  5.71s/it, CE=7.077390e-01 H=7.077252e-01 dV_dx=-1.146295e-06 dV_dθ=-1.269019e-05 ||∇||=4.808183e-01 | Tr=0.9372]                             35%|███▌      | 7/20 [00:42<01:11,  5.52s/it, CE=7.077390e-01 H=7.077252e-01 dV_dx=-1.146295e-06 dV_dθ=-1.269019e-05 ||∇||=4.808183e-01 | Tr=0.9372] 35%|███▌      | 7/20 [00:47<01:11,  5.52s/it, CE=7.038409e-01 H=7.038171e-01 dV_dx=-5.580086e-06 dV_dθ=-1.820873e-05 ||∇||=4.760476e-01 | Tr=0.9399] 40%|████      | 8/20 [00:47<01:03,  5.32s/it, CE=7.038409e-01 H=7.038171e-01 dV_dx=-5.580086e-06 dV_dθ=-1.820873e-05 ||∇||=4.760476e-01 | Tr=0.9399] 40%|████      | 8/20 [00:52<01:03,  5.32s/it, CE=7.000828e-01 H=7.000142e-01 dV_dx=-4.358570e-05 dV_dθ=-2.495181e-05 ||∇||=4.731092e-01 | Tr=0.9421] 45%|████▌     | 9/20 [00:52<00:57,  5.24s/it, CE=7.000828e-01 H=7.000142e-01 dV_dx=-4.358570e-05 dV_dθ=-2.495181e-05 ||∇||=4.731092e-01 | Tr=0.9421] 45%|████▌     | 9/20 [00:57<00:57,  5.24s/it, CE=6.965082e-01 H=6.964620e-01 dV_dx=-1.577147e-05 dV_dθ=-3.045785e-05 ||∇||=4.698497e-01 | Tr=0.9442] 50%|█████     | 10/20 [00:57<00:52,  5.23s/it, CE=6.965082e-01 H=6.964620e-01 dV_dx=-1.577147e-05 dV_dθ=-3.045785e-05 ||∇||=4.698497e-01 | Tr=0.9442] 50%|█████     | 10/20 [01:04<00:52,  5.23s/it, CE=6.931198e-01 H=6.929990e-01 dV_dx=-8.520172e-05 dV_dθ=-3.557915e-05 ||∇||=4.682784e-01 | Tr=0.9460 Te/Cur=0.9428 Te/Exp=0.7569] 55%|█████▌    | 11/20 [01:04<00:51,  5.67s/it, CE=6.931198e-01 H=6.929990e-01 dV_dx=-8.520172e-05 dV_dθ=-3.557915e-05 ||∇||=4.682784e-01 | Tr=0.9460 Te/Cur=0.9428 Te/Exp=0.7569] 55%|█████▌    | 11/20 [01:09<00:51,  5.67s/it, CE=6.899040e-01 H=6.898999e-01 dV_dx=3.499277e-05 dV_dθ=-3.915868e-05 ||∇||=4.656655e-01 | Tr=0.9478]                              60%|██████    | 12/20 [01:09<00:43,  5.38s/it, CE=6.899040e-01 H=6.898999e-01 dV_dx=3.499277e-05 dV_dθ=-3.915868e-05 ||∇||=4.656655e-01 | Tr=0.9478] 60%|██████    | 12/20 [01:14<00:43,  5.38s/it, CE=6.868048e-01 H=6.867379e-01 dV_dx=-2.380582e-05 dV_dθ=-4.305400e-05 ||∇||=4.639220e-01 | Tr=0.9496] 65%|██████▌   | 13/20 [01:14<00:37,  5.32s/it, CE=6.868048e-01 H=6.867379e-01 dV_dx=-2.380582e-05 dV_dθ=-4.305400e-05 ||∇||=4.639220e-01 | Tr=0.9496] 65%|██████▌   | 13/20 [01:19<00:37,  5.32s/it, CE=6.838592e-01 H=6.838261e-01 dV_dx=1.276947e-05 dV_dθ=-4.594316e-05 ||∇||=4.615200e-01 | Tr=0.9515]  70%|███████   | 14/20 [01:19<00:31,  5.21s/it, CE=6.838592e-01 H=6.838261e-01 dV_dx=1.276947e-05 dV_dθ=-4.594316e-05 ||∇||=4.615200e-01 | Tr=0.9515] 70%|███████   | 14/20 [01:24<00:31,  5.21s/it, CE=6.809995e-01 H=6.809682e-01 dV_dx=1.798768e-05 dV_dθ=-4.926733e-05 ||∇||=4.602305e-01 | Tr=0.9526] 75%|███████▌  | 15/20 [01:24<00:25,  5.18s/it, CE=6.809995e-01 H=6.809682e-01 dV_dx=1.798768e-05 dV_dθ=-4.926733e-05 ||∇||=4.602305e-01 | Tr=0.9526] 75%|███████▌  | 15/20 [01:31<00:25,  5.18s/it, CE=6.782513e-01 H=6.782401e-01 dV_dx=4.055758e-05 dV_dθ=-5.168487e-05 ||∇||=4.582403e-01 | Tr=0.9540 Te/Cur=0.9498 Te/Exp=0.7605] 80%|████████  | 16/20 [01:31<00:22,  5.68s/it, CE=6.782513e-01 H=6.782401e-01 dV_dx=4.055758e-05 dV_dθ=-5.168487e-05 ||∇||=4.582403e-01 | Tr=0.9540 Te/Cur=0.9498 Te/Exp=0.7605] 80%|████████  | 16/20 [01:36<00:22,  5.68s/it, CE=6.756302e-01 H=6.755462e-01 dV_dx=-2.967619e-05 dV_dθ=-5.436669e-05 ||∇||=4.566892e-01 | Tr=0.9553]                            85%|████████▌ | 17/20 [01:36<00:16,  5.57s/it, CE=6.756302e-01 H=6.755462e-01 dV_dx=-2.967619e-05 dV_dθ=-5.436669e-05 ||∇||=4.566892e-01 | Tr=0.9553] 85%|████████▌ | 17/20 [01:41<00:16,  5.57s/it, CE=6.730871e-01 H=6.730406e-01 dV_dx=1.192709e-05 dV_dθ=-5.840104e-05 ||∇||=4.560999e-01 | Tr=0.9566]  90%|█████████ | 18/20 [01:41<00:10,  5.37s/it, CE=6.730871e-01 H=6.730406e-01 dV_dx=1.192709e-05 dV_dθ=-5.840104e-05 ||∇||=4.560999e-01 | Tr=0.9566] 90%|█████████ | 18/20 [01:45<00:10,  5.37s/it, CE=6.706593e-01 H=6.705570e-01 dV_dx=-4.099061e-05 dV_dθ=-6.126216e-05 ||∇||=4.549643e-01 | Tr=0.9579] 95%|█████████▌| 19/20 [01:45<00:05,  5.12s/it, CE=6.706593e-01 H=6.705570e-01 dV_dx=-4.099061e-05 dV_dθ=-6.126216e-05 ||∇||=4.549643e-01 | Tr=0.9579] 95%|█████████▌| 19/20 [01:52<00:05,  5.12s/it, CE=6.682536e-01 H=6.681579e-01 dV_dx=-3.220853e-05 dV_dθ=-6.343210e-05 ||∇||=4.535685e-01 | Tr=0.9589 Te/Cur=0.9551 Te/Exp=0.7707]100%|██████████| 20/20 [01:52<00:00,  5.52s/it, CE=6.682536e-01 H=6.681579e-01 dV_dx=-3.220853e-05 dV_dθ=-6.343210e-05 ||∇||=4.535685e-01 | Tr=0.9589 Te/Cur=0.9551 Te/Exp=0.7707]100%|██████████| 20/20 [01:52<00:00,  5.62s/it, CE=6.682536e-01 H=6.681579e-01 dV_dx=-3.220853e-05 dV_dθ=-6.343210e-05 ||∇||=4.535685e-01 | Tr=0.9589 Te/Cur=0.9551 Te/Exp=0.7707]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7542
    Task 1: 0.9261
    Task 2: 0.8310
    Task 3: 0.5526
    Task 4: 0.9555

============================================================
Task 5
============================================================
Initial loss on new task: 6.1846, previous: 0.6683, ratio: 9.25
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=9.25)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<04:05, 12.90s/it]  5%|▌         | 1/20 [00:17<04:05, 12.90s/it, CE=6.570345e-01 H=6.569117e-01 dV_dx=-5.617588e-05 dV_dθ=-6.666760e-05 ||∇||=7.539756e-01 | Tr=0.8469] 10%|█         | 2/20 [00:17<02:24,  8.02s/it, CE=6.570345e-01 H=6.569117e-01 dV_dx=-5.617588e-05 dV_dθ=-6.666760e-05 ||∇||=7.539756e-01 | Tr=0.8469] 10%|█         | 2/20 [00:21<02:24,  8.02s/it, CE=6.314190e-01 H=6.313014e-01 dV_dx=-6.994781e-05 dV_dθ=-4.756371e-05 ||∇||=6.231458e-01 | Tr=0.8829] 15%|█▌        | 3/20 [00:21<01:45,  6.23s/it, CE=6.314190e-01 H=6.313014e-01 dV_dx=-6.994781e-05 dV_dθ=-4.756371e-05 ||∇||=6.231458e-01 | Tr=0.8829] 15%|█▌        | 3/20 [00:26<01:45,  6.23s/it, CE=6.191796e-01 H=6.191462e-01 dV_dx=1.625148e-05 dV_dθ=-4.958214e-05 ||∇||=5.874181e-01 | Tr=0.8999]  20%|██        | 4/20 [00:26<01:30,  5.66s/it, CE=6.191796e-01 H=6.191462e-01 dV_dx=1.625148e-05 dV_dθ=-4.958214e-05 ||∇||=5.874181e-01 | Tr=0.8999] 20%|██        | 4/20 [00:31<01:30,  5.66s/it, CE=6.111875e-01 H=6.111609e-01 dV_dx=2.192630e-05 dV_dθ=-4.849115e-05 ||∇||=5.601025e-01 | Tr=0.9100] 25%|██▌       | 5/20 [00:31<01:22,  5.50s/it, CE=6.111875e-01 H=6.111609e-01 dV_dx=2.192630e-05 dV_dθ=-4.849115e-05 ||∇||=5.601025e-01 | Tr=0.9100] 25%|██▌       | 5/20 [00:37<01:22,  5.50s/it, CE=6.052132e-01 H=6.051217e-01 dV_dx=-4.571883e-05 dV_dθ=-4.575983e-05 ||∇||=5.383804e-01 | Tr=0.9182 Te/Cur=0.9139 Te/Exp=0.7947] 30%|███       | 6/20 [00:37<01:20,  5.72s/it, CE=6.052132e-01 H=6.051217e-01 dV_dx=-4.571883e-05 dV_dθ=-4.575983e-05 ||∇||=5.383804e-01 | Tr=0.9182 Te/Cur=0.9139 Te/Exp=0.7947] 30%|███       | 6/20 [00:42<01:20,  5.72s/it, CE=6.006811e-01 H=6.006393e-01 dV_dx=2.888557e-06 dV_dθ=-4.475915e-05 ||∇||=5.248090e-01 | Tr=0.9236]                              35%|███▌      | 7/20 [00:42<01:08,  5.26s/it, CE=6.006811e-01 H=6.006393e-01 dV_dx=2.888557e-06 dV_dθ=-4.475915e-05 ||∇||=5.248090e-01 | Tr=0.9236] 35%|███▌      | 7/20 [00:46<01:08,  5.26s/it, CE=5.969894e-01 H=5.969123e-01 dV_dx=-3.483374e-05 dV_dθ=-4.222290e-05 ||∇||=5.126195e-01 | Tr=0.9282] 40%|████      | 8/20 [00:46<01:01,  5.10s/it, CE=5.969894e-01 H=5.969123e-01 dV_dx=-3.483374e-05 dV_dθ=-4.222290e-05 ||∇||=5.126195e-01 | Tr=0.9282] 40%|████      | 8/20 [00:51<01:01,  5.10s/it, CE=5.938389e-01 H=5.938012e-01 dV_dx=4.803580e-06 dV_dθ=-4.254804e-05 ||∇||=5.039206e-01 | Tr=0.9325]  45%|████▌     | 9/20 [00:51<00:55,  5.03s/it, CE=5.938389e-01 H=5.938012e-01 dV_dx=4.803580e-06 dV_dθ=-4.254804e-05 ||∇||=5.039206e-01 | Tr=0.9325] 45%|████▌     | 9/20 [00:56<00:55,  5.03s/it, CE=5.909467e-01 H=5.908767e-01 dV_dx=-2.853277e-05 dV_dθ=-4.152860e-05 ||∇||=4.948511e-01 | Tr=0.9360] 50%|█████     | 10/20 [00:56<00:49,  4.91s/it, CE=5.909467e-01 H=5.908767e-01 dV_dx=-2.853277e-05 dV_dθ=-4.152860e-05 ||∇||=4.948511e-01 | Tr=0.9360] 50%|█████     | 10/20 [01:03<00:49,  4.91s/it, CE=5.882791e-01 H=5.882061e-01 dV_dx=-3.218197e-05 dV_dθ=-4.076441e-05 ||∇||=4.874692e-01 | Tr=0.9386 Te/Cur=0.9340 Te/Exp=0.8073] 55%|█████▌    | 11/20 [01:03<00:49,  5.48s/it, CE=5.882791e-01 H=5.882061e-01 dV_dx=-3.218197e-05 dV_dθ=-4.076441e-05 ||∇||=4.874692e-01 | Tr=0.9386 Te/Cur=0.9340 Te/Exp=0.8073] 55%|█████▌    | 11/20 [01:08<00:49,  5.48s/it, CE=5.858408e-01 H=5.857973e-01 dV_dx=-3.470300e-06 dV_dθ=-3.999590e-05 ||∇||=4.816821e-01 | Tr=0.9414]                             60%|██████    | 12/20 [01:08<00:42,  5.35s/it, CE=5.858408e-01 H=5.857973e-01 dV_dx=-3.470300e-06 dV_dθ=-3.999590e-05 ||∇||=4.816821e-01 | Tr=0.9414] 60%|██████    | 12/20 [01:13<00:42,  5.35s/it, CE=5.835310e-01 H=5.834907e-01 dV_dx=6.810129e-07 dV_dθ=-4.092543e-05 ||∇||=4.773991e-01 | Tr=0.9437]  65%|██████▌   | 13/20 [01:13<00:36,  5.22s/it, CE=5.835310e-01 H=5.834907e-01 dV_dx=6.810129e-07 dV_dθ=-4.092543e-05 ||∇||=4.773991e-01 | Tr=0.9437] 65%|██████▌   | 13/20 [01:17<00:36,  5.22s/it, CE=5.812954e-01 H=5.812956e-01 dV_dx=4.104501e-05 dV_dθ=-4.085509e-05 ||∇||=4.725730e-01 | Tr=0.9458] 70%|███████   | 14/20 [01:17<00:30,  5.00s/it, CE=5.812954e-01 H=5.812956e-01 dV_dx=4.104501e-05 dV_dθ=-4.085509e-05 ||∇||=4.725730e-01 | Tr=0.9458] 70%|███████   | 14/20 [01:22<00:30,  5.00s/it, CE=5.791718e-01 H=5.791497e-01 dV_dx=1.802983e-05 dV_dθ=-4.007708e-05 ||∇||=4.681640e-01 | Tr=0.9475] 75%|███████▌  | 15/20 [01:22<00:24,  4.96s/it, CE=5.791718e-01 H=5.791497e-01 dV_dx=1.802983e-05 dV_dθ=-4.007708e-05 ||∇||=4.681640e-01 | Tr=0.9475] 75%|███████▌  | 15/20 [01:29<00:24,  4.96s/it, CE=5.771092e-01 H=5.771546e-01 dV_dx=8.631268e-05 dV_dθ=-4.084820e-05 ||∇||=4.646175e-01 | Tr=0.9493 Te/Cur=0.9436 Te/Exp=0.8075] 80%|████████  | 16/20 [01:29<00:21,  5.50s/it, CE=5.771092e-01 H=5.771546e-01 dV_dx=8.631268e-05 dV_dθ=-4.084820e-05 ||∇||=4.646175e-01 | Tr=0.9493 Te/Cur=0.9436 Te/Exp=0.8075] 80%|████████  | 16/20 [01:34<00:21,  5.50s/it, CE=5.751012e-01 H=5.750779e-01 dV_dx=1.856815e-05 dV_dθ=-4.183517e-05 ||∇||=4.611180e-01 | Tr=0.9513]                             85%|████████▌ | 17/20 [01:34<00:16,  5.45s/it, CE=5.751012e-01 H=5.750779e-01 dV_dx=1.856815e-05 dV_dθ=-4.183517e-05 ||∇||=4.611180e-01 | Tr=0.9513] 85%|████████▌ | 17/20 [01:39<00:16,  5.45s/it, CE=5.731429e-01 H=5.730480e-01 dV_dx=-5.239203e-05 dV_dθ=-4.245686e-05 ||∇||=4.582313e-01 | Tr=0.9527] 90%|█████████ | 18/20 [01:39<00:10,  5.18s/it, CE=5.731429e-01 H=5.730480e-01 dV_dx=-5.239203e-05 dV_dθ=-4.245686e-05 ||∇||=4.582313e-01 | Tr=0.9527] 90%|█████████ | 18/20 [01:43<00:10,  5.18s/it, CE=5.712494e-01 H=5.711412e-01 dV_dx=-6.417374e-05 dV_dθ=-4.409999e-05 ||∇||=4.561753e-01 | Tr=0.9542] 95%|█████████▌| 19/20 [01:43<00:04,  4.84s/it, CE=5.712494e-01 H=5.711412e-01 dV_dx=-6.417374e-05 dV_dθ=-4.409999e-05 ||∇||=4.561753e-01 | Tr=0.9542] 95%|█████████▌| 19/20 [01:50<00:04,  4.84s/it, CE=5.694110e-01 H=5.692758e-01 dV_dx=-9.108661e-05 dV_dθ=-4.407518e-05 ||∇||=4.537976e-01 | Tr=0.9560 Te/Cur=0.9491 Te/Exp=0.7988]100%|██████████| 20/20 [01:50<00:00,  5.54s/it, CE=5.694110e-01 H=5.692758e-01 dV_dx=-9.108661e-05 dV_dθ=-4.407518e-05 ||∇||=4.537976e-01 | Tr=0.9560 Te/Cur=0.9491 Te/Exp=0.7988]100%|██████████| 20/20 [01:50<00:00,  5.51s/it, CE=5.694110e-01 H=5.692758e-01 dV_dx=-9.108661e-05 dV_dθ=-4.407518e-05 ||∇||=4.537976e-01 | Tr=0.9560 Te/Cur=0.9491 Te/Exp=0.7988]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7629
    Task 1: 0.9405
    Task 2: 0.8326
    Task 3: 0.5582
    Task 4: 0.9393
    Task 5: 0.9496

============================================================
Task 6
============================================================
Initial loss on new task: 6.3710, previous: 0.5694, ratio: 11.19
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=11.19)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:45, 11.86s/it]  5%|▌         | 1/20 [00:16<03:45, 11.86s/it, CE=5.472203e-01 H=5.471745e-01 dV_dx=-1.812993e-05 dV_dθ=-2.771753e-05 ||∇||=8.099690e-01 | Tr=0.8352] 10%|█         | 2/20 [00:16<02:13,  7.42s/it, CE=5.472203e-01 H=5.471745e-01 dV_dx=-1.812993e-05 dV_dθ=-2.771753e-05 ||∇||=8.099690e-01 | Tr=0.8352] 10%|█         | 2/20 [00:20<02:13,  7.42s/it, CE=5.356011e-01 H=5.355806e-01 dV_dx=9.444998e-06 dV_dθ=-2.990908e-05 ||∇||=6.889626e-01 | Tr=0.8727]  15%|█▌        | 3/20 [00:20<01:44,  6.17s/it, CE=5.356011e-01 H=5.355806e-01 dV_dx=9.444998e-06 dV_dθ=-2.990908e-05 ||∇||=6.889626e-01 | Tr=0.8727] 15%|█▌        | 3/20 [00:25<01:44,  6.17s/it, CE=5.289280e-01 H=5.289752e-01 dV_dx=7.187211e-05 dV_dθ=-2.470161e-05 ||∇||=6.437424e-01 | Tr=0.8907] 20%|██        | 4/20 [00:25<01:30,  5.66s/it, CE=5.289280e-01 H=5.289752e-01 dV_dx=7.187211e-05 dV_dθ=-2.470161e-05 ||∇||=6.437424e-01 | Tr=0.8907] 20%|██        | 4/20 [00:30<01:30,  5.66s/it, CE=5.234983e-01 H=5.235113e-01 dV_dx=4.139413e-05 dV_dθ=-2.833428e-05 ||∇||=6.172744e-01 | Tr=0.9011] 25%|██▌       | 5/20 [00:30<01:20,  5.34s/it, CE=5.234983e-01 H=5.235113e-01 dV_dx=4.139413e-05 dV_dθ=-2.833428e-05 ||∇||=6.172744e-01 | Tr=0.9011] 25%|██▌       | 5/20 [00:36<01:20,  5.34s/it, CE=5.189096e-01 H=5.188445e-01 dV_dx=-3.327706e-05 dV_dθ=-3.183254e-05 ||∇||=5.985949e-01 | Tr=0.9086 Te/Cur=0.9129 Te/Exp=0.8287] 30%|███       | 6/20 [00:36<01:20,  5.72s/it, CE=5.189096e-01 H=5.188445e-01 dV_dx=-3.327706e-05 dV_dθ=-3.183254e-05 ||∇||=5.985949e-01 | Tr=0.9086 Te/Cur=0.9129 Te/Exp=0.8287] 30%|███       | 6/20 [00:40<01:20,  5.72s/it, CE=5.148479e-01 H=5.148342e-01 dV_dx=1.674369e-05 dV_dθ=-3.042614e-05 ||∇||=5.823867e-01 | Tr=0.9138]                              35%|███▌      | 7/20 [00:40<01:06,  5.15s/it, CE=5.148479e-01 H=5.148342e-01 dV_dx=1.674369e-05 dV_dθ=-3.042614e-05 ||∇||=5.823867e-01 | Tr=0.9138] 35%|███▌      | 7/20 [00:45<01:06,  5.15s/it, CE=5.113295e-01 H=5.112770e-01 dV_dx=-2.477213e-05 dV_dθ=-2.770468e-05 ||∇||=5.703547e-01 | Tr=0.9181] 40%|████      | 8/20 [00:45<00:59,  4.92s/it, CE=5.113295e-01 H=5.112770e-01 dV_dx=-2.477213e-05 dV_dθ=-2.770468e-05 ||∇||=5.703547e-01 | Tr=0.9181] 40%|████      | 8/20 [00:49<00:59,  4.92s/it, CE=5.082197e-01 H=5.080939e-01 dV_dx=-9.806523e-05 dV_dθ=-2.769466e-05 ||∇||=5.604586e-01 | Tr=0.9223] 45%|████▌     | 9/20 [00:49<00:50,  4.59s/it, CE=5.082197e-01 H=5.080939e-01 dV_dx=-9.806523e-05 dV_dθ=-2.769466e-05 ||∇||=5.604586e-01 | Tr=0.9223] 45%|████▌     | 9/20 [00:53<00:50,  4.59s/it, CE=5.053159e-01 H=5.053417e-01 dV_dx=5.250631e-05 dV_dθ=-2.670952e-05 ||∇||=5.516729e-01 | Tr=0.9255]  50%|█████     | 10/20 [00:53<00:46,  4.64s/it, CE=5.053159e-01 H=5.053417e-01 dV_dx=5.250631e-05 dV_dθ=-2.670952e-05 ||∇||=5.516729e-01 | Tr=0.9255] 50%|█████     | 10/20 [01:00<00:46,  4.64s/it, CE=5.026508e-01 H=5.026027e-01 dV_dx=-2.299532e-05 dV_dθ=-2.509058e-05 ||∇||=5.450477e-01 | Tr=0.9288 Te/Cur=0.9273 Te/Exp=0.8279] 55%|█████▌    | 11/20 [01:00<00:47,  5.30s/it, CE=5.026508e-01 H=5.026027e-01 dV_dx=-2.299532e-05 dV_dθ=-2.509058e-05 ||∇||=5.450477e-01 | Tr=0.9288 Te/Cur=0.9273 Te/Exp=0.8279] 55%|█████▌    | 11/20 [01:05<00:47,  5.30s/it, CE=5.001586e-01 H=5.001363e-01 dV_dx=1.452414e-07 dV_dθ=-2.244679e-05 ||∇||=5.382930e-01 | Tr=0.9317]                              60%|██████    | 12/20 [01:05<00:42,  5.26s/it, CE=5.001586e-01 H=5.001363e-01 dV_dx=1.452414e-07 dV_dθ=-2.244679e-05 ||∇||=5.382930e-01 | Tr=0.9317] 60%|██████    | 12/20 [01:10<00:42,  5.26s/it, CE=4.978398e-01 H=4.978304e-01 dV_dx=1.366693e-05 dV_dθ=-2.298144e-05 ||∇||=5.331998e-01 | Tr=0.9341] 65%|██████▌   | 13/20 [01:10<00:35,  5.13s/it, CE=4.978398e-01 H=4.978304e-01 dV_dx=1.366693e-05 dV_dθ=-2.298144e-05 ||∇||=5.331998e-01 | Tr=0.9341] 65%|██████▌   | 13/20 [01:15<00:35,  5.13s/it, CE=4.956112e-01 H=4.955357e-01 dV_dx=-5.303187e-05 dV_dθ=-2.254170e-05 ||∇||=5.280001e-01 | Tr=0.9364] 70%|███████   | 14/20 [01:15<00:30,  5.04s/it, CE=4.956112e-01 H=4.955357e-01 dV_dx=-5.303187e-05 dV_dθ=-2.254170e-05 ||∇||=5.280001e-01 | Tr=0.9364] 70%|███████   | 14/20 [01:20<00:30,  5.04s/it, CE=4.934848e-01 H=4.935281e-01 dV_dx=6.689758e-05 dV_dθ=-2.357223e-05 ||∇||=5.240529e-01 | Tr=0.9389]  75%|███████▌  | 15/20 [01:20<00:24,  4.96s/it, CE=4.934848e-01 H=4.935281e-01 dV_dx=6.689758e-05 dV_dθ=-2.357223e-05 ||∇||=5.240529e-01 | Tr=0.9389] 75%|███████▌  | 15/20 [01:27<00:24,  4.96s/it, CE=4.914357e-01 H=4.914662e-01 dV_dx=5.476548e-05 dV_dθ=-2.428045e-05 ||∇||=5.202248e-01 | Tr=0.9407 Te/Cur=0.9404 Te/Exp=0.8291] 80%|████████  | 16/20 [01:27<00:22,  5.54s/it, CE=4.914357e-01 H=4.914662e-01 dV_dx=5.476548e-05 dV_dθ=-2.428045e-05 ||∇||=5.202248e-01 | Tr=0.9407 Te/Cur=0.9404 Te/Exp=0.8291] 80%|████████  | 16/20 [01:32<00:22,  5.54s/it, CE=4.894646e-01 H=4.895682e-01 dV_dx=1.277217e-04 dV_dθ=-2.416767e-05 ||∇||=5.160555e-01 | Tr=0.9420]                             85%|████████▌ | 17/20 [01:32<00:16,  5.41s/it, CE=4.894646e-01 H=4.895682e-01 dV_dx=1.277217e-04 dV_dθ=-2.416767e-05 ||∇||=5.160555e-01 | Tr=0.9420] 85%|████████▌ | 17/20 [01:37<00:16,  5.41s/it, CE=4.875485e-01 H=4.875030e-01 dV_dx=-2.168132e-05 dV_dθ=-2.381657e-05 ||∇||=5.126231e-01 | Tr=0.9435] 90%|█████████ | 18/20 [01:37<00:10,  5.22s/it, CE=4.875485e-01 H=4.875030e-01 dV_dx=-2.168132e-05 dV_dθ=-2.381657e-05 ||∇||=5.126231e-01 | Tr=0.9435] 90%|█████████ | 18/20 [01:41<00:10,  5.22s/it, CE=4.856892e-01 H=4.856432e-01 dV_dx=-2.168899e-05 dV_dθ=-2.433072e-05 ||∇||=5.094045e-01 | Tr=0.9451] 95%|█████████▌| 19/20 [01:41<00:05,  5.09s/it, CE=4.856892e-01 H=4.856432e-01 dV_dx=-2.168899e-05 dV_dθ=-2.433072e-05 ||∇||=5.094045e-01 | Tr=0.9451] 95%|█████████▌| 19/20 [01:48<00:05,  5.09s/it, CE=4.838464e-01 H=4.838653e-01 dV_dx=4.349706e-05 dV_dθ=-2.455900e-05 ||∇||=5.059127e-01 | Tr=0.9466 Te/Cur=0.9413 Te/Exp=0.8331]100%|██████████| 20/20 [01:48<00:00,  5.46s/it, CE=4.838464e-01 H=4.838653e-01 dV_dx=4.349706e-05 dV_dθ=-2.455900e-05 ||∇||=5.059127e-01 | Tr=0.9466 Te/Cur=0.9413 Te/Exp=0.8331]100%|██████████| 20/20 [01:48<00:00,  5.41s/it, CE=4.838464e-01 H=4.838653e-01 dV_dx=4.349706e-05 dV_dθ=-2.455900e-05 ||∇||=5.059127e-01 | Tr=0.9466 Te/Cur=0.9413 Te/Exp=0.8331]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7694
    Task 1: 0.9488
    Task 2: 0.8374
    Task 3: 0.5599
    Task 4: 0.9488
    Task 5: 0.9337
    Task 6: 0.9427

============================================================
Task 7
============================================================
Initial loss on new task: 5.7278, previous: 0.4838, ratio: 11.84
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=11.84)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:41, 11.68s/it]  5%|▌         | 1/20 [00:16<03:41, 11.68s/it, CE=5.799595e-01 H=5.800253e-01 dV_dx=4.033106e-06 dV_dθ=6.172154e-05 ||∇||=7.458083e-01 | Tr=0.8806] 10%|█         | 2/20 [00:16<02:13,  7.42s/it, CE=5.799595e-01 H=5.800253e-01 dV_dx=4.033106e-06 dV_dθ=6.172154e-05 ||∇||=7.458083e-01 | Tr=0.8806] 10%|█         | 2/20 [00:20<02:13,  7.42s/it, CE=5.444649e-01 H=5.445000e-01 dV_dx=-7.103936e-06 dV_dθ=4.221114e-05 ||∇||=6.610663e-01 | Tr=0.9040] 15%|█▌        | 3/20 [00:20<01:46,  6.24s/it, CE=5.444649e-01 H=5.445000e-01 dV_dx=-7.103936e-06 dV_dθ=4.221114e-05 ||∇||=6.610663e-01 | Tr=0.9040] 15%|█▌        | 3/20 [00:25<01:46,  6.24s/it, CE=5.264901e-01 H=5.264552e-01 dV_dx=-5.491286e-05 dV_dθ=1.994528e-05 ||∇||=6.261404e-01 | Tr=0.9160] 20%|██        | 4/20 [00:25<01:31,  5.71s/it, CE=5.264901e-01 H=5.264552e-01 dV_dx=-5.491286e-05 dV_dθ=1.994528e-05 ||∇||=6.261404e-01 | Tr=0.9160] 20%|██        | 4/20 [00:30<01:31,  5.71s/it, CE=5.143673e-01 H=5.143359e-01 dV_dx=-4.278012e-05 dV_dθ=1.144373e-05 ||∇||=5.986707e-01 | Tr=0.9243] 25%|██▌       | 5/20 [00:30<01:19,  5.31s/it, CE=5.143673e-01 H=5.143359e-01 dV_dx=-4.278012e-05 dV_dθ=1.144373e-05 ||∇||=5.986707e-01 | Tr=0.9243] 25%|██▌       | 5/20 [00:36<01:19,  5.31s/it, CE=5.053837e-01 H=5.053383e-01 dV_dx=-5.247812e-05 dV_dθ=7.059836e-06 ||∇||=5.775324e-01 | Tr=0.9308 Te/Cur=0.9281 Te/Exp=0.8277] 30%|███       | 6/20 [00:36<01:17,  5.52s/it, CE=5.053837e-01 H=5.053383e-01 dV_dx=-5.247812e-05 dV_dθ=7.059836e-06 ||∇||=5.775324e-01 | Tr=0.9308 Te/Cur=0.9281 Te/Exp=0.8277] 30%|███       | 6/20 [00:41<01:17,  5.52s/it, CE=4.983104e-01 H=4.982963e-01 dV_dx=-1.927623e-05 dV_dθ=5.178146e-06 ||∇||=5.583604e-01 | Tr=0.9357]                             35%|███▌      | 7/20 [00:41<01:10,  5.40s/it, CE=4.983104e-01 H=4.982963e-01 dV_dx=-1.927623e-05 dV_dθ=5.178146e-06 ||∇||=5.583604e-01 | Tr=0.9357] 35%|███▌      | 7/20 [00:45<01:10,  5.40s/it, CE=4.925106e-01 H=4.924974e-01 dV_dx=-1.530237e-05 dV_dθ=2.138725e-06 ||∇||=5.442663e-01 | Tr=0.9398] 40%|████      | 8/20 [00:45<01:00,  5.07s/it, CE=4.925106e-01 H=4.924974e-01 dV_dx=-1.530237e-05 dV_dθ=2.138725e-06 ||∇||=5.442663e-01 | Tr=0.9398] 40%|████      | 8/20 [00:50<01:00,  5.07s/it, CE=4.874805e-01 H=4.874404e-01 dV_dx=-4.172579e-05 dV_dθ=1.603838e-06 ||∇||=5.298557e-01 | Tr=0.9430] 45%|████▌     | 9/20 [00:50<00:52,  4.78s/it, CE=4.874805e-01 H=4.874404e-01 dV_dx=-4.172579e-05 dV_dθ=1.603838e-06 ||∇||=5.298557e-01 | Tr=0.9430] 45%|████▌     | 9/20 [00:54<00:52,  4.78s/it, CE=4.829658e-01 H=4.830036e-01 dV_dx=3.844536e-05 dV_dθ=-6.711724e-07 ||∇||=5.197251e-01 | Tr=0.9458] 50%|█████     | 10/20 [00:54<00:47,  4.75s/it, CE=4.829658e-01 H=4.830036e-01 dV_dx=3.844536e-05 dV_dθ=-6.711724e-07 ||∇||=5.197251e-01 | Tr=0.9458] 50%|█████     | 10/20 [01:02<00:47,  4.75s/it, CE=4.788412e-01 H=4.788393e-01 dV_dx=-2.892333e-08 dV_dθ=-1.886605e-06 ||∇||=5.113702e-01 | Tr=0.9488 Te/Cur=0.9443 Te/Exp=0.8283] 55%|█████▌    | 11/20 [01:02<00:49,  5.54s/it, CE=4.788412e-01 H=4.788393e-01 dV_dx=-2.892333e-08 dV_dθ=-1.886605e-06 ||∇||=5.113702e-01 | Tr=0.9488 Te/Cur=0.9443 Te/Exp=0.8283] 55%|█████▌    | 11/20 [01:06<00:49,  5.54s/it, CE=4.750490e-01 H=4.750390e-01 dV_dx=-7.434519e-06 dV_dθ=-2.601685e-06 ||∇||=5.035465e-01 | Tr=0.9511]                             60%|██████    | 12/20 [01:06<00:42,  5.35s/it, CE=4.750490e-01 H=4.750390e-01 dV_dx=-7.434519e-06 dV_dθ=-2.601685e-06 ||∇||=5.035465e-01 | Tr=0.9511] 60%|██████    | 12/20 [01:12<00:42,  5.35s/it, CE=4.715145e-01 H=4.715134e-01 dV_dx=4.344377e-06 dV_dθ=-5.366620e-06 ||∇||=4.970806e-01 | Tr=0.9529]  65%|██████▌   | 13/20 [01:12<00:37,  5.33s/it, CE=4.715145e-01 H=4.715134e-01 dV_dx=4.344377e-06 dV_dθ=-5.366620e-06 ||∇||=4.970806e-01 | Tr=0.9529] 65%|██████▌   | 13/20 [01:16<00:37,  5.33s/it, CE=4.682387e-01 H=4.682058e-01 dV_dx=-2.462415e-05 dV_dθ=-8.302333e-06 ||∇||=4.911280e-01 | Tr=0.9547] 70%|███████   | 14/20 [01:16<00:30,  5.03s/it, CE=4.682387e-01 H=4.682058e-01 dV_dx=-2.462415e-05 dV_dθ=-8.302333e-06 ||∇||=4.911280e-01 | Tr=0.9547] 70%|███████   | 14/20 [01:21<00:30,  5.03s/it, CE=4.651646e-01 H=4.651964e-01 dV_dx=4.148280e-05 dV_dθ=-9.662662e-06 ||∇||=4.848768e-01 | Tr=0.9568]  75%|███████▌  | 15/20 [01:21<00:24,  4.89s/it, CE=4.651646e-01 H=4.651964e-01 dV_dx=4.148280e-05 dV_dθ=-9.662662e-06 ||∇||=4.848768e-01 | Tr=0.9568] 75%|███████▌  | 15/20 [01:28<00:24,  4.89s/it, CE=4.621978e-01 H=4.621347e-01 dV_dx=-5.348923e-05 dV_dθ=-9.649329e-06 ||∇||=4.787201e-01 | Tr=0.9585 Te/Cur=0.9557 Te/Exp=0.8405] 80%|████████  | 16/20 [01:28<00:22,  5.54s/it, CE=4.621978e-01 H=4.621347e-01 dV_dx=-5.348923e-05 dV_dθ=-9.649329e-06 ||∇||=4.787201e-01 | Tr=0.9585 Te/Cur=0.9557 Te/Exp=0.8405] 80%|████████  | 16/20 [01:33<00:22,  5.54s/it, CE=4.593087e-01 H=4.592896e-01 dV_dx=-1.083199e-05 dV_dθ=-8.318849e-06 ||∇||=4.726738e-01 | Tr=0.9599]                             85%|████████▌ | 17/20 [01:33<00:15,  5.33s/it, CE=4.593087e-01 H=4.592896e-01 dV_dx=-1.083199e-05 dV_dθ=-8.318849e-06 ||∇||=4.726738e-01 | Tr=0.9599] 85%|████████▌ | 17/20 [01:38<00:15,  5.33s/it, CE=4.565634e-01 H=4.565303e-01 dV_dx=-2.708144e-05 dV_dθ=-6.005670e-06 ||∇||=4.670536e-01 | Tr=0.9613] 90%|█████████ | 18/20 [01:38<00:10,  5.27s/it, CE=4.565634e-01 H=4.565303e-01 dV_dx=-2.708144e-05 dV_dθ=-6.005670e-06 ||∇||=4.670536e-01 | Tr=0.9613] 90%|█████████ | 18/20 [01:43<00:10,  5.27s/it, CE=4.539776e-01 H=4.539347e-01 dV_dx=-3.696496e-05 dV_dθ=-5.920690e-06 ||∇||=4.615090e-01 | Tr=0.9628] 95%|█████████▌| 19/20 [01:43<00:05,  5.19s/it, CE=4.539776e-01 H=4.539347e-01 dV_dx=-3.696496e-05 dV_dθ=-5.920690e-06 ||∇||=4.615090e-01 | Tr=0.9628] 95%|█████████▌| 19/20 [01:49<00:05,  5.19s/it, CE=4.515297e-01 H=4.515748e-01 dV_dx=5.456905e-05 dV_dθ=-9.425788e-06 ||∇||=4.619012e-01 | Tr=0.9643 Te/Cur=0.9592 Te/Exp=0.8406]100%|██████████| 20/20 [01:49<00:00,  5.61s/it, CE=4.515297e-01 H=4.515748e-01 dV_dx=5.456905e-05 dV_dθ=-9.425788e-06 ||∇||=4.619012e-01 | Tr=0.9643 Te/Cur=0.9592 Te/Exp=0.8406]100%|██████████| 20/20 [01:49<00:00,  5.49s/it, CE=4.515297e-01 H=4.515748e-01 dV_dx=5.456905e-05 dV_dθ=-9.425788e-06 ||∇||=4.619012e-01 | Tr=0.9643 Te/Cur=0.9592 Te/Exp=0.8406]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7644
    Task 1: 0.9383
    Task 2: 0.8354
    Task 3: 0.5631
    Task 4: 0.9330
    Task 5: 0.9232
    Task 6: 0.9350
    Task 7: 0.9583

============================================================
Task 8
============================================================
Initial loss on new task: 4.7070, previous: 0.4515, ratio: 10.42
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=10.42)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:12, 13.30s/it]  5%|▌         | 1/20 [00:17<04:12, 13.30s/it, CE=5.729412e-01 H=5.732551e-01 dV_dx=5.899717e-05 dV_dθ=2.549009e-04 ||∇||=6.762582e-01 | Tr=0.8944] 10%|█         | 2/20 [00:17<02:24,  8.04s/it, CE=5.729412e-01 H=5.732551e-01 dV_dx=5.899717e-05 dV_dθ=2.549009e-04 ||∇||=6.762582e-01 | Tr=0.8944] 10%|█         | 2/20 [00:23<02:24,  8.04s/it, CE=5.325970e-01 H=5.326853e-01 dV_dx=-3.954177e-05 dV_dθ=1.278492e-04 ||∇||=6.186807e-01 | Tr=0.9120] 15%|█▌        | 3/20 [00:23<01:56,  6.84s/it, CE=5.325970e-01 H=5.326853e-01 dV_dx=-3.954177e-05 dV_dθ=1.278492e-04 ||∇||=6.186807e-01 | Tr=0.9120] 15%|█▌        | 3/20 [00:27<01:56,  6.84s/it, CE=5.131010e-01 H=5.131611e-01 dV_dx=-2.700950e-05 dV_dθ=8.717199e-05 ||∇||=5.979837e-01 | Tr=0.9233] 20%|██        | 4/20 [00:27<01:34,  5.93s/it, CE=5.131010e-01 H=5.131611e-01 dV_dx=-2.700950e-05 dV_dθ=8.717199e-05 ||∇||=5.979837e-01 | Tr=0.9233] 20%|██        | 4/20 [00:32<01:34,  5.93s/it, CE=4.999991e-01 H=5.000014e-01 dV_dx=-3.798617e-05 dV_dθ=4.034248e-05 ||∇||=5.874570e-01 | Tr=0.9303] 25%|██▌       | 5/20 [00:32<01:23,  5.58s/it, CE=4.999991e-01 H=5.000014e-01 dV_dx=-3.798617e-05 dV_dθ=4.034248e-05 ||∇||=5.874570e-01 | Tr=0.9303] 25%|██▌       | 5/20 [00:39<01:23,  5.58s/it, CE=4.900639e-01 H=4.900636e-01 dV_dx=-1.322291e-05 dV_dθ=1.296219e-05 ||∇||=5.786883e-01 | Tr=0.9365 Te/Cur=0.9313 Te/Exp=0.8333] 30%|███       | 6/20 [00:39<01:23,  5.99s/it, CE=4.900639e-01 H=4.900636e-01 dV_dx=-1.322291e-05 dV_dθ=1.296219e-05 ||∇||=5.786883e-01 | Tr=0.9365 Te/Cur=0.9313 Te/Exp=0.8333] 30%|███       | 6/20 [00:44<01:23,  5.99s/it, CE=4.821639e-01 H=4.821347e-01 dV_dx=-3.132041e-05 dV_dθ=2.140518e-06 ||∇||=5.708599e-01 | Tr=0.9417]                             35%|███▌      | 7/20 [00:44<01:14,  5.70s/it, CE=4.821639e-01 H=4.821347e-01 dV_dx=-3.132041e-05 dV_dθ=2.140518e-06 ||∇||=5.708599e-01 | Tr=0.9417] 35%|███▌      | 7/20 [00:49<01:14,  5.70s/it, CE=4.753227e-01 H=4.753314e-01 dV_dx=1.790920e-05 dV_dθ=-9.242264e-06 ||∇||=5.638907e-01 | Tr=0.9451] 40%|████      | 8/20 [00:49<01:04,  5.41s/it, CE=4.753227e-01 H=4.753314e-01 dV_dx=1.790920e-05 dV_dθ=-9.242264e-06 ||∇||=5.638907e-01 | Tr=0.9451] 40%|████      | 8/20 [00:53<01:04,  5.41s/it, CE=4.692553e-01 H=4.692509e-01 dV_dx=1.191671e-05 dV_dθ=-1.637950e-05 ||∇||=5.575829e-01 | Tr=0.9478] 45%|████▌     | 9/20 [00:53<00:57,  5.18s/it, CE=4.692553e-01 H=4.692509e-01 dV_dx=1.191671e-05 dV_dθ=-1.637950e-05 ||∇||=5.575829e-01 | Tr=0.9478] 45%|████▌     | 9/20 [00:58<00:57,  5.18s/it, CE=4.638904e-01 H=4.638477e-01 dV_dx=-1.438905e-05 dV_dθ=-2.827847e-05 ||∇||=5.528026e-01 | Tr=0.9500] 50%|█████     | 10/20 [00:58<00:49,  4.95s/it, CE=4.638904e-01 H=4.638477e-01 dV_dx=-1.438905e-05 dV_dθ=-2.827847e-05 ||∇||=5.528026e-01 | Tr=0.9500] 50%|█████     | 10/20 [01:04<00:49,  4.95s/it, CE=4.589836e-01 H=4.589506e-01 dV_dx=-8.229845e-06 dV_dθ=-2.472879e-05 ||∇||=5.448066e-01 | Tr=0.9524 Te/Cur=0.9466 Te/Exp=0.8350] 55%|█████▌    | 11/20 [01:04<00:48,  5.42s/it, CE=4.589836e-01 H=4.589506e-01 dV_dx=-8.229845e-06 dV_dθ=-2.472879e-05 ||∇||=5.448066e-01 | Tr=0.9524 Te/Cur=0.9466 Te/Exp=0.8350] 55%|█████▌    | 11/20 [01:10<00:48,  5.42s/it, CE=4.544902e-01 H=4.544389e-01 dV_dx=-1.904644e-05 dV_dθ=-3.218708e-05 ||∇||=5.404967e-01 | Tr=0.9548]                             60%|██████    | 12/20 [01:10<00:42,  5.35s/it, CE=4.544902e-01 H=4.544389e-01 dV_dx=-1.904644e-05 dV_dθ=-3.218708e-05 ||∇||=5.404967e-01 | Tr=0.9548] 60%|██████    | 12/20 [01:15<00:42,  5.35s/it, CE=4.503260e-01 H=4.502881e-01 dV_dx=-6.330329e-06 dV_dθ=-3.155216e-05 ||∇||=5.343807e-01 | Tr=0.9568] 65%|██████▌   | 13/20 [01:15<00:37,  5.32s/it, CE=4.503260e-01 H=4.502881e-01 dV_dx=-6.330329e-06 dV_dθ=-3.155216e-05 ||∇||=5.343807e-01 | Tr=0.9568] 65%|██████▌   | 13/20 [01:19<00:37,  5.32s/it, CE=4.463828e-01 H=4.463833e-01 dV_dx=3.535205e-05 dV_dθ=-3.476828e-05 ||∇||=5.306920e-01 | Tr=0.9589]  70%|███████   | 14/20 [01:19<00:30,  5.13s/it, CE=4.463828e-01 H=4.463833e-01 dV_dx=3.535205e-05 dV_dθ=-3.476828e-05 ||∇||=5.306920e-01 | Tr=0.9589] 70%|███████   | 14/20 [01:24<00:30,  5.13s/it, CE=4.426460e-01 H=4.426026e-01 dV_dx=-5.323336e-06 dV_dθ=-3.808531e-05 ||∇||=5.262728e-01 | Tr=0.9606] 75%|███████▌  | 15/20 [01:24<00:24,  4.99s/it, CE=4.426460e-01 H=4.426026e-01 dV_dx=-5.323336e-06 dV_dθ=-3.808531e-05 ||∇||=5.262728e-01 | Tr=0.9606] 75%|███████▌  | 15/20 [01:31<00:24,  4.99s/it, CE=4.391230e-01 H=4.390980e-01 dV_dx=1.817215e-05 dV_dθ=-4.319073e-05 ||∇||=5.228244e-01 | Tr=0.9620 Te/Cur=0.9555 Te/Exp=0.8441] 80%|████████  | 16/20 [01:31<00:22,  5.58s/it, CE=4.391230e-01 H=4.390980e-01 dV_dx=1.817215e-05 dV_dθ=-4.319073e-05 ||∇||=5.228244e-01 | Tr=0.9620 Te/Cur=0.9555 Te/Exp=0.8441] 80%|████████  | 16/20 [01:36<00:22,  5.58s/it, CE=4.358526e-01 H=4.358245e-01 dV_dx=1.462849e-05 dV_dθ=-4.279031e-05 ||∇||=5.166192e-01 | Tr=0.9631]                             85%|████████▌ | 17/20 [01:36<00:15,  5.31s/it, CE=4.358526e-01 H=4.358245e-01 dV_dx=1.462849e-05 dV_dθ=-4.279031e-05 ||∇||=5.166192e-01 | Tr=0.9631] 85%|████████▌ | 17/20 [01:40<00:15,  5.31s/it, CE=4.327453e-01 H=4.326720e-01 dV_dx=-3.223276e-05 dV_dθ=-4.106668e-05 ||∇||=5.111198e-01 | Tr=0.9642] 90%|█████████ | 18/20 [01:40<00:10,  5.13s/it, CE=4.327453e-01 H=4.326720e-01 dV_dx=-3.223276e-05 dV_dθ=-4.106668e-05 ||∇||=5.111198e-01 | Tr=0.9642] 90%|█████████ | 18/20 [01:45<00:10,  5.13s/it, CE=4.297834e-01 H=4.297749e-01 dV_dx=2.955793e-05 dV_dθ=-3.809591e-05 ||∇||=5.061256e-01 | Tr=0.9652]  95%|█████████▌| 19/20 [01:45<00:04,  4.92s/it, CE=4.297834e-01 H=4.297749e-01 dV_dx=2.955793e-05 dV_dθ=-3.809591e-05 ||∇||=5.061256e-01 | Tr=0.9652] 95%|█████████▌| 19/20 [01:52<00:04,  4.92s/it, CE=4.269557e-01 H=4.269609e-01 dV_dx=4.981463e-05 dV_dθ=-4.464691e-05 ||∇||=5.034256e-01 | Tr=0.9665 Te/Cur=0.9583 Te/Exp=0.8494]100%|██████████| 20/20 [01:52<00:00,  5.70s/it, CE=4.269557e-01 H=4.269609e-01 dV_dx=4.981463e-05 dV_dθ=-4.464691e-05 ||∇||=5.034256e-01 | Tr=0.9665 Te/Cur=0.9583 Te/Exp=0.8494]100%|██████████| 20/20 [01:52<00:00,  5.65s/it, CE=4.269557e-01 H=4.269609e-01 dV_dx=4.981463e-05 dV_dθ=-4.464691e-05 ||∇||=5.034256e-01 | Tr=0.9665 Te/Cur=0.9583 Te/Exp=0.8494]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.7692
    Task 1: 0.9432
    Task 2: 0.8361
    Task 3: 0.5659
    Task 4: 0.9423
    Task 5: 0.8938
    Task 6: 0.9134
    Task 7: 0.9086
    Task 8: 0.9592

============================================================
Task 9
============================================================
Initial loss on new task: 1.6372, previous: 0.4270, ratio: 3.83
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=3.83)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<04:05, 12.95s/it]  5%|▌         | 1/20 [00:17<04:05, 12.95s/it, CE=4.307863e-01 H=4.306155e-01 dV_dx=-2.412482e-05 dV_dθ=-1.466426e-04 ||∇||=8.154329e-01 | Tr=0.9087] 10%|█         | 2/20 [00:17<02:23,  7.95s/it, CE=4.307863e-01 H=4.306155e-01 dV_dx=-2.412482e-05 dV_dθ=-1.466426e-04 ||∇||=8.154329e-01 | Tr=0.9087] 10%|█         | 2/20 [00:21<02:23,  7.95s/it, CE=4.220246e-01 H=4.219189e-01 dV_dx=2.687514e-05 dV_dθ=-1.325532e-04 ||∇||=7.684123e-01 | Tr=0.9207]  15%|█▌        | 3/20 [00:21<01:45,  6.23s/it, CE=4.220246e-01 H=4.219189e-01 dV_dx=2.687514e-05 dV_dθ=-1.325532e-04 ||∇||=7.684123e-01 | Tr=0.9207] 15%|█▌        | 3/20 [00:26<01:45,  6.23s/it, CE=4.168611e-01 H=4.166505e-01 dV_dx=-6.651708e-05 dV_dθ=-1.440950e-04 ||∇||=7.400212e-01 | Tr=0.9285] 20%|██        | 4/20 [00:26<01:30,  5.63s/it, CE=4.168611e-01 H=4.166505e-01 dV_dx=-6.651708e-05 dV_dθ=-1.440950e-04 ||∇||=7.400212e-01 | Tr=0.9285] 20%|██        | 4/20 [00:31<01:30,  5.63s/it, CE=4.123142e-01 H=4.121505e-01 dV_dx=-2.179971e-05 dV_dθ=-1.419251e-04 ||∇||=7.090444e-01 | Tr=0.9333] 25%|██▌       | 5/20 [00:31<01:21,  5.42s/it, CE=4.123142e-01 H=4.121505e-01 dV_dx=-2.179971e-05 dV_dθ=-1.419251e-04 ||∇||=7.090444e-01 | Tr=0.9333] 25%|██▌       | 5/20 [00:38<01:21,  5.42s/it, CE=4.082772e-01 H=4.081348e-01 dV_dx=-7.489964e-06 dV_dθ=-1.349470e-04 ||∇||=6.831023e-01 | Tr=0.9372 Te/Cur=0.9368 Te/Exp=0.8512] 30%|███       | 6/20 [00:38<01:24,  6.00s/it, CE=4.082772e-01 H=4.081348e-01 dV_dx=-7.489964e-06 dV_dθ=-1.349470e-04 ||∇||=6.831023e-01 | Tr=0.9372 Te/Cur=0.9368 Te/Exp=0.8512] 30%|███       | 6/20 [00:42<01:24,  6.00s/it, CE=4.045502e-01 H=4.044378e-01 dV_dx=1.397496e-05 dV_dθ=-1.263245e-04 ||∇||=6.571018e-01 | Tr=0.9402]                              35%|███▌      | 7/20 [00:42<01:09,  5.37s/it, CE=4.045502e-01 H=4.044378e-01 dV_dx=1.397496e-05 dV_dθ=-1.263245e-04 ||∇||=6.571018e-01 | Tr=0.9402] 35%|███▌      | 7/20 [00:47<01:09,  5.37s/it, CE=4.010232e-01 H=4.009218e-01 dV_dx=1.665383e-05 dV_dθ=-1.181049e-04 ||∇||=6.396839e-01 | Tr=0.9431] 40%|████      | 8/20 [00:47<01:02,  5.20s/it, CE=4.010232e-01 H=4.009218e-01 dV_dx=1.665383e-05 dV_dθ=-1.181049e-04 ||∇||=6.396839e-01 | Tr=0.9431] 40%|████      | 8/20 [00:52<01:02,  5.20s/it, CE=3.977057e-01 H=3.975831e-01 dV_dx=-6.428662e-06 dV_dθ=-1.161951e-04 ||∇||=6.294224e-01 | Tr=0.9456] 45%|████▌     | 9/20 [00:52<00:56,  5.10s/it, CE=3.977057e-01 H=3.975831e-01 dV_dx=-6.428662e-06 dV_dθ=-1.161951e-04 ||∇||=6.294224e-01 | Tr=0.9456] 45%|████▌     | 9/20 [00:56<00:56,  5.10s/it, CE=3.945368e-01 H=3.944097e-01 dV_dx=-8.914284e-06 dV_dθ=-1.182306e-04 ||∇||=6.211003e-01 | Tr=0.9478] 50%|█████     | 10/20 [00:56<00:49,  4.94s/it, CE=3.945368e-01 H=3.944097e-01 dV_dx=-8.914284e-06 dV_dθ=-1.182306e-04 ||∇||=6.211003e-01 | Tr=0.9478] 50%|█████     | 10/20 [01:03<00:49,  4.94s/it, CE=3.915240e-01 H=3.914567e-01 dV_dx=3.914144e-05 dV_dθ=-1.065204e-04 ||∇||=6.090030e-01 | Tr=0.9496 Te/Cur=0.9500 Te/Exp=0.8599] 55%|█████▌    | 11/20 [01:03<00:47,  5.33s/it, CE=3.915240e-01 H=3.914567e-01 dV_dx=3.914144e-05 dV_dθ=-1.065204e-04 ||∇||=6.090030e-01 | Tr=0.9496 Te/Cur=0.9500 Te/Exp=0.8599] 55%|█████▌    | 11/20 [01:07<00:47,  5.33s/it, CE=3.886250e-01 H=3.886014e-01 dV_dx=9.480797e-05 dV_dθ=-1.183700e-04 ||∇||=6.124726e-01 | Tr=0.9516]                             60%|██████    | 12/20 [01:07<00:41,  5.19s/it, CE=3.886250e-01 H=3.886014e-01 dV_dx=9.480797e-05 dV_dθ=-1.183700e-04 ||∇||=6.124726e-01 | Tr=0.9516] 60%|██████    | 12/20 [01:12<00:41,  5.19s/it, CE=3.859360e-01 H=3.858615e-01 dV_dx=4.104155e-05 dV_dθ=-1.155387e-04 ||∇||=6.052121e-01 | Tr=0.9535] 65%|██████▌   | 13/20 [01:12<00:35,  5.09s/it, CE=3.859360e-01 H=3.858615e-01 dV_dx=4.104155e-05 dV_dθ=-1.155387e-04 ||∇||=6.052121e-01 | Tr=0.9535] 65%|██████▌   | 13/20 [01:17<00:35,  5.09s/it, CE=3.833174e-01 H=3.831713e-01 dV_dx=-3.088512e-05 dV_dθ=-1.152317e-04 ||∇||=5.975905e-01 | Tr=0.9548] 70%|███████   | 14/20 [01:17<00:29,  4.99s/it, CE=3.833174e-01 H=3.831713e-01 dV_dx=-3.088512e-05 dV_dθ=-1.152317e-04 ||∇||=5.975905e-01 | Tr=0.9548] 70%|███████   | 14/20 [01:22<00:29,  4.99s/it, CE=3.807879e-01 H=3.807071e-01 dV_dx=3.134154e-05 dV_dθ=-1.121173e-04 ||∇||=5.858881e-01 | Tr=0.9566]  75%|███████▌  | 15/20 [01:22<00:25,  5.03s/it, CE=3.807879e-01 H=3.807071e-01 dV_dx=3.134154e-05 dV_dθ=-1.121173e-04 ||∇||=5.858881e-01 | Tr=0.9566] 75%|███████▌  | 15/20 [01:30<00:25,  5.03s/it, CE=3.783234e-01 H=3.782713e-01 dV_dx=5.727691e-05 dV_dθ=-1.094104e-04 ||∇||=5.825111e-01 | Tr=0.9582 Te/Cur=0.9560 Te/Exp=0.8666] 80%|████████  | 16/20 [01:30<00:23,  5.85s/it, CE=3.783234e-01 H=3.782713e-01 dV_dx=5.727691e-05 dV_dθ=-1.094104e-04 ||∇||=5.825111e-01 | Tr=0.9582 Te/Cur=0.9560 Te/Exp=0.8666] 80%|████████  | 16/20 [01:35<00:23,  5.85s/it, CE=3.759423e-01 H=3.758631e-01 dV_dx=1.587488e-05 dV_dθ=-9.512017e-05 ||∇||=5.711999e-01 | Tr=0.9599]                             85%|████████▌ | 17/20 [01:35<00:16,  5.62s/it, CE=3.759423e-01 H=3.758631e-01 dV_dx=1.587488e-05 dV_dθ=-9.512017e-05 ||∇||=5.711999e-01 | Tr=0.9599] 85%|████████▌ | 17/20 [01:40<00:16,  5.62s/it, CE=3.736225e-01 H=3.735124e-01 dV_dx=-7.789276e-06 dV_dθ=-1.023843e-04 ||∇||=5.719084e-01 | Tr=0.9611] 90%|█████████ | 18/20 [01:40<00:10,  5.34s/it, CE=3.736225e-01 H=3.735124e-01 dV_dx=-7.789276e-06 dV_dθ=-1.023843e-04 ||∇||=5.719084e-01 | Tr=0.9611] 90%|█████████ | 18/20 [01:44<00:10,  5.34s/it, CE=3.714121e-01 H=3.713678e-01 dV_dx=5.556639e-05 dV_dθ=-9.984143e-05 ||∇||=5.664965e-01 | Tr=0.9623]  95%|█████████▌| 19/20 [01:44<00:05,  5.09s/it, CE=3.714121e-01 H=3.713678e-01 dV_dx=5.556639e-05 dV_dθ=-9.984143e-05 ||∇||=5.664965e-01 | Tr=0.9623] 95%|█████████▌| 19/20 [01:51<00:05,  5.09s/it, CE=3.692524e-01 H=3.691562e-01 dV_dx=-4.473696e-06 dV_dθ=-9.181500e-05 ||∇||=5.561681e-01 | Tr=0.9634 Te/Cur=0.9581 Te/Exp=0.8609]100%|██████████| 20/20 [01:51<00:00,  5.52s/it, CE=3.692524e-01 H=3.691562e-01 dV_dx=-4.473696e-06 dV_dθ=-9.181500e-05 ||∇||=5.561681e-01 | Tr=0.9634 Te/Cur=0.9581 Te/Exp=0.8609]100%|██████████| 20/20 [01:51<00:00,  5.56s/it, CE=3.692524e-01 H=3.691562e-01 dV_dx=-4.473696e-06 dV_dθ=-9.181500e-05 ||∇||=5.561681e-01 | Tr=0.9634 Te/Cur=0.9581 Te/Exp=0.8609]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7730
    Task 1: 0.9473
    Task 2: 0.8431
    Task 3: 0.5692
    Task 4: 0.9464
    Task 5: 0.9204
    Task 6: 0.9258
    Task 7: 0.9314
    Task 8: 0.9090
    Task 9: 0.9588
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run1/mnist_condition1_baseline_run1_run1/classification_mnist_cnn_run1_records.pkl

Training complete!
