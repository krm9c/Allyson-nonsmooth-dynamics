JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition1_baseline.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: False

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run2
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run2/mnist_condition1_baseline_run2


############################################################
# Run ID: 2
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:16<05:22, 16.98s/it]  5%|▌         | 1/20 [00:22<05:22, 16.98s/it, CE=2.067998e+00 H=2.067572e+00 dV_dx=4.243716e-07 dV_dθ=-4.264286e-04 ||∇||=4.508012e-01 | Tr=0.4010] 10%|█         | 2/20 [00:22<03:00, 10.03s/it, CE=2.067998e+00 H=2.067572e+00 dV_dx=4.243716e-07 dV_dθ=-4.264286e-04 ||∇||=4.508012e-01 | Tr=0.4010] 10%|█         | 2/20 [00:26<03:00, 10.03s/it, CE=1.855690e+00 H=1.854890e+00 dV_dx=4.487624e-07 dV_dθ=-8.002300e-04 ||∇||=6.150932e-01 | Tr=0.4863] 15%|█▌        | 3/20 [00:26<02:09,  7.61s/it, CE=1.855690e+00 H=1.854890e+00 dV_dx=4.487624e-07 dV_dθ=-8.002300e-04 ||∇||=6.150932e-01 | Tr=0.4863] 15%|█▌        | 3/20 [00:31<02:09,  7.61s/it, CE=1.648907e+00 H=1.647907e+00 dV_dx=4.832695e-07 dV_dθ=-1.000341e-03 ||∇||=6.923197e-01 | Tr=0.5287] 20%|██        | 4/20 [00:31<01:45,  6.57s/it, CE=1.648907e+00 H=1.647907e+00 dV_dx=4.832695e-07 dV_dθ=-1.000341e-03 ||∇||=6.923197e-01 | Tr=0.5287] 20%|██        | 4/20 [00:36<01:45,  6.57s/it, CE=1.472971e+00 H=1.471984e+00 dV_dx=-8.854370e-07 dV_dθ=-9.859423e-04 ||∇||=6.961006e-01 | Tr=0.5599] 25%|██▌       | 5/20 [00:36<01:29,  5.95s/it, CE=1.472971e+00 H=1.471984e+00 dV_dx=-8.854370e-07 dV_dθ=-9.859423e-04 ||∇||=6.961006e-01 | Tr=0.5599] 25%|██▌       | 5/20 [00:44<01:29,  5.95s/it, CE=1.336926e+00 H=1.336060e+00 dV_dx=2.402561e-08 dV_dθ=-8.657247e-04 ||∇||=6.643470e-01 | Tr=0.5870 Te/Cur=0.5943 Te/Exp=0.5935] 30%|███       | 6/20 [00:44<01:34,  6.75s/it, CE=1.336926e+00 H=1.336060e+00 dV_dx=2.402561e-08 dV_dθ=-8.657247e-04 ||∇||=6.643470e-01 | Tr=0.5870 Te/Cur=0.5943 Te/Exp=0.5935] 30%|███       | 6/20 [00:48<01:34,  6.75s/it, CE=1.234425e+00 H=1.233680e+00 dV_dx=-7.243613e-07 dV_dθ=-7.442636e-04 ||∇||=6.294364e-01 | Tr=0.6082]                            35%|███▌      | 7/20 [00:48<01:15,  5.78s/it, CE=1.234425e+00 H=1.233680e+00 dV_dx=-7.243613e-07 dV_dθ=-7.442636e-04 ||∇||=6.294364e-01 | Tr=0.6082] 35%|███▌      | 7/20 [00:53<01:15,  5.78s/it, CE=1.156922e+00 H=1.156293e+00 dV_dx=9.697300e-07 dV_dθ=-6.300922e-04 ||∇||=5.939425e-01 | Tr=0.6272]  40%|████      | 8/20 [00:53<01:06,  5.51s/it, CE=1.156922e+00 H=1.156293e+00 dV_dx=9.697300e-07 dV_dθ=-6.300922e-04 ||∇||=5.939425e-01 | Tr=0.6272] 40%|████      | 8/20 [00:58<01:06,  5.51s/it, CE=1.097148e+00 H=1.096607e+00 dV_dx=-3.894358e-07 dV_dθ=-5.406970e-04 ||∇||=5.647436e-01 | Tr=0.6434] 45%|████▌     | 9/20 [00:58<00:57,  5.23s/it, CE=1.097148e+00 H=1.096607e+00 dV_dx=-3.894358e-07 dV_dθ=-5.406970e-04 ||∇||=5.647436e-01 | Tr=0.6434] 45%|████▌     | 9/20 [01:02<00:57,  5.23s/it, CE=1.049904e+00 H=1.049426e+00 dV_dx=3.434109e-06 dV_dθ=-4.810019e-04 ||∇||=5.451479e-01 | Tr=0.6568]  50%|█████     | 10/20 [01:02<00:50,  5.05s/it, CE=1.049904e+00 H=1.049426e+00 dV_dx=3.434109e-06 dV_dθ=-4.810019e-04 ||∇||=5.451479e-01 | Tr=0.6568] 50%|█████     | 10/20 [01:09<00:50,  5.05s/it, CE=1.011466e+00 H=1.011018e+00 dV_dx=-1.106185e-06 dV_dθ=-4.475285e-04 ||∇||=5.344584e-01 | Tr=0.6688 Te/Cur=0.6701 Te/Exp=0.6683] 55%|█████▌    | 11/20 [01:09<00:50,  5.63s/it, CE=1.011466e+00 H=1.011018e+00 dV_dx=-1.106185e-06 dV_dθ=-4.475285e-04 ||∇||=5.344584e-01 | Tr=0.6688 Te/Cur=0.6701 Te/Exp=0.6683] 55%|█████▌    | 11/20 [01:14<00:50,  5.63s/it, CE=9.790988e-01 H=9.786669e-01 dV_dx=-6.868279e-07 dV_dθ=-4.312019e-04 ||∇||=5.296746e-01 | Tr=0.6796]                             60%|██████    | 12/20 [01:14<00:42,  5.32s/it, CE=9.790988e-01 H=9.786669e-01 dV_dx=-6.868279e-07 dV_dθ=-4.312019e-04 ||∇||=5.296746e-01 | Tr=0.6796] 60%|██████    | 12/20 [01:19<00:42,  5.32s/it, CE=9.512304e-01 H=9.508116e-01 dV_dx=-2.520758e-08 dV_dθ=-4.188395e-04 ||∇||=5.267606e-01 | Tr=0.6883] 65%|██████▌   | 13/20 [01:19<00:36,  5.25s/it, CE=9.512304e-01 H=9.508116e-01 dV_dx=-2.520758e-08 dV_dθ=-4.188395e-04 ||∇||=5.267606e-01 | Tr=0.6883] 65%|██████▌   | 13/20 [01:24<00:36,  5.25s/it, CE=9.265347e-01 H=9.261215e-01 dV_dx=-8.357123e-07 dV_dθ=-4.123147e-04 ||∇||=5.259899e-01 | Tr=0.6958] 70%|███████   | 14/20 [01:24<00:31,  5.21s/it, CE=9.265347e-01 H=9.261215e-01 dV_dx=-8.357123e-07 dV_dθ=-4.123147e-04 ||∇||=5.259899e-01 | Tr=0.6958] 70%|███████   | 14/20 [01:29<00:31,  5.21s/it, CE=9.044754e-01 H=9.040587e-01 dV_dx=-8.714013e-07 dV_dθ=-4.158514e-04 ||∇||=5.280920e-01 | Tr=0.7020] 75%|███████▌  | 15/20 [01:29<00:25,  5.14s/it, CE=9.044754e-01 H=9.040587e-01 dV_dx=-8.714013e-07 dV_dθ=-4.158514e-04 ||∇||=5.280920e-01 | Tr=0.7020] 75%|███████▌  | 15/20 [01:36<00:25,  5.14s/it, CE=8.845389e-01 H=8.841272e-01 dV_dx=-2.670339e-06 dV_dθ=-4.090723e-04 ||∇||=5.267402e-01 | Tr=0.7076 Te/Cur=0.7077 Te/Exp=0.7135] 80%|████████  | 16/20 [01:36<00:22,  5.71s/it, CE=8.845389e-01 H=8.841272e-01 dV_dx=-2.670339e-06 dV_dθ=-4.090723e-04 ||∇||=5.267402e-01 | Tr=0.7076 Te/Cur=0.7077 Te/Exp=0.7135] 80%|████████  | 16/20 [01:41<00:22,  5.71s/it, CE=8.664324e-01 H=8.660229e-01 dV_dx=-1.353428e-06 dV_dθ=-4.081579e-04 ||∇||=5.280471e-01 | Tr=0.7145]                             85%|████████▌ | 17/20 [01:41<00:16,  5.51s/it, CE=8.664324e-01 H=8.660229e-01 dV_dx=-1.353428e-06 dV_dθ=-4.081579e-04 ||∇||=5.280471e-01 | Tr=0.7145] 85%|████████▌ | 17/20 [01:46<00:16,  5.51s/it, CE=8.496325e-01 H=8.492228e-01 dV_dx=-1.821114e-06 dV_dθ=-4.078155e-04 ||∇||=5.292146e-01 | Tr=0.7204] 90%|█████████ | 18/20 [01:46<00:10,  5.22s/it, CE=8.496325e-01 H=8.492228e-01 dV_dx=-1.821114e-06 dV_dθ=-4.078155e-04 ||∇||=5.292146e-01 | Tr=0.7204] 90%|█████████ | 18/20 [01:51<00:10,  5.22s/it, CE=8.339200e-01 H=8.335096e-01 dV_dx=-1.109210e-06 dV_dθ=-4.092922e-04 ||∇||=5.306886e-01 | Tr=0.7247] 95%|█████████▌| 19/20 [01:51<00:05,  5.08s/it, CE=8.339200e-01 H=8.335096e-01 dV_dx=-1.109210e-06 dV_dθ=-4.092922e-04 ||∇||=5.306886e-01 | Tr=0.7247] 95%|█████████▌| 19/20 [01:57<00:05,  5.08s/it, CE=8.194253e-01 H=8.190203e-01 dV_dx=1.341187e-06 dV_dθ=-4.063048e-04 ||∇||=5.309166e-01 | Tr=0.7298 Te/Cur=0.7297 Te/Exp=0.7296]100%|██████████| 20/20 [01:57<00:00,  5.57s/it, CE=8.194253e-01 H=8.190203e-01 dV_dx=1.341187e-06 dV_dθ=-4.063048e-04 ||∇||=5.309166e-01 | Tr=0.7298 Te/Cur=0.7297 Te/Exp=0.7296]100%|██████████| 20/20 [01:57<00:00,  5.89s/it, CE=8.194253e-01 H=8.190203e-01 dV_dx=1.341187e-06 dV_dθ=-4.063048e-04 ||∇||=5.309166e-01 | Tr=0.7298 Te/Cur=0.7297 Te/Exp=0.7296]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7287

============================================================
Task 1
============================================================
Initial loss on new task: 6.0640, previous: 0.8194, ratio: 7.40
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.40)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<02:55,  9.26s/it]  5%|▌         | 1/20 [00:13<02:55,  9.26s/it, CE=8.681885e-01 H=8.679836e-01 dV_dx=4.136663e-05 dV_dθ=-2.463242e-04 ||∇||=7.130572e-01 | Tr=0.7794] 10%|█         | 2/20 [00:13<01:55,  6.43s/it, CE=8.681885e-01 H=8.679836e-01 dV_dx=4.136663e-05 dV_dθ=-2.463242e-04 ||∇||=7.130572e-01 | Tr=0.7794] 10%|█         | 2/20 [00:18<01:55,  6.43s/it, CE=8.503614e-01 H=8.502488e-01 dV_dx=3.211120e-05 dV_dθ=-1.447317e-04 ||∇||=5.886296e-01 | Tr=0.8283] 15%|█▌        | 3/20 [00:18<01:39,  5.84s/it, CE=8.503614e-01 H=8.502488e-01 dV_dx=3.211120e-05 dV_dθ=-1.447317e-04 ||∇||=5.886296e-01 | Tr=0.8283] 15%|█▌        | 3/20 [00:23<01:39,  5.84s/it, CE=8.361988e-01 H=8.359964e-01 dV_dx=-8.486764e-05 dV_dθ=-1.176146e-04 ||∇||=5.378866e-01 | Tr=0.8544] 20%|██        | 4/20 [00:23<01:23,  5.23s/it, CE=8.361988e-01 H=8.359964e-01 dV_dx=-8.486764e-05 dV_dθ=-1.176146e-04 ||∇||=5.378866e-01 | Tr=0.8544] 20%|██        | 4/20 [00:28<01:23,  5.23s/it, CE=8.265320e-01 H=8.264259e-01 dV_dx=-8.699956e-06 dV_dθ=-9.741119e-05 ||∇||=5.033334e-01 | Tr=0.8702] 25%|██▌       | 5/20 [00:28<01:17,  5.20s/it, CE=8.265320e-01 H=8.264259e-01 dV_dx=-8.699956e-06 dV_dθ=-9.741119e-05 ||∇||=5.033334e-01 | Tr=0.8702] 25%|██▌       | 5/20 [00:34<01:17,  5.20s/it, CE=8.177419e-01 H=8.177040e-01 dV_dx=4.556368e-05 dV_dθ=-8.346206e-05 ||∇||=4.802836e-01 | Tr=0.8796 Te/Cur=0.8836 Te/Exp=0.7299] 30%|███       | 6/20 [00:34<01:19,  5.67s/it, CE=8.177419e-01 H=8.177040e-01 dV_dx=4.556368e-05 dV_dθ=-8.346206e-05 ||∇||=4.802836e-01 | Tr=0.8796 Te/Cur=0.8836 Te/Exp=0.7299] 30%|███       | 6/20 [00:39<01:19,  5.67s/it, CE=8.107111e-01 H=8.106313e-01 dV_dx=-5.371142e-06 dV_dθ=-7.448589e-05 ||∇||=4.632583e-01 | Tr=0.8871]                            35%|███▌      | 7/20 [00:39<01:09,  5.35s/it, CE=8.107111e-01 H=8.106313e-01 dV_dx=-5.371142e-06 dV_dθ=-7.448589e-05 ||∇||=4.632583e-01 | Tr=0.8871] 35%|███▌      | 7/20 [00:44<01:09,  5.35s/it, CE=8.045828e-01 H=8.044834e-01 dV_dx=-2.983187e-05 dV_dθ=-6.952092e-05 ||∇||=4.510546e-01 | Tr=0.8933] 40%|████      | 8/20 [00:44<01:01,  5.16s/it, CE=8.045828e-01 H=8.044834e-01 dV_dx=-2.983187e-05 dV_dθ=-6.952092e-05 ||∇||=4.510546e-01 | Tr=0.8933] 40%|████      | 8/20 [00:49<01:01,  5.16s/it, CE=7.988247e-01 H=7.987228e-01 dV_dx=-3.372500e-05 dV_dθ=-6.818057e-05 ||∇||=4.429088e-01 | Tr=0.8982] 45%|████▌     | 9/20 [00:49<00:56,  5.13s/it, CE=7.988247e-01 H=7.987228e-01 dV_dx=-3.372500e-05 dV_dθ=-6.818057e-05 ||∇||=4.429088e-01 | Tr=0.8982] 45%|████▌     | 9/20 [00:54<00:56,  5.13s/it, CE=7.930036e-01 H=7.929687e-01 dV_dx=2.795112e-05 dV_dθ=-6.285618e-05 ||∇||=4.350878e-01 | Tr=0.9029]  50%|█████     | 10/20 [00:54<00:52,  5.25s/it, CE=7.930036e-01 H=7.929687e-01 dV_dx=2.795112e-05 dV_dθ=-6.285618e-05 ||∇||=4.350878e-01 | Tr=0.9029] 50%|█████     | 10/20 [01:02<00:52,  5.25s/it, CE=7.871836e-01 H=7.871322e-01 dV_dx=1.398107e-05 dV_dθ=-6.544187e-05 ||∇||=4.317672e-01 | Tr=0.9063 Te/Cur=0.9089 Te/Exp=0.7376] 55%|█████▌    | 11/20 [01:02<00:53,  5.92s/it, CE=7.871836e-01 H=7.871322e-01 dV_dx=1.398107e-05 dV_dθ=-6.544187e-05 ||∇||=4.317672e-01 | Tr=0.9063 Te/Cur=0.9089 Te/Exp=0.7376] 55%|█████▌    | 11/20 [01:07<00:53,  5.92s/it, CE=7.816538e-01 H=7.816089e-01 dV_dx=2.483439e-05 dV_dθ=-6.974518e-05 ||∇||=4.308823e-01 | Tr=0.9095]                             60%|██████    | 12/20 [01:07<00:44,  5.60s/it, CE=7.816538e-01 H=7.816089e-01 dV_dx=2.483439e-05 dV_dθ=-6.974518e-05 ||∇||=4.308823e-01 | Tr=0.9095] 60%|██████    | 12/20 [01:11<00:44,  5.60s/it, CE=7.760920e-01 H=7.760806e-01 dV_dx=5.553854e-05 dV_dθ=-6.698887e-05 ||∇||=4.266422e-01 | Tr=0.9128] 65%|██████▌   | 13/20 [01:11<00:37,  5.34s/it, CE=7.760920e-01 H=7.760806e-01 dV_dx=5.553854e-05 dV_dθ=-6.698887e-05 ||∇||=4.266422e-01 | Tr=0.9128] 65%|██████▌   | 13/20 [01:17<00:37,  5.34s/it, CE=7.705778e-01 H=7.705663e-01 dV_dx=5.648034e-05 dV_dθ=-6.802378e-05 ||∇||=4.252812e-01 | Tr=0.9159] 70%|███████   | 14/20 [01:17<00:31,  5.31s/it, CE=7.705778e-01 H=7.705663e-01 dV_dx=5.648034e-05 dV_dθ=-6.802378e-05 ||∇||=4.252812e-01 | Tr=0.9159] 70%|███████   | 14/20 [01:21<00:31,  5.31s/it, CE=7.652795e-01 H=7.652399e-01 dV_dx=2.952876e-05 dV_dθ=-6.908332e-05 ||∇||=4.233634e-01 | Tr=0.9185] 75%|███████▌  | 15/20 [01:21<00:25,  5.13s/it, CE=7.652795e-01 H=7.652399e-01 dV_dx=2.952876e-05 dV_dθ=-6.908332e-05 ||∇||=4.233634e-01 | Tr=0.9185] 75%|███████▌  | 15/20 [01:28<00:25,  5.13s/it, CE=7.602199e-01 H=7.601514e-01 dV_dx=1.581018e-06 dV_dθ=-7.010892e-05 ||∇||=4.218108e-01 | Tr=0.9211 Te/Cur=0.9211 Te/Exp=0.7494] 80%|████████  | 16/20 [01:28<00:22,  5.65s/it, CE=7.602199e-01 H=7.601514e-01 dV_dx=1.581018e-06 dV_dθ=-7.010892e-05 ||∇||=4.218108e-01 | Tr=0.9211 Te/Cur=0.9211 Te/Exp=0.7494] 80%|████████  | 16/20 [01:33<00:22,  5.65s/it, CE=7.552684e-01 H=7.552605e-01 dV_dx=6.384092e-05 dV_dθ=-7.174335e-05 ||∇||=4.209636e-01 | Tr=0.9235]                             85%|████████▌ | 17/20 [01:33<00:16,  5.46s/it, CE=7.552684e-01 H=7.552605e-01 dV_dx=6.384092e-05 dV_dθ=-7.174335e-05 ||∇||=4.209636e-01 | Tr=0.9235] 85%|████████▌ | 17/20 [01:38<00:16,  5.46s/it, CE=7.503642e-01 H=7.503341e-01 dV_dx=4.201338e-05 dV_dθ=-7.210096e-05 ||∇||=4.206850e-01 | Tr=0.9257] 90%|█████████ | 18/20 [01:38<00:10,  5.30s/it, CE=7.503642e-01 H=7.503341e-01 dV_dx=4.201338e-05 dV_dθ=-7.210096e-05 ||∇||=4.206850e-01 | Tr=0.9257] 90%|█████████ | 18/20 [01:43<00:10,  5.30s/it, CE=7.455408e-01 H=7.454396e-01 dV_dx=-2.841479e-05 dV_dθ=-7.281731e-05 ||∇||=4.194712e-01 | Tr=0.9275] 95%|█████████▌| 19/20 [01:43<00:05,  5.21s/it, CE=7.455408e-01 H=7.454396e-01 dV_dx=-2.841479e-05 dV_dθ=-7.281731e-05 ||∇||=4.194712e-01 | Tr=0.9275] 95%|█████████▌| 19/20 [01:50<00:05,  5.21s/it, CE=7.408308e-01 H=7.407826e-01 dV_dx=2.520089e-05 dV_dθ=-7.345827e-05 ||∇||=4.185729e-01 | Tr=0.9291 Te/Cur=0.9255 Te/Exp=0.7563]100%|██████████| 20/20 [01:50<00:00,  5.65s/it, CE=7.408308e-01 H=7.407826e-01 dV_dx=2.520089e-05 dV_dθ=-7.345827e-05 ||∇||=4.185729e-01 | Tr=0.9291 Te/Cur=0.9255 Te/Exp=0.7563]100%|██████████| 20/20 [01:50<00:00,  5.52s/it, CE=7.408308e-01 H=7.407826e-01 dV_dx=2.520089e-05 dV_dθ=-7.345827e-05 ||∇||=4.185729e-01 | Tr=0.9291 Te/Cur=0.9255 Te/Exp=0.7563]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.7553
    Task 1: 0.9264

============================================================
Task 2
============================================================
Initial loss on new task: 4.7721, previous: 0.7408, ratio: 6.44
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=6.44)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:05,  9.79s/it]  5%|▌         | 1/20 [00:13<03:05,  9.79s/it, CE=6.730329e-01 H=6.748078e-01 dV_dx=1.249684e-05 dV_dθ=1.762487e-03 ||∇||=7.989260e-01 | Tr=0.6336] 10%|█         | 2/20 [00:13<01:50,  6.14s/it, CE=6.730329e-01 H=6.748078e-01 dV_dx=1.249684e-05 dV_dθ=1.762487e-03 ||∇||=7.989260e-01 | Tr=0.6336] 10%|█         | 2/20 [00:18<01:50,  6.14s/it, CE=6.327197e-01 H=6.336877e-01 dV_dx=-4.276495e-05 dV_dθ=1.010775e-03 ||∇||=7.090778e-01 | Tr=0.6854] 15%|█▌        | 3/20 [00:18<01:35,  5.60s/it, CE=6.327197e-01 H=6.336877e-01 dV_dx=-4.276495e-05 dV_dθ=1.010775e-03 ||∇||=7.090778e-01 | Tr=0.6854] 15%|█▌        | 3/20 [00:23<01:35,  5.60s/it, CE=6.105952e-01 H=6.113139e-01 dV_dx=2.524394e-05 dV_dθ=6.934538e-04 ||∇||=6.607815e-01 | Tr=0.7155]  20%|██        | 4/20 [00:23<01:25,  5.35s/it, CE=6.105952e-01 H=6.113139e-01 dV_dx=2.524394e-05 dV_dθ=6.934538e-04 ||∇||=6.607815e-01 | Tr=0.7155] 20%|██        | 4/20 [00:27<01:25,  5.35s/it, CE=5.951582e-01 H=5.956172e-01 dV_dx=-1.070642e-05 dV_dθ=4.697471e-04 ||∇||=6.349611e-01 | Tr=0.7372] 25%|██▌       | 5/20 [00:27<01:13,  4.87s/it, CE=5.951582e-01 H=5.956172e-01 dV_dx=-1.070642e-05 dV_dθ=4.697471e-04 ||∇||=6.349611e-01 | Tr=0.7372] 25%|██▌       | 5/20 [00:33<01:13,  4.87s/it, CE=5.839471e-01 H=5.842819e-01 dV_dx=-2.518251e-05 dV_dθ=3.600508e-04 ||∇||=6.184524e-01 | Tr=0.7528 Te/Cur=0.7574 Te/Exp=0.8140] 30%|███       | 6/20 [00:33<01:16,  5.46s/it, CE=5.839471e-01 H=5.842819e-01 dV_dx=-2.518251e-05 dV_dθ=3.600508e-04 ||∇||=6.184524e-01 | Tr=0.7528 Te/Cur=0.7574 Te/Exp=0.8140] 30%|███       | 6/20 [00:38<01:16,  5.46s/it, CE=5.746755e-01 H=5.749680e-01 dV_dx=1.369684e-05 dV_dθ=2.787833e-04 ||∇||=6.060454e-01 | Tr=0.7633]                              35%|███▌      | 7/20 [00:38<01:07,  5.20s/it, CE=5.746755e-01 H=5.749680e-01 dV_dx=1.369684e-05 dV_dθ=2.787833e-04 ||∇||=6.060454e-01 | Tr=0.7633] 35%|███▌      | 7/20 [00:43<01:07,  5.20s/it, CE=5.666421e-01 H=5.668164e-01 dV_dx=-3.698530e-05 dV_dθ=2.112244e-04 ||∇||=5.962940e-01 | Tr=0.7726] 40%|████      | 8/20 [00:43<01:00,  5.04s/it, CE=5.666421e-01 H=5.668164e-01 dV_dx=-3.698530e-05 dV_dθ=2.112244e-04 ||∇||=5.962940e-01 | Tr=0.7726] 40%|████      | 8/20 [00:48<01:00,  5.04s/it, CE=5.595114e-01 H=5.596487e-01 dV_dx=-2.336694e-05 dV_dθ=1.606131e-04 ||∇||=5.894000e-01 | Tr=0.7803] 45%|████▌     | 9/20 [00:48<00:55,  5.09s/it, CE=5.595114e-01 H=5.596487e-01 dV_dx=-2.336694e-05 dV_dθ=1.606131e-04 ||∇||=5.894000e-01 | Tr=0.7803] 45%|████▌     | 9/20 [00:53<00:55,  5.09s/it, CE=5.532040e-01 H=5.533423e-01 dV_dx=1.653393e-05 dV_dθ=1.217748e-04 ||∇||=5.847502e-01 | Tr=0.7874]  50%|█████     | 10/20 [00:53<00:51,  5.10s/it, CE=5.532040e-01 H=5.533423e-01 dV_dx=1.653393e-05 dV_dθ=1.217748e-04 ||∇||=5.847502e-01 | Tr=0.7874] 50%|█████     | 10/20 [00:59<00:51,  5.10s/it, CE=5.471645e-01 H=5.472599e-01 dV_dx=9.669705e-06 dV_dθ=8.576046e-05 ||∇||=5.820673e-01 | Tr=0.7934 Te/Cur=0.7935 Te/Exp=0.8188] 55%|█████▌    | 11/20 [00:59<00:49,  5.49s/it, CE=5.471645e-01 H=5.472599e-01 dV_dx=9.669705e-06 dV_dθ=8.576046e-05 ||∇||=5.820673e-01 | Tr=0.7934 Te/Cur=0.7935 Te/Exp=0.8188] 55%|█████▌    | 11/20 [01:04<00:49,  5.49s/it, CE=5.416138e-01 H=5.416611e-01 dV_dx=-7.657926e-06 dV_dθ=5.500378e-05 ||∇||=5.806876e-01 | Tr=0.7993]                            60%|██████    | 12/20 [01:04<00:42,  5.27s/it, CE=5.416138e-01 H=5.416611e-01 dV_dx=-7.657926e-06 dV_dθ=5.500378e-05 ||∇||=5.806876e-01 | Tr=0.7993] 60%|██████    | 12/20 [01:09<00:42,  5.27s/it, CE=5.364295e-01 H=5.364535e-01 dV_dx=-6.563809e-06 dV_dθ=3.060767e-05 ||∇||=5.788071e-01 | Tr=0.8035] 65%|██████▌   | 13/20 [01:09<00:36,  5.17s/it, CE=5.364295e-01 H=5.364535e-01 dV_dx=-6.563809e-06 dV_dθ=3.060767e-05 ||∇||=5.788071e-01 | Tr=0.8035] 65%|██████▌   | 13/20 [01:14<00:36,  5.17s/it, CE=5.314859e-01 H=5.314879e-01 dV_dx=-7.940660e-06 dV_dθ=9.955748e-06 ||∇||=5.774254e-01 | Tr=0.8074] 70%|███████   | 14/20 [01:14<00:30,  5.03s/it, CE=5.314859e-01 H=5.314879e-01 dV_dx=-7.940660e-06 dV_dθ=9.955748e-06 ||∇||=5.774254e-01 | Tr=0.8074] 70%|███████   | 14/20 [01:19<00:30,  5.03s/it, CE=5.269777e-01 H=5.269409e-01 dV_dx=-3.003174e-05 dV_dθ=-6.844531e-06 ||∇||=5.761821e-01 | Tr=0.8111] 75%|███████▌  | 15/20 [01:19<00:24,  4.99s/it, CE=5.269777e-01 H=5.269409e-01 dV_dx=-3.003174e-05 dV_dθ=-6.844531e-06 ||∇||=5.761821e-01 | Tr=0.8111] 75%|███████▌  | 15/20 [01:26<00:24,  4.99s/it, CE=5.226887e-01 H=5.226975e-01 dV_dx=3.286484e-05 dV_dθ=-2.409617e-05 ||∇||=5.768062e-01 | Tr=0.8149 Te/Cur=0.8140 Te/Exp=0.8209] 80%|████████  | 16/20 [01:26<00:22,  5.56s/it, CE=5.226887e-01 H=5.226975e-01 dV_dx=3.286484e-05 dV_dθ=-2.409617e-05 ||∇||=5.768062e-01 | Tr=0.8149 Te/Cur=0.8140 Te/Exp=0.8209] 80%|████████  | 16/20 [01:31<00:22,  5.56s/it, CE=5.184851e-01 H=5.184156e-01 dV_dx=-3.072002e-05 dV_dθ=-3.874313e-05 ||∇||=5.780540e-01 | Tr=0.8179]                            85%|████████▌ | 17/20 [01:31<00:16,  5.38s/it, CE=5.184851e-01 H=5.184156e-01 dV_dx=-3.072002e-05 dV_dθ=-3.874313e-05 ||∇||=5.780540e-01 | Tr=0.8179] 85%|████████▌ | 17/20 [01:36<00:16,  5.38s/it, CE=5.145603e-01 H=5.145098e-01 dV_dx=4.516682e-07 dV_dθ=-5.100987e-05 ||∇||=5.795976e-01 | Tr=0.8212]  90%|█████████ | 18/20 [01:36<00:10,  5.28s/it, CE=5.145603e-01 H=5.145098e-01 dV_dx=4.516682e-07 dV_dθ=-5.100987e-05 ||∇||=5.795976e-01 | Tr=0.8212] 90%|█████████ | 18/20 [01:40<00:10,  5.28s/it, CE=5.109531e-01 H=5.108757e-01 dV_dx=-1.500535e-05 dV_dθ=-6.238466e-05 ||∇||=5.803349e-01 | Tr=0.8240] 95%|█████████▌| 19/20 [01:40<00:05,  5.10s/it, CE=5.109531e-01 H=5.108757e-01 dV_dx=-1.500535e-05 dV_dθ=-6.238466e-05 ||∇||=5.803349e-01 | Tr=0.8240] 95%|█████████▌| 19/20 [01:47<00:05,  5.10s/it, CE=5.075264e-01 H=5.074538e-01 dV_dx=7.515283e-07 dV_dθ=-7.333454e-05 ||∇||=5.819821e-01 | Tr=0.8271 Te/Cur=0.8215 Te/Exp=0.8259]100%|██████████| 20/20 [01:47<00:00,  5.60s/it, CE=5.075264e-01 H=5.074538e-01 dV_dx=7.515283e-07 dV_dθ=-7.333454e-05 ||∇||=5.819821e-01 | Tr=0.8271 Te/Cur=0.8215 Te/Exp=0.8259]100%|██████████| 20/20 [01:47<00:00,  5.38s/it, CE=5.075264e-01 H=5.074538e-01 dV_dx=7.515283e-07 dV_dθ=-7.333454e-05 ||∇||=5.819821e-01 | Tr=0.8271 Te/Cur=0.8215 Te/Exp=0.8259]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.7222
    Task 1: 0.9296
    Task 2: 0.8219

============================================================
Task 3
============================================================
Initial loss on new task: 4.2803, previous: 0.5075, ratio: 8.43
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=8.43)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:32, 11.17s/it]  5%|▌         | 1/20 [00:14<03:32, 11.17s/it, CE=5.708980e-01 H=5.707441e-01 dV_dx=2.934329e-05 dV_dθ=-1.832511e-04 ||∇||=8.589158e-01 | Tr=0.4330] 10%|█         | 2/20 [00:14<02:02,  6.80s/it, CE=5.708980e-01 H=5.707441e-01 dV_dx=2.934329e-05 dV_dθ=-1.832511e-04 ||∇||=8.589158e-01 | Tr=0.4330] 10%|█         | 2/20 [00:19<02:02,  6.80s/it, CE=5.550290e-01 H=5.548148e-01 dV_dx=-2.009303e-05 dV_dθ=-1.941292e-04 ||∇||=7.790090e-01 | Tr=0.4722] 15%|█▌        | 3/20 [00:19<01:35,  5.64s/it, CE=5.550290e-01 H=5.548148e-01 dV_dx=-2.009303e-05 dV_dθ=-1.941292e-04 ||∇||=7.790090e-01 | Tr=0.4722] 15%|█▌        | 3/20 [00:24<01:35,  5.64s/it, CE=5.467215e-01 H=5.465307e-01 dV_dx=2.330255e-05 dV_dθ=-2.140757e-04 ||∇||=7.658661e-01 | Tr=0.4965]  20%|██        | 4/20 [00:24<01:25,  5.34s/it, CE=5.467215e-01 H=5.465307e-01 dV_dx=2.330255e-05 dV_dθ=-2.140757e-04 ||∇||=7.658661e-01 | Tr=0.4965] 20%|██        | 4/20 [00:28<01:25,  5.34s/it, CE=5.406642e-01 H=5.404741e-01 dV_dx=3.944965e-05 dV_dθ=-2.295130e-04 ||∇||=7.514553e-01 | Tr=0.5093] 25%|██▌       | 5/20 [00:28<01:17,  5.19s/it, CE=5.406642e-01 H=5.404741e-01 dV_dx=3.944965e-05 dV_dθ=-2.295130e-04 ||∇||=7.514553e-01 | Tr=0.5093] 25%|██▌       | 5/20 [00:35<01:17,  5.19s/it, CE=5.357232e-01 H=5.354797e-01 dV_dx=3.377389e-06 dV_dθ=-2.469742e-04 ||∇||=7.481915e-01 | Tr=0.5165 Te/Cur=0.5148 Te/Exp=0.8202] 30%|███       | 6/20 [00:35<01:19,  5.66s/it, CE=5.357232e-01 H=5.354797e-01 dV_dx=3.377389e-06 dV_dθ=-2.469742e-04 ||∇||=7.481915e-01 | Tr=0.5165 Te/Cur=0.5148 Te/Exp=0.8202] 30%|███       | 6/20 [00:40<01:19,  5.66s/it, CE=5.315652e-01 H=5.313290e-01 dV_dx=1.762307e-05 dV_dθ=-2.537899e-04 ||∇||=7.454590e-01 | Tr=0.5228]                             35%|███▌      | 7/20 [00:40<01:10,  5.46s/it, CE=5.315652e-01 H=5.313290e-01 dV_dx=1.762307e-05 dV_dθ=-2.537899e-04 ||∇||=7.454590e-01 | Tr=0.5228] 35%|███▌      | 7/20 [00:45<01:10,  5.46s/it, CE=5.276663e-01 H=5.273941e-01 dV_dx=-1.382762e-05 dV_dθ=-2.583711e-04 ||∇||=7.435530e-01 | Tr=0.5279] 40%|████      | 8/20 [00:45<01:04,  5.36s/it, CE=5.276663e-01 H=5.273941e-01 dV_dx=-1.382762e-05 dV_dθ=-2.583711e-04 ||∇||=7.435530e-01 | Tr=0.5279] 40%|████      | 8/20 [00:50<01:04,  5.36s/it, CE=5.239998e-01 H=5.237271e-01 dV_dx=-2.831539e-06 dV_dθ=-2.698700e-04 ||∇||=7.472416e-01 | Tr=0.5322] 45%|████▌     | 9/20 [00:50<00:57,  5.21s/it, CE=5.239998e-01 H=5.237271e-01 dV_dx=-2.831539e-06 dV_dθ=-2.698700e-04 ||∇||=7.472416e-01 | Tr=0.5322] 45%|████▌     | 9/20 [00:55<00:57,  5.21s/it, CE=5.205598e-01 H=5.202700e-01 dV_dx=-6.932277e-06 dV_dθ=-2.828163e-04 ||∇||=7.516696e-01 | Tr=0.5366] 50%|█████     | 10/20 [00:55<00:51,  5.15s/it, CE=5.205598e-01 H=5.202700e-01 dV_dx=-6.932277e-06 dV_dθ=-2.828163e-04 ||∇||=7.516696e-01 | Tr=0.5366] 50%|█████     | 10/20 [01:02<00:51,  5.15s/it, CE=5.173150e-01 H=5.170704e-01 dV_dx=3.425114e-05 dV_dθ=-2.788468e-04 ||∇||=7.469012e-01 | Tr=0.5402 Te/Cur=0.5357 Te/Exp=0.8283] 55%|█████▌    | 11/20 [01:02<00:51,  5.72s/it, CE=5.173150e-01 H=5.170704e-01 dV_dx=3.425114e-05 dV_dθ=-2.788468e-04 ||∇||=7.469012e-01 | Tr=0.5402 Te/Cur=0.5357 Te/Exp=0.8283] 55%|█████▌    | 11/20 [01:07<00:51,  5.72s/it, CE=5.141779e-01 H=5.139285e-01 dV_dx=3.067038e-05 dV_dθ=-2.800823e-04 ||∇||=7.474627e-01 | Tr=0.5432]                             60%|██████    | 12/20 [01:07<00:43,  5.43s/it, CE=5.141779e-01 H=5.139285e-01 dV_dx=3.067038e-05 dV_dθ=-2.800823e-04 ||∇||=7.474627e-01 | Tr=0.5432] 60%|██████    | 12/20 [01:12<00:43,  5.43s/it, CE=5.111153e-01 H=5.107960e-01 dV_dx=-3.423307e-05 dV_dθ=-2.850101e-04 ||∇||=7.499235e-01 | Tr=0.5457] 65%|██████▌   | 13/20 [01:12<00:38,  5.43s/it, CE=5.111153e-01 H=5.107960e-01 dV_dx=-3.423307e-05 dV_dθ=-2.850101e-04 ||∇||=7.499235e-01 | Tr=0.5457] 65%|██████▌   | 13/20 [01:18<00:38,  5.43s/it, CE=5.081735e-01 H=5.079313e-01 dV_dx=4.466435e-05 dV_dθ=-2.868519e-04 ||∇||=7.519780e-01 | Tr=0.5480]  70%|███████   | 14/20 [01:18<00:32,  5.35s/it, CE=5.081735e-01 H=5.079313e-01 dV_dx=4.466435e-05 dV_dθ=-2.868519e-04 ||∇||=7.519780e-01 | Tr=0.5480] 70%|███████   | 14/20 [01:22<00:32,  5.35s/it, CE=5.053820e-01 H=5.050614e-01 dV_dx=-2.661849e-05 dV_dθ=-2.939917e-04 ||∇||=7.567424e-01 | Tr=0.5505] 75%|███████▌  | 15/20 [01:22<00:26,  5.22s/it, CE=5.053820e-01 H=5.050614e-01 dV_dx=-2.661849e-05 dV_dθ=-2.939917e-04 ||∇||=7.567424e-01 | Tr=0.5505] 75%|███████▌  | 15/20 [01:29<00:26,  5.22s/it, CE=5.026215e-01 H=5.023651e-01 dV_dx=4.028435e-05 dV_dθ=-2.966664e-04 ||∇||=7.575740e-01 | Tr=0.5523 Te/Cur=0.5491 Te/Exp=0.8313] 80%|████████  | 16/20 [01:29<00:22,  5.72s/it, CE=5.026215e-01 H=5.023651e-01 dV_dx=4.028435e-05 dV_dθ=-2.966664e-04 ||∇||=7.575740e-01 | Tr=0.5523 Te/Cur=0.5491 Te/Exp=0.8313] 80%|████████  | 16/20 [01:34<00:22,  5.72s/it, CE=4.999700e-01 H=4.996653e-01 dV_dx=-5.819879e-06 dV_dθ=-2.988510e-04 ||∇||=7.597989e-01 | Tr=0.5546]                            85%|████████▌ | 17/20 [01:34<00:16,  5.47s/it, CE=4.999700e-01 H=4.996653e-01 dV_dx=-5.819879e-06 dV_dθ=-2.988510e-04 ||∇||=7.597989e-01 | Tr=0.5546] 85%|████████▌ | 17/20 [01:39<00:16,  5.47s/it, CE=4.974004e-01 H=4.970967e-01 dV_dx=-5.750739e-06 dV_dθ=-2.978905e-04 ||∇||=7.602993e-01 | Tr=0.5569] 90%|█████████ | 18/20 [01:39<00:10,  5.30s/it, CE=4.974004e-01 H=4.970967e-01 dV_dx=-5.750739e-06 dV_dθ=-2.978905e-04 ||∇||=7.602993e-01 | Tr=0.5569] 90%|█████████ | 18/20 [01:44<00:10,  5.30s/it, CE=4.948902e-01 H=4.945717e-01 dV_dx=-1.652054e-05 dV_dθ=-3.019324e-04 ||∇||=7.623199e-01 | Tr=0.5588] 95%|█████████▌| 19/20 [01:44<00:05,  5.26s/it, CE=4.948902e-01 H=4.945717e-01 dV_dx=-1.652054e-05 dV_dθ=-3.019324e-04 ||∇||=7.623199e-01 | Tr=0.5588] 95%|█████████▌| 19/20 [01:51<00:05,  5.26s/it, CE=4.924046e-01 H=4.921011e-01 dV_dx=2.918612e-06 dV_dθ=-3.064655e-04 ||∇||=7.652522e-01 | Tr=0.5601 Te/Cur=0.5567 Te/Exp=0.8321]100%|██████████| 20/20 [01:51<00:00,  5.73s/it, CE=4.924046e-01 H=4.921011e-01 dV_dx=2.918612e-06 dV_dθ=-3.064655e-04 ||∇||=7.652522e-01 | Tr=0.5601 Te/Cur=0.5567 Te/Exp=0.8321]100%|██████████| 20/20 [01:51<00:00,  5.58s/it, CE=4.924046e-01 H=4.921011e-01 dV_dx=2.918612e-06 dV_dθ=-3.064655e-04 ||∇||=7.652522e-01 | Tr=0.5601 Te/Cur=0.5567 Te/Exp=0.8321]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.7387
    Task 1: 0.9358
    Task 2: 0.8250
    Task 3: 0.5539

============================================================
Task 4
============================================================
Initial loss on new task: 1.2532, previous: 0.4924, ratio: 2.54
Standard CL training (lr=0.000100, adaptive_lr_min=7.00e-05, loss_ratio=2.54)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:45, 11.88s/it]  5%|▌         | 1/20 [00:15<03:45, 11.88s/it, CE=7.324987e-01 H=7.324936e-01 dV_dx=-1.261209e-05 dV_dθ=7.466652e-06 ||∇||=5.620847e-01 | Tr=0.9078] 10%|█         | 2/20 [00:15<02:08,  7.15s/it, CE=7.324987e-01 H=7.324936e-01 dV_dx=-1.261209e-05 dV_dθ=7.466652e-06 ||∇||=5.620847e-01 | Tr=0.9078] 10%|█         | 2/20 [00:19<02:08,  7.15s/it, CE=7.239368e-01 H=7.238924e-01 dV_dx=-3.679895e-05 dV_dθ=-7.603513e-06 ||∇||=5.197845e-01 | Tr=0.9180] 15%|█▌        | 3/20 [00:19<01:37,  5.75s/it, CE=7.239368e-01 H=7.238924e-01 dV_dx=-3.679895e-05 dV_dθ=-7.603513e-06 ||∇||=5.197845e-01 | Tr=0.9180] 15%|█▌        | 3/20 [00:24<01:37,  5.75s/it, CE=7.180936e-01 H=7.180785e-01 dV_dx=1.602686e-05 dV_dθ=-3.108495e-05 ||∇||=5.060298e-01 | Tr=0.9241]  20%|██        | 4/20 [00:24<01:24,  5.26s/it, CE=7.180936e-01 H=7.180785e-01 dV_dx=1.602686e-05 dV_dθ=-3.108495e-05 ||∇||=5.060298e-01 | Tr=0.9241] 20%|██        | 4/20 [00:29<01:24,  5.26s/it, CE=7.130901e-01 H=7.130109e-01 dV_dx=-3.399015e-05 dV_dθ=-4.520502e-05 ||∇||=4.971956e-01 | Tr=0.9286] 25%|██▌       | 5/20 [00:29<01:17,  5.20s/it, CE=7.130901e-01 H=7.130109e-01 dV_dx=-3.399015e-05 dV_dθ=-4.520502e-05 ||∇||=4.971956e-01 | Tr=0.9286] 25%|██▌       | 5/20 [00:36<01:17,  5.20s/it, CE=7.084120e-01 H=7.083647e-01 dV_dx=2.491574e-06 dV_dθ=-4.980808e-05 ||∇||=4.863947e-01 | Tr=0.9322 Te/Cur=0.9333 Te/Exp=0.7529] 30%|███       | 6/20 [00:36<01:20,  5.77s/it, CE=7.084120e-01 H=7.083647e-01 dV_dx=2.491574e-06 dV_dθ=-4.980808e-05 ||∇||=4.863947e-01 | Tr=0.9322 Te/Cur=0.9333 Te/Exp=0.7529] 30%|███       | 6/20 [00:40<01:20,  5.77s/it, CE=7.040200e-01 H=7.038999e-01 dV_dx=-6.371339e-05 dV_dθ=-5.638748e-05 ||∇||=4.795668e-01 | Tr=0.9352]                            35%|███▌      | 7/20 [00:40<01:08,  5.27s/it, CE=7.040200e-01 H=7.038999e-01 dV_dx=-6.371339e-05 dV_dθ=-5.638748e-05 ||∇||=4.795668e-01 | Tr=0.9352] 35%|███▌      | 7/20 [00:45<01:08,  5.27s/it, CE=6.999042e-01 H=6.997679e-01 dV_dx=-7.535017e-05 dV_dθ=-6.098992e-05 ||∇||=4.734453e-01 | Tr=0.9381] 40%|████      | 8/20 [00:45<01:00,  5.06s/it, CE=6.999042e-01 H=6.997679e-01 dV_dx=-7.535017e-05 dV_dθ=-6.098992e-05 ||∇||=4.734453e-01 | Tr=0.9381] 40%|████      | 8/20 [00:50<01:00,  5.06s/it, CE=6.960629e-01 H=6.959840e-01 dV_dx=-1.700286e-05 dV_dθ=-6.186304e-05 ||∇||=4.670030e-01 | Tr=0.9407] 45%|████▌     | 9/20 [00:50<00:55,  5.04s/it, CE=6.960629e-01 H=6.959840e-01 dV_dx=-1.700286e-05 dV_dθ=-6.186304e-05 ||∇||=4.670030e-01 | Tr=0.9407] 45%|████▌     | 9/20 [00:54<00:55,  5.04s/it, CE=6.923788e-01 H=6.922971e-01 dV_dx=-1.731675e-05 dV_dθ=-6.438359e-05 ||∇||=4.618209e-01 | Tr=0.9430] 50%|█████     | 10/20 [00:54<00:48,  4.90s/it, CE=6.923788e-01 H=6.922971e-01 dV_dx=-1.731675e-05 dV_dθ=-6.438359e-05 ||∇||=4.618209e-01 | Tr=0.9430] 50%|█████     | 10/20 [01:01<00:48,  4.90s/it, CE=6.888310e-01 H=6.887806e-01 dV_dx=1.757054e-05 dV_dθ=-6.797338e-05 ||∇||=4.584556e-01 | Tr=0.9453 Te/Cur=0.9434 Te/Exp=0.7597] 55%|█████▌    | 11/20 [01:01<00:49,  5.48s/it, CE=6.888310e-01 H=6.887806e-01 dV_dx=1.757054e-05 dV_dθ=-6.797338e-05 ||∇||=4.584556e-01 | Tr=0.9453 Te/Cur=0.9434 Te/Exp=0.7597] 55%|█████▌    | 11/20 [01:06<00:49,  5.48s/it, CE=6.855169e-01 H=6.853951e-01 dV_dx=-5.174980e-05 dV_dθ=-7.012521e-05 ||∇||=4.555342e-01 | Tr=0.9470]                            60%|██████    | 12/20 [01:06<00:41,  5.24s/it, CE=6.855169e-01 H=6.853951e-01 dV_dx=-5.174980e-05 dV_dθ=-7.012521e-05 ||∇||=4.555342e-01 | Tr=0.9470] 60%|██████    | 12/20 [01:10<00:41,  5.24s/it, CE=6.823754e-01 H=6.823021e-01 dV_dx=-3.336844e-06 dV_dθ=-6.996310e-05 ||∇||=4.519768e-01 | Tr=0.9485] 65%|██████▌   | 13/20 [01:10<00:34,  4.98s/it, CE=6.823754e-01 H=6.823021e-01 dV_dx=-3.336844e-06 dV_dθ=-6.996310e-05 ||∇||=4.519768e-01 | Tr=0.9485] 65%|██████▌   | 13/20 [01:15<00:34,  4.98s/it, CE=6.793524e-01 H=6.792935e-01 dV_dx=1.216083e-05 dV_dθ=-7.100637e-05 ||∇||=4.489075e-01 | Tr=0.9502]  70%|███████   | 14/20 [01:15<00:30,  5.03s/it, CE=6.793524e-01 H=6.792935e-01 dV_dx=1.216083e-05 dV_dθ=-7.100637e-05 ||∇||=4.489075e-01 | Tr=0.9502] 70%|███████   | 14/20 [01:20<00:30,  5.03s/it, CE=6.764760e-01 H=6.763898e-01 dV_dx=-1.569468e-05 dV_dθ=-7.052690e-05 ||∇||=4.452634e-01 | Tr=0.9515] 75%|███████▌  | 15/20 [01:20<00:25,  5.08s/it, CE=6.764760e-01 H=6.763898e-01 dV_dx=-1.569468e-05 dV_dθ=-7.052690e-05 ||∇||=4.452634e-01 | Tr=0.9515] 75%|███████▌  | 15/20 [01:27<00:25,  5.08s/it, CE=6.736057e-01 H=6.735371e-01 dV_dx=2.081558e-06 dV_dθ=-7.063540e-05 ||∇||=4.420869e-01 | Tr=0.9529 Te/Cur=0.9540 Te/Exp=0.7596] 80%|████████  | 16/20 [01:27<00:22,  5.60s/it, CE=6.736057e-01 H=6.735371e-01 dV_dx=2.081558e-06 dV_dθ=-7.063540e-05 ||∇||=4.420869e-01 | Tr=0.9529 Te/Cur=0.9540 Te/Exp=0.7596] 80%|████████  | 16/20 [01:32<00:22,  5.60s/it, CE=6.708734e-01 H=6.708526e-01 dV_dx=4.985984e-05 dV_dθ=-7.063703e-05 ||∇||=4.396191e-01 | Tr=0.9547]                             85%|████████▌ | 17/20 [01:32<00:16,  5.36s/it, CE=6.708734e-01 H=6.708526e-01 dV_dx=4.985984e-05 dV_dθ=-7.063703e-05 ||∇||=4.396191e-01 | Tr=0.9547] 85%|████████▌ | 17/20 [01:37<00:16,  5.36s/it, CE=6.682041e-01 H=6.682128e-01 dV_dx=7.924726e-05 dV_dθ=-7.060152e-05 ||∇||=4.367100e-01 | Tr=0.9560] 90%|█████████ | 18/20 [01:37<00:10,  5.16s/it, CE=6.682041e-01 H=6.682128e-01 dV_dx=7.924726e-05 dV_dθ=-7.060152e-05 ||∇||=4.367100e-01 | Tr=0.9560] 90%|█████████ | 18/20 [01:42<00:10,  5.16s/it, CE=6.656183e-01 H=6.655168e-01 dV_dx=-3.092682e-05 dV_dθ=-7.055994e-05 ||∇||=4.345698e-01 | Tr=0.9572] 95%|█████████▌| 19/20 [01:42<00:05,  5.09s/it, CE=6.656183e-01 H=6.655168e-01 dV_dx=-3.092682e-05 dV_dθ=-7.055994e-05 ||∇||=4.345698e-01 | Tr=0.9572] 95%|█████████▌| 19/20 [01:49<00:05,  5.09s/it, CE=6.631209e-01 H=6.630369e-01 dV_dx=-1.357157e-05 dV_dθ=-7.048063e-05 ||∇||=4.322188e-01 | Tr=0.9584 Te/Cur=0.9568 Te/Exp=0.7609]100%|██████████| 20/20 [01:49<00:00,  5.69s/it, CE=6.631209e-01 H=6.630369e-01 dV_dx=-1.357157e-05 dV_dθ=-7.048063e-05 ||∇||=4.322188e-01 | Tr=0.9584 Te/Cur=0.9568 Te/Exp=0.7609]100%|██████████| 20/20 [01:49<00:00,  5.46s/it, CE=6.631209e-01 H=6.630369e-01 dV_dx=-1.357157e-05 dV_dθ=-7.048063e-05 ||∇||=4.322188e-01 | Tr=0.9584 Te/Cur=0.9568 Te/Exp=0.7609]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7550
    Task 1: 0.9256
    Task 2: 0.8289
    Task 3: 0.5531
    Task 4: 0.9567

============================================================
Task 5
============================================================
Initial loss on new task: 6.8568, previous: 0.6631, ratio: 10.34
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=10.34)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:51, 12.18s/it]  5%|▌         | 1/20 [00:16<03:51, 12.18s/it, CE=6.704165e-01 H=6.702895e-01 dV_dx=1.883403e-05 dV_dθ=-1.457827e-04 ||∇||=7.610338e-01 | Tr=0.8420] 10%|█         | 2/20 [00:16<02:15,  7.52s/it, CE=6.704165e-01 H=6.702895e-01 dV_dx=1.883403e-05 dV_dθ=-1.457827e-04 ||∇||=7.610338e-01 | Tr=0.8420] 10%|█         | 2/20 [00:21<02:15,  7.52s/it, CE=6.446978e-01 H=6.445839e-01 dV_dx=1.508993e-05 dV_dθ=-1.289660e-04 ||∇||=6.590167e-01 | Tr=0.8789] 15%|█▌        | 3/20 [00:21<01:45,  6.20s/it, CE=6.446978e-01 H=6.445839e-01 dV_dx=1.508993e-05 dV_dθ=-1.289660e-04 ||∇||=6.590167e-01 | Tr=0.8789] 15%|█▌        | 3/20 [00:25<01:45,  6.20s/it, CE=6.317199e-01 H=6.316674e-01 dV_dx=7.423060e-05 dV_dθ=-1.267692e-04 ||∇||=6.209056e-01 | Tr=0.8967] 20%|██        | 4/20 [00:25<01:26,  5.42s/it, CE=6.317199e-01 H=6.316674e-01 dV_dx=7.423060e-05 dV_dθ=-1.267692e-04 ||∇||=6.209056e-01 | Tr=0.8967] 20%|██        | 4/20 [00:29<01:26,  5.42s/it, CE=6.232300e-01 H=6.231113e-01 dV_dx=1.637187e-05 dV_dθ=-1.351241e-04 ||∇||=6.027119e-01 | Tr=0.9076] 25%|██▌       | 5/20 [00:29<01:14,  5.00s/it, CE=6.232300e-01 H=6.231113e-01 dV_dx=1.637187e-05 dV_dθ=-1.351241e-04 ||∇||=6.027119e-01 | Tr=0.9076] 25%|██▌       | 5/20 [00:35<01:14,  5.00s/it, CE=6.170307e-01 H=6.168934e-01 dV_dx=-4.593180e-07 dV_dθ=-1.368899e-04 ||∇||=5.872477e-01 | Tr=0.9145 Te/Cur=0.9111 Te/Exp=0.7965] 30%|███       | 6/20 [00:35<01:16,  5.45s/it, CE=6.170307e-01 H=6.168934e-01 dV_dx=-4.593180e-07 dV_dθ=-1.368899e-04 ||∇||=5.872477e-01 | Tr=0.9145 Te/Cur=0.9111 Te/Exp=0.7965] 30%|███       | 6/20 [00:40<01:16,  5.45s/it, CE=6.120278e-01 H=6.118760e-01 dV_dx=-1.921248e-05 dV_dθ=-1.325709e-04 ||∇||=5.710421e-01 | Tr=0.9206]                             35%|███▌      | 7/20 [00:40<01:08,  5.27s/it, CE=6.120278e-01 H=6.118760e-01 dV_dx=-1.921248e-05 dV_dθ=-1.325709e-04 ||∇||=5.710421e-01 | Tr=0.9206] 35%|███▌      | 7/20 [00:45<01:08,  5.27s/it, CE=6.077908e-01 H=6.076992e-01 dV_dx=3.110389e-05 dV_dθ=-1.227193e-04 ||∇||=5.555103e-01 | Tr=0.9251]  40%|████      | 8/20 [00:45<01:01,  5.10s/it, CE=6.077908e-01 H=6.076992e-01 dV_dx=3.110389e-05 dV_dθ=-1.227193e-04 ||∇||=5.555103e-01 | Tr=0.9251] 40%|████      | 8/20 [00:50<01:01,  5.10s/it, CE=6.041432e-01 H=6.040438e-01 dV_dx=1.954305e-05 dV_dθ=-1.188790e-04 ||∇||=5.453838e-01 | Tr=0.9286] 45%|████▌     | 9/20 [00:50<00:54,  4.94s/it, CE=6.041432e-01 H=6.040438e-01 dV_dx=1.954305e-05 dV_dθ=-1.188790e-04 ||∇||=5.453838e-01 | Tr=0.9286] 45%|████▌     | 9/20 [00:54<00:54,  4.94s/it, CE=6.009768e-01 H=6.008286e-01 dV_dx=-3.269189e-05 dV_dθ=-1.155060e-04 ||∇||=5.366503e-01 | Tr=0.9319] 50%|█████     | 10/20 [00:54<00:49,  4.91s/it, CE=6.009768e-01 H=6.008286e-01 dV_dx=-3.269189e-05 dV_dθ=-1.155060e-04 ||∇||=5.366503e-01 | Tr=0.9319] 50%|█████     | 10/20 [01:01<00:49,  4.91s/it, CE=5.980890e-01 H=5.979642e-01 dV_dx=-1.281226e-05 dV_dθ=-1.120458e-04 ||∇||=5.285309e-01 | Tr=0.9349 Te/Cur=0.9317 Te/Exp=0.8048] 55%|█████▌    | 11/20 [01:01<00:48,  5.41s/it, CE=5.980890e-01 H=5.979642e-01 dV_dx=-1.281226e-05 dV_dθ=-1.120458e-04 ||∇||=5.285309e-01 | Tr=0.9349 Te/Cur=0.9317 Te/Exp=0.8048] 55%|█████▌    | 11/20 [01:06<00:48,  5.41s/it, CE=5.954157e-01 H=5.953085e-01 dV_dx=-2.782592e-06 dV_dθ=-1.044118e-04 ||∇||=5.199207e-01 | Tr=0.9376]                             60%|██████    | 12/20 [01:06<00:41,  5.22s/it, CE=5.954157e-01 H=5.953085e-01 dV_dx=-2.782592e-06 dV_dθ=-1.044118e-04 ||∇||=5.199207e-01 | Tr=0.9376] 60%|██████    | 12/20 [01:11<00:41,  5.22s/it, CE=5.929016e-01 H=5.928015e-01 dV_dx=-1.193723e-06 dV_dθ=-9.888093e-05 ||∇||=5.124257e-01 | Tr=0.9402] 65%|██████▌   | 13/20 [01:11<00:35,  5.09s/it, CE=5.929016e-01 H=5.928015e-01 dV_dx=-1.193723e-06 dV_dθ=-9.888093e-05 ||∇||=5.124257e-01 | Tr=0.9402] 65%|██████▌   | 13/20 [01:16<00:35,  5.09s/it, CE=5.905634e-01 H=5.904818e-01 dV_dx=1.107033e-05 dV_dθ=-9.265846e-05 ||∇||=5.045439e-01 | Tr=0.9423]  70%|███████   | 14/20 [01:16<00:30,  5.07s/it, CE=5.905634e-01 H=5.904818e-01 dV_dx=1.107033e-05 dV_dθ=-9.265846e-05 ||∇||=5.045439e-01 | Tr=0.9423] 70%|███████   | 14/20 [01:21<00:30,  5.07s/it, CE=5.883434e-01 H=5.882180e-01 dV_dx=-3.638948e-05 dV_dθ=-8.900400e-05 ||∇||=4.988427e-01 | Tr=0.9443] 75%|███████▌  | 15/20 [01:21<00:25,  5.10s/it, CE=5.883434e-01 H=5.882180e-01 dV_dx=-3.638948e-05 dV_dθ=-8.900400e-05 ||∇||=4.988427e-01 | Tr=0.9443] 75%|███████▌  | 15/20 [01:27<00:25,  5.10s/it, CE=5.862113e-01 H=5.861283e-01 dV_dx=2.680372e-06 dV_dθ=-8.569649e-05 ||∇||=4.936071e-01 | Tr=0.9461 Te/Cur=0.9437 Te/Exp=0.8080] 80%|████████  | 16/20 [01:27<00:22,  5.58s/it, CE=5.862113e-01 H=5.861283e-01 dV_dx=2.680372e-06 dV_dθ=-8.569649e-05 ||∇||=4.936071e-01 | Tr=0.9461 Te/Cur=0.9437 Te/Exp=0.8080] 80%|████████  | 16/20 [01:32<00:22,  5.58s/it, CE=5.841781e-01 H=5.840681e-01 dV_dx=-2.989466e-05 dV_dθ=-8.010341e-05 ||∇||=4.881710e-01 | Tr=0.9477]                            85%|████████▌ | 17/20 [01:32<00:16,  5.37s/it, CE=5.841781e-01 H=5.840681e-01 dV_dx=-2.989466e-05 dV_dθ=-8.010341e-05 ||∇||=4.881710e-01 | Tr=0.9477] 85%|████████▌ | 17/20 [01:37<00:16,  5.37s/it, CE=5.822289e-01 H=5.821202e-01 dV_dx=-3.456402e-05 dV_dθ=-7.418168e-05 ||∇||=4.824973e-01 | Tr=0.9493] 90%|█████████ | 18/20 [01:37<00:10,  5.15s/it, CE=5.822289e-01 H=5.821202e-01 dV_dx=-3.456402e-05 dV_dθ=-7.418168e-05 ||∇||=4.824973e-01 | Tr=0.9493] 90%|█████████ | 18/20 [01:42<00:10,  5.15s/it, CE=5.802929e-01 H=5.802186e-01 dV_dx=-4.219301e-06 dV_dθ=-7.003155e-05 ||∇||=4.779709e-01 | Tr=0.9509] 95%|█████████▌| 19/20 [01:42<00:05,  5.11s/it, CE=5.802929e-01 H=5.802186e-01 dV_dx=-4.219301e-06 dV_dθ=-7.003155e-05 ||∇||=4.779709e-01 | Tr=0.9509] 95%|█████████▌| 19/20 [01:48<00:05,  5.11s/it, CE=5.784023e-01 H=5.783027e-01 dV_dx=-3.365721e-05 dV_dθ=-6.588571e-05 ||∇||=4.730674e-01 | Tr=0.9522 Te/Cur=0.9499 Te/Exp=0.8095]100%|██████████| 20/20 [01:48<00:00,  5.52s/it, CE=5.784023e-01 H=5.783027e-01 dV_dx=-3.365721e-05 dV_dθ=-6.588571e-05 ||∇||=4.730674e-01 | Tr=0.9522 Te/Cur=0.9499 Te/Exp=0.8095]100%|██████████| 20/20 [01:48<00:00,  5.45s/it, CE=5.784023e-01 H=5.783027e-01 dV_dx=-3.365721e-05 dV_dθ=-6.588571e-05 ||∇||=4.730674e-01 | Tr=0.9522 Te/Cur=0.9499 Te/Exp=0.8095]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7632
    Task 1: 0.9421
    Task 2: 0.8366
    Task 3: 0.5530
    Task 4: 0.9415
    Task 5: 0.9478

============================================================
Task 6
============================================================
Initial loss on new task: 6.7980, previous: 0.5784, ratio: 11.75
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=11.75)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:43, 11.77s/it]  5%|▌         | 1/20 [00:16<03:43, 11.77s/it, CE=5.594775e-01 H=5.592845e-01 dV_dx=-8.166775e-05 dV_dθ=-1.113593e-04 ||∇||=8.250044e-01 | Tr=0.8321] 10%|█         | 2/20 [00:16<02:12,  7.34s/it, CE=5.594775e-01 H=5.592845e-01 dV_dx=-8.166775e-05 dV_dθ=-1.113593e-04 ||∇||=8.250044e-01 | Tr=0.8321] 10%|█         | 2/20 [00:19<02:12,  7.34s/it, CE=5.419357e-01 H=5.418975e-01 dV_dx=9.259131e-06 dV_dθ=-4.751997e-05 ||∇||=6.786637e-01 | Tr=0.8713]  15%|█▌        | 3/20 [00:19<01:37,  5.71s/it, CE=5.419357e-01 H=5.418975e-01 dV_dx=9.259131e-06 dV_dθ=-4.751997e-05 ||∇||=6.786637e-01 | Tr=0.8713] 15%|█▌        | 3/20 [00:24<01:37,  5.71s/it, CE=5.341207e-01 H=5.340419e-01 dV_dx=-2.579000e-05 dV_dθ=-5.301055e-05 ||∇||=6.369268e-01 | Tr=0.8870] 20%|██        | 4/20 [00:24<01:27,  5.45s/it, CE=5.341207e-01 H=5.340419e-01 dV_dx=-2.579000e-05 dV_dθ=-5.301055e-05 ||∇||=6.369268e-01 | Tr=0.8870] 20%|██        | 4/20 [00:29<01:27,  5.45s/it, CE=5.286384e-01 H=5.285855e-01 dV_dx=8.825864e-06 dV_dθ=-6.164722e-05 ||∇||=6.135473e-01 | Tr=0.8973]  25%|██▌       | 5/20 [00:29<01:18,  5.23s/it, CE=5.286384e-01 H=5.285855e-01 dV_dx=8.825864e-06 dV_dθ=-6.164722e-05 ||∇||=6.135473e-01 | Tr=0.8973] 25%|██▌       | 5/20 [00:36<01:18,  5.23s/it, CE=5.242071e-01 H=5.241354e-01 dV_dx=-9.833108e-06 dV_dθ=-6.187701e-05 ||∇||=5.939863e-01 | Tr=0.9052 Te/Cur=0.9104 Te/Exp=0.8250] 30%|███       | 6/20 [00:36<01:19,  5.70s/it, CE=5.242071e-01 H=5.241354e-01 dV_dx=-9.833108e-06 dV_dθ=-6.187701e-05 ||∇||=5.939863e-01 | Tr=0.9052 Te/Cur=0.9104 Te/Exp=0.8250] 30%|███       | 6/20 [00:41<01:19,  5.70s/it, CE=5.204895e-01 H=5.203938e-01 dV_dx=-3.384720e-05 dV_dθ=-6.187306e-05 ||∇||=5.801632e-01 | Tr=0.9116]                             35%|███▌      | 7/20 [00:41<01:10,  5.39s/it, CE=5.204895e-01 H=5.203938e-01 dV_dx=-3.384720e-05 dV_dθ=-6.187306e-05 ||∇||=5.801632e-01 | Tr=0.9116] 35%|███▌      | 7/20 [00:46<01:10,  5.39s/it, CE=5.172745e-01 H=5.172053e-01 dV_dx=-6.500800e-06 dV_dθ=-6.271068e-05 ||∇||=5.681905e-01 | Tr=0.9163] 40%|████      | 8/20 [00:46<01:03,  5.29s/it, CE=5.172745e-01 H=5.172053e-01 dV_dx=-6.500800e-06 dV_dθ=-6.271068e-05 ||∇||=5.681905e-01 | Tr=0.9163] 40%|████      | 8/20 [00:50<01:03,  5.29s/it, CE=5.144115e-01 H=5.143224e-01 dV_dx=-2.658516e-05 dV_dθ=-6.255002e-05 ||∇||=5.576506e-01 | Tr=0.9204] 45%|████▌     | 9/20 [00:50<00:53,  4.89s/it, CE=5.144115e-01 H=5.143224e-01 dV_dx=-2.658516e-05 dV_dθ=-6.255002e-05 ||∇||=5.576506e-01 | Tr=0.9204] 45%|████▌     | 9/20 [00:54<00:53,  4.89s/it, CE=5.117670e-01 H=5.117316e-01 dV_dx=2.830683e-05 dV_dθ=-6.371316e-05 ||∇||=5.485679e-01 | Tr=0.9238]  50%|█████     | 10/20 [00:54<00:48,  4.87s/it, CE=5.117670e-01 H=5.117316e-01 dV_dx=2.830683e-05 dV_dθ=-6.371316e-05 ||∇||=5.485679e-01 | Tr=0.9238] 50%|█████     | 10/20 [01:00<00:48,  4.87s/it, CE=5.092999e-01 H=5.093312e-01 dV_dx=9.371688e-05 dV_dθ=-6.244903e-05 ||∇||=5.404531e-01 | Tr=0.9268 Te/Cur=0.9262 Te/Exp=0.8394] 55%|█████▌    | 11/20 [01:00<00:46,  5.20s/it, CE=5.092999e-01 H=5.093312e-01 dV_dx=9.371688e-05 dV_dθ=-6.244903e-05 ||∇||=5.404531e-01 | Tr=0.9268 Te/Cur=0.9262 Te/Exp=0.8394] 55%|█████▌    | 11/20 [01:05<00:46,  5.20s/it, CE=5.070640e-01 H=5.070036e-01 dV_dx=2.153910e-06 dV_dθ=-6.254743e-05 ||∇||=5.343719e-01 | Tr=0.9302]                             60%|██████    | 12/20 [01:05<00:40,  5.10s/it, CE=5.070640e-01 H=5.070036e-01 dV_dx=2.153910e-06 dV_dθ=-6.254743e-05 ||∇||=5.343719e-01 | Tr=0.9302] 60%|██████    | 12/20 [01:11<00:40,  5.10s/it, CE=5.049111e-01 H=5.047830e-01 dV_dx=-6.598852e-05 dV_dθ=-6.210705e-05 ||∇||=5.281032e-01 | Tr=0.9329] 65%|██████▌   | 13/20 [01:11<00:36,  5.21s/it, CE=5.049111e-01 H=5.047830e-01 dV_dx=-6.598852e-05 dV_dθ=-6.210705e-05 ||∇||=5.281032e-01 | Tr=0.9329] 65%|██████▌   | 13/20 [01:16<00:36,  5.21s/it, CE=5.029046e-01 H=5.028430e-01 dV_dx=2.434480e-06 dV_dθ=-6.406748e-05 ||∇||=5.238309e-01 | Tr=0.9351]  70%|███████   | 14/20 [01:16<00:31,  5.18s/it, CE=5.029046e-01 H=5.028430e-01 dV_dx=2.434480e-06 dV_dθ=-6.406748e-05 ||∇||=5.238309e-01 | Tr=0.9351] 70%|███████   | 14/20 [01:21<00:31,  5.18s/it, CE=5.009509e-01 H=5.008994e-01 dV_dx=1.187202e-05 dV_dθ=-6.333739e-05 ||∇||=5.194038e-01 | Tr=0.9374] 75%|███████▌  | 15/20 [01:21<00:25,  5.13s/it, CE=5.009509e-01 H=5.008994e-01 dV_dx=1.187202e-05 dV_dθ=-6.333739e-05 ||∇||=5.194038e-01 | Tr=0.9374] 75%|███████▌  | 15/20 [01:28<00:25,  5.13s/it, CE=4.990250e-01 H=4.988563e-01 dV_dx=-1.051762e-04 dV_dθ=-6.354565e-05 ||∇||=5.151538e-01 | Tr=0.9392 Te/Cur=0.9374 Te/Exp=0.8269] 80%|████████  | 16/20 [01:28<00:22,  5.74s/it, CE=4.990250e-01 H=4.988563e-01 dV_dx=-1.051762e-04 dV_dθ=-6.354565e-05 ||∇||=5.151538e-01 | Tr=0.9392 Te/Cur=0.9374 Te/Exp=0.8269] 80%|████████  | 16/20 [01:33<00:22,  5.74s/it, CE=4.971609e-01 H=4.970992e-01 dV_dx=1.383343e-06 dV_dθ=-6.315758e-05 ||∇||=5.116344e-01 | Tr=0.9413]                              85%|████████▌ | 17/20 [01:33<00:16,  5.59s/it, CE=4.971609e-01 H=4.970992e-01 dV_dx=1.383343e-06 dV_dθ=-6.315758e-05 ||∇||=5.116344e-01 | Tr=0.9413] 85%|████████▌ | 17/20 [01:39<00:16,  5.59s/it, CE=4.953171e-01 H=4.952989e-01 dV_dx=4.346183e-05 dV_dθ=-6.167305e-05 ||∇||=5.071377e-01 | Tr=0.9429] 90%|█████████ | 18/20 [01:39<00:10,  5.49s/it, CE=4.953171e-01 H=4.952989e-01 dV_dx=4.346183e-05 dV_dθ=-6.167305e-05 ||∇||=5.071377e-01 | Tr=0.9429] 90%|█████████ | 18/20 [01:43<00:10,  5.49s/it, CE=4.935265e-01 H=4.934627e-01 dV_dx=-2.278990e-06 dV_dθ=-6.151717e-05 ||∇||=5.033936e-01 | Tr=0.9443] 95%|█████████▌| 19/20 [01:43<00:05,  5.29s/it, CE=4.935265e-01 H=4.934627e-01 dV_dx=-2.278990e-06 dV_dθ=-6.151717e-05 ||∇||=5.033936e-01 | Tr=0.9443] 95%|█████████▌| 19/20 [01:50<00:05,  5.29s/it, CE=4.918105e-01 H=4.917677e-01 dV_dx=1.956588e-05 dV_dθ=-6.232962e-05 ||∇||=5.006583e-01 | Tr=0.9459 Te/Cur=0.9431 Te/Exp=0.8340]100%|██████████| 20/20 [01:50<00:00,  5.74s/it, CE=4.918105e-01 H=4.917677e-01 dV_dx=1.956588e-05 dV_dθ=-6.232962e-05 ||∇||=5.006583e-01 | Tr=0.9459 Te/Cur=0.9431 Te/Exp=0.8340]100%|██████████| 20/20 [01:50<00:00,  5.53s/it, CE=4.918105e-01 H=4.917677e-01 dV_dx=1.956588e-05 dV_dθ=-6.232962e-05 ||∇||=5.006583e-01 | Tr=0.9459 Te/Cur=0.9431 Te/Exp=0.8340]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7734
    Task 1: 0.9470
    Task 2: 0.8394
    Task 3: 0.5603
    Task 4: 0.9499
    Task 5: 0.9288
    Task 6: 0.9439

============================================================
Task 7
============================================================
Initial loss on new task: 6.0694, previous: 0.4918, ratio: 12.34
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=12.34)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:26, 10.86s/it]  5%|▌         | 1/20 [00:15<03:26, 10.86s/it, CE=5.902081e-01 H=5.900780e-01 dV_dx=-2.210318e-05 dV_dθ=-1.079442e-04 ||∇||=8.306574e-01 | Tr=0.8735] 10%|█         | 2/20 [00:15<02:09,  7.20s/it, CE=5.902081e-01 H=5.900780e-01 dV_dx=-2.210318e-05 dV_dθ=-1.079442e-04 ||∇||=8.306574e-01 | Tr=0.8735] 10%|█         | 2/20 [00:20<02:09,  7.20s/it, CE=5.515691e-01 H=5.515072e-01 dV_dx=2.373806e-05 dV_dθ=-8.558060e-05 ||∇||=7.125263e-01 | Tr=0.8984]  15%|█▌        | 3/20 [00:20<01:44,  6.17s/it, CE=5.515691e-01 H=5.515072e-01 dV_dx=2.373806e-05 dV_dθ=-8.558060e-05 ||∇||=7.125263e-01 | Tr=0.8984] 15%|█▌        | 3/20 [00:24<01:44,  6.17s/it, CE=5.330922e-01 H=5.330510e-01 dV_dx=2.375122e-05 dV_dθ=-6.497010e-05 ||∇||=6.532341e-01 | Tr=0.9120] 20%|██        | 4/20 [00:24<01:24,  5.28s/it, CE=5.330922e-01 H=5.330510e-01 dV_dx=2.375122e-05 dV_dθ=-6.497010e-05 ||∇||=6.532341e-01 | Tr=0.9120] 20%|██        | 4/20 [00:28<01:24,  5.28s/it, CE=5.217409e-01 H=5.216532e-01 dV_dx=-3.042269e-05 dV_dθ=-5.725652e-05 ||∇||=6.158871e-01 | Tr=0.9205] 25%|██▌       | 5/20 [00:28<01:13,  4.91s/it, CE=5.217409e-01 H=5.216532e-01 dV_dx=-3.042269e-05 dV_dθ=-5.725652e-05 ||∇||=6.158871e-01 | Tr=0.9205] 25%|██▌       | 5/20 [00:35<01:13,  4.91s/it, CE=5.132648e-01 H=5.132316e-01 dV_dx=2.033339e-05 dV_dθ=-5.352585e-05 ||∇||=5.910442e-01 | Tr=0.9267 Te/Cur=0.9270 Te/Exp=0.8246] 30%|███       | 6/20 [00:35<01:19,  5.64s/it, CE=5.132648e-01 H=5.132316e-01 dV_dx=2.033339e-05 dV_dθ=-5.352585e-05 ||∇||=5.910442e-01 | Tr=0.9267 Te/Cur=0.9270 Te/Exp=0.8246] 30%|███       | 6/20 [00:39<01:19,  5.64s/it, CE=5.062306e-01 H=5.061673e-01 dV_dx=-1.461784e-05 dV_dθ=-4.866328e-05 ||∇||=5.707969e-01 | Tr=0.9321]                            35%|███▌      | 7/20 [00:39<01:06,  5.15s/it, CE=5.062306e-01 H=5.061673e-01 dV_dx=-1.461784e-05 dV_dθ=-4.866328e-05 ||∇||=5.707969e-01 | Tr=0.9321] 35%|███▌      | 7/20 [00:44<01:06,  5.15s/it, CE=5.002197e-01 H=5.001655e-01 dV_dx=-8.789930e-06 dV_dθ=-4.535398e-05 ||∇||=5.562572e-01 | Tr=0.9368] 40%|████      | 8/20 [00:44<00:58,  4.86s/it, CE=5.002197e-01 H=5.001655e-01 dV_dx=-8.789930e-06 dV_dθ=-4.535398e-05 ||∇||=5.562572e-01 | Tr=0.9368] 40%|████      | 8/20 [00:49<00:58,  4.86s/it, CE=4.950801e-01 H=4.950084e-01 dV_dx=-2.975170e-05 dV_dθ=-4.200255e-05 ||∇||=5.431544e-01 | Tr=0.9408] 45%|████▌     | 9/20 [00:49<00:53,  4.90s/it, CE=4.950801e-01 H=4.950084e-01 dV_dx=-2.975170e-05 dV_dθ=-4.200255e-05 ||∇||=5.431544e-01 | Tr=0.9408] 45%|████▌     | 9/20 [00:53<00:53,  4.90s/it, CE=4.904392e-01 H=4.903435e-01 dV_dx=-5.638533e-05 dV_dθ=-3.929394e-05 ||∇||=5.335108e-01 | Tr=0.9436] 50%|█████     | 10/20 [00:53<00:48,  4.81s/it, CE=4.904392e-01 H=4.903435e-01 dV_dx=-5.638533e-05 dV_dθ=-3.929394e-05 ||∇||=5.335108e-01 | Tr=0.9436] 50%|█████     | 10/20 [00:59<00:48,  4.81s/it, CE=4.862884e-01 H=4.861850e-01 dV_dx=-6.688680e-05 dV_dθ=-3.650167e-05 ||∇||=5.246228e-01 | Tr=0.9465 Te/Cur=0.9439 Te/Exp=0.8397] 55%|█████▌    | 11/20 [00:59<00:46,  5.20s/it, CE=4.862884e-01 H=4.861850e-01 dV_dx=-6.688680e-05 dV_dθ=-3.650167e-05 ||∇||=5.246228e-01 | Tr=0.9465 Te/Cur=0.9439 Te/Exp=0.8397] 55%|█████▌    | 11/20 [01:04<00:46,  5.20s/it, CE=4.825255e-01 H=4.824900e-01 dV_dx=-9.473835e-07 dV_dθ=-3.448583e-05 ||∇||=5.172493e-01 | Tr=0.9490]                             60%|██████    | 12/20 [01:04<00:40,  5.02s/it, CE=4.825255e-01 H=4.824900e-01 dV_dx=-9.473835e-07 dV_dθ=-3.448583e-05 ||∇||=5.172493e-01 | Tr=0.9490] 60%|██████    | 12/20 [01:09<00:40,  5.02s/it, CE=4.790559e-01 H=4.790130e-01 dV_dx=-9.939570e-06 dV_dθ=-3.295938e-05 ||∇||=5.102562e-01 | Tr=0.9511] 65%|██████▌   | 13/20 [01:09<00:35,  5.03s/it, CE=4.790559e-01 H=4.790130e-01 dV_dx=-9.939570e-06 dV_dθ=-3.295938e-05 ||∇||=5.102562e-01 | Tr=0.9511] 65%|██████▌   | 13/20 [01:13<00:35,  5.03s/it, CE=4.757679e-01 H=4.757472e-01 dV_dx=1.065885e-05 dV_dθ=-3.135940e-05 ||∇||=5.040366e-01 | Tr=0.9530]  70%|███████   | 14/20 [01:13<00:28,  4.77s/it, CE=4.757679e-01 H=4.757472e-01 dV_dx=1.065885e-05 dV_dθ=-3.135940e-05 ||∇||=5.040366e-01 | Tr=0.9530] 70%|███████   | 14/20 [01:18<00:28,  4.77s/it, CE=4.726446e-01 H=4.726073e-01 dV_dx=-6.201506e-06 dV_dθ=-3.107023e-05 ||∇||=4.985227e-01 | Tr=0.9552] 75%|███████▌  | 15/20 [01:18<00:24,  4.89s/it, CE=4.726446e-01 H=4.726073e-01 dV_dx=-6.201506e-06 dV_dθ=-3.107023e-05 ||∇||=4.985227e-01 | Tr=0.9552] 75%|███████▌  | 15/20 [01:25<00:24,  4.89s/it, CE=4.696948e-01 H=4.696838e-01 dV_dx=2.028471e-05 dV_dθ=-3.127255e-05 ||∇||=4.934967e-01 | Tr=0.9569 Te/Cur=0.9518 Te/Exp=0.8357] 80%|████████  | 16/20 [01:25<00:22,  5.52s/it, CE=4.696948e-01 H=4.696838e-01 dV_dx=2.028471e-05 dV_dθ=-3.127255e-05 ||∇||=4.934967e-01 | Tr=0.9569 Te/Cur=0.9518 Te/Exp=0.8357] 80%|████████  | 16/20 [01:30<00:22,  5.52s/it, CE=4.668636e-01 H=4.669012e-01 dV_dx=7.060769e-05 dV_dθ=-3.297377e-05 ||∇||=4.892322e-01 | Tr=0.9582]                             85%|████████▌ | 17/20 [01:30<00:15,  5.26s/it, CE=4.668636e-01 H=4.669012e-01 dV_dx=7.060769e-05 dV_dθ=-3.297377e-05 ||∇||=4.892322e-01 | Tr=0.9582] 85%|████████▌ | 17/20 [01:35<00:15,  5.26s/it, CE=4.642548e-01 H=4.641964e-01 dV_dx=-2.537716e-05 dV_dθ=-3.300495e-05 ||∇||=4.853438e-01 | Tr=0.9596] 90%|█████████ | 18/20 [01:35<00:10,  5.19s/it, CE=4.642548e-01 H=4.641964e-01 dV_dx=-2.537716e-05 dV_dθ=-3.300495e-05 ||∇||=4.853438e-01 | Tr=0.9596] 90%|█████████ | 18/20 [01:40<00:10,  5.19s/it, CE=4.617697e-01 H=4.616623e-01 dV_dx=-7.568278e-05 dV_dθ=-3.169137e-05 ||∇||=4.806346e-01 | Tr=0.9609] 95%|█████████▌| 19/20 [01:40<00:05,  5.03s/it, CE=4.617697e-01 H=4.616623e-01 dV_dx=-7.568278e-05 dV_dθ=-3.169137e-05 ||∇||=4.806346e-01 | Tr=0.9609] 95%|█████████▌| 19/20 [01:46<00:05,  5.03s/it, CE=4.594004e-01 H=4.592988e-01 dV_dx=-7.025910e-05 dV_dθ=-3.133188e-05 ||∇||=4.770524e-01 | Tr=0.9621 Te/Cur=0.9546 Te/Exp=0.8337]100%|██████████| 20/20 [01:46<00:00,  5.59s/it, CE=4.594004e-01 H=4.592988e-01 dV_dx=-7.025910e-05 dV_dθ=-3.133188e-05 ||∇||=4.770524e-01 | Tr=0.9621 Te/Cur=0.9546 Te/Exp=0.8337]100%|██████████| 20/20 [01:46<00:00,  5.35s/it, CE=4.594004e-01 H=4.592988e-01 dV_dx=-7.025910e-05 dV_dθ=-3.133188e-05 ||∇||=4.770524e-01 | Tr=0.9621 Te/Cur=0.9546 Te/Exp=0.8337]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7586
    Task 1: 0.9357
    Task 2: 0.8313
    Task 3: 0.5606
    Task 4: 0.9305
    Task 5: 0.9192
    Task 6: 0.9337
    Task 7: 0.9562

============================================================
Task 8
============================================================
Initial loss on new task: 4.7973, previous: 0.4594, ratio: 10.44
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=10.44)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:50, 12.14s/it]  5%|▌         | 1/20 [00:16<03:50, 12.14s/it, CE=5.852528e-01 H=5.854384e-01 dV_dx=3.052459e-06 dV_dθ=1.825581e-04 ||∇||=7.283764e-01 | Tr=0.8846] 10%|█         | 2/20 [00:16<02:17,  7.66s/it, CE=5.852528e-01 H=5.854384e-01 dV_dx=3.052459e-06 dV_dθ=1.825581e-04 ||∇||=7.283764e-01 | Tr=0.8846] 10%|█         | 2/20 [00:21<02:17,  7.66s/it, CE=5.447142e-01 H=5.448252e-01 dV_dx=2.655581e-05 dV_dθ=8.435884e-05 ||∇||=6.563607e-01 | Tr=0.9053] 15%|█▌        | 3/20 [00:21<01:48,  6.37s/it, CE=5.447142e-01 H=5.448252e-01 dV_dx=2.655581e-05 dV_dθ=8.435884e-05 ||∇||=6.563607e-01 | Tr=0.9053] 15%|█▌        | 3/20 [00:26<01:48,  6.37s/it, CE=5.270499e-01 H=5.270797e-01 dV_dx=-2.570736e-06 dV_dθ=3.235694e-05 ||∇||=6.268699e-01 | Tr=0.9176] 20%|██        | 4/20 [00:26<01:33,  5.83s/it, CE=5.270499e-01 H=5.270797e-01 dV_dx=-2.570736e-06 dV_dθ=3.235694e-05 ||∇||=6.268699e-01 | Tr=0.9176] 20%|██        | 4/20 [00:30<01:33,  5.83s/it, CE=5.146289e-01 H=5.146615e-01 dV_dx=2.334703e-05 dV_dθ=9.248476e-06 ||∇||=6.032704e-01 | Tr=0.9251]  25%|██▌       | 5/20 [00:30<01:18,  5.26s/it, CE=5.146289e-01 H=5.146615e-01 dV_dx=2.334703e-05 dV_dθ=9.248476e-06 ||∇||=6.032704e-01 | Tr=0.9251] 25%|██▌       | 5/20 [00:36<01:18,  5.26s/it, CE=5.044800e-01 H=5.045236e-01 dV_dx=4.338419e-05 dV_dθ=2.195351e-07 ||∇||=5.828247e-01 | Tr=0.9305 Te/Cur=0.9261 Te/Exp=0.8310] 30%|███       | 6/20 [00:36<01:14,  5.35s/it, CE=5.044800e-01 H=5.045236e-01 dV_dx=4.338419e-05 dV_dθ=2.195351e-07 ||∇||=5.828247e-01 | Tr=0.9305 Te/Cur=0.9261 Te/Exp=0.8310] 30%|███       | 6/20 [00:41<01:14,  5.35s/it, CE=4.960884e-01 H=4.960614e-01 dV_dx=-1.405490e-05 dV_dθ=-1.287613e-05 ||∇||=5.695148e-01 | Tr=0.9357]                           35%|███▌      | 7/20 [00:41<01:07,  5.15s/it, CE=4.960884e-01 H=4.960614e-01 dV_dx=-1.405490e-05 dV_dθ=-1.287613e-05 ||∇||=5.695148e-01 | Tr=0.9357] 35%|███▌      | 7/20 [00:45<01:07,  5.15s/it, CE=4.890568e-01 H=4.890521e-01 dV_dx=1.146035e-05 dV_dθ=-1.609729e-05 ||∇||=5.617338e-01 | Tr=0.9392]  40%|████      | 8/20 [00:45<00:59,  4.94s/it, CE=4.890568e-01 H=4.890521e-01 dV_dx=1.146035e-05 dV_dθ=-1.609729e-05 ||∇||=5.617338e-01 | Tr=0.9392] 40%|████      | 8/20 [00:50<00:59,  4.94s/it, CE=4.829791e-01 H=4.829725e-01 dV_dx=1.674171e-05 dV_dθ=-2.340434e-05 ||∇||=5.526893e-01 | Tr=0.9425] 45%|████▌     | 9/20 [00:50<00:53,  4.83s/it, CE=4.829791e-01 H=4.829725e-01 dV_dx=1.674171e-05 dV_dθ=-2.340434e-05 ||∇||=5.526893e-01 | Tr=0.9425] 45%|████▌     | 9/20 [00:54<00:53,  4.83s/it, CE=4.775241e-01 H=4.775573e-01 dV_dx=5.668952e-05 dV_dθ=-2.348254e-05 ||∇||=5.441780e-01 | Tr=0.9455] 50%|█████     | 10/20 [00:54<00:47,  4.70s/it, CE=4.775241e-01 H=4.775573e-01 dV_dx=5.668952e-05 dV_dθ=-2.348254e-05 ||∇||=5.441780e-01 | Tr=0.9455] 50%|█████     | 10/20 [01:01<00:47,  4.70s/it, CE=4.727189e-01 H=4.727830e-01 dV_dx=9.341474e-05 dV_dθ=-2.931362e-05 ||∇||=5.352977e-01 | Tr=0.9484 Te/Cur=0.9446 Te/Exp=0.8298] 55%|█████▌    | 11/20 [01:01<00:47,  5.29s/it, CE=4.727189e-01 H=4.727830e-01 dV_dx=9.341474e-05 dV_dθ=-2.931362e-05 ||∇||=5.352977e-01 | Tr=0.9484 Te/Cur=0.9446 Te/Exp=0.8298] 55%|█████▌    | 11/20 [01:05<00:47,  5.29s/it, CE=4.682866e-01 H=4.682261e-01 dV_dx=-2.802147e-05 dV_dθ=-3.245820e-05 ||∇||=5.290183e-01 | Tr=0.9509]                            60%|██████    | 12/20 [01:05<00:40,  5.04s/it, CE=4.682866e-01 H=4.682261e-01 dV_dx=-2.802147e-05 dV_dθ=-3.245820e-05 ||∇||=5.290183e-01 | Tr=0.9509] 60%|██████    | 12/20 [01:09<00:40,  5.04s/it, CE=4.641072e-01 H=4.640668e-01 dV_dx=-1.046480e-05 dV_dθ=-2.994988e-05 ||∇||=5.239390e-01 | Tr=0.9531] 65%|██████▌   | 13/20 [01:09<00:33,  4.81s/it, CE=4.641072e-01 H=4.640668e-01 dV_dx=-1.046480e-05 dV_dθ=-2.994988e-05 ||∇||=5.239390e-01 | Tr=0.9531] 65%|██████▌   | 13/20 [01:14<00:33,  4.81s/it, CE=4.601396e-01 H=4.600127e-01 dV_dx=-9.398071e-05 dV_dθ=-3.295026e-05 ||∇||=5.186826e-01 | Tr=0.9552] 70%|███████   | 14/20 [01:14<00:28,  4.69s/it, CE=4.601396e-01 H=4.600127e-01 dV_dx=-9.398071e-05 dV_dθ=-3.295026e-05 ||∇||=5.186826e-01 | Tr=0.9552] 70%|███████   | 14/20 [01:19<00:28,  4.69s/it, CE=4.564092e-01 H=4.564047e-01 dV_dx=2.971884e-05 dV_dθ=-3.429312e-05 ||∇||=5.138951e-01 | Tr=0.9570]  75%|███████▌  | 15/20 [01:19<00:23,  4.75s/it, CE=4.564092e-01 H=4.564047e-01 dV_dx=2.971884e-05 dV_dθ=-3.429312e-05 ||∇||=5.138951e-01 | Tr=0.9570] 75%|███████▌  | 15/20 [01:26<00:23,  4.75s/it, CE=4.529224e-01 H=4.528713e-01 dV_dx=-1.685007e-05 dV_dθ=-3.422544e-05 ||∇||=5.078300e-01 | Tr=0.9588 Te/Cur=0.9555 Te/Exp=0.8406] 80%|████████  | 16/20 [01:26<00:21,  5.49s/it, CE=4.529224e-01 H=4.528713e-01 dV_dx=-1.685007e-05 dV_dθ=-3.422544e-05 ||∇||=5.078300e-01 | Tr=0.9588 Te/Cur=0.9555 Te/Exp=0.8406] 80%|████████  | 16/20 [01:31<00:21,  5.49s/it, CE=4.495712e-01 H=4.495807e-01 dV_dx=4.530426e-05 dV_dθ=-3.581436e-05 ||∇||=5.028661e-01 | Tr=0.9603]                              85%|████████▌ | 17/20 [01:31<00:15,  5.25s/it, CE=4.495712e-01 H=4.495807e-01 dV_dx=4.530426e-05 dV_dθ=-3.581436e-05 ||∇||=5.028661e-01 | Tr=0.9603] 85%|████████▌ | 17/20 [01:35<00:15,  5.25s/it, CE=4.463864e-01 H=4.463255e-01 dV_dx=-2.595891e-05 dV_dθ=-3.493670e-05 ||∇||=4.990092e-01 | Tr=0.9615] 90%|█████████ | 18/20 [01:35<00:10,  5.13s/it, CE=4.463864e-01 H=4.463255e-01 dV_dx=-2.595891e-05 dV_dθ=-3.493670e-05 ||∇||=4.990092e-01 | Tr=0.9615] 90%|█████████ | 18/20 [01:40<00:10,  5.13s/it, CE=4.432951e-01 H=4.432148e-01 dV_dx=-4.607579e-05 dV_dθ=-3.421647e-05 ||∇||=4.938570e-01 | Tr=0.9630] 95%|█████████▌| 19/20 [01:40<00:05,  5.08s/it, CE=4.432951e-01 H=4.432148e-01 dV_dx=-4.607579e-05 dV_dθ=-3.421647e-05 ||∇||=4.938570e-01 | Tr=0.9630] 95%|█████████▌| 19/20 [01:47<00:05,  5.08s/it, CE=4.403538e-01 H=4.402835e-01 dV_dx=-3.574908e-05 dV_dθ=-3.449194e-05 ||∇||=4.897192e-01 | Tr=0.9641 Te/Cur=0.9597 Te/Exp=0.8447]100%|██████████| 20/20 [01:47<00:00,  5.58s/it, CE=4.403538e-01 H=4.402835e-01 dV_dx=-3.574908e-05 dV_dθ=-3.449194e-05 ||∇||=4.897192e-01 | Tr=0.9641 Te/Cur=0.9597 Te/Exp=0.8447]100%|██████████| 20/20 [01:47<00:00,  5.38s/it, CE=4.403538e-01 H=4.402835e-01 dV_dx=-3.574908e-05 dV_dθ=-3.449194e-05 ||∇||=4.897192e-01 | Tr=0.9641 Te/Cur=0.9597 Te/Exp=0.8447]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.7665
    Task 1: 0.9430
    Task 2: 0.8359
    Task 3: 0.5661
    Task 4: 0.9420
    Task 5: 0.8895
    Task 6: 0.9138
    Task 7: 0.9065
    Task 8: 0.9590

============================================================
Task 9
============================================================
Initial loss on new task: 1.4745, previous: 0.4404, ratio: 3.35
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=3.35)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:57, 12.52s/it]  5%|▌         | 1/20 [00:16<03:57, 12.52s/it, CE=4.296807e-01 H=4.296212e-01 dV_dx=5.554661e-06 dV_dθ=-6.504475e-05 ||∇||=7.750863e-01 | Tr=0.9030] 10%|█         | 2/20 [00:16<02:16,  7.61s/it, CE=4.296807e-01 H=4.296212e-01 dV_dx=5.554661e-06 dV_dθ=-6.504475e-05 ||∇||=7.750863e-01 | Tr=0.9030] 10%|█         | 2/20 [00:21<02:16,  7.61s/it, CE=4.197035e-01 H=4.196630e-01 dV_dx=-1.443929e-05 dV_dθ=-2.601394e-05 ||∇||=6.789580e-01 | Tr=0.9173] 15%|█▌        | 3/20 [00:21<01:45,  6.21s/it, CE=4.197035e-01 H=4.196630e-01 dV_dx=-1.443929e-05 dV_dθ=-2.601394e-05 ||∇||=6.789580e-01 | Tr=0.9173] 15%|█▌        | 3/20 [00:25<01:45,  6.21s/it, CE=4.141668e-01 H=4.141566e-01 dV_dx=1.711046e-05 dV_dθ=-2.732344e-05 ||∇||=6.437882e-01 | Tr=0.9258]  20%|██        | 4/20 [00:25<01:28,  5.51s/it, CE=4.141668e-01 H=4.141566e-01 dV_dx=1.711046e-05 dV_dθ=-2.732344e-05 ||∇||=6.437882e-01 | Tr=0.9258] 20%|██        | 4/20 [00:30<01:28,  5.51s/it, CE=4.097515e-01 H=4.096871e-01 dV_dx=-2.823375e-05 dV_dθ=-3.617495e-05 ||∇||=6.231914e-01 | Tr=0.9320] 25%|██▌       | 5/20 [00:30<01:18,  5.22s/it, CE=4.097515e-01 H=4.096871e-01 dV_dx=-2.823375e-05 dV_dθ=-3.617495e-05 ||∇||=6.231914e-01 | Tr=0.9320] 25%|██▌       | 5/20 [00:36<01:18,  5.22s/it, CE=4.057946e-01 H=4.057570e-01 dV_dx=5.500815e-06 dV_dθ=-4.309068e-05 ||∇||=6.131975e-01 | Tr=0.9359 Te/Cur=0.9369 Te/Exp=0.8575] 30%|███       | 6/20 [00:36<01:18,  5.64s/it, CE=4.057946e-01 H=4.057570e-01 dV_dx=5.500815e-06 dV_dθ=-4.309068e-05 ||∇||=6.131975e-01 | Tr=0.9359 Te/Cur=0.9369 Te/Exp=0.8575] 30%|███       | 6/20 [00:41<01:18,  5.64s/it, CE=4.021905e-01 H=4.021464e-01 dV_dx=1.498884e-06 dV_dθ=-4.569213e-05 ||∇||=5.917136e-01 | Tr=0.9394]                             35%|███▌      | 7/20 [00:41<01:08,  5.30s/it, CE=4.021905e-01 H=4.021464e-01 dV_dx=1.498884e-06 dV_dθ=-4.569213e-05 ||∇||=5.917136e-01 | Tr=0.9394] 35%|███▌      | 7/20 [00:46<01:08,  5.30s/it, CE=3.988763e-01 H=3.987636e-01 dV_dx=-5.999899e-05 dV_dθ=-5.266984e-05 ||∇||=5.838821e-01 | Tr=0.9427] 40%|████      | 8/20 [00:46<01:03,  5.30s/it, CE=3.988763e-01 H=3.987636e-01 dV_dx=-5.999899e-05 dV_dθ=-5.266984e-05 ||∇||=5.838821e-01 | Tr=0.9427] 40%|████      | 8/20 [00:51<01:03,  5.30s/it, CE=3.957582e-01 H=3.957585e-01 dV_dx=5.673143e-05 dV_dθ=-5.642543e-05 ||∇||=5.762132e-01 | Tr=0.9457]  45%|████▌     | 9/20 [00:51<00:55,  5.08s/it, CE=3.957582e-01 H=3.957585e-01 dV_dx=5.673143e-05 dV_dθ=-5.642543e-05 ||∇||=5.762132e-01 | Tr=0.9457] 45%|████▌     | 9/20 [00:55<00:55,  5.08s/it, CE=3.928457e-01 H=3.928093e-01 dV_dx=1.885481e-05 dV_dθ=-5.522865e-05 ||∇||=5.614549e-01 | Tr=0.9480] 50%|█████     | 10/20 [00:55<00:48,  4.86s/it, CE=3.928457e-01 H=3.928093e-01 dV_dx=1.885481e-05 dV_dθ=-5.522865e-05 ||∇||=5.614549e-01 | Tr=0.9480] 50%|█████     | 10/20 [01:02<00:48,  4.86s/it, CE=3.900824e-01 H=3.900270e-01 dV_dx=-4.173253e-06 dV_dθ=-5.127176e-05 ||∇||=5.565767e-01 | Tr=0.9503 Te/Cur=0.9476 Te/Exp=0.8595] 55%|█████▌    | 11/20 [01:02<00:48,  5.35s/it, CE=3.900824e-01 H=3.900270e-01 dV_dx=-4.173253e-06 dV_dθ=-5.127176e-05 ||∇||=5.565767e-01 | Tr=0.9503 Te/Cur=0.9476 Te/Exp=0.8595] 55%|█████▌    | 11/20 [01:07<00:48,  5.35s/it, CE=3.874281e-01 H=3.873702e-01 dV_dx=1.485264e-06 dV_dθ=-5.938850e-05 ||∇||=5.479222e-01 | Tr=0.9524]                              60%|██████    | 12/20 [01:07<00:42,  5.29s/it, CE=3.874281e-01 H=3.873702e-01 dV_dx=1.485264e-06 dV_dθ=-5.938850e-05 ||∇||=5.479222e-01 | Tr=0.9524] 60%|██████    | 12/20 [01:11<00:42,  5.29s/it, CE=3.848795e-01 H=3.848312e-01 dV_dx=1.096702e-05 dV_dθ=-5.932000e-05 ||∇||=5.411785e-01 | Tr=0.9540] 65%|██████▌   | 13/20 [01:11<00:35,  5.03s/it, CE=3.848795e-01 H=3.848312e-01 dV_dx=1.096702e-05 dV_dθ=-5.932000e-05 ||∇||=5.411785e-01 | Tr=0.9540] 65%|██████▌   | 13/20 [01:16<00:35,  5.03s/it, CE=3.824105e-01 H=3.822950e-01 dV_dx=-5.730006e-05 dV_dθ=-5.822446e-05 ||∇||=5.355736e-01 | Tr=0.9558] 70%|███████   | 14/20 [01:16<00:28,  4.81s/it, CE=3.824105e-01 H=3.822950e-01 dV_dx=-5.730006e-05 dV_dθ=-5.822446e-05 ||∇||=5.355736e-01 | Tr=0.9558] 70%|███████   | 14/20 [01:20<00:28,  4.81s/it, CE=3.800287e-01 H=3.799798e-01 dV_dx=1.127285e-05 dV_dθ=-6.012917e-05 ||∇||=5.301992e-01 | Tr=0.9571]  75%|███████▌  | 15/20 [01:20<00:22,  4.59s/it, CE=3.800287e-01 H=3.799798e-01 dV_dx=1.127285e-05 dV_dθ=-6.012917e-05 ||∇||=5.301992e-01 | Tr=0.9571] 75%|███████▌  | 15/20 [01:26<00:22,  4.59s/it, CE=3.777172e-01 H=3.776278e-01 dV_dx=-3.418759e-05 dV_dθ=-5.522394e-05 ||∇||=5.238394e-01 | Tr=0.9584 Te/Cur=0.9526 Te/Exp=0.8561] 80%|████████  | 16/20 [01:26<00:21,  5.25s/it, CE=3.777172e-01 H=3.776278e-01 dV_dx=-3.418759e-05 dV_dθ=-5.522394e-05 ||∇||=5.238394e-01 | Tr=0.9584 Te/Cur=0.9526 Te/Exp=0.8561] 80%|████████  | 16/20 [01:31<00:21,  5.25s/it, CE=3.754803e-01 H=3.753462e-01 dV_dx=-8.522113e-05 dV_dθ=-4.889511e-05 ||∇||=5.191942e-01 | Tr=0.9598]                             85%|████████▌ | 17/20 [01:31<00:15,  5.14s/it, CE=3.754803e-01 H=3.753462e-01 dV_dx=-8.522113e-05 dV_dθ=-4.889511e-05 ||∇||=5.191942e-01 | Tr=0.9598] 85%|████████▌ | 17/20 [01:36<00:15,  5.14s/it, CE=3.733110e-01 H=3.732879e-01 dV_dx=2.910675e-05 dV_dθ=-5.224475e-05 ||∇||=5.165814e-01 | Tr=0.9610]  90%|█████████ | 18/20 [01:36<00:10,  5.05s/it, CE=3.733110e-01 H=3.732879e-01 dV_dx=2.910675e-05 dV_dθ=-5.224475e-05 ||∇||=5.165814e-01 | Tr=0.9610] 90%|█████████ | 18/20 [01:41<00:10,  5.05s/it, CE=3.711646e-01 H=3.711556e-01 dV_dx=4.357888e-05 dV_dθ=-5.252921e-05 ||∇||=5.113486e-01 | Tr=0.9619] 95%|█████████▌| 19/20 [01:41<00:05,  5.03s/it, CE=3.711646e-01 H=3.711556e-01 dV_dx=4.357888e-05 dV_dθ=-5.252921e-05 ||∇||=5.113486e-01 | Tr=0.9619] 95%|█████████▌| 19/20 [01:48<00:05,  5.03s/it, CE=3.690533e-01 H=3.690059e-01 dV_dx=8.896105e-06 dV_dθ=-5.624970e-05 ||∇||=5.068519e-01 | Tr=0.9628 Te/Cur=0.9582 Te/Exp=0.8647]100%|██████████| 20/20 [01:48<00:00,  5.63s/it, CE=3.690533e-01 H=3.690059e-01 dV_dx=8.896105e-06 dV_dθ=-5.624970e-05 ||∇||=5.068519e-01 | Tr=0.9628 Te/Cur=0.9582 Te/Exp=0.8647]100%|██████████| 20/20 [01:48<00:00,  5.43s/it, CE=3.690533e-01 H=3.690059e-01 dV_dx=8.896105e-06 dV_dθ=-5.624970e-05 ||∇||=5.068519e-01 | Tr=0.9628 Te/Cur=0.9582 Te/Exp=0.8647]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7675
    Task 1: 0.9478
    Task 2: 0.8403
    Task 3: 0.5652
    Task 4: 0.9461
    Task 5: 0.9241
    Task 6: 0.9200
    Task 7: 0.9331
    Task 8: 0.9118
    Task 9: 0.9589
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition1_baseline_run2/mnist_condition1_baseline_run2_run2/classification_mnist_cnn_run2_records.pkl

Training complete!
