JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition2_heuristics.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: False

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run0
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run0/mnist_condition2_heuristics_run0


############################################################
# Run ID: 0
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:18<05:48, 18.36s/it]  5%|▌         | 1/20 [00:23<05:48, 18.36s/it, CE=2.070028e+00 H=2.069602e+00 dV_dx=-5.251783e-07 dV_dθ=-4.254045e-04 ||∇||=4.500913e-01 | Tr=0.4036] 10%|█         | 2/20 [00:23<03:06, 10.35s/it, CE=2.070028e+00 H=2.069602e+00 dV_dx=-5.251783e-07 dV_dθ=-4.254045e-04 ||∇||=4.500913e-01 | Tr=0.4036] 10%|█         | 2/20 [00:27<03:06, 10.35s/it, CE=1.860689e+00 H=1.859885e+00 dV_dx=1.015187e-06 dV_dθ=-8.046707e-04 ||∇||=6.164648e-01 | Tr=0.4824]  15%|█▌        | 3/20 [00:27<02:13,  7.83s/it, CE=1.860689e+00 H=1.859885e+00 dV_dx=1.015187e-06 dV_dθ=-8.046707e-04 ||∇||=6.164648e-01 | Tr=0.4824] 15%|█▌        | 3/20 [00:32<02:13,  7.83s/it, CE=1.651947e+00 H=1.650914e+00 dV_dx=2.980870e-07 dV_dθ=-1.033752e-03 ||∇||=7.023502e-01 | Tr=0.5219] 20%|██        | 4/20 [00:32<01:45,  6.57s/it, CE=1.651947e+00 H=1.650914e+00 dV_dx=2.980870e-07 dV_dθ=-1.033752e-03 ||∇||=7.023502e-01 | Tr=0.5219] 20%|██        | 4/20 [00:37<01:45,  6.57s/it, CE=1.475331e+00 H=1.474336e+00 dV_dx=-4.864102e-09 dV_dθ=-9.951905e-04 ||∇||=6.981196e-01 | Tr=0.5535] 25%|██▌       | 5/20 [00:37<01:29,  5.94s/it, CE=1.475331e+00 H=1.474336e+00 dV_dx=-4.864102e-09 dV_dθ=-9.951905e-04 ||∇||=6.981196e-01 | Tr=0.5535] 25%|██▌       | 5/20 [00:45<01:29,  5.94s/it, CE=1.340152e+00 H=1.339282e+00 dV_dx=8.392116e-07 dV_dθ=-8.707361e-04 ||∇||=6.644473e-01 | Tr=0.5817 Te/Cur=0.5918 Te/Exp=0.5899] 30%|███       | 6/20 [00:45<01:33,  6.66s/it, CE=1.340152e+00 H=1.339282e+00 dV_dx=8.392116e-07 dV_dθ=-8.707361e-04 ||∇||=6.644473e-01 | Tr=0.5817 Te/Cur=0.5918 Te/Exp=0.5899] 30%|███       | 6/20 [00:50<01:33,  6.66s/it, CE=1.240430e+00 H=1.239686e+00 dV_dx=-5.169304e-07 dV_dθ=-7.439430e-04 ||∇||=6.266384e-01 | Tr=0.6045]                            35%|███▌      | 7/20 [00:50<01:19,  6.10s/it, CE=1.240430e+00 H=1.239686e+00 dV_dx=-5.169304e-07 dV_dθ=-7.439430e-04 ||∇||=6.266384e-01 | Tr=0.6045] 35%|███▌      | 7/20 [00:54<01:19,  6.10s/it, CE=1.164663e+00 H=1.164016e+00 dV_dx=1.139555e-07 dV_dθ=-6.474749e-04 ||∇||=5.957640e-01 | Tr=0.6236]  40%|████      | 8/20 [00:54<01:07,  5.59s/it, CE=1.164663e+00 H=1.164016e+00 dV_dx=1.139555e-07 dV_dθ=-6.474749e-04 ||∇||=5.957640e-01 | Tr=0.6236] 40%|████      | 8/20 [00:59<01:07,  5.59s/it, CE=1.105671e+00 H=1.105097e+00 dV_dx=1.957516e-06 dV_dθ=-5.757990e-04 ||∇||=5.724808e-01 | Tr=0.6395] 45%|████▌     | 9/20 [00:59<00:57,  5.27s/it, CE=1.105671e+00 H=1.105097e+00 dV_dx=1.957516e-06 dV_dθ=-5.757990e-04 ||∇||=5.724808e-01 | Tr=0.6395] 45%|████▌     | 9/20 [01:04<00:57,  5.27s/it, CE=1.058581e+00 H=1.058058e+00 dV_dx=-1.242207e-06 dV_dθ=-5.222274e-04 ||∇||=5.550555e-01 | Tr=0.6520] 50%|█████     | 10/20 [01:04<00:51,  5.19s/it, CE=1.058581e+00 H=1.058058e+00 dV_dx=-1.242207e-06 dV_dθ=-5.222274e-04 ||∇||=5.550555e-01 | Tr=0.6520] 50%|█████     | 10/20 [01:11<00:51,  5.19s/it, CE=1.019848e+00 H=1.019356e+00 dV_dx=-1.519522e-06 dV_dθ=-4.896080e-04 ||∇||=5.448599e-01 | Tr=0.6641 Te/Cur=0.6657 Te/Exp=0.6620] 55%|█████▌    | 11/20 [01:11<00:50,  5.60s/it, CE=1.019848e+00 H=1.019356e+00 dV_dx=-1.519522e-06 dV_dθ=-4.896080e-04 ||∇||=5.448599e-01 | Tr=0.6641 Te/Cur=0.6657 Te/Exp=0.6620] 55%|█████▌    | 11/20 [01:15<00:50,  5.60s/it, CE=9.872252e-01 H=9.867530e-01 dV_dx=-3.028893e-06 dV_dθ=-4.690740e-04 ||∇||=5.386785e-01 | Tr=0.6748]                             60%|██████    | 12/20 [01:15<00:41,  5.21s/it, CE=9.872252e-01 H=9.867530e-01 dV_dx=-3.028893e-06 dV_dθ=-4.690740e-04 ||∇||=5.386785e-01 | Tr=0.6748] 60%|██████    | 12/20 [01:20<00:41,  5.21s/it, CE=9.588958e-01 H=9.584410e-01 dV_dx=7.578047e-07 dV_dθ=-4.555422e-04 ||∇||=5.349950e-01 | Tr=0.6851]  65%|██████▌   | 13/20 [01:20<00:36,  5.24s/it, CE=9.588958e-01 H=9.584410e-01 dV_dx=7.578047e-07 dV_dθ=-4.555422e-04 ||∇||=5.349950e-01 | Tr=0.6851] 65%|██████▌   | 13/20 [01:25<00:36,  5.24s/it, CE=9.338200e-01 H=9.333780e-01 dV_dx=2.320743e-06 dV_dθ=-4.443176e-04 ||∇||=5.324645e-01 | Tr=0.6923] 70%|███████   | 14/20 [01:25<00:30,  5.11s/it, CE=9.338200e-01 H=9.333780e-01 dV_dx=2.320743e-06 dV_dθ=-4.443176e-04 ||∇||=5.324645e-01 | Tr=0.6923] 70%|███████   | 14/20 [01:30<00:30,  5.11s/it, CE=9.114578e-01 H=9.110184e-01 dV_dx=5.110392e-07 dV_dθ=-4.399675e-04 ||∇||=5.329208e-01 | Tr=0.6990] 75%|███████▌  | 15/20 [01:30<00:25,  5.11s/it, CE=9.114578e-01 H=9.110184e-01 dV_dx=5.110392e-07 dV_dθ=-4.399675e-04 ||∇||=5.329208e-01 | Tr=0.6990] 75%|███████▌  | 15/20 [01:36<00:25,  5.11s/it, CE=8.912789e-01 H=8.908498e-01 dV_dx=9.380875e-07 dV_dθ=-4.300233e-04 ||∇||=5.307978e-01 | Tr=0.7048 Te/Cur=0.7041 Te/Exp=0.7077] 80%|████████  | 16/20 [01:36<00:21,  5.47s/it, CE=8.912789e-01 H=8.908498e-01 dV_dx=9.380875e-07 dV_dθ=-4.300233e-04 ||∇||=5.307978e-01 | Tr=0.7048 Te/Cur=0.7041 Te/Exp=0.7077] 80%|████████  | 16/20 [01:41<00:21,  5.47s/it, CE=8.728728e-01 H=8.724405e-01 dV_dx=-5.616146e-07 dV_dθ=-4.317042e-04 ||∇||=5.330520e-01 | Tr=0.7107]                            85%|████████▌ | 17/20 [01:41<00:15,  5.24s/it, CE=8.728728e-01 H=8.724405e-01 dV_dx=-5.616146e-07 dV_dθ=-4.317042e-04 ||∇||=5.330520e-01 | Tr=0.7107] 85%|████████▌ | 17/20 [01:46<00:15,  5.24s/it, CE=8.560377e-01 H=8.556026e-01 dV_dx=-2.554935e-06 dV_dθ=-4.325576e-04 ||∇||=5.348777e-01 | Tr=0.7164] 90%|█████████ | 18/20 [01:46<00:10,  5.11s/it, CE=8.560377e-01 H=8.556026e-01 dV_dx=-2.554935e-06 dV_dθ=-4.325576e-04 ||∇||=5.348777e-01 | Tr=0.7164] 90%|█████████ | 18/20 [01:51<00:10,  5.11s/it, CE=8.403658e-01 H=8.399322e-01 dV_dx=7.518513e-07 dV_dθ=-4.343522e-04 ||∇||=5.369433e-01 | Tr=0.7215]  95%|█████████▌| 19/20 [01:51<00:05,  5.15s/it, CE=8.403658e-01 H=8.399322e-01 dV_dx=7.518513e-07 dV_dθ=-4.343522e-04 ||∇||=5.369433e-01 | Tr=0.7215] 95%|█████████▌| 19/20 [01:58<00:05,  5.15s/it, CE=8.256732e-01 H=8.252388e-01 dV_dx=-1.494270e-06 dV_dθ=-4.329049e-04 ||∇||=5.380309e-01 | Tr=0.7266 Te/Cur=0.7315 Te/Exp=0.7287]100%|██████████| 20/20 [01:58<00:00,  5.73s/it, CE=8.256732e-01 H=8.252388e-01 dV_dx=-1.494270e-06 dV_dθ=-4.329049e-04 ||∇||=5.380309e-01 | Tr=0.7266 Te/Cur=0.7315 Te/Exp=0.7287]100%|██████████| 20/20 [01:58<00:00,  5.93s/it, CE=8.256732e-01 H=8.252388e-01 dV_dx=-1.494270e-06 dV_dθ=-4.329049e-04 ||∇||=5.380309e-01 | Tr=0.7266 Te/Cur=0.7315 Te/Exp=0.7287]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7293

============================================================
Task 1
============================================================
Initial loss on new task: 5.9637, previous: 0.8257, ratio: 7.22
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.22)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.26s/it] 50%|█████     | 1/2 [00:16<00:09,  9.26s/it, CE=5.940700e+00 H=5.001946e+00 dV_dx=-2.456298e-06 dV_dθ=-9.387513e-01 ||∇||=2.258006e+01 | Tr=0.1016 Te/Cur=0.0990 Te/Exp=0.7327]100%|██████████| 2/2 [00:16<00:00,  7.85s/it, CE=5.940700e+00 H=5.001946e+00 dV_dx=-2.456298e-06 dV_dθ=-9.387513e-01 ||∇||=2.258006e+01 | Tr=0.1016 Te/Cur=0.0990 Te/Exp=0.7327]100%|██████████| 2/2 [00:16<00:00,  8.06s/it, CE=5.940700e+00 H=5.001946e+00 dV_dx=-2.456298e-06 dV_dθ=-9.387513e-01 ||∇||=2.258006e+01 | Tr=0.1016 Te/Cur=0.0990 Te/Exp=0.7327]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:08<02:32,  8.95s/it]  6%|▌         | 1/18 [00:13<02:32,  8.95s/it, CE=9.172616e-01 H=9.192341e-01 dV_dx=3.376472e-05 dV_dθ=1.938797e-03 ||∇||=1.134307e+00 | Tr=0.5899] 11%|█         | 2/18 [00:13<01:43,  6.46s/it, CE=9.172616e-01 H=9.192341e-01 dV_dx=3.376472e-05 dV_dθ=1.938797e-03 ||∇||=1.134307e+00 | Tr=0.5899] 11%|█         | 2/18 [00:18<01:43,  6.46s/it, CE=8.647745e-01 H=8.647765e-01 dV_dx=3.786147e-05 dV_dθ=-3.589747e-05 ||∇||=8.316087e-01 | Tr=0.7102] 17%|█▋        | 3/18 [00:18<01:24,  5.67s/it, CE=8.647745e-01 H=8.647765e-01 dV_dx=3.786147e-05 dV_dθ=-3.589747e-05 ||∇||=8.316087e-01 | Tr=0.7102] 17%|█▋        | 3/18 [00:22<01:24,  5.67s/it, CE=8.545307e-01 H=8.543621e-01 dV_dx=7.787937e-06 dV_dθ=-1.764275e-04 ||∇||=7.244718e-01 | Tr=0.7701] 22%|██▏       | 4/18 [00:22<01:13,  5.25s/it, CE=8.545307e-01 H=8.543621e-01 dV_dx=7.787937e-06 dV_dθ=-1.764275e-04 ||∇||=7.244718e-01 | Tr=0.7701] 22%|██▏       | 4/18 [00:27<01:13,  5.25s/it, CE=8.478723e-01 H=8.477222e-01 dV_dx=3.182506e-05 dV_dθ=-1.819479e-04 ||∇||=6.632383e-01 | Tr=0.8060] 28%|██▊       | 5/18 [00:27<01:06,  5.10s/it, CE=8.478723e-01 H=8.477222e-01 dV_dx=3.182506e-05 dV_dθ=-1.819479e-04 ||∇||=6.632383e-01 | Tr=0.8060] 28%|██▊       | 5/18 [00:33<01:06,  5.10s/it, CE=8.414241e-01 H=8.412912e-01 dV_dx=3.807563e-05 dV_dθ=-1.709325e-04 ||∇||=6.194076e-01 | Tr=0.8308 Te/Cur=0.8364 Te/Exp=0.7281] 33%|███▎      | 6/18 [00:33<01:04,  5.39s/it, CE=8.414241e-01 H=8.412912e-01 dV_dx=3.807563e-05 dV_dθ=-1.709325e-04 ||∇||=6.194076e-01 | Tr=0.8308 Te/Cur=0.8364 Te/Exp=0.7281] 33%|███▎      | 6/18 [00:38<01:04,  5.39s/it, CE=8.351630e-01 H=8.350280e-01 dV_dx=2.739738e-05 dV_dθ=-1.624042e-04 ||∇||=5.855126e-01 | Tr=0.8481]                             39%|███▉      | 7/18 [00:38<00:57,  5.19s/it, CE=8.351630e-01 H=8.350280e-01 dV_dx=2.739738e-05 dV_dθ=-1.624042e-04 ||∇||=5.855126e-01 | Tr=0.8481] 39%|███▉      | 7/18 [00:43<00:57,  5.19s/it, CE=8.289740e-01 H=8.288230e-01 dV_dx=1.126671e-06 dV_dθ=-1.521690e-04 ||∇||=5.582415e-01 | Tr=0.8599] 44%|████▍     | 8/18 [00:43<00:50,  5.09s/it, CE=8.289740e-01 H=8.288230e-01 dV_dx=1.126671e-06 dV_dθ=-1.521690e-04 ||∇||=5.582415e-01 | Tr=0.8599] 44%|████▍     | 8/18 [00:48<00:50,  5.09s/it, CE=8.230486e-01 H=8.229091e-01 dV_dx=4.704659e-06 dV_dθ=-1.441301e-04 ||∇||=5.380699e-01 | Tr=0.8699] 50%|█████     | 9/18 [00:48<00:44,  4.96s/it, CE=8.230486e-01 H=8.229091e-01 dV_dx=4.704659e-06 dV_dθ=-1.441301e-04 ||∇||=5.380699e-01 | Tr=0.8699] 50%|█████     | 9/18 [00:52<00:44,  4.96s/it, CE=8.174518e-01 H=8.173137e-01 dV_dx=3.729450e-06 dV_dθ=-1.417447e-04 ||∇||=5.248637e-01 | Tr=0.8774] 56%|█████▌    | 10/18 [00:52<00:39,  4.88s/it, CE=8.174518e-01 H=8.173137e-01 dV_dx=3.729450e-06 dV_dθ=-1.417447e-04 ||∇||=5.248637e-01 | Tr=0.8774] 56%|█████▌    | 10/18 [00:59<00:39,  4.88s/it, CE=8.116746e-01 H=8.115535e-01 dV_dx=1.771390e-05 dV_dθ=-1.388505e-04 ||∇||=5.135880e-01 | Tr=0.8837 Te/Cur=0.8863 Te/Exp=0.7330] 61%|██████    | 11/18 [00:59<00:37,  5.40s/it, CE=8.116746e-01 H=8.115535e-01 dV_dx=1.771390e-05 dV_dθ=-1.388505e-04 ||∇||=5.135880e-01 | Tr=0.8837 Te/Cur=0.8863 Te/Exp=0.7330] 61%|██████    | 11/18 [01:04<00:37,  5.40s/it, CE=8.062610e-01 H=8.060819e-01 dV_dx=-4.333000e-05 dV_dθ=-1.357814e-04 ||∇||=5.041276e-01 | Tr=0.8893]                            67%|██████▋   | 12/18 [01:04<00:31,  5.24s/it, CE=8.062610e-01 H=8.060819e-01 dV_dx=-4.333000e-05 dV_dθ=-1.357814e-04 ||∇||=5.041276e-01 | Tr=0.8893] 67%|██████▋   | 12/18 [01:09<00:31,  5.24s/it, CE=8.011135e-01 H=8.009631e-01 dV_dx=-2.061435e-05 dV_dθ=-1.298169e-04 ||∇||=4.950161e-01 | Tr=0.8939] 72%|███████▏  | 13/18 [01:09<00:25,  5.14s/it, CE=8.011135e-01 H=8.009631e-01 dV_dx=-2.061435e-05 dV_dθ=-1.298169e-04 ||∇||=4.950161e-01 | Tr=0.8939] 72%|███████▏  | 13/18 [01:13<00:25,  5.14s/it, CE=7.961315e-01 H=7.959110e-01 dV_dx=-9.263440e-05 dV_dθ=-1.279213e-04 ||∇||=4.890844e-01 | Tr=0.8977] 78%|███████▊  | 14/18 [01:13<00:19,  4.99s/it, CE=7.961315e-01 H=7.959110e-01 dV_dx=-9.263440e-05 dV_dθ=-1.279213e-04 ||∇||=4.890844e-01 | Tr=0.8977] 78%|███████▊  | 14/18 [01:18<00:19,  4.99s/it, CE=7.911684e-01 H=7.910478e-01 dV_dx=7.226223e-06 dV_dθ=-1.277768e-04 ||∇||=4.851006e-01 | Tr=0.9015]  83%|████████▎ | 15/18 [01:18<00:14,  4.91s/it, CE=7.911684e-01 H=7.910478e-01 dV_dx=7.226223e-06 dV_dθ=-1.277768e-04 ||∇||=4.851006e-01 | Tr=0.9015] 83%|████████▎ | 15/18 [01:25<00:14,  4.91s/it, CE=7.862236e-01 H=7.860361e-01 dV_dx=-6.132437e-05 dV_dθ=-1.262025e-04 ||∇||=4.808408e-01 | Tr=0.9050 Te/Cur=0.9063 Te/Exp=0.7351] 89%|████████▉ | 16/18 [01:25<00:11,  5.63s/it, CE=7.862236e-01 H=7.860361e-01 dV_dx=-6.132437e-05 dV_dθ=-1.262025e-04 ||∇||=4.808408e-01 | Tr=0.9050 Te/Cur=0.9063 Te/Exp=0.7351] 89%|████████▉ | 16/18 [01:30<00:11,  5.63s/it, CE=7.812835e-01 H=7.811843e-01 dV_dx=2.475166e-05 dV_dθ=-1.239610e-04 ||∇||=4.768226e-01 | Tr=0.9082]                              94%|█████████▍| 17/18 [01:30<00:05,  5.35s/it, CE=7.812835e-01 H=7.811843e-01 dV_dx=2.475166e-05 dV_dθ=-1.239610e-04 ||∇||=4.768226e-01 | Tr=0.9082] 94%|█████████▍| 17/18 [01:36<00:05,  5.35s/it, CE=7.763698e-01 H=7.762667e-01 dV_dx=2.144293e-05 dV_dθ=-1.245262e-04 ||∇||=4.746009e-01 | Tr=0.9109 Te/Cur=0.9121 Te/Exp=0.7381]100%|██████████| 18/18 [01:36<00:00,  5.62s/it, CE=7.763698e-01 H=7.762667e-01 dV_dx=2.144293e-05 dV_dθ=-1.245262e-04 ||∇||=4.746009e-01 | Tr=0.9109 Te/Cur=0.9121 Te/Exp=0.7381]100%|██████████| 18/18 [01:36<00:00,  5.38s/it, CE=7.763698e-01 H=7.762667e-01 dV_dx=2.144293e-05 dV_dθ=-1.245262e-04 ||∇||=4.746009e-01 | Tr=0.9109 Te/Cur=0.9121 Te/Exp=0.7381]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.7409
    Task 1: 0.9109

============================================================
Task 2
============================================================
Initial loss on new task: 4.4579, previous: 0.7764, ratio: 5.74
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=5.74)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.78s/it] 50%|█████     | 1/2 [00:15<00:08,  8.78s/it, CE=4.431499e+00 H=3.655493e+00 dV_dx=6.025581e-06 dV_dθ=-7.760115e-01 ||∇||=2.054541e+01 | Tr=0.1264 Te/Cur=0.1236 Te/Exp=0.8328]100%|██████████| 2/2 [00:15<00:00,  7.65s/it, CE=4.431499e+00 H=3.655493e+00 dV_dx=6.025581e-06 dV_dθ=-7.760115e-01 ||∇||=2.054541e+01 | Tr=0.1264 Te/Cur=0.1236 Te/Exp=0.8328]100%|██████████| 2/2 [00:15<00:00,  7.82s/it, CE=4.431499e+00 H=3.655493e+00 dV_dx=6.025581e-06 dV_dθ=-7.760115e-01 ||∇||=2.054541e+01 | Tr=0.1264 Te/Cur=0.1236 Te/Exp=0.8328]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:09<02:47,  9.84s/it]  6%|▌         | 1/18 [00:14<02:47,  9.84s/it, CE=7.486514e-01 H=7.530433e-01 dV_dx=8.514993e-06 dV_dθ=4.383358e-03 ||∇||=1.233492e+00 | Tr=0.4721] 11%|█         | 2/18 [00:14<01:48,  6.80s/it, CE=7.486514e-01 H=7.530433e-01 dV_dx=8.514993e-06 dV_dθ=4.383358e-03 ||∇||=1.233492e+00 | Tr=0.4721] 11%|█         | 2/18 [00:19<01:48,  6.80s/it, CE=7.330798e-01 H=7.364449e-01 dV_dx=-1.510477e-05 dV_dθ=3.380168e-03 ||∇||=8.872132e-01 | Tr=0.5576] 17%|█▋        | 3/18 [00:19<01:28,  5.88s/it, CE=7.330798e-01 H=7.364449e-01 dV_dx=-1.510477e-05 dV_dθ=3.380168e-03 ||∇||=8.872132e-01 | Tr=0.5576] 17%|█▋        | 3/18 [00:23<01:28,  5.88s/it, CE=7.091341e-01 H=7.119556e-01 dV_dx=2.598117e-06 dV_dθ=2.818985e-03 ||∇||=7.783840e-01 | Tr=0.6114]  22%|██▏       | 4/18 [00:23<01:15,  5.38s/it, CE=7.091341e-01 H=7.119556e-01 dV_dx=2.598117e-06 dV_dθ=2.818985e-03 ||∇||=7.783840e-01 | Tr=0.6114] 22%|██▏       | 4/18 [00:28<01:15,  5.38s/it, CE=6.849224e-01 H=6.871028e-01 dV_dx=-1.693527e-05 dV_dθ=2.197333e-03 ||∇||=7.280558e-01 | Tr=0.6497] 28%|██▊       | 5/18 [00:28<01:08,  5.26s/it, CE=6.849224e-01 H=6.871028e-01 dV_dx=-1.693527e-05 dV_dθ=2.197333e-03 ||∇||=7.280558e-01 | Tr=0.6497] 28%|██▊       | 5/18 [00:35<01:08,  5.26s/it, CE=6.641399e-01 H=6.657903e-01 dV_dx=8.663135e-06 dV_dθ=1.641774e-03 ||∇||=7.002751e-01 | Tr=0.6771 Te/Cur=0.6922 Te/Exp=0.7921] 33%|███▎      | 6/18 [00:35<01:09,  5.76s/it, CE=6.641399e-01 H=6.657903e-01 dV_dx=8.663135e-06 dV_dθ=1.641774e-03 ||∇||=7.002751e-01 | Tr=0.6771 Te/Cur=0.6922 Te/Exp=0.7921] 33%|███▎      | 6/18 [00:40<01:09,  5.76s/it, CE=6.477878e-01 H=6.489779e-01 dV_dx=-3.366586e-05 dV_dθ=1.223709e-03 ||∇||=6.846178e-01 | Tr=0.6980]                            39%|███▉      | 7/18 [00:40<00:58,  5.30s/it, CE=6.477878e-01 H=6.489779e-01 dV_dx=-3.366586e-05 dV_dθ=1.223709e-03 ||∇||=6.846178e-01 | Tr=0.6980] 39%|███▉      | 7/18 [00:44<00:58,  5.30s/it, CE=6.347748e-01 H=6.357056e-01 dV_dx=1.105544e-05 dV_dθ=9.196619e-04 ||∇||=6.721534e-01 | Tr=0.7134]  44%|████▍     | 8/18 [00:44<00:50,  5.06s/it, CE=6.347748e-01 H=6.357056e-01 dV_dx=1.105544e-05 dV_dθ=9.196619e-04 ||∇||=6.721534e-01 | Tr=0.7134] 44%|████▍     | 8/18 [00:49<00:50,  5.06s/it, CE=6.231583e-01 H=6.238762e-01 dV_dx=3.218551e-05 dV_dθ=6.857476e-04 ||∇||=6.626810e-01 | Tr=0.7286] 50%|█████     | 9/18 [00:49<00:45,  5.02s/it, CE=6.231583e-01 H=6.238762e-01 dV_dx=3.218551e-05 dV_dθ=6.857476e-04 ||∇||=6.626810e-01 | Tr=0.7286] 50%|█████     | 9/18 [00:54<00:45,  5.02s/it, CE=6.129371e-01 H=6.134414e-01 dV_dx=-1.087663e-05 dV_dθ=5.151869e-04 ||∇||=6.575527e-01 | Tr=0.7412] 56%|█████▌    | 10/18 [00:54<00:39,  4.96s/it, CE=6.129371e-01 H=6.134414e-01 dV_dx=-1.087663e-05 dV_dθ=5.151869e-04 ||∇||=6.575527e-01 | Tr=0.7412] 56%|█████▌    | 10/18 [01:01<00:39,  4.96s/it, CE=6.036185e-01 H=6.039968e-01 dV_dx=2.491548e-06 dV_dθ=3.757862e-04 ||∇||=6.548594e-01 | Tr=0.7513 Te/Cur=0.7524 Te/Exp=0.8059] 61%|██████    | 11/18 [01:01<00:38,  5.57s/it, CE=6.036185e-01 H=6.039968e-01 dV_dx=2.491548e-06 dV_dθ=3.757862e-04 ||∇||=6.548594e-01 | Tr=0.7513 Te/Cur=0.7524 Te/Exp=0.8059] 61%|██████    | 11/18 [01:06<00:38,  5.57s/it, CE=5.955833e-01 H=5.958330e-01 dV_dx=-2.550627e-05 dV_dθ=2.752633e-04 ||∇||=6.534625e-01 | Tr=0.7603]                            67%|██████▋   | 12/18 [01:06<00:32,  5.42s/it, CE=5.955833e-01 H=5.958330e-01 dV_dx=-2.550627e-05 dV_dθ=2.752633e-04 ||∇||=6.534625e-01 | Tr=0.7603] 67%|██████▋   | 12/18 [01:11<00:32,  5.42s/it, CE=5.882639e-01 H=5.884555e-01 dV_dx=-5.301121e-06 dV_dθ=1.968906e-04 ||∇||=6.517189e-01 | Tr=0.7678] 72%|███████▏  | 13/18 [01:11<00:26,  5.25s/it, CE=5.882639e-01 H=5.884555e-01 dV_dx=-5.301121e-06 dV_dθ=1.968906e-04 ||∇||=6.517189e-01 | Tr=0.7678] 72%|███████▏  | 13/18 [01:16<00:26,  5.25s/it, CE=5.815143e-01 H=5.816781e-01 dV_dx=3.057649e-05 dV_dθ=1.332680e-04 ||∇||=6.527375e-01 | Tr=0.7747]  78%|███████▊  | 14/18 [01:16<00:20,  5.12s/it, CE=5.815143e-01 H=5.816781e-01 dV_dx=3.057649e-05 dV_dθ=1.332680e-04 ||∇||=6.527375e-01 | Tr=0.7747] 78%|███████▊  | 14/18 [01:20<00:20,  5.12s/it, CE=5.751398e-01 H=5.752612e-01 dV_dx=5.148060e-05 dV_dθ=6.983669e-05 ||∇||=6.570753e-01 | Tr=0.7812] 83%|████████▎ | 15/18 [01:20<00:15,  5.03s/it, CE=5.751398e-01 H=5.752612e-01 dV_dx=5.148060e-05 dV_dθ=6.983669e-05 ||∇||=6.570753e-01 | Tr=0.7812] 83%|████████▎ | 15/18 [01:27<00:15,  5.03s/it, CE=5.689207e-01 H=5.689239e-01 dV_dx=-2.312968e-05 dV_dθ=2.631876e-05 ||∇||=6.613815e-01 | Tr=0.7876 Te/Cur=0.7827 Te/Exp=0.8079] 89%|████████▉ | 16/18 [01:27<00:11,  5.65s/it, CE=5.689207e-01 H=5.689239e-01 dV_dx=-2.312968e-05 dV_dθ=2.631876e-05 ||∇||=6.613815e-01 | Tr=0.7876 Te/Cur=0.7827 Te/Exp=0.8079] 89%|████████▉ | 16/18 [01:32<00:11,  5.65s/it, CE=5.631859e-01 H=5.631944e-01 dV_dx=2.853907e-05 dV_dθ=-2.010579e-05 ||∇||=6.656324e-01 | Tr=0.7929]                             94%|█████████▍| 17/18 [01:32<00:05,  5.23s/it, CE=5.631859e-01 H=5.631944e-01 dV_dx=2.853907e-05 dV_dθ=-2.010579e-05 ||∇||=6.656324e-01 | Tr=0.7929] 94%|█████████▍| 17/18 [01:38<00:05,  5.23s/it, CE=5.576354e-01 H=5.575973e-01 dV_dx=1.707818e-05 dV_dθ=-5.520525e-05 ||∇||=6.684479e-01 | Tr=0.7984 Te/Cur=0.7956 Te/Exp=0.8181]100%|██████████| 18/18 [01:38<00:00,  5.47s/it, CE=5.576354e-01 H=5.575973e-01 dV_dx=1.707818e-05 dV_dθ=-5.520525e-05 ||∇||=6.684479e-01 | Tr=0.7984 Te/Cur=0.7956 Te/Exp=0.8181]100%|██████████| 18/18 [01:38<00:00,  5.46s/it, CE=5.576354e-01 H=5.575973e-01 dV_dx=1.707818e-05 dV_dθ=-5.520525e-05 ||∇||=6.684479e-01 | Tr=0.7984 Te/Cur=0.7956 Te/Exp=0.8181]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.7069
    Task 1: 0.9210
    Task 2: 0.7932

============================================================
Task 3
============================================================
Initial loss on new task: 4.1882, previous: 0.5576, ratio: 7.51
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.51)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.03s/it] 50%|█████     | 1/2 [00:16<00:09,  9.03s/it, CE=4.232648e+00 H=3.591506e+00 dV_dx=2.031769e-06 dV_dθ=-6.411436e-01 ||∇||=1.865655e+01 | Tr=0.1182 Te/Cur=0.1215 Te/Exp=0.8085]100%|██████████| 2/2 [00:16<00:00,  7.84s/it, CE=4.232648e+00 H=3.591506e+00 dV_dx=2.031769e-06 dV_dθ=-6.411436e-01 ||∇||=1.865655e+01 | Tr=0.1182 Te/Cur=0.1215 Te/Exp=0.8085]100%|██████████| 2/2 [00:16<00:00,  8.02s/it, CE=4.232648e+00 H=3.591506e+00 dV_dx=2.031769e-06 dV_dθ=-6.411436e-01 ||∇||=1.865655e+01 | Tr=0.1182 Te/Cur=0.1215 Te/Exp=0.8085]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:10<03:02, 10.71s/it]  6%|▌         | 1/18 [00:15<03:02, 10.71s/it, CE=6.825684e-01 H=6.847910e-01 dV_dx=4.454377e-05 dV_dθ=2.177998e-03 ||∇||=8.709149e-01 | Tr=0.3591] 11%|█         | 2/18 [00:15<01:57,  7.36s/it, CE=6.825684e-01 H=6.847910e-01 dV_dx=4.454377e-05 dV_dθ=2.177998e-03 ||∇||=8.709149e-01 | Tr=0.3591] 11%|█         | 2/18 [00:20<01:57,  7.36s/it, CE=6.380081e-01 H=6.387251e-01 dV_dx=-9.739982e-06 dV_dθ=7.266908e-04 ||∇||=7.910705e-01 | Tr=0.3957] 17%|█▋        | 3/18 [00:20<01:33,  6.23s/it, CE=6.380081e-01 H=6.387251e-01 dV_dx=-9.739982e-06 dV_dθ=7.266908e-04 ||∇||=7.910705e-01 | Tr=0.3957] 17%|█▋        | 3/18 [00:25<01:33,  6.23s/it, CE=6.192100e-01 H=6.193575e-01 dV_dx=-7.982691e-05 dV_dθ=2.274002e-04 ||∇||=7.596163e-01 | Tr=0.4245] 22%|██▏       | 4/18 [00:25<01:19,  5.66s/it, CE=6.192100e-01 H=6.193575e-01 dV_dx=-7.982691e-05 dV_dθ=2.274002e-04 ||∇||=7.596163e-01 | Tr=0.4245] 22%|██▏       | 4/18 [00:29<01:19,  5.66s/it, CE=6.066411e-01 H=6.066786e-01 dV_dx=-3.934912e-07 dV_dθ=3.785997e-05 ||∇||=7.412309e-01 | Tr=0.4464] 28%|██▊       | 5/18 [00:29<01:08,  5.28s/it, CE=6.066411e-01 H=6.066786e-01 dV_dx=-3.934912e-07 dV_dθ=3.785997e-05 ||∇||=7.412309e-01 | Tr=0.4464] 28%|██▊       | 5/18 [00:36<01:08,  5.28s/it, CE=5.970499e-01 H=5.969637e-01 dV_dx=-2.036023e-05 dV_dθ=-6.577612e-05 ||∇||=7.348462e-01 | Tr=0.4657 Te/Cur=0.4672 Te/Exp=0.7977] 33%|███▎      | 6/18 [00:36<01:08,  5.73s/it, CE=5.970499e-01 H=5.969637e-01 dV_dx=-2.036023e-05 dV_dθ=-6.577612e-05 ||∇||=7.348462e-01 | Tr=0.4657 Te/Cur=0.4672 Te/Exp=0.7977] 33%|███▎      | 6/18 [00:41<01:08,  5.73s/it, CE=5.894037e-01 H=5.892735e-01 dV_dx=4.879442e-06 dV_dθ=-1.350884e-04 ||∇||=7.298751e-01 | Tr=0.4816]                              39%|███▉      | 7/18 [00:41<00:59,  5.38s/it, CE=5.894037e-01 H=5.892735e-01 dV_dx=4.879442e-06 dV_dθ=-1.350884e-04 ||∇||=7.298751e-01 | Tr=0.4816] 39%|███▉      | 7/18 [00:46<00:59,  5.38s/it, CE=5.822041e-01 H=5.820294e-01 dV_dx=-1.750298e-05 dV_dθ=-1.571366e-04 ||∇||=7.191028e-01 | Tr=0.4941] 44%|████▍     | 8/18 [00:46<00:52,  5.28s/it, CE=5.822041e-01 H=5.820294e-01 dV_dx=-1.750298e-05 dV_dθ=-1.571366e-04 ||∇||=7.191028e-01 | Tr=0.4941] 44%|████▍     | 8/18 [00:51<00:52,  5.28s/it, CE=5.760171e-01 H=5.758684e-01 dV_dx=8.397363e-06 dV_dθ=-1.570882e-04 ||∇||=7.051252e-01 | Tr=0.5037]  50%|█████     | 9/18 [00:51<00:47,  5.27s/it, CE=5.760171e-01 H=5.758684e-01 dV_dx=8.397363e-06 dV_dθ=-1.570882e-04 ||∇||=7.051252e-01 | Tr=0.5037] 50%|█████     | 9/18 [00:56<00:47,  5.27s/it, CE=5.702868e-01 H=5.701522e-01 dV_dx=2.075626e-05 dV_dθ=-1.553283e-04 ||∇||=6.935834e-01 | Tr=0.5108] 56%|█████▌    | 10/18 [00:56<00:41,  5.15s/it, CE=5.702868e-01 H=5.701522e-01 dV_dx=2.075626e-05 dV_dθ=-1.553283e-04 ||∇||=6.935834e-01 | Tr=0.5108] 56%|█████▌    | 10/18 [01:03<00:41,  5.15s/it, CE=5.649712e-01 H=5.648202e-01 dV_dx=4.619805e-06 dV_dθ=-1.555742e-04 ||∇||=6.850334e-01 | Tr=0.5160 Te/Cur=0.5121 Te/Exp=0.8072] 61%|██████    | 11/18 [01:03<00:39,  5.68s/it, CE=5.649712e-01 H=5.648202e-01 dV_dx=4.619805e-06 dV_dθ=-1.555742e-04 ||∇||=6.850334e-01 | Tr=0.5160 Te/Cur=0.5121 Te/Exp=0.8072] 61%|██████    | 11/18 [01:08<00:39,  5.68s/it, CE=5.599839e-01 H=5.598410e-01 dV_dx=1.213390e-05 dV_dθ=-1.550081e-04 ||∇||=6.786692e-01 | Tr=0.5204]                             67%|██████▋   | 12/18 [01:08<00:32,  5.44s/it, CE=5.599839e-01 H=5.598410e-01 dV_dx=1.213390e-05 dV_dθ=-1.550081e-04 ||∇||=6.786692e-01 | Tr=0.5204] 67%|██████▋   | 12/18 [01:13<00:32,  5.44s/it, CE=5.553235e-01 H=5.551257e-01 dV_dx=-4.412652e-05 dV_dθ=-1.537498e-04 ||∇||=6.747800e-01 | Tr=0.5255] 72%|███████▏  | 13/18 [01:13<00:26,  5.38s/it, CE=5.553235e-01 H=5.551257e-01 dV_dx=-4.412652e-05 dV_dθ=-1.537498e-04 ||∇||=6.747800e-01 | Tr=0.5255] 72%|███████▏  | 13/18 [01:18<00:26,  5.38s/it, CE=5.509227e-01 H=5.508092e-01 dV_dx=4.535798e-05 dV_dθ=-1.588872e-04 ||∇||=6.741924e-01 | Tr=0.5293]  78%|███████▊  | 14/18 [01:18<00:21,  5.26s/it, CE=5.509227e-01 H=5.508092e-01 dV_dx=4.535798e-05 dV_dθ=-1.588872e-04 ||∇||=6.741924e-01 | Tr=0.5293] 78%|███████▊  | 14/18 [01:23<00:21,  5.26s/it, CE=5.466513e-01 H=5.464457e-01 dV_dx=-4.539238e-05 dV_dθ=-1.601716e-04 ||∇||=6.737315e-01 | Tr=0.5329] 83%|████████▎ | 15/18 [01:23<00:15,  5.13s/it, CE=5.466513e-01 H=5.464457e-01 dV_dx=-4.539238e-05 dV_dθ=-1.601716e-04 ||∇||=6.737315e-01 | Tr=0.5329] 83%|████████▎ | 15/18 [01:29<00:15,  5.13s/it, CE=5.425135e-01 H=5.423507e-01 dV_dx=4.016256e-06 dV_dθ=-1.667888e-04 ||∇||=6.748533e-01 | Tr=0.5371 Te/Cur=0.5332 Te/Exp=0.8209] 89%|████████▉ | 16/18 [01:29<00:11,  5.59s/it, CE=5.425135e-01 H=5.423507e-01 dV_dx=4.016256e-06 dV_dθ=-1.667888e-04 ||∇||=6.748533e-01 | Tr=0.5371 Te/Cur=0.5332 Te/Exp=0.8209] 89%|████████▉ | 16/18 [01:35<00:11,  5.59s/it, CE=5.385165e-01 H=5.383417e-01 dV_dx=-4.897966e-06 dV_dθ=-1.699246e-04 ||∇||=6.758056e-01 | Tr=0.5404]                            94%|█████████▍| 17/18 [01:35<00:05,  5.44s/it, CE=5.385165e-01 H=5.383417e-01 dV_dx=-4.897966e-06 dV_dθ=-1.699246e-04 ||∇||=6.758056e-01 | Tr=0.5404] 94%|█████████▍| 17/18 [01:40<00:05,  5.44s/it, CE=5.346557e-01 H=5.345083e-01 dV_dx=2.599090e-05 dV_dθ=-1.734059e-04 ||∇||=6.769922e-01 | Tr=0.5432 Te/Cur=0.5407 Te/Exp=0.8124]100%|██████████| 18/18 [01:40<00:00,  5.55s/it, CE=5.346557e-01 H=5.345083e-01 dV_dx=2.599090e-05 dV_dθ=-1.734059e-04 ||∇||=6.769922e-01 | Tr=0.5432 Te/Cur=0.5407 Te/Exp=0.8124]100%|██████████| 18/18 [01:40<00:00,  5.60s/it, CE=5.346557e-01 H=5.345083e-01 dV_dx=2.599090e-05 dV_dθ=-1.734059e-04 ||∇||=6.769922e-01 | Tr=0.5432 Te/Cur=0.5407 Te/Exp=0.8124]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.7221
    Task 1: 0.9294
    Task 2: 0.8026
    Task 3: 0.5397

============================================================
Task 4
============================================================
Initial loss on new task: 1.1501, previous: 0.5347, ratio: 2.15
Standard CL training (lr=0.000077, adaptive_lr_min=4.40e-05, loss_ratio=2.15)
  Warmup phase: 2 epochs at lr=7.68e-08
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.36s/it] 50%|█████     | 1/2 [00:16<00:09,  9.36s/it, CE=1.177070e+00 H=1.119156e+00 dV_dx=-1.055207e-06 dV_dθ=-5.791290e-02 ||∇||=5.713252e+00 | Tr=0.6758 Te/Cur=0.6714 Te/Exp=0.7489]100%|██████████| 2/2 [00:16<00:00,  8.03s/it, CE=1.177070e+00 H=1.119156e+00 dV_dx=-1.055207e-06 dV_dθ=-5.791290e-02 ||∇||=5.713252e+00 | Tr=0.6758 Te/Cur=0.6714 Te/Exp=0.7489]100%|██████████| 2/2 [00:16<00:00,  8.23s/it, CE=1.177070e+00 H=1.119156e+00 dV_dx=-1.055207e-06 dV_dθ=-5.791290e-02 ||∇||=5.713252e+00 | Tr=0.6758 Te/Cur=0.6714 Te/Exp=0.7489]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=7.68e-05
    Using experience replay
    Adaptive grad weights: [0.62, 0.28, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:13, 11.37s/it]  6%|▌         | 1/18 [00:16<03:13, 11.37s/it, CE=7.643792e-01 H=7.643749e-01 dV_dx=-2.057439e-05 dV_dθ=1.629954e-05 ||∇||=7.192555e-01 | Tr=0.8656] 11%|█         | 2/18 [00:16<02:00,  7.53s/it, CE=7.643792e-01 H=7.643749e-01 dV_dx=-2.057439e-05 dV_dθ=1.629954e-05 ||∇||=7.192555e-01 | Tr=0.8656] 11%|█         | 2/18 [00:21<02:00,  7.53s/it, CE=7.620337e-01 H=7.619729e-01 dV_dx=8.703125e-06 dV_dθ=-6.950759e-05 ||∇||=6.636044e-01 | Tr=0.8839] 17%|█▋        | 3/18 [00:21<01:34,  6.31s/it, CE=7.620337e-01 H=7.619729e-01 dV_dx=8.703125e-06 dV_dθ=-6.950759e-05 ||∇||=6.636044e-01 | Tr=0.8839] 17%|█▋        | 3/18 [00:26<01:34,  6.31s/it, CE=7.576709e-01 H=7.575383e-01 dV_dx=-1.465428e-06 dV_dθ=-1.311080e-04 ||∇||=6.464401e-01 | Tr=0.8953] 22%|██▏       | 4/18 [00:26<01:20,  5.78s/it, CE=7.576709e-01 H=7.575383e-01 dV_dx=-1.465428e-06 dV_dθ=-1.311080e-04 ||∇||=6.464401e-01 | Tr=0.8953] 22%|██▏       | 4/18 [00:30<01:20,  5.78s/it, CE=7.532716e-01 H=7.531418e-01 dV_dx=2.634718e-05 dV_dθ=-1.560735e-04 ||∇||=6.312649e-01 | Tr=0.9028]  28%|██▊       | 5/18 [00:30<01:09,  5.32s/it, CE=7.532716e-01 H=7.531418e-01 dV_dx=2.634718e-05 dV_dθ=-1.560735e-04 ||∇||=6.312649e-01 | Tr=0.9028] 28%|██▊       | 5/18 [00:37<01:09,  5.32s/it, CE=7.492440e-01 H=7.490480e-01 dV_dx=-2.412282e-05 dV_dθ=-1.718429e-04 ||∇||=6.206452e-01 | Tr=0.9079 Te/Cur=0.9101 Te/Exp=0.7351] 33%|███▎      | 6/18 [00:37<01:11,  5.99s/it, CE=7.492440e-01 H=7.490480e-01 dV_dx=-2.412282e-05 dV_dθ=-1.718429e-04 ||∇||=6.206452e-01 | Tr=0.9079 Te/Cur=0.9101 Te/Exp=0.7351] 33%|███▎      | 6/18 [00:42<01:11,  5.99s/it, CE=7.451591e-01 H=7.450061e-01 dV_dx=2.739063e-05 dV_dθ=-1.804688e-04 ||∇||=6.110201e-01 | Tr=0.9131]                              39%|███▉      | 7/18 [00:42<01:02,  5.68s/it, CE=7.451591e-01 H=7.450061e-01 dV_dx=2.739063e-05 dV_dθ=-1.804688e-04 ||∇||=6.110201e-01 | Tr=0.9131] 39%|███▉      | 7/18 [00:47<01:02,  5.68s/it, CE=7.411237e-01 H=7.409636e-01 dV_dx=2.454191e-05 dV_dθ=-1.846320e-04 ||∇||=6.030978e-01 | Tr=0.9174] 44%|████▍     | 8/18 [00:47<00:54,  5.44s/it, CE=7.411237e-01 H=7.409636e-01 dV_dx=2.454191e-05 dV_dθ=-1.846320e-04 ||∇||=6.030978e-01 | Tr=0.9174] 44%|████▍     | 8/18 [00:53<00:54,  5.44s/it, CE=7.370395e-01 H=7.368538e-01 dV_dx=2.168623e-06 dV_dθ=-1.878581e-04 ||∇||=5.955337e-01 | Tr=0.9209] 50%|█████     | 9/18 [00:53<00:48,  5.39s/it, CE=7.370395e-01 H=7.368538e-01 dV_dx=2.168623e-06 dV_dθ=-1.878581e-04 ||∇||=5.955337e-01 | Tr=0.9209] 50%|█████     | 9/18 [00:58<00:48,  5.39s/it, CE=7.330548e-01 H=7.328533e-01 dV_dx=-9.923121e-06 dV_dθ=-1.915775e-04 ||∇||=5.896802e-01 | Tr=0.9238] 56%|█████▌    | 10/18 [00:58<00:42,  5.28s/it, CE=7.330548e-01 H=7.328533e-01 dV_dx=-9.923121e-06 dV_dθ=-1.915775e-04 ||∇||=5.896802e-01 | Tr=0.9238] 56%|█████▌    | 10/18 [01:04<00:42,  5.28s/it, CE=7.292513e-01 H=7.290536e-01 dV_dx=-7.660397e-06 dV_dθ=-1.900268e-04 ||∇||=5.835044e-01 | Tr=0.9265 Te/Cur=0.9271 Te/Exp=0.7399] 61%|██████    | 11/18 [01:04<00:39,  5.69s/it, CE=7.292513e-01 H=7.290536e-01 dV_dx=-7.660397e-06 dV_dθ=-1.900268e-04 ||∇||=5.835044e-01 | Tr=0.9265 Te/Cur=0.9271 Te/Exp=0.7399] 61%|██████    | 11/18 [01:09<00:39,  5.69s/it, CE=7.254964e-01 H=7.253536e-01 dV_dx=4.325852e-05 dV_dθ=-1.861153e-04 ||∇||=5.759614e-01 | Tr=0.9293]                              67%|██████▋   | 12/18 [01:09<00:32,  5.47s/it, CE=7.254964e-01 H=7.253536e-01 dV_dx=4.325852e-05 dV_dθ=-1.861153e-04 ||∇||=5.759614e-01 | Tr=0.9293] 67%|██████▋   | 12/18 [01:14<00:32,  5.47s/it, CE=7.218541e-01 H=7.215951e-01 dV_dx=-7.523468e-05 dV_dθ=-1.838095e-04 ||∇||=5.703863e-01 | Tr=0.9317] 72%|███████▏  | 13/18 [01:14<00:26,  5.21s/it, CE=7.218541e-01 H=7.215951e-01 dV_dx=-7.523468e-05 dV_dθ=-1.838095e-04 ||∇||=5.703863e-01 | Tr=0.9317] 72%|███████▏  | 13/18 [01:19<00:26,  5.21s/it, CE=7.182671e-01 H=7.179549e-01 dV_dx=-1.289457e-04 dV_dθ=-1.833381e-04 ||∇||=5.659012e-01 | Tr=0.9340] 78%|███████▊  | 14/18 [01:19<00:20,  5.07s/it, CE=7.182671e-01 H=7.179549e-01 dV_dx=-1.289457e-04 dV_dθ=-1.833381e-04 ||∇||=5.659012e-01 | Tr=0.9340] 78%|███████▊  | 14/18 [01:23<00:20,  5.07s/it, CE=7.147226e-01 H=7.145210e-01 dV_dx=-2.152412e-05 dV_dθ=-1.800982e-04 ||∇||=5.608070e-01 | Tr=0.9363] 83%|████████▎ | 15/18 [01:23<00:14,  4.84s/it, CE=7.147226e-01 H=7.145210e-01 dV_dx=-2.152412e-05 dV_dθ=-1.800982e-04 ||∇||=5.608070e-01 | Tr=0.9363] 83%|████████▎ | 15/18 [01:30<00:14,  4.84s/it, CE=7.112990e-01 H=7.111206e-01 dV_dx=-1.086952e-06 dV_dθ=-1.773249e-04 ||∇||=5.557768e-01 | Tr=0.9378 Te/Cur=0.9344 Te/Exp=0.7501] 89%|████████▉ | 16/18 [01:30<00:11,  5.64s/it, CE=7.112990e-01 H=7.111206e-01 dV_dx=-1.086952e-06 dV_dθ=-1.773249e-04 ||∇||=5.557768e-01 | Tr=0.9378 Te/Cur=0.9344 Te/Exp=0.7501] 89%|████████▉ | 16/18 [01:35<00:11,  5.64s/it, CE=7.079591e-01 H=7.077344e-01 dV_dx=-5.069799e-05 dV_dθ=-1.740264e-04 ||∇||=5.513745e-01 | Tr=0.9388]                             94%|█████████▍| 17/18 [01:35<00:05,  5.28s/it, CE=7.079591e-01 H=7.077344e-01 dV_dx=-5.069799e-05 dV_dθ=-1.740264e-04 ||∇||=5.513745e-01 | Tr=0.9388] 94%|█████████▍| 17/18 [01:41<00:05,  5.28s/it, CE=7.046686e-01 H=7.044674e-01 dV_dx=-2.991221e-05 dV_dθ=-1.712996e-04 ||∇||=5.469332e-01 | Tr=0.9404 Te/Cur=0.9360 Te/Exp=0.7524]100%|██████████| 18/18 [01:41<00:00,  5.46s/it, CE=7.046686e-01 H=7.044674e-01 dV_dx=-2.991221e-05 dV_dθ=-1.712996e-04 ||∇||=5.469332e-01 | Tr=0.9404 Te/Cur=0.9360 Te/Exp=0.7524]100%|██████████| 18/18 [01:41<00:00,  5.62s/it, CE=7.046686e-01 H=7.044674e-01 dV_dx=-2.991221e-05 dV_dθ=-1.712996e-04 ||∇||=5.469332e-01 | Tr=0.9404 Te/Cur=0.9360 Te/Exp=0.7524]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7450
    Task 1: 0.9125
    Task 2: 0.8134
    Task 3: 0.5400
    Task 4: 0.9381

============================================================
Task 5
============================================================
Initial loss on new task: 7.3408, previous: 0.7047, ratio: 10.42
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=10.42)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.93s/it] 50%|█████     | 1/2 [00:16<00:08,  8.93s/it, CE=7.389622e+00 H=5.410267e+00 dV_dx=1.854085e-06 dV_dθ=-1.979357e+00 ||∇||=3.279538e+01 | Tr=0.1287 Te/Cur=0.1227 Te/Exp=0.7873]100%|██████████| 2/2 [00:16<00:00,  7.84s/it, CE=7.389622e+00 H=5.410267e+00 dV_dx=1.854085e-06 dV_dθ=-1.979357e+00 ||∇||=3.279538e+01 | Tr=0.1287 Te/Cur=0.1227 Te/Exp=0.7873]100%|██████████| 2/2 [00:16<00:00,  8.00s/it, CE=7.389622e+00 H=5.410267e+00 dV_dx=1.854085e-06 dV_dθ=-1.979357e+00 ||∇||=3.279538e+01 | Tr=0.1287 Te/Cur=0.1227 Te/Exp=0.7873]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:12<03:24, 12.01s/it]  6%|▌         | 1/18 [00:17<03:24, 12.01s/it, CE=7.442933e-01 H=7.456635e-01 dV_dx=4.165038e-06 dV_dθ=1.366088e-03 ||∇||=1.571744e+00 | Tr=0.5866] 11%|█         | 2/18 [00:17<02:08,  8.02s/it, CE=7.442933e-01 H=7.456635e-01 dV_dx=4.165038e-06 dV_dθ=1.366088e-03 ||∇||=1.571744e+00 | Tr=0.5866] 11%|█         | 2/18 [00:21<02:08,  8.02s/it, CE=7.181493e-01 H=7.182999e-01 dV_dx=-6.881196e-06 dV_dθ=1.575526e-04 ||∇||=1.098703e+00 | Tr=0.7180] 17%|█▋        | 3/18 [00:21<01:37,  6.52s/it, CE=7.181493e-01 H=7.182999e-01 dV_dx=-6.881196e-06 dV_dθ=1.575526e-04 ||∇||=1.098703e+00 | Tr=0.7180] 17%|█▋        | 3/18 [00:27<01:37,  6.52s/it, CE=7.056839e-01 H=7.056434e-01 dV_dx=-6.791178e-06 dV_dθ=-3.369220e-05 ||∇||=9.301158e-01 | Tr=0.7891] 22%|██▏       | 4/18 [00:27<01:23,  5.99s/it, CE=7.056839e-01 H=7.056434e-01 dV_dx=-6.791178e-06 dV_dθ=-3.369220e-05 ||∇||=9.301158e-01 | Tr=0.7891] 22%|██▏       | 4/18 [00:32<01:23,  5.99s/it, CE=6.949970e-01 H=6.948949e-01 dV_dx=4.437957e-06 dV_dθ=-1.065786e-04 ||∇||=8.457081e-01 | Tr=0.8287]  28%|██▊       | 5/18 [00:32<01:13,  5.64s/it, CE=6.949970e-01 H=6.948949e-01 dV_dx=4.437957e-06 dV_dθ=-1.065786e-04 ||∇||=8.457081e-01 | Tr=0.8287] 28%|██▊       | 5/18 [00:39<01:13,  5.64s/it, CE=6.856357e-01 H=6.855191e-01 dV_dx=3.573177e-05 dV_dθ=-1.523411e-04 ||∇||=7.963134e-01 | Tr=0.8547 Te/Cur=0.8580 Te/Exp=0.7818] 33%|███▎      | 6/18 [00:39<01:12,  6.08s/it, CE=6.856357e-01 H=6.855191e-01 dV_dx=3.573177e-05 dV_dθ=-1.523411e-04 ||∇||=7.963134e-01 | Tr=0.8547 Te/Cur=0.8580 Te/Exp=0.7818] 33%|███▎      | 6/18 [00:43<01:12,  6.08s/it, CE=6.779916e-01 H=6.778332e-01 dV_dx=2.512730e-05 dV_dθ=-1.835511e-04 ||∇||=7.637368e-01 | Tr=0.8732]                             39%|███▉      | 7/18 [00:43<01:02,  5.64s/it, CE=6.779916e-01 H=6.778332e-01 dV_dx=2.512730e-05 dV_dθ=-1.835511e-04 ||∇||=7.637368e-01 | Tr=0.8732] 39%|███▉      | 7/18 [00:48<01:02,  5.64s/it, CE=6.712213e-01 H=6.710598e-01 dV_dx=3.152417e-05 dV_dθ=-1.930412e-04 ||∇||=7.349844e-01 | Tr=0.8867] 44%|████▍     | 8/18 [00:48<00:54,  5.46s/it, CE=6.712213e-01 H=6.710598e-01 dV_dx=3.152417e-05 dV_dθ=-1.930412e-04 ||∇||=7.349844e-01 | Tr=0.8867] 44%|████▍     | 8/18 [00:53<00:54,  5.46s/it, CE=6.656674e-01 H=6.654460e-01 dV_dx=-2.284241e-05 dV_dθ=-1.985462e-04 ||∇||=7.122171e-01 | Tr=0.8954] 50%|█████     | 9/18 [00:53<00:47,  5.29s/it, CE=6.656674e-01 H=6.654460e-01 dV_dx=-2.284241e-05 dV_dθ=-1.985462e-04 ||∇||=7.122171e-01 | Tr=0.8954] 50%|█████     | 9/18 [00:58<00:47,  5.29s/it, CE=6.608159e-01 H=6.606668e-01 dV_dx=4.801500e-05 dV_dθ=-1.971170e-04 ||∇||=6.916749e-01 | Tr=0.9017]  56%|█████▌    | 10/18 [00:58<00:41,  5.15s/it, CE=6.608159e-01 H=6.606668e-01 dV_dx=4.801500e-05 dV_dθ=-1.971170e-04 ||∇||=6.916749e-01 | Tr=0.9017] 56%|█████▌    | 10/18 [01:05<00:41,  5.15s/it, CE=6.564051e-01 H=6.562456e-01 dV_dx=3.035045e-05 dV_dθ=-1.898292e-04 ||∇||=6.729936e-01 | Tr=0.9073 Te/Cur=0.9082 Te/Exp=0.7847] 61%|██████    | 11/18 [01:05<00:40,  5.81s/it, CE=6.564051e-01 H=6.562456e-01 dV_dx=3.035045e-05 dV_dθ=-1.898292e-04 ||∇||=6.729936e-01 | Tr=0.9073 Te/Cur=0.9082 Te/Exp=0.7847] 61%|██████    | 11/18 [01:10<00:40,  5.81s/it, CE=6.522165e-01 H=6.520333e-01 dV_dx=3.676755e-06 dV_dθ=-1.868955e-04 ||∇||=6.576301e-01 | Tr=0.9125]                             67%|██████▋   | 12/18 [01:10<00:32,  5.47s/it, CE=6.522165e-01 H=6.520333e-01 dV_dx=3.676755e-06 dV_dθ=-1.868955e-04 ||∇||=6.576301e-01 | Tr=0.9125] 67%|██████▋   | 12/18 [01:15<00:32,  5.47s/it, CE=6.484108e-01 H=6.482912e-01 dV_dx=6.185042e-05 dV_dθ=-1.814023e-04 ||∇||=6.431854e-01 | Tr=0.9167] 72%|███████▏  | 13/18 [01:15<00:26,  5.34s/it, CE=6.484108e-01 H=6.482912e-01 dV_dx=6.185042e-05 dV_dθ=-1.814023e-04 ||∇||=6.431854e-01 | Tr=0.9167] 72%|███████▏  | 13/18 [01:19<00:26,  5.34s/it, CE=6.448139e-01 H=6.446933e-01 dV_dx=5.186092e-05 dV_dθ=-1.724204e-04 ||∇||=6.291227e-01 | Tr=0.9209] 78%|███████▊  | 14/18 [01:19<00:19,  4.89s/it, CE=6.448139e-01 H=6.446933e-01 dV_dx=5.186092e-05 dV_dθ=-1.724204e-04 ||∇||=6.291227e-01 | Tr=0.9209] 78%|███████▊  | 14/18 [01:24<00:19,  4.89s/it, CE=6.413986e-01 H=6.413172e-01 dV_dx=9.003082e-05 dV_dθ=-1.714073e-04 ||∇||=6.195323e-01 | Tr=0.9243] 83%|████████▎ | 15/18 [01:24<00:14,  4.76s/it, CE=6.413986e-01 H=6.413172e-01 dV_dx=9.003082e-05 dV_dθ=-1.714073e-04 ||∇||=6.195323e-01 | Tr=0.9243] 83%|████████▎ | 15/18 [01:29<00:14,  4.76s/it, CE=6.382800e-01 H=6.380032e-01 dV_dx=-1.082472e-04 dV_dθ=-1.685957e-04 ||∇||=6.109438e-01 | Tr=0.9272 Te/Cur=0.9218 Te/Exp=0.7802] 89%|████████▉ | 16/18 [01:29<00:10,  5.03s/it, CE=6.382800e-01 H=6.380032e-01 dV_dx=-1.082472e-04 dV_dθ=-1.685957e-04 ||∇||=6.109438e-01 | Tr=0.9272 Te/Cur=0.9218 Te/Exp=0.7802] 89%|████████▉ | 16/18 [01:33<00:10,  5.03s/it, CE=6.352762e-01 H=6.350992e-01 dV_dx=-1.272444e-05 dV_dθ=-1.642878e-04 ||∇||=6.029916e-01 | Tr=0.9297]                             94%|█████████▍| 17/18 [01:33<00:04,  4.79s/it, CE=6.352762e-01 H=6.350992e-01 dV_dx=-1.272444e-05 dV_dθ=-1.642878e-04 ||∇||=6.029916e-01 | Tr=0.9297] 94%|█████████▍| 17/18 [01:39<00:04,  4.79s/it, CE=6.324470e-01 H=6.322092e-01 dV_dx=-7.841571e-05 dV_dθ=-1.594079e-04 ||∇||=5.944543e-01 | Tr=0.9327 Te/Cur=0.9291 Te/Exp=0.7915]100%|██████████| 18/18 [01:39<00:00,  5.13s/it, CE=6.324470e-01 H=6.322092e-01 dV_dx=-7.841571e-05 dV_dθ=-1.594079e-04 ||∇||=5.944543e-01 | Tr=0.9327 Te/Cur=0.9291 Te/Exp=0.7915]100%|██████████| 18/18 [01:39<00:00,  5.54s/it, CE=6.324470e-01 H=6.322092e-01 dV_dx=-7.841571e-05 dV_dθ=-1.594079e-04 ||∇||=5.944543e-01 | Tr=0.9327 Te/Cur=0.9291 Te/Exp=0.7915]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7476
    Task 1: 0.9299
    Task 2: 0.8187
    Task 3: 0.5416
    Task 4: 0.9184
    Task 5: 0.9282

============================================================
Task 6
============================================================
Initial loss on new task: 4.9975, previous: 0.6324, ratio: 7.90
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.90)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.47s/it] 50%|█████     | 1/2 [00:15<00:09,  9.47s/it, CE=4.916274e+00 H=3.898912e+00 dV_dx=-3.184074e-06 dV_dθ=-1.017358e+00 ||∇||=2.356339e+01 | Tr=0.2145 Te/Cur=0.2183 Te/Exp=0.8116]100%|██████████| 2/2 [00:15<00:00,  7.52s/it, CE=4.916274e+00 H=3.898912e+00 dV_dx=-3.184074e-06 dV_dθ=-1.017358e+00 ||∇||=2.356339e+01 | Tr=0.2145 Te/Cur=0.2183 Te/Exp=0.8116]100%|██████████| 2/2 [00:15<00:00,  7.82s/it, CE=4.916274e+00 H=3.898912e+00 dV_dx=-3.184074e-06 dV_dθ=-1.017358e+00 ||∇||=2.356339e+01 | Tr=0.2145 Te/Cur=0.2183 Te/Exp=0.8116]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:18, 11.65s/it]  6%|▌         | 1/18 [00:16<03:18, 11.65s/it, CE=6.170152e-01 H=6.169746e-01 dV_dx=2.555200e-05 dV_dθ=-6.623799e-05 ||∇||=1.271672e+00 | Tr=0.6941] 11%|█         | 2/18 [00:16<02:05,  7.83s/it, CE=6.170152e-01 H=6.169746e-01 dV_dx=2.555200e-05 dV_dθ=-6.623799e-05 ||∇||=1.271672e+00 | Tr=0.6941] 11%|█         | 2/18 [00:21<02:05,  7.83s/it, CE=5.993290e-01 H=5.991709e-01 dV_dx=4.250310e-05 dV_dθ=-2.006199e-04 ||∇||=1.009667e+00 | Tr=0.7864] 17%|█▋        | 3/18 [00:21<01:36,  6.42s/it, CE=5.993290e-01 H=5.991709e-01 dV_dx=4.250310e-05 dV_dθ=-2.006199e-04 ||∇||=1.009667e+00 | Tr=0.7864] 17%|█▋        | 3/18 [00:26<01:36,  6.42s/it, CE=5.922620e-01 H=5.920435e-01 dV_dx=-9.293375e-06 dV_dθ=-2.092049e-04 ||∇||=8.819113e-01 | Tr=0.8323] 22%|██▏       | 4/18 [00:26<01:21,  5.81s/it, CE=5.922620e-01 H=5.920435e-01 dV_dx=-9.293375e-06 dV_dθ=-2.092049e-04 ||∇||=8.819113e-01 | Tr=0.8323] 22%|██▏       | 4/18 [00:31<01:21,  5.81s/it, CE=5.871520e-01 H=5.870037e-01 dV_dx=5.615609e-05 dV_dθ=-2.044417e-04 ||∇||=8.143103e-01 | Tr=0.8575]  28%|██▊       | 5/18 [00:31<01:10,  5.44s/it, CE=5.871520e-01 H=5.870037e-01 dV_dx=5.615609e-05 dV_dθ=-2.044417e-04 ||∇||=8.143103e-01 | Tr=0.8575] 28%|██▊       | 5/18 [00:37<01:10,  5.44s/it, CE=5.826265e-01 H=5.824498e-01 dV_dx=2.158519e-05 dV_dθ=-1.983092e-04 ||∇||=7.727803e-01 | Tr=0.8736 Te/Cur=0.8827 Te/Exp=0.8115] 33%|███▎      | 6/18 [00:37<01:09,  5.77s/it, CE=5.826265e-01 H=5.824498e-01 dV_dx=2.158519e-05 dV_dθ=-1.983092e-04 ||∇||=7.727803e-01 | Tr=0.8736 Te/Cur=0.8827 Te/Exp=0.8115] 33%|███▎      | 6/18 [00:42<01:09,  5.77s/it, CE=5.783426e-01 H=5.781237e-01 dV_dx=-3.123113e-05 dV_dθ=-1.876388e-04 ||∇||=7.396353e-01 | Tr=0.8857]                            39%|███▉      | 7/18 [00:42<00:59,  5.45s/it, CE=5.783426e-01 H=5.781237e-01 dV_dx=-3.123113e-05 dV_dθ=-1.876388e-04 ||∇||=7.396353e-01 | Tr=0.8857] 39%|███▉      | 7/18 [00:47<00:59,  5.45s/it, CE=5.740726e-01 H=5.738552e-01 dV_dx=-3.573408e-05 dV_dθ=-1.817145e-04 ||∇||=7.185819e-01 | Tr=0.8939] 44%|████▍     | 8/18 [00:47<00:53,  5.32s/it, CE=5.740726e-01 H=5.738552e-01 dV_dx=-3.573408e-05 dV_dθ=-1.817145e-04 ||∇||=7.185819e-01 | Tr=0.8939] 44%|████▍     | 8/18 [00:52<00:53,  5.32s/it, CE=5.700837e-01 H=5.698738e-01 dV_dx=-3.741118e-05 dV_dθ=-1.725598e-04 ||∇||=7.003428e-01 | Tr=0.9008] 50%|█████     | 9/18 [00:52<00:46,  5.19s/it, CE=5.700837e-01 H=5.698738e-01 dV_dx=-3.741118e-05 dV_dθ=-1.725598e-04 ||∇||=7.003428e-01 | Tr=0.9008] 50%|█████     | 9/18 [00:57<00:46,  5.19s/it, CE=5.660361e-01 H=5.658709e-01 dV_dx=5.845478e-07 dV_dθ=-1.658133e-04 ||∇||=6.838286e-01 | Tr=0.9069]  56%|█████▌    | 10/18 [00:57<00:40,  5.11s/it, CE=5.660361e-01 H=5.658709e-01 dV_dx=5.845478e-07 dV_dθ=-1.658133e-04 ||∇||=6.838286e-01 | Tr=0.9069] 56%|█████▌    | 10/18 [01:04<00:40,  5.11s/it, CE=5.620772e-01 H=5.618086e-01 dV_dx=-1.032140e-04 dV_dθ=-1.654423e-04 ||∇||=6.705323e-01 | Tr=0.9121 Te/Cur=0.9137 Te/Exp=0.8064] 61%|██████    | 11/18 [01:04<00:40,  5.77s/it, CE=5.620772e-01 H=5.618086e-01 dV_dx=-1.032140e-04 dV_dθ=-1.654423e-04 ||∇||=6.705323e-01 | Tr=0.9121 Te/Cur=0.9137 Te/Exp=0.8064] 61%|██████    | 11/18 [01:09<00:40,  5.77s/it, CE=5.583409e-01 H=5.581850e-01 dV_dx=8.723512e-06 dV_dθ=-1.645874e-04 ||∇||=6.596108e-01 | Tr=0.9159]                              67%|██████▋   | 12/18 [01:09<00:32,  5.46s/it, CE=5.583409e-01 H=5.581850e-01 dV_dx=8.723512e-06 dV_dθ=-1.645874e-04 ||∇||=6.596108e-01 | Tr=0.9159] 67%|██████▋   | 12/18 [01:13<00:32,  5.46s/it, CE=5.548217e-01 H=5.546727e-01 dV_dx=1.444760e-05 dV_dθ=-1.634693e-04 ||∇||=6.499684e-01 | Tr=0.9194] 72%|███████▏  | 13/18 [01:13<00:24,  4.94s/it, CE=5.548217e-01 H=5.546727e-01 dV_dx=1.444760e-05 dV_dθ=-1.634693e-04 ||∇||=6.499684e-01 | Tr=0.9194] 72%|███████▏  | 13/18 [01:17<00:24,  4.94s/it, CE=5.514644e-01 H=5.512859e-01 dV_dx=-1.143219e-05 dV_dθ=-1.670510e-04 ||∇||=6.430164e-01 | Tr=0.9229] 78%|███████▊  | 14/18 [01:17<00:19,  4.86s/it, CE=5.514644e-01 H=5.512859e-01 dV_dx=-1.143219e-05 dV_dθ=-1.670510e-04 ||∇||=6.430164e-01 | Tr=0.9229] 78%|███████▊  | 14/18 [01:21<00:19,  4.86s/it, CE=5.482339e-01 H=5.480147e-01 dV_dx=-5.517296e-05 dV_dθ=-1.640044e-04 ||∇||=6.351758e-01 | Tr=0.9256] 83%|████████▎ | 15/18 [01:21<00:13,  4.65s/it, CE=5.482339e-01 H=5.480147e-01 dV_dx=-5.517296e-05 dV_dθ=-1.640044e-04 ||∇||=6.351758e-01 | Tr=0.9256] 83%|████████▎ | 15/18 [01:28<00:13,  4.65s/it, CE=5.451882e-01 H=5.449955e-01 dV_dx=-2.664861e-05 dV_dθ=-1.660969e-04 ||∇||=6.301118e-01 | Tr=0.9279 Te/Cur=0.9280 Te/Exp=0.8130] 89%|████████▉ | 16/18 [01:28<00:10,  5.16s/it, CE=5.451882e-01 H=5.449955e-01 dV_dx=-2.664861e-05 dV_dθ=-1.660969e-04 ||∇||=6.301118e-01 | Tr=0.9279 Te/Cur=0.9280 Te/Exp=0.8130] 89%|████████▉ | 16/18 [01:32<00:10,  5.16s/it, CE=5.422052e-01 H=5.419955e-01 dV_dx=-4.156768e-05 dV_dθ=-1.681884e-04 ||∇||=6.248484e-01 | Tr=0.9306]                             94%|█████████▍| 17/18 [01:32<00:04,  4.94s/it, CE=5.422052e-01 H=5.419955e-01 dV_dx=-4.156768e-05 dV_dθ=-1.681884e-04 ||∇||=6.248484e-01 | Tr=0.9306] 94%|█████████▍| 17/18 [01:39<00:04,  4.94s/it, CE=5.393776e-01 H=5.391174e-01 dV_dx=-9.050595e-05 dV_dθ=-1.697153e-04 ||∇||=6.204048e-01 | Tr=0.9326 Te/Cur=0.9320 Te/Exp=0.8126]100%|██████████| 18/18 [01:39<00:00,  5.60s/it, CE=5.393776e-01 H=5.391174e-01 dV_dx=-9.050595e-05 dV_dθ=-1.697153e-04 ||∇||=6.204048e-01 | Tr=0.9326 Te/Cur=0.9320 Te/Exp=0.8126]100%|██████████| 18/18 [01:39<00:00,  5.54s/it, CE=5.393776e-01 H=5.391174e-01 dV_dx=-9.050595e-05 dV_dθ=-1.697153e-04 ||∇||=6.204048e-01 | Tr=0.9326 Te/Cur=0.9320 Te/Exp=0.8126]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7576
    Task 1: 0.9380
    Task 2: 0.8243
    Task 3: 0.5402
    Task 4: 0.9326
    Task 5: 0.9057
    Task 6: 0.9315

============================================================
Task 7
============================================================
Initial loss on new task: 5.5356, previous: 0.5394, ratio: 10.26
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=10.26)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.13s/it] 50%|█████     | 1/2 [00:15<00:09,  9.13s/it, CE=5.366992e+00 H=4.814012e+00 dV_dx=-4.087086e-07 dV_dθ=-5.529793e-01 ||∇||=1.747357e+01 | Tr=0.1741 Te/Cur=0.1742 Te/Exp=0.8340]100%|██████████| 2/2 [00:15<00:00,  7.77s/it, CE=5.366992e+00 H=4.814012e+00 dV_dx=-4.087086e-07 dV_dθ=-5.529793e-01 ||∇||=1.747357e+01 | Tr=0.1741 Te/Cur=0.1742 Te/Exp=0.8340]100%|██████████| 2/2 [00:15<00:00,  7.97s/it, CE=5.366992e+00 H=4.814012e+00 dV_dx=-4.087086e-07 dV_dθ=-5.529793e-01 ||∇||=1.747357e+01 | Tr=0.1741 Te/Cur=0.1742 Te/Exp=0.8340]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:12<03:26, 12.15s/it]  6%|▌         | 1/18 [00:17<03:26, 12.15s/it, CE=6.645173e-01 H=6.659892e-01 dV_dx=2.149803e-05 dV_dθ=1.450380e-03 ||∇||=1.250459e+00 | Tr=0.7340] 11%|█         | 2/18 [00:17<02:08,  8.00s/it, CE=6.645173e-01 H=6.659892e-01 dV_dx=2.149803e-05 dV_dθ=1.450380e-03 ||∇||=1.250459e+00 | Tr=0.7340] 11%|█         | 2/18 [00:22<02:08,  8.00s/it, CE=6.429482e-01 H=6.433037e-01 dV_dx=2.247169e-05 dV_dθ=3.330238e-04 ||∇||=9.264691e-01 | Tr=0.8316] 17%|█▋        | 3/18 [00:22<01:38,  6.56s/it, CE=6.429482e-01 H=6.433037e-01 dV_dx=2.247169e-05 dV_dθ=3.330238e-04 ||∇||=9.264691e-01 | Tr=0.8316] 17%|█▋        | 3/18 [00:27<01:38,  6.56s/it, CE=6.263889e-01 H=6.265778e-01 dV_dx=7.199417e-05 dV_dθ=1.169490e-04 ||∇||=8.269256e-01 | Tr=0.8699] 22%|██▏       | 4/18 [00:27<01:24,  6.01s/it, CE=6.263889e-01 H=6.265778e-01 dV_dx=7.199417e-05 dV_dθ=1.169490e-04 ||∇||=8.269256e-01 | Tr=0.8699] 22%|██▏       | 4/18 [00:32<01:24,  6.01s/it, CE=6.117546e-01 H=6.117299e-01 dV_dx=-3.698601e-05 dV_dθ=1.232402e-05 ||∇||=7.765547e-01 | Tr=0.8898] 28%|██▊       | 5/18 [00:32<01:12,  5.60s/it, CE=6.117546e-01 H=6.117299e-01 dV_dx=-3.698601e-05 dV_dθ=1.232402e-05 ||∇||=7.765547e-01 | Tr=0.8898] 28%|██▊       | 5/18 [00:39<01:12,  5.60s/it, CE=5.990932e-01 H=5.990609e-01 dV_dx=3.086380e-05 dV_dθ=-6.323359e-05 ||∇||=7.486041e-01 | Tr=0.9025 Te/Cur=0.9017 Te/Exp=0.8032] 33%|███▎      | 6/18 [00:39<01:13,  6.12s/it, CE=5.990932e-01 H=5.990609e-01 dV_dx=3.086380e-05 dV_dθ=-6.323359e-05 ||∇||=7.486041e-01 | Tr=0.9025 Te/Cur=0.9017 Te/Exp=0.8032] 33%|███▎      | 6/18 [00:43<01:13,  6.12s/it, CE=5.882646e-01 H=5.881542e-01 dV_dx=1.522560e-08 dV_dθ=-1.104241e-04 ||∇||=7.263049e-01 | Tr=0.9110]                             39%|███▉      | 7/18 [00:43<01:01,  5.60s/it, CE=5.882646e-01 H=5.881542e-01 dV_dx=1.522560e-08 dV_dθ=-1.104241e-04 ||∇||=7.263049e-01 | Tr=0.9110] 39%|███▉      | 7/18 [00:48<01:01,  5.60s/it, CE=5.789849e-01 H=5.788790e-01 dV_dx=2.778189e-05 dV_dθ=-1.336889e-04 ||∇||=7.045685e-01 | Tr=0.9186] 44%|████▍     | 8/18 [00:48<00:53,  5.38s/it, CE=5.789849e-01 H=5.788790e-01 dV_dx=2.778189e-05 dV_dθ=-1.336889e-04 ||∇||=7.045685e-01 | Tr=0.9186] 44%|████▍     | 8/18 [00:53<00:53,  5.38s/it, CE=5.708038e-01 H=5.706744e-01 dV_dx=2.750146e-05 dV_dθ=-1.568666e-04 ||∇||=6.891005e-01 | Tr=0.9253] 50%|█████     | 9/18 [00:53<00:47,  5.32s/it, CE=5.708038e-01 H=5.706744e-01 dV_dx=2.750146e-05 dV_dθ=-1.568666e-04 ||∇||=6.891005e-01 | Tr=0.9253] 50%|█████     | 9/18 [00:58<00:47,  5.32s/it, CE=5.635566e-01 H=5.633526e-01 dV_dx=-3.562416e-05 dV_dθ=-1.683479e-04 ||∇||=6.739075e-01 | Tr=0.9302] 56%|█████▌    | 10/18 [00:58<00:41,  5.24s/it, CE=5.635566e-01 H=5.633526e-01 dV_dx=-3.562416e-05 dV_dθ=-1.683479e-04 ||∇||=6.739075e-01 | Tr=0.9302] 56%|█████▌    | 10/18 [01:05<00:41,  5.24s/it, CE=5.569716e-01 H=5.567651e-01 dV_dx=-2.977826e-05 dV_dθ=-1.767849e-04 ||∇||=6.603524e-01 | Tr=0.9344 Te/Cur=0.9328 Te/Exp=0.8202] 61%|██████    | 11/18 [01:05<00:38,  5.52s/it, CE=5.569716e-01 H=5.567651e-01 dV_dx=-2.977826e-05 dV_dθ=-1.767849e-04 ||∇||=6.603524e-01 | Tr=0.9344 Te/Cur=0.9328 Te/Exp=0.8202] 61%|██████    | 11/18 [01:09<00:38,  5.52s/it, CE=5.510281e-01 H=5.508667e-01 dV_dx=2.810247e-05 dV_dθ=-1.894922e-04 ||∇||=6.507285e-01 | Tr=0.9379]                              67%|██████▋   | 12/18 [01:09<00:31,  5.23s/it, CE=5.510281e-01 H=5.508667e-01 dV_dx=2.810247e-05 dV_dθ=-1.894922e-04 ||∇||=6.507285e-01 | Tr=0.9379] 67%|██████▋   | 12/18 [01:14<00:31,  5.23s/it, CE=5.455265e-01 H=5.453111e-01 dV_dx=-2.025575e-05 dV_dθ=-1.951446e-04 ||∇||=6.410893e-01 | Tr=0.9411] 72%|███████▏  | 13/18 [01:14<00:25,  5.10s/it, CE=5.455265e-01 H=5.453111e-01 dV_dx=-2.025575e-05 dV_dθ=-1.951446e-04 ||∇||=6.410893e-01 | Tr=0.9411] 72%|███████▏  | 13/18 [01:18<00:25,  5.10s/it, CE=5.403881e-01 H=5.401556e-01 dV_dx=-3.515227e-05 dV_dθ=-1.973953e-04 ||∇||=6.313969e-01 | Tr=0.9436] 78%|███████▊  | 14/18 [01:18<00:19,  4.85s/it, CE=5.403881e-01 H=5.401556e-01 dV_dx=-3.515227e-05 dV_dθ=-1.973953e-04 ||∇||=6.313969e-01 | Tr=0.9436] 78%|███████▊  | 14/18 [01:23<00:19,  4.85s/it, CE=5.355569e-01 H=5.354119e-01 dV_dx=5.155198e-05 dV_dθ=-1.965629e-04 ||∇||=6.212548e-01 | Tr=0.9462]  83%|████████▎ | 15/18 [01:23<00:14,  4.90s/it, CE=5.355569e-01 H=5.354119e-01 dV_dx=5.155198e-05 dV_dθ=-1.965629e-04 ||∇||=6.212548e-01 | Tr=0.9462] 83%|████████▎ | 15/18 [01:29<00:14,  4.90s/it, CE=5.309910e-01 H=5.308059e-01 dV_dx=1.214661e-05 dV_dθ=-1.972971e-04 ||∇||=6.128251e-01 | Tr=0.9491 Te/Cur=0.9447 Te/Exp=0.8255] 89%|████████▉ | 16/18 [01:29<00:10,  5.20s/it, CE=5.309910e-01 H=5.308059e-01 dV_dx=1.214661e-05 dV_dθ=-1.972971e-04 ||∇||=6.128251e-01 | Tr=0.9491 Te/Cur=0.9447 Te/Exp=0.8255] 89%|████████▉ | 16/18 [01:34<00:10,  5.20s/it, CE=5.266892e-01 H=5.265027e-01 dV_dx=5.885393e-06 dV_dθ=-1.923521e-04 ||∇||=6.029988e-01 | Tr=0.9513]                             94%|█████████▍| 17/18 [01:34<00:05,  5.03s/it, CE=5.266892e-01 H=5.265027e-01 dV_dx=5.885393e-06 dV_dθ=-1.923521e-04 ||∇||=6.029988e-01 | Tr=0.9513] 94%|█████████▍| 17/18 [01:40<00:05,  5.03s/it, CE=5.225723e-01 H=5.223649e-01 dV_dx=-1.812945e-05 dV_dθ=-1.892881e-04 ||∇||=5.960380e-01 | Tr=0.9533 Te/Cur=0.9468 Te/Exp=0.8211]100%|██████████| 18/18 [01:40<00:00,  5.48s/it, CE=5.225723e-01 H=5.223649e-01 dV_dx=-1.812945e-05 dV_dθ=-1.892881e-04 ||∇||=5.960380e-01 | Tr=0.9533 Te/Cur=0.9468 Te/Exp=0.8211]100%|██████████| 18/18 [01:40<00:00,  5.60s/it, CE=5.225723e-01 H=5.223649e-01 dV_dx=-1.812945e-05 dV_dθ=-1.892881e-04 ||∇||=5.960380e-01 | Tr=0.9533 Te/Cur=0.9468 Te/Exp=0.8211]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7482
    Task 1: 0.9226
    Task 2: 0.8144
    Task 3: 0.5405
    Task 4: 0.9123
    Task 5: 0.9000
    Task 6: 0.9219
    Task 7: 0.9476

============================================================
Task 8
============================================================
Initial loss on new task: 4.5389, previous: 0.5226, ratio: 8.69
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=8.69)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.16s/it] 50%|█████     | 1/2 [00:15<00:09,  9.16s/it, CE=4.530609e+00 H=3.885315e+00 dV_dx=-3.982247e-06 dV_dθ=-6.452899e-01 ||∇||=1.886096e+01 | Tr=0.1700 Te/Cur=0.1604 Te/Exp=0.8386]100%|██████████| 2/2 [00:15<00:00,  7.57s/it, CE=4.530609e+00 H=3.885315e+00 dV_dx=-3.982247e-06 dV_dθ=-6.452899e-01 ||∇||=1.886096e+01 | Tr=0.1700 Te/Cur=0.1604 Te/Exp=0.8386]100%|██████████| 2/2 [00:15<00:00,  7.81s/it, CE=4.530609e+00 H=3.885315e+00 dV_dx=-3.982247e-06 dV_dθ=-6.452899e-01 ||∇||=1.886096e+01 | Tr=0.1700 Te/Cur=0.1604 Te/Exp=0.8386]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:12<03:30, 12.37s/it]  6%|▌         | 1/18 [00:17<03:30, 12.37s/it, CE=6.096578e-01 H=6.107288e-01 dV_dx=1.362218e-05 dV_dθ=1.057369e-03 ||∇||=1.049245e+00 | Tr=0.7913] 11%|█         | 2/18 [00:17<02:05,  7.85s/it, CE=6.096578e-01 H=6.107288e-01 dV_dx=1.362218e-05 dV_dθ=1.057369e-03 ||∇||=1.049245e+00 | Tr=0.7913] 11%|█         | 2/18 [00:22<02:05,  7.85s/it, CE=5.997539e-01 H=6.002814e-01 dV_dx=2.697168e-05 dV_dθ=5.005759e-04 ||∇||=8.092455e-01 | Tr=0.8568] 17%|█▋        | 3/18 [00:22<01:39,  6.65s/it, CE=5.997539e-01 H=6.002814e-01 dV_dx=2.697168e-05 dV_dθ=5.005759e-04 ||∇||=8.092455e-01 | Tr=0.8568] 17%|█▋        | 3/18 [00:26<01:39,  6.65s/it, CE=5.883330e-01 H=5.886105e-01 dV_dx=1.036826e-05 dV_dθ=2.670648e-04 ||∇||=7.398202e-01 | Tr=0.8826] 22%|██▏       | 4/18 [00:26<01:20,  5.73s/it, CE=5.883330e-01 H=5.886105e-01 dV_dx=1.036826e-05 dV_dθ=2.670648e-04 ||∇||=7.398202e-01 | Tr=0.8826] 22%|██▏       | 4/18 [00:31<01:20,  5.73s/it, CE=5.777630e-01 H=5.779424e-01 dV_dx=2.637410e-05 dV_dθ=1.530138e-04 ||∇||=7.060279e-01 | Tr=0.8983] 28%|██▊       | 5/18 [00:31<01:11,  5.48s/it, CE=5.777630e-01 H=5.779424e-01 dV_dx=2.637410e-05 dV_dθ=1.530138e-04 ||∇||=7.060279e-01 | Tr=0.8983] 28%|██▊       | 5/18 [00:38<01:11,  5.48s/it, CE=5.684969e-01 H=5.686122e-01 dV_dx=2.596835e-05 dV_dθ=8.927017e-05 ||∇||=6.811716e-01 | Tr=0.9103 Te/Cur=0.9094 Te/Exp=0.8146] 33%|███▎      | 6/18 [00:38<01:13,  6.09s/it, CE=5.684969e-01 H=5.686122e-01 dV_dx=2.596835e-05 dV_dθ=8.927017e-05 ||∇||=6.811716e-01 | Tr=0.9103 Te/Cur=0.9094 Te/Exp=0.8146] 33%|███▎      | 6/18 [00:43<01:13,  6.09s/it, CE=5.597297e-01 H=5.597586e-01 dV_dx=-1.835383e-05 dV_dθ=4.728716e-05 ||∇||=6.627252e-01 | Tr=0.9184]                            39%|███▉      | 7/18 [00:43<01:02,  5.71s/it, CE=5.597297e-01 H=5.597586e-01 dV_dx=-1.835383e-05 dV_dθ=4.728716e-05 ||∇||=6.627252e-01 | Tr=0.9184] 39%|███▉      | 7/18 [00:49<01:02,  5.71s/it, CE=5.517045e-01 H=5.517227e-01 dV_dx=-3.554761e-06 dV_dθ=2.178488e-05 ||∇||=6.465743e-01 | Tr=0.9248] 44%|████▍     | 8/18 [00:49<00:56,  5.68s/it, CE=5.517045e-01 H=5.517227e-01 dV_dx=-3.554761e-06 dV_dθ=2.178488e-05 ||∇||=6.465743e-01 | Tr=0.9248] 44%|████▍     | 8/18 [00:53<00:56,  5.68s/it, CE=5.443818e-01 H=5.444292e-01 dV_dx=4.827358e-05 dV_dθ=-8.291126e-07 ||∇||=6.335431e-01 | Tr=0.9305] 50%|█████     | 9/18 [00:53<00:47,  5.32s/it, CE=5.443818e-01 H=5.444292e-01 dV_dx=4.827358e-05 dV_dθ=-8.291126e-07 ||∇||=6.335431e-01 | Tr=0.9305] 50%|█████     | 9/18 [00:58<00:47,  5.32s/it, CE=5.377243e-01 H=5.377126e-01 dV_dx=9.867275e-06 dV_dθ=-2.157460e-05 ||∇||=6.244183e-01 | Tr=0.9352] 56%|█████▌    | 10/18 [00:58<00:40,  5.08s/it, CE=5.377243e-01 H=5.377126e-01 dV_dx=9.867275e-06 dV_dθ=-2.157460e-05 ||∇||=6.244183e-01 | Tr=0.9352] 56%|█████▌    | 10/18 [01:05<00:40,  5.08s/it, CE=5.315940e-01 H=5.316015e-01 dV_dx=4.574012e-05 dV_dθ=-3.826635e-05 ||∇||=6.175060e-01 | Tr=0.9386 Te/Cur=0.9347 Te/Exp=0.8232] 61%|██████    | 11/18 [01:05<00:38,  5.56s/it, CE=5.315940e-01 H=5.316015e-01 dV_dx=4.574012e-05 dV_dθ=-3.826635e-05 ||∇||=6.175060e-01 | Tr=0.9386 Te/Cur=0.9347 Te/Exp=0.8232] 61%|██████    | 11/18 [01:09<00:38,  5.56s/it, CE=5.258132e-01 H=5.257319e-01 dV_dx=-2.712286e-05 dV_dθ=-5.419779e-05 ||∇||=6.124056e-01 | Tr=0.9424]                            67%|██████▋   | 12/18 [01:09<00:31,  5.32s/it, CE=5.258132e-01 H=5.257319e-01 dV_dx=-2.712286e-05 dV_dθ=-5.419779e-05 ||∇||=6.124056e-01 | Tr=0.9424] 67%|██████▋   | 12/18 [01:14<00:31,  5.32s/it, CE=5.204517e-01 H=5.203624e-01 dV_dx=-2.224602e-05 dV_dθ=-6.707075e-05 ||∇||=6.076076e-01 | Tr=0.9451] 72%|███████▏  | 13/18 [01:14<00:25,  5.03s/it, CE=5.204517e-01 H=5.203624e-01 dV_dx=-2.224602e-05 dV_dθ=-6.707075e-05 ||∇||=6.076076e-01 | Tr=0.9451] 72%|███████▏  | 13/18 [01:18<00:25,  5.03s/it, CE=5.153427e-01 H=5.153174e-01 dV_dx=5.159478e-05 dV_dθ=-7.683085e-05 ||∇||=6.021150e-01 | Tr=0.9476]  78%|███████▊  | 14/18 [01:18<00:19,  4.86s/it, CE=5.153427e-01 H=5.153174e-01 dV_dx=5.159478e-05 dV_dθ=-7.683085e-05 ||∇||=6.021150e-01 | Tr=0.9476] 78%|███████▊  | 14/18 [01:23<00:19,  4.86s/it, CE=5.104267e-01 H=5.103829e-01 dV_dx=4.156825e-05 dV_dθ=-8.536840e-05 ||∇||=5.969867e-01 | Tr=0.9502] 83%|████████▎ | 15/18 [01:23<00:14,  4.70s/it, CE=5.104267e-01 H=5.103829e-01 dV_dx=4.156825e-05 dV_dθ=-8.536840e-05 ||∇||=5.969867e-01 | Tr=0.9502] 83%|████████▎ | 15/18 [01:29<00:14,  4.70s/it, CE=5.056771e-01 H=5.056666e-01 dV_dx=7.977550e-05 dV_dθ=-9.027821e-05 ||∇||=5.920125e-01 | Tr=0.9522 Te/Cur=0.9499 Te/Exp=0.8282] 89%|████████▉ | 16/18 [01:29<00:10,  5.07s/it, CE=5.056771e-01 H=5.056666e-01 dV_dx=7.977550e-05 dV_dθ=-9.027821e-05 ||∇||=5.920125e-01 | Tr=0.9522 Te/Cur=0.9499 Te/Exp=0.8282] 89%|████████▉ | 16/18 [01:33<00:10,  5.07s/it, CE=5.012123e-01 H=5.010716e-01 dV_dx=-4.510717e-05 dV_dθ=-9.559640e-05 ||∇||=5.882094e-01 | Tr=0.9543]                            94%|█████████▍| 17/18 [01:33<00:04,  4.98s/it, CE=5.012123e-01 H=5.010716e-01 dV_dx=-4.510717e-05 dV_dθ=-9.559640e-05 ||∇||=5.882094e-01 | Tr=0.9543] 94%|█████████▍| 17/18 [01:40<00:04,  4.98s/it, CE=4.969539e-01 H=4.968715e-01 dV_dx=1.777083e-05 dV_dθ=-1.001062e-04 ||∇||=5.841414e-01 | Tr=0.9563 Te/Cur=0.9523 Te/Exp=0.8275]100%|██████████| 18/18 [01:40<00:00,  5.41s/it, CE=4.969539e-01 H=4.968715e-01 dV_dx=1.777083e-05 dV_dθ=-1.001062e-04 ||∇||=5.841414e-01 | Tr=0.9563 Te/Cur=0.9523 Te/Exp=0.8275]100%|██████████| 18/18 [01:40<00:00,  5.57s/it, CE=4.969539e-01 H=4.968715e-01 dV_dx=1.777083e-05 dV_dθ=-1.001062e-04 ||∇||=5.841414e-01 | Tr=0.9563 Te/Cur=0.9523 Te/Exp=0.8275]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.7548
    Task 1: 0.9340
    Task 2: 0.8205
    Task 3: 0.5510
    Task 4: 0.9285
    Task 5: 0.8619
    Task 6: 0.9027
    Task 7: 0.8802
    Task 8: 0.9528

============================================================
Task 9
============================================================
Initial loss on new task: 1.6916, previous: 0.4970, ratio: 3.40
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=3.40)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.84s/it] 50%|█████     | 1/2 [00:15<00:08,  8.84s/it, CE=1.671746e+00 H=1.377088e+00 dV_dx=4.618990e-06 dV_dθ=-2.946628e-01 ||∇||=1.276674e+01 | Tr=0.4728 Te/Cur=0.4755 Te/Exp=0.8429]100%|██████████| 2/2 [00:15<00:00,  7.82s/it, CE=1.671746e+00 H=1.377088e+00 dV_dx=4.618990e-06 dV_dθ=-2.946628e-01 ||∇||=1.276674e+01 | Tr=0.4728 Te/Cur=0.4755 Te/Exp=0.8429]100%|██████████| 2/2 [00:15<00:00,  7.97s/it, CE=1.671746e+00 H=1.377088e+00 dV_dx=4.618990e-06 dV_dθ=-2.946628e-01 ||∇||=1.276674e+01 | Tr=0.4728 Te/Cur=0.4755 Te/Exp=0.8429]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:19, 11.73s/it]  6%|▌         | 1/18 [00:16<03:19, 11.73s/it, CE=4.846906e-01 H=4.845469e-01 dV_dx=-3.648872e-05 dV_dθ=-1.071524e-04 ||∇||=9.712075e-01 | Tr=0.8621] 11%|█         | 2/18 [00:16<02:03,  7.69s/it, CE=4.846906e-01 H=4.845469e-01 dV_dx=-3.648872e-05 dV_dθ=-1.071524e-04 ||∇||=9.712075e-01 | Tr=0.8621] 11%|█         | 2/18 [00:21<02:03,  7.69s/it, CE=4.796369e-01 H=4.795193e-01 dV_dx=1.939643e-05 dV_dθ=-1.369965e-04 ||∇||=8.629717e-01 | Tr=0.8897]  17%|█▋        | 3/18 [00:21<01:37,  6.47s/it, CE=4.796369e-01 H=4.795193e-01 dV_dx=1.939643e-05 dV_dθ=-1.369965e-04 ||∇||=8.629717e-01 | Tr=0.8897] 17%|█▋        | 3/18 [00:27<01:37,  6.47s/it, CE=4.751270e-01 H=4.749458e-01 dV_dx=-1.773051e-05 dV_dθ=-1.634993e-04 ||∇||=8.157784e-01 | Tr=0.9033] 22%|██▏       | 4/18 [00:27<01:24,  6.05s/it, CE=4.751270e-01 H=4.749458e-01 dV_dx=-1.773051e-05 dV_dθ=-1.634993e-04 ||∇||=8.157784e-01 | Tr=0.9033] 22%|██▏       | 4/18 [00:32<01:24,  6.05s/it, CE=4.701920e-01 H=4.700513e-01 dV_dx=3.230766e-05 dV_dθ=-1.730249e-04 ||∇||=7.842087e-01 | Tr=0.9133]  28%|██▊       | 5/18 [00:32<01:14,  5.75s/it, CE=4.701920e-01 H=4.700513e-01 dV_dx=3.230766e-05 dV_dθ=-1.730249e-04 ||∇||=7.842087e-01 | Tr=0.9133] 28%|██▊       | 5/18 [00:39<01:14,  5.75s/it, CE=4.650995e-01 H=4.649505e-01 dV_dx=2.949869e-05 dV_dθ=-1.785076e-04 ||∇||=7.600054e-01 | Tr=0.9202 Te/Cur=0.9199 Te/Exp=0.8320] 33%|███▎      | 6/18 [00:39<01:13,  6.11s/it, CE=4.650995e-01 H=4.649505e-01 dV_dx=2.949869e-05 dV_dθ=-1.785076e-04 ||∇||=7.600054e-01 | Tr=0.9202 Te/Cur=0.9199 Te/Exp=0.8320] 33%|███▎      | 6/18 [00:43<01:13,  6.11s/it, CE=4.600986e-01 H=4.599209e-01 dV_dx=1.206925e-06 dV_dθ=-1.789213e-04 ||∇||=7.389597e-01 | Tr=0.9251]                             39%|███▉      | 7/18 [00:43<01:02,  5.72s/it, CE=4.600986e-01 H=4.599209e-01 dV_dx=1.206925e-06 dV_dθ=-1.789213e-04 ||∇||=7.389597e-01 | Tr=0.9251] 39%|███▉      | 7/18 [00:48<01:02,  5.72s/it, CE=4.552254e-01 H=4.550681e-01 dV_dx=2.201141e-05 dV_dθ=-1.793248e-04 ||∇||=7.218377e-01 | Tr=0.9292] 44%|████▍     | 8/18 [00:48<00:53,  5.33s/it, CE=4.552254e-01 H=4.550681e-01 dV_dx=2.201141e-05 dV_dθ=-1.793248e-04 ||∇||=7.218377e-01 | Tr=0.9292] 44%|████▍     | 8/18 [00:52<00:53,  5.33s/it, CE=4.504530e-01 H=4.501961e-01 dV_dx=-7.762848e-05 dV_dθ=-1.792476e-04 ||∇||=7.069184e-01 | Tr=0.9331] 50%|█████     | 9/18 [00:52<00:45,  5.08s/it, CE=4.504530e-01 H=4.501961e-01 dV_dx=-7.762848e-05 dV_dθ=-1.792476e-04 ||∇||=7.069184e-01 | Tr=0.9331] 50%|█████     | 9/18 [00:57<00:45,  5.08s/it, CE=4.460438e-01 H=4.457685e-01 dV_dx=-9.780360e-05 dV_dθ=-1.774757e-04 ||∇||=6.944349e-01 | Tr=0.9362] 56%|█████▌    | 10/18 [00:57<00:38,  4.82s/it, CE=4.460438e-01 H=4.457685e-01 dV_dx=-9.780360e-05 dV_dθ=-1.774757e-04 ||∇||=6.944349e-01 | Tr=0.9362] 56%|█████▌    | 10/18 [01:03<00:38,  4.82s/it, CE=4.418815e-01 H=4.416714e-01 dV_dx=-2.762720e-05 dV_dθ=-1.825220e-04 ||∇||=6.928120e-01 | Tr=0.9392 Te/Cur=0.9385 Te/Exp=0.8489] 61%|██████    | 11/18 [01:03<00:36,  5.19s/it, CE=4.418815e-01 H=4.416714e-01 dV_dx=-2.762720e-05 dV_dθ=-1.825220e-04 ||∇||=6.928120e-01 | Tr=0.9392 Te/Cur=0.9385 Te/Exp=0.8489] 61%|██████    | 11/18 [01:05<00:36,  5.19s/it, CE=4.378949e-01 H=4.377400e-01 dV_dx=2.512198e-05 dV_dθ=-1.800126e-04 ||∇||=6.894310e-01 | Tr=0.9419]                              67%|██████▋   | 12/18 [01:05<00:26,  4.39s/it, CE=4.378949e-01 H=4.377400e-01 dV_dx=2.512198e-05 dV_dθ=-1.800126e-04 ||∇||=6.894310e-01 | Tr=0.9419] 67%|██████▋   | 12/18 [01:07<00:26,  4.39s/it, CE=4.340426e-01 H=4.338422e-01 dV_dx=-1.992208e-05 dV_dθ=-1.804761e-04 ||∇||=6.820333e-01 | Tr=0.9444] 72%|███████▏  | 13/18 [01:07<00:18,  3.72s/it, CE=4.340426e-01 H=4.338422e-01 dV_dx=-1.992208e-05 dV_dθ=-1.804761e-04 ||∇||=6.820333e-01 | Tr=0.9444] 72%|███████▏  | 13/18 [01:10<00:18,  3.72s/it, CE=4.303430e-01 H=4.300907e-01 dV_dx=-7.443100e-05 dV_dθ=-1.778946e-04 ||∇||=6.748684e-01 | Tr=0.9466] 78%|███████▊  | 14/18 [01:10<00:13,  3.36s/it, CE=4.303430e-01 H=4.300907e-01 dV_dx=-7.443100e-05 dV_dθ=-1.778946e-04 ||∇||=6.748684e-01 | Tr=0.9466] 78%|███████▊  | 14/18 [01:12<00:13,  3.36s/it, CE=4.267415e-01 H=4.265446e-01 dV_dx=-2.059601e-05 dV_dθ=-1.763015e-04 ||∇||=6.679544e-01 | Tr=0.9483] 83%|████████▎ | 15/18 [01:12<00:08,  2.96s/it, CE=4.267415e-01 H=4.265446e-01 dV_dx=-2.059601e-05 dV_dθ=-1.763015e-04 ||∇||=6.679544e-01 | Tr=0.9483] 83%|████████▎ | 15/18 [01:15<00:08,  2.96s/it, CE=4.233077e-01 H=4.231336e-01 dV_dx=2.760779e-06 dV_dθ=-1.768586e-04 ||∇||=6.620215e-01 | Tr=0.9500 Te/Cur=0.9496 Te/Exp=0.8480] 89%|████████▉ | 16/18 [01:15<00:05,  2.85s/it, CE=4.233077e-01 H=4.231336e-01 dV_dx=2.760779e-06 dV_dθ=-1.768586e-04 ||∇||=6.620215e-01 | Tr=0.9500 Te/Cur=0.9496 Te/Exp=0.8480] 89%|████████▉ | 16/18 [01:16<00:05,  2.85s/it, CE=4.199971e-01 H=4.197967e-01 dV_dx=-2.445599e-05 dV_dθ=-1.759216e-04 ||∇||=6.561160e-01 | Tr=0.9518]                            94%|█████████▍| 17/18 [01:16<00:02,  2.39s/it, CE=4.199971e-01 H=4.197967e-01 dV_dx=-2.445599e-05 dV_dθ=-1.759216e-04 ||∇||=6.561160e-01 | Tr=0.9518] 94%|█████████▍| 17/18 [01:18<00:02,  2.39s/it, CE=4.167369e-01 H=4.165561e-01 dV_dx=-4.951632e-06 dV_dθ=-1.757627e-04 ||∇||=6.515874e-01 | Tr=0.9533 Te/Cur=0.9504 Te/Exp=0.8508]100%|██████████| 18/18 [01:18<00:00,  2.23s/it, CE=4.167369e-01 H=4.165561e-01 dV_dx=-4.951632e-06 dV_dθ=-1.757627e-04 ||∇||=6.515874e-01 | Tr=0.9533 Te/Cur=0.9504 Te/Exp=0.8508]100%|██████████| 18/18 [01:18<00:00,  4.35s/it, CE=4.167369e-01 H=4.165561e-01 dV_dx=-4.951632e-06 dV_dθ=-1.757627e-04 ||∇||=6.515874e-01 | Tr=0.9533 Te/Cur=0.9504 Te/Exp=0.8508]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7644
    Task 1: 0.9401
    Task 2: 0.8332
    Task 3: 0.5509
    Task 4: 0.9375
    Task 5: 0.9033
    Task 6: 0.9085
    Task 7: 0.9135
    Task 8: 0.8909
    Task 9: 0.9501
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run0/mnist_condition2_heuristics_run0_run0/classification_mnist_cnn_run0_records.pkl

Training complete!
