JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition2_heuristics.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: False

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run1
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run1/mnist_condition2_heuristics_run1


############################################################
# Run ID: 1
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:18<05:58, 18.89s/it]  5%|▌         | 1/20 [00:23<05:58, 18.89s/it, CE=2.070986e+00 H=2.070558e+00 dV_dx=1.559829e-07 dV_dθ=-4.282602e-04 ||∇||=4.506103e-01 | Tr=0.4015] 10%|█         | 2/20 [00:23<03:12, 10.68s/it, CE=2.070986e+00 H=2.070558e+00 dV_dx=1.559829e-07 dV_dθ=-4.282602e-04 ||∇||=4.506103e-01 | Tr=0.4015] 10%|█         | 2/20 [00:29<03:12, 10.68s/it, CE=1.863806e+00 H=1.862997e+00 dV_dx=4.865485e-07 dV_dθ=-8.088065e-04 ||∇||=6.167660e-01 | Tr=0.4828] 15%|█▌        | 3/20 [00:29<02:18,  8.17s/it, CE=1.863806e+00 H=1.862997e+00 dV_dx=4.865485e-07 dV_dθ=-8.088065e-04 ||∇||=6.167660e-01 | Tr=0.4828] 15%|█▌        | 3/20 [00:34<02:18,  8.17s/it, CE=1.651764e+00 H=1.650735e+00 dV_dx=-2.507296e-07 dV_dθ=-1.029412e-03 ||∇||=6.991945e-01 | Tr=0.5241] 20%|██        | 4/20 [00:34<01:51,  6.96s/it, CE=1.651764e+00 H=1.650735e+00 dV_dx=-2.507296e-07 dV_dθ=-1.029412e-03 ||∇||=6.991945e-01 | Tr=0.5241] 20%|██        | 4/20 [00:39<01:51,  6.96s/it, CE=1.473102e+00 H=1.472109e+00 dV_dx=5.925875e-07 dV_dθ=-9.932725e-04 ||∇||=6.949522e-01 | Tr=0.5572]  25%|██▌       | 5/20 [00:39<01:33,  6.25s/it, CE=1.473102e+00 H=1.472109e+00 dV_dx=5.925875e-07 dV_dθ=-9.932725e-04 ||∇||=6.949522e-01 | Tr=0.5572] 25%|██▌       | 5/20 [00:46<01:33,  6.25s/it, CE=1.336213e+00 H=1.335358e+00 dV_dx=-2.872716e-07 dV_dθ=-8.538848e-04 ||∇||=6.558204e-01 | Tr=0.5850 Te/Cur=0.5879 Te/Exp=0.5899] 30%|███       | 6/20 [00:46<01:33,  6.66s/it, CE=1.336213e+00 H=1.335358e+00 dV_dx=-2.872716e-07 dV_dθ=-8.538848e-04 ||∇||=6.558204e-01 | Tr=0.5850 Te/Cur=0.5879 Te/Exp=0.5899] 30%|███       | 6/20 [00:51<01:33,  6.66s/it, CE=1.233999e+00 H=1.233283e+00 dV_dx=-7.840879e-07 dV_dθ=-7.157632e-04 ||∇||=6.137824e-01 | Tr=0.6079]                             35%|███▌      | 7/20 [00:51<01:18,  6.05s/it, CE=1.233999e+00 H=1.233283e+00 dV_dx=-7.840879e-07 dV_dθ=-7.157632e-04 ||∇||=6.137824e-01 | Tr=0.6079] 35%|███▌      | 7/20 [00:56<01:18,  6.05s/it, CE=1.157435e+00 H=1.156822e+00 dV_dx=2.739597e-07 dV_dθ=-6.125543e-04 ||∇||=5.805800e-01 | Tr=0.6271]  40%|████      | 8/20 [00:56<01:08,  5.68s/it, CE=1.157435e+00 H=1.156822e+00 dV_dx=2.739597e-07 dV_dθ=-6.125543e-04 ||∇||=5.805800e-01 | Tr=0.6271] 40%|████      | 8/20 [01:01<01:08,  5.68s/it, CE=1.098934e+00 H=1.098395e+00 dV_dx=-1.156174e-06 dV_dθ=-5.383682e-04 ||∇||=5.556082e-01 | Tr=0.6435] 45%|████▌     | 9/20 [01:01<01:01,  5.60s/it, CE=1.098934e+00 H=1.098395e+00 dV_dx=-1.156174e-06 dV_dθ=-5.383682e-04 ||∇||=5.556082e-01 | Tr=0.6435] 45%|████▌     | 9/20 [01:06<01:01,  5.60s/it, CE=1.052665e+00 H=1.052176e+00 dV_dx=8.863630e-07 dV_dθ=-4.899559e-04 ||∇||=5.392810e-01 | Tr=0.6567]  50%|█████     | 10/20 [01:06<00:54,  5.47s/it, CE=1.052665e+00 H=1.052176e+00 dV_dx=8.863630e-07 dV_dθ=-4.899559e-04 ||∇||=5.392810e-01 | Tr=0.6567] 50%|█████     | 10/20 [01:13<00:54,  5.47s/it, CE=1.014218e+00 H=1.013759e+00 dV_dx=9.123849e-07 dV_dθ=-4.593064e-04 ||∇||=5.292200e-01 | Tr=0.6679 Te/Cur=0.6653 Te/Exp=0.6632] 55%|█████▌    | 11/20 [01:13<00:53,  5.91s/it, CE=1.014218e+00 H=1.013759e+00 dV_dx=9.123849e-07 dV_dθ=-4.593064e-04 ||∇||=5.292200e-01 | Tr=0.6679 Te/Cur=0.6653 Te/Exp=0.6632] 55%|█████▌    | 11/20 [01:18<00:53,  5.91s/it, CE=9.817873e-01 H=9.813479e-01 dV_dx=-4.286696e-07 dV_dθ=-4.390014e-04 ||∇||=5.232138e-01 | Tr=0.6779]                            60%|██████    | 12/20 [01:18<00:45,  5.66s/it, CE=9.817873e-01 H=9.813479e-01 dV_dx=-4.286696e-07 dV_dθ=-4.390014e-04 ||∇||=5.232138e-01 | Tr=0.6779] 60%|██████    | 12/20 [01:24<00:45,  5.66s/it, CE=9.534942e-01 H=9.530653e-01 dV_dx=3.004729e-07 dV_dθ=-4.292018e-04 ||∇||=5.215526e-01 | Tr=0.6871]  65%|██████▌   | 13/20 [01:24<00:38,  5.52s/it, CE=9.534942e-01 H=9.530653e-01 dV_dx=3.004729e-07 dV_dθ=-4.292018e-04 ||∇||=5.215526e-01 | Tr=0.6871] 65%|██████▌   | 13/20 [01:29<00:38,  5.52s/it, CE=9.285106e-01 H=9.280875e-01 dV_dx=3.263070e-06 dV_dθ=-4.264322e-04 ||∇||=5.221878e-01 | Tr=0.6951] 70%|███████   | 14/20 [01:29<00:32,  5.41s/it, CE=9.285106e-01 H=9.280875e-01 dV_dx=3.263070e-06 dV_dθ=-4.264322e-04 ||∇||=5.221878e-01 | Tr=0.6951] 70%|███████   | 14/20 [01:33<00:32,  5.41s/it, CE=9.061281e-01 H=9.057048e-01 dV_dx=4.507962e-07 dV_dθ=-4.238041e-04 ||∇||=5.231170e-01 | Tr=0.7023] 75%|███████▌  | 15/20 [01:33<00:26,  5.21s/it, CE=9.061281e-01 H=9.057048e-01 dV_dx=4.507962e-07 dV_dθ=-4.238041e-04 ||∇||=5.231170e-01 | Tr=0.7023] 75%|███████▌  | 15/20 [01:40<00:26,  5.21s/it, CE=8.859895e-01 H=8.855777e-01 dV_dx=2.394174e-06 dV_dθ=-4.141588e-04 ||∇||=5.207778e-01 | Tr=0.7083 Te/Cur=0.7053 Te/Exp=0.7056] 80%|████████  | 16/20 [01:40<00:22,  5.61s/it, CE=8.859895e-01 H=8.855777e-01 dV_dx=2.394174e-06 dV_dθ=-4.141588e-04 ||∇||=5.207778e-01 | Tr=0.7083 Te/Cur=0.7053 Te/Exp=0.7056] 80%|████████  | 16/20 [01:45<00:22,  5.61s/it, CE=8.677829e-01 H=8.673749e-01 dV_dx=8.472550e-09 dV_dθ=-4.080014e-04 ||∇||=5.201738e-01 | Tr=0.7140]                             85%|████████▌ | 17/20 [01:45<00:16,  5.37s/it, CE=8.677829e-01 H=8.673749e-01 dV_dx=8.472550e-09 dV_dθ=-4.080014e-04 ||∇||=5.201738e-01 | Tr=0.7140] 85%|████████▌ | 17/20 [01:50<00:16,  5.37s/it, CE=8.510975e-01 H=8.506928e-01 dV_dx=1.528296e-07 dV_dθ=-4.048990e-04 ||∇||=5.208893e-01 | Tr=0.7202] 90%|█████████ | 18/20 [01:50<00:10,  5.22s/it, CE=8.510975e-01 H=8.506928e-01 dV_dx=1.528296e-07 dV_dθ=-4.048990e-04 ||∇||=5.208893e-01 | Tr=0.7202] 90%|█████████ | 18/20 [01:55<00:10,  5.22s/it, CE=8.356411e-01 H=8.352410e-01 dV_dx=2.550833e-06 dV_dθ=-4.026088e-04 ||∇||=5.216354e-01 | Tr=0.7252] 95%|█████████▌| 19/20 [01:55<00:05,  5.30s/it, CE=8.356411e-01 H=8.352410e-01 dV_dx=2.550833e-06 dV_dθ=-4.026088e-04 ||∇||=5.216354e-01 | Tr=0.7252] 95%|█████████▌| 19/20 [02:01<00:05,  5.30s/it, CE=8.212240e-01 H=8.208231e-01 dV_dx=1.706781e-06 dV_dθ=-4.026129e-04 ||∇||=5.232037e-01 | Tr=0.7298 Te/Cur=0.7292 Te/Exp=0.7270]100%|██████████| 20/20 [02:01<00:00,  5.57s/it, CE=8.212240e-01 H=8.208231e-01 dV_dx=1.706781e-06 dV_dθ=-4.026129e-04 ||∇||=5.232037e-01 | Tr=0.7298 Te/Cur=0.7292 Te/Exp=0.7270]100%|██████████| 20/20 [02:01<00:00,  6.09s/it, CE=8.212240e-01 H=8.208231e-01 dV_dx=1.706781e-06 dV_dθ=-4.026129e-04 ||∇||=5.232037e-01 | Tr=0.7298 Te/Cur=0.7292 Te/Exp=0.7270]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7269

============================================================
Task 1
============================================================
Initial loss on new task: 5.7178, previous: 0.8212, ratio: 6.96
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=6.96)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.42s/it] 50%|█████     | 1/2 [00:13<00:08,  8.42s/it, CE=5.793130e+00 H=4.833459e+00 dV_dx=1.185296e-06 dV_dθ=-9.596721e-01 ||∇||=2.282773e+01 | Tr=0.1009 Te/Cur=0.0983 Te/Exp=0.7260]100%|██████████| 2/2 [00:13<00:00,  6.74s/it, CE=5.793130e+00 H=4.833459e+00 dV_dx=1.185296e-06 dV_dθ=-9.596721e-01 ||∇||=2.282773e+01 | Tr=0.1009 Te/Cur=0.0983 Te/Exp=0.7260]100%|██████████| 2/2 [00:13<00:00,  6.99s/it, CE=5.793130e+00 H=4.833459e+00 dV_dx=1.185296e-06 dV_dθ=-9.596721e-01 ||∇||=2.282773e+01 | Tr=0.1009 Te/Cur=0.0983 Te/Exp=0.7260]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:08<02:30,  8.83s/it]  6%|▌         | 1/18 [00:13<02:30,  8.83s/it, CE=9.065660e-01 H=9.084157e-01 dV_dx=-9.008811e-06 dV_dθ=1.858755e-03 ||∇||=1.115960e+00 | Tr=0.6070] 11%|█         | 2/18 [00:13<01:40,  6.27s/it, CE=9.065660e-01 H=9.084157e-01 dV_dx=-9.008811e-06 dV_dθ=1.858755e-03 ||∇||=1.115960e+00 | Tr=0.6070] 11%|█         | 2/18 [00:17<01:40,  6.27s/it, CE=8.567686e-01 H=8.567735e-01 dV_dx=5.119407e-05 dV_dθ=-4.635528e-05 ||∇||=8.073990e-01 | Tr=0.7216] 17%|█▋        | 3/18 [00:17<01:21,  5.44s/it, CE=8.567686e-01 H=8.567735e-01 dV_dx=5.119407e-05 dV_dθ=-4.635528e-05 ||∇||=8.073990e-01 | Tr=0.7216] 17%|█▋        | 3/18 [00:21<01:21,  5.44s/it, CE=8.472234e-01 H=8.471421e-01 dV_dx=2.887034e-05 dV_dθ=-1.101410e-04 ||∇||=7.031459e-01 | Tr=0.7782] 22%|██▏       | 4/18 [00:21<01:06,  4.76s/it, CE=8.472234e-01 H=8.471421e-01 dV_dx=2.887034e-05 dV_dθ=-1.101410e-04 ||∇||=7.031459e-01 | Tr=0.7782] 22%|██▏       | 4/18 [00:26<01:06,  4.76s/it, CE=8.394262e-01 H=8.393251e-01 dV_dx=6.194467e-06 dV_dθ=-1.072827e-04 ||∇||=6.435222e-01 | Tr=0.8116] 28%|██▊       | 5/18 [00:26<01:01,  4.71s/it, CE=8.394262e-01 H=8.393251e-01 dV_dx=6.194467e-06 dV_dθ=-1.072827e-04 ||∇||=6.435222e-01 | Tr=0.8116] 28%|██▊       | 5/18 [00:32<01:01,  4.71s/it, CE=8.326007e-01 H=8.324895e-01 dV_dx=-1.476430e-05 dV_dθ=-9.644398e-05 ||∇||=6.022155e-01 | Tr=0.8360 Te/Cur=0.8440 Te/Exp=0.7240] 33%|███▎      | 6/18 [00:32<01:02,  5.17s/it, CE=8.326007e-01 H=8.324895e-01 dV_dx=-1.476430e-05 dV_dθ=-9.644398e-05 ||∇||=6.022155e-01 | Tr=0.8360 Te/Cur=0.8440 Te/Exp=0.7240] 33%|███▎      | 6/18 [00:36<01:02,  5.17s/it, CE=8.262463e-01 H=8.261613e-01 dV_dx=4.645467e-06 dV_dθ=-8.963026e-05 ||∇||=5.724215e-01 | Tr=0.8523]                              39%|███▉      | 7/18 [00:36<00:52,  4.77s/it, CE=8.262463e-01 H=8.261613e-01 dV_dx=4.645467e-06 dV_dθ=-8.963026e-05 ||∇||=5.724215e-01 | Tr=0.8523] 39%|███▉      | 7/18 [00:40<00:52,  4.77s/it, CE=8.203254e-01 H=8.201869e-01 dV_dx=-4.867363e-05 dV_dθ=-8.988174e-05 ||∇||=5.537057e-01 | Tr=0.8636] 44%|████▍     | 8/18 [00:40<00:46,  4.65s/it, CE=8.203254e-01 H=8.201869e-01 dV_dx=-4.867363e-05 dV_dθ=-8.988174e-05 ||∇||=5.537057e-01 | Tr=0.8636] 44%|████▍     | 8/18 [00:44<00:46,  4.65s/it, CE=8.146833e-01 H=8.146472e-01 dV_dx=5.199212e-05 dV_dθ=-8.808068e-05 ||∇||=5.386789e-01 | Tr=0.8726]  50%|█████     | 9/18 [00:44<00:41,  4.58s/it, CE=8.146833e-01 H=8.146472e-01 dV_dx=5.199212e-05 dV_dθ=-8.808068e-05 ||∇||=5.386789e-01 | Tr=0.8726] 50%|█████     | 9/18 [00:48<00:41,  4.58s/it, CE=8.092569e-01 H=8.092486e-01 dV_dx=7.477508e-05 dV_dθ=-8.310841e-05 ||∇||=5.255088e-01 | Tr=0.8796] 56%|█████▌    | 10/18 [00:48<00:35,  4.40s/it, CE=8.092569e-01 H=8.092486e-01 dV_dx=7.477508e-05 dV_dθ=-8.310841e-05 ||∇||=5.255088e-01 | Tr=0.8796] 56%|█████▌    | 10/18 [00:54<00:35,  4.40s/it, CE=8.041150e-01 H=8.040517e-01 dV_dx=1.963316e-05 dV_dθ=-8.292071e-05 ||∇||=5.183305e-01 | Tr=0.8859 Te/Cur=0.8866 Te/Exp=0.7319] 61%|██████    | 11/18 [00:54<00:34,  4.86s/it, CE=8.041150e-01 H=8.040517e-01 dV_dx=1.963316e-05 dV_dθ=-8.292071e-05 ||∇||=5.183305e-01 | Tr=0.8859 Te/Cur=0.8866 Te/Exp=0.7319] 61%|██████    | 11/18 [00:59<00:34,  4.86s/it, CE=7.991098e-01 H=7.989960e-01 dV_dx=-2.895462e-05 dV_dθ=-8.489279e-05 ||∇||=5.122005e-01 | Tr=0.8913]                            67%|██████▋   | 12/18 [00:59<00:28,  4.70s/it, CE=7.991098e-01 H=7.989960e-01 dV_dx=-2.895462e-05 dV_dθ=-8.489279e-05 ||∇||=5.122005e-01 | Tr=0.8913] 67%|██████▋   | 12/18 [01:03<00:28,  4.70s/it, CE=7.937681e-01 H=7.937079e-01 dV_dx=2.563350e-05 dV_dθ=-8.576704e-05 ||∇||=5.089367e-01 | Tr=0.8959]  72%|███████▏  | 13/18 [01:03<00:23,  4.66s/it, CE=7.937681e-01 H=7.937079e-01 dV_dx=2.563350e-05 dV_dθ=-8.576704e-05 ||∇||=5.089367e-01 | Tr=0.8959] 72%|███████▏  | 13/18 [01:08<00:23,  4.66s/it, CE=7.885669e-01 H=7.884580e-01 dV_dx=-2.681097e-05 dV_dθ=-8.206593e-05 ||∇||=5.022452e-01 | Tr=0.8996] 78%|███████▊  | 14/18 [01:08<00:18,  4.65s/it, CE=7.885669e-01 H=7.884580e-01 dV_dx=-2.681097e-05 dV_dθ=-8.206593e-05 ||∇||=5.022452e-01 | Tr=0.8996] 78%|███████▊  | 14/18 [01:12<00:18,  4.65s/it, CE=7.837187e-01 H=7.836613e-01 dV_dx=3.080250e-05 dV_dθ=-8.819815e-05 ||∇||=5.012363e-01 | Tr=0.9034]  83%|████████▎ | 15/18 [01:12<00:13,  4.59s/it, CE=7.837187e-01 H=7.836613e-01 dV_dx=3.080250e-05 dV_dθ=-8.819815e-05 ||∇||=5.012363e-01 | Tr=0.9034] 83%|████████▎ | 15/18 [01:18<00:13,  4.59s/it, CE=7.789440e-01 H=7.788057e-01 dV_dx=-4.623656e-05 dV_dθ=-9.211997e-05 ||∇||=5.001110e-01 | Tr=0.9069 Te/Cur=0.9092 Te/Exp=0.7422] 89%|████████▉ | 16/18 [01:18<00:09,  4.88s/it, CE=7.789440e-01 H=7.788057e-01 dV_dx=-4.623656e-05 dV_dθ=-9.211997e-05 ||∇||=5.001110e-01 | Tr=0.9069 Te/Cur=0.9092 Te/Exp=0.7422] 89%|████████▉ | 16/18 [01:22<00:09,  4.88s/it, CE=7.741854e-01 H=7.741849e-01 dV_dx=9.151398e-05 dV_dθ=-9.203821e-05 ||∇||=4.975722e-01 | Tr=0.9099]                              94%|█████████▍| 17/18 [01:22<00:04,  4.75s/it, CE=7.741854e-01 H=7.741849e-01 dV_dx=9.151398e-05 dV_dθ=-9.203821e-05 ||∇||=4.975722e-01 | Tr=0.9099] 94%|█████████▍| 17/18 [01:30<00:04,  4.75s/it, CE=7.694012e-01 H=7.693464e-01 dV_dx=3.979270e-05 dV_dθ=-9.460781e-05 ||∇||=4.960315e-01 | Tr=0.9129 Te/Cur=0.9141 Te/Exp=0.7462]100%|██████████| 18/18 [01:30<00:00,  5.52s/it, CE=7.694012e-01 H=7.693464e-01 dV_dx=3.979270e-05 dV_dθ=-9.460781e-05 ||∇||=4.960315e-01 | Tr=0.9129 Te/Cur=0.9141 Te/Exp=0.7462]100%|██████████| 18/18 [01:30<00:00,  5.01s/it, CE=7.694012e-01 H=7.693464e-01 dV_dx=3.979270e-05 dV_dθ=-9.460781e-05 ||∇||=4.960315e-01 | Tr=0.9129 Te/Cur=0.9141 Te/Exp=0.7462]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.7460
    Task 1: 0.9133

============================================================
Task 2
============================================================
Initial loss on new task: 4.7358, previous: 0.7694, ratio: 6.16
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=6.16)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.45s/it] 50%|█████     | 1/2 [00:15<00:08,  8.45s/it, CE=4.684300e+00 H=3.755715e+00 dV_dx=2.497513e-06 dV_dθ=-9.285876e-01 ||∇||=2.245140e+01 | Tr=0.1228 Te/Cur=0.1205 Te/Exp=0.8316]100%|██████████| 2/2 [00:15<00:00,  7.36s/it, CE=4.684300e+00 H=3.755715e+00 dV_dx=2.497513e-06 dV_dθ=-9.285876e-01 ||∇||=2.245140e+01 | Tr=0.1228 Te/Cur=0.1205 Te/Exp=0.8316]100%|██████████| 2/2 [00:15<00:00,  7.52s/it, CE=4.684300e+00 H=3.755715e+00 dV_dx=2.497513e-06 dV_dθ=-9.285876e-01 ||∇||=2.245140e+01 | Tr=0.1228 Te/Cur=0.1205 Te/Exp=0.8316]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:09<02:37,  9.26s/it]  6%|▌         | 1/18 [00:13<02:37,  9.26s/it, CE=7.496426e-01 H=7.538786e-01 dV_dx=4.637105e-05 dV_dθ=4.189626e-03 ||∇||=1.254454e+00 | Tr=0.4700] 11%|█         | 2/18 [00:13<01:37,  6.12s/it, CE=7.496426e-01 H=7.538786e-01 dV_dx=4.637105e-05 dV_dθ=4.189626e-03 ||∇||=1.254454e+00 | Tr=0.4700] 11%|█         | 2/18 [00:17<01:37,  6.12s/it, CE=7.371473e-01 H=7.404186e-01 dV_dx=-1.330941e-06 dV_dθ=3.272620e-03 ||∇||=8.993099e-01 | Tr=0.5552] 17%|█▋        | 3/18 [00:17<01:18,  5.20s/it, CE=7.371473e-01 H=7.404186e-01 dV_dx=-1.330941e-06 dV_dθ=3.272620e-03 ||∇||=8.993099e-01 | Tr=0.5552] 17%|█▋        | 3/18 [00:22<01:18,  5.20s/it, CE=7.120231e-01 H=7.147269e-01 dV_dx=1.751908e-05 dV_dθ=2.686312e-03 ||∇||=7.959926e-01 | Tr=0.6083]  22%|██▏       | 4/18 [00:22<01:11,  5.13s/it, CE=7.120231e-01 H=7.147269e-01 dV_dx=1.751908e-05 dV_dθ=2.686312e-03 ||∇||=7.959926e-01 | Tr=0.6083] 22%|██▏       | 4/18 [00:26<01:11,  5.13s/it, CE=6.879563e-01 H=6.900147e-01 dV_dx=-5.124784e-06 dV_dθ=2.063552e-03 ||∇||=7.639009e-01 | Tr=0.6454] 28%|██▊       | 5/18 [00:26<01:03,  4.90s/it, CE=6.879563e-01 H=6.900147e-01 dV_dx=-5.124784e-06 dV_dθ=2.063552e-03 ||∇||=7.639009e-01 | Tr=0.6454] 28%|██▊       | 5/18 [00:32<01:03,  4.90s/it, CE=6.683802e-01 H=6.699584e-01 dV_dx=1.806891e-06 dV_dθ=1.576427e-03 ||∇||=7.486189e-01 | Tr=0.6738 Te/Cur=0.6930 Te/Exp=0.7860] 33%|███▎      | 6/18 [00:32<01:02,  5.17s/it, CE=6.683802e-01 H=6.699584e-01 dV_dx=1.806891e-06 dV_dθ=1.576427e-03 ||∇||=7.486189e-01 | Tr=0.6738 Te/Cur=0.6930 Te/Exp=0.7860] 33%|███▎      | 6/18 [00:37<01:02,  5.17s/it, CE=6.514590e-01 H=6.526385e-01 dV_dx=-1.257129e-05 dV_dθ=1.192085e-03 ||∇||=7.365144e-01 | Tr=0.6956]                            39%|███▉      | 7/18 [00:37<00:55,  5.04s/it, CE=6.514590e-01 H=6.526385e-01 dV_dx=-1.257129e-05 dV_dθ=1.192085e-03 ||∇||=7.365144e-01 | Tr=0.6956] 39%|███▉      | 7/18 [00:41<00:55,  5.04s/it, CE=6.367676e-01 H=6.376501e-01 dV_dx=1.191076e-05 dV_dθ=8.706059e-04 ||∇||=7.301852e-01 | Tr=0.7126]  44%|████▍     | 8/18 [00:41<00:46,  4.63s/it, CE=6.367676e-01 H=6.376501e-01 dV_dx=1.191076e-05 dV_dθ=8.706059e-04 ||∇||=7.301852e-01 | Tr=0.7126] 44%|████▍     | 8/18 [00:45<00:46,  4.63s/it, CE=6.244228e-01 H=6.250489e-01 dV_dx=-1.944886e-05 dV_dθ=6.455674e-04 ||∇||=7.238348e-01 | Tr=0.7280] 50%|█████     | 9/18 [00:45<00:40,  4.50s/it, CE=6.244228e-01 H=6.250489e-01 dV_dx=-1.944886e-05 dV_dθ=6.455674e-04 ||∇||=7.238348e-01 | Tr=0.7280] 50%|█████     | 9/18 [00:49<00:40,  4.50s/it, CE=6.139382e-01 H=6.144129e-01 dV_dx=-2.650092e-06 dV_dθ=4.773526e-04 ||∇||=7.179894e-01 | Tr=0.7404] 56%|█████▌    | 10/18 [00:49<00:35,  4.48s/it, CE=6.139382e-01 H=6.144129e-01 dV_dx=-2.650092e-06 dV_dθ=4.773526e-04 ||∇||=7.179894e-01 | Tr=0.7404] 56%|█████▌    | 10/18 [00:55<00:35,  4.48s/it, CE=6.049070e-01 H=6.053170e-01 dV_dx=5.334203e-05 dV_dθ=3.566940e-04 ||∇||=7.132763e-01 | Tr=0.7507 Te/Cur=0.7604 Te/Exp=0.8044] 61%|██████    | 11/18 [00:55<00:34,  4.98s/it, CE=6.049070e-01 H=6.053170e-01 dV_dx=5.334203e-05 dV_dθ=3.566940e-04 ||∇||=7.132763e-01 | Tr=0.7507 Te/Cur=0.7604 Te/Exp=0.8044] 61%|██████    | 11/18 [00:59<00:34,  4.98s/it, CE=5.969392e-01 H=5.972184e-01 dV_dx=1.319813e-05 dV_dθ=2.659816e-04 ||∇||=7.117436e-01 | Tr=0.7595]                             67%|██████▋   | 12/18 [00:59<00:27,  4.60s/it, CE=5.969392e-01 H=5.972184e-01 dV_dx=1.319813e-05 dV_dθ=2.659816e-04 ||∇||=7.117436e-01 | Tr=0.7595] 67%|██████▋   | 12/18 [01:04<00:27,  4.60s/it, CE=5.897186e-01 H=5.898911e-01 dV_dx=-1.478502e-05 dV_dθ=1.872393e-04 ||∇||=7.121747e-01 | Tr=0.7663] 72%|███████▏  | 13/18 [01:04<00:23,  4.63s/it, CE=5.897186e-01 H=5.898911e-01 dV_dx=-1.478502e-05 dV_dθ=1.872393e-04 ||∇||=7.121747e-01 | Tr=0.7663] 72%|███████▏  | 13/18 [01:09<00:23,  4.63s/it, CE=5.832633e-01 H=5.834025e-01 dV_dx=1.314512e-05 dV_dθ=1.260677e-04 ||∇||=7.106916e-01 | Tr=0.7731]  78%|███████▊  | 14/18 [01:09<00:18,  4.69s/it, CE=5.832633e-01 H=5.834025e-01 dV_dx=1.314512e-05 dV_dθ=1.260677e-04 ||∇||=7.106916e-01 | Tr=0.7731] 78%|███████▊  | 14/18 [01:13<00:18,  4.69s/it, CE=5.772305e-01 H=5.773322e-01 dV_dx=3.183857e-05 dV_dθ=6.982931e-05 ||∇||=7.105560e-01 | Tr=0.7802] 83%|████████▎ | 15/18 [01:13<00:14,  4.74s/it, CE=5.772305e-01 H=5.773322e-01 dV_dx=3.183857e-05 dV_dθ=6.982931e-05 ||∇||=7.105560e-01 | Tr=0.7802] 83%|████████▎ | 15/18 [01:19<00:14,  4.74s/it, CE=5.713202e-01 H=5.714072e-01 dV_dx=6.457659e-05 dV_dθ=2.240489e-05 ||∇||=7.106948e-01 | Tr=0.7872 Te/Cur=0.7846 Te/Exp=0.8109] 89%|████████▉ | 16/18 [01:19<00:10,  5.14s/it, CE=5.713202e-01 H=5.714072e-01 dV_dx=6.457659e-05 dV_dθ=2.240489e-05 ||∇||=7.106948e-01 | Tr=0.7872 Te/Cur=0.7846 Te/Exp=0.8109] 89%|████████▉ | 16/18 [01:23<00:10,  5.14s/it, CE=5.655759e-01 H=5.655537e-01 dV_dx=-1.694086e-06 dV_dθ=-2.049742e-05 ||∇||=7.090749e-01 | Tr=0.7924]                           94%|█████████▍| 17/18 [01:23<00:04,  4.78s/it, CE=5.655759e-01 H=5.655537e-01 dV_dx=-1.694086e-06 dV_dθ=-2.049742e-05 ||∇||=7.090749e-01 | Tr=0.7924] 94%|█████████▍| 17/18 [01:30<00:04,  4.78s/it, CE=5.600879e-01 H=5.600169e-01 dV_dx=-1.302121e-05 dV_dθ=-5.794243e-05 ||∇||=7.108905e-01 | Tr=0.7980 Te/Cur=0.7923 Te/Exp=0.8127]100%|██████████| 18/18 [01:30<00:00,  5.43s/it, CE=5.600879e-01 H=5.600169e-01 dV_dx=-1.302121e-05 dV_dθ=-5.794243e-05 ||∇||=7.108905e-01 | Tr=0.7980 Te/Cur=0.7923 Te/Exp=0.8127]100%|██████████| 18/18 [01:30<00:00,  5.05s/it, CE=5.600879e-01 H=5.600169e-01 dV_dx=-1.302121e-05 dV_dθ=-5.794243e-05 ||∇||=7.108905e-01 | Tr=0.7980 Te/Cur=0.7923 Te/Exp=0.8127]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.7052
    Task 1: 0.9184
    Task 2: 0.7932

============================================================
Task 3
============================================================
Initial loss on new task: 4.4470, previous: 0.5601, ratio: 7.94
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.94)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.14s/it] 50%|█████     | 1/2 [00:13<00:08,  8.14s/it, CE=4.387175e+00 H=3.772887e+00 dV_dx=5.380497e-06 dV_dθ=-6.142935e-01 ||∇||=1.826214e+01 | Tr=0.1132 Te/Cur=0.1173 Te/Exp=0.8056]100%|██████████| 2/2 [00:13<00:00,  6.53s/it, CE=4.387175e+00 H=3.772887e+00 dV_dx=5.380497e-06 dV_dθ=-6.142935e-01 ||∇||=1.826214e+01 | Tr=0.1132 Te/Cur=0.1173 Te/Exp=0.8056]100%|██████████| 2/2 [00:13<00:00,  6.77s/it, CE=4.387175e+00 H=3.772887e+00 dV_dx=5.380497e-06 dV_dθ=-6.142935e-01 ||∇||=1.826214e+01 | Tr=0.1132 Te/Cur=0.1173 Te/Exp=0.8056]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:10<03:04, 10.85s/it]  6%|▌         | 1/18 [00:15<03:04, 10.85s/it, CE=7.005474e-01 H=7.029733e-01 dV_dx=3.406431e-06 dV_dθ=2.422484e-03 ||∇||=9.152416e-01 | Tr=0.3561] 11%|█         | 2/18 [00:15<01:52,  7.05s/it, CE=7.005474e-01 H=7.029733e-01 dV_dx=3.406431e-06 dV_dθ=2.422484e-03 ||∇||=9.152416e-01 | Tr=0.3561] 11%|█         | 2/18 [00:19<01:52,  7.05s/it, CE=6.478910e-01 H=6.485808e-01 dV_dx=-1.045056e-05 dV_dθ=7.002650e-04 ||∇||=8.213182e-01 | Tr=0.3972] 17%|█▋        | 3/18 [00:19<01:24,  5.64s/it, CE=6.478910e-01 H=6.485808e-01 dV_dx=-1.045056e-05 dV_dθ=7.002650e-04 ||∇||=8.213182e-01 | Tr=0.3972] 17%|█▋        | 3/18 [00:23<01:24,  5.64s/it, CE=6.282175e-01 H=6.283458e-01 dV_dx=-1.126261e-05 dV_dθ=1.396193e-04 ||∇||=7.896827e-01 | Tr=0.4264] 22%|██▏       | 4/18 [00:23<01:12,  5.15s/it, CE=6.282175e-01 H=6.283458e-01 dV_dx=-1.126261e-05 dV_dθ=1.396193e-04 ||∇||=7.896827e-01 | Tr=0.4264] 22%|██▏       | 4/18 [00:27<01:12,  5.15s/it, CE=6.155821e-01 H=6.155533e-01 dV_dx=8.202492e-06 dV_dθ=-3.708300e-05 ||∇||=7.556046e-01 | Tr=0.4495] 28%|██▊       | 5/18 [00:27<01:00,  4.67s/it, CE=6.155821e-01 H=6.155533e-01 dV_dx=8.202492e-06 dV_dθ=-3.708300e-05 ||∇||=7.556046e-01 | Tr=0.4495] 28%|██▊       | 5/18 [00:33<01:00,  4.67s/it, CE=6.057727e-01 H=6.056332e-01 dV_dx=-2.326353e-05 dV_dθ=-1.162362e-04 ||∇||=7.335815e-01 | Tr=0.4686 Te/Cur=0.4721 Te/Exp=0.8011] 33%|███▎      | 6/18 [00:33<01:00,  5.08s/it, CE=6.057727e-01 H=6.056332e-01 dV_dx=-2.326353e-05 dV_dθ=-1.162362e-04 ||∇||=7.335815e-01 | Tr=0.4686 Te/Cur=0.4721 Te/Exp=0.8011] 33%|███▎      | 6/18 [00:38<01:00,  5.08s/it, CE=5.975032e-01 H=5.973788e-01 dV_dx=3.591309e-05 dV_dθ=-1.602401e-04 ||∇||=7.239948e-01 | Tr=0.4827]                              39%|███▉      | 7/18 [00:38<00:54,  4.98s/it, CE=5.975032e-01 H=5.973788e-01 dV_dx=3.591309e-05 dV_dθ=-1.602401e-04 ||∇||=7.239948e-01 | Tr=0.4827] 39%|███▉      | 7/18 [00:41<00:54,  4.98s/it, CE=5.899546e-01 H=5.897796e-01 dV_dx=1.590921e-05 dV_dθ=-1.908486e-04 ||∇||=7.190253e-01 | Tr=0.4944] 44%|████▍     | 8/18 [00:41<00:46,  4.62s/it, CE=5.899546e-01 H=5.897796e-01 dV_dx=1.590921e-05 dV_dθ=-1.908486e-04 ||∇||=7.190253e-01 | Tr=0.4944] 44%|████▍     | 8/18 [00:46<00:46,  4.62s/it, CE=5.828837e-01 H=5.826858e-01 dV_dx=8.751669e-06 dV_dθ=-2.066451e-04 ||∇||=7.147100e-01 | Tr=0.5027] 50%|█████     | 9/18 [00:46<00:41,  4.64s/it, CE=5.828837e-01 H=5.826858e-01 dV_dx=8.751669e-06 dV_dθ=-2.066451e-04 ||∇||=7.147100e-01 | Tr=0.5027] 50%|█████     | 9/18 [00:50<00:41,  4.64s/it, CE=5.765374e-01 H=5.763015e-01 dV_dx=-1.935815e-05 dV_dθ=-2.166180e-04 ||∇||=7.091218e-01 | Tr=0.5102] 56%|█████▌    | 10/18 [00:50<00:36,  4.52s/it, CE=5.765374e-01 H=5.763015e-01 dV_dx=-1.935815e-05 dV_dθ=-2.166180e-04 ||∇||=7.091218e-01 | Tr=0.5102] 56%|█████▌    | 10/18 [00:57<00:36,  4.52s/it, CE=5.706763e-01 H=5.704237e-01 dV_dx=-1.727354e-05 dV_dθ=-2.353017e-04 ||∇||=7.091141e-01 | Tr=0.5161 Te/Cur=0.5128 Te/Exp=0.8186] 61%|██████    | 11/18 [00:57<00:36,  5.15s/it, CE=5.706763e-01 H=5.704237e-01 dV_dx=-1.727354e-05 dV_dθ=-2.353017e-04 ||∇||=7.091141e-01 | Tr=0.5161 Te/Cur=0.5128 Te/Exp=0.8186] 61%|██████    | 11/18 [01:01<00:36,  5.15s/it, CE=5.652560e-01 H=5.649963e-01 dV_dx=-3.399500e-06 dV_dθ=-2.563629e-04 ||∇||=7.142848e-01 | Tr=0.5215]                             67%|██████▋   | 12/18 [01:01<00:29,  4.91s/it, CE=5.652560e-01 H=5.649963e-01 dV_dx=-3.399500e-06 dV_dθ=-2.563629e-04 ||∇||=7.142848e-01 | Tr=0.5215] 67%|██████▋   | 12/18 [01:05<00:29,  4.91s/it, CE=5.603277e-01 H=5.600214e-01 dV_dx=-3.442177e-05 dV_dθ=-2.718618e-04 ||∇||=7.183108e-01 | Tr=0.5259] 72%|███████▏  | 13/18 [01:05<00:23,  4.61s/it, CE=5.603277e-01 H=5.600214e-01 dV_dx=-3.442177e-05 dV_dθ=-2.718618e-04 ||∇||=7.183108e-01 | Tr=0.5259] 72%|███████▏  | 13/18 [01:09<00:23,  4.61s/it, CE=5.556471e-01 H=5.553761e-01 dV_dx=1.790454e-05 dV_dθ=-2.889062e-04 ||∇||=7.250543e-01 | Tr=0.5299]  78%|███████▊  | 14/18 [01:09<00:17,  4.46s/it, CE=5.556471e-01 H=5.553761e-01 dV_dx=1.790454e-05 dV_dθ=-2.889062e-04 ||∇||=7.250543e-01 | Tr=0.5299] 78%|███████▊  | 14/18 [01:14<00:17,  4.46s/it, CE=5.511682e-01 H=5.508661e-01 dV_dx=5.350852e-06 dV_dθ=-3.073650e-04 ||∇||=7.300191e-01 | Tr=0.5339] 83%|████████▎ | 15/18 [01:14<00:13,  4.54s/it, CE=5.511682e-01 H=5.508661e-01 dV_dx=5.350852e-06 dV_dθ=-3.073650e-04 ||∇||=7.300191e-01 | Tr=0.5339] 83%|████████▎ | 15/18 [01:20<00:13,  4.54s/it, CE=5.468392e-01 H=5.465167e-01 dV_dx=-7.719432e-06 dV_dθ=-3.148141e-04 ||∇||=7.335294e-01 | Tr=0.5367 Te/Cur=0.5357 Te/Exp=0.8195] 89%|████████▉ | 16/18 [01:20<00:10,  5.04s/it, CE=5.468392e-01 H=5.465167e-01 dV_dx=-7.719432e-06 dV_dθ=-3.148141e-04 ||∇||=7.335294e-01 | Tr=0.5367 Te/Cur=0.5357 Te/Exp=0.8195] 89%|████████▉ | 16/18 [01:24<00:10,  5.04s/it, CE=5.426889e-01 H=5.423605e-01 dV_dx=-5.899802e-06 dV_dθ=-3.224750e-04 ||∇||=7.373522e-01 | Tr=0.5392]                             94%|█████████▍| 17/18 [01:24<00:04,  4.75s/it, CE=5.426889e-01 H=5.423605e-01 dV_dx=-5.899802e-06 dV_dθ=-3.224750e-04 ||∇||=7.373522e-01 | Tr=0.5392] 94%|█████████▍| 17/18 [01:30<00:04,  4.75s/it, CE=5.386925e-01 H=5.383563e-01 dV_dx=-5.864983e-06 dV_dθ=-3.303601e-04 ||∇||=7.417330e-01 | Tr=0.5423 Te/Cur=0.5437 Te/Exp=0.8203]100%|██████████| 18/18 [01:30<00:00,  5.03s/it, CE=5.386925e-01 H=5.383563e-01 dV_dx=-5.864983e-06 dV_dθ=-3.303601e-04 ||∇||=7.417330e-01 | Tr=0.5423 Te/Cur=0.5437 Te/Exp=0.8203]100%|██████████| 18/18 [01:30<00:00,  5.03s/it, CE=5.386925e-01 H=5.383563e-01 dV_dx=-5.864983e-06 dV_dθ=-3.303601e-04 ||∇||=7.417330e-01 | Tr=0.5423 Te/Cur=0.5437 Te/Exp=0.8203]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.7271
    Task 1: 0.9292
    Task 2: 0.8050
    Task 3: 0.5413

============================================================
Task 4
============================================================
Initial loss on new task: 1.1887, previous: 0.5387, ratio: 2.21
Standard CL training (lr=0.000078, adaptive_lr_min=4.76e-05, loss_ratio=2.21)
  Warmup phase: 2 epochs at lr=7.84e-08
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.35s/it] 50%|█████     | 1/2 [00:14<00:08,  8.35s/it, CE=1.186437e+00 H=1.126174e+00 dV_dx=-2.935767e-06 dV_dθ=-6.025984e-02 ||∇||=5.840593e+00 | Tr=0.6724 Te/Cur=0.6755 Te/Exp=0.7516]100%|██████████| 2/2 [00:14<00:00,  7.16s/it, CE=1.186437e+00 H=1.126174e+00 dV_dx=-2.935767e-06 dV_dθ=-6.025984e-02 ||∇||=5.840593e+00 | Tr=0.6724 Te/Cur=0.6755 Te/Exp=0.7516]100%|██████████| 2/2 [00:14<00:00,  7.34s/it, CE=1.186437e+00 H=1.126174e+00 dV_dx=-2.935767e-06 dV_dθ=-6.025984e-02 ||∇||=5.840593e+00 | Tr=0.6724 Te/Cur=0.6755 Te/Exp=0.7516]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=7.84e-05
    Using experience replay
    Adaptive grad weights: [0.64, 0.26, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:16, 11.54s/it]  6%|▌         | 1/18 [00:16<03:16, 11.54s/it, CE=7.790896e-01 H=7.791619e-01 dV_dx=-1.505622e-05 dV_dθ=8.734433e-05 ||∇||=7.231610e-01 | Tr=0.8673] 11%|█         | 2/18 [00:16<01:59,  7.47s/it, CE=7.790896e-01 H=7.791619e-01 dV_dx=-1.505622e-05 dV_dθ=8.734433e-05 ||∇||=7.231610e-01 | Tr=0.8673] 11%|█         | 2/18 [00:20<01:59,  7.47s/it, CE=7.759304e-01 H=7.759559e-01 dV_dx=-1.971993e-05 dV_dθ=4.521414e-05 ||∇||=6.447037e-01 | Tr=0.8854] 17%|█▋        | 3/18 [00:20<01:30,  6.00s/it, CE=7.759304e-01 H=7.759559e-01 dV_dx=-1.971993e-05 dV_dθ=4.521414e-05 ||∇||=6.447037e-01 | Tr=0.8854] 17%|█▋        | 3/18 [00:23<01:30,  6.00s/it, CE=7.714798e-01 H=7.715156e-01 dV_dx=2.362364e-05 dV_dθ=1.219357e-05 ||∇||=6.140343e-01 | Tr=0.8963]  22%|██▏       | 4/18 [00:23<01:10,  5.01s/it, CE=7.714798e-01 H=7.715156e-01 dV_dx=2.362364e-05 dV_dθ=1.219357e-05 ||∇||=6.140343e-01 | Tr=0.8963] 22%|██▏       | 4/18 [00:27<01:10,  5.01s/it, CE=7.667451e-01 H=7.667543e-01 dV_dx=1.970699e-05 dV_dθ=-1.052010e-05 ||∇||=5.972681e-01 | Tr=0.9043] 28%|██▊       | 5/18 [00:27<01:00,  4.62s/it, CE=7.667451e-01 H=7.667543e-01 dV_dx=1.970699e-05 dV_dθ=-1.052010e-05 ||∇||=5.972681e-01 | Tr=0.9043] 28%|██▊       | 5/18 [00:33<01:00,  4.62s/it, CE=7.621511e-01 H=7.621387e-01 dV_dx=1.103757e-05 dV_dθ=-2.348082e-05 ||∇||=5.849278e-01 | Tr=0.9103 Te/Cur=0.9098 Te/Exp=0.7383] 33%|███▎      | 6/18 [00:33<00:59,  4.99s/it, CE=7.621511e-01 H=7.621387e-01 dV_dx=1.103757e-05 dV_dθ=-2.348082e-05 ||∇||=5.849278e-01 | Tr=0.9103 Te/Cur=0.9098 Te/Exp=0.7383] 33%|███▎      | 6/18 [00:37<00:59,  4.99s/it, CE=7.576945e-01 H=7.577232e-01 dV_dx=6.686819e-05 dV_dθ=-3.809642e-05 ||∇||=5.771433e-01 | Tr=0.9153]                             39%|███▉      | 7/18 [00:37<00:52,  4.76s/it, CE=7.576945e-01 H=7.577232e-01 dV_dx=6.686819e-05 dV_dθ=-3.809642e-05 ||∇||=5.771433e-01 | Tr=0.9153] 39%|███▉      | 7/18 [00:42<00:52,  4.76s/it, CE=7.533146e-01 H=7.532941e-01 dV_dx=2.702833e-05 dV_dθ=-4.752906e-05 ||∇||=5.702035e-01 | Tr=0.9197] 44%|████▍     | 8/18 [00:42<00:46,  4.65s/it, CE=7.533146e-01 H=7.532941e-01 dV_dx=2.702833e-05 dV_dθ=-4.752906e-05 ||∇||=5.702035e-01 | Tr=0.9197] 44%|████▍     | 8/18 [00:46<00:46,  4.65s/it, CE=7.490120e-01 H=7.490134e-01 dV_dx=5.760675e-05 dV_dθ=-5.619613e-05 ||∇||=5.660860e-01 | Tr=0.9230] 50%|█████     | 9/18 [00:46<00:41,  4.56s/it, CE=7.490120e-01 H=7.490134e-01 dV_dx=5.760675e-05 dV_dθ=-5.619613e-05 ||∇||=5.660860e-01 | Tr=0.9230] 50%|█████     | 9/18 [00:51<00:41,  4.56s/it, CE=7.448277e-01 H=7.447638e-01 dV_dx=-7.660971e-07 dV_dθ=-6.312587e-05 ||∇||=5.621844e-01 | Tr=0.9256] 56%|█████▌    | 10/18 [00:51<00:36,  4.54s/it, CE=7.448277e-01 H=7.447638e-01 dV_dx=-7.660971e-07 dV_dθ=-6.312587e-05 ||∇||=5.621844e-01 | Tr=0.9256] 56%|█████▌    | 10/18 [00:56<00:36,  4.54s/it, CE=7.407070e-01 H=7.405822e-01 dV_dx=-5.328082e-05 dV_dθ=-7.155383e-05 ||∇||=5.597278e-01 | Tr=0.9281 Te/Cur=0.9280 Te/Exp=0.7489] 61%|██████    | 11/18 [00:56<00:34,  4.86s/it, CE=7.407070e-01 H=7.405822e-01 dV_dx=-5.328082e-05 dV_dθ=-7.155383e-05 ||∇||=5.597278e-01 | Tr=0.9281 Te/Cur=0.9280 Te/Exp=0.7489] 61%|██████    | 11/18 [01:01<00:34,  4.86s/it, CE=7.366169e-01 H=7.364506e-01 dV_dx=-8.892051e-05 dV_dθ=-7.738133e-05 ||∇||=5.567140e-01 | Tr=0.9309]                             67%|██████▋   | 12/18 [01:01<00:29,  4.87s/it, CE=7.366169e-01 H=7.364506e-01 dV_dx=-8.892051e-05 dV_dθ=-7.738133e-05 ||∇||=5.567140e-01 | Tr=0.9309] 67%|██████▋   | 12/18 [01:06<00:29,  4.87s/it, CE=7.326259e-01 H=7.325247e-01 dV_dx=-1.885145e-05 dV_dθ=-8.228912e-05 ||∇||=5.538436e-01 | Tr=0.9332] 72%|███████▏  | 13/18 [01:06<00:23,  4.73s/it, CE=7.326259e-01 H=7.325247e-01 dV_dx=-1.885145e-05 dV_dθ=-8.228912e-05 ||∇||=5.538436e-01 | Tr=0.9332] 72%|███████▏  | 13/18 [01:10<00:23,  4.73s/it, CE=7.286924e-01 H=7.285989e-01 dV_dx=-8.714325e-06 dV_dθ=-8.484897e-05 ||∇||=5.504089e-01 | Tr=0.9353] 78%|███████▊  | 14/18 [01:10<00:18,  4.75s/it, CE=7.286924e-01 H=7.285989e-01 dV_dx=-8.714325e-06 dV_dθ=-8.484897e-05 ||∇||=5.504089e-01 | Tr=0.9353] 78%|███████▊  | 14/18 [01:14<00:18,  4.75s/it, CE=7.248376e-01 H=7.248320e-01 dV_dx=8.046039e-05 dV_dθ=-8.600985e-05 ||∇||=5.465019e-01 | Tr=0.9376]  83%|████████▎ | 15/18 [01:14<00:13,  4.45s/it, CE=7.248376e-01 H=7.248320e-01 dV_dx=8.046039e-05 dV_dθ=-8.600985e-05 ||∇||=5.465019e-01 | Tr=0.9376] 83%|████████▎ | 15/18 [01:20<00:13,  4.45s/it, CE=7.210806e-01 H=7.210073e-01 dV_dx=1.382503e-05 dV_dθ=-8.711860e-05 ||∇||=5.429743e-01 | Tr=0.9390 Te/Cur=0.9359 Te/Exp=0.7570] 89%|████████▉ | 16/18 [01:20<00:09,  4.98s/it, CE=7.210806e-01 H=7.210073e-01 dV_dx=1.382503e-05 dV_dθ=-8.711860e-05 ||∇||=5.429743e-01 | Tr=0.9390 Te/Cur=0.9359 Te/Exp=0.7570] 89%|████████▉ | 16/18 [01:24<00:09,  4.98s/it, CE=7.174193e-01 H=7.173742e-01 dV_dx=4.258291e-05 dV_dθ=-8.771543e-05 ||∇||=5.397854e-01 | Tr=0.9406]                             94%|█████████▍| 17/18 [01:24<00:04,  4.67s/it, CE=7.174193e-01 H=7.173742e-01 dV_dx=4.258291e-05 dV_dθ=-8.771543e-05 ||∇||=5.397854e-01 | Tr=0.9406] 94%|█████████▍| 17/18 [01:31<00:04,  4.67s/it, CE=7.138818e-01 H=7.137292e-01 dV_dx=-6.131615e-05 dV_dθ=-9.127748e-05 ||∇||=5.382396e-01 | Tr=0.9420 Te/Cur=0.9393 Te/Exp=0.7547]100%|██████████| 18/18 [01:31<00:00,  5.30s/it, CE=7.138818e-01 H=7.137292e-01 dV_dx=-6.131615e-05 dV_dθ=-9.127748e-05 ||∇||=5.382396e-01 | Tr=0.9420 Te/Cur=0.9393 Te/Exp=0.7547]100%|██████████| 18/18 [01:31<00:00,  5.08s/it, CE=7.138818e-01 H=7.137292e-01 dV_dx=-6.131615e-05 dV_dθ=-9.127748e-05 ||∇||=5.382396e-01 | Tr=0.9420 Te/Cur=0.9393 Te/Exp=0.7547]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7453
    Task 1: 0.9141
    Task 2: 0.8178
    Task 3: 0.5439
    Task 4: 0.9404

============================================================
Task 5
============================================================
Initial loss on new task: 6.6483, previous: 0.7139, ratio: 9.31
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=9.31)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.06s/it] 50%|█████     | 1/2 [00:13<00:08,  8.06s/it, CE=6.701692e+00 H=5.037199e+00 dV_dx=-9.174015e-07 dV_dθ=-1.664492e+00 ||∇||=3.009556e+01 | Tr=0.1288 Te/Cur=0.1238 Te/Exp=0.7822]100%|██████████| 2/2 [00:13<00:00,  6.79s/it, CE=6.701692e+00 H=5.037199e+00 dV_dx=-9.174015e-07 dV_dθ=-1.664492e+00 ||∇||=3.009556e+01 | Tr=0.1288 Te/Cur=0.1238 Te/Exp=0.7822]100%|██████████| 2/2 [00:13<00:00,  6.98s/it, CE=6.701692e+00 H=5.037199e+00 dV_dx=-9.174015e-07 dV_dθ=-1.664492e+00 ||∇||=3.009556e+01 | Tr=0.1288 Te/Cur=0.1238 Te/Exp=0.7822]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:12, 11.35s/it]  6%|▌         | 1/18 [00:15<03:12, 11.35s/it, CE=7.289080e-01 H=7.296935e-01 dV_dx=-8.572436e-05 dV_dθ=8.712191e-04 ||∇||=1.422543e+00 | Tr=0.6138] 11%|█         | 2/18 [00:15<01:52,  7.01s/it, CE=7.289080e-01 H=7.296935e-01 dV_dx=-8.572436e-05 dV_dθ=8.712191e-04 ||∇||=1.422543e+00 | Tr=0.6138] 11%|█         | 2/18 [00:19<01:52,  7.01s/it, CE=7.020170e-01 H=7.020594e-01 dV_dx=1.581947e-06 dV_dθ=4.080179e-05 ||∇||=9.930950e-01 | Tr=0.7397]  17%|█▋        | 3/18 [00:19<01:27,  5.82s/it, CE=7.020170e-01 H=7.020594e-01 dV_dx=1.581947e-06 dV_dθ=4.080179e-05 ||∇||=9.930950e-01 | Tr=0.7397] 17%|█▋        | 3/18 [00:23<01:27,  5.82s/it, CE=6.875686e-01 H=6.874581e-01 dV_dx=-1.273841e-05 dV_dθ=-9.778645e-05 ||∇||=8.445552e-01 | Tr=0.8052] 22%|██▏       | 4/18 [00:23<01:12,  5.17s/it, CE=6.875686e-01 H=6.874581e-01 dV_dx=-1.273841e-05 dV_dθ=-9.778645e-05 ||∇||=8.445552e-01 | Tr=0.8052] 22%|██▏       | 4/18 [00:28<01:12,  5.17s/it, CE=6.766581e-01 H=6.764752e-01 dV_dx=-2.315658e-05 dV_dθ=-1.596524e-04 ||∇||=7.705135e-01 | Tr=0.8417] 28%|██▊       | 5/18 [00:28<01:04,  4.95s/it, CE=6.766581e-01 H=6.764752e-01 dV_dx=-2.315658e-05 dV_dθ=-1.596524e-04 ||∇||=7.705135e-01 | Tr=0.8417] 28%|██▊       | 5/18 [00:33<01:04,  4.95s/it, CE=6.681498e-01 H=6.679924e-01 dV_dx=4.028189e-05 dV_dθ=-1.976094e-04 ||∇||=7.298266e-01 | Tr=0.8646 Te/Cur=0.8662 Te/Exp=0.7802] 33%|███▎      | 6/18 [00:33<01:01,  5.14s/it, CE=6.681498e-01 H=6.679924e-01 dV_dx=4.028189e-05 dV_dθ=-1.976094e-04 ||∇||=7.298266e-01 | Tr=0.8646 Te/Cur=0.8662 Te/Exp=0.7802] 33%|███▎      | 6/18 [00:38<01:01,  5.14s/it, CE=6.609778e-01 H=6.607882e-01 dV_dx=3.185179e-05 dV_dθ=-2.214623e-04 ||∇||=7.059924e-01 | Tr=0.8793]                             39%|███▉      | 7/18 [00:38<00:54,  4.92s/it, CE=6.609778e-01 H=6.607882e-01 dV_dx=3.185179e-05 dV_dθ=-2.214623e-04 ||∇||=7.059924e-01 | Tr=0.8793] 39%|███▉      | 7/18 [00:42<00:54,  4.92s/it, CE=6.546687e-01 H=6.544566e-01 dV_dx=2.134638e-05 dV_dθ=-2.334310e-04 ||∇||=6.879472e-01 | Tr=0.8898] 44%|████▍     | 8/18 [00:42<00:47,  4.80s/it, CE=6.546687e-01 H=6.544566e-01 dV_dx=2.134638e-05 dV_dθ=-2.334310e-04 ||∇||=6.879472e-01 | Tr=0.8898] 44%|████▍     | 8/18 [00:47<00:47,  4.80s/it, CE=6.492127e-01 H=6.489716e-01 dV_dx=2.967407e-06 dV_dθ=-2.440241e-04 ||∇||=6.745845e-01 | Tr=0.8980] 50%|█████     | 9/18 [00:47<00:43,  4.80s/it, CE=6.492127e-01 H=6.489716e-01 dV_dx=2.967407e-06 dV_dθ=-2.440241e-04 ||∇||=6.745845e-01 | Tr=0.8980] 50%|█████     | 9/18 [00:52<00:43,  4.80s/it, CE=6.444134e-01 H=6.441572e-01 dV_dx=-9.217740e-06 dV_dθ=-2.469914e-04 ||∇||=6.635975e-01 | Tr=0.9045] 56%|█████▌    | 10/18 [00:52<00:38,  4.79s/it, CE=6.444134e-01 H=6.441572e-01 dV_dx=-9.217740e-06 dV_dθ=-2.469914e-04 ||∇||=6.635975e-01 | Tr=0.9045] 56%|█████▌    | 10/18 [00:58<00:38,  4.79s/it, CE=6.401164e-01 H=6.397767e-01 dV_dx=-8.817796e-05 dV_dθ=-2.515793e-04 ||∇||=6.557706e-01 | Tr=0.9101 Te/Cur=0.9054 Te/Exp=0.7857] 61%|██████    | 11/18 [00:58<00:36,  5.23s/it, CE=6.401164e-01 H=6.397767e-01 dV_dx=-8.817796e-05 dV_dθ=-2.515793e-04 ||∇||=6.557706e-01 | Tr=0.9101 Te/Cur=0.9054 Te/Exp=0.7857] 61%|██████    | 11/18 [01:02<00:36,  5.23s/it, CE=6.361470e-01 H=6.358447e-01 dV_dx=-5.038365e-05 dV_dθ=-2.519765e-04 ||∇||=6.480987e-01 | Tr=0.9153]                             67%|██████▋   | 12/18 [01:02<00:28,  4.80s/it, CE=6.361470e-01 H=6.358447e-01 dV_dx=-5.038365e-05 dV_dθ=-2.519765e-04 ||∇||=6.480987e-01 | Tr=0.9153] 67%|██████▋   | 12/18 [01:06<00:28,  4.80s/it, CE=6.325134e-01 H=6.322432e-01 dV_dx=-1.781555e-05 dV_dθ=-2.523791e-04 ||∇||=6.403054e-01 | Tr=0.9192] 72%|███████▏  | 13/18 [01:06<00:22,  4.50s/it, CE=6.325134e-01 H=6.322432e-01 dV_dx=-1.781555e-05 dV_dθ=-2.523791e-04 ||∇||=6.403054e-01 | Tr=0.9192] 72%|███████▏  | 13/18 [01:09<00:22,  4.50s/it, CE=6.291718e-01 H=6.289635e-01 dV_dx=4.781725e-05 dV_dθ=-2.561095e-04 ||∇||=6.351025e-01 | Tr=0.9225]  78%|███████▊  | 14/18 [01:09<00:16,  4.05s/it, CE=6.291718e-01 H=6.289635e-01 dV_dx=4.781725e-05 dV_dθ=-2.561095e-04 ||∇||=6.351025e-01 | Tr=0.9225] 78%|███████▊  | 14/18 [01:13<00:16,  4.05s/it, CE=6.260274e-01 H=6.258223e-01 dV_dx=5.326878e-05 dV_dθ=-2.583946e-04 ||∇||=6.298655e-01 | Tr=0.9264] 83%|████████▎ | 15/18 [01:13<00:12,  4.06s/it, CE=6.260274e-01 H=6.258223e-01 dV_dx=5.326878e-05 dV_dθ=-2.583946e-04 ||∇||=6.298655e-01 | Tr=0.9264] 83%|████████▎ | 15/18 [01:19<00:12,  4.06s/it, CE=6.230458e-01 H=6.228029e-01 dV_dx=1.724853e-05 dV_dθ=-2.601699e-04 ||∇||=6.249936e-01 | Tr=0.9293 Te/Cur=0.9233 Te/Exp=0.7895] 89%|████████▉ | 16/18 [01:19<00:09,  4.52s/it, CE=6.230458e-01 H=6.228029e-01 dV_dx=1.724853e-05 dV_dθ=-2.601699e-04 ||∇||=6.249936e-01 | Tr=0.9293 Te/Cur=0.9233 Te/Exp=0.7895] 89%|████████▉ | 16/18 [01:23<00:09,  4.52s/it, CE=6.201535e-01 H=6.199053e-01 dV_dx=1.068194e-05 dV_dθ=-2.588602e-04 ||∇||=6.189726e-01 | Tr=0.9316]                             94%|█████████▍| 17/18 [01:23<00:04,  4.64s/it, CE=6.201535e-01 H=6.199053e-01 dV_dx=1.068194e-05 dV_dθ=-2.588602e-04 ||∇||=6.189726e-01 | Tr=0.9316] 94%|█████████▍| 17/18 [01:30<00:04,  4.64s/it, CE=6.173479e-01 H=6.170061e-01 dV_dx=-8.581770e-05 dV_dθ=-2.560248e-04 ||∇||=6.128356e-01 | Tr=0.9343 Te/Cur=0.9292 Te/Exp=0.7912]100%|██████████| 18/18 [01:30<00:00,  5.20s/it, CE=6.173479e-01 H=6.170061e-01 dV_dx=-8.581770e-05 dV_dθ=-2.560248e-04 ||∇||=6.128356e-01 | Tr=0.9343 Te/Cur=0.9292 Te/Exp=0.7912]100%|██████████| 18/18 [01:30<00:00,  5.03s/it, CE=6.173479e-01 H=6.170061e-01 dV_dx=-8.581770e-05 dV_dθ=-2.560248e-04 ||∇||=6.128356e-01 | Tr=0.9343 Te/Cur=0.9292 Te/Exp=0.7912]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7489
    Task 1: 0.9296
    Task 2: 0.8193
    Task 3: 0.5425
    Task 4: 0.9201
    Task 5: 0.9284

============================================================
Task 6
============================================================
Initial loss on new task: 5.1729, previous: 0.6173, ratio: 8.38
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=8.38)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.25s/it] 50%|█████     | 1/2 [00:15<00:09,  9.25s/it, CE=5.179441e+00 H=3.959983e+00 dV_dx=4.382191e-06 dV_dθ=-1.219463e+00 ||∇||=2.576694e+01 | Tr=0.2012 Te/Cur=0.2031 Te/Exp=0.8114]100%|██████████| 2/2 [00:15<00:00,  7.37s/it, CE=5.179441e+00 H=3.959983e+00 dV_dx=4.382191e-06 dV_dθ=-1.219463e+00 ||∇||=2.576694e+01 | Tr=0.2012 Te/Cur=0.2031 Te/Exp=0.8114]100%|██████████| 2/2 [00:15<00:00,  7.66s/it, CE=5.179441e+00 H=3.959983e+00 dV_dx=4.382191e-06 dV_dθ=-1.219463e+00 ||∇||=2.576694e+01 | Tr=0.2012 Te/Cur=0.2031 Te/Exp=0.8114]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:22, 11.90s/it]  6%|▌         | 1/18 [00:16<03:22, 11.90s/it, CE=6.144045e-01 H=6.143275e-01 dV_dx=-4.456021e-05 dV_dθ=-3.246342e-05 ||∇||=1.332948e+00 | Tr=0.6848] 11%|█         | 2/18 [00:16<01:59,  7.47s/it, CE=6.144045e-01 H=6.143275e-01 dV_dx=-4.456021e-05 dV_dθ=-3.246342e-05 ||∇||=1.332948e+00 | Tr=0.6848] 11%|█         | 2/18 [00:20<01:59,  7.47s/it, CE=5.950488e-01 H=5.950115e-01 dV_dx=3.675029e-05 dV_dθ=-7.413133e-05 ||∇||=1.002937e+00 | Tr=0.7815]  17%|█▋        | 3/18 [00:20<01:30,  6.00s/it, CE=5.950488e-01 H=5.950115e-01 dV_dx=3.675029e-05 dV_dθ=-7.413133e-05 ||∇||=1.002937e+00 | Tr=0.7815] 17%|█▋        | 3/18 [00:24<01:30,  6.00s/it, CE=5.862036e-01 H=5.860374e-01 dV_dx=-3.225257e-05 dV_dθ=-1.339912e-04 ||∇||=8.752637e-01 | Tr=0.8296] 22%|██▏       | 4/18 [00:24<01:13,  5.27s/it, CE=5.862036e-01 H=5.860374e-01 dV_dx=-3.225257e-05 dV_dθ=-1.339912e-04 ||∇||=8.752637e-01 | Tr=0.8296] 22%|██▏       | 4/18 [00:29<01:13,  5.27s/it, CE=5.802340e-01 H=5.800904e-01 dV_dx=-5.097696e-07 dV_dθ=-1.431234e-04 ||∇||=7.952263e-01 | Tr=0.8567] 28%|██▊       | 5/18 [00:29<01:04,  5.00s/it, CE=5.802340e-01 H=5.800904e-01 dV_dx=-5.097696e-07 dV_dθ=-1.431234e-04 ||∇||=7.952263e-01 | Tr=0.8567] 28%|██▊       | 5/18 [00:35<01:04,  5.00s/it, CE=5.745541e-01 H=5.743866e-01 dV_dx=-2.849303e-05 dV_dθ=-1.390210e-04 ||∇||=7.413933e-01 | Tr=0.8732 Te/Cur=0.8784 Te/Exp=0.8096] 33%|███▎      | 6/18 [00:35<01:03,  5.30s/it, CE=5.745541e-01 H=5.743866e-01 dV_dx=-2.849303e-05 dV_dθ=-1.390210e-04 ||∇||=7.413933e-01 | Tr=0.8732 Te/Cur=0.8784 Te/Exp=0.8096] 33%|███▎      | 6/18 [00:39<01:03,  5.30s/it, CE=5.694581e-01 H=5.692396e-01 dV_dx=-7.693357e-05 dV_dθ=-1.415674e-04 ||∇||=7.077578e-01 | Tr=0.8852]                             39%|███▉      | 7/18 [00:39<00:56,  5.16s/it, CE=5.694581e-01 H=5.692396e-01 dV_dx=-7.693357e-05 dV_dθ=-1.415674e-04 ||∇||=7.077578e-01 | Tr=0.8852] 39%|███▉      | 7/18 [00:44<00:56,  5.16s/it, CE=5.649246e-01 H=5.648056e-01 dV_dx=2.579101e-05 dV_dθ=-1.448233e-04 ||∇||=6.856837e-01 | Tr=0.8942]  44%|████▍     | 8/18 [00:44<00:48,  4.81s/it, CE=5.649246e-01 H=5.648056e-01 dV_dx=2.579101e-05 dV_dθ=-1.448233e-04 ||∇||=6.856837e-01 | Tr=0.8942] 44%|████▍     | 8/18 [00:48<00:48,  4.81s/it, CE=5.606822e-01 H=5.604951e-01 dV_dx=-3.733702e-05 dV_dθ=-1.497419e-04 ||∇||=6.697845e-01 | Tr=0.9008] 50%|█████     | 9/18 [00:48<00:41,  4.64s/it, CE=5.606822e-01 H=5.604951e-01 dV_dx=-3.733702e-05 dV_dθ=-1.497419e-04 ||∇||=6.697845e-01 | Tr=0.9008] 50%|█████     | 9/18 [00:52<00:41,  4.64s/it, CE=5.567862e-01 H=5.565865e-01 dV_dx=-4.028119e-05 dV_dθ=-1.593766e-04 ||∇||=6.595859e-01 | Tr=0.9069] 56%|█████▌    | 10/18 [00:52<00:35,  4.46s/it, CE=5.567862e-01 H=5.565865e-01 dV_dx=-4.028119e-05 dV_dθ=-1.593766e-04 ||∇||=6.595859e-01 | Tr=0.9069] 56%|█████▌    | 10/18 [00:57<00:35,  4.46s/it, CE=5.531185e-01 H=5.528843e-01 dV_dx=-6.660840e-05 dV_dθ=-1.675049e-04 ||∇||=6.511542e-01 | Tr=0.9112 Te/Cur=0.9144 Te/Exp=0.8145] 61%|██████    | 11/18 [00:57<00:33,  4.74s/it, CE=5.531185e-01 H=5.528843e-01 dV_dx=-6.660840e-05 dV_dθ=-1.675049e-04 ||∇||=6.511542e-01 | Tr=0.9112 Te/Cur=0.9144 Te/Exp=0.8145] 61%|██████    | 11/18 [01:02<00:33,  4.74s/it, CE=5.496405e-01 H=5.494169e-01 dV_dx=-4.855297e-05 dV_dθ=-1.749788e-04 ||∇||=6.448280e-01 | Tr=0.9161]                             67%|██████▋   | 12/18 [01:02<00:28,  4.74s/it, CE=5.496405e-01 H=5.494169e-01 dV_dx=-4.855297e-05 dV_dθ=-1.749788e-04 ||∇||=6.448280e-01 | Tr=0.9161] 67%|██████▋   | 12/18 [01:05<00:28,  4.74s/it, CE=5.463150e-01 H=5.461013e-01 dV_dx=-3.331656e-05 dV_dθ=-1.804202e-04 ||∇||=6.395775e-01 | Tr=0.9200] 72%|███████▏  | 13/18 [01:05<00:21,  4.34s/it, CE=5.463150e-01 H=5.461013e-01 dV_dx=-3.331656e-05 dV_dθ=-1.804202e-04 ||∇||=6.395775e-01 | Tr=0.9200] 72%|███████▏  | 13/18 [01:09<00:21,  4.34s/it, CE=5.431931e-01 H=5.430351e-01 dV_dx=2.665446e-05 dV_dθ=-1.846954e-04 ||∇||=6.354590e-01 | Tr=0.9230]  78%|███████▊  | 14/18 [01:09<00:16,  4.10s/it, CE=5.431931e-01 H=5.430351e-01 dV_dx=2.665446e-05 dV_dθ=-1.846954e-04 ||∇||=6.354590e-01 | Tr=0.9230] 78%|███████▊  | 14/18 [01:13<00:16,  4.10s/it, CE=5.401886e-01 H=5.399288e-01 dV_dx=-7.414638e-05 dV_dθ=-1.857107e-04 ||∇||=6.291994e-01 | Tr=0.9264] 83%|████████▎ | 15/18 [01:13<00:12,  4.00s/it, CE=5.401886e-01 H=5.399288e-01 dV_dx=-7.414638e-05 dV_dθ=-1.857107e-04 ||∇||=6.291994e-01 | Tr=0.9264] 83%|████████▎ | 15/18 [01:18<00:12,  4.00s/it, CE=5.372730e-01 H=5.371232e-01 dV_dx=3.413980e-05 dV_dθ=-1.839855e-04 ||∇||=6.228073e-01 | Tr=0.9287 Te/Cur=0.9274 Te/Exp=0.8118] 89%|████████▉ | 16/18 [01:18<00:08,  4.48s/it, CE=5.372730e-01 H=5.371232e-01 dV_dx=3.413980e-05 dV_dθ=-1.839855e-04 ||∇||=6.228073e-01 | Tr=0.9287 Te/Cur=0.9274 Te/Exp=0.8118] 89%|████████▉ | 16/18 [01:22<00:08,  4.48s/it, CE=5.345146e-01 H=5.343598e-01 dV_dx=3.422220e-05 dV_dθ=-1.890171e-04 ||∇||=6.200422e-01 | Tr=0.9310]                             94%|█████████▍| 17/18 [01:22<00:04,  4.30s/it, CE=5.345146e-01 H=5.343598e-01 dV_dx=3.422220e-05 dV_dθ=-1.890171e-04 ||∇||=6.200422e-01 | Tr=0.9310] 94%|█████████▍| 17/18 [01:29<00:04,  4.30s/it, CE=5.317852e-01 H=5.316085e-01 dV_dx=1.470084e-05 dV_dθ=-1.914574e-04 ||∇||=6.163353e-01 | Tr=0.9331 Te/Cur=0.9318 Te/Exp=0.8144]100%|██████████| 18/18 [01:29<00:00,  4.94s/it, CE=5.317852e-01 H=5.316085e-01 dV_dx=1.470084e-05 dV_dθ=-1.914574e-04 ||∇||=6.163353e-01 | Tr=0.9331 Te/Cur=0.9318 Te/Exp=0.8144]100%|██████████| 18/18 [01:29<00:00,  4.95s/it, CE=5.317852e-01 H=5.316085e-01 dV_dx=1.470084e-05 dV_dθ=-1.914574e-04 ||∇||=6.163353e-01 | Tr=0.9331 Te/Cur=0.9318 Te/Exp=0.8144]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7560
    Task 1: 0.9406
    Task 2: 0.8243
    Task 3: 0.5415
    Task 4: 0.9334
    Task 5: 0.9087
    Task 6: 0.9308

============================================================
Task 7
============================================================
Initial loss on new task: 6.0777, previous: 0.5318, ratio: 11.43
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=11.43)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.64s/it] 50%|█████     | 1/2 [00:14<00:08,  8.64s/it, CE=5.989092e+00 H=5.093171e+00 dV_dx=-1.775123e-06 dV_dθ=-8.959189e-01 ||∇||=2.215760e+01 | Tr=0.1614 Te/Cur=0.1624 Te/Exp=0.8371]100%|██████████| 2/2 [00:14<00:00,  7.01s/it, CE=5.989092e+00 H=5.093171e+00 dV_dx=-1.775123e-06 dV_dθ=-8.959189e-01 ||∇||=2.215760e+01 | Tr=0.1614 Te/Cur=0.1624 Te/Exp=0.8371]100%|██████████| 2/2 [00:14<00:00,  7.26s/it, CE=5.989092e+00 H=5.093171e+00 dV_dx=-1.775123e-06 dV_dθ=-8.959189e-01 ||∇||=2.215760e+01 | Tr=0.1614 Te/Cur=0.1624 Te/Exp=0.8371]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:12<03:29, 12.32s/it]  6%|▌         | 1/18 [00:16<03:29, 12.32s/it, CE=6.433214e-01 H=6.447547e-01 dV_dx=2.468873e-05 dV_dθ=1.408587e-03 ||∇||=1.463141e+00 | Tr=0.7117] 11%|█         | 2/18 [00:16<01:59,  7.44s/it, CE=6.433214e-01 H=6.447547e-01 dV_dx=2.468873e-05 dV_dθ=1.408587e-03 ||∇||=1.463141e+00 | Tr=0.7117] 11%|█         | 2/18 [00:20<01:59,  7.44s/it, CE=6.339420e-01 H=6.342492e-01 dV_dx=-1.984284e-05 dV_dθ=3.270654e-04 ||∇||=1.013504e+00 | Tr=0.8192] 17%|█▋        | 3/18 [00:20<01:31,  6.12s/it, CE=6.339420e-01 H=6.342492e-01 dV_dx=-1.984284e-05 dV_dθ=3.270654e-04 ||∇||=1.013504e+00 | Tr=0.8192] 17%|█▋        | 3/18 [00:25<01:31,  6.12s/it, CE=6.222965e-01 H=6.224920e-01 dV_dx=5.817901e-05 dV_dθ=1.373142e-04 ||∇||=8.692883e-01 | Tr=0.8608]  22%|██▏       | 4/18 [00:25<01:16,  5.43s/it, CE=6.222965e-01 H=6.224920e-01 dV_dx=5.817901e-05 dV_dθ=1.373142e-04 ||∇||=8.692883e-01 | Tr=0.8608] 22%|██▏       | 4/18 [00:29<01:16,  5.43s/it, CE=6.092349e-01 H=6.093479e-01 dV_dx=4.835792e-05 dV_dθ=6.461970e-05 ||∇||=7.946959e-01 | Tr=0.8820] 28%|██▊       | 5/18 [00:29<01:04,  4.99s/it, CE=6.092349e-01 H=6.093479e-01 dV_dx=4.835792e-05 dV_dθ=6.461970e-05 ||∇||=7.946959e-01 | Tr=0.8820] 28%|██▊       | 5/18 [00:34<01:04,  4.99s/it, CE=5.964942e-01 H=5.965311e-01 dV_dx=1.362512e-05 dV_dθ=2.324745e-05 ||∇||=7.481008e-01 | Tr=0.8956 Te/Cur=0.8948 Te/Exp=0.8003] 33%|███▎      | 6/18 [00:34<01:01,  5.14s/it, CE=5.964942e-01 H=5.965311e-01 dV_dx=1.362512e-05 dV_dθ=2.324745e-05 ||∇||=7.481008e-01 | Tr=0.8956 Te/Cur=0.8948 Te/Exp=0.8003] 33%|███▎      | 6/18 [00:37<01:01,  5.14s/it, CE=5.850046e-01 H=5.849828e-01 dV_dx=-9.988883e-06 dV_dθ=-1.190143e-05 ||∇||=7.176475e-01 | Tr=0.9054]                           39%|███▉      | 7/18 [00:37<00:49,  4.46s/it, CE=5.850046e-01 H=5.849828e-01 dV_dx=-9.988883e-06 dV_dθ=-1.190143e-05 ||∇||=7.176475e-01 | Tr=0.9054] 39%|███▉      | 7/18 [00:42<00:49,  4.46s/it, CE=5.751712e-01 H=5.751638e-01 dV_dx=2.803876e-05 dV_dθ=-3.549279e-05 ||∇||=6.923508e-01 | Tr=0.9136]  44%|████▍     | 8/18 [00:42<00:44,  4.41s/it, CE=5.751712e-01 H=5.751638e-01 dV_dx=2.803876e-05 dV_dθ=-3.549279e-05 ||∇||=6.923508e-01 | Tr=0.9136] 44%|████▍     | 8/18 [00:46<00:44,  4.41s/it, CE=5.667601e-01 H=5.667719e-01 dV_dx=6.811414e-05 dV_dθ=-5.630012e-05 ||∇||=6.745171e-01 | Tr=0.9193] 50%|█████     | 9/18 [00:46<00:38,  4.26s/it, CE=5.667601e-01 H=5.667719e-01 dV_dx=6.811414e-05 dV_dθ=-5.630012e-05 ||∇||=6.745171e-01 | Tr=0.9193] 50%|█████     | 9/18 [00:50<00:38,  4.26s/it, CE=5.590873e-01 H=5.589547e-01 dV_dx=-5.860371e-05 dV_dθ=-7.404206e-05 ||∇||=6.599249e-01 | Tr=0.9244] 56%|█████▌    | 10/18 [00:50<00:34,  4.26s/it, CE=5.590873e-01 H=5.589547e-01 dV_dx=-5.860371e-05 dV_dθ=-7.404206e-05 ||∇||=6.599249e-01 | Tr=0.9244] 56%|█████▌    | 10/18 [00:56<00:34,  4.26s/it, CE=5.522069e-01 H=5.521449e-01 dV_dx=1.914780e-05 dV_dθ=-8.111002e-05 ||∇||=6.460319e-01 | Tr=0.9297 Te/Cur=0.9264 Te/Exp=0.8157] 61%|██████    | 11/18 [00:56<00:34,  4.93s/it, CE=5.522069e-01 H=5.521449e-01 dV_dx=1.914780e-05 dV_dθ=-8.111002e-05 ||∇||=6.460319e-01 | Tr=0.9297 Te/Cur=0.9264 Te/Exp=0.8157] 61%|██████    | 11/18 [01:01<00:34,  4.93s/it, CE=5.459362e-01 H=5.459260e-01 dV_dx=7.500942e-05 dV_dθ=-8.521853e-05 ||∇||=6.339836e-01 | Tr=0.9339]                             67%|██████▋   | 12/18 [01:01<00:28,  4.83s/it, CE=5.459362e-01 H=5.459260e-01 dV_dx=7.500942e-05 dV_dθ=-8.521853e-05 ||∇||=6.339836e-01 | Tr=0.9339] 67%|██████▋   | 12/18 [01:06<00:28,  4.83s/it, CE=5.402068e-01 H=5.401680e-01 dV_dx=5.565190e-05 dV_dθ=-9.444075e-05 ||∇||=6.262691e-01 | Tr=0.9371] 72%|███████▏  | 13/18 [01:06<00:23,  4.74s/it, CE=5.402068e-01 H=5.401680e-01 dV_dx=5.565190e-05 dV_dθ=-9.444075e-05 ||∇||=6.262691e-01 | Tr=0.9371] 72%|███████▏  | 13/18 [01:10<00:23,  4.74s/it, CE=5.349886e-01 H=5.348776e-01 dV_dx=-9.506213e-06 dV_dθ=-1.014364e-04 ||∇||=6.189171e-01 | Tr=0.9402] 78%|███████▊  | 14/18 [01:10<00:18,  4.70s/it, CE=5.349886e-01 H=5.348776e-01 dV_dx=-9.506213e-06 dV_dθ=-1.014364e-04 ||∇||=6.189171e-01 | Tr=0.9402] 78%|███████▊  | 14/18 [01:15<00:18,  4.70s/it, CE=5.301369e-01 H=5.300175e-01 dV_dx=-1.544830e-05 dV_dθ=-1.039488e-04 ||∇||=6.113887e-01 | Tr=0.9432] 83%|████████▎ | 15/18 [01:15<00:14,  4.70s/it, CE=5.301369e-01 H=5.300175e-01 dV_dx=-1.544830e-05 dV_dθ=-1.039488e-04 ||∇||=6.113887e-01 | Tr=0.9432] 83%|████████▎ | 15/18 [01:21<00:14,  4.70s/it, CE=5.256088e-01 H=5.255475e-01 dV_dx=4.464616e-05 dV_dθ=-1.059084e-04 ||∇||=6.041542e-01 | Tr=0.9458 Te/Cur=0.9412 Te/Exp=0.8197] 89%|████████▉ | 16/18 [01:21<00:10,  5.18s/it, CE=5.256088e-01 H=5.255475e-01 dV_dx=4.464616e-05 dV_dθ=-1.059084e-04 ||∇||=6.041542e-01 | Tr=0.9458 Te/Cur=0.9412 Te/Exp=0.8197] 89%|████████▉ | 16/18 [01:25<00:10,  5.18s/it, CE=5.213595e-01 H=5.212507e-01 dV_dx=-6.295683e-07 dV_dθ=-1.081018e-04 ||∇||=5.974886e-01 | Tr=0.9480]                            94%|█████████▍| 17/18 [01:25<00:04,  4.68s/it, CE=5.213595e-01 H=5.212507e-01 dV_dx=-6.295683e-07 dV_dθ=-1.081018e-04 ||∇||=5.974886e-01 | Tr=0.9480] 94%|█████████▍| 17/18 [01:31<00:04,  4.68s/it, CE=5.173422e-01 H=5.172358e-01 dV_dx=2.195904e-06 dV_dθ=-1.085926e-04 ||∇||=5.917881e-01 | Tr=0.9507 Te/Cur=0.9462 Te/Exp=0.8304]100%|██████████| 18/18 [01:31<00:00,  5.18s/it, CE=5.173422e-01 H=5.172358e-01 dV_dx=2.195904e-06 dV_dθ=-1.085926e-04 ||∇||=5.917881e-01 | Tr=0.9507 Te/Cur=0.9462 Te/Exp=0.8304]100%|██████████| 18/18 [01:31<00:00,  5.08s/it, CE=5.173422e-01 H=5.172358e-01 dV_dx=2.195904e-06 dV_dθ=-1.085926e-04 ||∇||=5.917881e-01 | Tr=0.9507 Te/Cur=0.9462 Te/Exp=0.8304]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7526
    Task 1: 0.9207
    Task 2: 0.8145
    Task 3: 0.5494
    Task 4: 0.9103
    Task 5: 0.8964
    Task 6: 0.9219
    Task 7: 0.9454

============================================================
Task 8
============================================================
Initial loss on new task: 4.9516, previous: 0.5173, ratio: 9.57
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=9.57)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.99s/it] 50%|█████     | 1/2 [00:13<00:08,  8.99s/it, CE=4.923781e+00 H=4.148539e+00 dV_dx=-8.557578e-07 dV_dθ=-7.752415e-01 ||∇||=2.062611e+01 | Tr=0.1733 Te/Cur=0.1720 Te/Exp=0.8389]100%|██████████| 2/2 [00:13<00:00,  6.56s/it, CE=4.923781e+00 H=4.148539e+00 dV_dx=-8.557578e-07 dV_dθ=-7.752415e-01 ||∇||=2.062611e+01 | Tr=0.1733 Te/Cur=0.1720 Te/Exp=0.8389]100%|██████████| 2/2 [00:13<00:00,  6.93s/it, CE=4.923781e+00 H=4.148539e+00 dV_dx=-8.557578e-07 dV_dθ=-7.752415e-01 ||∇||=2.062611e+01 | Tr=0.1733 Te/Cur=0.1720 Te/Exp=0.8389]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:12, 11.34s/it]  6%|▌         | 1/18 [00:15<03:12, 11.34s/it, CE=6.212014e-01 H=6.222238e-01 dV_dx=2.420506e-05 dV_dθ=9.981841e-04 ||∇||=1.163329e+00 | Tr=0.7875] 11%|█         | 2/18 [00:15<01:56,  7.29s/it, CE=6.212014e-01 H=6.222238e-01 dV_dx=2.420506e-05 dV_dθ=9.981841e-04 ||∇||=1.163329e+00 | Tr=0.7875] 11%|█         | 2/18 [00:20<01:56,  7.29s/it, CE=6.148841e-01 H=6.152361e-01 dV_dx=6.053838e-05 dV_dθ=2.914471e-04 ||∇||=9.276754e-01 | Tr=0.8549] 17%|█▋        | 3/18 [00:20<01:29,  5.97s/it, CE=6.148841e-01 H=6.152361e-01 dV_dx=6.053838e-05 dV_dθ=2.914471e-04 ||∇||=9.276754e-01 | Tr=0.8549] 17%|█▋        | 3/18 [00:24<01:29,  5.97s/it, CE=6.028514e-01 H=6.029008e-01 dV_dx=1.510196e-05 dV_dθ=3.437589e-05 ||∇||=8.576865e-01 | Tr=0.8828] 22%|██▏       | 4/18 [00:24<01:15,  5.40s/it, CE=6.028514e-01 H=6.029008e-01 dV_dx=1.510196e-05 dV_dθ=3.437589e-05 ||∇||=8.576865e-01 | Tr=0.8828] 22%|██▏       | 4/18 [00:28<01:15,  5.40s/it, CE=5.897957e-01 H=5.896988e-01 dV_dx=-1.870509e-05 dV_dθ=-7.814642e-05 ||∇||=8.144224e-01 | Tr=0.8990] 28%|██▊       | 5/18 [00:28<01:04,  4.98s/it, CE=5.897957e-01 H=5.896988e-01 dV_dx=-1.870509e-05 dV_dθ=-7.814642e-05 ||∇||=8.144224e-01 | Tr=0.8990] 28%|██▊       | 5/18 [00:35<01:04,  4.98s/it, CE=5.777569e-01 H=5.776456e-01 dV_dx=2.299785e-05 dV_dθ=-1.343514e-04 ||∇||=7.838300e-01 | Tr=0.9090 Te/Cur=0.9092 Te/Exp=0.8056] 33%|███▎      | 6/18 [00:35<01:06,  5.50s/it, CE=5.777569e-01 H=5.776456e-01 dV_dx=2.299785e-05 dV_dθ=-1.343514e-04 ||∇||=7.838300e-01 | Tr=0.9090 Te/Cur=0.9092 Te/Exp=0.8056] 33%|███▎      | 6/18 [00:40<01:06,  5.50s/it, CE=5.670100e-01 H=5.668370e-01 dV_dx=-1.172361e-05 dV_dθ=-1.612619e-04 ||∇||=7.601929e-01 | Tr=0.9167]                            39%|███▉      | 7/18 [00:40<00:58,  5.34s/it, CE=5.670100e-01 H=5.668370e-01 dV_dx=-1.172361e-05 dV_dθ=-1.612619e-04 ||∇||=7.601929e-01 | Tr=0.9167] 39%|███▉      | 7/18 [00:44<00:58,  5.34s/it, CE=5.574961e-01 H=5.572963e-01 dV_dx=-1.463880e-05 dV_dθ=-1.851096e-04 ||∇||=7.430287e-01 | Tr=0.9234] 44%|████▍     | 8/18 [00:44<00:50,  5.02s/it, CE=5.574961e-01 H=5.572963e-01 dV_dx=-1.463880e-05 dV_dθ=-1.851096e-04 ||∇||=7.430287e-01 | Tr=0.9234] 44%|████▍     | 8/18 [00:49<00:50,  5.02s/it, CE=5.487486e-01 H=5.485030e-01 dV_dx=-4.152093e-05 dV_dθ=-2.040514e-04 ||∇||=7.283833e-01 | Tr=0.9283] 50%|█████     | 9/18 [00:49<00:43,  4.84s/it, CE=5.487486e-01 H=5.485030e-01 dV_dx=-4.152093e-05 dV_dθ=-2.040514e-04 ||∇||=7.283833e-01 | Tr=0.9283] 50%|█████     | 9/18 [00:53<00:43,  4.84s/it, CE=5.408946e-01 H=5.406808e-01 dV_dx=4.998473e-07 dV_dθ=-2.142567e-04 ||∇||=7.144082e-01 | Tr=0.9324]  56%|█████▌    | 10/18 [00:53<00:37,  4.69s/it, CE=5.408946e-01 H=5.406808e-01 dV_dx=4.998473e-07 dV_dθ=-2.142567e-04 ||∇||=7.144082e-01 | Tr=0.9324] 56%|█████▌    | 10/18 [00:59<00:37,  4.69s/it, CE=5.336534e-01 H=5.334422e-01 dV_dx=7.787956e-06 dV_dθ=-2.189649e-04 ||∇||=7.019292e-01 | Tr=0.9366 Te/Cur=0.9349 Te/Exp=0.8174] 61%|██████    | 11/18 [00:59<00:35,  5.12s/it, CE=5.336534e-01 H=5.334422e-01 dV_dx=7.787956e-06 dV_dθ=-2.189649e-04 ||∇||=7.019292e-01 | Tr=0.9366 Te/Cur=0.9349 Te/Exp=0.8174] 61%|██████    | 11/18 [01:03<00:35,  5.12s/it, CE=5.270351e-01 H=5.267326e-01 dV_dx=-7.188142e-05 dV_dθ=-2.306316e-04 ||∇||=6.928652e-01 | Tr=0.9399]                            67%|██████▋   | 12/18 [01:03<00:28,  4.83s/it, CE=5.270351e-01 H=5.267326e-01 dV_dx=-7.188142e-05 dV_dθ=-2.306316e-04 ||∇||=6.928652e-01 | Tr=0.9399] 67%|██████▋   | 12/18 [01:08<00:28,  4.83s/it, CE=5.207786e-01 H=5.205349e-01 dV_dx=-5.042853e-06 dV_dθ=-2.386273e-04 ||∇||=6.844422e-01 | Tr=0.9427] 72%|███████▏  | 13/18 [01:08<00:24,  4.92s/it, CE=5.207786e-01 H=5.205349e-01 dV_dx=-5.042853e-06 dV_dθ=-2.386273e-04 ||∇||=6.844422e-01 | Tr=0.9427] 72%|███████▏  | 13/18 [01:13<00:24,  4.92s/it, CE=5.148876e-01 H=5.146651e-01 dV_dx=1.621664e-05 dV_dθ=-2.387677e-04 ||∇||=6.747741e-01 | Tr=0.9459]  78%|███████▊  | 14/18 [01:13<00:19,  4.82s/it, CE=5.148876e-01 H=5.146651e-01 dV_dx=1.621664e-05 dV_dθ=-2.387677e-04 ||∇||=6.747741e-01 | Tr=0.9459] 78%|███████▊  | 14/18 [01:18<00:19,  4.82s/it, CE=5.093153e-01 H=5.090323e-01 dV_dx=-4.288256e-05 dV_dθ=-2.401622e-04 ||∇||=6.662546e-01 | Tr=0.9485] 83%|████████▎ | 15/18 [01:18<00:14,  4.99s/it, CE=5.093153e-01 H=5.090323e-01 dV_dx=-4.288256e-05 dV_dθ=-2.401622e-04 ||∇||=6.662546e-01 | Tr=0.9485] 83%|████████▎ | 15/18 [01:25<00:14,  4.99s/it, CE=5.041707e-01 H=5.039475e-01 dV_dx=1.134125e-05 dV_dθ=-2.345122e-04 ||∇||=6.559140e-01 | Tr=0.9509 Te/Cur=0.9470 Te/Exp=0.8264] 89%|████████▉ | 16/18 [01:25<00:11,  5.54s/it, CE=5.041707e-01 H=5.039475e-01 dV_dx=1.134125e-05 dV_dθ=-2.345122e-04 ||∇||=6.559140e-01 | Tr=0.9509 Te/Cur=0.9470 Te/Exp=0.8264] 89%|████████▉ | 16/18 [01:30<00:11,  5.54s/it, CE=4.992331e-01 H=4.989392e-01 dV_dx=-6.420536e-05 dV_dθ=-2.296956e-04 ||∇||=6.465120e-01 | Tr=0.9533]                            94%|█████████▍| 17/18 [01:30<00:05,  5.40s/it, CE=4.992331e-01 H=4.989392e-01 dV_dx=-6.420536e-05 dV_dθ=-2.296956e-04 ||∇||=6.465120e-01 | Tr=0.9533] 94%|█████████▍| 17/18 [01:36<00:05,  5.40s/it, CE=4.945122e-01 H=4.942269e-01 dV_dx=-5.956736e-05 dV_dθ=-2.257309e-04 ||∇||=6.382774e-01 | Tr=0.9555 Te/Cur=0.9521 Te/Exp=0.8316]100%|██████████| 18/18 [01:36<00:00,  5.45s/it, CE=4.945122e-01 H=4.942269e-01 dV_dx=-5.956736e-05 dV_dθ=-2.257309e-04 ||∇||=6.382774e-01 | Tr=0.9555 Te/Cur=0.9521 Te/Exp=0.8316]100%|██████████| 18/18 [01:36<00:00,  5.36s/it, CE=4.945122e-01 H=4.942269e-01 dV_dx=-5.956736e-05 dV_dθ=-2.257309e-04 ||∇||=6.382774e-01 | Tr=0.9555 Te/Cur=0.9521 Te/Exp=0.8316]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.7608
    Task 1: 0.9338
    Task 2: 0.8219
    Task 3: 0.5528
    Task 4: 0.9255
    Task 5: 0.8636
    Task 6: 0.9004
    Task 7: 0.8785
    Task 8: 0.9518

============================================================
Task 9
============================================================
Initial loss on new task: 1.7077, previous: 0.4945, ratio: 3.45
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=3.45)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.39s/it] 50%|█████     | 1/2 [00:13<00:07,  7.39s/it, CE=1.684350e+00 H=1.319113e+00 dV_dx=4.731016e-06 dV_dθ=-3.652418e-01 ||∇||=1.418822e+01 | Tr=0.4876 Te/Cur=0.4910 Te/Exp=0.8413]100%|██████████| 2/2 [00:13<00:00,  6.52s/it, CE=1.684350e+00 H=1.319113e+00 dV_dx=4.731016e-06 dV_dθ=-3.652418e-01 ||∇||=1.418822e+01 | Tr=0.4876 Te/Cur=0.4910 Te/Exp=0.8413]100%|██████████| 2/2 [00:13<00:00,  6.65s/it, CE=1.684350e+00 H=1.319113e+00 dV_dx=4.731016e-06 dV_dθ=-3.652418e-01 ||∇||=1.418822e+01 | Tr=0.4876 Te/Cur=0.4910 Te/Exp=0.8413]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:12<03:24, 12.04s/it]  6%|▌         | 1/18 [00:17<03:24, 12.04s/it, CE=4.802047e-01 H=4.803196e-01 dV_dx=3.907837e-05 dV_dθ=7.585600e-05 ||∇||=9.172287e-01 | Tr=0.8600] 11%|█         | 2/18 [00:17<02:07,  7.95s/it, CE=4.802047e-01 H=4.803196e-01 dV_dx=3.907837e-05 dV_dθ=7.585600e-05 ||∇||=9.172287e-01 | Tr=0.8600] 11%|█         | 2/18 [00:21<02:07,  7.95s/it, CE=4.766366e-01 H=4.766670e-01 dV_dx=5.142616e-06 dV_dθ=2.533186e-05 ||∇||=8.318570e-01 | Tr=0.8882] 17%|█▋        | 3/18 [00:21<01:36,  6.46s/it, CE=4.766366e-01 H=4.766670e-01 dV_dx=5.142616e-06 dV_dθ=2.533186e-05 ||∇||=8.318570e-01 | Tr=0.8882] 17%|█▋        | 3/18 [00:26<01:36,  6.46s/it, CE=4.714164e-01 H=4.714647e-01 dV_dx=5.933193e-05 dV_dθ=-1.107681e-05 ||∇||=7.940385e-01 | Tr=0.9024] 22%|██▏       | 4/18 [00:26<01:21,  5.84s/it, CE=4.714164e-01 H=4.714647e-01 dV_dx=5.933193e-05 dV_dθ=-1.107681e-05 ||∇||=7.940385e-01 | Tr=0.9024] 22%|██▏       | 4/18 [00:31<01:21,  5.84s/it, CE=4.658809e-01 H=4.657837e-01 dV_dx=-5.964784e-05 dV_dθ=-3.754247e-05 ||∇||=7.677710e-01 | Tr=0.9119] 28%|██▊       | 5/18 [00:31<01:12,  5.60s/it, CE=4.658809e-01 H=4.657837e-01 dV_dx=-5.964784e-05 dV_dθ=-3.754247e-05 ||∇||=7.677710e-01 | Tr=0.9119] 28%|██▊       | 5/18 [00:38<01:12,  5.60s/it, CE=4.607457e-01 H=4.606154e-01 dV_dx=-6.491009e-05 dV_dθ=-6.534866e-05 ||∇||=7.485912e-01 | Tr=0.9190 Te/Cur=0.9249 Te/Exp=0.8427] 33%|███▎      | 6/18 [00:38<01:11,  5.95s/it, CE=4.607457e-01 H=4.606154e-01 dV_dx=-6.491009e-05 dV_dθ=-6.534866e-05 ||∇||=7.485912e-01 | Tr=0.9190 Te/Cur=0.9249 Te/Exp=0.8427] 33%|███▎      | 6/18 [00:42<01:11,  5.95s/it, CE=4.556527e-01 H=4.555286e-01 dV_dx=-3.771244e-05 dV_dθ=-8.642865e-05 ||∇||=7.321679e-01 | Tr=0.9254]                             39%|███▉      | 7/18 [00:42<00:59,  5.40s/it, CE=4.556527e-01 H=4.555286e-01 dV_dx=-3.771244e-05 dV_dθ=-8.642865e-05 ||∇||=7.321679e-01 | Tr=0.9254] 39%|███▉      | 7/18 [00:46<00:59,  5.40s/it, CE=4.507091e-01 H=4.505855e-01 dV_dx=-2.079951e-05 dV_dθ=-1.028120e-04 ||∇||=7.177472e-01 | Tr=0.9297] 44%|████▍     | 8/18 [00:46<00:49,  4.96s/it, CE=4.507091e-01 H=4.505855e-01 dV_dx=-2.079951e-05 dV_dθ=-1.028120e-04 ||∇||=7.177472e-01 | Tr=0.9297] 44%|████▍     | 8/18 [00:51<00:49,  4.96s/it, CE=4.459536e-01 H=4.458297e-01 dV_dx=1.845694e-06 dV_dθ=-1.257187e-04 ||∇||=7.094269e-01 | Tr=0.9331]  50%|█████     | 9/18 [00:51<00:44,  4.93s/it, CE=4.459536e-01 H=4.458297e-01 dV_dx=1.845694e-06 dV_dθ=-1.257187e-04 ||∇||=7.094269e-01 | Tr=0.9331] 50%|█████     | 9/18 [00:56<00:44,  4.93s/it, CE=4.414691e-01 H=4.413131e-01 dV_dx=-1.980484e-05 dV_dθ=-1.361968e-04 ||∇||=7.005851e-01 | Tr=0.9364] 56%|█████▌    | 10/18 [00:56<00:38,  4.76s/it, CE=4.414691e-01 H=4.413131e-01 dV_dx=-1.980484e-05 dV_dθ=-1.361968e-04 ||∇||=7.005851e-01 | Tr=0.9364] 56%|█████▌    | 10/18 [01:02<00:38,  4.76s/it, CE=4.371297e-01 H=4.369917e-01 dV_dx=8.041179e-06 dV_dθ=-1.460417e-04 ||∇||=6.931397e-01 | Tr=0.9393 Te/Cur=0.9402 Te/Exp=0.8439] 61%|██████    | 11/18 [01:02<00:37,  5.31s/it, CE=4.371297e-01 H=4.369917e-01 dV_dx=8.041179e-06 dV_dθ=-1.460417e-04 ||∇||=6.931397e-01 | Tr=0.9393 Te/Cur=0.9402 Te/Exp=0.8439] 61%|██████    | 11/18 [01:07<00:37,  5.31s/it, CE=4.329706e-01 H=4.328060e-01 dV_dx=-6.951844e-06 dV_dθ=-1.576909e-04 ||∇||=6.870893e-01 | Tr=0.9422]                            67%|██████▋   | 12/18 [01:07<00:31,  5.32s/it, CE=4.329706e-01 H=4.328060e-01 dV_dx=-6.951844e-06 dV_dθ=-1.576909e-04 ||∇||=6.870893e-01 | Tr=0.9422] 67%|██████▋   | 12/18 [01:12<00:31,  5.32s/it, CE=4.289929e-01 H=4.288000e-01 dV_dx=-2.093404e-05 dV_dθ=-1.719610e-04 ||∇||=6.838594e-01 | Tr=0.9442] 72%|███████▏  | 13/18 [01:12<00:26,  5.24s/it, CE=4.289929e-01 H=4.288000e-01 dV_dx=-2.093404e-05 dV_dθ=-1.719610e-04 ||∇||=6.838594e-01 | Tr=0.9442] 72%|███████▏  | 13/18 [01:17<00:26,  5.24s/it, CE=4.251644e-01 H=4.250104e-01 dV_dx=2.314318e-05 dV_dθ=-1.771656e-04 ||∇||=6.783998e-01 | Tr=0.9469]  78%|███████▊  | 14/18 [01:17<00:20,  5.05s/it, CE=4.251644e-01 H=4.250104e-01 dV_dx=2.314318e-05 dV_dθ=-1.771656e-04 ||∇||=6.783998e-01 | Tr=0.9469] 78%|███████▊  | 14/18 [01:22<00:20,  5.05s/it, CE=4.214494e-01 H=4.212557e-01 dV_dx=-9.504558e-06 dV_dθ=-1.841496e-04 ||∇||=6.741022e-01 | Tr=0.9489] 83%|████████▎ | 15/18 [01:22<00:15,  5.12s/it, CE=4.214494e-01 H=4.212557e-01 dV_dx=-9.504558e-06 dV_dθ=-1.841496e-04 ||∇||=6.741022e-01 | Tr=0.9489] 83%|████████▎ | 15/18 [01:29<00:15,  5.12s/it, CE=4.179119e-01 H=4.176859e-01 dV_dx=-4.344454e-05 dV_dθ=-1.825067e-04 ||∇||=6.676078e-01 | Tr=0.9511 Te/Cur=0.9497 Te/Exp=0.8488] 89%|████████▉ | 16/18 [01:29<00:11,  5.60s/it, CE=4.179119e-01 H=4.176859e-01 dV_dx=-4.344454e-05 dV_dθ=-1.825067e-04 ||∇||=6.676078e-01 | Tr=0.9511 Te/Cur=0.9497 Te/Exp=0.8488] 89%|████████▉ | 16/18 [01:34<00:11,  5.60s/it, CE=4.144735e-01 H=4.143316e-01 dV_dx=4.444964e-05 dV_dθ=-1.863448e-04 ||∇||=6.646679e-01 | Tr=0.9527]                              94%|█████████▍| 17/18 [01:34<00:05,  5.36s/it, CE=4.144735e-01 H=4.143316e-01 dV_dx=4.444964e-05 dV_dθ=-1.863448e-04 ||∇||=6.646679e-01 | Tr=0.9527] 94%|█████████▍| 17/18 [01:41<00:05,  5.36s/it, CE=4.110637e-01 H=4.108851e-01 dV_dx=9.058697e-06 dV_dθ=-1.877134e-04 ||∇||=6.601530e-01 | Tr=0.9539 Te/Cur=0.9526 Te/Exp=0.8590]100%|██████████| 18/18 [01:41<00:00,  5.76s/it, CE=4.110637e-01 H=4.108851e-01 dV_dx=9.058697e-06 dV_dθ=-1.877134e-04 ||∇||=6.601530e-01 | Tr=0.9539 Te/Cur=0.9526 Te/Exp=0.8590]100%|██████████| 18/18 [01:41<00:00,  5.61s/it, CE=4.110637e-01 H=4.108851e-01 dV_dx=9.058697e-06 dV_dθ=-1.877134e-04 ||∇||=6.601530e-01 | Tr=0.9539 Te/Cur=0.9526 Te/Exp=0.8590]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7647
    Task 1: 0.9391
    Task 2: 0.8312
    Task 3: 0.5566
    Task 4: 0.9362
    Task 5: 0.9057
    Task 6: 0.9137
    Task 7: 0.9161
    Task 8: 0.8911
    Task 9: 0.9525
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run1/mnist_condition2_heuristics_run1_run1/classification_mnist_cnn_run1_records.pkl

Training complete!
