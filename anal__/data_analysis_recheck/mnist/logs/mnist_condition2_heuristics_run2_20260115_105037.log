JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition2_heuristics.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: False

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run2
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run2/mnist_condition2_heuristics_run2


############################################################
# Run ID: 2
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:18<05:52, 18.56s/it]  5%|▌         | 1/20 [00:23<05:52, 18.56s/it, CE=2.069933e+00 H=2.069519e+00 dV_dx=-1.136231e-07 dV_dθ=-4.137243e-04 ||∇||=4.432295e-01 | Tr=0.4057] 10%|█         | 2/20 [00:23<03:10, 10.57s/it, CE=2.069933e+00 H=2.069519e+00 dV_dx=-1.136231e-07 dV_dθ=-4.137243e-04 ||∇||=4.432295e-01 | Tr=0.4057] 10%|█         | 2/20 [00:28<03:10, 10.57s/it, CE=1.855012e+00 H=1.854194e+00 dV_dx=3.254960e-07 dV_dθ=-8.177614e-04 ||∇||=6.201689e-01 | Tr=0.4886]  15%|█▌        | 3/20 [00:28<02:18,  8.14s/it, CE=1.855012e+00 H=1.854194e+00 dV_dx=3.254960e-07 dV_dθ=-8.177614e-04 ||∇||=6.201689e-01 | Tr=0.4886] 15%|█▌        | 3/20 [00:33<02:18,  8.14s/it, CE=1.636719e+00 H=1.635685e+00 dV_dx=1.144712e-06 dV_dθ=-1.034864e-03 ||∇||=7.014052e-01 | Tr=0.5297] 20%|██        | 4/20 [00:33<01:51,  6.97s/it, CE=1.636719e+00 H=1.635685e+00 dV_dx=1.144712e-06 dV_dθ=-1.034864e-03 ||∇||=7.014052e-01 | Tr=0.5297] 20%|██        | 4/20 [00:38<01:51,  6.97s/it, CE=1.461459e+00 H=1.460452e+00 dV_dx=4.613437e-07 dV_dθ=-1.006529e-03 ||∇||=6.990438e-01 | Tr=0.5590] 25%|██▌       | 5/20 [00:38<01:33,  6.24s/it, CE=1.461459e+00 H=1.460452e+00 dV_dx=4.613437e-07 dV_dθ=-1.006529e-03 ||∇||=6.990438e-01 | Tr=0.5590] 25%|██▌       | 5/20 [00:46<01:33,  6.24s/it, CE=1.328565e+00 H=1.327666e+00 dV_dx=1.487162e-06 dV_dθ=-9.007671e-04 ||∇||=6.705078e-01 | Tr=0.5864 Te/Cur=0.5919 Te/Exp=0.5914] 30%|███       | 6/20 [00:46<01:34,  6.78s/it, CE=1.328565e+00 H=1.327666e+00 dV_dx=1.487162e-06 dV_dθ=-9.007671e-04 ||∇||=6.705078e-01 | Tr=0.5864 Te/Cur=0.5919 Te/Exp=0.5914] 30%|███       | 6/20 [00:51<01:34,  6.78s/it, CE=1.230083e+00 H=1.229313e+00 dV_dx=1.440711e-06 dV_dθ=-7.711663e-04 ||∇||=6.314457e-01 | Tr=0.6093]                             35%|███▌      | 7/20 [00:51<01:20,  6.19s/it, CE=1.230083e+00 H=1.229313e+00 dV_dx=1.440711e-06 dV_dθ=-7.711663e-04 ||∇||=6.314457e-01 | Tr=0.6093] 35%|███▌      | 7/20 [00:56<01:20,  6.19s/it, CE=1.155646e+00 H=1.154979e+00 dV_dx=1.837485e-06 dV_dθ=-6.685001e-04 ||∇||=5.986690e-01 | Tr=0.6278] 40%|████      | 8/20 [00:56<01:09,  5.75s/it, CE=1.155646e+00 H=1.154979e+00 dV_dx=1.837485e-06 dV_dθ=-6.685001e-04 ||∇||=5.986690e-01 | Tr=0.6278] 40%|████      | 8/20 [01:01<01:09,  5.75s/it, CE=1.097313e+00 H=1.096726e+00 dV_dx=3.750397e-07 dV_dθ=-5.874796e-04 ||∇||=5.728748e-01 | Tr=0.6442] 45%|████▌     | 9/20 [01:01<01:00,  5.49s/it, CE=1.097313e+00 H=1.096726e+00 dV_dx=3.750397e-07 dV_dθ=-5.874796e-04 ||∇||=5.728748e-01 | Tr=0.6442] 45%|████▌     | 9/20 [01:06<01:00,  5.49s/it, CE=1.050429e+00 H=1.049888e+00 dV_dx=-1.762111e-06 dV_dθ=-5.385984e-04 ||∇||=5.577600e-01 | Tr=0.6578] 50%|█████     | 10/20 [01:06<00:54,  5.41s/it, CE=1.050429e+00 H=1.049888e+00 dV_dx=-1.762111e-06 dV_dθ=-5.385984e-04 ||∇||=5.577600e-01 | Tr=0.6578] 50%|█████     | 10/20 [01:12<00:54,  5.41s/it, CE=1.011703e+00 H=1.011207e+00 dV_dx=-2.235859e-06 dV_dθ=-4.945037e-04 ||∇||=5.442833e-01 | Tr=0.6693 Te/Cur=0.6654 Te/Exp=0.6695] 55%|█████▌    | 11/20 [01:12<00:50,  5.66s/it, CE=1.011703e+00 H=1.011207e+00 dV_dx=-2.235859e-06 dV_dθ=-4.945037e-04 ||∇||=5.442833e-01 | Tr=0.6693 Te/Cur=0.6654 Te/Exp=0.6695] 55%|█████▌    | 11/20 [01:17<00:50,  5.66s/it, CE=9.789458e-01 H=9.784792e-01 dV_dx=-1.013021e-06 dV_dθ=-4.656571e-04 ||∇||=5.358405e-01 | Tr=0.6789]                             60%|██████    | 12/20 [01:17<00:43,  5.46s/it, CE=9.789458e-01 H=9.784792e-01 dV_dx=-1.013021e-06 dV_dθ=-4.656571e-04 ||∇||=5.358405e-01 | Tr=0.6789] 60%|██████    | 12/20 [01:22<00:43,  5.46s/it, CE=9.505429e-01 H=9.500973e-01 dV_dx=5.766817e-07 dV_dθ=-4.461430e-04 ||∇||=5.305699e-01 | Tr=0.6883]  65%|██████▌   | 13/20 [01:22<00:37,  5.29s/it, CE=9.505429e-01 H=9.500973e-01 dV_dx=5.766817e-07 dV_dθ=-4.461430e-04 ||∇||=5.305699e-01 | Tr=0.6883] 65%|██████▌   | 13/20 [01:27<00:37,  5.29s/it, CE=9.253687e-01 H=9.249348e-01 dV_dx=2.125905e-06 dV_dθ=-4.360794e-04 ||∇||=5.288198e-01 | Tr=0.6965] 70%|███████   | 14/20 [01:27<00:31,  5.18s/it, CE=9.253687e-01 H=9.249348e-01 dV_dx=2.125905e-06 dV_dθ=-4.360794e-04 ||∇||=5.288198e-01 | Tr=0.6965] 70%|███████   | 14/20 [01:32<00:31,  5.18s/it, CE=9.025762e-01 H=9.021459e-01 dV_dx=-3.610362e-07 dV_dθ=-4.298878e-04 ||∇||=5.282463e-01 | Tr=0.7036] 75%|███████▌  | 15/20 [01:32<00:25,  5.12s/it, CE=9.025762e-01 H=9.021459e-01 dV_dx=-3.610362e-07 dV_dθ=-4.298878e-04 ||∇||=5.282463e-01 | Tr=0.7036] 75%|███████▌  | 15/20 [01:38<00:25,  5.12s/it, CE=8.820981e-01 H=8.816791e-01 dV_dx=-1.519259e-07 dV_dθ=-4.188638e-04 ||∇||=5.258729e-01 | Tr=0.7097 Te/Cur=0.7050 Te/Exp=0.7081] 80%|████████  | 16/20 [01:38<00:21,  5.34s/it, CE=8.820981e-01 H=8.816791e-01 dV_dx=-1.519259e-07 dV_dθ=-4.188638e-04 ||∇||=5.258729e-01 | Tr=0.7097 Te/Cur=0.7050 Te/Exp=0.7081] 80%|████████  | 16/20 [01:43<00:21,  5.34s/it, CE=8.636815e-01 H=8.632739e-01 dV_dx=1.857644e-06 dV_dθ=-4.093833e-04 ||∇||=5.243482e-01 | Tr=0.7156]                              85%|████████▌ | 17/20 [01:43<00:15,  5.14s/it, CE=8.636815e-01 H=8.632739e-01 dV_dx=1.857644e-06 dV_dθ=-4.093833e-04 ||∇||=5.243482e-01 | Tr=0.7156] 85%|████████▌ | 17/20 [01:48<00:15,  5.14s/it, CE=8.468160e-01 H=8.464159e-01 dV_dx=-6.319204e-09 dV_dθ=-4.000566e-04 ||∇||=5.224000e-01 | Tr=0.7211] 90%|█████████ | 18/20 [01:48<00:10,  5.04s/it, CE=8.468160e-01 H=8.464159e-01 dV_dx=-6.319204e-09 dV_dθ=-4.000566e-04 ||∇||=5.224000e-01 | Tr=0.7211] 90%|█████████ | 18/20 [01:53<00:10,  5.04s/it, CE=8.313144e-01 H=8.309179e-01 dV_dx=1.684210e-06 dV_dθ=-3.981933e-04 ||∇||=5.235500e-01 | Tr=0.7261]  95%|█████████▌| 19/20 [01:53<00:05,  5.02s/it, CE=8.313144e-01 H=8.309179e-01 dV_dx=1.684210e-06 dV_dθ=-3.981933e-04 ||∇||=5.235500e-01 | Tr=0.7261] 95%|█████████▌| 19/20 [02:00<00:05,  5.02s/it, CE=8.169310e-01 H=8.165382e-01 dV_dx=-6.668497e-07 dV_dθ=-3.920686e-04 ||∇||=5.230423e-01 | Tr=0.7306 Te/Cur=0.7271 Te/Exp=0.7299]100%|██████████| 20/20 [02:00<00:00,  5.74s/it, CE=8.169310e-01 H=8.165382e-01 dV_dx=-6.668497e-07 dV_dθ=-3.920686e-04 ||∇||=5.230423e-01 | Tr=0.7306 Te/Cur=0.7271 Te/Exp=0.7299]100%|██████████| 20/20 [02:00<00:00,  6.02s/it, CE=8.169310e-01 H=8.165382e-01 dV_dx=-6.668497e-07 dV_dθ=-3.920686e-04 ||∇||=5.230423e-01 | Tr=0.7306 Te/Cur=0.7271 Te/Exp=0.7299]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7277

============================================================
Task 1
============================================================
Initial loss on new task: 6.1486, previous: 0.8169, ratio: 7.53
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.53)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.16s/it] 50%|█████     | 1/2 [00:14<00:09,  9.16s/it, CE=6.071102e+00 H=5.029565e+00 dV_dx=6.972824e-07 dV_dθ=-1.041538e+00 ||∇||=2.377285e+01 | Tr=0.1007 Te/Cur=0.0994 Te/Exp=0.7259]100%|██████████| 2/2 [00:14<00:00,  6.90s/it, CE=6.071102e+00 H=5.029565e+00 dV_dx=6.972824e-07 dV_dθ=-1.041538e+00 ||∇||=2.377285e+01 | Tr=0.1007 Te/Cur=0.0994 Te/Exp=0.7259]100%|██████████| 2/2 [00:14<00:00,  7.24s/it, CE=6.071102e+00 H=5.029565e+00 dV_dx=6.972824e-07 dV_dθ=-1.041538e+00 ||∇||=2.377285e+01 | Tr=0.1007 Te/Cur=0.0994 Te/Exp=0.7259]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:08<02:19,  8.19s/it]  6%|▌         | 1/18 [00:11<02:19,  8.19s/it, CE=9.101135e-01 H=9.123122e-01 dV_dx=2.109821e-05 dV_dθ=2.177524e-03 ||∇||=1.132007e+00 | Tr=0.5964] 11%|█         | 2/18 [00:11<01:29,  5.60s/it, CE=9.101135e-01 H=9.123122e-01 dV_dx=2.109821e-05 dV_dθ=2.177524e-03 ||∇||=1.132007e+00 | Tr=0.5964] 11%|█         | 2/18 [00:15<01:29,  5.60s/it, CE=8.544288e-01 H=8.543942e-01 dV_dx=3.469076e-05 dV_dθ=-6.923969e-05 ||∇||=8.253719e-01 | Tr=0.7174] 17%|█▋        | 3/18 [00:15<01:12,  4.81s/it, CE=8.544288e-01 H=8.543942e-01 dV_dx=3.469076e-05 dV_dθ=-6.923969e-05 ||∇||=8.253719e-01 | Tr=0.7174] 17%|█▋        | 3/18 [00:20<01:12,  4.81s/it, CE=8.460358e-01 H=8.458579e-01 dV_dx=-2.496908e-05 dV_dθ=-1.529530e-04 ||∇||=7.262788e-01 | Tr=0.7743] 22%|██▏       | 4/18 [00:20<01:07,  4.83s/it, CE=8.460358e-01 H=8.458579e-01 dV_dx=-2.496908e-05 dV_dθ=-1.529530e-04 ||∇||=7.262788e-01 | Tr=0.7743] 22%|██▏       | 4/18 [00:24<01:07,  4.83s/it, CE=8.386636e-01 H=8.384616e-01 dV_dx=-5.872057e-05 dV_dθ=-1.432200e-04 ||∇||=6.617800e-01 | Tr=0.8093] 28%|██▊       | 5/18 [00:24<00:59,  4.61s/it, CE=8.386636e-01 H=8.384616e-01 dV_dx=-5.872057e-05 dV_dθ=-1.432200e-04 ||∇||=6.617800e-01 | Tr=0.8093] 28%|██▊       | 5/18 [00:31<00:59,  4.61s/it, CE=8.317020e-01 H=8.316515e-01 dV_dx=8.347820e-05 dV_dθ=-1.339920e-04 ||∇||=6.166605e-01 | Tr=0.8339 Te/Cur=0.8424 Te/Exp=0.7227] 33%|███▎      | 6/18 [00:31<01:03,  5.32s/it, CE=8.317020e-01 H=8.316515e-01 dV_dx=8.347820e-05 dV_dθ=-1.339920e-04 ||∇||=6.166605e-01 | Tr=0.8339 Te/Cur=0.8424 Te/Exp=0.7227] 33%|███▎      | 6/18 [00:36<01:03,  5.32s/it, CE=8.252891e-01 H=8.251695e-01 dV_dx=3.241538e-06 dV_dθ=-1.227963e-04 ||∇||=5.845765e-01 | Tr=0.8510]                             39%|███▉      | 7/18 [00:36<00:57,  5.19s/it, CE=8.252891e-01 H=8.251695e-01 dV_dx=3.241538e-06 dV_dθ=-1.227963e-04 ||∇||=5.845765e-01 | Tr=0.8510] 39%|███▉      | 7/18 [00:41<00:57,  5.19s/it, CE=8.193603e-01 H=8.192614e-01 dV_dx=1.550600e-05 dV_dθ=-1.144809e-04 ||∇||=5.593266e-01 | Tr=0.8623] 44%|████▍     | 8/18 [00:41<00:49,  4.98s/it, CE=8.193603e-01 H=8.192614e-01 dV_dx=1.550600e-05 dV_dθ=-1.144809e-04 ||∇||=5.593266e-01 | Tr=0.8623] 44%|████▍     | 8/18 [00:45<00:49,  4.98s/it, CE=8.134309e-01 H=8.133263e-01 dV_dx=2.460846e-06 dV_dθ=-1.070544e-04 ||∇||=5.395774e-01 | Tr=0.8708] 50%|█████     | 9/18 [00:45<00:42,  4.74s/it, CE=8.134309e-01 H=8.133263e-01 dV_dx=2.460846e-06 dV_dθ=-1.070544e-04 ||∇||=5.395774e-01 | Tr=0.8708] 50%|█████     | 9/18 [00:48<00:42,  4.74s/it, CE=8.078884e-01 H=8.077494e-01 dV_dx=-3.836296e-05 dV_dθ=-1.006564e-04 ||∇||=5.242162e-01 | Tr=0.8778] 56%|█████▌    | 10/18 [00:48<00:33,  4.23s/it, CE=8.078884e-01 H=8.077494e-01 dV_dx=-3.836296e-05 dV_dθ=-1.006564e-04 ||∇||=5.242162e-01 | Tr=0.8778] 56%|█████▌    | 10/18 [00:54<00:33,  4.23s/it, CE=8.025043e-01 H=8.023935e-01 dV_dx=-1.609468e-05 dV_dθ=-9.473837e-05 ||∇||=5.085310e-01 | Tr=0.8843 Te/Cur=0.8864 Te/Exp=0.7310] 61%|██████    | 11/18 [00:54<00:33,  4.72s/it, CE=8.025043e-01 H=8.023935e-01 dV_dx=-1.609468e-05 dV_dθ=-9.473837e-05 ||∇||=5.085310e-01 | Tr=0.8843 Te/Cur=0.8864 Te/Exp=0.7310] 61%|██████    | 11/18 [00:58<00:33,  4.72s/it, CE=7.973670e-01 H=7.972582e-01 dV_dx=-1.779706e-05 dV_dθ=-9.096021e-05 ||∇||=4.983039e-01 | Tr=0.8895]                             67%|██████▋   | 12/18 [00:58<00:27,  4.59s/it, CE=7.973670e-01 H=7.972582e-01 dV_dx=-1.779706e-05 dV_dθ=-9.096021e-05 ||∇||=4.983039e-01 | Tr=0.8895] 67%|██████▋   | 12/18 [01:02<00:27,  4.59s/it, CE=7.923298e-01 H=7.922269e-01 dV_dx=-1.120724e-05 dV_dθ=-9.168363e-05 ||∇||=4.919482e-01 | Tr=0.8938] 72%|███████▏  | 13/18 [01:02<00:22,  4.52s/it, CE=7.923298e-01 H=7.922269e-01 dV_dx=-1.120724e-05 dV_dθ=-9.168363e-05 ||∇||=4.919482e-01 | Tr=0.8938] 72%|███████▏  | 13/18 [01:07<00:22,  4.52s/it, CE=7.872031e-01 H=7.871365e-01 dV_dx=2.484927e-05 dV_dθ=-9.144270e-05 ||∇||=4.858231e-01 | Tr=0.8977]  78%|███████▊  | 14/18 [01:07<00:18,  4.58s/it, CE=7.872031e-01 H=7.871365e-01 dV_dx=2.484927e-05 dV_dθ=-9.144270e-05 ||∇||=4.858231e-01 | Tr=0.8977] 78%|███████▊  | 14/18 [01:12<00:18,  4.58s/it, CE=7.821192e-01 H=7.819540e-01 dV_dx=-7.656292e-05 dV_dθ=-8.869409e-05 ||∇||=4.802043e-01 | Tr=0.9014] 83%|████████▎ | 15/18 [01:12<00:13,  4.59s/it, CE=7.821192e-01 H=7.819540e-01 dV_dx=-7.656292e-05 dV_dθ=-8.869409e-05 ||∇||=4.802043e-01 | Tr=0.9014] 83%|████████▎ | 15/18 [01:18<00:13,  4.59s/it, CE=7.771188e-01 H=7.771031e-01 dV_dx=7.060669e-05 dV_dθ=-8.634046e-05 ||∇||=4.749662e-01 | Tr=0.9048 Te/Cur=0.9038 Te/Exp=0.7405] 89%|████████▉ | 16/18 [01:18<00:10,  5.22s/it, CE=7.771188e-01 H=7.771031e-01 dV_dx=7.060669e-05 dV_dθ=-8.634046e-05 ||∇||=4.749662e-01 | Tr=0.9048 Te/Cur=0.9038 Te/Exp=0.7405] 89%|████████▉ | 16/18 [01:22<00:10,  5.22s/it, CE=7.722641e-01 H=7.721040e-01 dV_dx=-7.451718e-05 dV_dθ=-8.558480e-05 ||∇||=4.719317e-01 | Tr=0.9078]                            94%|█████████▍| 17/18 [01:22<00:04,  4.67s/it, CE=7.722641e-01 H=7.721040e-01 dV_dx=-7.451718e-05 dV_dθ=-8.558480e-05 ||∇||=4.719317e-01 | Tr=0.9078] 94%|█████████▍| 17/18 [01:28<00:04,  4.67s/it, CE=7.673844e-01 H=7.672997e-01 dV_dx=2.136270e-06 dV_dθ=-8.680694e-05 ||∇||=4.697511e-01 | Tr=0.9106 Te/Cur=0.9110 Te/Exp=0.7436]100%|██████████| 18/18 [01:28<00:00,  5.02s/it, CE=7.673844e-01 H=7.672997e-01 dV_dx=2.136270e-06 dV_dθ=-8.680694e-05 ||∇||=4.697511e-01 | Tr=0.9106 Te/Cur=0.9110 Te/Exp=0.7436]100%|██████████| 18/18 [01:28<00:00,  4.89s/it, CE=7.673844e-01 H=7.672997e-01 dV_dx=2.136270e-06 dV_dθ=-8.680694e-05 ||∇||=4.697511e-01 | Tr=0.9106 Te/Cur=0.9110 Te/Exp=0.7436]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.7428
    Task 1: 0.9113

============================================================
Task 2
============================================================
Initial loss on new task: 4.5130, previous: 0.7674, ratio: 5.88
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=5.88)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.93s/it] 50%|█████     | 1/2 [00:14<00:08,  8.93s/it, CE=4.477625e+00 H=3.663546e+00 dV_dx=-2.937797e-06 dV_dθ=-8.140762e-01 ||∇||=2.103573e+01 | Tr=0.1255 Te/Cur=0.1212 Te/Exp=0.8257]100%|██████████| 2/2 [00:14<00:00,  6.87s/it, CE=4.477625e+00 H=3.663546e+00 dV_dx=-2.937797e-06 dV_dθ=-8.140762e-01 ||∇||=2.103573e+01 | Tr=0.1255 Te/Cur=0.1212 Te/Exp=0.8257]100%|██████████| 2/2 [00:14<00:00,  7.18s/it, CE=4.477625e+00 H=3.663546e+00 dV_dx=-2.937797e-06 dV_dθ=-8.140762e-01 ||∇||=2.103573e+01 | Tr=0.1255 Te/Cur=0.1212 Te/Exp=0.8257]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:09<02:36,  9.18s/it]  6%|▌         | 1/18 [00:13<02:36,  9.18s/it, CE=7.402854e-01 H=7.444019e-01 dV_dx=-1.090280e-05 dV_dθ=4.127347e-03 ||∇||=1.183846e+00 | Tr=0.4708] 11%|█         | 2/18 [00:13<01:36,  6.05s/it, CE=7.402854e-01 H=7.444019e-01 dV_dx=-1.090280e-05 dV_dθ=4.127347e-03 ||∇||=1.183846e+00 | Tr=0.4708] 11%|█         | 2/18 [00:17<01:36,  6.05s/it, CE=7.298047e-01 H=7.329950e-01 dV_dx=4.756410e-05 dV_dθ=3.142713e-03 ||∇||=8.928591e-01 | Tr=0.5554]  17%|█▋        | 3/18 [00:17<01:20,  5.37s/it, CE=7.298047e-01 H=7.329950e-01 dV_dx=4.756410e-05 dV_dθ=3.142713e-03 ||∇||=8.928591e-01 | Tr=0.5554] 17%|█▋        | 3/18 [00:22<01:20,  5.37s/it, CE=7.055694e-01 H=7.080920e-01 dV_dx=4.466898e-06 dV_dθ=2.518122e-03 ||∇||=7.983860e-01 | Tr=0.6086] 22%|██▏       | 4/18 [00:22<01:10,  5.07s/it, CE=7.055694e-01 H=7.080920e-01 dV_dx=4.466898e-06 dV_dθ=2.518122e-03 ||∇||=7.983860e-01 | Tr=0.6086] 22%|██▏       | 4/18 [00:26<01:10,  5.07s/it, CE=6.827649e-01 H=6.846536e-01 dV_dx=-1.714738e-05 dV_dθ=1.905838e-03 ||∇||=7.481187e-01 | Tr=0.6469] 28%|██▊       | 5/18 [00:26<01:02,  4.82s/it, CE=6.827649e-01 H=6.846536e-01 dV_dx=-1.714738e-05 dV_dθ=1.905838e-03 ||∇||=7.481187e-01 | Tr=0.6469] 28%|██▊       | 5/18 [00:32<01:02,  4.82s/it, CE=6.633649e-01 H=6.647747e-01 dV_dx=6.801138e-06 dV_dθ=1.402963e-03 ||∇||=7.210530e-01 | Tr=0.6748 Te/Cur=0.6853 Te/Exp=0.7941] 33%|███▎      | 6/18 [00:32<01:00,  5.05s/it, CE=6.633649e-01 H=6.647747e-01 dV_dx=6.801138e-06 dV_dθ=1.402963e-03 ||∇||=7.210530e-01 | Tr=0.6748 Te/Cur=0.6853 Te/Exp=0.7941] 33%|███▎      | 6/18 [00:36<01:00,  5.05s/it, CE=6.477910e-01 H=6.488655e-01 dV_dx=1.870728e-05 dV_dθ=1.055752e-03 ||∇||=7.044514e-01 | Tr=0.6953]                             39%|███▉      | 7/18 [00:36<00:52,  4.81s/it, CE=6.477910e-01 H=6.488655e-01 dV_dx=1.870728e-05 dV_dθ=1.055752e-03 ||∇||=7.044514e-01 | Tr=0.6953] 39%|███▉      | 7/18 [00:40<00:52,  4.81s/it, CE=6.342757e-01 H=6.350504e-01 dV_dx=1.708524e-07 dV_dθ=7.745632e-04 ||∇||=6.927769e-01 | Tr=0.7119] 44%|████▍     | 8/18 [00:40<00:47,  4.72s/it, CE=6.342757e-01 H=6.350504e-01 dV_dx=1.708524e-07 dV_dθ=7.745632e-04 ||∇||=6.927769e-01 | Tr=0.7119] 44%|████▍     | 8/18 [00:44<00:47,  4.72s/it, CE=6.227545e-01 H=6.232992e-01 dV_dx=-2.842294e-05 dV_dθ=5.731174e-04 ||∇||=6.861057e-01 | Tr=0.7257] 50%|█████     | 9/18 [00:44<00:39,  4.44s/it, CE=6.227545e-01 H=6.232992e-01 dV_dx=-2.842294e-05 dV_dθ=5.731174e-04 ||∇||=6.861057e-01 | Tr=0.7257] 50%|█████     | 9/18 [00:48<00:39,  4.44s/it, CE=6.129328e-01 H=6.133575e-01 dV_dx=6.227353e-06 dV_dθ=4.184026e-04 ||∇||=6.844586e-01 | Tr=0.7388]  56%|█████▌    | 10/18 [00:48<00:34,  4.34s/it, CE=6.129328e-01 H=6.133575e-01 dV_dx=6.227353e-06 dV_dθ=4.184026e-04 ||∇||=6.844586e-01 | Tr=0.7388] 56%|█████▌    | 10/18 [00:54<00:34,  4.34s/it, CE=6.045602e-01 H=6.048349e-01 dV_dx=-2.638339e-05 dV_dθ=3.010162e-04 ||∇||=6.820092e-01 | Tr=0.7495 Te/Cur=0.7563 Te/Exp=0.7998] 61%|██████    | 11/18 [00:54<00:32,  4.63s/it, CE=6.045602e-01 H=6.048349e-01 dV_dx=-2.638339e-05 dV_dθ=3.010162e-04 ||∇||=6.820092e-01 | Tr=0.7495 Te/Cur=0.7563 Te/Exp=0.7998] 61%|██████    | 11/18 [00:58<00:32,  4.63s/it, CE=5.968926e-01 H=5.971227e-01 dV_dx=8.697690e-06 dV_dθ=2.214157e-04 ||∇||=6.753276e-01 | Tr=0.7592]                              67%|██████▋   | 12/18 [00:58<00:26,  4.47s/it, CE=5.968926e-01 H=5.971227e-01 dV_dx=8.697690e-06 dV_dθ=2.214157e-04 ||∇||=6.753276e-01 | Tr=0.7592] 67%|██████▋   | 12/18 [01:02<00:26,  4.47s/it, CE=5.894593e-01 H=5.896366e-01 dV_dx=2.953588e-05 dV_dθ=1.477622e-04 ||∇||=6.724834e-01 | Tr=0.7668] 72%|███████▏  | 13/18 [01:02<00:22,  4.54s/it, CE=5.894593e-01 H=5.896366e-01 dV_dx=2.953588e-05 dV_dθ=1.477622e-04 ||∇||=6.724834e-01 | Tr=0.7668] 72%|███████▏  | 13/18 [01:07<00:22,  4.54s/it, CE=5.826637e-01 H=5.827424e-01 dV_dx=-8.324481e-06 dV_dθ=8.699277e-05 ||∇||=6.701624e-01 | Tr=0.7745] 78%|███████▊  | 14/18 [01:07<00:17,  4.49s/it, CE=5.826637e-01 H=5.827424e-01 dV_dx=-8.324481e-06 dV_dθ=8.699277e-05 ||∇||=6.701624e-01 | Tr=0.7745] 78%|███████▊  | 14/18 [01:11<00:17,  4.49s/it, CE=5.761592e-01 H=5.761813e-01 dV_dx=-2.009839e-05 dV_dθ=4.222135e-05 ||∇||=6.670662e-01 | Tr=0.7803] 83%|████████▎ | 15/18 [01:11<00:13,  4.35s/it, CE=5.761592e-01 H=5.761813e-01 dV_dx=-2.009839e-05 dV_dθ=4.222135e-05 ||∇||=6.670662e-01 | Tr=0.7803] 83%|████████▎ | 15/18 [01:18<00:13,  4.35s/it, CE=5.698535e-01 H=5.698678e-01 dV_dx=1.402418e-05 dV_dθ=2.662848e-07 ||∇||=6.644634e-01 | Tr=0.7862 Te/Cur=0.7833 Te/Exp=0.8132] 89%|████████▉ | 16/18 [01:18<00:10,  5.05s/it, CE=5.698535e-01 H=5.698678e-01 dV_dx=1.402418e-05 dV_dθ=2.662848e-07 ||∇||=6.644634e-01 | Tr=0.7862 Te/Cur=0.7833 Te/Exp=0.8132] 89%|████████▉ | 16/18 [01:22<00:10,  5.05s/it, CE=5.637894e-01 H=5.637887e-01 dV_dx=3.554082e-05 dV_dθ=-3.623403e-05 ||∇||=6.644469e-01 | Tr=0.7916]                            94%|█████████▍| 17/18 [01:22<00:04,  4.98s/it, CE=5.637894e-01 H=5.637887e-01 dV_dx=3.554082e-05 dV_dθ=-3.623403e-05 ||∇||=6.644469e-01 | Tr=0.7916] 94%|█████████▍| 17/18 [01:28<00:04,  4.98s/it, CE=5.581664e-01 H=5.581088e-01 dV_dx=3.208167e-07 dV_dθ=-5.790349e-05 ||∇||=6.619668e-01 | Tr=0.7972 Te/Cur=0.7960 Te/Exp=0.8146]100%|██████████| 18/18 [01:28<00:00,  5.26s/it, CE=5.581664e-01 H=5.581088e-01 dV_dx=3.208167e-07 dV_dθ=-5.790349e-05 ||∇||=6.619668e-01 | Tr=0.7972 Te/Cur=0.7960 Te/Exp=0.8146]100%|██████████| 18/18 [01:28<00:00,  4.93s/it, CE=5.581664e-01 H=5.581088e-01 dV_dx=3.208167e-07 dV_dθ=-5.790349e-05 ||∇||=6.619668e-01 | Tr=0.7972 Te/Cur=0.7960 Te/Exp=0.8146]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.7121
    Task 1: 0.9197
    Task 2: 0.7952

============================================================
Task 3
============================================================
Initial loss on new task: 4.2372, previous: 0.5582, ratio: 7.59
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=7.59)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.17s/it] 50%|█████     | 1/2 [00:13<00:08,  8.17s/it, CE=4.237109e+00 H=3.684011e+00 dV_dx=1.078945e-06 dV_dθ=-5.530989e-01 ||∇||=1.732553e+01 | Tr=0.1198 Te/Cur=0.1254 Te/Exp=0.8066]100%|██████████| 2/2 [00:13<00:00,  6.40s/it, CE=4.237109e+00 H=3.684011e+00 dV_dx=1.078945e-06 dV_dθ=-5.530989e-01 ||∇||=1.732553e+01 | Tr=0.1198 Te/Cur=0.1254 Te/Exp=0.8066]100%|██████████| 2/2 [00:13<00:00,  6.67s/it, CE=4.237109e+00 H=3.684011e+00 dV_dx=1.078945e-06 dV_dθ=-5.530989e-01 ||∇||=1.732553e+01 | Tr=0.1198 Te/Cur=0.1254 Te/Exp=0.8066]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:10<02:56, 10.36s/it]  6%|▌         | 1/18 [00:14<02:56, 10.36s/it, CE=6.909962e-01 H=6.930592e-01 dV_dx=7.921906e-06 dV_dθ=2.055022e-03 ||∇||=8.056220e-01 | Tr=0.3667] 11%|█         | 2/18 [00:14<01:50,  6.91s/it, CE=6.909962e-01 H=6.930592e-01 dV_dx=7.921906e-06 dV_dθ=2.055022e-03 ||∇||=8.056220e-01 | Tr=0.3667] 11%|█         | 2/18 [00:19<01:50,  6.91s/it, CE=6.479103e-01 H=6.486004e-01 dV_dx=1.117848e-05 dV_dθ=6.788589e-04 ||∇||=7.614207e-01 | Tr=0.4029] 17%|█▋        | 3/18 [00:19<01:28,  5.91s/it, CE=6.479103e-01 H=6.486004e-01 dV_dx=1.117848e-05 dV_dθ=6.788589e-04 ||∇||=7.614207e-01 | Tr=0.4029] 17%|█▋        | 3/18 [00:23<01:28,  5.91s/it, CE=6.288125e-01 H=6.290548e-01 dV_dx=4.909020e-05 dV_dθ=1.932270e-04 ||∇||=7.373123e-01 | Tr=0.4322] 22%|██▏       | 4/18 [00:23<01:13,  5.28s/it, CE=6.288125e-01 H=6.290548e-01 dV_dx=4.909020e-05 dV_dθ=1.932270e-04 ||∇||=7.373123e-01 | Tr=0.4322] 22%|██▏       | 4/18 [00:28<01:13,  5.28s/it, CE=6.154778e-01 H=6.154879e-01 dV_dx=1.264704e-05 dV_dθ=-2.530725e-06 ||∇||=7.180512e-01 | Tr=0.4554] 28%|██▊       | 5/18 [00:28<01:05,  5.01s/it, CE=6.154778e-01 H=6.154879e-01 dV_dx=1.264704e-05 dV_dθ=-2.530725e-06 ||∇||=7.180512e-01 | Tr=0.4554] 28%|██▊       | 5/18 [00:33<01:05,  5.01s/it, CE=6.046784e-01 H=6.046329e-01 dV_dx=5.424028e-05 dV_dθ=-9.979254e-05 ||∇||=7.068875e-01 | Tr=0.4748 Te/Cur=0.4740 Te/Exp=0.8063] 33%|███▎      | 6/18 [00:33<01:01,  5.12s/it, CE=6.046784e-01 H=6.046329e-01 dV_dx=5.424028e-05 dV_dθ=-9.979254e-05 ||∇||=7.068875e-01 | Tr=0.4748 Te/Cur=0.4740 Te/Exp=0.8063] 33%|███▎      | 6/18 [00:38<01:01,  5.12s/it, CE=5.955442e-01 H=5.953489e-01 dV_dx=-3.260022e-05 dV_dθ=-1.627504e-04 ||∇||=7.012291e-01 | Tr=0.4903]                            39%|███▉      | 7/18 [00:38<00:54,  4.91s/it, CE=5.955442e-01 H=5.953489e-01 dV_dx=-3.260022e-05 dV_dθ=-1.627504e-04 ||∇||=7.012291e-01 | Tr=0.4903] 39%|███▉      | 7/18 [00:43<00:54,  4.91s/it, CE=5.877933e-01 H=5.875569e-01 dV_dx=-4.121499e-05 dV_dθ=-1.952039e-04 ||∇||=6.968551e-01 | Tr=0.5005] 44%|████▍     | 8/18 [00:43<00:49,  4.99s/it, CE=5.877933e-01 H=5.875569e-01 dV_dx=-4.121499e-05 dV_dθ=-1.952039e-04 ||∇||=6.968551e-01 | Tr=0.5005] 44%|████▍     | 8/18 [00:47<00:49,  4.99s/it, CE=5.811451e-01 H=5.809342e-01 dV_dx=1.191248e-07 dV_dθ=-2.110781e-04 ||∇||=6.949769e-01 | Tr=0.5081]  50%|█████     | 9/18 [00:47<00:43,  4.79s/it, CE=5.811451e-01 H=5.809342e-01 dV_dx=1.191248e-07 dV_dθ=-2.110781e-04 ||∇||=6.949769e-01 | Tr=0.5081] 50%|█████     | 9/18 [00:51<00:43,  4.79s/it, CE=5.750811e-01 H=5.748040e-01 dV_dx=-3.585460e-05 dV_dθ=-2.412349e-04 ||∇||=6.995858e-01 | Tr=0.5148] 56%|█████▌    | 10/18 [00:51<00:36,  4.60s/it, CE=5.750811e-01 H=5.748040e-01 dV_dx=-3.585460e-05 dV_dθ=-2.412349e-04 ||∇||=6.995858e-01 | Tr=0.5148] 56%|█████▌    | 10/18 [00:57<00:36,  4.60s/it, CE=5.689316e-01 H=5.686501e-01 dV_dx=-1.984077e-05 dV_dθ=-2.617007e-04 ||∇||=7.038455e-01 | Tr=0.5191 Te/Cur=0.5148 Te/Exp=0.8142] 61%|██████    | 11/18 [00:57<00:35,  5.05s/it, CE=5.689316e-01 H=5.686501e-01 dV_dx=-1.984077e-05 dV_dθ=-2.617007e-04 ||∇||=7.038455e-01 | Tr=0.5191 Te/Cur=0.5148 Te/Exp=0.8142] 61%|██████    | 11/18 [01:01<00:35,  5.05s/it, CE=5.633142e-01 H=5.630509e-01 dV_dx=1.482931e-05 dV_dθ=-2.780722e-04 ||∇||=7.090158e-01 | Tr=0.5242]                              67%|██████▋   | 12/18 [01:01<00:28,  4.69s/it, CE=5.633142e-01 H=5.630509e-01 dV_dx=1.482931e-05 dV_dθ=-2.780722e-04 ||∇||=7.090158e-01 | Tr=0.5242] 67%|██████▋   | 12/18 [01:06<00:28,  4.69s/it, CE=5.580997e-01 H=5.577608e-01 dV_dx=-4.578128e-05 dV_dθ=-2.931417e-04 ||∇||=7.160365e-01 | Tr=0.5284] 72%|███████▏  | 13/18 [01:06<00:22,  4.58s/it, CE=5.580997e-01 H=5.577608e-01 dV_dx=-4.578128e-05 dV_dθ=-2.931417e-04 ||∇||=7.160365e-01 | Tr=0.5284] 72%|███████▏  | 13/18 [01:10<00:22,  4.58s/it, CE=5.532736e-01 H=5.529166e-01 dV_dx=-4.441392e-05 dV_dθ=-3.125723e-04 ||∇||=7.247086e-01 | Tr=0.5329] 78%|███████▊  | 14/18 [01:10<00:17,  4.49s/it, CE=5.532736e-01 H=5.529166e-01 dV_dx=-4.441392e-05 dV_dθ=-3.125723e-04 ||∇||=7.247086e-01 | Tr=0.5329] 78%|███████▊  | 14/18 [01:13<00:17,  4.49s/it, CE=5.487135e-01 H=5.484017e-01 dV_dx=1.473314e-05 dV_dθ=-3.265346e-04 ||∇||=7.318401e-01 | Tr=0.5364]  83%|████████▎ | 15/18 [01:13<00:12,  4.20s/it, CE=5.487135e-01 H=5.484017e-01 dV_dx=1.473314e-05 dV_dθ=-3.265346e-04 ||∇||=7.318401e-01 | Tr=0.5364] 83%|████████▎ | 15/18 [01:19<00:12,  4.20s/it, CE=5.443570e-01 H=5.439998e-01 dV_dx=-2.256648e-05 dV_dθ=-3.346736e-04 ||∇||=7.361634e-01 | Tr=0.5398 Te/Cur=0.5358 Te/Exp=0.8108] 89%|████████▉ | 16/18 [01:19<00:09,  4.62s/it, CE=5.443570e-01 H=5.439998e-01 dV_dx=-2.256648e-05 dV_dθ=-3.346736e-04 ||∇||=7.361634e-01 | Tr=0.5398 Te/Cur=0.5358 Te/Exp=0.8108] 89%|████████▉ | 16/18 [01:24<00:09,  4.62s/it, CE=5.401660e-01 H=5.398349e-01 dV_dx=1.644022e-05 dV_dθ=-3.474928e-04 ||∇||=7.435143e-01 | Tr=0.5429]                              94%|█████████▍| 17/18 [01:24<00:04,  4.57s/it, CE=5.401660e-01 H=5.398349e-01 dV_dx=1.644022e-05 dV_dθ=-3.474928e-04 ||∇||=7.435143e-01 | Tr=0.5429] 94%|█████████▍| 17/18 [01:30<00:04,  4.57s/it, CE=5.360901e-01 H=5.357676e-01 dV_dx=3.388023e-05 dV_dθ=-3.563842e-04 ||∇||=7.490835e-01 | Tr=0.5460 Te/Cur=0.5376 Te/Exp=0.8246]100%|██████████| 18/18 [01:30<00:00,  5.07s/it, CE=5.360901e-01 H=5.357676e-01 dV_dx=3.388023e-05 dV_dθ=-3.563842e-04 ||∇||=7.490835e-01 | Tr=0.5460 Te/Cur=0.5376 Te/Exp=0.8246]100%|██████████| 18/18 [01:30<00:00,  5.02s/it, CE=5.360901e-01 H=5.357676e-01 dV_dx=3.388023e-05 dV_dθ=-3.563842e-04 ||∇||=7.490835e-01 | Tr=0.5460 Te/Cur=0.5376 Te/Exp=0.8246]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.7316
    Task 1: 0.9283
    Task 2: 0.8040
    Task 3: 0.5395

============================================================
Task 4
============================================================
Initial loss on new task: 1.1730, previous: 0.5361, ratio: 2.19
Standard CL training (lr=0.000078, adaptive_lr_min=4.64e-05, loss_ratio=2.19)
  Warmup phase: 2 epochs at lr=7.79e-08
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.25s/it] 50%|█████     | 1/2 [00:14<00:08,  8.25s/it, CE=1.163153e+00 H=1.105472e+00 dV_dx=2.584178e-06 dV_dθ=-5.768339e-02 ||∇||=5.721262e+00 | Tr=0.6827 Te/Cur=0.6744 Te/Exp=0.7497]100%|██████████| 2/2 [00:14<00:00,  6.92s/it, CE=1.163153e+00 H=1.105472e+00 dV_dx=2.584178e-06 dV_dθ=-5.768339e-02 ||∇||=5.721262e+00 | Tr=0.6827 Te/Cur=0.6744 Te/Exp=0.7497]100%|██████████| 2/2 [00:14<00:00,  7.12s/it, CE=1.163153e+00 H=1.105472e+00 dV_dx=2.584178e-06 dV_dθ=-5.768339e-02 ||∇||=5.721262e+00 | Tr=0.6827 Te/Cur=0.6744 Te/Exp=0.7497]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=7.79e-05
    Using experience replay
    Adaptive grad weights: [0.63, 0.27, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:13, 11.40s/it]  6%|▌         | 1/18 [00:14<03:13, 11.40s/it, CE=7.737308e-01 H=7.737159e-01 dV_dx=-4.767102e-07 dV_dθ=-1.445925e-05 ||∇||=7.518029e-01 | Tr=0.8660] 11%|█         | 2/18 [00:14<01:46,  6.64s/it, CE=7.737308e-01 H=7.737159e-01 dV_dx=-4.767102e-07 dV_dθ=-1.445925e-05 ||∇||=7.518029e-01 | Tr=0.8660] 11%|█         | 2/18 [00:18<01:46,  6.64s/it, CE=7.711097e-01 H=7.710142e-01 dV_dx=8.222544e-06 dV_dθ=-1.037546e-04 ||∇||=6.817918e-01 | Tr=0.8828]  17%|█▋        | 3/18 [00:18<01:21,  5.43s/it, CE=7.711097e-01 H=7.710142e-01 dV_dx=8.222544e-06 dV_dθ=-1.037546e-04 ||∇||=6.817918e-01 | Tr=0.8828] 17%|█▋        | 3/18 [00:22<01:21,  5.43s/it, CE=7.676295e-01 H=7.674502e-01 dV_dx=-4.532984e-05 dV_dθ=-1.339895e-04 ||∇||=6.507065e-01 | Tr=0.8939] 22%|██▏       | 4/18 [00:22<01:09,  4.96s/it, CE=7.676295e-01 H=7.674502e-01 dV_dx=-4.532984e-05 dV_dθ=-1.339895e-04 ||∇||=6.507065e-01 | Tr=0.8939] 22%|██▏       | 4/18 [00:27<01:09,  4.96s/it, CE=7.635531e-01 H=7.634664e-01 dV_dx=6.148726e-05 dV_dθ=-1.481721e-04 ||∇||=6.325484e-01 | Tr=0.9017]  28%|██▊       | 5/18 [00:27<01:01,  4.71s/it, CE=7.635531e-01 H=7.634664e-01 dV_dx=6.148726e-05 dV_dθ=-1.481721e-04 ||∇||=6.325484e-01 | Tr=0.9017] 28%|██▊       | 5/18 [00:32<01:01,  4.71s/it, CE=7.593645e-01 H=7.592323e-01 dV_dx=1.910624e-05 dV_dθ=-1.513300e-04 ||∇||=6.176454e-01 | Tr=0.9078 Te/Cur=0.9113 Te/Exp=0.7465] 33%|███▎      | 6/18 [00:32<00:59,  4.96s/it, CE=7.593645e-01 H=7.592323e-01 dV_dx=1.910624e-05 dV_dθ=-1.513300e-04 ||∇||=6.176454e-01 | Tr=0.9078 Te/Cur=0.9113 Te/Exp=0.7465] 33%|███▎      | 6/18 [00:36<00:59,  4.96s/it, CE=7.549642e-01 H=7.548571e-01 dV_dx=4.123404e-05 dV_dθ=-1.483035e-04 ||∇||=6.046017e-01 | Tr=0.9123]                             39%|███▉      | 7/18 [00:36<00:50,  4.55s/it, CE=7.549642e-01 H=7.548571e-01 dV_dx=4.123404e-05 dV_dθ=-1.483035e-04 ||∇||=6.046017e-01 | Tr=0.9123] 39%|███▉      | 7/18 [00:41<00:50,  4.55s/it, CE=7.507173e-01 H=7.505394e-01 dV_dx=-3.142916e-05 dV_dθ=-1.464339e-04 ||∇||=5.935645e-01 | Tr=0.9167] 44%|████▍     | 8/18 [00:41<00:45,  4.59s/it, CE=7.507173e-01 H=7.505394e-01 dV_dx=-3.142916e-05 dV_dθ=-1.464339e-04 ||∇||=5.935645e-01 | Tr=0.9167] 44%|████▍     | 8/18 [00:45<00:45,  4.59s/it, CE=7.465438e-01 H=7.463977e-01 dV_dx=1.637887e-06 dV_dθ=-1.477092e-04 ||∇||=5.852152e-01 | Tr=0.9200]  50%|█████     | 9/18 [00:45<00:40,  4.45s/it, CE=7.465438e-01 H=7.463977e-01 dV_dx=1.637887e-06 dV_dθ=-1.477092e-04 ||∇||=5.852152e-01 | Tr=0.9200] 50%|█████     | 9/18 [00:49<00:40,  4.45s/it, CE=7.424557e-01 H=7.423566e-01 dV_dx=4.907784e-05 dV_dθ=-1.481314e-04 ||∇||=5.786473e-01 | Tr=0.9233] 56%|█████▌    | 10/18 [00:49<00:34,  4.37s/it, CE=7.424557e-01 H=7.423566e-01 dV_dx=4.907784e-05 dV_dθ=-1.481314e-04 ||∇||=5.786473e-01 | Tr=0.9233] 56%|█████▌    | 10/18 [00:55<00:34,  4.37s/it, CE=7.384615e-01 H=7.383152e-01 dV_dx=1.690757e-07 dV_dθ=-1.465199e-04 ||∇||=5.712139e-01 | Tr=0.9263 Te/Cur=0.9251 Te/Exp=0.7490] 61%|██████    | 11/18 [00:55<00:35,  5.02s/it, CE=7.384615e-01 H=7.383152e-01 dV_dx=1.690757e-07 dV_dθ=-1.465199e-04 ||∇||=5.712139e-01 | Tr=0.9263 Te/Cur=0.9251 Te/Exp=0.7490] 61%|██████    | 11/18 [01:00<00:35,  5.02s/it, CE=7.346065e-01 H=7.344258e-01 dV_dx=-3.423219e-05 dV_dθ=-1.464136e-04 ||∇||=5.657939e-01 | Tr=0.9290]                            67%|██████▋   | 12/18 [01:00<00:29,  4.87s/it, CE=7.346065e-01 H=7.344258e-01 dV_dx=-3.423219e-05 dV_dθ=-1.464136e-04 ||∇||=5.657939e-01 | Tr=0.9290] 67%|██████▋   | 12/18 [01:05<00:29,  4.87s/it, CE=7.308031e-01 H=7.306645e-01 dV_dx=1.078959e-05 dV_dθ=-1.493902e-04 ||∇||=5.612823e-01 | Tr=0.9315]  72%|███████▏  | 13/18 [01:05<00:24,  4.90s/it, CE=7.308031e-01 H=7.306645e-01 dV_dx=1.078959e-05 dV_dθ=-1.493902e-04 ||∇||=5.612823e-01 | Tr=0.9315] 72%|███████▏  | 13/18 [01:10<00:24,  4.90s/it, CE=7.270520e-01 H=7.268939e-01 dV_dx=-9.436655e-06 dV_dθ=-1.486389e-04 ||∇||=5.563924e-01 | Tr=0.9335] 78%|███████▊  | 14/18 [01:10<00:19,  4.88s/it, CE=7.270520e-01 H=7.268939e-01 dV_dx=-9.436655e-06 dV_dθ=-1.486389e-04 ||∇||=5.563924e-01 | Tr=0.9335] 78%|███████▊  | 14/18 [01:14<00:19,  4.88s/it, CE=7.234077e-01 H=7.232321e-01 dV_dx=-2.618731e-05 dV_dθ=-1.493561e-04 ||∇||=5.521549e-01 | Tr=0.9355] 83%|████████▎ | 15/18 [01:14<00:14,  4.67s/it, CE=7.234077e-01 H=7.232321e-01 dV_dx=-2.618731e-05 dV_dθ=-1.493561e-04 ||∇||=5.521549e-01 | Tr=0.9355] 83%|████████▎ | 15/18 [01:20<00:14,  4.67s/it, CE=7.198546e-01 H=7.197059e-01 dV_dx=1.460004e-06 dV_dθ=-1.501070e-04 ||∇||=5.480279e-01 | Tr=0.9369 Te/Cur=0.9357 Te/Exp=0.7597] 89%|████████▉ | 16/18 [01:20<00:10,  5.11s/it, CE=7.198546e-01 H=7.197059e-01 dV_dx=1.460004e-06 dV_dθ=-1.501070e-04 ||∇||=5.480279e-01 | Tr=0.9369 Te/Cur=0.9357 Te/Exp=0.7597] 89%|████████▉ | 16/18 [01:24<00:10,  5.11s/it, CE=7.163999e-01 H=7.161995e-01 dV_dx=-4.942800e-05 dV_dθ=-1.509060e-04 ||∇||=5.445531e-01 | Tr=0.9386]                            94%|█████████▍| 17/18 [01:24<00:04,  4.88s/it, CE=7.163999e-01 H=7.161995e-01 dV_dx=-4.942800e-05 dV_dθ=-1.509060e-04 ||∇||=5.445531e-01 | Tr=0.9386] 94%|█████████▍| 17/18 [01:31<00:04,  4.88s/it, CE=7.130223e-01 H=7.128532e-01 dV_dx=-1.948025e-05 dV_dθ=-1.495300e-04 ||∇||=5.407668e-01 | Tr=0.9400 Te/Cur=0.9350 Te/Exp=0.7496]100%|██████████| 18/18 [01:31<00:00,  5.50s/it, CE=7.130223e-01 H=7.128532e-01 dV_dx=-1.948025e-05 dV_dθ=-1.495300e-04 ||∇||=5.407668e-01 | Tr=0.9400 Te/Cur=0.9350 Te/Exp=0.7496]100%|██████████| 18/18 [01:31<00:00,  5.10s/it, CE=7.130223e-01 H=7.128532e-01 dV_dx=-1.948025e-05 dV_dθ=-1.495300e-04 ||∇||=5.407668e-01 | Tr=0.9400 Te/Cur=0.9350 Te/Exp=0.7496]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7465
    Task 1: 0.9137
    Task 2: 0.8179
    Task 3: 0.5394
    Task 4: 0.9367

============================================================
Task 5
============================================================
Initial loss on new task: 6.8503, previous: 0.7130, ratio: 9.61
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=9.61)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.54s/it] 50%|█████     | 1/2 [00:12<00:08,  8.54s/it, CE=6.909566e+00 H=5.099455e+00 dV_dx=2.017504e-06 dV_dθ=-1.810113e+00 ||∇||=3.139385e+01 | Tr=0.1273 Te/Cur=0.1193 Te/Exp=0.7913]100%|██████████| 2/2 [00:12<00:00,  5.86s/it, CE=6.909566e+00 H=5.099455e+00 dV_dx=2.017504e-06 dV_dθ=-1.810113e+00 ||∇||=3.139385e+01 | Tr=0.1273 Te/Cur=0.1193 Te/Exp=0.7913]100%|██████████| 2/2 [00:12<00:00,  6.26s/it, CE=6.909566e+00 H=5.099455e+00 dV_dx=2.017504e-06 dV_dθ=-1.810113e+00 ||∇||=3.139385e+01 | Tr=0.1273 Te/Cur=0.1193 Te/Exp=0.7913]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:12, 11.30s/it]  6%|▌         | 1/18 [00:15<03:12, 11.30s/it, CE=7.285831e-01 H=7.293928e-01 dV_dx=3.152716e-05 dV_dθ=7.781227e-04 ||∇||=1.601509e+00 | Tr=0.5997] 11%|█         | 2/18 [00:15<01:55,  7.22s/it, CE=7.285831e-01 H=7.293928e-01 dV_dx=3.152716e-05 dV_dθ=7.781227e-04 ||∇||=1.601509e+00 | Tr=0.5997] 11%|█         | 2/18 [00:18<01:55,  7.22s/it, CE=7.044276e-01 H=7.044102e-01 dV_dx=-5.273708e-05 dV_dθ=3.534236e-05 ||∇||=1.132107e+00 | Tr=0.7280] 17%|█▋        | 3/18 [00:18<01:18,  5.26s/it, CE=7.044276e-01 H=7.044102e-01 dV_dx=-5.273708e-05 dV_dθ=3.534236e-05 ||∇||=1.132107e+00 | Tr=0.7280] 17%|█▋        | 3/18 [00:23<01:18,  5.26s/it, CE=6.935385e-01 H=6.934270e-01 dV_dx=-9.687252e-06 dV_dθ=-1.017905e-04 ||∇||=9.546721e-01 | Tr=0.7952] 22%|██▏       | 4/18 [00:23<01:11,  5.11s/it, CE=6.935385e-01 H=6.934270e-01 dV_dx=-9.687252e-06 dV_dθ=-1.017905e-04 ||∇||=9.546721e-01 | Tr=0.7952] 22%|██▏       | 4/18 [00:27<01:11,  5.11s/it, CE=6.848152e-01 H=6.847040e-01 dV_dx=7.902244e-06 dV_dθ=-1.191256e-04 ||∇||=8.494937e-01 | Tr=0.8340]  28%|██▊       | 5/18 [00:27<01:02,  4.82s/it, CE=6.848152e-01 H=6.847040e-01 dV_dx=7.902244e-06 dV_dθ=-1.191256e-04 ||∇||=8.494937e-01 | Tr=0.8340] 28%|██▊       | 5/18 [00:33<01:02,  4.82s/it, CE=6.768494e-01 H=6.767551e-01 dV_dx=2.587127e-05 dV_dθ=-1.201084e-04 ||∇||=7.823728e-01 | Tr=0.8582 Te/Cur=0.8595 Te/Exp=0.7704] 33%|███▎      | 6/18 [00:33<01:03,  5.27s/it, CE=6.768494e-01 H=6.767551e-01 dV_dx=2.587127e-05 dV_dθ=-1.201084e-04 ||∇||=7.823728e-01 | Tr=0.8582 Te/Cur=0.8595 Te/Exp=0.7704] 33%|███▎      | 6/18 [00:37<01:03,  5.27s/it, CE=6.698656e-01 H=6.696962e-01 dV_dx=-4.715292e-05 dV_dθ=-1.222170e-04 ||∇||=7.404609e-01 | Tr=0.8749]                            39%|███▉      | 7/18 [00:37<00:53,  4.84s/it, CE=6.698656e-01 H=6.696962e-01 dV_dx=-4.715292e-05 dV_dθ=-1.222170e-04 ||∇||=7.404609e-01 | Tr=0.8749] 39%|███▉      | 7/18 [00:41<00:53,  4.84s/it, CE=6.633324e-01 H=6.632025e-01 dV_dx=-1.138719e-06 dV_dθ=-1.287118e-04 ||∇||=7.127114e-01 | Tr=0.8872] 44%|████▍     | 8/18 [00:41<00:46,  4.61s/it, CE=6.633324e-01 H=6.632025e-01 dV_dx=-1.138719e-06 dV_dθ=-1.287118e-04 ||∇||=7.127114e-01 | Tr=0.8872] 44%|████▍     | 8/18 [00:45<00:46,  4.61s/it, CE=6.574626e-01 H=6.573623e-01 dV_dx=3.305397e-05 dV_dθ=-1.333579e-04 ||∇||=6.915188e-01 | Tr=0.8953]  50%|█████     | 9/18 [00:45<00:39,  4.40s/it, CE=6.574626e-01 H=6.573623e-01 dV_dx=3.305397e-05 dV_dθ=-1.333579e-04 ||∇||=6.915188e-01 | Tr=0.8953] 50%|█████     | 9/18 [00:50<00:39,  4.40s/it, CE=6.522848e-01 H=6.521739e-01 dV_dx=2.583654e-05 dV_dθ=-1.367399e-04 ||∇||=6.742068e-01 | Tr=0.9018] 56%|█████▌    | 10/18 [00:50<00:35,  4.45s/it, CE=6.522848e-01 H=6.521739e-01 dV_dx=2.583654e-05 dV_dθ=-1.367399e-04 ||∇||=6.742068e-01 | Tr=0.9018] 56%|█████▌    | 10/18 [00:57<00:35,  4.45s/it, CE=6.476680e-01 H=6.475619e-01 dV_dx=3.170448e-05 dV_dθ=-1.377305e-04 ||∇||=6.609389e-01 | Tr=0.9075 Te/Cur=0.9027 Te/Exp=0.7820] 61%|██████    | 11/18 [00:57<00:36,  5.16s/it, CE=6.476680e-01 H=6.475619e-01 dV_dx=3.170448e-05 dV_dθ=-1.377305e-04 ||∇||=6.609389e-01 | Tr=0.9075 Te/Cur=0.9027 Te/Exp=0.7820] 61%|██████    | 11/18 [01:01<00:36,  5.16s/it, CE=6.434624e-01 H=6.432443e-01 dV_dx=-8.633489e-05 dV_dθ=-1.317243e-04 ||∇||=6.477289e-01 | Tr=0.9119]                            67%|██████▋   | 12/18 [01:01<00:29,  4.97s/it, CE=6.434624e-01 H=6.432443e-01 dV_dx=-8.633489e-05 dV_dθ=-1.317243e-04 ||∇||=6.477289e-01 | Tr=0.9119] 67%|██████▋   | 12/18 [01:06<00:29,  4.97s/it, CE=6.396406e-01 H=6.394688e-01 dV_dx=-3.927561e-05 dV_dθ=-1.325002e-04 ||∇||=6.387220e-01 | Tr=0.9166] 72%|███████▏  | 13/18 [01:06<00:24,  4.86s/it, CE=6.396406e-01 H=6.394688e-01 dV_dx=-3.927561e-05 dV_dθ=-1.325002e-04 ||∇||=6.387220e-01 | Tr=0.9166] 72%|███████▏  | 13/18 [01:10<00:24,  4.86s/it, CE=6.361590e-01 H=6.360537e-01 dV_dx=2.944691e-05 dV_dθ=-1.347244e-04 ||∇||=6.308777e-01 | Tr=0.9209]  78%|███████▊  | 14/18 [01:10<00:18,  4.72s/it, CE=6.361590e-01 H=6.360537e-01 dV_dx=2.944691e-05 dV_dθ=-1.347244e-04 ||∇||=6.308777e-01 | Tr=0.9209] 78%|███████▊  | 14/18 [01:14<00:18,  4.72s/it, CE=6.329212e-01 H=6.327196e-01 dV_dx=-6.519327e-05 dV_dθ=-1.363893e-04 ||∇||=6.246538e-01 | Tr=0.9244] 83%|████████▎ | 15/18 [01:14<00:13,  4.45s/it, CE=6.329212e-01 H=6.327196e-01 dV_dx=-6.519327e-05 dV_dθ=-1.363893e-04 ||∇||=6.246538e-01 | Tr=0.9244] 83%|████████▎ | 15/18 [01:20<00:13,  4.45s/it, CE=6.298135e-01 H=6.296582e-01 dV_dx=-1.480309e-05 dV_dθ=-1.404758e-04 ||∇||=6.198187e-01 | Tr=0.9276 Te/Cur=0.9252 Te/Exp=0.7898] 89%|████████▉ | 16/18 [01:20<00:09,  4.85s/it, CE=6.298135e-01 H=6.296582e-01 dV_dx=-1.480309e-05 dV_dθ=-1.404758e-04 ||∇||=6.198187e-01 | Tr=0.9276 Te/Cur=0.9252 Te/Exp=0.7898] 89%|████████▉ | 16/18 [01:23<00:09,  4.85s/it, CE=6.268104e-01 H=6.266489e-01 dV_dx=-1.873584e-05 dV_dθ=-1.427620e-04 ||∇||=6.144053e-01 | Tr=0.9308]                             94%|█████████▍| 17/18 [01:23<00:04,  4.47s/it, CE=6.268104e-01 H=6.266489e-01 dV_dx=-1.873584e-05 dV_dθ=-1.427620e-04 ||∇||=6.144053e-01 | Tr=0.9308] 94%|█████████▍| 17/18 [01:30<00:04,  4.47s/it, CE=6.239387e-01 H=6.237148e-01 dV_dx=-7.859690e-05 dV_dθ=-1.453681e-04 ||∇||=6.099702e-01 | Tr=0.9331 Te/Cur=0.9312 Te/Exp=0.7930]100%|██████████| 18/18 [01:30<00:00,  4.93s/it, CE=6.239387e-01 H=6.237148e-01 dV_dx=-7.859690e-05 dV_dθ=-1.453681e-04 ||∇||=6.099702e-01 | Tr=0.9331 Te/Cur=0.9312 Te/Exp=0.7930]100%|██████████| 18/18 [01:30<00:00,  5.00s/it, CE=6.239387e-01 H=6.237148e-01 dV_dx=-7.859690e-05 dV_dθ=-1.453681e-04 ||∇||=6.099702e-01 | Tr=0.9331 Te/Cur=0.9312 Te/Exp=0.7930]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7477
    Task 1: 0.9280
    Task 2: 0.8205
    Task 3: 0.5425
    Task 4: 0.9165
    Task 5: 0.9297

============================================================
Task 6
============================================================
Initial loss on new task: 5.3242, previous: 0.6239, ratio: 8.53
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=8.53)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.70s/it] 50%|█████     | 1/2 [00:14<00:08,  8.70s/it, CE=5.368895e+00 H=3.952084e+00 dV_dx=1.274350e-05 dV_dθ=-1.416824e+00 ||∇||=2.777820e+01 | Tr=0.1995 Te/Cur=0.2005 Te/Exp=0.8062]100%|██████████| 2/2 [00:14<00:00,  6.76s/it, CE=5.368895e+00 H=3.952084e+00 dV_dx=1.274350e-05 dV_dθ=-1.416824e+00 ||∇||=2.777820e+01 | Tr=0.1995 Te/Cur=0.2005 Te/Exp=0.8062]100%|██████████| 2/2 [00:14<00:00,  7.05s/it, CE=5.368895e+00 H=3.952084e+00 dV_dx=1.274350e-05 dV_dθ=-1.416824e+00 ||∇||=2.777820e+01 | Tr=0.1995 Te/Cur=0.2005 Te/Exp=0.8062]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:15, 11.49s/it]  6%|▌         | 1/18 [00:14<03:15, 11.49s/it, CE=6.176839e-01 H=6.177373e-01 dV_dx=2.706226e-05 dV_dθ=2.636402e-05 ||∇||=1.326589e+00 | Tr=0.6744] 11%|█         | 2/18 [00:14<01:47,  6.71s/it, CE=6.176839e-01 H=6.177373e-01 dV_dx=2.706226e-05 dV_dθ=2.636402e-05 ||∇||=1.326589e+00 | Tr=0.6744] 11%|█         | 2/18 [00:19<01:47,  6.71s/it, CE=5.987313e-01 H=5.985179e-01 dV_dx=-1.012423e-04 dV_dθ=-1.120871e-04 ||∇||=9.985299e-01 | Tr=0.7768] 17%|█▋        | 3/18 [00:19<01:23,  5.57s/it, CE=5.987313e-01 H=5.985179e-01 dV_dx=-1.012423e-04 dV_dθ=-1.120871e-04 ||∇||=9.985299e-01 | Tr=0.7768] 17%|█▋        | 3/18 [00:23<01:23,  5.57s/it, CE=5.919355e-01 H=5.917330e-01 dV_dx=5.437188e-07 dV_dθ=-2.030262e-04 ||∇||=9.054991e-01 | Tr=0.8255]  22%|██▏       | 4/18 [00:23<01:09,  4.96s/it, CE=5.919355e-01 H=5.917330e-01 dV_dx=5.437188e-07 dV_dθ=-2.030262e-04 ||∇||=9.054991e-01 | Tr=0.8255] 22%|██▏       | 4/18 [00:27<01:09,  4.96s/it, CE=5.866878e-01 H=5.864185e-01 dV_dx=-2.237708e-05 dV_dθ=-2.469143e-04 ||∇||=8.557352e-01 | Tr=0.8542] 28%|██▊       | 5/18 [00:27<00:59,  4.59s/it, CE=5.866878e-01 H=5.864185e-01 dV_dx=-2.237708e-05 dV_dθ=-2.469143e-04 ||∇||=8.557352e-01 | Tr=0.8542] 28%|██▊       | 5/18 [00:33<00:59,  4.59s/it, CE=5.816776e-01 H=5.814365e-01 dV_dx=2.375674e-05 dV_dθ=-2.649239e-04 ||∇||=8.199874e-01 | Tr=0.8693 Te/Cur=0.8738 Te/Exp=0.8113] 33%|███▎      | 6/18 [00:33<01:04,  5.35s/it, CE=5.816776e-01 H=5.814365e-01 dV_dx=2.375674e-05 dV_dθ=-2.649239e-04 ||∇||=8.199874e-01 | Tr=0.8693 Te/Cur=0.8738 Te/Exp=0.8113] 33%|███▎      | 6/18 [00:38<01:04,  5.35s/it, CE=5.774683e-01 H=5.772164e-01 dV_dx=2.717803e-05 dV_dθ=-2.790146e-04 ||∇||=7.948465e-01 | Tr=0.8816]                             39%|███▉      | 7/18 [00:38<00:57,  5.25s/it, CE=5.774683e-01 H=5.772164e-01 dV_dx=2.717803e-05 dV_dθ=-2.790146e-04 ||∇||=7.948465e-01 | Tr=0.8816] 39%|███▉      | 7/18 [00:43<00:57,  5.25s/it, CE=5.734601e-01 H=5.732208e-01 dV_dx=3.620175e-05 dV_dθ=-2.755287e-04 ||∇||=7.669724e-01 | Tr=0.8908] 44%|████▍     | 8/18 [00:43<00:49,  4.92s/it, CE=5.734601e-01 H=5.732208e-01 dV_dx=3.620175e-05 dV_dθ=-2.755287e-04 ||∇||=7.669724e-01 | Tr=0.8908] 44%|████▍     | 8/18 [00:46<00:49,  4.92s/it, CE=5.694081e-01 H=5.690977e-01 dV_dx=-4.146716e-05 dV_dθ=-2.689000e-04 ||∇||=7.446841e-01 | Tr=0.8982] 50%|█████     | 9/18 [00:46<00:41,  4.58s/it, CE=5.694081e-01 H=5.690977e-01 dV_dx=-4.146716e-05 dV_dθ=-2.689000e-04 ||∇||=7.446841e-01 | Tr=0.8982] 50%|█████     | 9/18 [00:50<00:41,  4.58s/it, CE=5.655216e-01 H=5.652756e-01 dV_dx=1.572350e-05 dV_dθ=-2.618018e-04 ||∇||=7.256168e-01 | Tr=0.9040]  56%|█████▌    | 10/18 [00:50<00:34,  4.32s/it, CE=5.655216e-01 H=5.652756e-01 dV_dx=1.572350e-05 dV_dθ=-2.618018e-04 ||∇||=7.256168e-01 | Tr=0.9040] 56%|█████▌    | 10/18 [00:57<00:34,  4.32s/it, CE=5.617668e-01 H=5.615054e-01 dV_dx=9.512794e-07 dV_dθ=-2.623424e-04 ||∇||=7.113573e-01 | Tr=0.9086 Te/Cur=0.9101 Te/Exp=0.8147] 61%|██████    | 11/18 [00:57<00:35,  5.01s/it, CE=5.617668e-01 H=5.615054e-01 dV_dx=9.512794e-07 dV_dθ=-2.623424e-04 ||∇||=7.113573e-01 | Tr=0.9086 Te/Cur=0.9101 Te/Exp=0.8147] 61%|██████    | 11/18 [01:01<00:35,  5.01s/it, CE=5.581404e-01 H=5.578707e-01 dV_dx=-1.600422e-05 dV_dθ=-2.537566e-04 ||∇||=6.965353e-01 | Tr=0.9132]                            67%|██████▋   | 12/18 [01:01<00:29,  4.86s/it, CE=5.581404e-01 H=5.578707e-01 dV_dx=-1.600422e-05 dV_dθ=-2.537566e-04 ||∇||=6.965353e-01 | Tr=0.9132] 67%|██████▋   | 12/18 [01:05<00:29,  4.86s/it, CE=5.547257e-01 H=5.544943e-01 dV_dx=1.285413e-05 dV_dθ=-2.441829e-04 ||∇||=6.824338e-01 | Tr=0.9167]  72%|███████▏  | 13/18 [01:05<00:22,  4.60s/it, CE=5.547257e-01 H=5.544943e-01 dV_dx=1.285413e-05 dV_dθ=-2.441829e-04 ||∇||=6.824338e-01 | Tr=0.9167] 72%|███████▏  | 13/18 [01:10<00:22,  4.60s/it, CE=5.513527e-01 H=5.510427e-01 dV_dx=-7.134944e-05 dV_dθ=-2.386287e-04 ||∇||=6.712359e-01 | Tr=0.9198] 78%|███████▊  | 14/18 [01:10<00:18,  4.69s/it, CE=5.513527e-01 H=5.510427e-01 dV_dx=-7.134944e-05 dV_dθ=-2.386287e-04 ||∇||=6.712359e-01 | Tr=0.9198] 78%|███████▊  | 14/18 [01:15<00:18,  4.69s/it, CE=5.481312e-01 H=5.478460e-01 dV_dx=-5.338211e-05 dV_dθ=-2.318076e-04 ||∇||=6.610410e-01 | Tr=0.9227] 83%|████████▎ | 15/18 [01:15<00:13,  4.61s/it, CE=5.481312e-01 H=5.478460e-01 dV_dx=-5.338211e-05 dV_dθ=-2.318076e-04 ||∇||=6.610410e-01 | Tr=0.9227] 83%|████████▎ | 15/18 [01:21<00:13,  4.61s/it, CE=5.450673e-01 H=5.448666e-01 dV_dx=2.751404e-05 dV_dθ=-2.282293e-04 ||∇||=6.529832e-01 | Tr=0.9254 Te/Cur=0.9248 Te/Exp=0.8144] 89%|████████▉ | 16/18 [01:21<00:10,  5.08s/it, CE=5.450673e-01 H=5.448666e-01 dV_dx=2.751404e-05 dV_dθ=-2.282293e-04 ||∇||=6.529832e-01 | Tr=0.9254 Te/Cur=0.9248 Te/Exp=0.8144] 89%|████████▉ | 16/18 [01:25<00:10,  5.08s/it, CE=5.421142e-01 H=5.418904e-01 dV_dx=-2.612548e-06 dV_dθ=-2.211762e-04 ||∇||=6.435765e-01 | Tr=0.9278]                            94%|█████████▍| 17/18 [01:25<00:04,  4.75s/it, CE=5.421142e-01 H=5.418904e-01 dV_dx=-2.612548e-06 dV_dθ=-2.211762e-04 ||∇||=6.435765e-01 | Tr=0.9278] 94%|█████████▍| 17/18 [01:30<00:04,  4.75s/it, CE=5.392587e-01 H=5.390235e-01 dV_dx=-1.953320e-05 dV_dθ=-2.156457e-04 ||∇||=6.356660e-01 | Tr=0.9301 Te/Cur=0.9317 Te/Exp=0.8126]100%|██████████| 18/18 [01:30<00:00,  4.88s/it, CE=5.392587e-01 H=5.390235e-01 dV_dx=-1.953320e-05 dV_dθ=-2.156457e-04 ||∇||=6.356660e-01 | Tr=0.9301 Te/Cur=0.9317 Te/Exp=0.8126]100%|██████████| 18/18 [01:30<00:00,  5.02s/it, CE=5.392587e-01 H=5.390235e-01 dV_dx=-1.953320e-05 dV_dθ=-2.156457e-04 ||∇||=6.356660e-01 | Tr=0.9301 Te/Cur=0.9317 Te/Exp=0.8126]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7642
    Task 1: 0.9405
    Task 2: 0.8237
    Task 3: 0.5416
    Task 4: 0.9307
    Task 5: 0.9051
    Task 6: 0.9304

============================================================
Task 7
============================================================
Initial loss on new task: 6.0893, previous: 0.5393, ratio: 11.29
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=11.29)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.06s/it] 50%|█████     | 1/2 [00:14<00:08,  8.06s/it, CE=5.991253e+00 H=4.977744e+00 dV_dx=-1.040971e-06 dV_dθ=-1.013508e+00 ||∇||=2.356731e+01 | Tr=0.1534 Te/Cur=0.1539 Te/Exp=0.8318]100%|██████████| 2/2 [00:14<00:00,  7.02s/it, CE=5.991253e+00 H=4.977744e+00 dV_dx=-1.040971e-06 dV_dθ=-1.013508e+00 ||∇||=2.356731e+01 | Tr=0.1534 Te/Cur=0.1539 Te/Exp=0.8318]100%|██████████| 2/2 [00:14<00:00,  7.18s/it, CE=5.991253e+00 H=4.977744e+00 dV_dx=-1.040971e-06 dV_dθ=-1.013508e+00 ||∇||=2.356731e+01 | Tr=0.1534 Te/Cur=0.1539 Te/Exp=0.8318]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:20, 11.80s/it]  6%|▌         | 1/18 [00:16<03:20, 11.80s/it, CE=6.568423e-01 H=6.585783e-01 dV_dx=-1.796344e-05 dV_dθ=1.753912e-03 ||∇||=1.442582e+00 | Tr=0.7116] 11%|█         | 2/18 [00:16<01:59,  7.49s/it, CE=6.568423e-01 H=6.585783e-01 dV_dx=-1.796344e-05 dV_dθ=1.753912e-03 ||∇||=1.442582e+00 | Tr=0.7116] 11%|█         | 2/18 [00:20<01:59,  7.49s/it, CE=6.384330e-01 H=6.388364e-01 dV_dx=1.011992e-05 dV_dθ=3.932672e-04 ||∇||=1.002375e+00 | Tr=0.8178]  17%|█▋        | 3/18 [00:20<01:30,  6.06s/it, CE=6.384330e-01 H=6.388364e-01 dV_dx=1.011992e-05 dV_dθ=3.932672e-04 ||∇||=1.002375e+00 | Tr=0.8178] 17%|█▋        | 3/18 [00:24<01:30,  6.06s/it, CE=6.233540e-01 H=6.234776e-01 dV_dx=2.247180e-05 dV_dθ=1.011077e-04 ||∇||=8.821766e-01 | Tr=0.8604] 22%|██▏       | 4/18 [00:24<01:12,  5.15s/it, CE=6.233540e-01 H=6.234776e-01 dV_dx=2.247180e-05 dV_dθ=1.011077e-04 ||∇||=8.821766e-01 | Tr=0.8604] 22%|██▏       | 4/18 [00:28<01:12,  5.15s/it, CE=6.093869e-01 H=6.093992e-01 dV_dx=3.187500e-05 dV_dθ=-1.959773e-05 ||∇||=8.230995e-01 | Tr=0.8836] 28%|██▊       | 5/18 [00:28<01:00,  4.66s/it, CE=6.093869e-01 H=6.093992e-01 dV_dx=3.187500e-05 dV_dθ=-1.959773e-05 ||∇||=8.230995e-01 | Tr=0.8836] 28%|██▊       | 5/18 [00:34<01:00,  4.66s/it, CE=5.971997e-01 H=5.971206e-01 dV_dx=1.027201e-05 dV_dθ=-8.935370e-05 ||∇||=7.894084e-01 | Tr=0.8973 Te/Cur=0.8969 Te/Exp=0.8055] 33%|███▎      | 6/18 [00:34<01:01,  5.15s/it, CE=5.971997e-01 H=5.971206e-01 dV_dx=1.027201e-05 dV_dθ=-8.935370e-05 ||∇||=7.894084e-01 | Tr=0.8973 Te/Cur=0.8969 Te/Exp=0.8055] 33%|███▎      | 6/18 [00:38<01:01,  5.15s/it, CE=5.862975e-01 H=5.861488e-01 dV_dx=-1.222100e-05 dV_dθ=-1.364330e-04 ||∇||=7.658929e-01 | Tr=0.9078]                            39%|███▉      | 7/18 [00:38<00:53,  4.83s/it, CE=5.862975e-01 H=5.861488e-01 dV_dx=-1.222100e-05 dV_dθ=-1.364330e-04 ||∇||=7.658929e-01 | Tr=0.9078] 39%|███▉      | 7/18 [00:42<00:53,  4.83s/it, CE=5.767097e-01 H=5.765768e-01 dV_dx=3.605679e-05 dV_dθ=-1.689832e-04 ||∇||=7.473873e-01 | Tr=0.9162]  44%|████▍     | 8/18 [00:42<00:44,  4.49s/it, CE=5.767097e-01 H=5.765768e-01 dV_dx=3.605679e-05 dV_dθ=-1.689832e-04 ||∇||=7.473873e-01 | Tr=0.9162] 44%|████▍     | 8/18 [00:44<00:44,  4.49s/it, CE=5.683341e-01 H=5.681308e-01 dV_dx=-1.438747e-05 dV_dθ=-1.888466e-04 ||∇||=7.314686e-01 | Tr=0.9225] 50%|█████     | 9/18 [00:44<00:34,  3.88s/it, CE=5.683341e-01 H=5.681308e-01 dV_dx=-1.438747e-05 dV_dθ=-1.888466e-04 ||∇||=7.314686e-01 | Tr=0.9225] 50%|█████     | 9/18 [00:48<00:34,  3.88s/it, CE=5.608032e-01 H=5.605624e-01 dV_dx=-3.033362e-05 dV_dθ=-2.104508e-04 ||∇||=7.201145e-01 | Tr=0.9278] 56%|█████▌    | 10/18 [00:48<00:31,  3.96s/it, CE=5.608032e-01 H=5.605624e-01 dV_dx=-3.033362e-05 dV_dθ=-2.104508e-04 ||∇||=7.201145e-01 | Tr=0.9278] 56%|█████▌    | 10/18 [00:54<00:31,  3.96s/it, CE=5.539409e-01 H=5.536812e-01 dV_dx=-3.662111e-05 dV_dθ=-2.229936e-04 ||∇||=7.090481e-01 | Tr=0.9323 Te/Cur=0.9253 Te/Exp=0.8159] 61%|██████    | 11/18 [00:54<00:32,  4.60s/it, CE=5.539409e-01 H=5.536812e-01 dV_dx=-3.662111e-05 dV_dθ=-2.229936e-04 ||∇||=7.090481e-01 | Tr=0.9323 Te/Cur=0.9253 Te/Exp=0.8159] 61%|██████    | 11/18 [00:58<00:32,  4.60s/it, CE=5.474454e-01 H=5.472484e-01 dV_dx=3.535261e-05 dV_dθ=-2.324123e-04 ||∇||=6.985944e-01 | Tr=0.9362]                              67%|██████▋   | 12/18 [00:58<00:25,  4.25s/it, CE=5.474454e-01 H=5.472484e-01 dV_dx=3.535261e-05 dV_dθ=-2.324123e-04 ||∇||=6.985944e-01 | Tr=0.9362] 67%|██████▋   | 12/18 [01:03<00:25,  4.25s/it, CE=5.413019e-01 H=5.411058e-01 dV_dx=4.725750e-05 dV_dθ=-2.433097e-04 ||∇||=6.903021e-01 | Tr=0.9395] 72%|███████▏  | 13/18 [01:03<00:21,  4.39s/it, CE=5.413019e-01 H=5.411058e-01 dV_dx=4.725750e-05 dV_dθ=-2.433097e-04 ||∇||=6.903021e-01 | Tr=0.9395] 72%|███████▏  | 13/18 [01:07<00:21,  4.39s/it, CE=5.356674e-01 H=5.354744e-01 dV_dx=5.527014e-05 dV_dθ=-2.482679e-04 ||∇||=6.819652e-01 | Tr=0.9422] 78%|███████▊  | 14/18 [01:07<00:17,  4.36s/it, CE=5.356674e-01 H=5.354744e-01 dV_dx=5.527014e-05 dV_dθ=-2.482679e-04 ||∇||=6.819652e-01 | Tr=0.9422] 78%|███████▊  | 14/18 [01:11<00:17,  4.36s/it, CE=5.305129e-01 H=5.302117e-01 dV_dx=-5.544874e-05 dV_dθ=-2.457184e-04 ||∇||=6.725124e-01 | Tr=0.9448] 83%|████████▎ | 15/18 [01:11<00:12,  4.33s/it, CE=5.305129e-01 H=5.302117e-01 dV_dx=-5.544874e-05 dV_dθ=-2.457184e-04 ||∇||=6.725124e-01 | Tr=0.9448] 83%|████████▎ | 15/18 [01:17<00:12,  4.33s/it, CE=5.258157e-01 H=5.255709e-01 dV_dx=-2.544623e-06 dV_dθ=-2.422191e-04 ||∇||=6.630587e-01 | Tr=0.9468 Te/Cur=0.9391 Te/Exp=0.8240] 89%|████████▉ | 16/18 [01:17<00:09,  4.67s/it, CE=5.258157e-01 H=5.255709e-01 dV_dx=-2.544623e-06 dV_dθ=-2.422191e-04 ||∇||=6.630587e-01 | Tr=0.9468 Te/Cur=0.9391 Te/Exp=0.8240] 89%|████████▉ | 16/18 [01:21<00:09,  4.67s/it, CE=5.214221e-01 H=5.213321e-01 dV_dx=1.495065e-04 dV_dθ=-2.394696e-04 ||∇||=6.547970e-01 | Tr=0.9490]                              94%|█████████▍| 17/18 [01:21<00:04,  4.64s/it, CE=5.214221e-01 H=5.213321e-01 dV_dx=1.495065e-04 dV_dθ=-2.394696e-04 ||∇||=6.547970e-01 | Tr=0.9490] 94%|█████████▍| 17/18 [01:27<00:04,  4.64s/it, CE=5.172869e-01 H=5.170732e-01 dV_dx=2.235193e-05 dV_dθ=-2.360146e-04 ||∇||=6.460424e-01 | Tr=0.9509 Te/Cur=0.9464 Te/Exp=0.8237]100%|██████████| 18/18 [01:27<00:00,  4.99s/it, CE=5.172869e-01 H=5.170732e-01 dV_dx=2.235193e-05 dV_dθ=-2.360146e-04 ||∇||=6.460424e-01 | Tr=0.9509 Te/Cur=0.9464 Te/Exp=0.8237]100%|██████████| 18/18 [01:27<00:00,  4.86s/it, CE=5.172869e-01 H=5.170732e-01 dV_dx=2.235193e-05 dV_dθ=-2.360146e-04 ||∇||=6.460424e-01 | Tr=0.9509 Te/Cur=0.9464 Te/Exp=0.8237]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7509
    Task 1: 0.9216
    Task 2: 0.8147
    Task 3: 0.5488
    Task 4: 0.9110
    Task 5: 0.8988
    Task 6: 0.9172
    Task 7: 0.9446

============================================================
Task 8
============================================================
Initial loss on new task: 4.7986, previous: 0.5173, ratio: 9.28
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=9.28)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.33s/it] 50%|█████     | 1/2 [00:14<00:09,  9.33s/it, CE=4.778337e+00 H=4.045299e+00 dV_dx=-2.262720e-06 dV_dθ=-7.330353e-01 ||∇||=2.008850e+01 | Tr=0.1693 Te/Cur=0.1647 Te/Exp=0.8388]100%|██████████| 2/2 [00:14<00:00,  7.08s/it, CE=4.778337e+00 H=4.045299e+00 dV_dx=-2.262720e-06 dV_dθ=-7.330353e-01 ||∇||=2.008850e+01 | Tr=0.1693 Te/Cur=0.1647 Te/Exp=0.8388]100%|██████████| 2/2 [00:14<00:00,  7.42s/it, CE=4.778337e+00 H=4.045299e+00 dV_dx=-2.262720e-06 dV_dθ=-7.330353e-01 ||∇||=2.008850e+01 | Tr=0.1693 Te/Cur=0.1647 Te/Exp=0.8388]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:11<03:07, 11.01s/it]  6%|▌         | 1/18 [00:15<03:07, 11.01s/it, CE=6.136452e-01 H=6.147207e-01 dV_dx=6.176713e-05 dV_dθ=1.013739e-03 ||∇||=1.273354e+00 | Tr=0.7828] 11%|█         | 2/18 [00:15<01:56,  7.29s/it, CE=6.136452e-01 H=6.147207e-01 dV_dx=6.176713e-05 dV_dθ=1.013739e-03 ||∇||=1.273354e+00 | Tr=0.7828] 11%|█         | 2/18 [00:20<01:56,  7.29s/it, CE=6.058913e-01 H=6.062757e-01 dV_dx=-1.479500e-06 dV_dθ=3.859328e-04 ||∇||=9.856019e-01 | Tr=0.8524] 17%|█▋        | 3/18 [00:20<01:29,  5.97s/it, CE=6.058913e-01 H=6.062757e-01 dV_dx=-1.479500e-06 dV_dθ=3.859328e-04 ||∇||=9.856019e-01 | Tr=0.8524] 17%|█▋        | 3/18 [00:24<01:29,  5.97s/it, CE=5.959062e-01 H=5.959930e-01 dV_dx=4.152741e-05 dV_dθ=4.531941e-05 ||∇||=9.036775e-01 | Tr=0.8822]  22%|██▏       | 4/18 [00:24<01:12,  5.19s/it, CE=5.959062e-01 H=5.959930e-01 dV_dx=4.152741e-05 dV_dθ=4.531941e-05 ||∇||=9.036775e-01 | Tr=0.8822] 22%|██▏       | 4/18 [00:28<01:12,  5.19s/it, CE=5.858738e-01 H=5.857587e-01 dV_dx=-2.746763e-05 dV_dθ=-8.772497e-05 ||∇||=8.493223e-01 | Tr=0.8988] 28%|██▊       | 5/18 [00:28<01:02,  4.77s/it, CE=5.858738e-01 H=5.857587e-01 dV_dx=-2.746763e-05 dV_dθ=-8.772497e-05 ||∇||=8.493223e-01 | Tr=0.8988] 28%|██▊       | 5/18 [00:34<01:02,  4.77s/it, CE=5.760834e-01 H=5.759728e-01 dV_dx=2.780074e-05 dV_dθ=-1.384245e-04 ||∇||=8.057597e-01 | Tr=0.9095 Te/Cur=0.9072 Te/Exp=0.8035] 33%|███▎      | 6/18 [00:34<01:03,  5.31s/it, CE=5.760834e-01 H=5.759728e-01 dV_dx=2.780074e-05 dV_dθ=-1.384245e-04 ||∇||=8.057597e-01 | Tr=0.9095 Te/Cur=0.9072 Te/Exp=0.8035] 33%|███▎      | 6/18 [00:38<01:03,  5.31s/it, CE=5.665215e-01 H=5.663865e-01 dV_dx=2.157425e-05 dV_dθ=-1.566102e-04 ||∇||=7.691253e-01 | Tr=0.9179]                             39%|███▉      | 7/18 [00:38<00:54,  4.95s/it, CE=5.665215e-01 H=5.663865e-01 dV_dx=2.157425e-05 dV_dθ=-1.566102e-04 ||∇||=7.691253e-01 | Tr=0.9179] 39%|███▉      | 7/18 [00:42<00:54,  4.95s/it, CE=5.576524e-01 H=5.575293e-01 dV_dx=3.572403e-05 dV_dθ=-1.587937e-04 ||∇||=7.383604e-01 | Tr=0.9234] 44%|████▍     | 8/18 [00:42<00:46,  4.66s/it, CE=5.576524e-01 H=5.575293e-01 dV_dx=3.572403e-05 dV_dθ=-1.587937e-04 ||∇||=7.383604e-01 | Tr=0.9234] 44%|████▍     | 8/18 [00:46<00:46,  4.66s/it, CE=5.494936e-01 H=5.493272e-01 dV_dx=-3.540089e-06 dV_dθ=-1.628114e-04 ||∇||=7.154618e-01 | Tr=0.9284] 50%|█████     | 9/18 [00:46<00:40,  4.53s/it, CE=5.494936e-01 H=5.493272e-01 dV_dx=-3.540089e-06 dV_dθ=-1.628114e-04 ||∇||=7.154618e-01 | Tr=0.9284] 50%|█████     | 9/18 [00:51<00:40,  4.53s/it, CE=5.419780e-01 H=5.418571e-01 dV_dx=3.604703e-05 dV_dθ=-1.569713e-04 ||∇||=6.943106e-01 | Tr=0.9329]  56%|█████▌    | 10/18 [00:51<00:36,  4.52s/it, CE=5.419780e-01 H=5.418571e-01 dV_dx=3.604703e-05 dV_dθ=-1.569713e-04 ||∇||=6.943106e-01 | Tr=0.9329] 56%|█████▌    | 10/18 [00:57<00:36,  4.52s/it, CE=5.350713e-01 H=5.348877e-01 dV_dx=-2.633390e-05 dV_dθ=-1.572722e-04 ||∇||=6.782816e-01 | Tr=0.9362 Te/Cur=0.9343 Te/Exp=0.8144] 61%|██████    | 11/18 [00:57<00:35,  5.09s/it, CE=5.350713e-01 H=5.348877e-01 dV_dx=-2.633390e-05 dV_dθ=-1.572722e-04 ||∇||=6.782816e-01 | Tr=0.9362 Te/Cur=0.9343 Te/Exp=0.8144] 61%|██████    | 11/18 [01:01<00:35,  5.09s/it, CE=5.285896e-01 H=5.284830e-01 dV_dx=4.901004e-05 dV_dθ=-1.556767e-04 ||∇||=6.646283e-01 | Tr=0.9396]                              67%|██████▋   | 12/18 [01:01<00:28,  4.79s/it, CE=5.285896e-01 H=5.284830e-01 dV_dx=4.901004e-05 dV_dθ=-1.556767e-04 ||∇||=6.646283e-01 | Tr=0.9396] 67%|██████▋   | 12/18 [01:05<00:28,  4.79s/it, CE=5.226229e-01 H=5.224148e-01 dV_dx=-5.286236e-05 dV_dθ=-1.552069e-04 ||∇||=6.530799e-01 | Tr=0.9423] 72%|███████▏  | 13/18 [01:05<00:22,  4.56s/it, CE=5.226229e-01 H=5.224148e-01 dV_dx=-5.286236e-05 dV_dθ=-1.552069e-04 ||∇||=6.530799e-01 | Tr=0.9423] 72%|███████▏  | 13/18 [01:10<00:22,  4.56s/it, CE=5.170101e-01 H=5.169148e-01 dV_dx=5.529609e-05 dV_dθ=-1.506038e-04 ||∇||=6.409982e-01 | Tr=0.9449]  78%|███████▊  | 14/18 [01:10<00:17,  4.44s/it, CE=5.170101e-01 H=5.169148e-01 dV_dx=5.529609e-05 dV_dθ=-1.506038e-04 ||∇||=6.409982e-01 | Tr=0.9449] 78%|███████▊  | 14/18 [01:14<00:17,  4.44s/it, CE=5.117148e-01 H=5.115668e-01 dV_dx=2.235182e-06 dV_dθ=-1.503152e-04 ||∇||=6.319627e-01 | Tr=0.9475] 83%|████████▎ | 15/18 [01:14<00:13,  4.54s/it, CE=5.117148e-01 H=5.115668e-01 dV_dx=2.235182e-06 dV_dθ=-1.503152e-04 ||∇||=6.319627e-01 | Tr=0.9475] 83%|████████▎ | 15/18 [01:21<00:13,  4.54s/it, CE=5.066323e-01 H=5.064689e-01 dV_dx=-1.416314e-05 dV_dθ=-1.492314e-04 ||∇||=6.228138e-01 | Tr=0.9498 Te/Cur=0.9461 Te/Exp=0.8188] 89%|████████▉ | 16/18 [01:21<00:10,  5.30s/it, CE=5.066323e-01 H=5.064689e-01 dV_dx=-1.416314e-05 dV_dθ=-1.492314e-04 ||∇||=6.228138e-01 | Tr=0.9498 Te/Cur=0.9461 Te/Exp=0.8188] 89%|████████▉ | 16/18 [01:27<00:10,  5.30s/it, CE=5.018508e-01 H=5.016644e-01 dV_dx=-4.186741e-05 dV_dθ=-1.446017e-04 ||∇||=6.143427e-01 | Tr=0.9519]                             94%|█████████▍| 17/18 [01:27<00:05,  5.26s/it, CE=5.018508e-01 H=5.016644e-01 dV_dx=-4.186741e-05 dV_dθ=-1.446017e-04 ||∇||=6.143427e-01 | Tr=0.9519] 94%|█████████▍| 17/18 [01:34<00:05,  5.26s/it, CE=4.972620e-01 H=4.971198e-01 dV_dx=-5.686338e-07 dV_dθ=-1.415664e-04 ||∇||=6.064991e-01 | Tr=0.9540 Te/Cur=0.9533 Te/Exp=0.8273]100%|██████████| 18/18 [01:34<00:00,  5.83s/it, CE=4.972620e-01 H=4.971198e-01 dV_dx=-5.686338e-07 dV_dθ=-1.415664e-04 ||∇||=6.064991e-01 | Tr=0.9540 Te/Cur=0.9533 Te/Exp=0.8273]100%|██████████| 18/18 [01:34<00:00,  5.24s/it, CE=4.972620e-01 H=4.971198e-01 dV_dx=-5.686338e-07 dV_dθ=-1.415664e-04 ||∇||=6.064991e-01 | Tr=0.9540 Te/Cur=0.9533 Te/Exp=0.8273]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.7561
    Task 1: 0.9296
    Task 2: 0.8222
    Task 3: 0.5451
    Task 4: 0.9281
    Task 5: 0.8607
    Task 6: 0.8986
    Task 7: 0.8790
    Task 8: 0.9513

============================================================
Task 9
============================================================
Initial loss on new task: 1.6300, previous: 0.4973, ratio: 3.28
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-04, loss_ratio=3.28)
  Warmup phase: 2 epochs at lr=1.00e-07
    Using new task samples only (no experience replay)
    Grad weights: [1.0, 0.0, 0.0]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.92s/it] 50%|█████     | 1/2 [00:14<00:08,  8.92s/it, CE=1.599843e+00 H=1.359238e+00 dV_dx=2.954299e-06 dV_dθ=-2.406080e-01 ||∇||=1.157324e+01 | Tr=0.5127 Te/Cur=0.5148 Te/Exp=0.8434]100%|██████████| 2/2 [00:14<00:00,  7.21s/it, CE=1.599843e+00 H=1.359238e+00 dV_dx=2.954299e-06 dV_dθ=-2.406080e-01 ||∇||=1.157324e+01 | Tr=0.5127 Te/Cur=0.5148 Te/Exp=0.8434]100%|██████████| 2/2 [00:14<00:00,  7.47s/it, CE=1.599843e+00 H=1.359238e+00 dV_dx=2.954299e-06 dV_dθ=-2.406080e-01 ||∇||=1.157324e+01 | Tr=0.5127 Te/Cur=0.5148 Te/Exp=0.8434]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Main phase: 18 epochs at lr=1.00e-04
    Using experience replay
    Adaptive grad weights: [0.70, 0.20, 0.10] (current, experience, regularization)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:12<03:30, 12.36s/it]  6%|▌         | 1/18 [00:16<03:30, 12.36s/it, CE=4.877834e-01 H=4.875913e-01 dV_dx=-2.698790e-06 dV_dθ=-1.894126e-04 ||∇||=9.861750e-01 | Tr=0.8610] 11%|█         | 2/18 [00:16<02:00,  7.51s/it, CE=4.877834e-01 H=4.875913e-01 dV_dx=-2.698790e-06 dV_dθ=-1.894126e-04 ||∇||=9.861750e-01 | Tr=0.8610] 11%|█         | 2/18 [00:21<02:00,  7.51s/it, CE=4.823467e-01 H=4.820516e-01 dV_dx=-2.990188e-05 dV_dθ=-2.651796e-04 ||∇||=9.128518e-01 | Tr=0.8884] 17%|█▋        | 3/18 [00:21<01:33,  6.26s/it, CE=4.823467e-01 H=4.820516e-01 dV_dx=-2.990188e-05 dV_dθ=-2.651796e-04 ||∇||=9.128518e-01 | Tr=0.8884] 17%|█▋        | 3/18 [00:25<01:33,  6.26s/it, CE=4.776458e-01 H=4.772864e-01 dV_dx=-4.408942e-05 dV_dθ=-3.153583e-04 ||∇||=8.892138e-01 | Tr=0.9026] 22%|██▏       | 4/18 [00:25<01:18,  5.58s/it, CE=4.776458e-01 H=4.772864e-01 dV_dx=-4.408942e-05 dV_dθ=-3.153583e-04 ||∇||=8.892138e-01 | Tr=0.9026] 22%|██▏       | 4/18 [00:30<01:18,  5.58s/it, CE=4.726987e-01 H=4.724002e-01 dV_dx=3.748924e-05 dV_dθ=-3.359423e-04 ||∇||=8.624001e-01 | Tr=0.9115]  28%|██▊       | 5/18 [00:30<01:09,  5.33s/it, CE=4.726987e-01 H=4.724002e-01 dV_dx=3.748924e-05 dV_dθ=-3.359423e-04 ||∇||=8.624001e-01 | Tr=0.9115] 28%|██▊       | 5/18 [00:37<01:09,  5.33s/it, CE=4.676844e-01 H=4.673271e-01 dV_dx=-1.149164e-05 dV_dθ=-3.457566e-04 ||∇||=8.395122e-01 | Tr=0.9183 Te/Cur=0.9202 Te/Exp=0.8365] 33%|███▎      | 6/18 [00:37<01:10,  5.87s/it, CE=4.676844e-01 H=4.673271e-01 dV_dx=-1.149164e-05 dV_dθ=-3.457566e-04 ||∇||=8.395122e-01 | Tr=0.9183 Te/Cur=0.9202 Te/Exp=0.8365] 33%|███▎      | 6/18 [00:42<01:10,  5.87s/it, CE=4.625838e-01 H=4.622641e-01 dV_dx=3.075593e-05 dV_dθ=-3.504278e-04 ||∇||=8.209343e-01 | Tr=0.9240]                              39%|███▉      | 7/18 [00:42<01:00,  5.50s/it, CE=4.625838e-01 H=4.622641e-01 dV_dx=3.075593e-05 dV_dθ=-3.504278e-04 ||∇||=8.209343e-01 | Tr=0.9240] 39%|███▉      | 7/18 [00:46<01:00,  5.50s/it, CE=4.577782e-01 H=4.574663e-01 dV_dx=4.007121e-05 dV_dθ=-3.519467e-04 ||∇||=8.057960e-01 | Tr=0.9284] 44%|████▍     | 8/18 [00:46<00:50,  5.07s/it, CE=4.577782e-01 H=4.574663e-01 dV_dx=4.007121e-05 dV_dθ=-3.519467e-04 ||∇||=8.057960e-01 | Tr=0.9284] 44%|████▍     | 8/18 [00:51<00:50,  5.07s/it, CE=4.532717e-01 H=4.529102e-01 dV_dx=-7.274464e-06 dV_dθ=-3.542522e-04 ||∇||=7.913181e-01 | Tr=0.9318] 50%|█████     | 9/18 [00:51<00:44,  4.98s/it, CE=4.532717e-01 H=4.529102e-01 dV_dx=-7.274464e-06 dV_dθ=-3.542522e-04 ||∇||=7.913181e-01 | Tr=0.9318] 50%|█████     | 9/18 [00:55<00:44,  4.98s/it, CE=4.490167e-01 H=4.486172e-01 dV_dx=-4.660942e-05 dV_dθ=-3.528242e-04 ||∇||=7.795910e-01 | Tr=0.9352] 56%|█████▌    | 10/18 [00:55<00:38,  4.77s/it, CE=4.490167e-01 H=4.486172e-01 dV_dx=-4.660942e-05 dV_dθ=-3.528242e-04 ||∇||=7.795910e-01 | Tr=0.9352] 56%|█████▌    | 10/18 [01:01<00:38,  4.77s/it, CE=4.448702e-01 H=4.445772e-01 dV_dx=6.029997e-05 dV_dθ=-3.532901e-04 ||∇||=7.688802e-01 | Tr=0.9382 Te/Cur=0.9394 Te/Exp=0.8350] 61%|██████    | 11/18 [01:01<00:36,  5.23s/it, CE=4.448702e-01 H=4.445772e-01 dV_dx=6.029997e-05 dV_dθ=-3.532901e-04 ||∇||=7.688802e-01 | Tr=0.9382 Te/Cur=0.9394 Te/Exp=0.8350] 61%|██████    | 11/18 [01:05<00:36,  5.23s/it, CE=4.409126e-01 H=4.404941e-01 dV_dx=-6.724430e-05 dV_dθ=-3.512100e-04 ||∇||=7.586786e-01 | Tr=0.9411]                            67%|██████▋   | 12/18 [01:05<00:29,  4.86s/it, CE=4.409126e-01 H=4.404941e-01 dV_dx=-6.724430e-05 dV_dθ=-3.512100e-04 ||∇||=7.586786e-01 | Tr=0.9411] 67%|██████▋   | 12/18 [01:10<00:29,  4.86s/it, CE=4.371047e-01 H=4.367801e-01 dV_dx=2.213286e-05 dV_dθ=-3.467946e-04 ||∇||=7.494490e-01 | Tr=0.9436]  72%|███████▏  | 13/18 [01:10<00:23,  4.78s/it, CE=4.371047e-01 H=4.367801e-01 dV_dx=2.213286e-05 dV_dθ=-3.467946e-04 ||∇||=7.494490e-01 | Tr=0.9436] 72%|███████▏  | 13/18 [01:15<00:23,  4.78s/it, CE=4.333695e-01 H=4.330697e-01 dV_dx=3.475577e-05 dV_dθ=-3.345571e-04 ||∇||=7.389316e-01 | Tr=0.9458] 78%|███████▊  | 14/18 [01:15<00:19,  4.83s/it, CE=4.333695e-01 H=4.330697e-01 dV_dx=3.475577e-05 dV_dθ=-3.345571e-04 ||∇||=7.389316e-01 | Tr=0.9458] 78%|███████▊  | 14/18 [01:20<00:19,  4.83s/it, CE=4.297663e-01 H=4.294235e-01 dV_dx=-2.079009e-05 dV_dθ=-3.219853e-04 ||∇||=7.283108e-01 | Tr=0.9481] 83%|████████▎ | 15/18 [01:20<00:14,  4.91s/it, CE=4.297663e-01 H=4.294235e-01 dV_dx=-2.079009e-05 dV_dθ=-3.219853e-04 ||∇||=7.283108e-01 | Tr=0.9481] 83%|████████▎ | 15/18 [01:27<00:14,  4.91s/it, CE=4.262619e-01 H=4.259429e-01 dV_dx=-7.553791e-06 dV_dθ=-3.115075e-04 ||∇||=7.191902e-01 | Tr=0.9501 Te/Cur=0.9500 Te/Exp=0.8435] 89%|████████▉ | 16/18 [01:27<00:10,  5.46s/it, CE=4.262619e-01 H=4.259429e-01 dV_dx=-7.553791e-06 dV_dθ=-3.115075e-04 ||∇||=7.191902e-01 | Tr=0.9501 Te/Cur=0.9500 Te/Exp=0.8435] 89%|████████▉ | 16/18 [01:32<00:10,  5.46s/it, CE=4.227959e-01 H=4.224460e-01 dV_dx=-3.828256e-05 dV_dθ=-3.115654e-04 ||∇||=7.177195e-01 | Tr=0.9517]                             94%|█████████▍| 17/18 [01:32<00:05,  5.38s/it, CE=4.227959e-01 H=4.224460e-01 dV_dx=-3.828256e-05 dV_dθ=-3.115654e-04 ||∇||=7.177195e-01 | Tr=0.9517] 94%|█████████▍| 17/18 [01:39<00:05,  5.38s/it, CE=4.194531e-01 H=4.191244e-01 dV_dx=-2.394193e-05 dV_dθ=-3.047775e-04 ||∇||=7.081479e-01 | Tr=0.9535 Te/Cur=0.9515 Te/Exp=0.8422]100%|██████████| 18/18 [01:39<00:00,  5.88s/it, CE=4.194531e-01 H=4.191244e-01 dV_dx=-2.394193e-05 dV_dθ=-3.047775e-04 ||∇||=7.081479e-01 | Tr=0.9535 Te/Cur=0.9515 Te/Exp=0.8422]100%|██████████| 18/18 [01:39<00:00,  5.52s/it, CE=4.194531e-01 H=4.191244e-01 dV_dx=-2.394193e-05 dV_dθ=-3.047775e-04 ||∇||=7.081479e-01 | Tr=0.9535 Te/Cur=0.9515 Te/Exp=0.8422]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7642
    Task 1: 0.9359
    Task 2: 0.8313
    Task 3: 0.5512
    Task 4: 0.9355
    Task 5: 0.9063
    Task 6: 0.9048
    Task 7: 0.9138
    Task 8: 0.8893
    Task 9: 0.9514
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition2_heuristics_run2/mnist_condition2_heuristics_run2_run2/classification_mnist_cnn_run2_records.pkl

Training complete!
