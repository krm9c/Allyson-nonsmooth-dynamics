JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition4_awb_full.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: True

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run0
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run0/mnist_condition4_awb_full_run0


############################################################
# Run ID: 0
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:19<06:03, 19.11s/it]  5%|▌         | 1/20 [00:24<06:03, 19.11s/it, CE=2.070707e+00 H=2.070282e+00 dV_dx=-2.187251e-07 dV_dθ=-4.247024e-04 ||∇||=4.480374e-01 | Tr=0.4039] 10%|█         | 2/20 [00:24<03:18, 11.05s/it, CE=2.070707e+00 H=2.070282e+00 dV_dx=-2.187251e-07 dV_dθ=-4.247024e-04 ||∇||=4.480374e-01 | Tr=0.4039] 10%|█         | 2/20 [00:29<03:18, 11.05s/it, CE=1.859065e+00 H=1.858250e+00 dV_dx=-2.806087e-07 dV_dθ=-8.145258e-04 ||∇||=6.177087e-01 | Tr=0.4915] 15%|█▌        | 3/20 [00:29<02:21,  8.33s/it, CE=1.859065e+00 H=1.858250e+00 dV_dx=-2.806087e-07 dV_dθ=-8.145258e-04 ||∇||=6.177087e-01 | Tr=0.4915] 15%|█▌        | 3/20 [00:34<02:21,  8.33s/it, CE=1.646728e+00 H=1.645685e+00 dV_dx=-2.677922e-07 dV_dθ=-1.042613e-03 ||∇||=7.036629e-01 | Tr=0.5262] 20%|██        | 4/20 [00:34<01:53,  7.11s/it, CE=1.646728e+00 H=1.645685e+00 dV_dx=-2.677922e-07 dV_dθ=-1.042613e-03 ||∇||=7.036629e-01 | Tr=0.5262] 20%|██        | 4/20 [00:39<01:53,  7.11s/it, CE=1.468197e+00 H=1.467220e+00 dV_dx=4.801006e-07 dV_dθ=-9.766233e-04 ||∇||=6.917343e-01 | Tr=0.5557]  25%|██▌       | 5/20 [00:39<01:35,  6.35s/it, CE=1.468197e+00 H=1.467220e+00 dV_dx=4.801006e-07 dV_dθ=-9.766233e-04 ||∇||=6.917343e-01 | Tr=0.5557] 25%|██▌       | 5/20 [00:47<01:35,  6.35s/it, CE=1.336575e+00 H=1.335741e+00 dV_dx=-5.608561e-07 dV_dθ=-8.331820e-04 ||∇||=6.526699e-01 | Tr=0.5821 Te/Cur=0.5926 Te/Exp=0.5899] 30%|███       | 6/20 [00:47<01:36,  6.91s/it, CE=1.336575e+00 H=1.335741e+00 dV_dx=-5.608561e-07 dV_dθ=-8.331820e-04 ||∇||=6.526699e-01 | Tr=0.5821 Te/Cur=0.5926 Te/Exp=0.5899] 30%|███       | 6/20 [00:52<01:36,  6.91s/it, CE=1.236797e+00 H=1.236114e+00 dV_dx=-1.201242e-06 dV_dθ=-6.811010e-04 ||∇||=6.075169e-01 | Tr=0.6056]                             35%|███▌      | 7/20 [00:52<01:22,  6.31s/it, CE=1.236797e+00 H=1.236114e+00 dV_dx=-1.201242e-06 dV_dθ=-6.811010e-04 ||∇||=6.075169e-01 | Tr=0.6056] 35%|███▌      | 7/20 [00:57<01:22,  6.31s/it, CE=1.161481e+00 H=1.160917e+00 dV_dx=-5.465450e-07 dV_dθ=-5.634566e-04 ||∇||=5.699427e-01 | Tr=0.6260] 40%|████      | 8/20 [00:57<01:10,  5.85s/it, CE=1.161481e+00 H=1.160917e+00 dV_dx=-5.465450e-07 dV_dθ=-5.634566e-04 ||∇||=5.699427e-01 | Tr=0.6260] 40%|████      | 8/20 [01:02<01:10,  5.85s/it, CE=1.103337e+00 H=1.102856e+00 dV_dx=3.026141e-07 dV_dθ=-4.807624e-04 ||∇||=5.433173e-01 | Tr=0.6418]  45%|████▌     | 9/20 [01:02<01:01,  5.56s/it, CE=1.103337e+00 H=1.102856e+00 dV_dx=3.026141e-07 dV_dθ=-4.807624e-04 ||∇||=5.433173e-01 | Tr=0.6418] 45%|████▌     | 9/20 [01:07<01:01,  5.56s/it, CE=1.056371e+00 H=1.055943e+00 dV_dx=-3.684212e-07 dV_dθ=-4.275995e-04 ||∇||=5.270938e-01 | Tr=0.6549] 50%|█████     | 10/20 [01:07<00:54,  5.43s/it, CE=1.056371e+00 H=1.055943e+00 dV_dx=-3.684212e-07 dV_dθ=-4.275995e-04 ||∇||=5.270938e-01 | Tr=0.6549] 50%|█████     | 10/20 [01:14<00:54,  5.43s/it, CE=1.017656e+00 H=1.017269e+00 dV_dx=-9.488744e-09 dV_dθ=-3.861574e-04 ||∇||=5.147175e-01 | Tr=0.6657 Te/Cur=0.6695 Te/Exp=0.6666] 55%|█████▌    | 11/20 [01:14<00:51,  5.77s/it, CE=1.017656e+00 H=1.017269e+00 dV_dx=-9.488744e-09 dV_dθ=-3.861574e-04 ||∇||=5.147175e-01 | Tr=0.6657 Te/Cur=0.6695 Te/Exp=0.6666] 55%|█████▌    | 11/20 [01:19<00:51,  5.77s/it, CE=9.847054e-01 H=9.843398e-01 dV_dx=-3.614285e-06 dV_dθ=-3.619882e-04 ||∇||=5.093182e-01 | Tr=0.6766]                             60%|██████    | 12/20 [01:19<00:44,  5.55s/it, CE=9.847054e-01 H=9.843398e-01 dV_dx=-3.614285e-06 dV_dθ=-3.619882e-04 ||∇||=5.093182e-01 | Tr=0.6766] 60%|██████    | 12/20 [01:24<00:44,  5.55s/it, CE=9.558241e-01 H=9.554858e-01 dV_dx=1.543146e-06 dV_dθ=-3.397612e-04 ||∇||=5.032946e-01 | Tr=0.6859]  65%|██████▌   | 13/20 [01:24<00:37,  5.38s/it, CE=9.558241e-01 H=9.554858e-01 dV_dx=1.543146e-06 dV_dθ=-3.397612e-04 ||∇||=5.032946e-01 | Tr=0.6859] 65%|██████▌   | 13/20 [01:29<00:37,  5.38s/it, CE=9.301290e-01 H=9.298034e-01 dV_dx=1.214576e-06 dV_dθ=-3.267450e-04 ||∇||=5.015586e-01 | Tr=0.6944] 70%|███████   | 14/20 [01:29<00:31,  5.31s/it, CE=9.301290e-01 H=9.298034e-01 dV_dx=1.214576e-06 dV_dθ=-3.267450e-04 ||∇||=5.015586e-01 | Tr=0.6944] 70%|███████   | 14/20 [01:34<00:31,  5.31s/it, CE=9.073352e-01 H=9.070119e-01 dV_dx=-8.088085e-07 dV_dθ=-3.225097e-04 ||∇||=5.038987e-01 | Tr=0.7008] 75%|███████▌  | 15/20 [01:34<00:26,  5.21s/it, CE=9.073352e-01 H=9.070119e-01 dV_dx=-8.088085e-07 dV_dθ=-3.225097e-04 ||∇||=5.038987e-01 | Tr=0.7008] 75%|███████▌  | 15/20 [01:40<00:26,  5.21s/it, CE=8.867923e-01 H=8.864851e-01 dV_dx=8.855714e-07 dV_dθ=-3.080911e-04 ||∇||=5.019053e-01 | Tr=0.7073 Te/Cur=0.7119 Te/Exp=0.7056] 80%|████████  | 16/20 [01:40<00:21,  5.43s/it, CE=8.867923e-01 H=8.864851e-01 dV_dx=8.855714e-07 dV_dθ=-3.080911e-04 ||∇||=5.019053e-01 | Tr=0.7073 Te/Cur=0.7119 Te/Exp=0.7056] 80%|████████  | 16/20 [01:45<00:21,  5.43s/it, CE=8.683677e-01 H=8.680709e-01 dV_dx=1.536462e-06 dV_dθ=-2.983381e-04 ||∇||=5.016164e-01 | Tr=0.7138]                             85%|████████▌ | 17/20 [01:45<00:15,  5.27s/it, CE=8.683677e-01 H=8.680709e-01 dV_dx=1.536462e-06 dV_dθ=-2.983381e-04 ||∇||=5.016164e-01 | Tr=0.7138] 85%|████████▌ | 17/20 [01:50<00:15,  5.27s/it, CE=8.514402e-01 H=8.511495e-01 dV_dx=2.417238e-06 dV_dθ=-2.931211e-04 ||∇||=5.034188e-01 | Tr=0.7196] 90%|█████████ | 18/20 [01:50<00:10,  5.15s/it, CE=8.514402e-01 H=8.511495e-01 dV_dx=2.417238e-06 dV_dθ=-2.931211e-04 ||∇||=5.034188e-01 | Tr=0.7196] 90%|█████████ | 18/20 [01:54<00:10,  5.15s/it, CE=8.356457e-01 H=8.353562e-01 dV_dx=-1.478768e-06 dV_dθ=-2.881125e-04 ||∇||=5.048583e-01 | Tr=0.7248] 95%|█████████▌| 19/20 [01:54<00:04,  4.95s/it, CE=8.356457e-01 H=8.353562e-01 dV_dx=-1.478768e-06 dV_dθ=-2.881125e-04 ||∇||=5.048583e-01 | Tr=0.7248] 95%|█████████▌| 19/20 [02:01<00:04,  4.95s/it, CE=8.209838e-01 H=8.206944e-01 dV_dx=8.966353e-07 dV_dθ=-2.903630e-04 ||∇||=5.093470e-01 | Tr=0.7299 Te/Cur=0.7322 Te/Exp=0.7294]100%|██████████| 20/20 [02:01<00:00,  5.39s/it, CE=8.209838e-01 H=8.206944e-01 dV_dx=8.966353e-07 dV_dθ=-2.903630e-04 ||∇||=5.093470e-01 | Tr=0.7299 Te/Cur=0.7322 Te/Exp=0.7294]100%|██████████| 20/20 [02:01<00:00,  6.06s/it, CE=8.209838e-01 H=8.206944e-01 dV_dx=8.966353e-07 dV_dθ=-2.903630e-04 ||∇||=5.093470e-01 | Tr=0.7299 Te/Cur=0.7322 Te/Exp=0.7294]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7295

============================================================
Task 1
============================================================
Initial loss on new task: 6.3919, previous: 0.8210, ratio: 7.79
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 1
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:11<?, ?it/s, CE=9.618100e-01 H=9.650294e-01 dV_dx=-5.025973e-05 dV_dθ=3.269653e-03 ||∇||=2.276558e+00 | Tr=0.5078 Te/Cur=0.7309 Te/Exp=0.7191]100%|██████████| 1/1 [00:11<00:00, 11.18s/it, CE=9.618100e-01 H=9.650294e-01 dV_dx=-5.025973e-05 dV_dθ=3.269653e-03 ||∇||=2.276558e+00 | Tr=0.5078 Te/Cur=0.7309 Te/Exp=0.7191]100%|██████████| 1/1 [00:11<00:00, 11.18s/it, CE=9.618100e-01 H=9.650294e-01 dV_dx=-5.025973e-05 dV_dθ=3.269653e-03 ||∇||=2.276558e+00 | Tr=0.5078 Te/Cur=0.7309 Te/Exp=0.7191]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.961810

[STEP 2] Architecture change decision
  Current: 0.961810, Previous: 0.820984
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9416 samples from 10 classes
  Created balanced validation set: 9417 samples from 10 classes
  Starting grid architecture search for task 1
  Baseline architecture: (3, [507, 512, 64, 10])
  Baseline loss: 0.961810
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.57s/it] 50%|█████     | 1/2 [00:19<00:15, 15.57s/it, CE=2.318111e+00 H=2.318025e+00 dV_dx=1.831441e-06 dV_dθ=-8.842798e-05 ||∇||=3.164297e-01 | Tr=0.0862 Te/Cur=0.0960 Te/Exp=0.1264]100%|██████████| 2/2 [00:19<00:00,  8.48s/it, CE=2.318111e+00 H=2.318025e+00 dV_dx=1.831441e-06 dV_dθ=-8.842798e-05 ||∇||=3.164297e-01 | Tr=0.0862 Te/Cur=0.0960 Te/Exp=0.1264]100%|██████████| 2/2 [00:19<00:00,  9.55s/it, CE=2.318111e+00 H=2.318025e+00 dV_dx=1.831441e-06 dV_dθ=-8.842798e-05 ||∇||=3.164297e-01 | Tr=0.0862 Te/Cur=0.0960 Te/Exp=0.1264]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.318111298401931
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.78s/it] 50%|█████     | 1/2 [00:15<00:12, 12.78s/it, CE=2.316978e+00 H=2.316887e+00 dV_dx=-1.394558e-07 dV_dθ=-9.132468e-05 ||∇||=3.244657e-01 | Tr=0.1131 Te/Cur=0.1165 Te/Exp=0.1594]100%|██████████| 2/2 [00:15<00:00,  6.88s/it, CE=2.316978e+00 H=2.316887e+00 dV_dx=-1.394558e-07 dV_dθ=-9.132468e-05 ||∇||=3.244657e-01 | Tr=0.1131 Te/Cur=0.1165 Te/Exp=0.1594]100%|██████████| 2/2 [00:15<00:00,  7.76s/it, CE=2.316978e+00 H=2.316887e+00 dV_dx=-1.394558e-07 dV_dθ=-9.132468e-05 ||∇||=3.244657e-01 | Tr=0.1131 Te/Cur=0.1165 Te/Exp=0.1594]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 44, 10]) with loss 2.316978
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.84s/it] 50%|█████     | 1/2 [00:16<00:13, 13.84s/it, CE=2.330125e+00 H=2.330030e+00 dV_dx=-1.293344e-05 dV_dθ=-8.259174e-05 ||∇||=3.260872e-01 | Tr=0.1226 Te/Cur=0.1272 Te/Exp=0.1283]100%|██████████| 2/2 [00:16<00:00,  7.52s/it, CE=2.330125e+00 H=2.330030e+00 dV_dx=-1.293344e-05 dV_dθ=-8.259174e-05 ||∇||=3.260872e-01 | Tr=0.1226 Te/Cur=0.1272 Te/Exp=0.1283]100%|██████████| 2/2 [00:16<00:00,  8.47s/it, CE=2.330125e+00 H=2.330030e+00 dV_dx=-1.293344e-05 dV_dθ=-8.259174e-05 ||∇||=3.260872e-01 | Tr=0.1226 Te/Cur=0.1272 Te/Exp=0.1283]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.90s/it] 50%|█████     | 1/2 [00:16<00:12, 12.90s/it, CE=2.328761e+00 H=2.328678e+00 dV_dx=2.019523e-06 dV_dθ=-8.535812e-05 ||∇||=3.286714e-01 | Tr=0.1169 Te/Cur=0.1152 Te/Exp=0.0975]100%|██████████| 2/2 [00:16<00:00,  7.27s/it, CE=2.328761e+00 H=2.328678e+00 dV_dx=2.019523e-06 dV_dθ=-8.535812e-05 ||∇||=3.286714e-01 | Tr=0.1169 Te/Cur=0.1152 Te/Exp=0.0975]100%|██████████| 2/2 [00:16<00:00,  8.11s/it, CE=2.328761e+00 H=2.328678e+00 dV_dx=2.019523e-06 dV_dθ=-8.535812e-05 ||∇||=3.286714e-01 | Tr=0.1169 Te/Cur=0.1152 Te/Exp=0.0975]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.80s/it] 50%|█████     | 1/2 [00:15<00:12, 12.80s/it, CE=2.313975e+00 H=2.313882e+00 dV_dx=1.846604e-06 dV_dθ=-9.512889e-05 ||∇||=3.682555e-01 | Tr=0.1028 Te/Cur=0.0985 Te/Exp=0.1008]100%|██████████| 2/2 [00:15<00:00,  7.06s/it, CE=2.313975e+00 H=2.313882e+00 dV_dx=1.846604e-06 dV_dθ=-9.512889e-05 ||∇||=3.682555e-01 | Tr=0.1028 Te/Cur=0.0985 Te/Exp=0.1008]100%|██████████| 2/2 [00:15<00:00,  7.92s/it, CE=2.313975e+00 H=2.313882e+00 dV_dx=1.846604e-06 dV_dθ=-9.512889e-05 ||∇||=3.682555e-01 | Tr=0.1028 Te/Cur=0.0985 Te/Exp=0.1008]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 64, 10]) with loss 2.313975
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.20s/it] 50%|█████     | 1/2 [00:15<00:13, 13.20s/it, CE=2.329756e+00 H=2.329599e+00 dV_dx=-1.128057e-05 dV_dθ=-1.454798e-04 ||∇||=3.801929e-01 | Tr=0.1698 Te/Cur=0.1663 Te/Exp=0.1216]100%|██████████| 2/2 [00:15<00:00,  7.06s/it, CE=2.329756e+00 H=2.329599e+00 dV_dx=-1.128057e-05 dV_dθ=-1.454798e-04 ||∇||=3.801929e-01 | Tr=0.1698 Te/Cur=0.1663 Te/Exp=0.1216]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.329756e+00 H=2.329599e+00 dV_dx=-1.128057e-05 dV_dθ=-1.454798e-04 ||∇||=3.801929e-01 | Tr=0.1698 Te/Cur=0.1663 Te/Exp=0.1216]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.95s/it] 50%|█████     | 1/2 [00:15<00:12, 12.95s/it, CE=2.296875e+00 H=2.296750e+00 dV_dx=-4.304527e-06 dV_dθ=-1.205642e-04 ||∇||=3.583976e-01 | Tr=0.1220 Te/Cur=0.1459 Te/Exp=0.1899]100%|██████████| 2/2 [00:15<00:00,  7.02s/it, CE=2.296875e+00 H=2.296750e+00 dV_dx=-4.304527e-06 dV_dθ=-1.205642e-04 ||∇||=3.583976e-01 | Tr=0.1220 Te/Cur=0.1459 Te/Exp=0.1899]100%|██████████| 2/2 [00:15<00:00,  7.91s/it, CE=2.296875e+00 H=2.296750e+00 dV_dx=-4.304527e-06 dV_dθ=-1.205642e-04 ||∇||=3.583976e-01 | Tr=0.1220 Te/Cur=0.1459 Te/Exp=0.1899]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 492, 84, 10]) with loss 2.296875
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.38s/it] 50%|█████     | 1/2 [00:16<00:13, 13.38s/it, CE=2.287870e+00 H=2.287769e+00 dV_dx=-2.321759e-06 dV_dθ=-9.906180e-05 ||∇||=3.460157e-01 | Tr=0.1273 Te/Cur=0.1753 Te/Exp=0.2101]100%|██████████| 2/2 [00:16<00:00,  7.32s/it, CE=2.287870e+00 H=2.287769e+00 dV_dx=-2.321759e-06 dV_dθ=-9.906180e-05 ||∇||=3.460157e-01 | Tr=0.1273 Te/Cur=0.1753 Te/Exp=0.2101]100%|██████████| 2/2 [00:16<00:00,  8.23s/it, CE=2.287870e+00 H=2.287769e+00 dV_dx=-2.321759e-06 dV_dθ=-9.906180e-05 ||∇||=3.460157e-01 | Tr=0.1273 Te/Cur=0.1753 Te/Exp=0.2101]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 84, 10]) with loss 2.287870
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.57s/it] 50%|█████     | 1/2 [00:14<00:12, 12.57s/it, CE=2.294310e+00 H=2.294189e+00 dV_dx=-2.238025e-06 dV_dθ=-1.181428e-04 ||∇||=3.680527e-01 | Tr=0.1058 Te/Cur=0.1199 Te/Exp=0.1151]100%|██████████| 2/2 [00:14<00:00,  6.59s/it, CE=2.294310e+00 H=2.294189e+00 dV_dx=-2.238025e-06 dV_dθ=-1.181428e-04 ||∇||=3.680527e-01 | Tr=0.1058 Te/Cur=0.1199 Te/Exp=0.1151]100%|██████████| 2/2 [00:14<00:00,  7.49s/it, CE=2.294310e+00 H=2.294189e+00 dV_dx=-2.238025e-06 dV_dθ=-1.181428e-04 ||∇||=3.680527e-01 | Tr=0.1058 Te/Cur=0.1199 Te/Exp=0.1151]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.26s/it] 50%|█████     | 1/2 [00:15<00:13, 13.26s/it, CE=2.314802e+00 H=2.314692e+00 dV_dx=-1.313499e-05 dV_dθ=-9.644145e-05 ||∇||=4.408185e-01 | Tr=0.1400 Te/Cur=0.1173 Te/Exp=0.1445]100%|██████████| 2/2 [00:15<00:00,  7.01s/it, CE=2.314802e+00 H=2.314692e+00 dV_dx=-1.313499e-05 dV_dθ=-9.644145e-05 ||∇||=4.408185e-01 | Tr=0.1400 Te/Cur=0.1173 Te/Exp=0.1445]100%|██████████| 2/2 [00:15<00:00,  7.95s/it, CE=2.314802e+00 H=2.314692e+00 dV_dx=-1.313499e-05 dV_dθ=-9.644145e-05 ||∇||=4.408185e-01 | Tr=0.1400 Te/Cur=0.1173 Te/Exp=0.1445]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.82s/it] 50%|█████     | 1/2 [00:16<00:12, 12.82s/it, CE=2.305329e+00 H=2.305258e+00 dV_dx=-7.490296e-06 dV_dθ=-6.332851e-05 ||∇||=4.122323e-01 | Tr=0.1274 Te/Cur=0.1149 Te/Exp=0.1308]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.305329e+00 H=2.305258e+00 dV_dx=-7.490296e-06 dV_dθ=-6.332851e-05 ||∇||=4.122323e-01 | Tr=0.1274 Te/Cur=0.1149 Te/Exp=0.1308]100%|██████████| 2/2 [00:16<00:00,  8.20s/it, CE=2.305329e+00 H=2.305258e+00 dV_dx=-7.490296e-06 dV_dθ=-6.332851e-05 ||∇||=4.122323e-01 | Tr=0.1274 Te/Cur=0.1149 Te/Exp=0.1308]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.52s/it] 50%|█████     | 1/2 [00:14<00:12, 12.52s/it, CE=2.302780e+00 H=2.302678e+00 dV_dx=6.847062e-06 dV_dθ=-1.086099e-04 ||∇||=4.284279e-01 | Tr=0.1033 Te/Cur=0.1003 Te/Exp=0.1327]100%|██████████| 2/2 [00:14<00:00,  6.61s/it, CE=2.302780e+00 H=2.302678e+00 dV_dx=6.847062e-06 dV_dθ=-1.086099e-04 ||∇||=4.284279e-01 | Tr=0.1033 Te/Cur=0.1003 Te/Exp=0.1327]100%|██████████| 2/2 [00:14<00:00,  7.50s/it, CE=2.302780e+00 H=2.302678e+00 dV_dx=6.847062e-06 dV_dθ=-1.086099e-04 ||∇||=4.284279e-01 | Tr=0.1033 Te/Cur=0.1003 Te/Exp=0.1327]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.58s/it] 50%|█████     | 1/2 [00:15<00:12, 12.58s/it, CE=2.308635e+00 H=2.308472e+00 dV_dx=-1.432356e-05 dV_dθ=-1.493951e-04 ||∇||=4.320879e-01 | Tr=0.1614 Te/Cur=0.1748 Te/Exp=0.1018]100%|██████████| 2/2 [00:15<00:00,  7.17s/it, CE=2.308635e+00 H=2.308472e+00 dV_dx=-1.432356e-05 dV_dθ=-1.493951e-04 ||∇||=4.320879e-01 | Tr=0.1614 Te/Cur=0.1748 Te/Exp=0.1018]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.308635e+00 H=2.308472e+00 dV_dx=-1.432356e-05 dV_dθ=-1.493951e-04 ||∇||=4.320879e-01 | Tr=0.1614 Te/Cur=0.1748 Te/Exp=0.1018]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.10s/it] 50%|█████     | 1/2 [00:09<00:07,  7.10s/it, CE=2.292648e+00 H=2.292534e+00 dV_dx=1.307094e-06 dV_dθ=-1.153978e-04 ||∇||=4.800981e-01 | Tr=0.1651 Te/Cur=0.1922 Te/Exp=0.1896]100%|██████████| 2/2 [00:09<00:00,  4.57s/it, CE=2.292648e+00 H=2.292534e+00 dV_dx=1.307094e-06 dV_dθ=-1.153978e-04 ||∇||=4.800981e-01 | Tr=0.1651 Te/Cur=0.1922 Te/Exp=0.1896]100%|██████████| 2/2 [00:09<00:00,  4.95s/it, CE=2.292648e+00 H=2.292534e+00 dV_dx=1.307094e-06 dV_dθ=-1.153978e-04 ||∇||=4.800981e-01 | Tr=0.1651 Te/Cur=0.1922 Te/Exp=0.1896]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.12s/it] 50%|█████     | 1/2 [00:16<00:13, 13.12s/it, CE=2.312207e+00 H=2.312044e+00 dV_dx=-4.889453e-06 dV_dθ=-1.578958e-04 ||∇||=4.766796e-01 | Tr=0.0988 Te/Cur=0.1168 Te/Exp=0.1612]100%|██████████| 2/2 [00:16<00:00,  7.35s/it, CE=2.312207e+00 H=2.312044e+00 dV_dx=-4.889453e-06 dV_dθ=-1.578958e-04 ||∇||=4.766796e-01 | Tr=0.0988 Te/Cur=0.1168 Te/Exp=0.1612]100%|██████████| 2/2 [00:16<00:00,  8.22s/it, CE=2.312207e+00 H=2.312044e+00 dV_dx=-4.889453e-06 dV_dθ=-1.578958e-04 ||∇||=4.766796e-01 | Tr=0.0988 Te/Cur=0.1168 Te/Exp=0.1612]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.98s/it] 50%|█████     | 1/2 [00:15<00:12, 12.98s/it, CE=2.275579e+00 H=2.275479e+00 dV_dx=1.445879e-05 dV_dθ=-1.143822e-04 ||∇||=4.503465e-01 | Tr=0.1383 Te/Cur=0.1393 Te/Exp=0.2034]100%|██████████| 2/2 [00:15<00:00,  6.90s/it, CE=2.275579e+00 H=2.275479e+00 dV_dx=1.445879e-05 dV_dθ=-1.143822e-04 ||∇||=4.503465e-01 | Tr=0.1383 Te/Cur=0.1393 Te/Exp=0.2034]100%|██████████| 2/2 [00:15<00:00,  7.81s/it, CE=2.275579e+00 H=2.275479e+00 dV_dx=1.445879e-05 dV_dθ=-1.143822e-04 ||∇||=4.503465e-01 | Tr=0.1383 Te/Cur=0.1393 Te/Exp=0.2034]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 492, 84, 10]) with loss 2.275579
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.98s/it] 50%|█████     | 1/2 [00:15<00:12, 12.98s/it, CE=2.273739e+00 H=2.273643e+00 dV_dx=9.036076e-06 dV_dθ=-1.057482e-04 ||∇||=4.372714e-01 | Tr=0.1606 Te/Cur=0.1752 Te/Exp=0.1898]100%|██████████| 2/2 [00:15<00:00,  6.99s/it, CE=2.273739e+00 H=2.273643e+00 dV_dx=9.036076e-06 dV_dθ=-1.057482e-04 ||∇||=4.372714e-01 | Tr=0.1606 Te/Cur=0.1752 Te/Exp=0.1898]100%|██████████| 2/2 [00:15<00:00,  7.89s/it, CE=2.273739e+00 H=2.273643e+00 dV_dx=9.036076e-06 dV_dθ=-1.057482e-04 ||∇||=4.372714e-01 | Tr=0.1606 Te/Cur=0.1752 Te/Exp=0.1898]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 512, 84, 10]) with loss 2.273739
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.04s/it] 50%|█████     | 1/2 [00:15<00:13, 13.04s/it, CE=2.276584e+00 H=2.276515e+00 dV_dx=1.623587e-07 dV_dθ=-6.962548e-05 ||∇||=4.472492e-01 | Tr=0.1074 Te/Cur=0.1261 Te/Exp=0.1825]100%|██████████| 2/2 [00:15<00:00,  7.00s/it, CE=2.276584e+00 H=2.276515e+00 dV_dx=1.623587e-07 dV_dθ=-6.962548e-05 ||∇||=4.472492e-01 | Tr=0.1074 Te/Cur=0.1261 Te/Exp=0.1825]100%|██████████| 2/2 [00:15<00:00,  7.90s/it, CE=2.276584e+00 H=2.276515e+00 dV_dx=1.623587e-07 dV_dθ=-6.962548e-05 ||∇||=4.472492e-01 | Tr=0.1074 Te/Cur=0.1261 Te/Exp=0.1825]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.14s/it] 50%|█████     | 1/2 [00:16<00:13, 13.14s/it, CE=2.340868e+00 H=2.340792e+00 dV_dx=5.385079e-06 dV_dθ=-8.206731e-05 ||∇||=4.414864e-01 | Tr=0.1069 Te/Cur=0.1109 Te/Exp=0.1019]100%|██████████| 2/2 [00:16<00:00,  7.18s/it, CE=2.340868e+00 H=2.340792e+00 dV_dx=5.385079e-06 dV_dθ=-8.206731e-05 ||∇||=4.414864e-01 | Tr=0.1069 Te/Cur=0.1109 Te/Exp=0.1019]100%|██████████| 2/2 [00:16<00:00,  8.08s/it, CE=2.340868e+00 H=2.340792e+00 dV_dx=5.385079e-06 dV_dθ=-8.206731e-05 ||∇||=4.414864e-01 | Tr=0.1069 Te/Cur=0.1109 Te/Exp=0.1019]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.16s/it] 50%|█████     | 1/2 [00:15<00:13, 13.16s/it, CE=2.314706e+00 H=2.314646e+00 dV_dx=1.084785e-05 dV_dθ=-7.004868e-05 ||∇||=4.058001e-01 | Tr=0.1447 Te/Cur=0.1414 Te/Exp=0.1794]100%|██████████| 2/2 [00:15<00:00,  7.04s/it, CE=2.314706e+00 H=2.314646e+00 dV_dx=1.084785e-05 dV_dθ=-7.004868e-05 ||∇||=4.058001e-01 | Tr=0.1447 Te/Cur=0.1414 Te/Exp=0.1794]100%|██████████| 2/2 [00:15<00:00,  7.96s/it, CE=2.314706e+00 H=2.314646e+00 dV_dx=1.084785e-05 dV_dθ=-7.004868e-05 ||∇||=4.058001e-01 | Tr=0.1447 Te/Cur=0.1414 Te/Exp=0.1794]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.26s/it] 50%|█████     | 1/2 [00:15<00:12, 12.26s/it, CE=2.318535e+00 H=2.318403e+00 dV_dx=-9.103415e-06 dV_dθ=-1.226610e-04 ||∇||=4.228103e-01 | Tr=0.1761 Te/Cur=0.1852 Te/Exp=0.1529]100%|██████████| 2/2 [00:15<00:00,  6.71s/it, CE=2.318535e+00 H=2.318403e+00 dV_dx=-9.103415e-06 dV_dθ=-1.226610e-04 ||∇||=4.228103e-01 | Tr=0.1761 Te/Cur=0.1852 Te/Exp=0.1529]100%|██████████| 2/2 [00:15<00:00,  7.54s/it, CE=2.318535e+00 H=2.318403e+00 dV_dx=-9.103415e-06 dV_dθ=-1.226610e-04 ||∇||=4.228103e-01 | Tr=0.1761 Te/Cur=0.1852 Te/Exp=0.1529]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.61s/it] 50%|█████     | 1/2 [00:15<00:12, 12.61s/it, CE=2.333147e+00 H=2.333043e+00 dV_dx=-1.022426e-06 dV_dθ=-1.024128e-04 ||∇||=3.897353e-01 | Tr=0.1278 Te/Cur=0.1321 Te/Exp=0.1351]100%|██████████| 2/2 [00:15<00:00,  6.81s/it, CE=2.333147e+00 H=2.333043e+00 dV_dx=-1.022426e-06 dV_dθ=-1.024128e-04 ||∇||=3.897353e-01 | Tr=0.1278 Te/Cur=0.1321 Te/Exp=0.1351]100%|██████████| 2/2 [00:15<00:00,  7.68s/it, CE=2.333147e+00 H=2.333043e+00 dV_dx=-1.022426e-06 dV_dθ=-1.024128e-04 ||∇||=3.897353e-01 | Tr=0.1278 Te/Cur=0.1321 Te/Exp=0.1351]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.47s/it] 50%|█████     | 1/2 [00:15<00:12, 12.47s/it, CE=2.319504e+00 H=2.319395e+00 dV_dx=5.662526e-06 dV_dθ=-1.146493e-04 ||∇||=4.028206e-01 | Tr=0.0891 Te/Cur=0.1037 Te/Exp=0.1004]100%|██████████| 2/2 [00:15<00:00,  6.82s/it, CE=2.319504e+00 H=2.319395e+00 dV_dx=5.662526e-06 dV_dθ=-1.146493e-04 ||∇||=4.028206e-01 | Tr=0.0891 Te/Cur=0.1037 Te/Exp=0.1004]100%|██████████| 2/2 [00:15<00:00,  7.67s/it, CE=2.319504e+00 H=2.319395e+00 dV_dx=5.662526e-06 dV_dθ=-1.146493e-04 ||∇||=4.028206e-01 | Tr=0.0891 Te/Cur=0.1037 Te/Exp=0.1004]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.42s/it] 50%|█████     | 1/2 [00:15<00:12, 12.42s/it, CE=2.315459e+00 H=2.315280e+00 dV_dx=-3.227694e-06 dV_dθ=-1.760747e-04 ||∇||=4.418349e-01 | Tr=0.1573 Te/Cur=0.1722 Te/Exp=0.1539]100%|██████████| 2/2 [00:15<00:00,  6.96s/it, CE=2.315459e+00 H=2.315280e+00 dV_dx=-3.227694e-06 dV_dθ=-1.760747e-04 ||∇||=4.418349e-01 | Tr=0.1573 Te/Cur=0.1722 Te/Exp=0.1539]100%|██████████| 2/2 [00:15<00:00,  7.78s/it, CE=2.315459e+00 H=2.315280e+00 dV_dx=-3.227694e-06 dV_dθ=-1.760747e-04 ||∇||=4.418349e-01 | Tr=0.1573 Te/Cur=0.1722 Te/Exp=0.1539]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.74s/it] 50%|█████     | 1/2 [00:15<00:12, 12.74s/it, CE=2.308595e+00 H=2.308435e+00 dV_dx=-2.795478e-05 dV_dθ=-1.327646e-04 ||∇||=4.346741e-01 | Tr=0.1686 Te/Cur=0.1775 Te/Exp=0.1656]100%|██████████| 2/2 [00:15<00:00,  6.86s/it, CE=2.308595e+00 H=2.308435e+00 dV_dx=-2.795478e-05 dV_dθ=-1.327646e-04 ||∇||=4.346741e-01 | Tr=0.1686 Te/Cur=0.1775 Te/Exp=0.1656]100%|██████████| 2/2 [00:15<00:00,  7.74s/it, CE=2.308595e+00 H=2.308435e+00 dV_dx=-2.795478e-05 dV_dθ=-1.327646e-04 ||∇||=4.346741e-01 | Tr=0.1686 Te/Cur=0.1775 Te/Exp=0.1656]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.70s/it] 50%|█████     | 1/2 [00:15<00:12, 12.70s/it, CE=2.285402e+00 H=2.285295e+00 dV_dx=1.908160e-05 dV_dθ=-1.262140e-04 ||∇||=4.367771e-01 | Tr=0.1244 Te/Cur=0.1214 Te/Exp=0.2096]100%|██████████| 2/2 [00:15<00:00,  6.87s/it, CE=2.285402e+00 H=2.285295e+00 dV_dx=1.908160e-05 dV_dθ=-1.262140e-04 ||∇||=4.367771e-01 | Tr=0.1244 Te/Cur=0.1214 Te/Exp=0.2096]100%|██████████| 2/2 [00:15<00:00,  7.74s/it, CE=2.285402e+00 H=2.285295e+00 dV_dx=1.908160e-05 dV_dθ=-1.262140e-04 ||∇||=4.367771e-01 | Tr=0.1244 Te/Cur=0.1214 Te/Exp=0.2096]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.72s/it] 50%|█████     | 1/2 [00:16<00:13, 13.72s/it, CE=2.284793e+00 H=2.284684e+00 dV_dx=1.331408e-05 dV_dθ=-1.222508e-04 ||∇||=5.037005e-01 | Tr=0.1067 Te/Cur=0.1318 Te/Exp=0.1602]100%|██████████| 2/2 [00:16<00:00,  7.37s/it, CE=2.284793e+00 H=2.284684e+00 dV_dx=1.331408e-05 dV_dθ=-1.222508e-04 ||∇||=5.037005e-01 | Tr=0.1067 Te/Cur=0.1318 Te/Exp=0.1602]100%|██████████| 2/2 [00:16<00:00,  8.32s/it, CE=2.284793e+00 H=2.284684e+00 dV_dx=1.331408e-05 dV_dθ=-1.222508e-04 ||∇||=5.037005e-01 | Tr=0.1067 Te/Cur=0.1318 Te/Exp=0.1602]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.00s/it] 50%|█████     | 1/2 [00:16<00:13, 13.00s/it, CE=2.304695e+00 H=2.304491e+00 dV_dx=-3.629386e-06 dV_dθ=-2.005443e-04 ||∇||=4.885549e-01 | Tr=0.1441 Te/Cur=0.1681 Te/Exp=0.1396]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.304695e+00 H=2.304491e+00 dV_dx=-3.629386e-06 dV_dθ=-2.005443e-04 ||∇||=4.885549e-01 | Tr=0.1441 Te/Cur=0.1681 Te/Exp=0.1396]100%|██████████| 2/2 [00:16<00:00,  8.14s/it, CE=2.304695e+00 H=2.304491e+00 dV_dx=-3.629386e-06 dV_dθ=-2.005443e-04 ||∇||=4.885549e-01 | Tr=0.1441 Te/Cur=0.1681 Te/Exp=0.1396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.304694826271964
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.94s/it] 50%|█████     | 1/2 [00:06<00:03,  3.94s/it, CE=2.298757e+00 H=2.298560e+00 dV_dx=-3.490788e-06 dV_dθ=-1.930384e-04 ||∇||=4.767249e-01 | Tr=0.1440 Te/Cur=0.1220 Te/Exp=0.1026]100%|██████████| 2/2 [00:06<00:00,  3.10s/it, CE=2.298757e+00 H=2.298560e+00 dV_dx=-3.490788e-06 dV_dθ=-1.930384e-04 ||∇||=4.767249e-01 | Tr=0.1440 Te/Cur=0.1220 Te/Exp=0.1026]100%|██████████| 2/2 [00:06<00:00,  3.23s/it, CE=2.298757e+00 H=2.298560e+00 dV_dx=-3.490788e-06 dV_dθ=-1.930384e-04 ||∇||=4.767249e-01 | Tr=0.1440 Te/Cur=0.1220 Te/Exp=0.1026]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 44, 10]) with loss 2.298757
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.65s/it] 50%|█████     | 1/2 [00:16<00:13, 13.65s/it, CE=2.304077e+00 H=2.303918e+00 dV_dx=1.994422e-06 dV_dθ=-1.602199e-04 ||∇||=5.087760e-01 | Tr=0.1612 Te/Cur=0.1549 Te/Exp=0.1445]100%|██████████| 2/2 [00:16<00:00,  7.43s/it, CE=2.304077e+00 H=2.303918e+00 dV_dx=1.994422e-06 dV_dθ=-1.602199e-04 ||∇||=5.087760e-01 | Tr=0.1612 Te/Cur=0.1549 Te/Exp=0.1445]100%|██████████| 2/2 [00:16<00:00,  8.37s/it, CE=2.304077e+00 H=2.303918e+00 dV_dx=1.994422e-06 dV_dθ=-1.602199e-04 ||∇||=5.087760e-01 | Tr=0.1612 Te/Cur=0.1549 Te/Exp=0.1445]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.86s/it] 50%|█████     | 1/2 [00:15<00:12, 12.86s/it, CE=2.295355e+00 H=2.295200e+00 dV_dx=-1.520553e-05 dV_dθ=-1.394969e-04 ||∇||=4.954427e-01 | Tr=0.1391 Te/Cur=0.2200 Te/Exp=0.1801]100%|██████████| 2/2 [00:15<00:00,  6.80s/it, CE=2.295355e+00 H=2.295200e+00 dV_dx=-1.520553e-05 dV_dθ=-1.394969e-04 ||∇||=4.954427e-01 | Tr=0.1391 Te/Cur=0.2200 Te/Exp=0.1801]100%|██████████| 2/2 [00:15<00:00,  7.71s/it, CE=2.295355e+00 H=2.295200e+00 dV_dx=-1.520553e-05 dV_dθ=-1.394969e-04 ||∇||=4.954427e-01 | Tr=0.1391 Te/Cur=0.2200 Te/Exp=0.1801]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 472, 84, 10]) with loss 2.295355
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.28s/it] 50%|█████     | 1/2 [00:07<00:05,  5.28s/it, CE=2.279126e+00 H=2.279038e+00 dV_dx=-9.902484e-06 dV_dθ=-7.878745e-05 ||∇||=4.132228e-01 | Tr=0.1340 Te/Cur=0.1854 Te/Exp=0.1931]100%|██████████| 2/2 [00:07<00:00,  3.41s/it, CE=2.279126e+00 H=2.279038e+00 dV_dx=-9.902484e-06 dV_dθ=-7.878745e-05 ||∇||=4.132228e-01 | Tr=0.1340 Te/Cur=0.1854 Te/Exp=0.1931]100%|██████████| 2/2 [00:07<00:00,  3.70s/it, CE=2.279126e+00 H=2.279038e+00 dV_dx=-9.902484e-06 dV_dθ=-7.878745e-05 ||∇||=4.132228e-01 | Tr=0.1340 Te/Cur=0.1854 Te/Exp=0.1931]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 84, 10]) with loss 2.279126
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.23s/it] 50%|█████     | 1/2 [00:15<00:13, 13.23s/it, CE=2.275521e+00 H=2.275438e+00 dV_dx=1.314797e-06 dV_dθ=-8.444751e-05 ||∇||=4.495422e-01 | Tr=0.1744 Te/Cur=0.1935 Te/Exp=0.3236]100%|██████████| 2/2 [00:15<00:00,  6.95s/it, CE=2.275521e+00 H=2.275438e+00 dV_dx=1.314797e-06 dV_dθ=-8.444751e-05 ||∇||=4.495422e-01 | Tr=0.1744 Te/Cur=0.1935 Te/Exp=0.3236]100%|██████████| 2/2 [00:15<00:00,  7.89s/it, CE=2.275521e+00 H=2.275438e+00 dV_dx=1.314797e-06 dV_dθ=-8.444751e-05 ||∇||=4.495422e-01 | Tr=0.1744 Te/Cur=0.1935 Te/Exp=0.3236]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 84, 10]) with loss 2.275521
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.54s/it] 50%|█████     | 1/2 [00:16<00:13, 13.54s/it, CE=2.279416e+00 H=2.279316e+00 dV_dx=4.479583e-06 dV_dθ=-1.044356e-04 ||∇||=4.329982e-01 | Tr=0.0898 Te/Cur=0.0993 Te/Exp=0.2164]100%|██████████| 2/2 [00:16<00:00,  7.17s/it, CE=2.279416e+00 H=2.279316e+00 dV_dx=4.479583e-06 dV_dθ=-1.044356e-04 ||∇||=4.329982e-01 | Tr=0.0898 Te/Cur=0.0993 Te/Exp=0.2164]100%|██████████| 2/2 [00:16<00:00,  8.12s/it, CE=2.279416e+00 H=2.279316e+00 dV_dx=4.479583e-06 dV_dθ=-1.044356e-04 ||∇||=4.329982e-01 | Tr=0.0898 Te/Cur=0.0993 Te/Exp=0.2164]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.79s/it] 50%|█████     | 1/2 [00:16<00:13, 13.79s/it, CE=2.279035e+00 H=2.278924e+00 dV_dx=8.969064e-06 dV_dθ=-1.204055e-04 ||∇||=4.296011e-01 | Tr=0.1483 Te/Cur=0.1824 Te/Exp=0.2195]100%|██████████| 2/2 [00:16<00:00,  7.12s/it, CE=2.279035e+00 H=2.278924e+00 dV_dx=8.969064e-06 dV_dθ=-1.204055e-04 ||∇||=4.296011e-01 | Tr=0.1483 Te/Cur=0.1824 Te/Exp=0.2195]100%|██████████| 2/2 [00:16<00:00,  8.12s/it, CE=2.279035e+00 H=2.278924e+00 dV_dx=8.969064e-06 dV_dθ=-1.204055e-04 ||∇||=4.296011e-01 | Tr=0.1483 Te/Cur=0.1824 Te/Exp=0.2195]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.32s/it] 50%|█████     | 1/2 [00:15<00:13, 13.32s/it, CE=2.281772e+00 H=2.281729e+00 dV_dx=-5.989774e-06 dV_dθ=-3.632851e-05 ||∇||=4.377522e-01 | Tr=0.1662 Te/Cur=0.1754 Te/Exp=0.2470]100%|██████████| 2/2 [00:15<00:00,  6.95s/it, CE=2.281772e+00 H=2.281729e+00 dV_dx=-5.989774e-06 dV_dθ=-3.632851e-05 ||∇||=4.377522e-01 | Tr=0.1662 Te/Cur=0.1754 Te/Exp=0.2470]100%|██████████| 2/2 [00:15<00:00,  7.91s/it, CE=2.281772e+00 H=2.281729e+00 dV_dx=-5.989774e-06 dV_dθ=-3.632851e-05 ||∇||=4.377522e-01 | Tr=0.1662 Te/Cur=0.1754 Te/Exp=0.2470]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.33s/it] 50%|█████     | 1/2 [00:14<00:12, 12.33s/it, CE=2.299502e+00 H=2.299378e+00 dV_dx=1.689518e-05 dV_dθ=-1.409254e-04 ||∇||=4.353943e-01 | Tr=0.1648 Te/Cur=0.1651 Te/Exp=0.1180]100%|██████████| 2/2 [00:14<00:00,  6.60s/it, CE=2.299502e+00 H=2.299378e+00 dV_dx=1.689518e-05 dV_dθ=-1.409254e-04 ||∇||=4.353943e-01 | Tr=0.1648 Te/Cur=0.1651 Te/Exp=0.1180]100%|██████████| 2/2 [00:14<00:00,  7.46s/it, CE=2.299502e+00 H=2.299378e+00 dV_dx=1.689518e-05 dV_dθ=-1.409254e-04 ||∇||=4.353943e-01 | Tr=0.1648 Te/Cur=0.1651 Te/Exp=0.1180]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.16s/it] 50%|█████     | 1/2 [00:08<00:05,  5.16s/it, CE=2.290692e+00 H=2.290534e+00 dV_dx=-1.005243e-06 dV_dθ=-1.573946e-04 ||∇||=4.540690e-01 | Tr=0.1705 Te/Cur=0.1915 Te/Exp=0.1265]100%|██████████| 2/2 [00:08<00:00,  3.84s/it, CE=2.290692e+00 H=2.290534e+00 dV_dx=-1.005243e-06 dV_dθ=-1.573946e-04 ||∇||=4.540690e-01 | Tr=0.1705 Te/Cur=0.1915 Te/Exp=0.1265]100%|██████████| 2/2 [00:08<00:00,  4.04s/it, CE=2.290692e+00 H=2.290534e+00 dV_dx=-1.005243e-06 dV_dθ=-1.573946e-04 ||∇||=4.540690e-01 | Tr=0.1705 Te/Cur=0.1915 Te/Exp=0.1265]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.65s/it] 50%|█████     | 1/2 [00:16<00:13, 13.65s/it, CE=2.300798e+00 H=2.300668e+00 dV_dx=1.809294e-05 dV_dθ=-1.482832e-04 ||∇||=4.384447e-01 | Tr=0.1617 Te/Cur=0.1696 Te/Exp=0.1746]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.300798e+00 H=2.300668e+00 dV_dx=1.809294e-05 dV_dθ=-1.482832e-04 ||∇||=4.384447e-01 | Tr=0.1617 Te/Cur=0.1696 Te/Exp=0.1746]100%|██████████| 2/2 [00:16<00:00,  8.16s/it, CE=2.300798e+00 H=2.300668e+00 dV_dx=1.809294e-05 dV_dθ=-1.482832e-04 ||∇||=4.384447e-01 | Tr=0.1617 Te/Cur=0.1696 Te/Exp=0.1746]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.01s/it] 50%|█████     | 1/2 [00:16<00:13, 13.01s/it, CE=2.271111e+00 H=2.271016e+00 dV_dx=-9.231817e-06 dV_dθ=-8.535574e-05 ||∇||=4.727179e-01 | Tr=0.2631 Te/Cur=0.3205 Te/Exp=0.1716]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.271111e+00 H=2.271016e+00 dV_dx=-9.231817e-06 dV_dθ=-8.535574e-05 ||∇||=4.727179e-01 | Tr=0.2631 Te/Cur=0.3205 Te/Exp=0.1716]100%|██████████| 2/2 [00:16<00:00,  8.08s/it, CE=2.271111e+00 H=2.271016e+00 dV_dx=-9.231817e-06 dV_dθ=-8.535574e-05 ||∇||=4.727179e-01 | Tr=0.2631 Te/Cur=0.3205 Te/Exp=0.1716]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 472, 84, 10]) with loss 2.271111
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.08s/it] 50%|█████     | 1/2 [00:08<00:05,  5.08s/it, CE=2.264811e+00 H=2.264704e+00 dV_dx=1.296398e-05 dV_dθ=-1.203832e-04 ||∇||=4.836098e-01 | Tr=0.2231 Te/Cur=0.2703 Te/Exp=0.1775]100%|██████████| 2/2 [00:08<00:00,  3.98s/it, CE=2.264811e+00 H=2.264704e+00 dV_dx=1.296398e-05 dV_dθ=-1.203832e-04 ||∇||=4.836098e-01 | Tr=0.2231 Te/Cur=0.2703 Te/Exp=0.1775]100%|██████████| 2/2 [00:08<00:00,  4.15s/it, CE=2.264811e+00 H=2.264704e+00 dV_dx=1.296398e-05 dV_dθ=-1.203832e-04 ||∇||=4.836098e-01 | Tr=0.2231 Te/Cur=0.2703 Te/Exp=0.1775]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 512, 84, 10]) with loss 2.264811
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.37s/it] 50%|█████     | 1/2 [00:16<00:13, 13.37s/it, CE=2.253481e+00 H=2.253385e+00 dV_dx=4.039400e-06 dV_dθ=-9.982559e-05 ||∇||=4.372104e-01 | Tr=0.2481 Te/Cur=0.3151 Te/Exp=0.3159]100%|██████████| 2/2 [00:16<00:00,  7.23s/it, CE=2.253481e+00 H=2.253385e+00 dV_dx=4.039400e-06 dV_dθ=-9.982559e-05 ||∇||=4.372104e-01 | Tr=0.2481 Te/Cur=0.3151 Te/Exp=0.3159]100%|██████████| 2/2 [00:16<00:00,  8.15s/it, CE=2.253481e+00 H=2.253385e+00 dV_dx=4.039400e-06 dV_dθ=-9.982559e-05 ||∇||=4.372104e-01 | Tr=0.2481 Te/Cur=0.3151 Te/Exp=0.3159]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 552, 84, 10]) with loss 2.253481
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.43s/it] 50%|█████     | 1/2 [00:15<00:12, 12.43s/it, CE=2.248948e+00 H=2.248875e+00 dV_dx=-1.644353e-05 dV_dθ=-5.655133e-05 ||∇||=4.461458e-01 | Tr=0.1700 Te/Cur=0.1900 Te/Exp=0.2886]100%|██████████| 2/2 [00:15<00:00,  6.76s/it, CE=2.248948e+00 H=2.248875e+00 dV_dx=-1.644353e-05 dV_dθ=-5.655133e-05 ||∇||=4.461458e-01 | Tr=0.1700 Te/Cur=0.1900 Te/Exp=0.2886]100%|██████████| 2/2 [00:15<00:00,  7.61s/it, CE=2.248948e+00 H=2.248875e+00 dV_dx=-1.644353e-05 dV_dθ=-5.655133e-05 ||∇||=4.461458e-01 | Tr=0.1700 Te/Cur=0.1900 Te/Exp=0.2886]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 472, 124, 10]) with loss 2.248948
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.50s/it] 50%|█████     | 1/2 [00:16<00:12, 12.50s/it, CE=2.256656e+00 H=2.256470e+00 dV_dx=-1.573686e-05 dV_dθ=-1.699976e-04 ||∇||=4.963002e-01 | Tr=0.2520 Te/Cur=0.3317 Te/Exp=0.3130]100%|██████████| 2/2 [00:16<00:00,  7.25s/it, CE=2.256656e+00 H=2.256470e+00 dV_dx=-1.573686e-05 dV_dθ=-1.699976e-04 ||∇||=4.963002e-01 | Tr=0.2520 Te/Cur=0.3317 Te/Exp=0.3130]100%|██████████| 2/2 [00:16<00:00,  8.04s/it, CE=2.256656e+00 H=2.256470e+00 dV_dx=-1.573686e-05 dV_dθ=-1.699976e-04 ||∇||=4.963002e-01 | Tr=0.2520 Te/Cur=0.3317 Te/Exp=0.3130]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.11s/it] 50%|█████     | 1/2 [00:15<00:13, 13.11s/it, CE=2.253843e+00 H=2.253765e+00 dV_dx=-8.235863e-06 dV_dθ=-6.992010e-05 ||∇||=4.378200e-01 | Tr=0.1598 Te/Cur=0.2346 Te/Exp=0.2805]100%|██████████| 2/2 [00:15<00:00,  7.01s/it, CE=2.253843e+00 H=2.253765e+00 dV_dx=-8.235863e-06 dV_dθ=-6.992010e-05 ||∇||=4.378200e-01 | Tr=0.1598 Te/Cur=0.2346 Te/Exp=0.2805]100%|██████████| 2/2 [00:15<00:00,  7.92s/it, CE=2.253843e+00 H=2.253765e+00 dV_dx=-8.235863e-06 dV_dθ=-6.992010e-05 ||∇||=4.378200e-01 | Tr=0.1598 Te/Cur=0.2346 Te/Exp=0.2805]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.76s/it] 50%|█████     | 1/2 [00:15<00:12, 12.76s/it, CE=2.300884e+00 H=2.300614e+00 dV_dx=-2.711827e-05 dV_dθ=-2.434980e-04 ||∇||=5.197455e-01 | Tr=0.1486 Te/Cur=0.1583 Te/Exp=0.1533]100%|██████████| 2/2 [00:15<00:00,  6.98s/it, CE=2.300884e+00 H=2.300614e+00 dV_dx=-2.711827e-05 dV_dθ=-2.434980e-04 ||∇||=5.197455e-01 | Tr=0.1486 Te/Cur=0.1583 Te/Exp=0.1533]100%|██████████| 2/2 [00:15<00:00,  7.84s/it, CE=2.300884e+00 H=2.300614e+00 dV_dx=-2.711827e-05 dV_dθ=-2.434980e-04 ||∇||=5.197455e-01 | Tr=0.1486 Te/Cur=0.1583 Te/Exp=0.1533]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.35s/it] 50%|█████     | 1/2 [00:06<00:04,  4.35s/it, CE=2.301509e+00 H=2.301500e+00 dV_dx=1.924836e-05 dV_dθ=-2.760504e-05 ||∇||=4.008281e-01 | Tr=0.0995 Te/Cur=0.1038 Te/Exp=0.0994]100%|██████████| 2/2 [00:06<00:00,  3.26s/it, CE=2.301509e+00 H=2.301500e+00 dV_dx=1.924836e-05 dV_dθ=-2.760504e-05 ||∇||=4.008281e-01 | Tr=0.0995 Te/Cur=0.1038 Te/Exp=0.0994]100%|██████████| 2/2 [00:06<00:00,  3.43s/it, CE=2.301509e+00 H=2.301500e+00 dV_dx=1.924836e-05 dV_dθ=-2.760504e-05 ||∇||=4.008281e-01 | Tr=0.0995 Te/Cur=0.1038 Te/Exp=0.0994]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.54s/it] 50%|█████     | 1/2 [00:16<00:13, 13.54s/it, CE=2.275127e+00 H=2.274979e+00 dV_dx=1.267341e-05 dV_dθ=-1.609025e-04 ||∇||=4.796838e-01 | Tr=0.0988 Te/Cur=0.1007 Te/Exp=0.1679]100%|██████████| 2/2 [00:16<00:00,  7.11s/it, CE=2.275127e+00 H=2.274979e+00 dV_dx=1.267341e-05 dV_dθ=-1.609025e-04 ||∇||=4.796838e-01 | Tr=0.0988 Te/Cur=0.1007 Te/Exp=0.1679]100%|██████████| 2/2 [00:16<00:00,  8.08s/it, CE=2.275127e+00 H=2.274979e+00 dV_dx=1.267341e-05 dV_dθ=-1.609025e-04 ||∇||=4.796838e-01 | Tr=0.0988 Te/Cur=0.1007 Te/Exp=0.1679]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.08s/it] 50%|█████     | 1/2 [00:15<00:13, 13.08s/it, CE=2.260705e+00 H=2.260604e+00 dV_dx=-1.210395e-05 dV_dθ=-8.926613e-05 ||∇||=4.350249e-01 | Tr=0.1645 Te/Cur=0.1528 Te/Exp=0.2047]100%|██████████| 2/2 [00:15<00:00,  6.90s/it, CE=2.260705e+00 H=2.260604e+00 dV_dx=-1.210395e-05 dV_dθ=-8.926613e-05 ||∇||=4.350249e-01 | Tr=0.1645 Te/Cur=0.1528 Te/Exp=0.2047]100%|██████████| 2/2 [00:15<00:00,  7.83s/it, CE=2.260705e+00 H=2.260604e+00 dV_dx=-1.210395e-05 dV_dθ=-8.926613e-05 ||∇||=4.350249e-01 | Tr=0.1645 Te/Cur=0.1528 Te/Exp=0.2047]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.48s/it] 50%|█████     | 1/2 [00:07<00:04,  4.48s/it, CE=2.251345e+00 H=2.251279e+00 dV_dx=3.155540e-06 dV_dθ=-6.877330e-05 ||∇||=4.930299e-01 | Tr=0.0822 Te/Cur=0.0946 Te/Exp=0.1610]100%|██████████| 2/2 [00:07<00:00,  3.50s/it, CE=2.251345e+00 H=2.251279e+00 dV_dx=3.155540e-06 dV_dθ=-6.877330e-05 ||∇||=4.930299e-01 | Tr=0.0822 Te/Cur=0.0946 Te/Exp=0.1610]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.251345e+00 H=2.251279e+00 dV_dx=3.155540e-06 dV_dθ=-6.877330e-05 ||∇||=4.930299e-01 | Tr=0.0822 Te/Cur=0.0946 Te/Exp=0.1610]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.71s/it] 50%|█████     | 1/2 [00:16<00:13, 13.71s/it, CE=2.220848e+00 H=2.220757e+00 dV_dx=2.289465e-07 dV_dθ=-9.049129e-05 ||∇||=5.042011e-01 | Tr=0.0981 Te/Cur=0.1302 Te/Exp=0.3632]100%|██████████| 2/2 [00:16<00:00,  7.16s/it, CE=2.220848e+00 H=2.220757e+00 dV_dx=2.289465e-07 dV_dθ=-9.049129e-05 ||∇||=5.042011e-01 | Tr=0.0981 Te/Cur=0.1302 Te/Exp=0.3632]100%|██████████| 2/2 [00:16<00:00,  8.14s/it, CE=2.220848e+00 H=2.220757e+00 dV_dx=2.289465e-07 dV_dθ=-9.049129e-05 ||∇||=5.042011e-01 | Tr=0.0981 Te/Cur=0.1302 Te/Exp=0.3632]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 552, 84, 10]) with loss 2.220848
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.75s/it] 50%|█████     | 1/2 [00:15<00:12, 12.75s/it, CE=2.268321e+00 H=2.268137e+00 dV_dx=-1.582231e-05 dV_dθ=-1.689050e-04 ||∇||=5.118408e-01 | Tr=0.0609 Te/Cur=0.0651 Te/Exp=0.1296]100%|██████████| 2/2 [00:15<00:00,  6.89s/it, CE=2.268321e+00 H=2.268137e+00 dV_dx=-1.582231e-05 dV_dθ=-1.689050e-04 ||∇||=5.118408e-01 | Tr=0.0609 Te/Cur=0.0651 Te/Exp=0.1296]100%|██████████| 2/2 [00:15<00:00,  7.77s/it, CE=2.268321e+00 H=2.268137e+00 dV_dx=-1.582231e-05 dV_dθ=-1.689050e-04 ||∇||=5.118408e-01 | Tr=0.0609 Te/Cur=0.0651 Te/Exp=0.1296]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.91s/it] 50%|█████     | 1/2 [00:15<00:12, 12.91s/it, CE=2.259194e+00 H=2.259071e+00 dV_dx=-1.616074e-05 dV_dθ=-1.069029e-04 ||∇||=4.720802e-01 | Tr=0.1003 Te/Cur=0.1296 Te/Exp=0.1337]100%|██████████| 2/2 [00:15<00:00,  7.03s/it, CE=2.259194e+00 H=2.259071e+00 dV_dx=-1.616074e-05 dV_dθ=-1.069029e-04 ||∇||=4.720802e-01 | Tr=0.1003 Te/Cur=0.1296 Te/Exp=0.1337]100%|██████████| 2/2 [00:15<00:00,  7.92s/it, CE=2.259194e+00 H=2.259071e+00 dV_dx=-1.616074e-05 dV_dθ=-1.069029e-04 ||∇||=4.720802e-01 | Tr=0.1003 Te/Cur=0.1296 Te/Exp=0.1337]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.87s/it] 50%|█████     | 1/2 [00:15<00:12, 12.87s/it, CE=2.247804e+00 H=2.247728e+00 dV_dx=8.095130e-06 dV_dθ=-8.372587e-05 ||∇||=5.127817e-01 | Tr=0.1644 Te/Cur=0.1705 Te/Exp=0.2066]100%|██████████| 2/2 [00:15<00:00,  7.08s/it, CE=2.247804e+00 H=2.247728e+00 dV_dx=8.095130e-06 dV_dθ=-8.372587e-05 ||∇||=5.127817e-01 | Tr=0.1644 Te/Cur=0.1705 Te/Exp=0.2066]100%|██████████| 2/2 [00:15<00:00,  7.95s/it, CE=2.247804e+00 H=2.247728e+00 dV_dx=8.095130e-06 dV_dθ=-8.372587e-05 ||∇||=5.127817e-01 | Tr=0.1644 Te/Cur=0.1705 Te/Exp=0.2066]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (4, [432, 552, 84, 10]) with loss 2.220848
  Total candidates evaluated: 54
  Original: (3, [507, 512, 64, 10])
  Optimal: (4, [432, 552, 84, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 3→4, feed [507, 512, 64, 10]→[432, 552, 84, 10]
  Conv filter changed: A_conv/B_conv shape = (4, 3)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:19<06:01, 19.00s/it]  5%|▌         | 1/20 [00:23<06:01, 19.00s/it, CE=1.545236e+00 H=1.544177e+00 dV_dx=-1.175544e-05 dV_dθ=-1.047288e-03 ||∇||=1.193268e+00 | Tr=0.7303] 10%|█         | 2/20 [00:23<03:12, 10.69s/it, CE=1.545236e+00 H=1.544177e+00 dV_dx=-1.175544e-05 dV_dθ=-1.047288e-03 ||∇||=1.193268e+00 | Tr=0.7303] 10%|█         | 2/20 [00:28<03:12, 10.69s/it, CE=1.311477e+00 H=1.309317e+00 dV_dx=2.698965e-05 dV_dθ=-2.187522e-03 ||∇||=1.614408e+00 | Tr=0.7303]  15%|█▌        | 3/20 [00:28<02:14,  7.92s/it, CE=1.311477e+00 H=1.309317e+00 dV_dx=2.698965e-05 dV_dθ=-2.187522e-03 ||∇||=1.614408e+00 | Tr=0.7303] 15%|█▌        | 3/20 [00:33<02:14,  7.92s/it, CE=1.179045e+00 H=1.176604e+00 dV_dx=-7.853685e-06 dV_dθ=-2.433360e-03 ||∇||=1.731946e+00 | Tr=0.7303] 20%|██        | 4/20 [00:33<01:45,  6.62s/it, CE=1.179045e+00 H=1.176604e+00 dV_dx=-7.853685e-06 dV_dθ=-2.433360e-03 ||∇||=1.731946e+00 | Tr=0.7303] 20%|██        | 4/20 [00:37<01:45,  6.62s/it, CE=1.081882e+00 H=1.079695e+00 dV_dx=1.770877e-05 dV_dθ=-2.204552e-03 ||∇||=1.738187e+00 | Tr=0.7303]  25%|██▌       | 5/20 [00:37<01:27,  5.86s/it, CE=1.081882e+00 H=1.079695e+00 dV_dx=1.770877e-05 dV_dθ=-2.204552e-03 ||∇||=1.738187e+00 | Tr=0.7303] 25%|██▌       | 5/20 [00:42<01:27,  5.86s/it, CE=1.006641e+00 H=1.004281e+00 dV_dx=-2.426923e-05 dV_dθ=-2.335603e-03 ||∇||=1.830685e+00 | Tr=0.7303] 30%|███       | 6/20 [00:42<01:15,  5.36s/it, CE=1.006641e+00 H=1.004281e+00 dV_dx=-2.426923e-05 dV_dθ=-2.335603e-03 ||∇||=1.830685e+00 | Tr=0.7303] 30%|███       | 6/20 [00:46<01:15,  5.36s/it, CE=9.480735e-01 H=9.455927e-01 dV_dx=-3.345003e-05 dV_dθ=-2.447289e-03 ||∇||=1.905301e+00 | Tr=0.7303] 35%|███▌      | 7/20 [00:46<01:04,  4.99s/it, CE=9.480735e-01 H=9.455927e-01 dV_dx=-3.345003e-05 dV_dθ=-2.447289e-03 ||∇||=1.905301e+00 | Tr=0.7303] 35%|███▌      | 7/20 [00:51<01:04,  4.99s/it, CE=9.019413e-01 H=8.995436e-01 dV_dx=5.065273e-05 dV_dθ=-2.448350e-03 ||∇||=1.943237e+00 | Tr=0.7303]  40%|████      | 8/20 [00:51<00:59,  4.93s/it, CE=9.019413e-01 H=8.995436e-01 dV_dx=5.065273e-05 dV_dθ=-2.448350e-03 ||∇||=1.943237e+00 | Tr=0.7303] 40%|████      | 8/20 [00:55<00:59,  4.93s/it, CE=8.642213e-01 H=8.620681e-01 dV_dx=-3.952236e-06 dV_dθ=-2.149286e-03 ||∇||=1.893450e+00 | Tr=0.7303] 45%|████▌     | 9/20 [00:55<00:53,  4.84s/it, CE=8.642213e-01 H=8.620681e-01 dV_dx=-3.952236e-06 dV_dθ=-2.149286e-03 ||∇||=1.893450e+00 | Tr=0.7303] 45%|████▌     | 9/20 [00:59<00:53,  4.84s/it, CE=8.334716e-01 H=8.314142e-01 dV_dx=2.430149e-05 dV_dθ=-2.081770e-03 ||∇||=1.911754e+00 | Tr=0.7303]  50%|█████     | 10/20 [00:59<00:46,  4.64s/it, CE=8.334716e-01 H=8.314142e-01 dV_dx=2.430149e-05 dV_dθ=-2.081770e-03 ||∇||=1.911754e+00 | Tr=0.7303] 50%|█████     | 10/20 [01:04<00:46,  4.64s/it, CE=8.073737e-01 H=8.053734e-01 dV_dx=4.961897e-05 dV_dθ=-2.049932e-03 ||∇||=1.933772e+00 | Tr=0.7303] 55%|█████▌    | 11/20 [01:04<00:42,  4.77s/it, CE=8.073737e-01 H=8.053734e-01 dV_dx=4.961897e-05 dV_dθ=-2.049932e-03 ||∇||=1.933772e+00 | Tr=0.7303] 55%|█████▌    | 11/20 [01:09<00:42,  4.77s/it, CE=7.849551e-01 H=7.829148e-01 dV_dx=1.470326e-05 dV_dθ=-2.054972e-03 ||∇||=1.962154e+00 | Tr=0.7303] 60%|██████    | 12/20 [01:09<00:37,  4.69s/it, CE=7.849551e-01 H=7.829148e-01 dV_dx=1.470326e-05 dV_dθ=-2.054972e-03 ||∇||=1.962154e+00 | Tr=0.7303] 60%|██████    | 12/20 [01:14<00:37,  4.69s/it, CE=7.654125e-01 H=7.632946e-01 dV_dx=7.410518e-06 dV_dθ=-2.125340e-03 ||∇||=2.011089e+00 | Tr=0.7303] 65%|██████▌   | 13/20 [01:14<00:32,  4.71s/it, CE=7.654125e-01 H=7.632946e-01 dV_dx=7.410518e-06 dV_dθ=-2.125340e-03 ||∇||=2.011089e+00 | Tr=0.7303] 65%|██████▌   | 13/20 [01:18<00:32,  4.71s/it, CE=7.482187e-01 H=7.459094e-01 dV_dx=-6.836405e-05 dV_dθ=-2.240931e-03 ||∇||=2.072042e+00 | Tr=0.7303] 70%|███████   | 14/20 [01:18<00:28,  4.71s/it, CE=7.482187e-01 H=7.459094e-01 dV_dx=-6.836405e-05 dV_dθ=-2.240931e-03 ||∇||=2.072042e+00 | Tr=0.7303] 70%|███████   | 14/20 [01:23<00:28,  4.71s/it, CE=7.328584e-01 H=7.305114e-01 dV_dx=1.437236e-05 dV_dθ=-2.361331e-03 ||∇||=2.115096e+00 | Tr=0.7303]  75%|███████▌  | 15/20 [01:23<00:23,  4.69s/it, CE=7.328584e-01 H=7.305114e-01 dV_dx=1.437236e-05 dV_dθ=-2.361331e-03 ||∇||=2.115096e+00 | Tr=0.7303] 75%|███████▌  | 15/20 [01:28<00:23,  4.69s/it, CE=7.184854e-01 H=7.162550e-01 dV_dx=8.282957e-05 dV_dθ=-2.313277e-03 ||∇||=2.118508e+00 | Tr=0.7303] 80%|████████  | 16/20 [01:28<00:18,  4.62s/it, CE=7.184854e-01 H=7.162550e-01 dV_dx=8.282957e-05 dV_dθ=-2.313277e-03 ||∇||=2.118508e+00 | Tr=0.7303] 80%|████████  | 16/20 [01:33<00:18,  4.62s/it, CE=7.046024e-01 H=7.024747e-01 dV_dx=2.651134e-05 dV_dθ=-2.154264e-03 ||∇||=2.082741e+00 | Tr=0.7303] 85%|████████▌ | 17/20 [01:33<00:14,  4.73s/it, CE=7.046024e-01 H=7.024747e-01 dV_dx=2.651134e-05 dV_dθ=-2.154264e-03 ||∇||=2.082741e+00 | Tr=0.7303] 85%|████████▌ | 17/20 [01:38<00:14,  4.73s/it, CE=6.916758e-01 H=6.897492e-01 dV_dx=5.325076e-05 dV_dθ=-1.979810e-03 ||∇||=2.039121e+00 | Tr=0.7303] 90%|█████████ | 18/20 [01:38<00:09,  4.85s/it, CE=6.916758e-01 H=6.897492e-01 dV_dx=5.325076e-05 dV_dθ=-1.979810e-03 ||∇||=2.039121e+00 | Tr=0.7303] 90%|█████████ | 18/20 [01:43<00:09,  4.85s/it, CE=6.798731e-01 H=6.778455e-01 dV_dx=-7.706810e-05 dV_dθ=-1.950483e-03 ||∇||=2.034525e+00 | Tr=0.7303] 95%|█████████▌| 19/20 [01:43<00:04,  4.95s/it, CE=6.798731e-01 H=6.778455e-01 dV_dx=-7.706810e-05 dV_dθ=-1.950483e-03 ||∇||=2.034525e+00 | Tr=0.7303] 95%|█████████▌| 19/20 [01:50<00:04,  4.95s/it, CE=6.687835e-01 H=6.669465e-01 dV_dx=1.600882e-05 dV_dθ=-1.853016e-03 ||∇||=2.015725e+00 | Tr=0.7303 Te/Cur=0.9405 Te/Exp=0.7751]100%|██████████| 20/20 [02:00<00:00,  8.61s/it, CE=6.687835e-01 H=6.669465e-01 dV_dx=1.600882e-05 dV_dθ=-1.853016e-03 ||∇||=2.015725e+00 | Tr=0.7303 Te/Cur=0.9405 Te/Exp=0.7751]100%|██████████| 20/20 [02:00<00:00,  6.02s/it, CE=6.687835e-01 H=6.669465e-01 dV_dx=1.600882e-05 dV_dθ=-1.853016e-03 ||∇||=2.015725e+00 | Tr=0.7303 Te/Cur=0.9405 Te/Exp=0.7751]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.668784

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.14s/it] 50%|█████     | 1/2 [00:18<00:12, 12.14s/it, CE=6.487240e-01 H=6.484302e-01 dV_dx=-5.891019e-05 dV_dθ=-2.348326e-04 ||∇||=6.734933e-01 | Tr=0.9511 Te/Cur=0.9438 Te/Exp=0.7780]100%|██████████| 2/2 [00:18<00:00,  8.77s/it, CE=6.487240e-01 H=6.484302e-01 dV_dx=-5.891019e-05 dV_dθ=-2.348326e-04 ||∇||=6.734933e-01 | Tr=0.9511 Te/Cur=0.9438 Te/Exp=0.7780]100%|██████████| 2/2 [00:18<00:00,  9.28s/it, CE=6.487240e-01 H=6.484302e-01 dV_dx=-5.891019e-05 dV_dθ=-2.348326e-04 ||∇||=6.734933e-01 | Tr=0.9511 Te/Cur=0.9438 Te/Exp=0.7780]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<02:51,  9.04s/it]  5%|▌         | 1/20 [00:13<02:51,  9.04s/it, CE=6.422712e-01 H=6.421288e-01 dV_dx=8.184580e-05 dV_dθ=-2.242830e-04 ||∇||=7.085044e-01 | Tr=0.9528] 10%|█         | 2/20 [00:13<01:56,  6.45s/it, CE=6.422712e-01 H=6.421288e-01 dV_dx=8.184580e-05 dV_dθ=-2.242830e-04 ||∇||=7.085044e-01 | Tr=0.9528] 10%|█         | 2/20 [00:18<01:56,  6.45s/it, CE=6.388592e-01 H=6.386412e-01 dV_dx=9.093783e-06 dV_dθ=-2.271301e-04 ||∇||=7.154341e-01 | Tr=0.9533] 15%|█▌        | 3/20 [00:18<01:38,  5.79s/it, CE=6.388592e-01 H=6.386412e-01 dV_dx=9.093783e-06 dV_dθ=-2.271301e-04 ||∇||=7.154341e-01 | Tr=0.9533] 15%|█▌        | 3/20 [00:23<01:38,  5.79s/it, CE=6.354841e-01 H=6.352237e-01 dV_dx=-3.252915e-05 dV_dθ=-2.278813e-04 ||∇||=7.168702e-01 | Tr=0.9541] 20%|██        | 4/20 [00:23<01:25,  5.33s/it, CE=6.354841e-01 H=6.352237e-01 dV_dx=-3.252915e-05 dV_dθ=-2.278813e-04 ||∇||=7.168702e-01 | Tr=0.9541] 20%|██        | 4/20 [00:28<01:25,  5.33s/it, CE=6.322269e-01 H=6.318789e-01 dV_dx=-1.220737e-04 dV_dθ=-2.259599e-04 ||∇||=7.188139e-01 | Tr=0.9547] 25%|██▌       | 5/20 [00:28<01:18,  5.24s/it, CE=6.322269e-01 H=6.318789e-01 dV_dx=-1.220737e-04 dV_dθ=-2.259599e-04 ||∇||=7.188139e-01 | Tr=0.9547] 25%|██▌       | 5/20 [00:35<01:18,  5.24s/it, CE=6.290617e-01 H=6.289298e-01 dV_dx=9.687419e-05 dV_dθ=-2.287917e-04 ||∇||=7.214875e-01 | Tr=0.9555 Te/Cur=0.9480 Te/Exp=0.7838] 30%|███       | 6/20 [00:35<01:21,  5.81s/it, CE=6.290617e-01 H=6.289298e-01 dV_dx=9.687419e-05 dV_dθ=-2.287917e-04 ||∇||=7.214875e-01 | Tr=0.9555 Te/Cur=0.9480 Te/Exp=0.7838] 30%|███       | 6/20 [00:40<01:21,  5.81s/it, CE=6.259225e-01 H=6.257464e-01 dV_dx=5.271446e-05 dV_dθ=-2.288024e-04 ||∇||=7.229536e-01 | Tr=0.9563]                             35%|███▌      | 7/20 [00:40<01:12,  5.57s/it, CE=6.259225e-01 H=6.257464e-01 dV_dx=5.271446e-05 dV_dθ=-2.288024e-04 ||∇||=7.229536e-01 | Tr=0.9563] 35%|███▌      | 7/20 [00:45<01:12,  5.57s/it, CE=6.228358e-01 H=6.226373e-01 dV_dx=3.263002e-05 dV_dθ=-2.310728e-04 ||∇||=7.244600e-01 | Tr=0.9568] 40%|████      | 8/20 [00:45<01:03,  5.28s/it, CE=6.228358e-01 H=6.226373e-01 dV_dx=3.263002e-05 dV_dθ=-2.310728e-04 ||∇||=7.244600e-01 | Tr=0.9568] 40%|████      | 8/20 [00:49<01:03,  5.28s/it, CE=6.198262e-01 H=6.196539e-01 dV_dx=6.194831e-05 dV_dθ=-2.343110e-04 ||∇||=7.275863e-01 | Tr=0.9573] 45%|████▌     | 9/20 [00:49<00:56,  5.17s/it, CE=6.198262e-01 H=6.196539e-01 dV_dx=6.194831e-05 dV_dθ=-2.343110e-04 ||∇||=7.275863e-01 | Tr=0.9573] 45%|████▌     | 9/20 [00:54<00:56,  5.17s/it, CE=6.168499e-01 H=6.164872e-01 dV_dx=-1.272586e-04 dV_dθ=-2.354095e-04 ||∇||=7.297836e-01 | Tr=0.9579] 50%|█████     | 10/20 [00:54<00:49,  4.96s/it, CE=6.168499e-01 H=6.164872e-01 dV_dx=-1.272586e-04 dV_dθ=-2.354095e-04 ||∇||=7.297836e-01 | Tr=0.9579] 50%|█████     | 10/20 [01:00<00:49,  4.96s/it, CE=6.139066e-01 H=6.138257e-01 dV_dx=1.551698e-04 dV_dθ=-2.360018e-04 ||∇||=7.318802e-01 | Tr=0.9587 Te/Cur=0.9513 Te/Exp=0.7869] 55%|█████▌    | 11/20 [01:00<00:48,  5.43s/it, CE=6.139066e-01 H=6.138257e-01 dV_dx=1.551698e-04 dV_dθ=-2.360018e-04 ||∇||=7.318802e-01 | Tr=0.9587 Te/Cur=0.9513 Te/Exp=0.7869] 55%|█████▌    | 11/20 [01:05<00:48,  5.43s/it, CE=6.110590e-01 H=6.106770e-01 dV_dx=-1.427860e-04 dV_dθ=-2.392583e-04 ||∇||=7.344450e-01 | Tr=0.9592]                            60%|██████    | 12/20 [01:05<00:42,  5.28s/it, CE=6.110590e-01 H=6.106770e-01 dV_dx=-1.427860e-04 dV_dθ=-2.392583e-04 ||∇||=7.344450e-01 | Tr=0.9592] 60%|██████    | 12/20 [01:10<00:42,  5.28s/it, CE=6.083096e-01 H=6.079604e-01 dV_dx=-1.079347e-04 dV_dθ=-2.412317e-04 ||∇||=7.364810e-01 | Tr=0.9596] 65%|██████▌   | 13/20 [01:10<00:36,  5.15s/it, CE=6.083096e-01 H=6.079604e-01 dV_dx=-1.079347e-04 dV_dθ=-2.412317e-04 ||∇||=7.364810e-01 | Tr=0.9596] 65%|██████▌   | 13/20 [01:15<00:36,  5.15s/it, CE=6.056152e-01 H=6.054710e-01 dV_dx=9.787261e-05 dV_dθ=-2.420637e-04 ||∇||=7.388920e-01 | Tr=0.9602]  70%|███████   | 14/20 [01:15<00:30,  5.14s/it, CE=6.056152e-01 H=6.054710e-01 dV_dx=9.787261e-05 dV_dθ=-2.420637e-04 ||∇||=7.388920e-01 | Tr=0.9602] 70%|███████   | 14/20 [01:20<00:30,  5.14s/it, CE=6.029790e-01 H=6.028059e-01 dV_dx=7.105512e-05 dV_dθ=-2.441747e-04 ||∇||=7.414974e-01 | Tr=0.9607] 75%|███████▌  | 15/20 [01:20<00:25,  5.07s/it, CE=6.029790e-01 H=6.028059e-01 dV_dx=7.105512e-05 dV_dθ=-2.441747e-04 ||∇||=7.414974e-01 | Tr=0.9607] 75%|███████▌  | 15/20 [01:27<00:25,  5.07s/it, CE=6.003932e-01 H=6.000216e-01 dV_dx=-1.247355e-04 dV_dθ=-2.469115e-04 ||∇||=7.444381e-01 | Tr=0.9615 Te/Cur=0.9521 Te/Exp=0.7886] 80%|████████  | 16/20 [01:27<00:22,  5.53s/it, CE=6.003932e-01 H=6.000216e-01 dV_dx=-1.247355e-04 dV_dθ=-2.469115e-04 ||∇||=7.444381e-01 | Tr=0.9615 Te/Cur=0.9521 Te/Exp=0.7886] 80%|████████  | 16/20 [01:31<00:22,  5.53s/it, CE=5.978363e-01 H=5.974041e-01 dV_dx=-1.823057e-04 dV_dθ=-2.498833e-04 ||∇||=7.473627e-01 | Tr=0.9622]                             85%|████████▌ | 17/20 [01:31<00:15,  5.06s/it, CE=5.978363e-01 H=5.974041e-01 dV_dx=-1.823057e-04 dV_dθ=-2.498833e-04 ||∇||=7.473627e-01 | Tr=0.9622] 85%|████████▌ | 17/20 [01:36<00:15,  5.06s/it, CE=5.952943e-01 H=5.951053e-01 dV_dx=5.793232e-05 dV_dθ=-2.469094e-04 ||∇||=7.475462e-01 | Tr=0.9627]  90%|█████████ | 18/20 [01:36<00:10,  5.10s/it, CE=5.952943e-01 H=5.951053e-01 dV_dx=5.793232e-05 dV_dθ=-2.469094e-04 ||∇||=7.475462e-01 | Tr=0.9627] 90%|█████████ | 18/20 [01:41<00:10,  5.10s/it, CE=5.928492e-01 H=5.927426e-01 dV_dx=1.428897e-04 dV_dθ=-2.495773e-04 ||∇||=7.519054e-01 | Tr=0.9632] 95%|█████████▌| 19/20 [01:41<00:04,  4.97s/it, CE=5.928492e-01 H=5.927426e-01 dV_dx=1.428897e-04 dV_dθ=-2.495773e-04 ||∇||=7.519054e-01 | Tr=0.9632] 95%|█████████▌| 19/20 [01:47<00:04,  4.97s/it, CE=5.904431e-01 H=5.901576e-01 dV_dx=-3.255049e-05 dV_dθ=-2.529675e-04 ||∇||=7.555495e-01 | Tr=0.9637 Te/Cur=0.9562 Te/Exp=0.7942]100%|██████████| 20/20 [01:47<00:00,  5.24s/it, CE=5.904431e-01 H=5.901576e-01 dV_dx=-3.255049e-05 dV_dθ=-2.529675e-04 ||∇||=7.555495e-01 | Tr=0.9637 Te/Cur=0.9562 Te/Exp=0.7942]100%|██████████| 20/20 [01:47<00:00,  5.35s/it, CE=5.904431e-01 H=5.901576e-01 dV_dx=-3.255049e-05 dV_dθ=-2.529675e-04 ||∇||=7.555495e-01 | Tr=0.9637 Te/Cur=0.9562 Te/Exp=0.7942]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 1 final loss: 0.595418
======================================================================


  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.7942
    Task 1: 0.9547

============================================================
Task 2
============================================================
Initial loss on new task: 6.5179, previous: 0.5904, ratio: 11.04
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 2
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:11<?, ?it/s, CE=5.197857e-01 H=5.102031e-01 dV_dx=1.376799e-05 dV_dθ=-9.596364e-03 ||∇||=3.651932e+00 | Tr=0.3607 Te/Cur=0.4979 Te/Exp=0.8466]100%|██████████| 1/1 [00:11<00:00, 11.28s/it, CE=5.197857e-01 H=5.102031e-01 dV_dx=1.376799e-05 dV_dθ=-9.596364e-03 ||∇||=3.651932e+00 | Tr=0.3607 Te/Cur=0.4979 Te/Exp=0.8466]100%|██████████| 1/1 [00:11<00:00, 11.28s/it, CE=5.197857e-01 H=5.102031e-01 dV_dx=1.376799e-05 dV_dθ=-9.596364e-03 ||∇||=3.651932e+00 | Tr=0.3607 Te/Cur=0.4979 Te/Exp=0.8466]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.519786

[STEP 2] Architecture change decision
  Current: 0.519786, Previous: 0.590443
  Decision: KEEP
  No change - standard training
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:09<03:14,  9.25s/it]  5%|▍         | 1/22 [00:13<03:14,  9.25s/it, CE=4.385627e-01 H=4.395166e-01 dV_dx=-1.241657e-05 dV_dθ=9.663019e-04 ||∇||=9.558645e-01 | Tr=0.6075]  9%|▉         | 2/22 [00:13<02:11,  6.55s/it, CE=4.385627e-01 H=4.395166e-01 dV_dx=-1.241657e-05 dV_dθ=9.663019e-04 ||∇||=9.558645e-01 | Tr=0.6075]  9%|▉         | 2/22 [00:18<02:11,  6.55s/it, CE=4.275783e-01 H=4.281745e-01 dV_dx=2.764593e-05 dV_dθ=5.685142e-04 ||∇||=9.398452e-01 | Tr=0.6501]  14%|█▎        | 3/22 [00:18<01:48,  5.72s/it, CE=4.275783e-01 H=4.281745e-01 dV_dx=2.764593e-05 dV_dθ=5.685142e-04 ||∇||=9.398452e-01 | Tr=0.6501] 14%|█▎        | 3/22 [00:23<01:48,  5.72s/it, CE=4.192713e-01 H=4.195739e-01 dV_dx=-6.576045e-06 dV_dθ=3.091775e-04 ||∇||=9.164008e-01 | Tr=0.6791] 18%|█▊        | 4/22 [00:23<01:35,  5.33s/it, CE=4.192713e-01 H=4.195739e-01 dV_dx=-6.576045e-06 dV_dθ=3.091775e-04 ||∇||=9.164008e-01 | Tr=0.6791] 18%|█▊        | 4/22 [00:27<01:35,  5.33s/it, CE=4.127378e-01 H=4.128470e-01 dV_dx=-1.750319e-05 dV_dθ=1.267097e-04 ||∇||=9.032278e-01 | Tr=0.7027] 23%|██▎       | 5/22 [00:27<01:25,  5.01s/it, CE=4.127378e-01 H=4.128470e-01 dV_dx=-1.750319e-05 dV_dθ=1.267097e-04 ||∇||=9.032278e-01 | Tr=0.7027] 23%|██▎       | 5/22 [00:34<01:25,  5.01s/it, CE=4.070711e-01 H=4.070340e-01 dV_dx=-3.383427e-05 dV_dθ=-3.312837e-06 ||∇||=8.912287e-01 | Tr=0.7202 Te/Cur=0.7275 Te/Exp=0.8600] 27%|██▋       | 6/22 [00:34<01:27,  5.47s/it, CE=4.070711e-01 H=4.070340e-01 dV_dx=-3.383427e-05 dV_dθ=-3.312837e-06 ||∇||=8.912287e-01 | Tr=0.7202 Te/Cur=0.7275 Te/Exp=0.8600] 27%|██▋       | 6/22 [00:38<01:27,  5.47s/it, CE=4.021280e-01 H=4.020150e-01 dV_dx=-1.394136e-05 dV_dθ=-9.899217e-05 ||∇||=8.842841e-01 | Tr=0.7331]                             32%|███▏      | 7/22 [00:38<01:15,  5.06s/it, CE=4.021280e-01 H=4.020150e-01 dV_dx=-1.394136e-05 dV_dθ=-9.899217e-05 ||∇||=8.842841e-01 | Tr=0.7331] 32%|███▏      | 7/22 [00:43<01:15,  5.06s/it, CE=3.977179e-01 H=3.975033e-01 dV_dx=-4.743910e-05 dV_dθ=-1.671646e-04 ||∇||=8.781514e-01 | Tr=0.7449] 36%|███▋      | 8/22 [00:43<01:09,  4.98s/it, CE=3.977179e-01 H=3.975033e-01 dV_dx=-4.743910e-05 dV_dθ=-1.671646e-04 ||∇||=8.781514e-01 | Tr=0.7449] 36%|███▋      | 8/22 [00:47<01:09,  4.98s/it, CE=3.935620e-01 H=3.932254e-01 dV_dx=-1.074881e-04 dV_dθ=-2.290986e-04 ||∇||=8.786312e-01 | Tr=0.7550] 41%|████      | 9/22 [00:47<01:01,  4.75s/it, CE=3.935620e-01 H=3.932254e-01 dV_dx=-1.074881e-04 dV_dθ=-2.290986e-04 ||∇||=8.786312e-01 | Tr=0.7550] 41%|████      | 9/22 [00:51<01:01,  4.75s/it, CE=3.895409e-01 H=3.892454e-01 dV_dx=-1.647298e-05 dV_dθ=-2.790299e-04 ||∇||=8.757870e-01 | Tr=0.7645] 45%|████▌     | 10/22 [00:51<00:55,  4.66s/it, CE=3.895409e-01 H=3.892454e-01 dV_dx=-1.647298e-05 dV_dθ=-2.790299e-04 ||∇||=8.757870e-01 | Tr=0.7645] 45%|████▌     | 10/22 [00:57<00:55,  4.66s/it, CE=3.857800e-01 H=3.854685e-01 dV_dx=-1.117635e-05 dV_dθ=-3.003955e-04 ||∇||=8.727454e-01 | Tr=0.7721 Te/Cur=0.7708 Te/Exp=0.8632] 50%|█████     | 11/22 [00:57<00:54,  4.97s/it, CE=3.857800e-01 H=3.854685e-01 dV_dx=-1.117635e-05 dV_dθ=-3.003955e-04 ||∇||=8.727454e-01 | Tr=0.7721 Te/Cur=0.7708 Te/Exp=0.8632] 50%|█████     | 11/22 [01:01<00:54,  4.97s/it, CE=3.820853e-01 H=3.817219e-01 dV_dx=-3.915421e-05 dV_dθ=-3.242618e-04 ||∇||=8.705246e-01 | Tr=0.7790]                             55%|█████▍    | 12/22 [01:01<00:47,  4.79s/it, CE=3.820853e-01 H=3.817219e-01 dV_dx=-3.915421e-05 dV_dθ=-3.242618e-04 ||∇||=8.705246e-01 | Tr=0.7790] 55%|█████▍    | 12/22 [01:06<00:47,  4.79s/it, CE=3.786762e-01 H=3.783898e-01 dV_dx=3.982383e-05 dV_dθ=-3.262599e-04 ||∇||=8.642786e-01 | Tr=0.7842]  59%|█████▉    | 13/22 [01:06<00:42,  4.76s/it, CE=3.786762e-01 H=3.783898e-01 dV_dx=3.982383e-05 dV_dθ=-3.262599e-04 ||∇||=8.642786e-01 | Tr=0.7842] 59%|█████▉    | 13/22 [01:10<00:42,  4.76s/it, CE=3.755176e-01 H=3.752001e-01 dV_dx=2.310613e-05 dV_dθ=-3.405684e-04 ||∇||=8.651225e-01 | Tr=0.7896] 64%|██████▎   | 14/22 [01:10<00:36,  4.61s/it, CE=3.755176e-01 H=3.752001e-01 dV_dx=2.310613e-05 dV_dθ=-3.405684e-04 ||∇||=8.651225e-01 | Tr=0.7896] 64%|██████▎   | 14/22 [01:15<00:36,  4.61s/it, CE=3.725348e-01 H=3.722162e-01 dV_dx=3.287390e-05 dV_dθ=-3.514810e-04 ||∇||=8.620847e-01 | Tr=0.7941] 68%|██████▊   | 15/22 [01:15<00:31,  4.46s/it, CE=3.725348e-01 H=3.722162e-01 dV_dx=3.287390e-05 dV_dθ=-3.514810e-04 ||∇||=8.620847e-01 | Tr=0.7941] 68%|██████▊   | 15/22 [01:20<00:31,  4.46s/it, CE=3.696209e-01 H=3.693044e-01 dV_dx=4.856254e-05 dV_dθ=-3.650425e-04 ||∇||=8.618014e-01 | Tr=0.7984 Te/Cur=0.7950 Te/Exp=0.8751] 73%|███████▎  | 16/22 [01:20<00:27,  4.66s/it, CE=3.696209e-01 H=3.693044e-01 dV_dx=4.856254e-05 dV_dθ=-3.650425e-04 ||∇||=8.618014e-01 | Tr=0.7984 Te/Cur=0.7950 Te/Exp=0.8751] 73%|███████▎  | 16/22 [01:24<00:27,  4.66s/it, CE=3.667594e-01 H=3.663861e-01 dV_dx=-1.838085e-05 dV_dθ=-3.548738e-04 ||∇||=8.562766e-01 | Tr=0.8020]                            77%|███████▋  | 17/22 [01:24<00:22,  4.53s/it, CE=3.667594e-01 H=3.663861e-01 dV_dx=-1.838085e-05 dV_dθ=-3.548738e-04 ||∇||=8.562766e-01 | Tr=0.8020] 77%|███████▋  | 17/22 [01:29<00:22,  4.53s/it, CE=3.638773e-01 H=3.634859e-01 dV_dx=-4.864378e-05 dV_dθ=-3.427060e-04 ||∇||=8.500733e-01 | Tr=0.8050] 82%|████████▏ | 18/22 [01:29<00:18,  4.60s/it, CE=3.638773e-01 H=3.634859e-01 dV_dx=-4.864378e-05 dV_dθ=-3.427060e-04 ||∇||=8.500733e-01 | Tr=0.8050] 82%|████████▏ | 18/22 [01:33<00:18,  4.60s/it, CE=3.612547e-01 H=3.609298e-01 dV_dx=2.761645e-05 dV_dθ=-3.524866e-04 ||∇||=8.504631e-01 | Tr=0.8088]  86%|████████▋ | 19/22 [01:33<00:13,  4.64s/it, CE=3.612547e-01 H=3.609298e-01 dV_dx=2.761645e-05 dV_dθ=-3.524866e-04 ||∇||=8.504631e-01 | Tr=0.8088] 86%|████████▋ | 19/22 [01:37<00:13,  4.64s/it, CE=3.587756e-01 H=3.584825e-01 dV_dx=5.855925e-05 dV_dθ=-3.517070e-04 ||∇||=8.478083e-01 | Tr=0.8120] 91%|█████████ | 20/22 [01:37<00:08,  4.37s/it, CE=3.587756e-01 H=3.584825e-01 dV_dx=5.855925e-05 dV_dθ=-3.517070e-04 ||∇||=8.478083e-01 | Tr=0.8120] 91%|█████████ | 20/22 [01:43<00:08,  4.37s/it, CE=3.563748e-01 H=3.559398e-01 dV_dx=-8.356769e-05 dV_dθ=-3.514525e-04 ||∇||=8.462550e-01 | Tr=0.8154 Te/Cur=0.8114 Te/Exp=0.8739] 95%|█████████▌| 21/22 [01:43<00:04,  4.90s/it, CE=3.563748e-01 H=3.559398e-01 dV_dx=-8.356769e-05 dV_dθ=-3.514525e-04 ||∇||=8.462550e-01 | Tr=0.8154 Te/Cur=0.8114 Te/Exp=0.8739] 95%|█████████▌| 21/22 [01:49<00:04,  4.90s/it, CE=3.540095e-01 H=3.537163e-01 dV_dx=6.993526e-05 dV_dθ=-3.631839e-04 ||∇||=8.483570e-01 | Tr=0.8185 Te/Cur=0.8146 Te/Exp=0.8722] 100%|██████████| 22/22 [01:49<00:00,  5.19s/it, CE=3.540095e-01 H=3.537163e-01 dV_dx=6.993526e-05 dV_dθ=-3.631839e-04 ||∇||=8.483570e-01 | Tr=0.8185 Te/Cur=0.8146 Te/Exp=0.8722]100%|██████████| 22/22 [01:49<00:00,  4.98s/it, CE=3.540095e-01 H=3.537163e-01 dV_dx=6.993526e-05 dV_dθ=-3.631839e-04 ||∇||=8.483570e-01 | Tr=0.8185 Te/Cur=0.8146 Te/Exp=0.8722]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 2 final loss: 0.369621
======================================================================


  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.7894
    Task 1: 0.9559
    Task 2: 0.8115

============================================================
Task 3
============================================================
Initial loss on new task: 4.4371, previous: 0.3540, ratio: 12.53
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 3
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:12<?, ?it/s, CE=5.422070e-01 H=5.347975e-01 dV_dx=1.286920e-04 dV_dθ=-7.538170e-03 ||∇||=2.904422e+00 | Tr=0.3868 Te/Cur=0.4473 Te/Exp=0.8381]100%|██████████| 1/1 [00:12<00:00, 12.22s/it, CE=5.422070e-01 H=5.347975e-01 dV_dx=1.286920e-04 dV_dθ=-7.538170e-03 ||∇||=2.904422e+00 | Tr=0.3868 Te/Cur=0.4473 Te/Exp=0.8381]100%|██████████| 1/1 [00:12<00:00, 12.22s/it, CE=5.422070e-01 H=5.347975e-01 dV_dx=1.286920e-04 dV_dθ=-7.538170e-03 ||∇||=2.904422e+00 | Tr=0.3868 Te/Cur=0.4473 Te/Exp=0.8381]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.542207

[STEP 2] Architecture change decision
  Current: 0.542207, Previous: 0.354010
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9416 samples from 10 classes
  Created balanced validation set: 28668 samples from 10 classes
  Starting grid architecture search for task 3
  Baseline architecture: (4, [432, 552, 84, 10])
  Baseline loss: 0.542207
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.59s/it] 50%|█████     | 1/2 [00:07<00:04,  4.59s/it, CE=2.373172e+00 H=2.373084e+00 dV_dx=-8.158265e-07 dV_dθ=-8.768740e-05 ||∇||=2.689043e-01 | Tr=0.1056 Te/Cur=0.1058 Te/Exp=0.1511]100%|██████████| 2/2 [00:07<00:00,  3.53s/it, CE=2.373172e+00 H=2.373084e+00 dV_dx=-8.158265e-07 dV_dθ=-8.768740e-05 ||∇||=2.689043e-01 | Tr=0.1056 Te/Cur=0.1058 Te/Exp=0.1511]100%|██████████| 2/2 [00:07<00:00,  3.69s/it, CE=2.373172e+00 H=2.373084e+00 dV_dx=-8.158265e-07 dV_dθ=-8.768740e-05 ||∇||=2.689043e-01 | Tr=0.1056 Te/Cur=0.1058 Te/Exp=0.1511]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.3731722262237818
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.53s/it] 50%|█████     | 1/2 [00:16<00:13, 13.53s/it, CE=2.371195e+00 H=2.371104e+00 dV_dx=-1.247456e-06 dV_dθ=-8.936609e-05 ||∇||=2.817136e-01 | Tr=0.0976 Te/Cur=0.0956 Te/Exp=0.1021]100%|██████████| 2/2 [00:16<00:00,  7.08s/it, CE=2.371195e+00 H=2.371104e+00 dV_dx=-1.247456e-06 dV_dθ=-8.936609e-05 ||∇||=2.817136e-01 | Tr=0.0976 Te/Cur=0.0956 Te/Exp=0.1021]100%|██████████| 2/2 [00:16<00:00,  8.05s/it, CE=2.371195e+00 H=2.371104e+00 dV_dx=-1.247456e-06 dV_dθ=-8.936609e-05 ||∇||=2.817136e-01 | Tr=0.0976 Te/Cur=0.0956 Te/Exp=0.1021]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 64, 10]) with loss 2.371195
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.40s/it] 50%|█████     | 1/2 [00:18<00:15, 15.40s/it, CE=2.375591e+00 H=2.375511e+00 dV_dx=-1.831698e-06 dV_dθ=-7.866615e-05 ||∇||=2.823007e-01 | Tr=0.0978 Te/Cur=0.0962 Te/Exp=0.1323]100%|██████████| 2/2 [00:18<00:00,  8.06s/it, CE=2.375591e+00 H=2.375511e+00 dV_dx=-1.831698e-06 dV_dθ=-7.866615e-05 ||∇||=2.823007e-01 | Tr=0.0978 Te/Cur=0.0962 Te/Exp=0.1323]100%|██████████| 2/2 [00:18<00:00,  9.16s/it, CE=2.375591e+00 H=2.375511e+00 dV_dx=-1.831698e-06 dV_dθ=-7.866615e-05 ||∇||=2.823007e-01 | Tr=0.0978 Te/Cur=0.0962 Te/Exp=0.1323]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.48s/it] 50%|█████     | 1/2 [00:07<00:04,  4.48s/it, CE=2.341939e+00 H=2.341850e+00 dV_dx=-3.352130e-06 dV_dθ=-8.507849e-05 ||∇||=2.847423e-01 | Tr=0.0909 Te/Cur=0.0974 Te/Exp=0.1080]100%|██████████| 2/2 [00:07<00:00,  3.42s/it, CE=2.341939e+00 H=2.341850e+00 dV_dx=-3.352130e-06 dV_dθ=-8.507849e-05 ||∇||=2.847423e-01 | Tr=0.0909 Te/Cur=0.0974 Te/Exp=0.1080]100%|██████████| 2/2 [00:07<00:00,  3.58s/it, CE=2.341939e+00 H=2.341850e+00 dV_dx=-3.352130e-06 dV_dθ=-8.507849e-05 ||∇||=2.847423e-01 | Tr=0.0909 Te/Cur=0.0974 Te/Exp=0.1080]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 84, 10]) with loss 2.341939
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.50s/it] 50%|█████     | 1/2 [00:07<00:04,  4.50s/it, CE=2.339492e+00 H=2.339413e+00 dV_dx=4.726218e-06 dV_dθ=-8.345367e-05 ||∇||=2.846059e-01 | Tr=0.1016 Te/Cur=0.0956 Te/Exp=0.1085]100%|██████████| 2/2 [00:07<00:00,  3.49s/it, CE=2.339492e+00 H=2.339413e+00 dV_dx=4.726218e-06 dV_dθ=-8.345367e-05 ||∇||=2.846059e-01 | Tr=0.1016 Te/Cur=0.0956 Te/Exp=0.1085]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.339492e+00 H=2.339413e+00 dV_dx=4.726218e-06 dV_dθ=-8.345367e-05 ||∇||=2.846059e-01 | Tr=0.1016 Te/Cur=0.0956 Te/Exp=0.1085]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 84, 10]) with loss 2.339492
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.40s/it] 50%|█████     | 1/2 [00:18<00:15, 15.40s/it, CE=2.346912e+00 H=2.346837e+00 dV_dx=-2.678339e-06 dV_dθ=-7.275319e-05 ||∇||=2.852014e-01 | Tr=0.0992 Te/Cur=0.0965 Te/Exp=0.1009]100%|██████████| 2/2 [00:18<00:00,  8.20s/it, CE=2.346912e+00 H=2.346837e+00 dV_dx=-2.678339e-06 dV_dθ=-7.275319e-05 ||∇||=2.852014e-01 | Tr=0.0992 Te/Cur=0.0965 Te/Exp=0.1009]100%|██████████| 2/2 [00:18<00:00,  9.28s/it, CE=2.346912e+00 H=2.346837e+00 dV_dx=-2.678339e-06 dV_dθ=-7.275319e-05 ||∇||=2.852014e-01 | Tr=0.0992 Te/Cur=0.0965 Te/Exp=0.1009]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.03s/it] 50%|█████     | 1/2 [00:16<00:14, 14.03s/it, CE=2.337476e+00 H=2.337394e+00 dV_dx=-2.906511e-06 dV_dθ=-7.851202e-05 ||∇||=2.769215e-01 | Tr=0.1250 Te/Cur=0.1277 Te/Exp=0.1479]100%|██████████| 2/2 [00:16<00:00,  7.43s/it, CE=2.337476e+00 H=2.337394e+00 dV_dx=-2.906511e-06 dV_dθ=-7.851202e-05 ||∇||=2.769215e-01 | Tr=0.1250 Te/Cur=0.1277 Te/Exp=0.1479]100%|██████████| 2/2 [00:16<00:00,  8.42s/it, CE=2.337476e+00 H=2.337394e+00 dV_dx=-2.906511e-06 dV_dθ=-7.851202e-05 ||∇||=2.769215e-01 | Tr=0.1250 Te/Cur=0.1277 Te/Exp=0.1479]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 104, 10]) with loss 2.337476
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.39s/it] 50%|█████     | 1/2 [00:16<00:13, 13.39s/it, CE=2.337652e+00 H=2.337567e+00 dV_dx=-1.874997e-06 dV_dθ=-8.277470e-05 ||∇||=2.937134e-01 | Tr=0.1045 Te/Cur=0.1055 Te/Exp=0.1082]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.337652e+00 H=2.337567e+00 dV_dx=-1.874997e-06 dV_dθ=-8.277470e-05 ||∇||=2.937134e-01 | Tr=0.1045 Te/Cur=0.1055 Te/Exp=0.1082]100%|██████████| 2/2 [00:16<00:00,  8.13s/it, CE=2.337652e+00 H=2.337567e+00 dV_dx=-1.874997e-06 dV_dθ=-8.277470e-05 ||∇||=2.937134e-01 | Tr=0.1045 Te/Cur=0.1055 Te/Exp=0.1082]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.90s/it] 50%|█████     | 1/2 [00:17<00:14, 14.90s/it, CE=2.338051e+00 H=2.337987e+00 dV_dx=9.959567e-07 dV_dθ=-6.558202e-05 ||∇||=2.680685e-01 | Tr=0.1537 Te/Cur=0.1576 Te/Exp=0.1465]100%|██████████| 2/2 [00:17<00:00,  7.77s/it, CE=2.338051e+00 H=2.337987e+00 dV_dx=9.959567e-07 dV_dθ=-6.558202e-05 ||∇||=2.680685e-01 | Tr=0.1537 Te/Cur=0.1576 Te/Exp=0.1465]100%|██████████| 2/2 [00:17<00:00,  8.84s/it, CE=2.338051e+00 H=2.337987e+00 dV_dx=9.959567e-07 dV_dθ=-6.558202e-05 ||∇||=2.680685e-01 | Tr=0.1537 Te/Cur=0.1576 Te/Exp=0.1465]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.49s/it] 50%|█████     | 1/2 [00:07<00:04,  4.49s/it, CE=2.368187e+00 H=2.368092e+00 dV_dx=-4.497627e-06 dV_dθ=-9.055148e-05 ||∇||=3.072366e-01 | Tr=0.1009 Te/Cur=0.1159 Te/Exp=0.1486]100%|██████████| 2/2 [00:07<00:00,  3.43s/it, CE=2.368187e+00 H=2.368092e+00 dV_dx=-4.497627e-06 dV_dθ=-9.055148e-05 ||∇||=3.072366e-01 | Tr=0.1009 Te/Cur=0.1159 Te/Exp=0.1486]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.368187e+00 H=2.368092e+00 dV_dx=-4.497627e-06 dV_dθ=-9.055148e-05 ||∇||=3.072366e-01 | Tr=0.1009 Te/Cur=0.1159 Te/Exp=0.1486]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.23s/it] 50%|█████     | 1/2 [00:16<00:13, 13.23s/it, CE=2.377531e+00 H=2.377435e+00 dV_dx=-3.001780e-06 dV_dθ=-9.272859e-05 ||∇||=3.377041e-01 | Tr=0.0964 Te/Cur=0.0957 Te/Exp=0.1430]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.377531e+00 H=2.377435e+00 dV_dx=-3.001780e-06 dV_dθ=-9.272859e-05 ||∇||=3.377041e-01 | Tr=0.0964 Te/Cur=0.0957 Te/Exp=0.1430]100%|██████████| 2/2 [00:16<00:00,  8.10s/it, CE=2.377531e+00 H=2.377435e+00 dV_dx=-3.001780e-06 dV_dθ=-9.272859e-05 ||∇||=3.377041e-01 | Tr=0.0964 Te/Cur=0.0957 Te/Exp=0.1430]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.27s/it] 50%|█████     | 1/2 [00:16<00:13, 13.27s/it, CE=2.366463e+00 H=2.366389e+00 dV_dx=2.061194e-07 dV_dθ=-7.445600e-05 ||∇||=2.999505e-01 | Tr=0.1055 Te/Cur=0.1012 Te/Exp=0.1384]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.366463e+00 H=2.366389e+00 dV_dx=2.061194e-07 dV_dθ=-7.445600e-05 ||∇||=2.999505e-01 | Tr=0.1055 Te/Cur=0.1012 Te/Exp=0.1384]100%|██████████| 2/2 [00:16<00:00,  8.19s/it, CE=2.366463e+00 H=2.366389e+00 dV_dx=2.061194e-07 dV_dθ=-7.445600e-05 ||∇||=2.999505e-01 | Tr=0.1055 Te/Cur=0.1012 Te/Exp=0.1384]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.73s/it] 50%|█████     | 1/2 [00:08<00:05,  5.73s/it, CE=2.334562e+00 H=2.334467e+00 dV_dx=-1.544544e-06 dV_dθ=-9.287849e-05 ||∇||=3.421975e-01 | Tr=0.0998 Te/Cur=0.1094 Te/Exp=0.1257]100%|██████████| 2/2 [00:08<00:00,  4.04s/it, CE=2.334562e+00 H=2.334467e+00 dV_dx=-1.544544e-06 dV_dθ=-9.287849e-05 ||∇||=3.421975e-01 | Tr=0.0998 Te/Cur=0.1094 Te/Exp=0.1257]100%|██████████| 2/2 [00:08<00:00,  4.29s/it, CE=2.334562e+00 H=2.334467e+00 dV_dx=-1.544544e-06 dV_dθ=-9.287849e-05 ||∇||=3.421975e-01 | Tr=0.0998 Te/Cur=0.1094 Te/Exp=0.1257]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 532, 84, 10]) with loss 2.334562
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.61s/it] 50%|█████     | 1/2 [00:07<00:04,  4.61s/it, CE=2.322445e+00 H=2.322356e+00 dV_dx=2.082268e-06 dV_dθ=-9.041086e-05 ||∇||=3.298668e-01 | Tr=0.0978 Te/Cur=0.0978 Te/Exp=0.1259]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.322445e+00 H=2.322356e+00 dV_dx=2.082268e-06 dV_dθ=-9.041086e-05 ||∇||=3.298668e-01 | Tr=0.0978 Te/Cur=0.0978 Te/Exp=0.1259]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.322445e+00 H=2.322356e+00 dV_dx=2.082268e-06 dV_dθ=-9.041086e-05 ||∇||=3.298668e-01 | Tr=0.0978 Te/Cur=0.0978 Te/Exp=0.1259]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 552, 84, 10]) with loss 2.322445
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.12s/it] 50%|█████     | 1/2 [00:15<00:13, 13.12s/it, CE=2.331046e+00 H=2.330970e+00 dV_dx=-1.641152e-06 dV_dθ=-7.415427e-05 ||∇||=3.385828e-01 | Tr=0.0964 Te/Cur=0.0955 Te/Exp=0.1331]100%|██████████| 2/2 [00:15<00:00,  7.07s/it, CE=2.331046e+00 H=2.330970e+00 dV_dx=-1.641152e-06 dV_dθ=-7.415427e-05 ||∇||=3.385828e-01 | Tr=0.0964 Te/Cur=0.0955 Te/Exp=0.1331]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.331046e+00 H=2.330970e+00 dV_dx=-1.641152e-06 dV_dθ=-7.415427e-05 ||∇||=3.385828e-01 | Tr=0.0964 Te/Cur=0.0955 Te/Exp=0.1331]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.90s/it] 50%|█████     | 1/2 [00:18<00:14, 14.90s/it, CE=2.334603e+00 H=2.334514e+00 dV_dx=-2.763906e-06 dV_dθ=-8.667203e-05 ||∇||=3.376743e-01 | Tr=0.1091 Te/Cur=0.1090 Te/Exp=0.1757]100%|██████████| 2/2 [00:18<00:00,  8.01s/it, CE=2.334603e+00 H=2.334514e+00 dV_dx=-2.763906e-06 dV_dθ=-8.667203e-05 ||∇||=3.376743e-01 | Tr=0.1091 Te/Cur=0.1090 Te/Exp=0.1757]100%|██████████| 2/2 [00:18<00:00,  9.04s/it, CE=2.334603e+00 H=2.334514e+00 dV_dx=-2.763906e-06 dV_dθ=-8.667203e-05 ||∇||=3.376743e-01 | Tr=0.1091 Te/Cur=0.1090 Te/Exp=0.1757]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.10s/it] 50%|█████     | 1/2 [00:15<00:13, 13.10s/it, CE=2.331517e+00 H=2.331425e+00 dV_dx=-5.816739e-07 dV_dθ=-9.084077e-05 ||∇||=3.652942e-01 | Tr=0.1009 Te/Cur=0.1047 Te/Exp=0.1363]100%|██████████| 2/2 [00:15<00:00,  7.08s/it, CE=2.331517e+00 H=2.331425e+00 dV_dx=-5.816739e-07 dV_dθ=-9.084077e-05 ||∇||=3.652942e-01 | Tr=0.1009 Te/Cur=0.1047 Te/Exp=0.1363]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.331517e+00 H=2.331425e+00 dV_dx=-5.816739e-07 dV_dθ=-9.084077e-05 ||∇||=3.652942e-01 | Tr=0.1009 Te/Cur=0.1047 Te/Exp=0.1363]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.09s/it] 50%|█████     | 1/2 [00:15<00:13, 13.09s/it, CE=2.324749e+00 H=2.324672e+00 dV_dx=-7.085122e-06 dV_dθ=-6.902460e-05 ||∇||=3.469406e-01 | Tr=0.1139 Te/Cur=0.1277 Te/Exp=0.1484]100%|██████████| 2/2 [00:15<00:00,  7.04s/it, CE=2.324749e+00 H=2.324672e+00 dV_dx=-7.085122e-06 dV_dθ=-6.902460e-05 ||∇||=3.469406e-01 | Tr=0.1139 Te/Cur=0.1277 Te/Exp=0.1484]100%|██████████| 2/2 [00:15<00:00,  7.95s/it, CE=2.324749e+00 H=2.324672e+00 dV_dx=-7.085122e-06 dV_dθ=-6.902460e-05 ||∇||=3.469406e-01 | Tr=0.1139 Te/Cur=0.1277 Te/Exp=0.1484]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.32s/it] 50%|█████     | 1/2 [00:07<00:04,  4.32s/it, CE=2.340107e+00 H=2.340018e+00 dV_dx=3.780723e-06 dV_dθ=-9.277323e-05 ||∇||=3.641434e-01 | Tr=0.1089 Te/Cur=0.1182 Te/Exp=0.1954]100%|██████████| 2/2 [00:07<00:00,  3.38s/it, CE=2.340107e+00 H=2.340018e+00 dV_dx=3.780723e-06 dV_dθ=-9.277323e-05 ||∇||=3.641434e-01 | Tr=0.1089 Te/Cur=0.1182 Te/Exp=0.1954]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.340107e+00 H=2.340018e+00 dV_dx=3.780723e-06 dV_dθ=-9.277323e-05 ||∇||=3.641434e-01 | Tr=0.1089 Te/Cur=0.1182 Te/Exp=0.1954]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.65s/it] 50%|█████     | 1/2 [00:17<00:14, 14.65s/it, CE=2.344740e+00 H=2.344636e+00 dV_dx=-5.687124e-06 dV_dθ=-9.821339e-05 ||∇||=3.694117e-01 | Tr=0.0947 Te/Cur=0.0965 Te/Exp=0.1846]100%|██████████| 2/2 [00:17<00:00,  7.61s/it, CE=2.344740e+00 H=2.344636e+00 dV_dx=-5.687124e-06 dV_dθ=-9.821339e-05 ||∇||=3.694117e-01 | Tr=0.0947 Te/Cur=0.0965 Te/Exp=0.1846]100%|██████████| 2/2 [00:17<00:00,  8.67s/it, CE=2.344740e+00 H=2.344636e+00 dV_dx=-5.687124e-06 dV_dθ=-9.821339e-05 ||∇||=3.694117e-01 | Tr=0.0947 Te/Cur=0.0965 Te/Exp=0.1846]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.53s/it] 50%|█████     | 1/2 [00:16<00:13, 13.53s/it, CE=2.335619e+00 H=2.335515e+00 dV_dx=-5.110064e-06 dV_dθ=-9.909416e-05 ||∇||=3.758106e-01 | Tr=0.1078 Te/Cur=0.1095 Te/Exp=0.1467]100%|██████████| 2/2 [00:16<00:00,  7.22s/it, CE=2.335619e+00 H=2.335515e+00 dV_dx=-5.110064e-06 dV_dθ=-9.909416e-05 ||∇||=3.758106e-01 | Tr=0.1078 Te/Cur=0.1095 Te/Exp=0.1467]100%|██████████| 2/2 [00:16<00:00,  8.17s/it, CE=2.335619e+00 H=2.335515e+00 dV_dx=-5.110064e-06 dV_dθ=-9.909416e-05 ||∇||=3.758106e-01 | Tr=0.1078 Te/Cur=0.1095 Te/Exp=0.1467]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.77s/it] 50%|█████     | 1/2 [00:07<00:04,  4.77s/it, CE=2.305716e+00 H=2.305612e+00 dV_dx=-3.916540e-06 dV_dθ=-9.964985e-05 ||∇||=4.040217e-01 | Tr=0.1011 Te/Cur=0.0972 Te/Exp=0.1561]100%|██████████| 2/2 [00:07<00:00,  3.42s/it, CE=2.305716e+00 H=2.305612e+00 dV_dx=-3.916540e-06 dV_dθ=-9.964985e-05 ||∇||=4.040217e-01 | Tr=0.1011 Te/Cur=0.0972 Te/Exp=0.1561]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.305716e+00 H=2.305612e+00 dV_dx=-3.916540e-06 dV_dθ=-9.964985e-05 ||∇||=4.040217e-01 | Tr=0.1011 Te/Cur=0.0972 Te/Exp=0.1561]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 532, 84, 10]) with loss 2.305716
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.84s/it] 50%|█████     | 1/2 [00:07<00:04,  4.84s/it, CE=2.307600e+00 H=2.307504e+00 dV_dx=2.784787e-06 dV_dθ=-9.914092e-05 ||∇||=4.118240e-01 | Tr=0.1163 Te/Cur=0.1050 Te/Exp=0.1770]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.307600e+00 H=2.307504e+00 dV_dx=2.784787e-06 dV_dθ=-9.914092e-05 ||∇||=4.118240e-01 | Tr=0.1163 Te/Cur=0.1050 Te/Exp=0.1770]100%|██████████| 2/2 [00:07<00:00,  3.83s/it, CE=2.307600e+00 H=2.307504e+00 dV_dx=2.784787e-06 dV_dθ=-9.914092e-05 ||∇||=4.118240e-01 | Tr=0.1163 Te/Cur=0.1050 Te/Exp=0.1770]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.79s/it] 50%|█████     | 1/2 [00:17<00:14, 14.79s/it, CE=2.295102e+00 H=2.295012e+00 dV_dx=-6.764613e-06 dV_dθ=-8.333062e-05 ||∇||=3.881816e-01 | Tr=0.1004 Te/Cur=0.0961 Te/Exp=0.2038]100%|██████████| 2/2 [00:17<00:00,  7.80s/it, CE=2.295102e+00 H=2.295012e+00 dV_dx=-6.764613e-06 dV_dθ=-8.333062e-05 ||∇||=3.881816e-01 | Tr=0.1004 Te/Cur=0.0961 Te/Exp=0.2038]100%|██████████| 2/2 [00:17<00:00,  8.85s/it, CE=2.295102e+00 H=2.295012e+00 dV_dx=-6.764613e-06 dV_dθ=-8.333062e-05 ||∇||=3.881816e-01 | Tr=0.1004 Te/Cur=0.0961 Te/Exp=0.2038]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 572, 84, 10]) with loss 2.295102
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.19s/it] 50%|█████     | 1/2 [00:15<00:13, 13.19s/it, CE=2.306727e+00 H=2.306632e+00 dV_dx=-8.409498e-06 dV_dθ=-8.619916e-05 ||∇||=4.078905e-01 | Tr=0.1519 Te/Cur=0.1608 Te/Exp=0.1555]100%|██████████| 2/2 [00:15<00:00,  6.88s/it, CE=2.306727e+00 H=2.306632e+00 dV_dx=-8.409498e-06 dV_dθ=-8.619916e-05 ||∇||=4.078905e-01 | Tr=0.1519 Te/Cur=0.1608 Te/Exp=0.1555]100%|██████████| 2/2 [00:15<00:00,  7.83s/it, CE=2.306727e+00 H=2.306632e+00 dV_dx=-8.409498e-06 dV_dθ=-8.619916e-05 ||∇||=4.078905e-01 | Tr=0.1519 Te/Cur=0.1608 Te/Exp=0.1555]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.03s/it] 50%|█████     | 1/2 [00:15<00:13, 13.03s/it, CE=2.310453e+00 H=2.310351e+00 dV_dx=3.491043e-06 dV_dθ=-1.062606e-04 ||∇||=4.256999e-01 | Tr=0.1021 Te/Cur=0.1064 Te/Exp=0.1667]100%|██████████| 2/2 [00:15<00:00,  6.73s/it, CE=2.310453e+00 H=2.310351e+00 dV_dx=3.491043e-06 dV_dθ=-1.062606e-04 ||∇||=4.256999e-01 | Tr=0.1021 Te/Cur=0.1064 Te/Exp=0.1667]100%|██████████| 2/2 [00:15<00:00,  7.67s/it, CE=2.310453e+00 H=2.310351e+00 dV_dx=3.491043e-06 dV_dθ=-1.062606e-04 ||∇||=4.256999e-01 | Tr=0.1021 Te/Cur=0.1064 Te/Exp=0.1667]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.41s/it] 50%|█████     | 1/2 [00:17<00:14, 14.41s/it, CE=2.294692e+00 H=2.294610e+00 dV_dx=1.872692e-06 dV_dθ=-8.387333e-05 ||∇||=4.080011e-01 | Tr=0.1179 Te/Cur=0.1294 Te/Exp=0.1801]100%|██████████| 2/2 [00:17<00:00,  7.71s/it, CE=2.294692e+00 H=2.294610e+00 dV_dx=1.872692e-06 dV_dθ=-8.387333e-05 ||∇||=4.080011e-01 | Tr=0.1179 Te/Cur=0.1294 Te/Exp=0.1801]100%|██████████| 2/2 [00:17<00:00,  8.72s/it, CE=2.294692e+00 H=2.294610e+00 dV_dx=1.872692e-06 dV_dθ=-8.387333e-05 ||∇||=4.080011e-01 | Tr=0.1179 Te/Cur=0.1294 Te/Exp=0.1801]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 572, 104, 10]) with loss 2.294692
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.49s/it] 50%|█████     | 1/2 [00:07<00:04,  4.49s/it, CE=2.239903e+00 H=2.239822e+00 dV_dx=9.842371e-06 dV_dθ=-9.016789e-05 ||∇||=6.854842e-01 | Tr=0.1109 Te/Cur=0.1101 Te/Exp=0.2463]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.239903e+00 H=2.239822e+00 dV_dx=9.842371e-06 dV_dθ=-9.016789e-05 ||∇||=6.854842e-01 | Tr=0.1109 Te/Cur=0.1101 Te/Exp=0.2463]100%|██████████| 2/2 [00:07<00:00,  3.70s/it, CE=2.239903e+00 H=2.239822e+00 dV_dx=9.842371e-06 dV_dθ=-9.016789e-05 ||∇||=6.854842e-01 | Tr=0.1109 Te/Cur=0.1101 Te/Exp=0.2463]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2399026725543107
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.64s/it] 50%|█████     | 1/2 [00:07<00:04,  4.64s/it, CE=2.288783e+00 H=2.288630e+00 dV_dx=-3.167117e-06 dV_dθ=-1.507016e-04 ||∇||=6.481389e-01 | Tr=0.1027 Te/Cur=0.0976 Te/Exp=0.1739]100%|██████████| 2/2 [00:07<00:00,  3.54s/it, CE=2.288783e+00 H=2.288630e+00 dV_dx=-3.167117e-06 dV_dθ=-1.507016e-04 ||∇||=6.481389e-01 | Tr=0.1027 Te/Cur=0.0976 Te/Exp=0.1739]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.288783e+00 H=2.288630e+00 dV_dx=-3.167117e-06 dV_dθ=-1.507016e-04 ||∇||=6.481389e-01 | Tr=0.1027 Te/Cur=0.0976 Te/Exp=0.1739]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.41s/it] 50%|█████     | 1/2 [00:17<00:14, 14.41s/it, CE=2.259470e+00 H=2.259329e+00 dV_dx=4.604326e-06 dV_dθ=-1.464955e-04 ||∇||=6.825013e-01 | Tr=0.1340 Te/Cur=0.1410 Te/Exp=0.2170]100%|██████████| 2/2 [00:17<00:00,  7.84s/it, CE=2.259470e+00 H=2.259329e+00 dV_dx=4.604326e-06 dV_dθ=-1.464955e-04 ||∇||=6.825013e-01 | Tr=0.1340 Te/Cur=0.1410 Te/Exp=0.2170]100%|██████████| 2/2 [00:17<00:00,  8.83s/it, CE=2.259470e+00 H=2.259329e+00 dV_dx=4.604326e-06 dV_dθ=-1.464955e-04 ||∇||=6.825013e-01 | Tr=0.1340 Te/Cur=0.1410 Te/Exp=0.2170]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.80s/it] 50%|█████     | 1/2 [00:08<00:05,  5.80s/it, CE=2.248924e+00 H=2.248662e+00 dV_dx=-1.014903e-05 dV_dθ=-2.521509e-04 ||∇||=7.996966e-01 | Tr=0.1061 Te/Cur=0.1098 Te/Exp=0.2336]100%|██████████| 2/2 [00:08<00:00,  3.80s/it, CE=2.248924e+00 H=2.248662e+00 dV_dx=-1.014903e-05 dV_dθ=-2.521509e-04 ||∇||=7.996966e-01 | Tr=0.1061 Te/Cur=0.1098 Te/Exp=0.2336]100%|██████████| 2/2 [00:08<00:00,  4.10s/it, CE=2.248924e+00 H=2.248662e+00 dV_dx=-1.014903e-05 dV_dθ=-2.521509e-04 ||∇||=7.996966e-01 | Tr=0.1061 Te/Cur=0.1098 Te/Exp=0.2336]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.97s/it] 50%|█████     | 1/2 [00:07<00:04,  4.97s/it, CE=2.183360e+00 H=2.183357e+00 dV_dx=6.978033e-06 dV_dθ=-1.053423e-05 ||∇||=7.380950e-01 | Tr=0.1127 Te/Cur=0.1101 Te/Exp=0.2985]100%|██████████| 2/2 [00:07<00:00,  3.65s/it, CE=2.183360e+00 H=2.183357e+00 dV_dx=6.978033e-06 dV_dθ=-1.053423e-05 ||∇||=7.380950e-01 | Tr=0.1127 Te/Cur=0.1101 Te/Exp=0.2985]100%|██████████| 2/2 [00:07<00:00,  3.85s/it, CE=2.183360e+00 H=2.183357e+00 dV_dx=6.978033e-06 dV_dθ=-1.053423e-05 ||∇||=7.380950e-01 | Tr=0.1127 Te/Cur=0.1101 Te/Exp=0.2985]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 104, 10]) with loss 2.183360
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.32s/it] 50%|█████     | 1/2 [00:16<00:13, 13.32s/it, CE=2.210729e+00 H=2.210736e+00 dV_dx=1.237881e-05 dV_dθ=-5.487285e-06 ||∇||=6.819611e-01 | Tr=0.1054 Te/Cur=0.1094 Te/Exp=0.2896]100%|██████████| 2/2 [00:16<00:00,  7.06s/it, CE=2.210729e+00 H=2.210736e+00 dV_dx=1.237881e-05 dV_dθ=-5.487285e-06 ||∇||=6.819611e-01 | Tr=0.1054 Te/Cur=0.1094 Te/Exp=0.2896]100%|██████████| 2/2 [00:16<00:00,  8.00s/it, CE=2.210729e+00 H=2.210736e+00 dV_dx=1.237881e-05 dV_dθ=-5.487285e-06 ||∇||=6.819611e-01 | Tr=0.1054 Te/Cur=0.1094 Te/Exp=0.2896]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.50s/it] 50%|█████     | 1/2 [00:16<00:13, 13.50s/it, CE=2.208483e+00 H=2.208410e+00 dV_dx=-1.031921e-06 dV_dθ=-7.226132e-05 ||∇||=6.634586e-01 | Tr=0.1157 Te/Cur=0.1085 Te/Exp=0.2896]100%|██████████| 2/2 [00:16<00:00,  7.55s/it, CE=2.208483e+00 H=2.208410e+00 dV_dx=-1.031921e-06 dV_dθ=-7.226132e-05 ||∇||=6.634586e-01 | Tr=0.1157 Te/Cur=0.1085 Te/Exp=0.2896]100%|██████████| 2/2 [00:16<00:00,  8.44s/it, CE=2.208483e+00 H=2.208410e+00 dV_dx=-1.031921e-06 dV_dθ=-7.226132e-05 ||∇||=6.634586e-01 | Tr=0.1157 Te/Cur=0.1085 Te/Exp=0.2896]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.82s/it] 50%|█████     | 1/2 [00:17<00:14, 14.82s/it, CE=2.221347e+00 H=2.221333e+00 dV_dx=5.466152e-06 dV_dθ=-1.899007e-05 ||∇||=6.648771e-01 | Tr=0.1117 Te/Cur=0.1071 Te/Exp=0.3029]100%|██████████| 2/2 [00:17<00:00,  7.59s/it, CE=2.221347e+00 H=2.221333e+00 dV_dx=5.466152e-06 dV_dθ=-1.899007e-05 ||∇||=6.648771e-01 | Tr=0.1117 Te/Cur=0.1071 Te/Exp=0.3029]100%|██████████| 2/2 [00:17<00:00,  8.68s/it, CE=2.221347e+00 H=2.221333e+00 dV_dx=5.466152e-06 dV_dθ=-1.899007e-05 ||∇||=6.648771e-01 | Tr=0.1117 Te/Cur=0.1071 Te/Exp=0.3029]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.24s/it] 50%|█████     | 1/2 [00:15<00:13, 13.24s/it, CE=2.196409e+00 H=2.196373e+00 dV_dx=1.380057e-05 dV_dθ=-5.018331e-05 ||∇||=7.849056e-01 | Tr=0.1283 Te/Cur=0.1407 Te/Exp=0.3530]100%|██████████| 2/2 [00:15<00:00,  7.04s/it, CE=2.196409e+00 H=2.196373e+00 dV_dx=1.380057e-05 dV_dθ=-5.018331e-05 ||∇||=7.849056e-01 | Tr=0.1283 Te/Cur=0.1407 Te/Exp=0.3530]100%|██████████| 2/2 [00:15<00:00,  7.97s/it, CE=2.196409e+00 H=2.196373e+00 dV_dx=1.380057e-05 dV_dθ=-5.018331e-05 ||∇||=7.849056e-01 | Tr=0.1283 Te/Cur=0.1407 Te/Exp=0.3530]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.38s/it] 50%|█████     | 1/2 [00:07<00:04,  4.38s/it, CE=2.269665e+00 H=2.269585e+00 dV_dx=3.200654e-08 dV_dθ=-7.963805e-05 ||∇||=5.109844e-01 | Tr=0.1131 Te/Cur=0.1092 Te/Exp=0.2313]100%|██████████| 2/2 [00:07<00:00,  3.45s/it, CE=2.269665e+00 H=2.269585e+00 dV_dx=3.200654e-08 dV_dθ=-7.963805e-05 ||∇||=5.109844e-01 | Tr=0.1131 Te/Cur=0.1092 Te/Exp=0.2313]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.269665e+00 H=2.269585e+00 dV_dx=3.200654e-08 dV_dθ=-7.963805e-05 ||∇||=5.109844e-01 | Tr=0.1131 Te/Cur=0.1092 Te/Exp=0.2313]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.82s/it] 50%|█████     | 1/2 [00:07<00:04,  4.82s/it, CE=2.289769e+00 H=2.289691e+00 dV_dx=3.061694e-06 dV_dθ=-8.081719e-05 ||∇||=5.150935e-01 | Tr=0.1055 Te/Cur=0.1173 Te/Exp=0.2045]100%|██████████| 2/2 [00:07<00:00,  3.69s/it, CE=2.289769e+00 H=2.289691e+00 dV_dx=3.061694e-06 dV_dθ=-8.081719e-05 ||∇||=5.150935e-01 | Tr=0.1055 Te/Cur=0.1173 Te/Exp=0.2045]100%|██████████| 2/2 [00:07<00:00,  3.86s/it, CE=2.289769e+00 H=2.289691e+00 dV_dx=3.061694e-06 dV_dθ=-8.081719e-05 ||∇||=5.150935e-01 | Tr=0.1055 Te/Cur=0.1173 Te/Exp=0.2045]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.24s/it] 50%|█████     | 1/2 [00:17<00:15, 15.24s/it, CE=2.261820e+00 H=2.261730e+00 dV_dx=-6.781021e-06 dV_dθ=-8.328587e-05 ||∇||=5.712147e-01 | Tr=0.1291 Te/Cur=0.1111 Te/Exp=0.2347]100%|██████████| 2/2 [00:17<00:00,  7.63s/it, CE=2.261820e+00 H=2.261730e+00 dV_dx=-6.781021e-06 dV_dθ=-8.328587e-05 ||∇||=5.712147e-01 | Tr=0.1291 Te/Cur=0.1111 Te/Exp=0.2347]100%|██████████| 2/2 [00:17<00:00,  8.77s/it, CE=2.261820e+00 H=2.261730e+00 dV_dx=-6.781021e-06 dV_dθ=-8.328587e-05 ||∇||=5.712147e-01 | Tr=0.1291 Te/Cur=0.1111 Te/Exp=0.2347]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.40s/it] 50%|█████     | 1/2 [00:07<00:04,  4.40s/it, CE=2.247908e+00 H=2.247816e+00 dV_dx=-8.107737e-06 dV_dθ=-8.432615e-05 ||∇||=5.314589e-01 | Tr=0.1097 Te/Cur=0.1105 Te/Exp=0.2648]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.247908e+00 H=2.247816e+00 dV_dx=-8.107737e-06 dV_dθ=-8.432615e-05 ||∇||=5.314589e-01 | Tr=0.1097 Te/Cur=0.1105 Te/Exp=0.2648]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.247908e+00 H=2.247816e+00 dV_dx=-8.107737e-06 dV_dθ=-8.432615e-05 ||∇||=5.314589e-01 | Tr=0.1097 Te/Cur=0.1105 Te/Exp=0.2648]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.39s/it] 50%|█████     | 1/2 [00:07<00:04,  4.39s/it, CE=2.222434e+00 H=2.222483e+00 dV_dx=2.824912e-07 dV_dθ=4.941044e-05 ||∇||=5.088995e-01 | Tr=0.1342 Te/Cur=0.1079 Te/Exp=0.3117]100%|██████████| 2/2 [00:07<00:00,  3.50s/it, CE=2.222434e+00 H=2.222483e+00 dV_dx=2.824912e-07 dV_dθ=4.941044e-05 ||∇||=5.088995e-01 | Tr=0.1342 Te/Cur=0.1079 Te/Exp=0.3117]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.222434e+00 H=2.222483e+00 dV_dx=2.824912e-07 dV_dθ=4.941044e-05 ||∇||=5.088995e-01 | Tr=0.1342 Te/Cur=0.1079 Te/Exp=0.3117]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.97s/it] 50%|█████     | 1/2 [00:16<00:12, 12.97s/it, CE=2.220784e+00 H=2.220795e+00 dV_dx=8.116431e-06 dV_dθ=3.418438e-06 ||∇||=5.339055e-01 | Tr=0.1119 Te/Cur=0.1072 Te/Exp=0.3138]100%|██████████| 2/2 [00:16<00:00,  7.26s/it, CE=2.220784e+00 H=2.220795e+00 dV_dx=8.116431e-06 dV_dθ=3.418438e-06 ||∇||=5.339055e-01 | Tr=0.1119 Te/Cur=0.1072 Te/Exp=0.3138]100%|██████████| 2/2 [00:16<00:00,  8.12s/it, CE=2.220784e+00 H=2.220795e+00 dV_dx=8.116431e-06 dV_dθ=3.418438e-06 ||∇||=5.339055e-01 | Tr=0.1119 Te/Cur=0.1072 Te/Exp=0.3138]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.78s/it] 50%|█████     | 1/2 [00:17<00:14, 14.78s/it, CE=2.216979e+00 H=2.216931e+00 dV_dx=-5.963108e-06 dV_dθ=-4.147475e-05 ||∇||=4.992237e-01 | Tr=0.1092 Te/Cur=0.1105 Te/Exp=0.2944]100%|██████████| 2/2 [00:17<00:00,  7.59s/it, CE=2.216979e+00 H=2.216931e+00 dV_dx=-5.963108e-06 dV_dθ=-4.147475e-05 ||∇||=4.992237e-01 | Tr=0.1092 Te/Cur=0.1105 Te/Exp=0.2944]100%|██████████| 2/2 [00:17<00:00,  8.66s/it, CE=2.216979e+00 H=2.216931e+00 dV_dx=-5.963108e-06 dV_dθ=-4.147475e-05 ||∇||=4.992237e-01 | Tr=0.1092 Te/Cur=0.1105 Te/Exp=0.2944]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.99s/it] 50%|█████     | 1/2 [00:15<00:12, 12.99s/it, CE=2.223935e+00 H=2.223924e+00 dV_dx=5.421781e-06 dV_dθ=-1.620331e-05 ||∇||=5.121128e-01 | Tr=0.1023 Te/Cur=0.0815 Te/Exp=0.2991]100%|██████████| 2/2 [00:15<00:00,  6.98s/it, CE=2.223935e+00 H=2.223924e+00 dV_dx=5.421781e-06 dV_dθ=-1.620331e-05 ||∇||=5.121128e-01 | Tr=0.1023 Te/Cur=0.0815 Te/Exp=0.2991]100%|██████████| 2/2 [00:15<00:00,  7.88s/it, CE=2.223935e+00 H=2.223924e+00 dV_dx=5.421781e-06 dV_dθ=-1.620331e-05 ||∇||=5.121128e-01 | Tr=0.1023 Te/Cur=0.0815 Te/Exp=0.2991]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.42s/it] 50%|█████     | 1/2 [00:16<00:13, 13.42s/it, CE=2.206810e+00 H=2.206767e+00 dV_dx=-5.631171e-06 dV_dθ=-3.704509e-05 ||∇||=5.457164e-01 | Tr=0.1147 Te/Cur=0.1100 Te/Exp=0.3404]100%|██████████| 2/2 [00:16<00:00,  7.40s/it, CE=2.206810e+00 H=2.206767e+00 dV_dx=-5.631171e-06 dV_dθ=-3.704509e-05 ||∇||=5.457164e-01 | Tr=0.1147 Te/Cur=0.1100 Te/Exp=0.3404]100%|██████████| 2/2 [00:16<00:00,  8.31s/it, CE=2.206810e+00 H=2.206767e+00 dV_dx=-5.631171e-06 dV_dθ=-3.704509e-05 ||∇||=5.457164e-01 | Tr=0.1147 Te/Cur=0.1100 Te/Exp=0.3404]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.72s/it] 50%|█████     | 1/2 [00:07<00:04,  4.72s/it, CE=2.298306e+00 H=2.298218e+00 dV_dx=1.134908e-05 dV_dθ=-9.954838e-05 ||∇||=4.273044e-01 | Tr=0.0960 Te/Cur=0.0728 Te/Exp=0.2034]100%|██████████| 2/2 [00:07<00:00,  3.51s/it, CE=2.298306e+00 H=2.298218e+00 dV_dx=1.134908e-05 dV_dθ=-9.954838e-05 ||∇||=4.273044e-01 | Tr=0.0960 Te/Cur=0.0728 Te/Exp=0.2034]100%|██████████| 2/2 [00:07<00:00,  3.69s/it, CE=2.298306e+00 H=2.298218e+00 dV_dx=1.134908e-05 dV_dθ=-9.954838e-05 ||∇||=4.273044e-01 | Tr=0.0960 Te/Cur=0.0728 Te/Exp=0.2034]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.28s/it] 50%|█████     | 1/2 [00:09<00:06,  6.28s/it, CE=2.295173e+00 H=2.295073e+00 dV_dx=-8.523521e-06 dV_dθ=-9.160308e-05 ||∇||=4.357991e-01 | Tr=0.0945 Te/Cur=0.0959 Te/Exp=0.1624]100%|██████████| 2/2 [00:09<00:00,  4.20s/it, CE=2.295173e+00 H=2.295073e+00 dV_dx=-8.523521e-06 dV_dθ=-9.160308e-05 ||∇||=4.357991e-01 | Tr=0.0945 Te/Cur=0.0959 Te/Exp=0.1624]100%|██████████| 2/2 [00:09<00:00,  4.52s/it, CE=2.295173e+00 H=2.295073e+00 dV_dx=-8.523521e-06 dV_dθ=-9.160308e-05 ||∇||=4.357991e-01 | Tr=0.0945 Te/Cur=0.0959 Te/Exp=0.1624]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.61s/it] 50%|█████     | 1/2 [00:16<00:13, 13.61s/it, CE=2.290308e+00 H=2.290203e+00 dV_dx=-4.741372e-06 dV_dθ=-1.001957e-04 ||∇||=4.661155e-01 | Tr=0.0963 Te/Cur=0.0967 Te/Exp=0.1439]100%|██████████| 2/2 [00:16<00:00,  7.46s/it, CE=2.290308e+00 H=2.290203e+00 dV_dx=-4.741372e-06 dV_dθ=-1.001957e-04 ||∇||=4.661155e-01 | Tr=0.0963 Te/Cur=0.0967 Te/Exp=0.1439]100%|██████████| 2/2 [00:16<00:00,  8.38s/it, CE=2.290308e+00 H=2.290203e+00 dV_dx=-4.741372e-06 dV_dθ=-1.001957e-04 ||∇||=4.661155e-01 | Tr=0.0963 Te/Cur=0.0967 Te/Exp=0.1439]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.71s/it] 50%|█████     | 1/2 [00:07<00:04,  4.71s/it, CE=2.255055e+00 H=2.254982e+00 dV_dx=-1.012160e-06 dV_dθ=-7.136036e-05 ||∇||=4.729356e-01 | Tr=0.1125 Te/Cur=0.1099 Te/Exp=0.2575]100%|██████████| 2/2 [00:07<00:00,  3.73s/it, CE=2.255055e+00 H=2.254982e+00 dV_dx=-1.012160e-06 dV_dθ=-7.136036e-05 ||∇||=4.729356e-01 | Tr=0.1125 Te/Cur=0.1099 Te/Exp=0.2575]100%|██████████| 2/2 [00:07<00:00,  3.88s/it, CE=2.255055e+00 H=2.254982e+00 dV_dx=-1.012160e-06 dV_dθ=-7.136036e-05 ||∇||=4.729356e-01 | Tr=0.1125 Te/Cur=0.1099 Te/Exp=0.2575]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.95s/it] 50%|█████     | 1/2 [00:07<00:04,  4.95s/it, CE=2.253151e+00 H=2.253129e+00 dV_dx=1.200614e-05 dV_dθ=-3.401263e-05 ||∇||=4.088420e-01 | Tr=0.1206 Te/Cur=0.1248 Te/Exp=0.2947]100%|██████████| 2/2 [00:07<00:00,  3.67s/it, CE=2.253151e+00 H=2.253129e+00 dV_dx=1.200614e-05 dV_dθ=-3.401263e-05 ||∇||=4.088420e-01 | Tr=0.1206 Te/Cur=0.1248 Te/Exp=0.2947]100%|██████████| 2/2 [00:07<00:00,  3.86s/it, CE=2.253151e+00 H=2.253129e+00 dV_dx=1.200614e-05 dV_dθ=-3.401263e-05 ||∇||=4.088420e-01 | Tr=0.1206 Te/Cur=0.1248 Te/Exp=0.2947]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.49s/it] 50%|█████     | 1/2 [00:15<00:13, 13.49s/it, CE=2.242246e+00 H=2.242249e+00 dV_dx=3.882825e-06 dV_dθ=-1.214128e-06 ||∇||=4.489175e-01 | Tr=0.1296 Te/Cur=0.1130 Te/Exp=0.2317]100%|██████████| 2/2 [00:15<00:00,  7.02s/it, CE=2.242246e+00 H=2.242249e+00 dV_dx=3.882825e-06 dV_dθ=-1.214128e-06 ||∇||=4.489175e-01 | Tr=0.1296 Te/Cur=0.1130 Te/Exp=0.2317]100%|██████████| 2/2 [00:15<00:00,  7.99s/it, CE=2.242246e+00 H=2.242249e+00 dV_dx=3.882825e-06 dV_dθ=-1.214128e-06 ||∇||=4.489175e-01 | Tr=0.1296 Te/Cur=0.1130 Te/Exp=0.2317]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.34s/it] 50%|█████     | 1/2 [00:17<00:14, 14.34s/it, CE=2.244655e+00 H=2.244610e+00 dV_dx=-1.050046e-06 dV_dθ=-4.395335e-05 ||∇||=4.205074e-01 | Tr=0.0957 Te/Cur=0.0897 Te/Exp=0.2920]100%|██████████| 2/2 [00:17<00:00,  7.64s/it, CE=2.244655e+00 H=2.244610e+00 dV_dx=-1.050046e-06 dV_dθ=-4.395335e-05 ||∇||=4.205074e-01 | Tr=0.0957 Te/Cur=0.0897 Te/Exp=0.2920]100%|██████████| 2/2 [00:17<00:00,  8.65s/it, CE=2.244655e+00 H=2.244610e+00 dV_dx=-1.050046e-06 dV_dθ=-4.395335e-05 ||∇||=4.205074e-01 | Tr=0.0957 Te/Cur=0.0897 Te/Exp=0.2920]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.37s/it] 50%|█████     | 1/2 [00:16<00:13, 13.37s/it, CE=2.235713e+00 H=2.235680e+00 dV_dx=4.720888e-06 dV_dθ=-3.772428e-05 ||∇||=4.507691e-01 | Tr=0.1155 Te/Cur=0.1407 Te/Exp=0.2979]100%|██████████| 2/2 [00:16<00:00,  7.24s/it, CE=2.235713e+00 H=2.235680e+00 dV_dx=4.720888e-06 dV_dθ=-3.772428e-05 ||∇||=4.507691e-01 | Tr=0.1155 Te/Cur=0.1407 Te/Exp=0.2979]100%|██████████| 2/2 [00:16<00:00,  8.16s/it, CE=2.235713e+00 H=2.235680e+00 dV_dx=4.720888e-06 dV_dθ=-3.772428e-05 ||∇||=4.507691e-01 | Tr=0.1155 Te/Cur=0.1407 Te/Exp=0.2979]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.71s/it] 50%|█████     | 1/2 [00:16<00:13, 13.71s/it, CE=2.240687e+00 H=2.240630e+00 dV_dx=-3.643600e-06 dV_dθ=-5.298567e-05 ||∇||=4.602005e-01 | Tr=0.0955 Te/Cur=0.1160 Te/Exp=0.3034]100%|██████████| 2/2 [00:16<00:00,  7.27s/it, CE=2.240687e+00 H=2.240630e+00 dV_dx=-3.643600e-06 dV_dθ=-5.298567e-05 ||∇||=4.602005e-01 | Tr=0.0955 Te/Cur=0.1160 Te/Exp=0.3034]100%|██████████| 2/2 [00:16<00:00,  8.24s/it, CE=2.240687e+00 H=2.240630e+00 dV_dx=-3.643600e-06 dV_dθ=-5.298567e-05 ||∇||=4.602005e-01 | Tr=0.0955 Te/Cur=0.1160 Te/Exp=0.3034]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 572, 104, 10]) with loss 2.183360
  Total candidates evaluated: 54
  Original: (4, [432, 552, 84, 10])
  Optimal: (2, [507, 572, 104, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 4→2, feed [432, 552, 84, 10]→[507, 572, 104, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 4)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:20<06:33, 20.73s/it]  5%|▌         | 1/20 [00:25<06:33, 20.73s/it, CE=1.516302e+00 H=1.515425e+00 dV_dx=2.917424e-05 dV_dθ=-9.057322e-04 ||∇||=1.440820e+00 | Tr=0.4516] 10%|█         | 2/20 [00:25<03:22, 11.27s/it, CE=1.516302e+00 H=1.515425e+00 dV_dx=2.917424e-05 dV_dθ=-9.057322e-04 ||∇||=1.440820e+00 | Tr=0.4516] 10%|█         | 2/20 [00:30<03:22, 11.27s/it, CE=1.206939e+00 H=1.204281e+00 dV_dx=-2.197669e-05 dV_dθ=-2.635728e-03 ||∇||=2.133064e+00 | Tr=0.4516] 15%|█▌        | 3/20 [00:30<02:20,  8.24s/it, CE=1.206939e+00 H=1.204281e+00 dV_dx=-2.197669e-05 dV_dθ=-2.635728e-03 ||∇||=2.133064e+00 | Tr=0.4516] 15%|█▌        | 3/20 [00:34<02:20,  8.24s/it, CE=1.019790e+00 H=1.012921e+00 dV_dx=-8.721550e-06 dV_dθ=-6.859895e-03 ||∇||=2.886780e+00 | Tr=0.4516] 20%|██        | 4/20 [00:34<01:48,  6.81s/it, CE=1.019790e+00 H=1.012921e+00 dV_dx=-8.721550e-06 dV_dθ=-6.859895e-03 ||∇||=2.886780e+00 | Tr=0.4516] 20%|██        | 4/20 [00:38<01:48,  6.81s/it, CE=8.970293e-01 H=8.888411e-01 dV_dx=8.066754e-06 dV_dθ=-8.196300e-03 ||∇||=3.099583e+00 | Tr=0.4516]  25%|██▌       | 5/20 [00:38<01:26,  5.76s/it, CE=8.970293e-01 H=8.888411e-01 dV_dx=8.066754e-06 dV_dθ=-8.196300e-03 ||∇||=3.099583e+00 | Tr=0.4516] 25%|██▌       | 5/20 [00:43<01:26,  5.76s/it, CE=8.124143e-01 H=8.011835e-01 dV_dx=2.785017e-05 dV_dθ=-1.125868e-02 ||∇||=3.570224e+00 | Tr=0.4516] 30%|███       | 6/20 [00:43<01:15,  5.41s/it, CE=8.124143e-01 H=8.011835e-01 dV_dx=2.785017e-05 dV_dθ=-1.125868e-02 ||∇||=3.570224e+00 | Tr=0.4516] 30%|███       | 6/20 [00:47<01:15,  5.41s/it, CE=7.477041e-01 H=7.370451e-01 dV_dx=1.255960e-05 dV_dθ=-1.067156e-02 ||∇||=3.554281e+00 | Tr=0.4516] 35%|███▌      | 7/20 [00:47<01:04,  4.99s/it, CE=7.477041e-01 H=7.370451e-01 dV_dx=1.255960e-05 dV_dθ=-1.067156e-02 ||∇||=3.554281e+00 | Tr=0.4516] 35%|███▌      | 7/20 [00:51<01:04,  4.99s/it, CE=6.966868e-01 H=6.872887e-01 dV_dx=2.012781e-05 dV_dθ=-9.418244e-03 ||∇||=3.439285e+00 | Tr=0.4516] 40%|████      | 8/20 [00:51<00:58,  4.86s/it, CE=6.966868e-01 H=6.872887e-01 dV_dx=2.012781e-05 dV_dθ=-9.418244e-03 ||∇||=3.439285e+00 | Tr=0.4516] 40%|████      | 8/20 [00:56<00:58,  4.86s/it, CE=6.568616e-01 H=6.463804e-01 dV_dx=-2.482002e-05 dV_dθ=-1.045642e-02 ||∇||=3.614300e+00 | Tr=0.4516] 45%|████▌     | 9/20 [00:56<00:52,  4.80s/it, CE=6.568616e-01 H=6.463804e-01 dV_dx=-2.482002e-05 dV_dθ=-1.045642e-02 ||∇||=3.614300e+00 | Tr=0.4516] 45%|████▌     | 9/20 [01:01<00:52,  4.80s/it, CE=6.237489e-01 H=6.136766e-01 dV_dx=-4.516412e-05 dV_dθ=-1.002717e-02 ||∇||=3.598963e+00 | Tr=0.4516] 50%|█████     | 10/20 [01:01<00:46,  4.70s/it, CE=6.237489e-01 H=6.136766e-01 dV_dx=-4.516412e-05 dV_dθ=-1.002717e-02 ||∇||=3.598963e+00 | Tr=0.4516] 50%|█████     | 10/20 [01:05<00:46,  4.70s/it, CE=5.952424e-01 H=5.862459e-01 dV_dx=9.459112e-06 dV_dθ=-9.005958e-03 ||∇||=3.506974e+00 | Tr=0.4516]  55%|█████▌    | 11/20 [01:05<00:41,  4.63s/it, CE=5.952424e-01 H=5.862459e-01 dV_dx=9.459112e-06 dV_dθ=-9.005958e-03 ||∇||=3.506974e+00 | Tr=0.4516] 55%|█████▌    | 11/20 [01:09<00:41,  4.63s/it, CE=5.702375e-01 H=5.626036e-01 dV_dx=2.009973e-05 dV_dθ=-7.654098e-03 ||∇||=3.342547e+00 | Tr=0.4516] 60%|██████    | 12/20 [01:09<00:35,  4.45s/it, CE=5.702375e-01 H=5.626036e-01 dV_dx=2.009973e-05 dV_dθ=-7.654098e-03 ||∇||=3.342547e+00 | Tr=0.4516] 60%|██████    | 12/20 [01:14<00:35,  4.45s/it, CE=5.481375e-01 H=5.414758e-01 dV_dx=-2.961190e-05 dV_dθ=-6.632114e-03 ||∇||=3.217135e+00 | Tr=0.4516] 65%|██████▌   | 13/20 [01:14<00:32,  4.60s/it, CE=5.481375e-01 H=5.414758e-01 dV_dx=-2.961190e-05 dV_dθ=-6.632114e-03 ||∇||=3.217135e+00 | Tr=0.4516] 65%|██████▌   | 13/20 [01:19<00:32,  4.60s/it, CE=5.293681e-01 H=5.233006e-01 dV_dx=-9.524474e-06 dV_dθ=-6.058006e-03 ||∇||=3.162211e+00 | Tr=0.4516] 70%|███████   | 14/20 [01:19<00:27,  4.63s/it, CE=5.293681e-01 H=5.233006e-01 dV_dx=-9.524474e-06 dV_dθ=-6.058006e-03 ||∇||=3.162211e+00 | Tr=0.4516] 70%|███████   | 14/20 [01:24<00:27,  4.63s/it, CE=5.126806e-01 H=5.066897e-01 dV_dx=4.013488e-05 dV_dθ=-6.030998e-03 ||∇||=3.161614e+00 | Tr=0.4516]  75%|███████▌  | 15/20 [01:24<00:23,  4.67s/it, CE=5.126806e-01 H=5.066897e-01 dV_dx=4.013488e-05 dV_dθ=-6.030998e-03 ||∇||=3.161614e+00 | Tr=0.4516] 75%|███████▌  | 15/20 [01:27<00:23,  4.67s/it, CE=4.978810e-01 H=4.920539e-01 dV_dx=1.894519e-05 dV_dθ=-5.845991e-03 ||∇||=3.145348e+00 | Tr=0.4516] 80%|████████  | 16/20 [01:27<00:17,  4.41s/it, CE=4.978810e-01 H=4.920539e-01 dV_dx=1.894519e-05 dV_dθ=-5.845991e-03 ||∇||=3.145348e+00 | Tr=0.4516] 80%|████████  | 16/20 [01:32<00:17,  4.41s/it, CE=4.848156e-01 H=4.786637e-01 dV_dx=-4.389213e-05 dV_dθ=-6.108025e-03 ||∇||=3.206619e+00 | Tr=0.4516] 85%|████████▌ | 17/20 [01:32<00:13,  4.46s/it, CE=4.848156e-01 H=4.786637e-01 dV_dx=-4.389213e-05 dV_dθ=-6.108025e-03 ||∇||=3.206619e+00 | Tr=0.4516] 85%|████████▌ | 17/20 [01:37<00:13,  4.46s/it, CE=4.726243e-01 H=4.658740e-01 dV_dx=-1.301066e-05 dV_dθ=-6.737263e-03 ||∇||=3.281318e+00 | Tr=0.4516] 90%|█████████ | 18/20 [01:37<00:09,  4.52s/it, CE=4.726243e-01 H=4.658740e-01 dV_dx=-1.301066e-05 dV_dθ=-6.737263e-03 ||∇||=3.281318e+00 | Tr=0.4516] 90%|█████████ | 18/20 [01:41<00:09,  4.52s/it, CE=4.615621e-01 H=4.543127e-01 dV_dx=-4.746115e-05 dV_dθ=-7.201915e-03 ||∇||=3.370636e+00 | Tr=0.4516] 95%|█████████▌| 19/20 [01:41<00:04,  4.55s/it, CE=4.615621e-01 H=4.543127e-01 dV_dx=-4.746115e-05 dV_dθ=-7.201915e-03 ||∇||=3.370636e+00 | Tr=0.4516] 95%|█████████▌| 19/20 [01:48<00:04,  4.55s/it, CE=4.508755e-01 H=4.440382e-01 dV_dx=-1.073742e-05 dV_dθ=-6.826557e-03 ||∇||=3.311506e+00 | Tr=0.4516 Te/Cur=0.5984 Te/Exp=0.8378]100%|██████████| 20/20 [01:54<00:00,  7.04s/it, CE=4.508755e-01 H=4.440382e-01 dV_dx=-1.073742e-05 dV_dθ=-6.826557e-03 ||∇||=3.311506e+00 | Tr=0.4516 Te/Cur=0.5984 Te/Exp=0.8378]100%|██████████| 20/20 [01:54<00:00,  5.73s/it, CE=4.508755e-01 H=4.440382e-01 dV_dx=-1.073742e-05 dV_dθ=-6.826557e-03 ||∇||=3.311506e+00 | Tr=0.4516 Te/Cur=0.5984 Te/Exp=0.8378]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.450876
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:01,  9.54s/it]  5%|▌         | 1/20 [00:13<03:01,  9.54s/it, CE=4.603299e-01 H=4.554316e-01 dV_dx=5.806543e-06 dV_dθ=-4.904117e-03 ||∇||=3.053384e+00 | Tr=0.4509] 10%|█         | 2/20 [00:13<01:55,  6.44s/it, CE=4.603299e-01 H=4.554316e-01 dV_dx=5.806543e-06 dV_dθ=-4.904117e-03 ||∇||=3.053384e+00 | Tr=0.4509] 10%|█         | 2/20 [00:18<01:55,  6.44s/it, CE=4.481697e-01 H=4.416212e-01 dV_dx=8.216621e-06 dV_dθ=-6.556685e-03 ||∇||=3.266022e+00 | Tr=0.4509] 15%|█▌        | 3/20 [00:18<01:32,  5.43s/it, CE=4.481697e-01 H=4.416212e-01 dV_dx=8.216621e-06 dV_dθ=-6.556685e-03 ||∇||=3.266022e+00 | Tr=0.4509] 15%|█▌        | 3/20 [00:22<01:32,  5.43s/it, CE=4.393155e-01 H=4.295529e-01 dV_dx=1.768896e-05 dV_dθ=-9.780233e-03 ||∇||=3.646100e+00 | Tr=0.4509] 20%|██        | 4/20 [00:22<01:18,  4.89s/it, CE=4.393155e-01 H=4.295529e-01 dV_dx=1.768896e-05 dV_dθ=-9.780233e-03 ||∇||=3.646100e+00 | Tr=0.4509] 20%|██        | 4/20 [00:25<01:18,  4.89s/it, CE=4.341055e-01 H=4.207585e-01 dV_dx=3.745868e-05 dV_dθ=-1.338450e-02 ||∇||=4.042763e+00 | Tr=0.4509] 25%|██▌       | 5/20 [00:25<01:07,  4.53s/it, CE=4.341055e-01 H=4.207585e-01 dV_dx=3.745868e-05 dV_dθ=-1.338450e-02 ||∇||=4.042763e+00 | Tr=0.4509] 25%|██▌       | 5/20 [00:30<01:07,  4.53s/it, CE=4.213140e-01 H=4.141238e-01 dV_dx=-8.251435e-06 dV_dθ=-7.181948e-03 ||∇||=3.426947e+00 | Tr=0.4509] 30%|███       | 6/20 [00:30<01:02,  4.46s/it, CE=4.213140e-01 H=4.141238e-01 dV_dx=-8.251435e-06 dV_dθ=-7.181948e-03 ||∇||=3.426947e+00 | Tr=0.4509] 30%|███       | 6/20 [00:34<01:02,  4.46s/it, CE=4.116263e-01 H=4.059344e-01 dV_dx=-1.953255e-05 dV_dθ=-5.672375e-03 ||∇||=3.205086e+00 | Tr=0.4509] 35%|███▌      | 7/20 [00:34<00:57,  4.45s/it, CE=4.116263e-01 H=4.059344e-01 dV_dx=-1.953255e-05 dV_dθ=-5.672375e-03 ||∇||=3.205086e+00 | Tr=0.4509] 35%|███▌      | 7/20 [00:39<00:57,  4.45s/it, CE=4.031843e-01 H=3.977760e-01 dV_dx=2.931891e-05 dV_dθ=-5.437656e-03 ||∇||=3.166443e+00 | Tr=0.4509]  40%|████      | 8/20 [00:39<00:53,  4.50s/it, CE=4.031843e-01 H=3.977760e-01 dV_dx=2.931891e-05 dV_dθ=-5.437656e-03 ||∇||=3.166443e+00 | Tr=0.4509] 40%|████      | 8/20 [00:43<00:53,  4.50s/it, CE=3.957229e-01 H=3.902919e-01 dV_dx=2.601892e-05 dV_dθ=-5.457026e-03 ||∇||=3.182560e+00 | Tr=0.4509] 45%|████▌     | 9/20 [00:43<00:48,  4.40s/it, CE=3.957229e-01 H=3.902919e-01 dV_dx=2.601892e-05 dV_dθ=-5.457026e-03 ||∇||=3.182560e+00 | Tr=0.4509] 45%|████▌     | 9/20 [00:47<00:48,  4.40s/it, CE=3.888557e-01 H=3.835609e-01 dV_dx=1.268152e-06 dV_dθ=-5.296091e-03 ||∇||=3.180801e+00 | Tr=0.4509] 50%|█████     | 10/20 [00:47<00:43,  4.33s/it, CE=3.888557e-01 H=3.835609e-01 dV_dx=1.268152e-06 dV_dθ=-5.296091e-03 ||∇||=3.180801e+00 | Tr=0.4509] 50%|█████     | 10/20 [00:52<00:43,  4.33s/it, CE=3.819647e-01 H=3.768778e-01 dV_dx=1.545273e-05 dV_dθ=-5.102349e-03 ||∇||=3.150515e+00 | Tr=0.4509] 55%|█████▌    | 11/20 [00:52<00:39,  4.34s/it, CE=3.819647e-01 H=3.768778e-01 dV_dx=1.545273e-05 dV_dθ=-5.102349e-03 ||∇||=3.150515e+00 | Tr=0.4509] 55%|█████▌    | 11/20 [00:56<00:39,  4.34s/it, CE=3.759865e-01 H=3.707880e-01 dV_dx=-5.091544e-05 dV_dθ=-5.147541e-03 ||∇||=3.159820e+00 | Tr=0.4509] 60%|██████    | 12/20 [00:56<00:34,  4.34s/it, CE=3.759865e-01 H=3.707880e-01 dV_dx=-5.091544e-05 dV_dθ=-5.147541e-03 ||∇||=3.159820e+00 | Tr=0.4509] 60%|██████    | 12/20 [01:00<00:34,  4.34s/it, CE=3.698834e-01 H=3.648240e-01 dV_dx=-1.825350e-05 dV_dθ=-5.041164e-03 ||∇||=3.150859e+00 | Tr=0.4509] 65%|██████▌   | 13/20 [01:00<00:30,  4.41s/it, CE=3.698834e-01 H=3.648240e-01 dV_dx=-1.825350e-05 dV_dθ=-5.041164e-03 ||∇||=3.150859e+00 | Tr=0.4509] 65%|██████▌   | 13/20 [01:05<00:30,  4.41s/it, CE=3.644068e-01 H=3.592270e-01 dV_dx=-8.481810e-06 dV_dθ=-5.171371e-03 ||∇||=3.189269e+00 | Tr=0.4509] 70%|███████   | 14/20 [01:05<00:26,  4.45s/it, CE=3.644068e-01 H=3.592270e-01 dV_dx=-8.481810e-06 dV_dθ=-5.171371e-03 ||∇||=3.189269e+00 | Tr=0.4509] 70%|███████   | 14/20 [01:09<00:26,  4.45s/it, CE=3.588962e-01 H=3.538383e-01 dV_dx=1.477424e-05 dV_dθ=-5.072669e-03 ||∇||=3.188536e+00 | Tr=0.4509]  75%|███████▌  | 15/20 [01:09<00:21,  4.38s/it, CE=3.588962e-01 H=3.538383e-01 dV_dx=1.477424e-05 dV_dθ=-5.072669e-03 ||∇||=3.188536e+00 | Tr=0.4509] 75%|███████▌  | 15/20 [01:14<00:21,  4.38s/it, CE=3.538700e-01 H=3.486858e-01 dV_dx=5.636920e-05 dV_dθ=-5.240633e-03 ||∇||=3.210504e+00 | Tr=0.4509] 80%|████████  | 16/20 [01:14<00:18,  4.52s/it, CE=3.538700e-01 H=3.486858e-01 dV_dx=5.636920e-05 dV_dθ=-5.240633e-03 ||∇||=3.210504e+00 | Tr=0.4509] 80%|████████  | 16/20 [01:19<00:18,  4.52s/it, CE=3.487758e-01 H=3.434023e-01 dV_dx=7.336363e-05 dV_dθ=-5.446863e-03 ||∇||=3.242527e+00 | Tr=0.4509] 85%|████████▌ | 17/20 [01:19<00:14,  4.71s/it, CE=3.487758e-01 H=3.434023e-01 dV_dx=7.336363e-05 dV_dθ=-5.446863e-03 ||∇||=3.242527e+00 | Tr=0.4509] 85%|████████▌ | 17/20 [01:24<00:14,  4.71s/it, CE=3.438237e-01 H=3.385651e-01 dV_dx=2.793541e-05 dV_dθ=-5.286516e-03 ||∇||=3.231843e+00 | Tr=0.4509] 90%|█████████ | 18/20 [01:24<00:09,  4.64s/it, CE=3.438237e-01 H=3.385651e-01 dV_dx=2.793541e-05 dV_dθ=-5.286516e-03 ||∇||=3.231843e+00 | Tr=0.4509] 90%|█████████ | 18/20 [01:29<00:09,  4.64s/it, CE=3.390207e-01 H=3.336665e-01 dV_dx=-1.086476e-05 dV_dθ=-5.343305e-03 ||∇||=3.241681e+00 | Tr=0.4509] 95%|█████████▌| 19/20 [01:29<00:04,  4.85s/it, CE=3.390207e-01 H=3.336665e-01 dV_dx=-1.086476e-05 dV_dθ=-5.343305e-03 ||∇||=3.241681e+00 | Tr=0.4509] 95%|█████████▌| 19/20 [01:36<00:04,  4.85s/it, CE=3.343801e-01 H=3.290308e-01 dV_dx=-6.435498e-05 dV_dθ=-5.284976e-03 ||∇||=3.236979e+00 | Tr=0.4509 Te/Cur=0.6159 Te/Exp=0.8551]100%|██████████| 20/20 [01:39<00:00,  6.36s/it, CE=3.343801e-01 H=3.290308e-01 dV_dx=-6.435498e-05 dV_dθ=-5.284976e-03 ||∇||=3.236979e+00 | Tr=0.4509 Te/Cur=0.6159 Te/Exp=0.8551]100%|██████████| 20/20 [01:39<00:00,  4.97s/it, CE=3.343801e-01 H=3.290308e-01 dV_dx=-6.435498e-05 dV_dθ=-5.284976e-03 ||∇||=3.236979e+00 | Tr=0.4509 Te/Cur=0.6159 Te/Exp=0.8551]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.51s/it] 50%|█████     | 1/2 [00:21<00:15, 15.51s/it, CE=3.643985e-01 H=3.635798e-01 dV_dx=1.630384e-04 dV_dθ=-9.817813e-04 ||∇||=1.206375e+00 | Tr=0.6321 Te/Cur=0.6234 Te/Exp=0.8672]100%|██████████| 2/2 [00:21<00:00,  9.88s/it, CE=3.643985e-01 H=3.635798e-01 dV_dx=1.630384e-04 dV_dθ=-9.817813e-04 ||∇||=1.206375e+00 | Tr=0.6321 Te/Cur=0.6234 Te/Exp=0.8672]100%|██████████| 2/2 [00:21<00:00, 10.72s/it, CE=3.643985e-01 H=3.635798e-01 dV_dx=1.630384e-04 dV_dθ=-9.817813e-04 ||∇||=1.206375e+00 | Tr=0.6321 Te/Cur=0.6234 Te/Exp=0.8672]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<02:56,  9.30s/it]  5%|▌         | 1/20 [00:14<02:56,  9.30s/it, CE=3.556777e-01 H=3.548250e-01 dV_dx=3.761051e-05 dV_dθ=-8.903318e-04 ||∇||=1.171847e+00 | Tr=0.6330] 10%|█         | 2/20 [00:14<01:59,  6.61s/it, CE=3.556777e-01 H=3.548250e-01 dV_dx=3.761051e-05 dV_dθ=-8.903318e-04 ||∇||=1.171847e+00 | Tr=0.6330] 10%|█         | 2/20 [00:18<01:59,  6.61s/it, CE=3.513218e-01 H=3.504369e-01 dV_dx=-5.795719e-05 dV_dθ=-8.269658e-04 ||∇||=1.153255e+00 | Tr=0.6332] 15%|█▌        | 3/20 [00:18<01:33,  5.52s/it, CE=3.513218e-01 H=3.504369e-01 dV_dx=-5.795719e-05 dV_dθ=-8.269658e-04 ||∇||=1.153255e+00 | Tr=0.6332] 15%|█▌        | 3/20 [00:22<01:33,  5.52s/it, CE=3.475649e-01 H=3.467191e-01 dV_dx=-2.235842e-05 dV_dθ=-8.234827e-04 ||∇||=1.151453e+00 | Tr=0.6333] 20%|██        | 4/20 [00:22<01:19,  4.99s/it, CE=3.475649e-01 H=3.467191e-01 dV_dx=-2.235842e-05 dV_dθ=-8.234827e-04 ||∇||=1.151453e+00 | Tr=0.6333] 20%|██        | 4/20 [00:26<01:19,  4.99s/it, CE=3.441881e-01 H=3.433729e-01 dV_dx=4.126776e-06 dV_dθ=-8.194055e-04 ||∇||=1.150035e+00 | Tr=0.6339]  25%|██▌       | 5/20 [00:26<01:11,  4.76s/it, CE=3.441881e-01 H=3.433729e-01 dV_dx=4.126776e-06 dV_dθ=-8.194055e-04 ||∇||=1.150035e+00 | Tr=0.6339] 25%|██▌       | 5/20 [00:32<01:11,  4.76s/it, CE=3.410200e-01 H=3.402372e-01 dV_dx=2.172822e-05 dV_dθ=-8.045570e-04 ||∇||=1.146211e+00 | Tr=0.6342 Te/Cur=0.6271 Te/Exp=0.8727] 30%|███       | 6/20 [00:32<01:11,  5.09s/it, CE=3.410200e-01 H=3.402372e-01 dV_dx=2.172822e-05 dV_dθ=-8.045570e-04 ||∇||=1.146211e+00 | Tr=0.6342 Te/Cur=0.6271 Te/Exp=0.8727] 30%|███       | 6/20 [00:36<01:11,  5.09s/it, CE=3.381567e-01 H=3.373577e-01 dV_dx=9.803349e-06 dV_dθ=-8.087894e-04 ||∇||=1.148425e+00 | Tr=0.6341]                             35%|███▌      | 7/20 [00:36<00:59,  4.60s/it, CE=3.381567e-01 H=3.373577e-01 dV_dx=9.803349e-06 dV_dθ=-8.087894e-04 ||∇||=1.148425e+00 | Tr=0.6341] 35%|███▌      | 7/20 [00:40<00:59,  4.60s/it, CE=3.354001e-01 H=3.345582e-01 dV_dx=-2.459641e-05 dV_dθ=-8.172711e-04 ||∇||=1.151180e+00 | Tr=0.6343] 40%|████      | 8/20 [00:40<00:54,  4.56s/it, CE=3.354001e-01 H=3.345582e-01 dV_dx=-2.459641e-05 dV_dθ=-8.172711e-04 ||∇||=1.151180e+00 | Tr=0.6343] 40%|████      | 8/20 [00:45<00:54,  4.56s/it, CE=3.328042e-01 H=3.319985e-01 dV_dx=1.850994e-05 dV_dθ=-8.242395e-04 ||∇||=1.153750e+00 | Tr=0.6347]  45%|████▌     | 9/20 [00:45<00:50,  4.60s/it, CE=3.328042e-01 H=3.319985e-01 dV_dx=1.850994e-05 dV_dθ=-8.242395e-04 ||∇||=1.153750e+00 | Tr=0.6347] 45%|████▌     | 9/20 [00:50<00:50,  4.60s/it, CE=3.303632e-01 H=3.294701e-01 dV_dx=-5.873912e-05 dV_dθ=-8.343191e-04 ||∇||=1.155079e+00 | Tr=0.6349] 50%|█████     | 10/20 [00:50<00:46,  4.70s/it, CE=3.303632e-01 H=3.294701e-01 dV_dx=-5.873912e-05 dV_dθ=-8.343191e-04 ||∇||=1.155079e+00 | Tr=0.6349] 50%|█████     | 10/20 [00:56<00:46,  4.70s/it, CE=3.280097e-01 H=3.271912e-01 dV_dx=9.152598e-06 dV_dθ=-8.276680e-04 ||∇||=1.152593e+00 | Tr=0.6353 Te/Cur=0.6277 Te/Exp=0.8741] 55%|█████▌    | 11/20 [00:56<00:46,  5.19s/it, CE=3.280097e-01 H=3.271912e-01 dV_dx=9.152598e-06 dV_dθ=-8.276680e-04 ||∇||=1.152593e+00 | Tr=0.6353 Te/Cur=0.6277 Te/Exp=0.8741] 55%|█████▌    | 11/20 [01:00<00:46,  5.19s/it, CE=3.257500e-01 H=3.249282e-01 dV_dx=-1.425906e-05 dV_dθ=-8.075399e-04 ||∇||=1.148830e+00 | Tr=0.6353]                            60%|██████    | 12/20 [01:00<00:38,  4.83s/it, CE=3.257500e-01 H=3.249282e-01 dV_dx=-1.425906e-05 dV_dθ=-8.075399e-04 ||∇||=1.148830e+00 | Tr=0.6353] 60%|██████    | 12/20 [01:04<00:38,  4.83s/it, CE=3.235595e-01 H=3.227141e-01 dV_dx=-4.500175e-05 dV_dθ=-8.004187e-04 ||∇||=1.148507e+00 | Tr=0.6354] 65%|██████▌   | 13/20 [01:04<00:32,  4.61s/it, CE=3.235595e-01 H=3.227141e-01 dV_dx=-4.500175e-05 dV_dθ=-8.004187e-04 ||∇||=1.148507e+00 | Tr=0.6354] 65%|██████▌   | 13/20 [01:09<00:32,  4.61s/it, CE=3.214599e-01 H=3.206179e-01 dV_dx=-2.907005e-05 dV_dθ=-8.129532e-04 ||∇||=1.151193e+00 | Tr=0.6355] 70%|███████   | 14/20 [01:09<00:27,  4.57s/it, CE=3.214599e-01 H=3.206179e-01 dV_dx=-2.907005e-05 dV_dθ=-8.129532e-04 ||∇||=1.151193e+00 | Tr=0.6355] 70%|███████   | 14/20 [01:13<00:27,  4.57s/it, CE=3.193589e-01 H=3.185573e-01 dV_dx=-3.897842e-06 dV_dθ=-7.977201e-04 ||∇||=1.147839e+00 | Tr=0.6357] 75%|███████▌  | 15/20 [01:13<00:22,  4.52s/it, CE=3.193589e-01 H=3.185573e-01 dV_dx=-3.897842e-06 dV_dθ=-7.977201e-04 ||∇||=1.147839e+00 | Tr=0.6357] 75%|███████▌  | 15/20 [01:19<00:22,  4.52s/it, CE=3.172574e-01 H=3.165170e-01 dV_dx=4.596981e-05 dV_dθ=-7.864017e-04 ||∇||=1.145507e+00 | Tr=0.6357 Te/Cur=0.6296 Te/Exp=0.8773] 80%|████████  | 16/20 [01:19<00:19,  4.92s/it, CE=3.172574e-01 H=3.165170e-01 dV_dx=4.596981e-05 dV_dθ=-7.864017e-04 ||∇||=1.145507e+00 | Tr=0.6357 Te/Cur=0.6296 Te/Exp=0.8773] 80%|████████  | 16/20 [01:23<00:19,  4.92s/it, CE=3.152631e-01 H=3.144853e-01 dV_dx=4.084274e-06 dV_dθ=-7.818654e-04 ||∇||=1.145433e+00 | Tr=0.6361]                             85%|████████▌ | 17/20 [01:23<00:14,  4.72s/it, CE=3.152631e-01 H=3.144853e-01 dV_dx=4.084274e-06 dV_dθ=-7.818654e-04 ||∇||=1.145433e+00 | Tr=0.6361] 85%|████████▌ | 17/20 [01:28<00:14,  4.72s/it, CE=3.133363e-01 H=3.125344e-01 dV_dx=-2.175747e-05 dV_dθ=-7.800745e-04 ||∇||=1.145597e+00 | Tr=0.6361] 90%|█████████ | 18/20 [01:28<00:09,  4.63s/it, CE=3.133363e-01 H=3.125344e-01 dV_dx=-2.175747e-05 dV_dθ=-7.800745e-04 ||∇||=1.145597e+00 | Tr=0.6361] 90%|█████████ | 18/20 [01:32<00:09,  4.63s/it, CE=3.114607e-01 H=3.107179e-01 dV_dx=3.332203e-05 dV_dθ=-7.761385e-04 ||∇||=1.144855e+00 | Tr=0.6364]  95%|█████████▌| 19/20 [01:32<00:04,  4.63s/it, CE=3.114607e-01 H=3.107179e-01 dV_dx=3.332203e-05 dV_dθ=-7.761385e-04 ||∇||=1.144855e+00 | Tr=0.6364] 95%|█████████▌| 19/20 [01:38<00:04,  4.63s/it, CE=3.096051e-01 H=3.087512e-01 dV_dx=-8.492952e-05 dV_dθ=-7.689108e-04 ||∇||=1.144009e+00 | Tr=0.6367 Te/Cur=0.6271 Te/Exp=0.8767]100%|██████████| 20/20 [01:38<00:00,  5.05s/it, CE=3.096051e-01 H=3.087512e-01 dV_dx=-8.492952e-05 dV_dθ=-7.689108e-04 ||∇||=1.144009e+00 | Tr=0.6367 Te/Cur=0.6271 Te/Exp=0.8767]100%|██████████| 20/20 [01:38<00:00,  4.93s/it, CE=3.096051e-01 H=3.087512e-01 dV_dx=-8.492952e-05 dV_dθ=-7.689108e-04 ||∇||=1.144009e+00 | Tr=0.6367 Te/Cur=0.6271 Te/Exp=0.8767]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 3 final loss: 0.313431
======================================================================


  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.8035
    Task 1: 0.9603
    Task 2: 0.8635
    Task 3: 0.6275

============================================================
Task 4
============================================================
Initial loss on new task: 1.4715, previous: 0.3096, ratio: 4.75
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 4
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:14<?, ?it/s, CE=5.390381e-01 H=5.368480e-01 dV_dx=1.128834e-06 dV_dθ=-2.191288e-03 ||∇||=1.860866e+00 | Tr=0.8604 Te/Cur=0.8980 Te/Exp=0.8019]100%|██████████| 1/1 [00:14<00:00, 14.48s/it, CE=5.390381e-01 H=5.368480e-01 dV_dx=1.128834e-06 dV_dθ=-2.191288e-03 ||∇||=1.860866e+00 | Tr=0.8604 Te/Cur=0.8980 Te/Exp=0.8019]100%|██████████| 1/1 [00:14<00:00, 14.48s/it, CE=5.390381e-01 H=5.368480e-01 dV_dx=1.128834e-06 dV_dθ=-2.191288e-03 ||∇||=1.860866e+00 | Tr=0.8604 Te/Cur=0.8980 Te/Exp=0.8019]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.539038

[STEP 2] Architecture change decision
  Current: 0.539038, Previous: 0.309605
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9418 samples from 10 classes
  Created balanced validation set: 38294 samples from 10 classes
  Starting grid architecture search for task 4
  Baseline architecture: (2, [507, 572, 104, 10])
  Baseline loss: 0.539038
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.48s/it] 50%|█████     | 1/2 [00:13<00:10, 10.48s/it, CE=2.338584e+00 H=2.338456e+00 dV_dx=5.164156e-06 dV_dθ=-1.333783e-04 ||∇||=3.114914e-01 | Tr=0.1328 Te/Cur=0.1594 Te/Exp=0.1272]100%|██████████| 2/2 [00:13<00:00,  5.89s/it, CE=2.338584e+00 H=2.338456e+00 dV_dx=5.164156e-06 dV_dθ=-1.333783e-04 ||∇||=3.114914e-01 | Tr=0.1328 Te/Cur=0.1594 Te/Exp=0.1272]100%|██████████| 2/2 [00:13<00:00,  6.57s/it, CE=2.338584e+00 H=2.338456e+00 dV_dx=5.164156e-06 dV_dθ=-1.333783e-04 ||∇||=3.114914e-01 | Tr=0.1328 Te/Cur=0.1594 Te/Exp=0.1272]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.338584177106734
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.15s/it] 50%|█████     | 1/2 [00:10<00:08,  8.15s/it, CE=2.332506e+00 H=2.332384e+00 dV_dx=-5.423179e-06 dV_dθ=-1.159686e-04 ||∇||=2.883013e-01 | Tr=0.1519 Te/Cur=0.1792 Te/Exp=0.1199]100%|██████████| 2/2 [00:10<00:00,  4.92s/it, CE=2.332506e+00 H=2.332384e+00 dV_dx=-5.423179e-06 dV_dθ=-1.159686e-04 ||∇||=2.883013e-01 | Tr=0.1519 Te/Cur=0.1792 Te/Exp=0.1199]100%|██████████| 2/2 [00:10<00:00,  5.41s/it, CE=2.332506e+00 H=2.332384e+00 dV_dx=-5.423179e-06 dV_dθ=-1.159686e-04 ||∇||=2.883013e-01 | Tr=0.1519 Te/Cur=0.1792 Te/Exp=0.1199]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 84, 10]) with loss 2.332506
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.34s/it] 50%|█████     | 1/2 [00:17<00:14, 14.34s/it, CE=2.324486e+00 H=2.324362e+00 dV_dx=-3.744361e-06 dV_dθ=-1.197856e-04 ||∇||=2.900658e-01 | Tr=0.1704 Te/Cur=0.1745 Te/Exp=0.1282]100%|██████████| 2/2 [00:17<00:00,  7.82s/it, CE=2.324486e+00 H=2.324362e+00 dV_dx=-3.744361e-06 dV_dθ=-1.197856e-04 ||∇||=2.900658e-01 | Tr=0.1704 Te/Cur=0.1745 Te/Exp=0.1282]100%|██████████| 2/2 [00:17<00:00,  8.80s/it, CE=2.324486e+00 H=2.324362e+00 dV_dx=-3.744361e-06 dV_dθ=-1.197856e-04 ||∇||=2.900658e-01 | Tr=0.1704 Te/Cur=0.1745 Te/Exp=0.1282]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 592, 84, 10]) with loss 2.324486
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.99s/it] 50%|█████     | 1/2 [00:11<00:07,  7.99s/it, CE=2.341174e+00 H=2.341025e+00 dV_dx=3.179273e-06 dV_dθ=-1.515881e-04 ||∇||=3.294731e-01 | Tr=0.1408 Te/Cur=0.1659 Te/Exp=0.1311]100%|██████████| 2/2 [00:11<00:00,  5.18s/it, CE=2.341174e+00 H=2.341025e+00 dV_dx=3.179273e-06 dV_dθ=-1.515881e-04 ||∇||=3.294731e-01 | Tr=0.1408 Te/Cur=0.1659 Te/Exp=0.1311]100%|██████████| 2/2 [00:11<00:00,  5.60s/it, CE=2.341174e+00 H=2.341025e+00 dV_dx=3.179273e-06 dV_dθ=-1.515881e-04 ||∇||=3.294731e-01 | Tr=0.1408 Te/Cur=0.1659 Te/Exp=0.1311]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.37s/it] 50%|█████     | 1/2 [00:12<00:09,  9.37s/it, CE=2.324976e+00 H=2.324815e+00 dV_dx=5.898709e-06 dV_dθ=-1.677127e-04 ||∇||=3.026249e-01 | Tr=0.1609 Te/Cur=0.1630 Te/Exp=0.1344]100%|██████████| 2/2 [00:12<00:00,  5.48s/it, CE=2.324976e+00 H=2.324815e+00 dV_dx=5.898709e-06 dV_dθ=-1.677127e-04 ||∇||=3.026249e-01 | Tr=0.1609 Te/Cur=0.1630 Te/Exp=0.1344]100%|██████████| 2/2 [00:12<00:00,  6.07s/it, CE=2.324976e+00 H=2.324815e+00 dV_dx=5.898709e-06 dV_dθ=-1.677127e-04 ||∇||=3.026249e-01 | Tr=0.1609 Te/Cur=0.1630 Te/Exp=0.1344]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.94s/it] 50%|█████     | 1/2 [00:16<00:13, 13.94s/it, CE=2.333710e+00 H=2.333582e+00 dV_dx=-6.186178e-06 dV_dθ=-1.216790e-04 ||∇||=2.993589e-01 | Tr=0.0975 Te/Cur=0.1020 Te/Exp=0.1007]100%|██████████| 2/2 [00:16<00:00,  7.50s/it, CE=2.333710e+00 H=2.333582e+00 dV_dx=-6.186178e-06 dV_dθ=-1.216790e-04 ||∇||=2.993589e-01 | Tr=0.0975 Te/Cur=0.1020 Te/Exp=0.1007]100%|██████████| 2/2 [00:16<00:00,  8.47s/it, CE=2.333710e+00 H=2.333582e+00 dV_dx=-6.186178e-06 dV_dθ=-1.216790e-04 ||∇||=2.993589e-01 | Tr=0.0975 Te/Cur=0.1020 Te/Exp=0.1007]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.79s/it] 50%|█████     | 1/2 [00:10<00:07,  7.79s/it, CE=2.328595e+00 H=2.328469e+00 dV_dx=-7.521727e-06 dV_dθ=-1.185785e-04 ||∇||=2.948399e-01 | Tr=0.2076 Te/Cur=0.2093 Te/Exp=0.1504]100%|██████████| 2/2 [00:10<00:00,  4.97s/it, CE=2.328595e+00 H=2.328469e+00 dV_dx=-7.521727e-06 dV_dθ=-1.185785e-04 ||∇||=2.948399e-01 | Tr=0.2076 Te/Cur=0.2093 Te/Exp=0.1504]100%|██████████| 2/2 [00:10<00:00,  5.40s/it, CE=2.328595e+00 H=2.328469e+00 dV_dx=-7.521727e-06 dV_dθ=-1.185785e-04 ||∇||=2.948399e-01 | Tr=0.2076 Te/Cur=0.2093 Te/Exp=0.1504]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.85s/it] 50%|█████     | 1/2 [00:16<00:13, 13.85s/it, CE=2.343168e+00 H=2.343034e+00 dV_dx=-5.072468e-06 dV_dθ=-1.288454e-04 ||∇||=2.864116e-01 | Tr=0.2149 Te/Cur=0.2213 Te/Exp=0.1605]100%|██████████| 2/2 [00:16<00:00,  7.21s/it, CE=2.343168e+00 H=2.343034e+00 dV_dx=-5.072468e-06 dV_dθ=-1.288454e-04 ||∇||=2.864116e-01 | Tr=0.2149 Te/Cur=0.2213 Te/Exp=0.1605]100%|██████████| 2/2 [00:16<00:00,  8.20s/it, CE=2.343168e+00 H=2.343034e+00 dV_dx=-5.072468e-06 dV_dθ=-1.288454e-04 ||∇||=2.864116e-01 | Tr=0.2149 Te/Cur=0.2213 Te/Exp=0.1605]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.12s/it] 50%|█████     | 1/2 [00:18<00:16, 16.12s/it, CE=2.342344e+00 H=2.342237e+00 dV_dx=-1.123014e-06 dV_dθ=-1.056546e-04 ||∇||=2.837962e-01 | Tr=0.1307 Te/Cur=0.1493 Te/Exp=0.1171]100%|██████████| 2/2 [00:18<00:00,  8.18s/it, CE=2.342344e+00 H=2.342237e+00 dV_dx=-1.123014e-06 dV_dθ=-1.056546e-04 ||∇||=2.837962e-01 | Tr=0.1307 Te/Cur=0.1493 Te/Exp=0.1171]100%|██████████| 2/2 [00:18<00:00,  9.37s/it, CE=2.342344e+00 H=2.342237e+00 dV_dx=-1.123014e-06 dV_dθ=-1.056546e-04 ||∇||=2.837962e-01 | Tr=0.1307 Te/Cur=0.1493 Te/Exp=0.1171]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.78s/it] 50%|█████     | 1/2 [00:10<00:07,  7.78s/it, CE=2.324422e+00 H=2.324223e+00 dV_dx=-7.879919e-06 dV_dθ=-1.910886e-04 ||∇||=3.475962e-01 | Tr=0.1450 Te/Cur=0.1643 Te/Exp=0.1312]100%|██████████| 2/2 [00:10<00:00,  4.97s/it, CE=2.324422e+00 H=2.324223e+00 dV_dx=-7.879919e-06 dV_dθ=-1.910886e-04 ||∇||=3.475962e-01 | Tr=0.1450 Te/Cur=0.1643 Te/Exp=0.1312]100%|██████████| 2/2 [00:10<00:00,  5.39s/it, CE=2.324422e+00 H=2.324223e+00 dV_dx=-7.879919e-06 dV_dθ=-1.910886e-04 ||∇||=3.475962e-01 | Tr=0.1450 Te/Cur=0.1643 Te/Exp=0.1312]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 552, 84, 10]) with loss 2.324422
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.76s/it] 50%|█████     | 1/2 [00:09<00:06,  6.76s/it, CE=2.319245e+00 H=2.319075e+00 dV_dx=1.019125e-06 dV_dθ=-1.714518e-04 ||∇||=3.462172e-01 | Tr=0.1613 Te/Cur=0.1836 Te/Exp=0.1552]100%|██████████| 2/2 [00:09<00:00,  4.54s/it, CE=2.319245e+00 H=2.319075e+00 dV_dx=1.019125e-06 dV_dθ=-1.714518e-04 ||∇||=3.462172e-01 | Tr=0.1613 Te/Cur=0.1836 Te/Exp=0.1552]100%|██████████| 2/2 [00:09<00:00,  4.87s/it, CE=2.319245e+00 H=2.319075e+00 dV_dx=1.019125e-06 dV_dθ=-1.714518e-04 ||∇||=3.462172e-01 | Tr=0.1613 Te/Cur=0.1836 Te/Exp=0.1552]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 84, 10]) with loss 2.319245
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.12s/it] 50%|█████     | 1/2 [00:16<00:13, 13.12s/it, CE=2.306675e+00 H=2.306514e+00 dV_dx=4.166991e-06 dV_dθ=-1.650503e-04 ||∇||=3.343125e-01 | Tr=0.1455 Te/Cur=0.1482 Te/Exp=0.1520]100%|██████████| 2/2 [00:16<00:00,  7.15s/it, CE=2.306675e+00 H=2.306514e+00 dV_dx=4.166991e-06 dV_dθ=-1.650503e-04 ||∇||=3.343125e-01 | Tr=0.1455 Te/Cur=0.1482 Te/Exp=0.1520]100%|██████████| 2/2 [00:16<00:00,  8.05s/it, CE=2.306675e+00 H=2.306514e+00 dV_dx=4.166991e-06 dV_dθ=-1.650503e-04 ||∇||=3.343125e-01 | Tr=0.1455 Te/Cur=0.1482 Te/Exp=0.1520]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 592, 84, 10]) with loss 2.306675
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.90s/it] 50%|█████     | 1/2 [00:13<00:07,  7.90s/it, CE=2.317813e+00 H=2.317582e+00 dV_dx=1.116395e-07 dV_dθ=-2.312579e-04 ||∇||=3.850997e-01 | Tr=0.1611 Te/Cur=0.1708 Te/Exp=0.1449]100%|██████████| 2/2 [00:13<00:00,  6.28s/it, CE=2.317813e+00 H=2.317582e+00 dV_dx=1.116395e-07 dV_dθ=-2.312579e-04 ||∇||=3.850997e-01 | Tr=0.1611 Te/Cur=0.1708 Te/Exp=0.1449]100%|██████████| 2/2 [00:13<00:00,  6.52s/it, CE=2.317813e+00 H=2.317582e+00 dV_dx=1.116395e-07 dV_dθ=-2.312579e-04 ||∇||=3.850997e-01 | Tr=0.1611 Te/Cur=0.1708 Te/Exp=0.1449]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.57s/it] 50%|█████     | 1/2 [00:10<00:07,  7.57s/it, CE=2.293329e+00 H=2.293114e+00 dV_dx=2.765541e-06 dV_dθ=-2.178760e-04 ||∇||=3.477577e-01 | Tr=0.1824 Te/Cur=0.1980 Te/Exp=0.1716]100%|██████████| 2/2 [00:10<00:00,  4.70s/it, CE=2.293329e+00 H=2.293114e+00 dV_dx=2.765541e-06 dV_dθ=-2.178760e-04 ||∇||=3.477577e-01 | Tr=0.1824 Te/Cur=0.1980 Te/Exp=0.1716]100%|██████████| 2/2 [00:10<00:00,  5.13s/it, CE=2.293329e+00 H=2.293114e+00 dV_dx=2.765541e-06 dV_dθ=-2.178760e-04 ||∇||=3.477577e-01 | Tr=0.1824 Te/Cur=0.1980 Te/Exp=0.1716]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 104, 10]) with loss 2.293329
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.11s/it] 50%|█████     | 1/2 [00:16<00:14, 14.11s/it, CE=2.308992e+00 H=2.308800e+00 dV_dx=-6.186529e-06 dV_dθ=-1.860896e-04 ||∇||=3.541353e-01 | Tr=0.1014 Te/Cur=0.1031 Te/Exp=0.1238]100%|██████████| 2/2 [00:16<00:00,  7.41s/it, CE=2.308992e+00 H=2.308800e+00 dV_dx=-6.186529e-06 dV_dθ=-1.860896e-04 ||∇||=3.541353e-01 | Tr=0.1014 Te/Cur=0.1031 Te/Exp=0.1238]100%|██████████| 2/2 [00:16<00:00,  8.41s/it, CE=2.308992e+00 H=2.308800e+00 dV_dx=-6.186529e-06 dV_dθ=-1.860896e-04 ||∇||=3.541353e-01 | Tr=0.1014 Te/Cur=0.1031 Te/Exp=0.1238]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.14s/it] 50%|█████     | 1/2 [00:11<00:08,  8.14s/it, CE=2.312917e+00 H=2.312782e+00 dV_dx=4.250978e-06 dV_dθ=-1.387740e-04 ||∇||=3.400355e-01 | Tr=0.1751 Te/Cur=0.1830 Te/Exp=0.1631]100%|██████████| 2/2 [00:11<00:00,  5.06s/it, CE=2.312917e+00 H=2.312782e+00 dV_dx=4.250978e-06 dV_dθ=-1.387740e-04 ||∇||=3.400355e-01 | Tr=0.1751 Te/Cur=0.1830 Te/Exp=0.1631]100%|██████████| 2/2 [00:11<00:00,  5.52s/it, CE=2.312917e+00 H=2.312782e+00 dV_dx=4.250978e-06 dV_dθ=-1.387740e-04 ||∇||=3.400355e-01 | Tr=0.1751 Te/Cur=0.1830 Te/Exp=0.1631]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.32s/it] 50%|█████     | 1/2 [00:16<00:13, 13.32s/it, CE=2.306028e+00 H=2.305788e+00 dV_dx=-1.694448e-06 dV_dθ=-2.373942e-04 ||∇||=3.871858e-01 | Tr=0.1950 Te/Cur=0.2010 Te/Exp=0.1850]100%|██████████| 2/2 [00:16<00:00,  7.19s/it, CE=2.306028e+00 H=2.305788e+00 dV_dx=-1.694448e-06 dV_dθ=-2.373942e-04 ||∇||=3.871858e-01 | Tr=0.1950 Te/Cur=0.2010 Te/Exp=0.1850]100%|██████████| 2/2 [00:16<00:00,  8.11s/it, CE=2.306028e+00 H=2.305788e+00 dV_dx=-1.694448e-06 dV_dθ=-2.373942e-04 ||∇||=3.871858e-01 | Tr=0.1950 Te/Cur=0.2010 Te/Exp=0.1850]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.11s/it] 50%|█████     | 1/2 [00:19<00:16, 16.11s/it, CE=2.321018e+00 H=2.320838e+00 dV_dx=1.921151e-07 dV_dθ=-1.801385e-04 ||∇||=3.519167e-01 | Tr=0.1468 Te/Cur=0.1743 Te/Exp=0.1638]100%|██████████| 2/2 [00:19<00:00,  8.35s/it, CE=2.321018e+00 H=2.320838e+00 dV_dx=1.921151e-07 dV_dθ=-1.801385e-04 ||∇||=3.519167e-01 | Tr=0.1468 Te/Cur=0.1743 Te/Exp=0.1638]100%|██████████| 2/2 [00:19<00:00,  9.51s/it, CE=2.321018e+00 H=2.320838e+00 dV_dx=1.921151e-07 dV_dθ=-1.801385e-04 ||∇||=3.519167e-01 | Tr=0.1468 Te/Cur=0.1743 Te/Exp=0.1638]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.09s/it] 50%|█████     | 1/2 [00:10<00:07,  7.09s/it, CE=2.313064e+00 H=2.312870e+00 dV_dx=2.790764e-06 dV_dθ=-1.970433e-04 ||∇||=3.490239e-01 | Tr=0.1583 Te/Cur=0.1650 Te/Exp=0.1302]100%|██████████| 2/2 [00:10<00:00,  4.77s/it, CE=2.313064e+00 H=2.312870e+00 dV_dx=2.790764e-06 dV_dθ=-1.970433e-04 ||∇||=3.490239e-01 | Tr=0.1583 Te/Cur=0.1650 Te/Exp=0.1302]100%|██████████| 2/2 [00:10<00:00,  5.12s/it, CE=2.313064e+00 H=2.312870e+00 dV_dx=2.790764e-06 dV_dθ=-1.970433e-04 ||∇||=3.490239e-01 | Tr=0.1583 Te/Cur=0.1650 Te/Exp=0.1302]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.70s/it] 50%|█████     | 1/2 [00:10<00:07,  7.70s/it, CE=2.323945e+00 H=2.323753e+00 dV_dx=-1.846722e-06 dV_dθ=-1.899456e-04 ||∇||=3.382771e-01 | Tr=0.1378 Te/Cur=0.1386 Te/Exp=0.1294]100%|██████████| 2/2 [00:10<00:00,  5.01s/it, CE=2.323945e+00 H=2.323753e+00 dV_dx=-1.846722e-06 dV_dθ=-1.899456e-04 ||∇||=3.382771e-01 | Tr=0.1378 Te/Cur=0.1386 Te/Exp=0.1294]100%|██████████| 2/2 [00:10<00:00,  5.42s/it, CE=2.323945e+00 H=2.323753e+00 dV_dx=-1.846722e-06 dV_dθ=-1.899456e-04 ||∇||=3.382771e-01 | Tr=0.1378 Te/Cur=0.1386 Te/Exp=0.1294]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.76s/it] 50%|█████     | 1/2 [00:16<00:13, 13.76s/it, CE=2.313155e+00 H=2.312972e+00 dV_dx=-3.140561e-06 dV_dθ=-1.796263e-04 ||∇||=3.495631e-01 | Tr=0.1755 Te/Cur=0.1670 Te/Exp=0.1377]100%|██████████| 2/2 [00:16<00:00,  7.44s/it, CE=2.313155e+00 H=2.312972e+00 dV_dx=-3.140561e-06 dV_dθ=-1.796263e-04 ||∇||=3.495631e-01 | Tr=0.1755 Te/Cur=0.1670 Te/Exp=0.1377]100%|██████████| 2/2 [00:16<00:00,  8.39s/it, CE=2.313155e+00 H=2.312972e+00 dV_dx=-3.140561e-06 dV_dθ=-1.796263e-04 ||∇||=3.495631e-01 | Tr=0.1755 Te/Cur=0.1670 Te/Exp=0.1377]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.39s/it] 50%|█████     | 1/2 [00:10<00:07,  7.39s/it, CE=2.308320e+00 H=2.308041e+00 dV_dx=6.999304e-07 dV_dθ=-2.795978e-04 ||∇||=3.821900e-01 | Tr=0.1741 Te/Cur=0.1751 Te/Exp=0.1521]100%|██████████| 2/2 [00:10<00:00,  4.89s/it, CE=2.308320e+00 H=2.308041e+00 dV_dx=6.999304e-07 dV_dθ=-2.795978e-04 ||∇||=3.821900e-01 | Tr=0.1741 Te/Cur=0.1751 Te/Exp=0.1521]100%|██████████| 2/2 [00:10<00:00,  5.27s/it, CE=2.308320e+00 H=2.308041e+00 dV_dx=6.999304e-07 dV_dθ=-2.795978e-04 ||∇||=3.821900e-01 | Tr=0.1741 Te/Cur=0.1751 Te/Exp=0.1521]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.96s/it] 50%|█████     | 1/2 [00:12<00:09,  9.96s/it, CE=2.306565e+00 H=2.306390e+00 dV_dx=1.354268e-05 dV_dθ=-1.892335e-04 ||∇||=3.377297e-01 | Tr=0.1771 Te/Cur=0.1774 Te/Exp=0.1231]100%|██████████| 2/2 [00:12<00:00,  5.57s/it, CE=2.306565e+00 H=2.306390e+00 dV_dx=1.354268e-05 dV_dθ=-1.892335e-04 ||∇||=3.377297e-01 | Tr=0.1771 Te/Cur=0.1774 Te/Exp=0.1231]100%|██████████| 2/2 [00:12<00:00,  6.23s/it, CE=2.306565e+00 H=2.306390e+00 dV_dx=1.354268e-05 dV_dθ=-1.892335e-04 ||∇||=3.377297e-01 | Tr=0.1771 Te/Cur=0.1774 Te/Exp=0.1231]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.74s/it] 50%|█████     | 1/2 [00:15<00:12, 12.74s/it, CE=2.313275e+00 H=2.313078e+00 dV_dx=2.472301e-06 dV_dθ=-1.998246e-04 ||∇||=3.451958e-01 | Tr=0.1340 Te/Cur=0.1318 Te/Exp=0.1223]100%|██████████| 2/2 [00:15<00:00,  6.92s/it, CE=2.313275e+00 H=2.313078e+00 dV_dx=2.472301e-06 dV_dθ=-1.998246e-04 ||∇||=3.451958e-01 | Tr=0.1340 Te/Cur=0.1318 Te/Exp=0.1223]100%|██████████| 2/2 [00:15<00:00,  7.79s/it, CE=2.313275e+00 H=2.313078e+00 dV_dx=2.472301e-06 dV_dθ=-1.998246e-04 ||∇||=3.451958e-01 | Tr=0.1340 Te/Cur=0.1318 Te/Exp=0.1223]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.50s/it] 50%|█████     | 1/2 [00:10<00:07,  7.50s/it, CE=2.317158e+00 H=2.316916e+00 dV_dx=5.614308e-06 dV_dθ=-2.472100e-04 ||∇||=3.626009e-01 | Tr=0.2294 Te/Cur=0.2328 Te/Exp=0.1315]100%|██████████| 2/2 [00:10<00:00,  4.80s/it, CE=2.317158e+00 H=2.316916e+00 dV_dx=5.614308e-06 dV_dθ=-2.472100e-04 ||∇||=3.626009e-01 | Tr=0.2294 Te/Cur=0.2328 Te/Exp=0.1315]100%|██████████| 2/2 [00:10<00:00,  5.21s/it, CE=2.317158e+00 H=2.316916e+00 dV_dx=5.614308e-06 dV_dθ=-2.472100e-04 ||∇||=3.626009e-01 | Tr=0.2294 Te/Cur=0.2328 Te/Exp=0.1315]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.33s/it] 50%|█████     | 1/2 [00:16<00:13, 13.33s/it, CE=2.306331e+00 H=2.306117e+00 dV_dx=-4.078494e-06 dV_dθ=-2.101981e-04 ||∇||=3.564256e-01 | Tr=0.1981 Te/Cur=0.1992 Te/Exp=0.1872]100%|██████████| 2/2 [00:16<00:00,  7.28s/it, CE=2.306331e+00 H=2.306117e+00 dV_dx=-4.078494e-06 dV_dθ=-2.101981e-04 ||∇||=3.564256e-01 | Tr=0.1981 Te/Cur=0.1992 Te/Exp=0.1872]100%|██████████| 2/2 [00:16<00:00,  8.19s/it, CE=2.306331e+00 H=2.306117e+00 dV_dx=-4.078494e-06 dV_dθ=-2.101981e-04 ||∇||=3.564256e-01 | Tr=0.1981 Te/Cur=0.1992 Te/Exp=0.1872]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.60s/it] 50%|█████     | 1/2 [00:16<00:13, 13.60s/it, CE=2.311192e+00 H=2.311019e+00 dV_dx=6.968030e-06 dV_dθ=-1.802627e-04 ||∇||=3.529823e-01 | Tr=0.1994 Te/Cur=0.1956 Te/Exp=0.1501]100%|██████████| 2/2 [00:16<00:00,  7.03s/it, CE=2.311192e+00 H=2.311019e+00 dV_dx=6.968030e-06 dV_dθ=-1.802627e-04 ||∇||=3.529823e-01 | Tr=0.1994 Te/Cur=0.1956 Te/Exp=0.1501]100%|██████████| 2/2 [00:16<00:00,  8.01s/it, CE=2.311192e+00 H=2.311019e+00 dV_dx=6.968030e-06 dV_dθ=-1.802627e-04 ||∇||=3.529823e-01 | Tr=0.1994 Te/Cur=0.1956 Te/Exp=0.1501]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.72s/it] 50%|█████     | 1/2 [00:12<00:09,  9.72s/it, CE=2.300167e+00 H=2.299929e+00 dV_dx=-3.107805e-06 dV_dθ=-2.345288e-04 ||∇||=4.102340e-01 | Tr=0.1588 Te/Cur=0.1349 Te/Exp=0.1589]100%|██████████| 2/2 [00:12<00:00,  5.55s/it, CE=2.300167e+00 H=2.299929e+00 dV_dx=-3.107805e-06 dV_dθ=-2.345288e-04 ||∇||=4.102340e-01 | Tr=0.1588 Te/Cur=0.1349 Te/Exp=0.1589]100%|██████████| 2/2 [00:12<00:00,  6.18s/it, CE=2.300167e+00 H=2.299929e+00 dV_dx=-3.107805e-06 dV_dθ=-2.345288e-04 ||∇||=4.102340e-01 | Tr=0.1588 Te/Cur=0.1349 Te/Exp=0.1589]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.3001668961794626
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.74s/it] 50%|█████     | 1/2 [00:10<00:07,  7.74s/it, CE=2.316483e+00 H=2.316318e+00 dV_dx=-1.178720e-06 dV_dθ=-1.637980e-04 ||∇||=4.048258e-01 | Tr=0.1598 Te/Cur=0.1517 Te/Exp=0.1512]100%|██████████| 2/2 [00:10<00:00,  5.00s/it, CE=2.316483e+00 H=2.316318e+00 dV_dx=-1.178720e-06 dV_dθ=-1.637980e-04 ||∇||=4.048258e-01 | Tr=0.1598 Te/Cur=0.1517 Te/Exp=0.1512]100%|██████████| 2/2 [00:10<00:00,  5.41s/it, CE=2.316483e+00 H=2.316318e+00 dV_dx=-1.178720e-06 dV_dθ=-1.637980e-04 ||∇||=4.048258e-01 | Tr=0.1598 Te/Cur=0.1517 Te/Exp=0.1512]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.73s/it] 50%|█████     | 1/2 [00:10<00:07,  7.73s/it, CE=2.308280e+00 H=2.308070e+00 dV_dx=9.221660e-07 dV_dθ=-2.117560e-04 ||∇||=4.251769e-01 | Tr=0.2140 Te/Cur=0.2362 Te/Exp=0.1748]100%|██████████| 2/2 [00:10<00:00,  4.94s/it, CE=2.308280e+00 H=2.308070e+00 dV_dx=9.221660e-07 dV_dθ=-2.117560e-04 ||∇||=4.251769e-01 | Tr=0.2140 Te/Cur=0.2362 Te/Exp=0.1748]100%|██████████| 2/2 [00:10<00:00,  5.36s/it, CE=2.308280e+00 H=2.308070e+00 dV_dx=9.221660e-07 dV_dθ=-2.117560e-04 ||∇||=4.251769e-01 | Tr=0.2140 Te/Cur=0.2362 Te/Exp=0.1748]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.43s/it] 50%|█████     | 1/2 [00:10<00:07,  7.43s/it, CE=2.283449e+00 H=2.283280e+00 dV_dx=-1.916867e-06 dV_dθ=-1.674812e-04 ||∇||=3.841335e-01 | Tr=0.1433 Te/Cur=0.1989 Te/Exp=0.2171]100%|██████████| 2/2 [00:10<00:00,  4.77s/it, CE=2.283449e+00 H=2.283280e+00 dV_dx=-1.916867e-06 dV_dθ=-1.674812e-04 ||∇||=3.841335e-01 | Tr=0.1433 Te/Cur=0.1989 Te/Exp=0.2171]100%|██████████| 2/2 [00:10<00:00,  5.17s/it, CE=2.283449e+00 H=2.283280e+00 dV_dx=-1.916867e-06 dV_dθ=-1.674812e-04 ||∇||=3.841335e-01 | Tr=0.1433 Te/Cur=0.1989 Te/Exp=0.2171]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 104, 10]) with loss 2.283449
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.98s/it] 50%|█████     | 1/2 [00:07<00:04,  4.98s/it, CE=2.263373e+00 H=2.263235e+00 dV_dx=3.487370e-06 dV_dθ=-1.410406e-04 ||∇||=3.734512e-01 | Tr=0.2267 Te/Cur=0.2822 Te/Exp=0.2284]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.263373e+00 H=2.263235e+00 dV_dx=3.487370e-06 dV_dθ=-1.410406e-04 ||∇||=3.734512e-01 | Tr=0.2267 Te/Cur=0.2822 Te/Exp=0.2284]100%|██████████| 2/2 [00:07<00:00,  3.86s/it, CE=2.263373e+00 H=2.263235e+00 dV_dx=3.487370e-06 dV_dθ=-1.410406e-04 ||∇||=3.734512e-01 | Tr=0.2267 Te/Cur=0.2822 Te/Exp=0.2284]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 104, 10]) with loss 2.263373
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.78s/it] 50%|█████     | 1/2 [00:12<00:09,  9.78s/it, CE=2.255009e+00 H=2.254876e+00 dV_dx=5.846149e-06 dV_dθ=-1.390108e-04 ||∇||=3.690553e-01 | Tr=0.1692 Te/Cur=0.2022 Te/Exp=0.2494]100%|██████████| 2/2 [00:12<00:00,  5.49s/it, CE=2.255009e+00 H=2.254876e+00 dV_dx=5.846149e-06 dV_dθ=-1.390108e-04 ||∇||=3.690553e-01 | Tr=0.1692 Te/Cur=0.2022 Te/Exp=0.2494]100%|██████████| 2/2 [00:12<00:00,  6.14s/it, CE=2.255009e+00 H=2.254876e+00 dV_dx=5.846149e-06 dV_dθ=-1.390108e-04 ||∇||=3.690553e-01 | Tr=0.1692 Te/Cur=0.2022 Te/Exp=0.2494]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 104, 10]) with loss 2.255009
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.49s/it] 50%|█████     | 1/2 [00:10<00:07,  7.49s/it, CE=2.255777e+00 H=2.255632e+00 dV_dx=3.015945e-06 dV_dθ=-1.476691e-04 ||∇||=3.784727e-01 | Tr=0.2596 Te/Cur=0.3187 Te/Exp=0.2140]100%|██████████| 2/2 [00:10<00:00,  4.74s/it, CE=2.255777e+00 H=2.255632e+00 dV_dx=3.015945e-06 dV_dθ=-1.476691e-04 ||∇||=3.784727e-01 | Tr=0.2596 Te/Cur=0.3187 Te/Exp=0.2140]100%|██████████| 2/2 [00:10<00:00,  5.15s/it, CE=2.255777e+00 H=2.255632e+00 dV_dx=3.015945e-06 dV_dθ=-1.476691e-04 ||∇||=3.784727e-01 | Tr=0.2596 Te/Cur=0.3187 Te/Exp=0.2140]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.68s/it] 50%|█████     | 1/2 [00:10<00:07,  7.68s/it, CE=2.268338e+00 H=2.268174e+00 dV_dx=-2.547357e-06 dV_dθ=-1.613904e-04 ||∇||=3.772776e-01 | Tr=0.1978 Te/Cur=0.1998 Te/Exp=0.2611]100%|██████████| 2/2 [00:10<00:00,  4.76s/it, CE=2.268338e+00 H=2.268174e+00 dV_dx=-2.547357e-06 dV_dθ=-1.613904e-04 ||∇||=3.772776e-01 | Tr=0.1978 Te/Cur=0.1998 Te/Exp=0.2611]100%|██████████| 2/2 [00:10<00:00,  5.20s/it, CE=2.268338e+00 H=2.268174e+00 dV_dx=-2.547357e-06 dV_dθ=-1.613904e-04 ||∇||=3.772776e-01 | Tr=0.1978 Te/Cur=0.1998 Te/Exp=0.2611]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.87s/it] 50%|█████     | 1/2 [00:10<00:07,  7.87s/it, CE=2.258287e+00 H=2.258165e+00 dV_dx=1.613067e-05 dV_dθ=-1.384756e-04 ||∇||=3.780762e-01 | Tr=0.2814 Te/Cur=0.3139 Te/Exp=0.2094]100%|██████████| 2/2 [00:10<00:00,  4.82s/it, CE=2.258287e+00 H=2.258165e+00 dV_dx=1.613067e-05 dV_dθ=-1.384756e-04 ||∇||=3.780762e-01 | Tr=0.2814 Te/Cur=0.3139 Te/Exp=0.2094]100%|██████████| 2/2 [00:10<00:00,  5.28s/it, CE=2.258287e+00 H=2.258165e+00 dV_dx=1.613067e-05 dV_dθ=-1.384756e-04 ||∇||=3.780762e-01 | Tr=0.2814 Te/Cur=0.3139 Te/Exp=0.2094]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.91s/it] 50%|█████     | 1/2 [00:09<00:06,  6.91s/it, CE=2.298436e+00 H=2.298185e+00 dV_dx=-2.132502e-05 dV_dθ=-2.295141e-04 ||∇||=4.571820e-01 | Tr=0.1794 Te/Cur=0.1682 Te/Exp=0.1481]100%|██████████| 2/2 [00:09<00:00,  4.50s/it, CE=2.298436e+00 H=2.298185e+00 dV_dx=-2.132502e-05 dV_dθ=-2.295141e-04 ||∇||=4.571820e-01 | Tr=0.1794 Te/Cur=0.1682 Te/Exp=0.1481]100%|██████████| 2/2 [00:09<00:00,  4.87s/it, CE=2.298436e+00 H=2.298185e+00 dV_dx=-2.132502e-05 dV_dθ=-2.295141e-04 ||∇||=4.571820e-01 | Tr=0.1794 Te/Cur=0.1682 Te/Exp=0.1481]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.19s/it] 50%|█████     | 1/2 [00:12<00:10, 10.19s/it, CE=2.297548e+00 H=2.297331e+00 dV_dx=1.274282e-05 dV_dθ=-2.294641e-04 ||∇||=4.142295e-01 | Tr=0.1855 Te/Cur=0.2601 Te/Exp=0.1698]100%|██████████| 2/2 [00:12<00:00,  5.74s/it, CE=2.297548e+00 H=2.297331e+00 dV_dx=1.274282e-05 dV_dθ=-2.294641e-04 ||∇||=4.142295e-01 | Tr=0.1855 Te/Cur=0.2601 Te/Exp=0.1698]100%|██████████| 2/2 [00:12<00:00,  6.40s/it, CE=2.297548e+00 H=2.297331e+00 dV_dx=1.274282e-05 dV_dθ=-2.294641e-04 ||∇||=4.142295e-01 | Tr=0.1855 Te/Cur=0.2601 Te/Exp=0.1698]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.87s/it] 50%|█████     | 1/2 [00:10<00:07,  7.87s/it, CE=2.298686e+00 H=2.298476e+00 dV_dx=6.017828e-06 dV_dθ=-2.158534e-04 ||∇||=4.220107e-01 | Tr=0.1402 Te/Cur=0.1842 Te/Exp=0.1794]100%|██████████| 2/2 [00:10<00:00,  4.80s/it, CE=2.298686e+00 H=2.298476e+00 dV_dx=6.017828e-06 dV_dθ=-2.158534e-04 ||∇||=4.220107e-01 | Tr=0.1402 Te/Cur=0.1842 Te/Exp=0.1794]100%|██████████| 2/2 [00:10<00:00,  5.26s/it, CE=2.298686e+00 H=2.298476e+00 dV_dx=6.017828e-06 dV_dθ=-2.158534e-04 ||∇||=4.220107e-01 | Tr=0.1402 Te/Cur=0.1842 Te/Exp=0.1794]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.41s/it] 50%|█████     | 1/2 [00:10<00:07,  7.41s/it, CE=2.276962e+00 H=2.276797e+00 dV_dx=1.730241e-05 dV_dθ=-1.825258e-04 ||∇||=4.071323e-01 | Tr=0.2353 Te/Cur=0.2979 Te/Exp=0.2069]100%|██████████| 2/2 [00:10<00:00,  4.72s/it, CE=2.276962e+00 H=2.276797e+00 dV_dx=1.730241e-05 dV_dθ=-1.825258e-04 ||∇||=4.071323e-01 | Tr=0.2353 Te/Cur=0.2979 Te/Exp=0.2069]100%|██████████| 2/2 [00:10<00:00,  5.13s/it, CE=2.276962e+00 H=2.276797e+00 dV_dx=1.730241e-05 dV_dθ=-1.825258e-04 ||∇||=4.071323e-01 | Tr=0.2353 Te/Cur=0.2979 Te/Exp=0.2069]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.20s/it] 50%|█████     | 1/2 [00:07<00:04,  4.20s/it, CE=2.255674e+00 H=2.255502e+00 dV_dx=1.339423e-05 dV_dθ=-1.854584e-04 ||∇||=4.069978e-01 | Tr=0.1980 Te/Cur=0.2521 Te/Exp=0.2089]100%|██████████| 2/2 [00:07<00:00,  3.45s/it, CE=2.255674e+00 H=2.255502e+00 dV_dx=1.339423e-05 dV_dθ=-1.854584e-04 ||∇||=4.069978e-01 | Tr=0.1980 Te/Cur=0.2521 Te/Exp=0.2089]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.255674e+00 H=2.255502e+00 dV_dx=1.339423e-05 dV_dθ=-1.854584e-04 ||∇||=4.069978e-01 | Tr=0.1980 Te/Cur=0.2521 Te/Exp=0.2089]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.86s/it] 50%|█████     | 1/2 [00:10<00:07,  7.86s/it, CE=2.242811e+00 H=2.242596e+00 dV_dx=-2.100798e-05 dV_dθ=-1.940204e-04 ||∇||=4.345562e-01 | Tr=0.1708 Te/Cur=0.2502 Te/Exp=0.2650]100%|██████████| 2/2 [00:10<00:00,  4.80s/it, CE=2.242811e+00 H=2.242596e+00 dV_dx=-2.100798e-05 dV_dθ=-1.940204e-04 ||∇||=4.345562e-01 | Tr=0.1708 Te/Cur=0.2502 Te/Exp=0.2650]100%|██████████| 2/2 [00:10<00:00,  5.26s/it, CE=2.242811e+00 H=2.242596e+00 dV_dx=-2.100798e-05 dV_dθ=-1.940204e-04 ||∇||=4.345562e-01 | Tr=0.1708 Te/Cur=0.2502 Te/Exp=0.2650]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 612, 104, 10]) with loss 2.242811
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.49s/it] 50%|█████     | 1/2 [00:13<00:10, 10.49s/it, CE=2.253729e+00 H=2.253555e+00 dV_dx=1.406810e-05 dV_dθ=-1.877874e-04 ||∇||=4.071835e-01 | Tr=0.2203 Te/Cur=0.2659 Te/Exp=0.2500]100%|██████████| 2/2 [00:13<00:00,  6.09s/it, CE=2.253729e+00 H=2.253555e+00 dV_dx=1.406810e-05 dV_dθ=-1.877874e-04 ||∇||=4.071835e-01 | Tr=0.2203 Te/Cur=0.2659 Te/Exp=0.2500]100%|██████████| 2/2 [00:13<00:00,  6.75s/it, CE=2.253729e+00 H=2.253555e+00 dV_dx=1.406810e-05 dV_dθ=-1.877874e-04 ||∇||=4.071835e-01 | Tr=0.2203 Te/Cur=0.2659 Te/Exp=0.2500]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.95s/it] 50%|█████     | 1/2 [00:10<00:07,  7.95s/it, CE=2.257664e+00 H=2.257500e+00 dV_dx=-5.855310e-07 dV_dθ=-1.636925e-04 ||∇||=3.993489e-01 | Tr=0.2121 Te/Cur=0.2548 Te/Exp=0.2382]100%|██████████| 2/2 [00:10<00:00,  5.05s/it, CE=2.257664e+00 H=2.257500e+00 dV_dx=-5.855310e-07 dV_dθ=-1.636925e-04 ||∇||=3.993489e-01 | Tr=0.2121 Te/Cur=0.2548 Te/Exp=0.2382]100%|██████████| 2/2 [00:10<00:00,  5.48s/it, CE=2.257664e+00 H=2.257500e+00 dV_dx=-5.855310e-07 dV_dθ=-1.636925e-04 ||∇||=3.993489e-01 | Tr=0.2121 Te/Cur=0.2548 Te/Exp=0.2382]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.02s/it] 50%|█████     | 1/2 [00:10<00:08,  8.02s/it, CE=2.240214e+00 H=2.240083e+00 dV_dx=1.412343e-05 dV_dθ=-1.449783e-04 ||∇||=4.004858e-01 | Tr=0.2919 Te/Cur=0.3656 Te/Exp=0.2704]100%|██████████| 2/2 [00:10<00:00,  4.99s/it, CE=2.240214e+00 H=2.240083e+00 dV_dx=1.412343e-05 dV_dθ=-1.449783e-04 ||∇||=4.004858e-01 | Tr=0.2919 Te/Cur=0.3656 Te/Exp=0.2704]100%|██████████| 2/2 [00:10<00:00,  5.44s/it, CE=2.240214e+00 H=2.240083e+00 dV_dx=1.412343e-05 dV_dθ=-1.449783e-04 ||∇||=4.004858e-01 | Tr=0.2919 Te/Cur=0.3656 Te/Exp=0.2704]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 612, 144, 10]) with loss 2.240214
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.88s/it] 50%|█████     | 1/2 [00:10<00:07,  7.88s/it, CE=2.302208e+00 H=2.301946e+00 dV_dx=-9.939158e-06 dV_dθ=-2.515478e-04 ||∇||=4.057953e-01 | Tr=0.2016 Te/Cur=0.2492 Te/Exp=0.1764]100%|██████████| 2/2 [00:10<00:00,  4.97s/it, CE=2.302208e+00 H=2.301946e+00 dV_dx=-9.939158e-06 dV_dθ=-2.515478e-04 ||∇||=4.057953e-01 | Tr=0.2016 Te/Cur=0.2492 Te/Exp=0.1764]100%|██████████| 2/2 [00:10<00:00,  5.41s/it, CE=2.302208e+00 H=2.301946e+00 dV_dx=-9.939158e-06 dV_dθ=-2.515478e-04 ||∇||=4.057953e-01 | Tr=0.2016 Te/Cur=0.2492 Te/Exp=0.1764]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.74s/it] 50%|█████     | 1/2 [00:10<00:07,  7.74s/it, CE=2.303600e+00 H=2.303362e+00 dV_dx=-9.823614e-06 dV_dθ=-2.281689e-04 ||∇||=3.711166e-01 | Tr=0.1903 Te/Cur=0.2766 Te/Exp=0.1690]100%|██████████| 2/2 [00:10<00:00,  4.74s/it, CE=2.303600e+00 H=2.303362e+00 dV_dx=-9.823614e-06 dV_dθ=-2.281689e-04 ||∇||=3.711166e-01 | Tr=0.1903 Te/Cur=0.2766 Te/Exp=0.1690]100%|██████████| 2/2 [00:10<00:00,  5.19s/it, CE=2.303600e+00 H=2.303362e+00 dV_dx=-9.823614e-06 dV_dθ=-2.281689e-04 ||∇||=3.711166e-01 | Tr=0.1903 Te/Cur=0.2766 Te/Exp=0.1690]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.36s/it] 50%|█████     | 1/2 [00:12<00:07,  7.36s/it, CE=2.285453e+00 H=2.285137e+00 dV_dx=-7.404274e-06 dV_dθ=-3.086111e-04 ||∇||=4.496793e-01 | Tr=0.1401 Te/Cur=0.1494 Te/Exp=0.1780]100%|██████████| 2/2 [00:12<00:00,  6.04s/it, CE=2.285453e+00 H=2.285137e+00 dV_dx=-7.404274e-06 dV_dθ=-3.086111e-04 ||∇||=4.496793e-01 | Tr=0.1401 Te/Cur=0.1494 Te/Exp=0.1780]100%|██████████| 2/2 [00:12<00:00,  6.24s/it, CE=2.285453e+00 H=2.285137e+00 dV_dx=-7.404274e-06 dV_dθ=-3.086111e-04 ||∇||=4.496793e-01 | Tr=0.1401 Te/Cur=0.1494 Te/Exp=0.1780]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.54s/it] 50%|█████     | 1/2 [00:10<00:07,  7.54s/it, CE=2.288692e+00 H=2.288457e+00 dV_dx=2.569900e-06 dV_dθ=-2.379267e-04 ||∇||=4.237983e-01 | Tr=0.1875 Te/Cur=0.2206 Te/Exp=0.1732]100%|██████████| 2/2 [00:10<00:00,  4.85s/it, CE=2.288692e+00 H=2.288457e+00 dV_dx=2.569900e-06 dV_dθ=-2.379267e-04 ||∇||=4.237983e-01 | Tr=0.1875 Te/Cur=0.2206 Te/Exp=0.1732]100%|██████████| 2/2 [00:10<00:00,  5.26s/it, CE=2.288692e+00 H=2.288457e+00 dV_dx=2.569900e-06 dV_dθ=-2.379267e-04 ||∇||=4.237983e-01 | Tr=0.1875 Te/Cur=0.2206 Te/Exp=0.1732]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.81s/it] 50%|█████     | 1/2 [00:07<00:04,  4.81s/it, CE=2.266795e+00 H=2.266640e+00 dV_dx=1.423294e-06 dV_dθ=-1.561771e-04 ||∇||=3.825542e-01 | Tr=0.1977 Te/Cur=0.2406 Te/Exp=0.1943]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.266795e+00 H=2.266640e+00 dV_dx=1.423294e-06 dV_dθ=-1.561771e-04 ||∇||=3.825542e-01 | Tr=0.1977 Te/Cur=0.2406 Te/Exp=0.1943]100%|██████████| 2/2 [00:07<00:00,  3.85s/it, CE=2.266795e+00 H=2.266640e+00 dV_dx=1.423294e-06 dV_dθ=-1.561771e-04 ||∇||=3.825542e-01 | Tr=0.1977 Te/Cur=0.2406 Te/Exp=0.1943]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.58s/it] 50%|█████     | 1/2 [00:10<00:07,  7.58s/it, CE=2.254630e+00 H=2.254401e+00 dV_dx=7.134213e-07 dV_dθ=-2.303422e-04 ||∇||=4.139013e-01 | Tr=0.2099 Te/Cur=0.3200 Te/Exp=0.2139]100%|██████████| 2/2 [00:10<00:00,  4.91s/it, CE=2.254630e+00 H=2.254401e+00 dV_dx=7.134213e-07 dV_dθ=-2.303422e-04 ||∇||=4.139013e-01 | Tr=0.2099 Te/Cur=0.3200 Te/Exp=0.2139]100%|██████████| 2/2 [00:10<00:00,  5.31s/it, CE=2.254630e+00 H=2.254401e+00 dV_dx=7.134213e-07 dV_dθ=-2.303422e-04 ||∇||=4.139013e-01 | Tr=0.2099 Te/Cur=0.3200 Te/Exp=0.2139]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.61s/it] 50%|█████     | 1/2 [00:10<00:07,  7.61s/it, CE=2.259988e+00 H=2.259809e+00 dV_dx=-1.055358e-05 dV_dθ=-1.677629e-04 ||∇||=3.758500e-01 | Tr=0.2596 Te/Cur=0.2863 Te/Exp=0.2311]100%|██████████| 2/2 [00:10<00:00,  4.87s/it, CE=2.259988e+00 H=2.259809e+00 dV_dx=-1.055358e-05 dV_dθ=-1.677629e-04 ||∇||=3.758500e-01 | Tr=0.2596 Te/Cur=0.2863 Te/Exp=0.2311]100%|██████████| 2/2 [00:10<00:00,  5.28s/it, CE=2.259988e+00 H=2.259809e+00 dV_dx=-1.055358e-05 dV_dθ=-1.677629e-04 ||∇||=3.758500e-01 | Tr=0.2596 Te/Cur=0.2863 Te/Exp=0.2311]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.81s/it] 50%|█████     | 1/2 [00:10<00:07,  7.81s/it, CE=2.247975e+00 H=2.247721e+00 dV_dx=7.168086e-06 dV_dθ=-2.613868e-04 ||∇||=4.238779e-01 | Tr=0.1360 Te/Cur=0.1499 Te/Exp=0.1910]100%|██████████| 2/2 [00:10<00:00,  4.93s/it, CE=2.247975e+00 H=2.247721e+00 dV_dx=7.168086e-06 dV_dθ=-2.613868e-04 ||∇||=4.238779e-01 | Tr=0.1360 Te/Cur=0.1499 Te/Exp=0.1910]100%|██████████| 2/2 [00:10<00:00,  5.36s/it, CE=2.247975e+00 H=2.247721e+00 dV_dx=7.168086e-06 dV_dθ=-2.613868e-04 ||∇||=4.238779e-01 | Tr=0.1360 Te/Cur=0.1499 Te/Exp=0.1910]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.23s/it] 50%|█████     | 1/2 [00:13<00:10, 10.23s/it, CE=2.266256e+00 H=2.266109e+00 dV_dx=1.422665e-05 dV_dθ=-1.603828e-04 ||∇||=3.745756e-01 | Tr=0.1989 Te/Cur=0.2375 Te/Exp=0.2097]100%|██████████| 2/2 [00:13<00:00,  5.98s/it, CE=2.266256e+00 H=2.266109e+00 dV_dx=1.422665e-05 dV_dθ=-1.603828e-04 ||∇||=3.745756e-01 | Tr=0.1989 Te/Cur=0.2375 Te/Exp=0.2097]100%|██████████| 2/2 [00:13<00:00,  6.61s/it, CE=2.266256e+00 H=2.266109e+00 dV_dx=1.422665e-05 dV_dθ=-1.603828e-04 ||∇||=3.745756e-01 | Tr=0.1989 Te/Cur=0.2375 Te/Exp=0.2097]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (3, [507, 612, 144, 10]) with loss 2.240214
  Total candidates evaluated: 54
  Original: (2, [507, 572, 104, 10])
  Optimal: (3, [507, 612, 144, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→3, feed [507, 572, 104, 10]→[507, 612, 144, 10]
  Conv filter changed: A_conv/B_conv shape = (3, 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:20<06:38, 20.96s/it]  5%|▌         | 1/20 [00:25<06:38, 20.96s/it, CE=1.552999e+00 H=1.545854e+00 dV_dx=4.186734e-05 dV_dθ=-7.186437e-03 ||∇||=3.467956e+00 | Tr=0.9001] 10%|█         | 2/20 [00:25<03:24, 11.38s/it, CE=1.552999e+00 H=1.545854e+00 dV_dx=4.186734e-05 dV_dθ=-7.186437e-03 ||∇||=3.467956e+00 | Tr=0.9001] 10%|█         | 2/20 [00:30<03:24, 11.38s/it, CE=1.314483e+00 H=1.304455e+00 dV_dx=7.281932e-05 dV_dθ=-1.010017e-02 ||∇||=3.702093e+00 | Tr=0.9001] 15%|█▌        | 3/20 [00:30<02:22,  8.36s/it, CE=1.314483e+00 H=1.304455e+00 dV_dx=7.281932e-05 dV_dθ=-1.010017e-02 ||∇||=3.702093e+00 | Tr=0.9001] 15%|█▌        | 3/20 [00:35<02:22,  8.36s/it, CE=1.173824e+00 H=1.166726e+00 dV_dx=-6.822560e-06 dV_dθ=-7.091163e-03 ||∇||=3.421759e+00 | Tr=0.9001] 20%|██        | 4/20 [00:35<01:53,  7.08s/it, CE=1.173824e+00 H=1.166726e+00 dV_dx=-6.822560e-06 dV_dθ=-7.091163e-03 ||∇||=3.421759e+00 | Tr=0.9001] 20%|██        | 4/20 [00:39<01:53,  7.08s/it, CE=1.074298e+00 H=1.068849e+00 dV_dx=1.823885e-05 dV_dθ=-5.467460e-03 ||∇||=3.216357e+00 | Tr=0.9001]  25%|██▌       | 5/20 [00:39<01:31,  6.11s/it, CE=1.074298e+00 H=1.068849e+00 dV_dx=1.823885e-05 dV_dθ=-5.467460e-03 ||∇||=3.216357e+00 | Tr=0.9001] 25%|██▌       | 5/20 [00:44<01:31,  6.11s/it, CE=9.991306e-01 H=9.939143e-01 dV_dx=2.796352e-05 dV_dθ=-5.244221e-03 ||∇||=3.223597e+00 | Tr=0.9001] 30%|███       | 6/20 [00:44<01:17,  5.54s/it, CE=9.991306e-01 H=9.939143e-01 dV_dx=2.796352e-05 dV_dθ=-5.244221e-03 ||∇||=3.223597e+00 | Tr=0.9001] 30%|███       | 6/20 [00:49<01:17,  5.54s/it, CE=9.394347e-01 H=9.338636e-01 dV_dx=3.929697e-05 dV_dθ=-5.610336e-03 ||∇||=3.380950e+00 | Tr=0.9001] 35%|███▌      | 7/20 [00:49<01:09,  5.31s/it, CE=9.394347e-01 H=9.338636e-01 dV_dx=3.929697e-05 dV_dθ=-5.610336e-03 ||∇||=3.380950e+00 | Tr=0.9001] 35%|███▌      | 7/20 [00:54<01:09,  5.31s/it, CE=8.898928e-01 H=8.847834e-01 dV_dx=6.570849e-05 dV_dθ=-5.175102e-03 ||∇||=3.464861e+00 | Tr=0.9001] 40%|████      | 8/20 [00:54<01:02,  5.19s/it, CE=8.898928e-01 H=8.847834e-01 dV_dx=6.570849e-05 dV_dθ=-5.175102e-03 ||∇||=3.464861e+00 | Tr=0.9001] 40%|████      | 8/20 [00:59<01:02,  5.19s/it, CE=8.499803e-01 H=8.428622e-01 dV_dx=3.660466e-05 dV_dθ=-7.154655e-03 ||∇||=3.785239e+00 | Tr=0.9001] 45%|████▌     | 9/20 [00:59<00:56,  5.18s/it, CE=8.499803e-01 H=8.428622e-01 dV_dx=3.660466e-05 dV_dθ=-7.154655e-03 ||∇||=3.785239e+00 | Tr=0.9001] 45%|████▌     | 9/20 [01:04<00:56,  5.18s/it, CE=8.151389e-01 H=8.082825e-01 dV_dx=2.716338e-05 dV_dθ=-6.883539e-03 ||∇||=3.760875e+00 | Tr=0.9001] 50%|█████     | 10/20 [01:04<00:53,  5.32s/it, CE=8.151389e-01 H=8.082825e-01 dV_dx=2.716338e-05 dV_dθ=-6.883539e-03 ||∇||=3.760875e+00 | Tr=0.9001] 50%|█████     | 10/20 [01:09<00:53,  5.32s/it, CE=7.855706e-01 H=7.796924e-01 dV_dx=-5.774521e-05 dV_dθ=-5.820462e-03 ||∇||=3.615076e+00 | Tr=0.9001] 55%|█████▌    | 11/20 [01:09<00:47,  5.23s/it, CE=7.855706e-01 H=7.796924e-01 dV_dx=-5.774521e-05 dV_dθ=-5.820462e-03 ||∇||=3.615076e+00 | Tr=0.9001] 55%|█████▌    | 11/20 [01:14<00:47,  5.23s/it, CE=7.611254e-01 H=7.562707e-01 dV_dx=-7.950979e-05 dV_dθ=-4.775216e-03 ||∇||=3.543905e+00 | Tr=0.9001] 60%|██████    | 12/20 [01:14<00:41,  5.18s/it, CE=7.611254e-01 H=7.562707e-01 dV_dx=-7.950979e-05 dV_dθ=-4.775216e-03 ||∇||=3.543905e+00 | Tr=0.9001] 60%|██████    | 12/20 [01:20<00:41,  5.18s/it, CE=7.397813e-01 H=7.350460e-01 dV_dx=-5.858928e-05 dV_dθ=-4.676621e-03 ||∇||=3.546252e+00 | Tr=0.9001] 65%|██████▌   | 13/20 [01:20<00:35,  5.13s/it, CE=7.397813e-01 H=7.350460e-01 dV_dx=-5.858928e-05 dV_dθ=-4.676621e-03 ||∇||=3.546252e+00 | Tr=0.9001] 65%|██████▌   | 13/20 [01:24<00:35,  5.13s/it, CE=7.204516e-01 H=7.165856e-01 dV_dx=1.628074e-05 dV_dθ=-3.882329e-03 ||∇||=3.397853e+00 | Tr=0.9001]  70%|███████   | 14/20 [01:24<00:29,  4.98s/it, CE=7.204516e-01 H=7.165856e-01 dV_dx=1.628074e-05 dV_dθ=-3.882329e-03 ||∇||=3.397853e+00 | Tr=0.9001] 70%|███████   | 14/20 [01:29<00:29,  4.98s/it, CE=7.032642e-01 H=7.000546e-01 dV_dx=6.104508e-05 dV_dθ=-3.270668e-03 ||∇||=3.304490e+00 | Tr=0.9001] 75%|███████▌  | 15/20 [01:29<00:24,  4.91s/it, CE=7.032642e-01 H=7.000546e-01 dV_dx=6.104508e-05 dV_dθ=-3.270668e-03 ||∇||=3.304490e+00 | Tr=0.9001] 75%|███████▌  | 15/20 [01:34<00:24,  4.91s/it, CE=6.874555e-01 H=6.851904e-01 dV_dx=6.151056e-05 dV_dθ=-2.326591e-03 ||∇||=3.214065e+00 | Tr=0.9001] 80%|████████  | 16/20 [01:34<00:19,  4.84s/it, CE=6.874555e-01 H=6.851904e-01 dV_dx=6.151056e-05 dV_dθ=-2.326591e-03 ||∇||=3.214065e+00 | Tr=0.9001] 80%|████████  | 16/20 [01:39<00:19,  4.84s/it, CE=6.743427e-01 H=6.717121e-01 dV_dx=-1.317413e-05 dV_dθ=-2.617416e-03 ||∇||=3.284434e+00 | Tr=0.9001] 85%|████████▌ | 17/20 [01:39<00:14,  4.90s/it, CE=6.743427e-01 H=6.717121e-01 dV_dx=-1.317413e-05 dV_dθ=-2.617416e-03 ||∇||=3.284434e+00 | Tr=0.9001] 85%|████████▌ | 17/20 [01:44<00:14,  4.90s/it, CE=6.624368e-01 H=6.596173e-01 dV_dx=4.443192e-05 dV_dθ=-2.863928e-03 ||∇||=3.361310e+00 | Tr=0.9001]  90%|█████████ | 18/20 [01:44<00:09,  4.95s/it, CE=6.624368e-01 H=6.596173e-01 dV_dx=4.443192e-05 dV_dθ=-2.863928e-03 ||∇||=3.361310e+00 | Tr=0.9001] 90%|█████████ | 18/20 [01:48<00:09,  4.95s/it, CE=6.515073e-01 H=6.484726e-01 dV_dx=2.096773e-05 dV_dθ=-3.055736e-03 ||∇||=3.412225e+00 | Tr=0.9001] 95%|█████████▌| 19/20 [01:48<00:04,  4.65s/it, CE=6.515073e-01 H=6.484726e-01 dV_dx=2.096773e-05 dV_dθ=-3.055736e-03 ||∇||=3.412225e+00 | Tr=0.9001] 95%|█████████▌| 19/20 [01:55<00:04,  4.65s/it, CE=6.410473e-01 H=6.377901e-01 dV_dx=2.554211e-05 dV_dθ=-3.282701e-03 ||∇||=3.450630e+00 | Tr=0.9001 Te/Cur=0.9570 Te/Exp=0.7590]100%|██████████| 20/20 [02:02<00:00,  7.51s/it, CE=6.410473e-01 H=6.377901e-01 dV_dx=2.554211e-05 dV_dθ=-3.282701e-03 ||∇||=3.450630e+00 | Tr=0.9001 Te/Cur=0.9570 Te/Exp=0.7590]100%|██████████| 20/20 [02:02<00:00,  6.12s/it, CE=6.410473e-01 H=6.377901e-01 dV_dx=2.554211e-05 dV_dθ=-3.282701e-03 ||∇||=3.450630e+00 | Tr=0.9001 Te/Cur=0.9570 Te/Exp=0.7590]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.590043
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:14, 10.25s/it]  5%|▌         | 1/20 [00:14<03:14, 10.25s/it, CE=6.738397e-01 H=6.623450e-01 dV_dx=-1.069651e-04 dV_dθ=-1.138771e-02 ||∇||=4.520956e+00 | Tr=0.9000] 10%|█         | 2/20 [00:14<02:02,  6.83s/it, CE=6.738397e-01 H=6.623450e-01 dV_dx=-1.069651e-04 dV_dθ=-1.138771e-02 ||∇||=4.520956e+00 | Tr=0.9000] 10%|█         | 2/20 [00:19<02:02,  6.83s/it, CE=6.522659e-01 H=6.457875e-01 dV_dx=-1.540045e-05 dV_dθ=-6.463051e-03 ||∇||=3.771470e+00 | Tr=0.9000] 15%|█▌        | 3/20 [00:19<01:38,  5.82s/it, CE=6.522659e-01 H=6.457875e-01 dV_dx=-1.540045e-05 dV_dθ=-6.463051e-03 ||∇||=3.771470e+00 | Tr=0.9000] 15%|█▌        | 3/20 [00:23<01:38,  5.82s/it, CE=6.372592e-01 H=6.316931e-01 dV_dx=-2.722622e-05 dV_dθ=-5.538898e-03 ||∇||=3.623883e+00 | Tr=0.9000] 20%|██        | 4/20 [00:23<01:26,  5.38s/it, CE=6.372592e-01 H=6.316931e-01 dV_dx=-2.722622e-05 dV_dθ=-5.538898e-03 ||∇||=3.623883e+00 | Tr=0.9000] 20%|██        | 4/20 [00:28<01:26,  5.38s/it, CE=6.254949e-01 H=6.206862e-01 dV_dx=-1.427112e-05 dV_dθ=-4.794423e-03 ||∇||=3.519936e+00 | Tr=0.9000] 25%|██▌       | 5/20 [00:28<01:15,  5.03s/it, CE=6.254949e-01 H=6.206862e-01 dV_dx=-1.427112e-05 dV_dθ=-4.794423e-03 ||∇||=3.519936e+00 | Tr=0.9000] 25%|██▌       | 5/20 [00:32<01:15,  5.03s/it, CE=6.159732e-01 H=6.117135e-01 dV_dx=3.623022e-05 dV_dθ=-4.295934e-03 ||∇||=3.425089e+00 | Tr=0.9000]  30%|███       | 6/20 [00:32<01:07,  4.86s/it, CE=6.159732e-01 H=6.117135e-01 dV_dx=3.623022e-05 dV_dθ=-4.295934e-03 ||∇||=3.425089e+00 | Tr=0.9000] 30%|███       | 6/20 [00:38<01:07,  4.86s/it, CE=6.072949e-01 H=6.033762e-01 dV_dx=2.724553e-05 dV_dθ=-3.945951e-03 ||∇||=3.366427e+00 | Tr=0.9000] 35%|███▌      | 7/20 [00:38<01:04,  4.94s/it, CE=6.072949e-01 H=6.033762e-01 dV_dx=2.724553e-05 dV_dθ=-3.945951e-03 ||∇||=3.366427e+00 | Tr=0.9000] 35%|███▌      | 7/20 [00:42<01:04,  4.94s/it, CE=5.986401e-01 H=5.948271e-01 dV_dx=5.111716e-05 dV_dθ=-3.864086e-03 ||∇||=3.357690e+00 | Tr=0.9000] 40%|████      | 8/20 [00:42<00:57,  4.77s/it, CE=5.986401e-01 H=5.948271e-01 dV_dx=5.111716e-05 dV_dθ=-3.864086e-03 ||∇||=3.357690e+00 | Tr=0.9000] 40%|████      | 8/20 [00:47<00:57,  4.77s/it, CE=5.902536e-01 H=5.861164e-01 dV_dx=1.510708e-05 dV_dθ=-4.152283e-03 ||∇||=3.426102e+00 | Tr=0.9000] 45%|████▌     | 9/20 [00:47<00:53,  4.82s/it, CE=5.902536e-01 H=5.861164e-01 dV_dx=1.510708e-05 dV_dθ=-4.152283e-03 ||∇||=3.426102e+00 | Tr=0.9000] 45%|████▌     | 9/20 [00:52<00:53,  4.82s/it, CE=5.822752e-01 H=5.780432e-01 dV_dx=-6.107223e-05 dV_dθ=-4.170974e-03 ||∇||=3.425309e+00 | Tr=0.9000] 50%|█████     | 10/20 [00:52<00:47,  4.77s/it, CE=5.822752e-01 H=5.780432e-01 dV_dx=-6.107223e-05 dV_dθ=-4.170974e-03 ||∇||=3.425309e+00 | Tr=0.9000] 50%|█████     | 10/20 [00:56<00:47,  4.77s/it, CE=5.737255e-01 H=5.699061e-01 dV_dx=8.028736e-05 dV_dθ=-3.899724e-03 ||∇||=3.331093e+00 | Tr=0.9000]  55%|█████▌    | 11/20 [00:56<00:43,  4.80s/it, CE=5.737255e-01 H=5.699061e-01 dV_dx=8.028736e-05 dV_dθ=-3.899724e-03 ||∇||=3.331093e+00 | Tr=0.9000] 55%|█████▌    | 11/20 [01:01<00:43,  4.80s/it, CE=5.653558e-01 H=5.619979e-01 dV_dx=-4.070363e-05 dV_dθ=-3.317254e-03 ||∇||=3.224518e+00 | Tr=0.9000] 60%|██████    | 12/20 [01:01<00:38,  4.83s/it, CE=5.653558e-01 H=5.619979e-01 dV_dx=-4.070363e-05 dV_dθ=-3.317254e-03 ||∇||=3.224518e+00 | Tr=0.9000] 60%|██████    | 12/20 [01:06<00:38,  4.83s/it, CE=5.567351e-01 H=5.541325e-01 dV_dx=-5.161752e-05 dV_dθ=-2.551017e-03 ||∇||=3.043697e+00 | Tr=0.9000] 65%|██████▌   | 13/20 [01:06<00:34,  4.89s/it, CE=5.567351e-01 H=5.541325e-01 dV_dx=-5.161752e-05 dV_dθ=-2.551017e-03 ||∇||=3.043697e+00 | Tr=0.9000] 65%|██████▌   | 13/20 [01:11<00:34,  4.89s/it, CE=5.496918e-01 H=5.474286e-01 dV_dx=4.123841e-05 dV_dθ=-2.304414e-03 ||∇||=2.977142e+00 | Tr=0.9000]  70%|███████   | 14/20 [01:11<00:28,  4.73s/it, CE=5.496918e-01 H=5.474286e-01 dV_dx=4.123841e-05 dV_dθ=-2.304414e-03 ||∇||=2.977142e+00 | Tr=0.9000] 70%|███████   | 14/20 [01:16<00:28,  4.73s/it, CE=5.446083e-01 H=5.423796e-01 dV_dx=6.686870e-05 dV_dθ=-2.295528e-03 ||∇||=2.948513e+00 | Tr=0.9000] 75%|███████▌  | 15/20 [01:16<00:24,  4.93s/it, CE=5.446083e-01 H=5.423796e-01 dV_dx=6.686870e-05 dV_dθ=-2.295528e-03 ||∇||=2.948513e+00 | Tr=0.9000] 75%|███████▌  | 15/20 [01:21<00:24,  4.93s/it, CE=5.395888e-01 H=5.373104e-01 dV_dx=3.442972e-05 dV_dθ=-2.312887e-03 ||∇||=2.995795e+00 | Tr=0.9000] 80%|████████  | 16/20 [01:21<00:19,  4.88s/it, CE=5.395888e-01 H=5.373104e-01 dV_dx=3.442972e-05 dV_dθ=-2.312887e-03 ||∇||=2.995795e+00 | Tr=0.9000] 80%|████████  | 16/20 [01:26<00:19,  4.88s/it, CE=5.359168e-01 H=5.332957e-01 dV_dx=1.163661e-04 dV_dθ=-2.737431e-03 ||∇||=3.086542e+00 | Tr=0.9000] 85%|████████▌ | 17/20 [01:26<00:15,  5.04s/it, CE=5.359168e-01 H=5.332957e-01 dV_dx=1.163661e-04 dV_dθ=-2.737431e-03 ||∇||=3.086542e+00 | Tr=0.9000] 85%|████████▌ | 17/20 [01:30<00:15,  5.04s/it, CE=5.332345e-01 H=5.290020e-01 dV_dx=-5.018358e-05 dV_dθ=-4.182225e-03 ||∇||=3.310181e+00 | Tr=0.9000] 90%|█████████ | 18/20 [01:30<00:09,  4.72s/it, CE=5.332345e-01 H=5.290020e-01 dV_dx=-5.018358e-05 dV_dθ=-4.182225e-03 ||∇||=3.310181e+00 | Tr=0.9000] 90%|█████████ | 18/20 [01:35<00:09,  4.72s/it, CE=5.331010e-01 H=5.269746e-01 dV_dx=-8.984527e-06 dV_dθ=-6.117485e-03 ||∇||=3.703555e+00 | Tr=0.9000] 95%|█████████▌| 19/20 [01:35<00:04,  4.79s/it, CE=5.331010e-01 H=5.269746e-01 dV_dx=-8.984527e-06 dV_dθ=-6.117485e-03 ||∇||=3.703555e+00 | Tr=0.9000] 95%|█████████▌| 19/20 [01:42<00:04,  4.79s/it, CE=5.302025e-01 H=5.251716e-01 dV_dx=5.273217e-05 dV_dθ=-5.083608e-03 ||∇||=3.623800e+00 | Tr=0.9000 Te/Cur=0.9625 Te/Exp=0.7813]100%|██████████| 20/20 [01:45<00:00,  6.43s/it, CE=5.302025e-01 H=5.251716e-01 dV_dx=5.273217e-05 dV_dθ=-5.083608e-03 ||∇||=3.623800e+00 | Tr=0.9000 Te/Cur=0.9625 Te/Exp=0.7813]100%|██████████| 20/20 [01:45<00:00,  5.30s/it, CE=5.302025e-01 H=5.251716e-01 dV_dx=5.273217e-05 dV_dθ=-5.083608e-03 ||∇||=3.623800e+00 | Tr=0.9000 Te/Cur=0.9625 Te/Exp=0.7813]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.59s/it] 50%|█████     | 1/2 [00:22<00:16, 16.59s/it, CE=5.580655e-01 H=5.578416e-01 dV_dx=-4.334653e-05 dV_dθ=-1.806254e-04 ||∇||=8.875725e-01 | Tr=0.9909 Te/Cur=0.9734 Te/Exp=0.7953]100%|██████████| 2/2 [00:22<00:00, 10.43s/it, CE=5.580655e-01 H=5.578416e-01 dV_dx=-4.334653e-05 dV_dθ=-1.806254e-04 ||∇||=8.875725e-01 | Tr=0.9909 Te/Cur=0.9734 Te/Exp=0.7953]100%|██████████| 2/2 [00:22<00:00, 11.35s/it, CE=5.580655e-01 H=5.578416e-01 dV_dx=-4.334653e-05 dV_dθ=-1.806254e-04 ||∇||=8.875725e-01 | Tr=0.9909 Te/Cur=0.9734 Te/Exp=0.7953]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:14, 10.22s/it]  5%|▌         | 1/20 [00:14<03:14, 10.22s/it, CE=5.463693e-01 H=5.460455e-01 dV_dx=1.509137e-05 dV_dθ=-3.388478e-04 ||∇||=9.721680e-01 | Tr=0.9916] 10%|█         | 2/20 [00:14<02:04,  6.89s/it, CE=5.463693e-01 H=5.460455e-01 dV_dx=1.509137e-05 dV_dθ=-3.388478e-04 ||∇||=9.721680e-01 | Tr=0.9916] 10%|█         | 2/20 [00:18<02:04,  6.89s/it, CE=5.397653e-01 H=5.393305e-01 dV_dx=-1.200106e-04 dV_dθ=-3.147953e-04 ||∇||=9.638265e-01 | Tr=0.9920] 15%|█▌        | 3/20 [00:18<01:35,  5.64s/it, CE=5.397653e-01 H=5.393305e-01 dV_dx=-1.200106e-04 dV_dθ=-3.147953e-04 ||∇||=9.638265e-01 | Tr=0.9920] 15%|█▌        | 3/20 [00:23<01:35,  5.64s/it, CE=5.342286e-01 H=5.340069e-01 dV_dx=6.166017e-05 dV_dθ=-2.833422e-04 ||∇||=9.524781e-01 | Tr=0.9925]  20%|██        | 4/20 [00:23<01:24,  5.25s/it, CE=5.342286e-01 H=5.340069e-01 dV_dx=6.166017e-05 dV_dθ=-2.833422e-04 ||∇||=9.524781e-01 | Tr=0.9925] 20%|██        | 4/20 [00:28<01:24,  5.25s/it, CE=5.293588e-01 H=5.290812e-01 dV_dx=-1.041574e-05 dV_dθ=-2.671249e-04 ||∇||=9.495255e-01 | Tr=0.9930] 25%|██▌       | 5/20 [00:28<01:17,  5.15s/it, CE=5.293588e-01 H=5.290812e-01 dV_dx=-1.041574e-05 dV_dθ=-2.671249e-04 ||∇||=9.495255e-01 | Tr=0.9930] 25%|██▌       | 5/20 [00:34<01:17,  5.15s/it, CE=5.250158e-01 H=5.246281e-01 dV_dx=-1.401287e-04 dV_dθ=-2.476022e-04 ||∇||=9.427874e-01 | Tr=0.9933 Te/Cur=0.9757 Te/Exp=0.8006] 30%|███       | 6/20 [00:34<01:17,  5.54s/it, CE=5.250158e-01 H=5.246281e-01 dV_dx=-1.401287e-04 dV_dθ=-2.476022e-04 ||∇||=9.427874e-01 | Tr=0.9933 Te/Cur=0.9757 Te/Exp=0.8006] 30%|███       | 6/20 [00:39<01:17,  5.54s/it, CE=5.211129e-01 H=5.208452e-01 dV_dx=-3.090760e-05 dV_dθ=-2.368605e-04 ||∇||=9.402466e-01 | Tr=0.9934]                             35%|███▌      | 7/20 [00:39<01:07,  5.22s/it, CE=5.211129e-01 H=5.208452e-01 dV_dx=-3.090760e-05 dV_dθ=-2.368605e-04 ||∇||=9.402466e-01 | Tr=0.9934] 35%|███▌      | 7/20 [00:44<01:07,  5.22s/it, CE=5.175862e-01 H=5.173781e-01 dV_dx=2.959745e-05 dV_dθ=-2.376873e-04 ||∇||=9.441478e-01 | Tr=0.9937]  40%|████      | 8/20 [00:44<01:00,  5.06s/it, CE=5.175862e-01 H=5.173781e-01 dV_dx=2.959745e-05 dV_dθ=-2.376873e-04 ||∇||=9.441478e-01 | Tr=0.9937] 40%|████      | 8/20 [00:48<01:00,  5.06s/it, CE=5.140854e-01 H=5.139603e-01 dV_dx=1.071805e-04 dV_dθ=-2.323150e-04 ||∇||=9.448131e-01 | Tr=0.9939] 45%|████▌     | 9/20 [00:48<00:54,  4.91s/it, CE=5.140854e-01 H=5.139603e-01 dV_dx=1.071805e-04 dV_dθ=-2.323150e-04 ||∇||=9.448131e-01 | Tr=0.9939] 45%|████▌     | 9/20 [00:53<00:54,  4.91s/it, CE=5.108153e-01 H=5.105465e-01 dV_dx=-3.540398e-05 dV_dθ=-2.334779e-04 ||∇||=9.473278e-01 | Tr=0.9941] 50%|█████     | 10/20 [00:53<00:48,  4.86s/it, CE=5.108153e-01 H=5.105465e-01 dV_dx=-3.540398e-05 dV_dθ=-2.334779e-04 ||∇||=9.473278e-01 | Tr=0.9941] 50%|█████     | 10/20 [01:00<00:48,  4.86s/it, CE=5.075754e-01 H=5.072753e-01 dV_dx=-7.635936e-05 dV_dθ=-2.237526e-04 ||∇||=9.402668e-01 | Tr=0.9943 Te/Cur=0.9756 Te/Exp=0.7987] 55%|█████▌    | 11/20 [01:00<00:48,  5.44s/it, CE=5.075754e-01 H=5.072753e-01 dV_dx=-7.635936e-05 dV_dθ=-2.237526e-04 ||∇||=9.402668e-01 | Tr=0.9943 Te/Cur=0.9756 Te/Exp=0.7987] 55%|█████▌    | 11/20 [01:05<00:48,  5.44s/it, CE=5.045019e-01 H=5.041920e-01 dV_dx=-8.754818e-05 dV_dθ=-2.223511e-04 ||∇||=9.365446e-01 | Tr=0.9944]                             60%|██████    | 12/20 [01:05<00:42,  5.28s/it, CE=5.045019e-01 H=5.041920e-01 dV_dx=-8.754818e-05 dV_dθ=-2.223511e-04 ||∇||=9.365446e-01 | Tr=0.9944] 60%|██████    | 12/20 [01:09<00:42,  5.28s/it, CE=5.017632e-01 H=5.014625e-01 dV_dx=-7.065213e-05 dV_dθ=-2.301141e-04 ||∇||=9.443170e-01 | Tr=0.9946] 65%|██████▌   | 13/20 [01:09<00:34,  4.96s/it, CE=5.017632e-01 H=5.014625e-01 dV_dx=-7.065213e-05 dV_dθ=-2.301141e-04 ||∇||=9.443170e-01 | Tr=0.9946] 65%|██████▌   | 13/20 [01:14<00:34,  4.96s/it, CE=4.989424e-01 H=4.986993e-01 dV_dx=-1.561436e-05 dV_dθ=-2.274678e-04 ||∇||=9.401743e-01 | Tr=0.9948] 70%|███████   | 14/20 [01:14<00:29,  4.92s/it, CE=4.989424e-01 H=4.986993e-01 dV_dx=-1.561436e-05 dV_dθ=-2.274678e-04 ||∇||=9.401743e-01 | Tr=0.9948] 70%|███████   | 14/20 [01:18<00:29,  4.92s/it, CE=4.963284e-01 H=4.961593e-01 dV_dx=4.764904e-05 dV_dθ=-2.167737e-04 ||∇||=9.393306e-01 | Tr=0.9950]  75%|███████▌  | 15/20 [01:18<00:24,  4.85s/it, CE=4.963284e-01 H=4.961593e-01 dV_dx=4.764904e-05 dV_dθ=-2.167737e-04 ||∇||=9.393306e-01 | Tr=0.9950] 75%|███████▌  | 15/20 [01:25<00:24,  4.85s/it, CE=4.937197e-01 H=4.934921e-01 dV_dx=-2.428899e-05 dV_dθ=-2.032915e-04 ||∇||=9.351183e-01 | Tr=0.9952 Te/Cur=0.9771 Te/Exp=0.8072] 80%|████████  | 16/20 [01:25<00:21,  5.25s/it, CE=4.937197e-01 H=4.934921e-01 dV_dx=-2.428899e-05 dV_dθ=-2.032915e-04 ||∇||=9.351183e-01 | Tr=0.9952 Te/Cur=0.9771 Te/Exp=0.8072] 80%|████████  | 16/20 [01:29<00:21,  5.25s/it, CE=4.912201e-01 H=4.910777e-01 dV_dx=5.686383e-05 dV_dθ=-1.993144e-04 ||∇||=9.302736e-01 | Tr=0.9955]                              85%|████████▌ | 17/20 [01:29<00:14,  4.99s/it, CE=4.912201e-01 H=4.910777e-01 dV_dx=5.686383e-05 dV_dθ=-1.993144e-04 ||∇||=9.302736e-01 | Tr=0.9955] 85%|████████▌ | 17/20 [01:33<00:14,  4.99s/it, CE=4.886945e-01 H=4.884729e-01 dV_dx=-2.877535e-05 dV_dθ=-1.928584e-04 ||∇||=9.273834e-01 | Tr=0.9958] 90%|█████████ | 18/20 [01:33<00:09,  4.79s/it, CE=4.886945e-01 H=4.884729e-01 dV_dx=-2.877535e-05 dV_dθ=-1.928584e-04 ||∇||=9.273834e-01 | Tr=0.9958] 90%|█████████ | 18/20 [01:38<00:09,  4.79s/it, CE=4.864491e-01 H=4.864998e-01 dV_dx=2.506744e-04 dV_dθ=-1.999601e-04 ||∇||=9.330224e-01 | Tr=0.9959]  95%|█████████▌| 19/20 [01:38<00:04,  4.63s/it, CE=4.864491e-01 H=4.864998e-01 dV_dx=2.506744e-04 dV_dθ=-1.999601e-04 ||∇||=9.330224e-01 | Tr=0.9959] 95%|█████████▌| 19/20 [01:44<00:04,  4.63s/it, CE=4.841725e-01 H=4.838700e-01 dV_dx=-1.099903e-04 dV_dθ=-1.925268e-04 ||∇||=9.318774e-01 | Tr=0.9961 Te/Cur=0.9775 Te/Exp=0.8062]100%|██████████| 20/20 [01:44<00:00,  5.33s/it, CE=4.841725e-01 H=4.838700e-01 dV_dx=-1.099903e-04 dV_dθ=-1.925268e-04 ||∇||=9.318774e-01 | Tr=0.9961 Te/Cur=0.9775 Te/Exp=0.8062]100%|██████████| 20/20 [01:44<00:00,  5.25s/it, CE=4.841725e-01 H=4.838700e-01 dV_dx=-1.099903e-04 dV_dθ=-1.925268e-04 ||∇||=9.318774e-01 | Tr=0.9961 Te/Cur=0.9775 Te/Exp=0.8062]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 4 final loss: 0.488946
======================================================================


  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7912
    Task 1: 0.9548
    Task 2: 0.8600
    Task 3: 0.6112
    Task 4: 0.9779

============================================================
Task 5
============================================================
Initial loss on new task: 7.6756, previous: 0.4842, ratio: 15.85
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 5
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:15<?, ?it/s, CE=5.760283e-01 H=5.663963e-01 dV_dx=-2.119421e-05 dV_dθ=-9.610838e-03 ||∇||=3.728915e+00 | Tr=0.6129 Te/Cur=0.7885 Te/Exp=0.8222]100%|██████████| 1/1 [00:15<00:00, 15.04s/it, CE=5.760283e-01 H=5.663963e-01 dV_dx=-2.119421e-05 dV_dθ=-9.610838e-03 ||∇||=3.728915e+00 | Tr=0.6129 Te/Cur=0.7885 Te/Exp=0.8222]100%|██████████| 1/1 [00:15<00:00, 15.04s/it, CE=5.760283e-01 H=5.663963e-01 dV_dx=-2.119421e-05 dV_dθ=-9.610838e-03 ||∇||=3.728915e+00 | Tr=0.6129 Te/Cur=0.7885 Te/Exp=0.8222]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.576028

[STEP 2] Architecture change decision
  Current: 0.576028, Previous: 0.484173
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 39933 samples from 10 classes
  Starting grid architecture search for task 5
  Baseline architecture: (3, [507, 612, 144, 10])
  Baseline loss: 0.576028
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.83s/it] 50%|█████     | 1/2 [00:11<00:08,  8.83s/it, CE=2.268266e+00 H=2.268108e+00 dV_dx=-2.436004e-05 dV_dθ=-1.334756e-04 ||∇||=5.041734e-01 | Tr=0.1927 Te/Cur=0.2025 Te/Exp=0.2311]100%|██████████| 2/2 [00:11<00:00,  5.40s/it, CE=2.268266e+00 H=2.268108e+00 dV_dx=-2.436004e-05 dV_dθ=-1.334756e-04 ||∇||=5.041734e-01 | Tr=0.1927 Te/Cur=0.2025 Te/Exp=0.2311]100%|██████████| 2/2 [00:11<00:00,  5.91s/it, CE=2.268266e+00 H=2.268108e+00 dV_dx=-2.436004e-05 dV_dθ=-1.334756e-04 ||∇||=5.041734e-01 | Tr=0.1927 Te/Cur=0.2025 Te/Exp=0.2311]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2682658870594965
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.52s/it] 50%|█████     | 1/2 [00:16<00:13, 13.52s/it, CE=2.275230e+00 H=2.275159e+00 dV_dx=1.083568e-05 dV_dθ=-8.223491e-05 ||∇||=4.606230e-01 | Tr=0.1258 Te/Cur=0.1164 Te/Exp=0.2303]100%|██████████| 2/2 [00:16<00:00,  7.13s/it, CE=2.275230e+00 H=2.275159e+00 dV_dx=1.083568e-05 dV_dθ=-8.223491e-05 ||∇||=4.606230e-01 | Tr=0.1258 Te/Cur=0.1164 Te/Exp=0.2303]100%|██████████| 2/2 [00:16<00:00,  8.08s/it, CE=2.275230e+00 H=2.275159e+00 dV_dx=1.083568e-05 dV_dθ=-8.223491e-05 ||∇||=4.606230e-01 | Tr=0.1258 Te/Cur=0.1164 Te/Exp=0.2303]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.99s/it] 50%|█████     | 1/2 [00:20<00:16, 16.99s/it, CE=2.282355e+00 H=2.282294e+00 dV_dx=-3.801558e-07 dV_dθ=-6.120612e-05 ||∇||=4.161546e-01 | Tr=0.1328 Te/Cur=0.1241 Te/Exp=0.1698]100%|██████████| 2/2 [00:20<00:00,  9.01s/it, CE=2.282355e+00 H=2.282294e+00 dV_dx=-3.801558e-07 dV_dθ=-6.120612e-05 ||∇||=4.161546e-01 | Tr=0.1328 Te/Cur=0.1241 Te/Exp=0.1698]100%|██████████| 2/2 [00:20<00:00, 10.20s/it, CE=2.282355e+00 H=2.282294e+00 dV_dx=-3.801558e-07 dV_dθ=-6.120612e-05 ||∇||=4.161546e-01 | Tr=0.1328 Te/Cur=0.1241 Te/Exp=0.1698]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.28s/it] 50%|█████     | 1/2 [00:16<00:13, 13.28s/it, CE=2.274224e+00 H=2.274137e+00 dV_dx=-6.241633e-06 dV_dθ=-8.029217e-05 ||∇||=4.329392e-01 | Tr=0.1406 Te/Cur=0.1871 Te/Exp=0.2361]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.274224e+00 H=2.274137e+00 dV_dx=-6.241633e-06 dV_dθ=-8.029217e-05 ||∇||=4.329392e-01 | Tr=0.1406 Te/Cur=0.1871 Te/Exp=0.2361]100%|██████████| 2/2 [00:16<00:00,  8.28s/it, CE=2.274224e+00 H=2.274137e+00 dV_dx=-6.241633e-06 dV_dθ=-8.029217e-05 ||∇||=4.329392e-01 | Tr=0.1406 Te/Cur=0.1871 Te/Exp=0.2361]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.54s/it] 50%|█████     | 1/2 [00:10<00:07,  7.54s/it, CE=2.272055e+00 H=2.272015e+00 dV_dx=9.382304e-06 dV_dθ=-4.952707e-05 ||∇||=4.508034e-01 | Tr=0.0961 Te/Cur=0.0983 Te/Exp=0.2421]100%|██████████| 2/2 [00:10<00:00,  4.77s/it, CE=2.272055e+00 H=2.272015e+00 dV_dx=9.382304e-06 dV_dθ=-4.952707e-05 ||∇||=4.508034e-01 | Tr=0.0961 Te/Cur=0.0983 Te/Exp=0.2421]100%|██████████| 2/2 [00:10<00:00,  5.19s/it, CE=2.272055e+00 H=2.272015e+00 dV_dx=9.382304e-06 dV_dθ=-4.952707e-05 ||∇||=4.508034e-01 | Tr=0.0961 Te/Cur=0.0983 Te/Exp=0.2421]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.24s/it] 50%|█████     | 1/2 [00:16<00:13, 13.24s/it, CE=2.264253e+00 H=2.264203e+00 dV_dx=2.542875e-06 dV_dθ=-5.218467e-05 ||∇||=5.915837e-01 | Tr=0.1275 Te/Cur=0.1396 Te/Exp=0.2674]100%|██████████| 2/2 [00:16<00:00,  7.19s/it, CE=2.264253e+00 H=2.264203e+00 dV_dx=2.542875e-06 dV_dθ=-5.218467e-05 ||∇||=5.915837e-01 | Tr=0.1275 Te/Cur=0.1396 Te/Exp=0.2674]100%|██████████| 2/2 [00:16<00:00,  8.10s/it, CE=2.264253e+00 H=2.264203e+00 dV_dx=2.542875e-06 dV_dθ=-5.218467e-05 ||∇||=5.915837e-01 | Tr=0.1275 Te/Cur=0.1396 Te/Exp=0.2674]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.264253
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.92s/it] 50%|█████     | 1/2 [00:17<00:13, 13.92s/it, CE=2.278435e+00 H=2.278358e+00 dV_dx=1.022752e-05 dV_dθ=-8.722848e-05 ||∇||=4.340614e-01 | Tr=0.1230 Te/Cur=0.1462 Te/Exp=0.1962]100%|██████████| 2/2 [00:17<00:00,  7.64s/it, CE=2.278435e+00 H=2.278358e+00 dV_dx=1.022752e-05 dV_dθ=-8.722848e-05 ||∇||=4.340614e-01 | Tr=0.1230 Te/Cur=0.1462 Te/Exp=0.1962]100%|██████████| 2/2 [00:17<00:00,  8.58s/it, CE=2.278435e+00 H=2.278358e+00 dV_dx=1.022752e-05 dV_dθ=-8.722848e-05 ||∇||=4.340614e-01 | Tr=0.1230 Te/Cur=0.1462 Te/Exp=0.1962]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:17<00:17, 17.04s/it] 50%|█████     | 1/2 [00:19<00:17, 17.04s/it, CE=2.276926e+00 H=2.276793e+00 dV_dx=-1.196691e-05 dV_dθ=-1.217173e-04 ||∇||=5.106549e-01 | Tr=0.1485 Te/Cur=0.1548 Te/Exp=0.1827]100%|██████████| 2/2 [00:19<00:00,  8.39s/it, CE=2.276926e+00 H=2.276793e+00 dV_dx=-1.196691e-05 dV_dθ=-1.217173e-04 ||∇||=5.106549e-01 | Tr=0.1485 Te/Cur=0.1548 Te/Exp=0.1827]100%|██████████| 2/2 [00:19<00:00,  9.69s/it, CE=2.276926e+00 H=2.276793e+00 dV_dx=-1.196691e-05 dV_dθ=-1.217173e-04 ||∇||=5.106549e-01 | Tr=0.1485 Te/Cur=0.1548 Te/Exp=0.1827]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.15s/it] 50%|█████     | 1/2 [00:17<00:14, 14.15s/it, CE=2.280267e+00 H=2.280202e+00 dV_dx=8.101304e-06 dV_dθ=-7.328106e-05 ||∇||=4.453952e-01 | Tr=0.1825 Te/Cur=0.1652 Te/Exp=0.1877]100%|██████████| 2/2 [00:17<00:00,  7.71s/it, CE=2.280267e+00 H=2.280202e+00 dV_dx=8.101304e-06 dV_dθ=-7.328106e-05 ||∇||=4.453952e-01 | Tr=0.1825 Te/Cur=0.1652 Te/Exp=0.1877]100%|██████████| 2/2 [00:17<00:00,  8.68s/it, CE=2.280267e+00 H=2.280202e+00 dV_dx=8.101304e-06 dV_dθ=-7.328106e-05 ||∇||=4.453952e-01 | Tr=0.1825 Te/Cur=0.1652 Te/Exp=0.1877]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.82s/it] 50%|█████     | 1/2 [00:10<00:07,  7.82s/it, CE=2.272524e+00 H=2.272481e+00 dV_dx=-4.830787e-06 dV_dθ=-3.820299e-05 ||∇||=3.382935e-01 | Tr=0.1526 Te/Cur=0.1356 Te/Exp=0.2439]100%|██████████| 2/2 [00:10<00:00,  4.71s/it, CE=2.272524e+00 H=2.272481e+00 dV_dx=-4.830787e-06 dV_dθ=-3.820299e-05 ||∇||=3.382935e-01 | Tr=0.1526 Te/Cur=0.1356 Te/Exp=0.2439]100%|██████████| 2/2 [00:10<00:00,  5.18s/it, CE=2.272524e+00 H=2.272481e+00 dV_dx=-4.830787e-06 dV_dθ=-3.820299e-05 ||∇||=3.382935e-01 | Tr=0.1526 Te/Cur=0.1356 Te/Exp=0.2439]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.98s/it] 50%|█████     | 1/2 [00:16<00:13, 13.98s/it, CE=2.270228e+00 H=2.270173e+00 dV_dx=-2.393269e-05 dV_dθ=-3.092986e-05 ||∇||=3.488103e-01 | Tr=0.1860 Te/Cur=0.1728 Te/Exp=0.2706]100%|██████████| 2/2 [00:16<00:00,  7.43s/it, CE=2.270228e+00 H=2.270173e+00 dV_dx=-2.393269e-05 dV_dθ=-3.092986e-05 ||∇||=3.488103e-01 | Tr=0.1860 Te/Cur=0.1728 Te/Exp=0.2706]100%|██████████| 2/2 [00:16<00:00,  8.41s/it, CE=2.270228e+00 H=2.270173e+00 dV_dx=-2.393269e-05 dV_dθ=-3.092986e-05 ||∇||=3.488103e-01 | Tr=0.1860 Te/Cur=0.1728 Te/Exp=0.2706]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.32s/it] 50%|█████     | 1/2 [00:17<00:14, 14.32s/it, CE=2.270695e+00 H=2.270636e+00 dV_dx=-8.844593e-06 dV_dθ=-4.943716e-05 ||∇||=3.451672e-01 | Tr=0.1521 Te/Cur=0.1580 Te/Exp=0.1937]100%|██████████| 2/2 [00:17<00:00,  7.65s/it, CE=2.270695e+00 H=2.270636e+00 dV_dx=-8.844593e-06 dV_dθ=-4.943716e-05 ||∇||=3.451672e-01 | Tr=0.1521 Te/Cur=0.1580 Te/Exp=0.1937]100%|██████████| 2/2 [00:17<00:00,  8.66s/it, CE=2.270695e+00 H=2.270636e+00 dV_dx=-8.844593e-06 dV_dθ=-4.943716e-05 ||∇||=3.451672e-01 | Tr=0.1521 Te/Cur=0.1580 Te/Exp=0.1937]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:17<00:17, 17.04s/it] 50%|█████     | 1/2 [00:19<00:17, 17.04s/it, CE=2.277719e+00 H=2.277660e+00 dV_dx=1.392684e-05 dV_dθ=-7.276010e-05 ||∇||=3.668213e-01 | Tr=0.1092 Te/Cur=0.1144 Te/Exp=0.2312]100%|██████████| 2/2 [00:19<00:00,  8.52s/it, CE=2.277719e+00 H=2.277660e+00 dV_dx=1.392684e-05 dV_dθ=-7.276010e-05 ||∇||=3.668213e-01 | Tr=0.1092 Te/Cur=0.1144 Te/Exp=0.2312]100%|██████████| 2/2 [00:19<00:00,  9.80s/it, CE=2.277719e+00 H=2.277660e+00 dV_dx=1.392684e-05 dV_dθ=-7.276010e-05 ||∇||=3.668213e-01 | Tr=0.1092 Te/Cur=0.1144 Te/Exp=0.2312]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.57s/it] 50%|█████     | 1/2 [00:10<00:07,  7.57s/it, CE=2.262428e+00 H=2.262434e+00 dV_dx=-8.754837e-07 dV_dθ=7.068158e-06 ||∇||=3.488424e-01 | Tr=0.0939 Te/Cur=0.1267 Te/Exp=0.2431]100%|██████████| 2/2 [00:10<00:00,  4.93s/it, CE=2.262428e+00 H=2.262434e+00 dV_dx=-8.754837e-07 dV_dθ=7.068158e-06 ||∇||=3.488424e-01 | Tr=0.0939 Te/Cur=0.1267 Te/Exp=0.2431]100%|██████████| 2/2 [00:10<00:00,  5.33s/it, CE=2.262428e+00 H=2.262434e+00 dV_dx=-8.754837e-07 dV_dθ=7.068158e-06 ||∇||=3.488424e-01 | Tr=0.0939 Te/Cur=0.1267 Te/Exp=0.2431]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 612, 144, 10]) with loss 2.262428
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.40s/it] 50%|█████     | 1/2 [00:16<00:13, 13.40s/it, CE=2.258535e+00 H=2.258541e+00 dV_dx=5.865473e-06 dV_dθ=1.686745e-07 ||∇||=3.774086e-01 | Tr=0.1366 Te/Cur=0.1443 Te/Exp=0.2218]100%|██████████| 2/2 [00:16<00:00,  7.24s/it, CE=2.258535e+00 H=2.258541e+00 dV_dx=5.865473e-06 dV_dθ=1.686745e-07 ||∇||=3.774086e-01 | Tr=0.1366 Te/Cur=0.1443 Te/Exp=0.2218]100%|██████████| 2/2 [00:16<00:00,  8.16s/it, CE=2.258535e+00 H=2.258541e+00 dV_dx=5.865473e-06 dV_dθ=1.686745e-07 ||∇||=3.774086e-01 | Tr=0.1366 Te/Cur=0.1443 Te/Exp=0.2218]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 632, 144, 10]) with loss 2.258535
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.46s/it] 50%|█████     | 1/2 [00:16<00:13, 13.46s/it, CE=2.275180e+00 H=2.275146e+00 dV_dx=-1.306045e-06 dV_dθ=-3.264917e-05 ||∇||=3.495259e-01 | Tr=0.0993 Te/Cur=0.0899 Te/Exp=0.2725]100%|██████████| 2/2 [00:16<00:00,  7.46s/it, CE=2.275180e+00 H=2.275146e+00 dV_dx=-1.306045e-06 dV_dθ=-3.264917e-05 ||∇||=3.495259e-01 | Tr=0.0993 Te/Cur=0.0899 Te/Exp=0.2725]100%|██████████| 2/2 [00:16<00:00,  8.36s/it, CE=2.275180e+00 H=2.275146e+00 dV_dx=-1.306045e-06 dV_dθ=-3.264917e-05 ||∇||=3.495259e-01 | Tr=0.0993 Te/Cur=0.0899 Te/Exp=0.2725]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.13s/it] 50%|█████     | 1/2 [00:16<00:13, 13.13s/it, CE=2.268250e+00 H=2.268180e+00 dV_dx=-1.075040e-05 dV_dθ=-5.903671e-05 ||∇||=3.654296e-01 | Tr=0.1292 Te/Cur=0.1230 Te/Exp=0.2243]100%|██████████| 2/2 [00:16<00:00,  7.21s/it, CE=2.268250e+00 H=2.268180e+00 dV_dx=-1.075040e-05 dV_dθ=-5.903671e-05 ||∇||=3.654296e-01 | Tr=0.1292 Te/Cur=0.1230 Te/Exp=0.2243]100%|██████████| 2/2 [00:16<00:00,  8.10s/it, CE=2.268250e+00 H=2.268180e+00 dV_dx=-1.075040e-05 dV_dθ=-5.903671e-05 ||∇||=3.654296e-01 | Tr=0.1292 Te/Cur=0.1230 Te/Exp=0.2243]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.76s/it] 50%|█████     | 1/2 [00:15<00:12, 12.76s/it, CE=2.272777e+00 H=2.272743e+00 dV_dx=2.561199e-06 dV_dθ=-3.639568e-05 ||∇||=3.732263e-01 | Tr=0.1336 Te/Cur=0.1759 Te/Exp=0.2167]100%|██████████| 2/2 [00:15<00:00,  6.82s/it, CE=2.272777e+00 H=2.272743e+00 dV_dx=2.561199e-06 dV_dθ=-3.639568e-05 ||∇||=3.732263e-01 | Tr=0.1336 Te/Cur=0.1759 Te/Exp=0.2167]100%|██████████| 2/2 [00:15<00:00,  7.71s/it, CE=2.272777e+00 H=2.272743e+00 dV_dx=2.561199e-06 dV_dθ=-3.639568e-05 ||∇||=3.732263e-01 | Tr=0.1336 Te/Cur=0.1759 Te/Exp=0.2167]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.50s/it] 50%|█████     | 1/2 [00:13<00:11, 11.50s/it, CE=2.283358e+00 H=2.283267e+00 dV_dx=4.891018e-06 dV_dθ=-9.563131e-05 ||∇||=3.538204e-01 | Tr=0.1555 Te/Cur=0.1681 Te/Exp=0.1973]100%|██████████| 2/2 [00:13<00:00,  6.11s/it, CE=2.283358e+00 H=2.283267e+00 dV_dx=4.891018e-06 dV_dθ=-9.563131e-05 ||∇||=3.538204e-01 | Tr=0.1555 Te/Cur=0.1681 Te/Exp=0.1973]100%|██████████| 2/2 [00:13<00:00,  6.92s/it, CE=2.283358e+00 H=2.283267e+00 dV_dx=4.891018e-06 dV_dθ=-9.563131e-05 ||∇||=3.538204e-01 | Tr=0.1555 Te/Cur=0.1681 Te/Exp=0.1973]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.38s/it] 50%|█████     | 1/2 [00:16<00:13, 13.38s/it, CE=2.270548e+00 H=2.270484e+00 dV_dx=-2.178028e-05 dV_dθ=-4.230078e-05 ||∇||=3.217008e-01 | Tr=0.1526 Te/Cur=0.1623 Te/Exp=0.2885]100%|██████████| 2/2 [00:16<00:00,  7.14s/it, CE=2.270548e+00 H=2.270484e+00 dV_dx=-2.178028e-05 dV_dθ=-4.230078e-05 ||∇||=3.217008e-01 | Tr=0.1526 Te/Cur=0.1623 Te/Exp=0.2885]100%|██████████| 2/2 [00:16<00:00,  8.07s/it, CE=2.270548e+00 H=2.270484e+00 dV_dx=-2.178028e-05 dV_dθ=-4.230078e-05 ||∇||=3.217008e-01 | Tr=0.1526 Te/Cur=0.1623 Te/Exp=0.2885]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.89s/it] 50%|█████     | 1/2 [00:16<00:13, 13.89s/it, CE=2.268619e+00 H=2.268538e+00 dV_dx=-2.029319e-06 dV_dθ=-7.878777e-05 ||∇||=3.417474e-01 | Tr=0.0994 Te/Cur=0.1194 Te/Exp=0.2447]100%|██████████| 2/2 [00:16<00:00,  7.42s/it, CE=2.268619e+00 H=2.268538e+00 dV_dx=-2.029319e-06 dV_dθ=-7.878777e-05 ||∇||=3.417474e-01 | Tr=0.0994 Te/Cur=0.1194 Te/Exp=0.2447]100%|██████████| 2/2 [00:16<00:00,  8.39s/it, CE=2.268619e+00 H=2.268538e+00 dV_dx=-2.029319e-06 dV_dθ=-7.878777e-05 ||∇||=3.417474e-01 | Tr=0.0994 Te/Cur=0.1194 Te/Exp=0.2447]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.00s/it] 50%|█████     | 1/2 [00:16<00:13, 13.00s/it, CE=2.266454e+00 H=2.266384e+00 dV_dx=6.409134e-06 dV_dθ=-7.651427e-05 ||∇||=3.419238e-01 | Tr=0.1385 Te/Cur=0.1698 Te/Exp=0.2260]100%|██████████| 2/2 [00:16<00:00,  7.23s/it, CE=2.266454e+00 H=2.266384e+00 dV_dx=6.409134e-06 dV_dθ=-7.651427e-05 ||∇||=3.419238e-01 | Tr=0.1385 Te/Cur=0.1698 Te/Exp=0.2260]100%|██████████| 2/2 [00:16<00:00,  8.09s/it, CE=2.266454e+00 H=2.266384e+00 dV_dx=6.409134e-06 dV_dθ=-7.651427e-05 ||∇||=3.419238e-01 | Tr=0.1385 Te/Cur=0.1698 Te/Exp=0.2260]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.52s/it] 50%|█████     | 1/2 [00:10<00:07,  7.52s/it, CE=2.270230e+00 H=2.270213e+00 dV_dx=4.274419e-05 dV_dθ=-6.008786e-05 ||∇||=2.981045e-01 | Tr=0.1498 Te/Cur=0.1589 Te/Exp=0.2704]100%|██████████| 2/2 [00:10<00:00,  4.75s/it, CE=2.270230e+00 H=2.270213e+00 dV_dx=4.274419e-05 dV_dθ=-6.008786e-05 ||∇||=2.981045e-01 | Tr=0.1498 Te/Cur=0.1589 Te/Exp=0.2704]100%|██████████| 2/2 [00:10<00:00,  5.17s/it, CE=2.270230e+00 H=2.270213e+00 dV_dx=4.274419e-05 dV_dθ=-6.008786e-05 ||∇||=2.981045e-01 | Tr=0.1498 Te/Cur=0.1589 Te/Exp=0.2704]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.13s/it] 50%|█████     | 1/2 [00:18<00:13, 13.13s/it, CE=2.263897e+00 H=2.263865e+00 dV_dx=2.480904e-05 dV_dθ=-5.591485e-05 ||∇||=3.403399e-01 | Tr=0.1113 Te/Cur=0.1402 Te/Exp=0.2401]100%|██████████| 2/2 [00:18<00:00,  8.79s/it, CE=2.263897e+00 H=2.263865e+00 dV_dx=2.480904e-05 dV_dθ=-5.591485e-05 ||∇||=3.403399e-01 | Tr=0.1113 Te/Cur=0.1402 Te/Exp=0.2401]100%|██████████| 2/2 [00:18<00:00,  9.44s/it, CE=2.263897e+00 H=2.263865e+00 dV_dx=2.480904e-05 dV_dθ=-5.591485e-05 ||∇||=3.403399e-01 | Tr=0.1113 Te/Cur=0.1402 Te/Exp=0.2401]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.61s/it] 50%|█████     | 1/2 [00:16<00:13, 13.61s/it, CE=2.257297e+00 H=2.257252e+00 dV_dx=-1.222540e-05 dV_dθ=-3.292222e-05 ||∇||=3.290896e-01 | Tr=0.1305 Te/Cur=0.1841 Te/Exp=0.2606]100%|██████████| 2/2 [00:16<00:00,  7.13s/it, CE=2.257297e+00 H=2.257252e+00 dV_dx=-1.222540e-05 dV_dθ=-3.292222e-05 ||∇||=3.290896e-01 | Tr=0.1305 Te/Cur=0.1841 Te/Exp=0.2606]100%|██████████| 2/2 [00:16<00:00,  8.10s/it, CE=2.257297e+00 H=2.257252e+00 dV_dx=-1.222540e-05 dV_dθ=-3.292222e-05 ||∇||=3.290896e-01 | Tr=0.1305 Te/Cur=0.1841 Te/Exp=0.2606]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 592, 164, 10]) with loss 2.257297
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.02s/it] 50%|█████     | 1/2 [00:17<00:14, 14.02s/it, CE=2.266407e+00 H=2.266345e+00 dV_dx=-2.317649e-06 dV_dθ=-6.059650e-05 ||∇||=3.172333e-01 | Tr=0.1031 Te/Cur=0.1034 Te/Exp=0.2291]100%|██████████| 2/2 [00:17<00:00,  7.53s/it, CE=2.266407e+00 H=2.266345e+00 dV_dx=-2.317649e-06 dV_dθ=-6.059650e-05 ||∇||=3.172333e-01 | Tr=0.1031 Te/Cur=0.1034 Te/Exp=0.2291]100%|██████████| 2/2 [00:17<00:00,  8.51s/it, CE=2.266407e+00 H=2.266345e+00 dV_dx=-2.317649e-06 dV_dθ=-6.059650e-05 ||∇||=3.172333e-01 | Tr=0.1031 Te/Cur=0.1034 Te/Exp=0.2291]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.90s/it] 50%|█████     | 1/2 [00:16<00:13, 13.90s/it, CE=2.278001e+00 H=2.277938e+00 dV_dx=1.022726e-06 dV_dθ=-6.392705e-05 ||∇||=3.439447e-01 | Tr=0.0925 Te/Cur=0.1049 Te/Exp=0.1760]100%|██████████| 2/2 [00:16<00:00,  7.47s/it, CE=2.278001e+00 H=2.277938e+00 dV_dx=1.022726e-06 dV_dθ=-6.392705e-05 ||∇||=3.439447e-01 | Tr=0.0925 Te/Cur=0.1049 Te/Exp=0.1760]100%|██████████| 2/2 [00:16<00:00,  8.43s/it, CE=2.278001e+00 H=2.277938e+00 dV_dx=1.022726e-06 dV_dθ=-6.392705e-05 ||∇||=3.439447e-01 | Tr=0.0925 Te/Cur=0.1049 Te/Exp=0.1760]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.66s/it] 50%|█████     | 1/2 [00:10<00:07,  7.66s/it, CE=2.225824e+00 H=2.225741e+00 dV_dx=-1.777919e-07 dV_dθ=-8.315103e-05 ||∇||=5.172738e-01 | Tr=0.1154 Te/Cur=0.1347 Te/Exp=0.3032]100%|██████████| 2/2 [00:10<00:00,  4.95s/it, CE=2.225824e+00 H=2.225741e+00 dV_dx=-1.777919e-07 dV_dθ=-8.315103e-05 ||∇||=5.172738e-01 | Tr=0.1154 Te/Cur=0.1347 Te/Exp=0.3032]100%|██████████| 2/2 [00:10<00:00,  5.36s/it, CE=2.225824e+00 H=2.225741e+00 dV_dx=-1.777919e-07 dV_dθ=-8.315103e-05 ||∇||=5.172738e-01 | Tr=0.1154 Te/Cur=0.1347 Te/Exp=0.3032]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.225824131477093
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.41s/it] 50%|█████     | 1/2 [00:08<00:05,  5.41s/it, CE=2.252060e+00 H=2.252046e+00 dV_dx=6.774458e-07 dV_dθ=-1.491678e-05 ||∇||=4.865202e-01 | Tr=0.0857 Te/Cur=0.0994 Te/Exp=0.2227]100%|██████████| 2/2 [00:08<00:00,  3.94s/it, CE=2.252060e+00 H=2.252046e+00 dV_dx=6.774458e-07 dV_dθ=-1.491678e-05 ||∇||=4.865202e-01 | Tr=0.0857 Te/Cur=0.0994 Te/Exp=0.2227]100%|██████████| 2/2 [00:08<00:00,  4.16s/it, CE=2.252060e+00 H=2.252046e+00 dV_dx=6.774458e-07 dV_dθ=-1.491678e-05 ||∇||=4.865202e-01 | Tr=0.0857 Te/Cur=0.0994 Te/Exp=0.2227]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.29s/it] 50%|█████     | 1/2 [00:11<00:05,  5.29s/it, CE=2.229997e+00 H=2.229930e+00 dV_dx=-1.697118e-05 dV_dθ=-4.929576e-05 ||∇||=5.133108e-01 | Tr=0.1133 Te/Cur=0.1391 Te/Exp=0.2909]100%|██████████| 2/2 [00:11<00:00,  5.68s/it, CE=2.229997e+00 H=2.229930e+00 dV_dx=-1.697118e-05 dV_dθ=-4.929576e-05 ||∇||=5.133108e-01 | Tr=0.1133 Te/Cur=0.1391 Te/Exp=0.2909]100%|██████████| 2/2 [00:11<00:00,  5.62s/it, CE=2.229997e+00 H=2.229930e+00 dV_dx=-1.697118e-05 dV_dθ=-4.929576e-05 ||∇||=5.133108e-01 | Tr=0.1133 Te/Cur=0.1391 Te/Exp=0.2909]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.63s/it] 50%|█████     | 1/2 [00:16<00:13, 13.63s/it, CE=2.228055e+00 H=2.228001e+00 dV_dx=1.515502e-05 dV_dθ=-6.817776e-05 ||∇||=5.129999e-01 | Tr=0.1772 Te/Cur=0.1977 Te/Exp=0.3061]100%|██████████| 2/2 [00:16<00:00,  7.30s/it, CE=2.228055e+00 H=2.228001e+00 dV_dx=1.515502e-05 dV_dθ=-6.817776e-05 ||∇||=5.129999e-01 | Tr=0.1772 Te/Cur=0.1977 Te/Exp=0.3061]100%|██████████| 2/2 [00:16<00:00,  8.25s/it, CE=2.228055e+00 H=2.228001e+00 dV_dx=1.515502e-05 dV_dθ=-6.817776e-05 ||∇||=5.129999e-01 | Tr=0.1772 Te/Cur=0.1977 Te/Exp=0.3061]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.13s/it] 50%|█████     | 1/2 [00:08<00:05,  5.13s/it, CE=2.227696e+00 H=2.227643e+00 dV_dx=-1.305631e-05 dV_dθ=-3.993350e-05 ||∇||=5.779995e-01 | Tr=0.0826 Te/Cur=0.0978 Te/Exp=0.3258]100%|██████████| 2/2 [00:08<00:00,  3.86s/it, CE=2.227696e+00 H=2.227643e+00 dV_dx=-1.305631e-05 dV_dθ=-3.993350e-05 ||∇||=5.779995e-01 | Tr=0.0826 Te/Cur=0.0978 Te/Exp=0.3258]100%|██████████| 2/2 [00:08<00:00,  4.05s/it, CE=2.227696e+00 H=2.227643e+00 dV_dx=-1.305631e-05 dV_dθ=-3.993350e-05 ||∇||=5.779995e-01 | Tr=0.0826 Te/Cur=0.0978 Te/Exp=0.3258]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.01s/it] 50%|█████     | 1/2 [00:07<00:05,  5.01s/it, CE=2.238271e+00 H=2.238209e+00 dV_dx=-1.539544e-06 dV_dθ=-6.023649e-05 ||∇||=5.024947e-01 | Tr=0.1457 Te/Cur=0.1483 Te/Exp=0.2986]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.238271e+00 H=2.238209e+00 dV_dx=-1.539544e-06 dV_dθ=-6.023649e-05 ||∇||=5.024947e-01 | Tr=0.1457 Te/Cur=0.1483 Te/Exp=0.2986]100%|██████████| 2/2 [00:07<00:00,  3.75s/it, CE=2.238271e+00 H=2.238209e+00 dV_dx=-1.539544e-06 dV_dθ=-6.023649e-05 ||∇||=5.024947e-01 | Tr=0.1457 Te/Cur=0.1483 Te/Exp=0.2986]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.08s/it] 50%|█████     | 1/2 [00:17<00:14, 14.08s/it, CE=2.208636e+00 H=2.208572e+00 dV_dx=5.034395e-06 dV_dθ=-6.877763e-05 ||∇||=5.042695e-01 | Tr=0.0791 Te/Cur=0.0847 Te/Exp=0.3362]100%|██████████| 2/2 [00:17<00:00,  7.63s/it, CE=2.208636e+00 H=2.208572e+00 dV_dx=5.034395e-06 dV_dθ=-6.877763e-05 ||∇||=5.042695e-01 | Tr=0.0791 Te/Cur=0.0847 Te/Exp=0.3362]100%|██████████| 2/2 [00:17<00:00,  8.60s/it, CE=2.208636e+00 H=2.208572e+00 dV_dx=5.034395e-06 dV_dθ=-6.877763e-05 ||∇||=5.042695e-01 | Tr=0.0791 Te/Cur=0.0847 Te/Exp=0.3362]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 204, 10]) with loss 2.208636
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.05s/it] 50%|█████     | 1/2 [00:17<00:14, 14.05s/it, CE=2.224587e+00 H=2.224528e+00 dV_dx=-3.967492e-06 dV_dθ=-5.547968e-05 ||∇||=5.303987e-01 | Tr=0.1164 Te/Cur=0.1310 Te/Exp=0.3229]100%|██████████| 2/2 [00:17<00:00,  7.59s/it, CE=2.224587e+00 H=2.224528e+00 dV_dx=-3.967492e-06 dV_dθ=-5.547968e-05 ||∇||=5.303987e-01 | Tr=0.1164 Te/Cur=0.1310 Te/Exp=0.3229]100%|██████████| 2/2 [00:17<00:00,  8.56s/it, CE=2.224587e+00 H=2.224528e+00 dV_dx=-3.967492e-06 dV_dθ=-5.547968e-05 ||∇||=5.303987e-01 | Tr=0.1164 Te/Cur=0.1310 Te/Exp=0.3229]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:17<00:17, 17.42s/it] 50%|█████     | 1/2 [00:20<00:17, 17.42s/it, CE=2.215669e+00 H=2.215605e+00 dV_dx=-5.816871e-06 dV_dθ=-5.828244e-05 ||∇||=5.162633e-01 | Tr=0.1645 Te/Cur=0.1540 Te/Exp=0.3187]100%|██████████| 2/2 [00:20<00:00,  8.96s/it, CE=2.215669e+00 H=2.215605e+00 dV_dx=-5.816871e-06 dV_dθ=-5.828244e-05 ||∇||=5.162633e-01 | Tr=0.1645 Te/Cur=0.1540 Te/Exp=0.3187]100%|██████████| 2/2 [00:20<00:00, 10.23s/it, CE=2.215669e+00 H=2.215605e+00 dV_dx=-5.816871e-06 dV_dθ=-5.828244e-05 ||∇||=5.162633e-01 | Tr=0.1645 Te/Cur=0.1540 Te/Exp=0.3187]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.81s/it] 50%|█████     | 1/2 [00:10<00:07,  7.81s/it, CE=2.280145e+00 H=2.280078e+00 dV_dx=5.363693e-06 dV_dθ=-7.272821e-05 ||∇||=3.619938e-01 | Tr=0.1274 Te/Cur=0.1415 Te/Exp=0.1814]100%|██████████| 2/2 [00:10<00:00,  4.92s/it, CE=2.280145e+00 H=2.280078e+00 dV_dx=5.363693e-06 dV_dθ=-7.272821e-05 ||∇||=3.619938e-01 | Tr=0.1274 Te/Cur=0.1415 Te/Exp=0.1814]100%|██████████| 2/2 [00:10<00:00,  5.35s/it, CE=2.280145e+00 H=2.280078e+00 dV_dx=5.363693e-06 dV_dθ=-7.272821e-05 ||∇||=3.619938e-01 | Tr=0.1274 Te/Cur=0.1415 Te/Exp=0.1814]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.54s/it] 50%|█████     | 1/2 [00:08<00:05,  5.54s/it, CE=2.279544e+00 H=2.279501e+00 dV_dx=1.284593e-05 dV_dθ=-5.569590e-05 ||∇||=3.612092e-01 | Tr=0.0890 Te/Cur=0.1003 Te/Exp=0.1634]100%|██████████| 2/2 [00:08<00:00,  3.92s/it, CE=2.279544e+00 H=2.279501e+00 dV_dx=1.284593e-05 dV_dθ=-5.569590e-05 ||∇||=3.612092e-01 | Tr=0.0890 Te/Cur=0.1003 Te/Exp=0.1634]100%|██████████| 2/2 [00:08<00:00,  4.16s/it, CE=2.279544e+00 H=2.279501e+00 dV_dx=1.284593e-05 dV_dθ=-5.569590e-05 ||∇||=3.612092e-01 | Tr=0.0890 Te/Cur=0.1003 Te/Exp=0.1634]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.75s/it] 50%|█████     | 1/2 [00:07<00:04,  4.75s/it, CE=2.279602e+00 H=2.279533e+00 dV_dx=-2.179775e-06 dV_dθ=-6.653118e-05 ||∇||=3.601899e-01 | Tr=0.1270 Te/Cur=0.1277 Te/Exp=0.1960]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.279602e+00 H=2.279533e+00 dV_dx=-2.179775e-06 dV_dθ=-6.653118e-05 ||∇||=3.601899e-01 | Tr=0.1270 Te/Cur=0.1277 Te/Exp=0.1960]100%|██████████| 2/2 [00:07<00:00,  3.84s/it, CE=2.279602e+00 H=2.279533e+00 dV_dx=-2.179775e-06 dV_dθ=-6.653118e-05 ||∇||=3.601899e-01 | Tr=0.1270 Te/Cur=0.1277 Te/Exp=0.1960]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.75s/it] 50%|█████     | 1/2 [00:16<00:13, 13.75s/it, CE=2.277207e+00 H=2.277153e+00 dV_dx=1.298527e-05 dV_dθ=-6.643431e-05 ||∇||=3.649448e-01 | Tr=0.1042 Te/Cur=0.1091 Te/Exp=0.1906]100%|██████████| 2/2 [00:16<00:00,  7.28s/it, CE=2.277207e+00 H=2.277153e+00 dV_dx=1.298527e-05 dV_dθ=-6.643431e-05 ||∇||=3.649448e-01 | Tr=0.1042 Te/Cur=0.1091 Te/Exp=0.1906]100%|██████████| 2/2 [00:16<00:00,  8.25s/it, CE=2.277207e+00 H=2.277153e+00 dV_dx=1.298527e-05 dV_dθ=-6.643431e-05 ||∇||=3.649448e-01 | Tr=0.1042 Te/Cur=0.1091 Te/Exp=0.1906]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.02s/it] 50%|█████     | 1/2 [00:07<00:05,  5.02s/it, CE=2.280202e+00 H=2.280106e+00 dV_dx=-1.294222e-05 dV_dθ=-8.281659e-05 ||∇||=3.707877e-01 | Tr=0.1339 Te/Cur=0.1330 Te/Exp=0.1562]100%|██████████| 2/2 [00:07<00:00,  3.82s/it, CE=2.280202e+00 H=2.280106e+00 dV_dx=-1.294222e-05 dV_dθ=-8.281659e-05 ||∇||=3.707877e-01 | Tr=0.1339 Te/Cur=0.1330 Te/Exp=0.1562]100%|██████████| 2/2 [00:07<00:00,  4.00s/it, CE=2.280202e+00 H=2.280106e+00 dV_dx=-1.294222e-05 dV_dθ=-8.281659e-05 ||∇||=3.707877e-01 | Tr=0.1339 Te/Cur=0.1330 Te/Exp=0.1562]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.80s/it] 50%|█████     | 1/2 [00:07<00:04,  4.80s/it, CE=2.285607e+00 H=2.285515e+00 dV_dx=-3.633825e-07 dV_dθ=-9.106711e-05 ||∇||=3.860387e-01 | Tr=0.1347 Te/Cur=0.1479 Te/Exp=0.1830]100%|██████████| 2/2 [00:07<00:00,  3.51s/it, CE=2.285607e+00 H=2.285515e+00 dV_dx=-3.633825e-07 dV_dθ=-9.106711e-05 ||∇||=3.860387e-01 | Tr=0.1347 Te/Cur=0.1479 Te/Exp=0.1830]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.285607e+00 H=2.285515e+00 dV_dx=-3.633825e-07 dV_dθ=-9.106711e-05 ||∇||=3.860387e-01 | Tr=0.1347 Te/Cur=0.1479 Te/Exp=0.1830]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.80s/it] 50%|█████     | 1/2 [00:19<00:16, 16.80s/it, CE=2.265580e+00 H=2.265553e+00 dV_dx=7.593032e-06 dV_dθ=-3.470673e-05 ||∇||=3.564776e-01 | Tr=0.1311 Te/Cur=0.1298 Te/Exp=0.2160]100%|██████████| 2/2 [00:19<00:00,  8.44s/it, CE=2.265580e+00 H=2.265553e+00 dV_dx=7.593032e-06 dV_dθ=-3.470673e-05 ||∇||=3.564776e-01 | Tr=0.1311 Te/Cur=0.1298 Te/Exp=0.2160]100%|██████████| 2/2 [00:19<00:00,  9.69s/it, CE=2.265580e+00 H=2.265553e+00 dV_dx=7.593032e-06 dV_dθ=-3.470673e-05 ||∇||=3.564776e-01 | Tr=0.1311 Te/Cur=0.1298 Te/Exp=0.2160]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.57s/it] 50%|█████     | 1/2 [00:16<00:13, 13.57s/it, CE=2.281836e+00 H=2.281753e+00 dV_dx=-9.183933e-06 dV_dθ=-7.353205e-05 ||∇||=3.538554e-01 | Tr=0.1320 Te/Cur=0.1720 Te/Exp=0.2115]100%|██████████| 2/2 [00:16<00:00,  7.17s/it, CE=2.281836e+00 H=2.281753e+00 dV_dx=-9.183933e-06 dV_dθ=-7.353205e-05 ||∇||=3.538554e-01 | Tr=0.1320 Te/Cur=0.1720 Te/Exp=0.2115]100%|██████████| 2/2 [00:16<00:00,  8.13s/it, CE=2.281836e+00 H=2.281753e+00 dV_dx=-9.183933e-06 dV_dθ=-7.353205e-05 ||∇||=3.538554e-01 | Tr=0.1320 Te/Cur=0.1720 Te/Exp=0.2115]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.78s/it] 50%|█████     | 1/2 [00:16<00:13, 13.78s/it, CE=2.272209e+00 H=2.272186e+00 dV_dx=5.808545e-06 dV_dθ=-2.881233e-05 ||∇||=3.230269e-01 | Tr=0.0940 Te/Cur=0.1002 Te/Exp=0.2761]100%|██████████| 2/2 [00:16<00:00,  7.36s/it, CE=2.272209e+00 H=2.272186e+00 dV_dx=5.808545e-06 dV_dθ=-2.881233e-05 ||∇||=3.230269e-01 | Tr=0.0940 Te/Cur=0.1002 Te/Exp=0.2761]100%|██████████| 2/2 [00:16<00:00,  8.32s/it, CE=2.272209e+00 H=2.272186e+00 dV_dx=5.808545e-06 dV_dθ=-2.881233e-05 ||∇||=3.230269e-01 | Tr=0.0940 Te/Cur=0.1002 Te/Exp=0.2761]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.77s/it] 50%|█████     | 1/2 [00:10<00:07,  7.77s/it, CE=2.281451e+00 H=2.281367e+00 dV_dx=1.705897e-05 dV_dθ=-1.007126e-04 ||∇||=4.268941e-01 | Tr=0.1263 Te/Cur=0.1295 Te/Exp=0.2178]100%|██████████| 2/2 [00:10<00:00,  4.94s/it, CE=2.281451e+00 H=2.281367e+00 dV_dx=1.705897e-05 dV_dθ=-1.007126e-04 ||∇||=4.268941e-01 | Tr=0.1263 Te/Cur=0.1295 Te/Exp=0.2178]100%|██████████| 2/2 [00:10<00:00,  5.36s/it, CE=2.281451e+00 H=2.281367e+00 dV_dx=1.705897e-05 dV_dθ=-1.007126e-04 ||∇||=4.268941e-01 | Tr=0.1263 Te/Cur=0.1295 Te/Exp=0.2178]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.08s/it] 50%|█████     | 1/2 [00:08<00:05,  5.08s/it, CE=2.274951e+00 H=2.274920e+00 dV_dx=1.415135e-05 dV_dθ=-4.465620e-05 ||∇||=4.355341e-01 | Tr=0.1055 Te/Cur=0.1171 Te/Exp=0.2004]100%|██████████| 2/2 [00:08<00:00,  3.97s/it, CE=2.274951e+00 H=2.274920e+00 dV_dx=1.415135e-05 dV_dθ=-4.465620e-05 ||∇||=4.355341e-01 | Tr=0.1055 Te/Cur=0.1171 Te/Exp=0.2004]100%|██████████| 2/2 [00:08<00:00,  4.13s/it, CE=2.274951e+00 H=2.274920e+00 dV_dx=1.415135e-05 dV_dθ=-4.465620e-05 ||∇||=4.355341e-01 | Tr=0.1055 Te/Cur=0.1171 Te/Exp=0.2004]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.24s/it] 50%|█████     | 1/2 [00:07<00:05,  5.24s/it, CE=2.261037e+00 H=2.261030e+00 dV_dx=7.721419e-06 dV_dθ=-1.480813e-05 ||∇||=4.064009e-01 | Tr=0.1008 Te/Cur=0.1057 Te/Exp=0.2013]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.261037e+00 H=2.261030e+00 dV_dx=7.721419e-06 dV_dθ=-1.480813e-05 ||∇||=4.064009e-01 | Tr=0.1008 Te/Cur=0.1057 Te/Exp=0.2013]100%|██████████| 2/2 [00:07<00:00,  3.97s/it, CE=2.261037e+00 H=2.261030e+00 dV_dx=7.721419e-06 dV_dθ=-1.480813e-05 ||∇||=4.064009e-01 | Tr=0.1008 Te/Cur=0.1057 Te/Exp=0.2013]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.82s/it] 50%|█████     | 1/2 [00:19<00:16, 16.82s/it, CE=2.272629e+00 H=2.272551e+00 dV_dx=-1.228596e-05 dV_dθ=-6.537728e-05 ||∇||=4.257968e-01 | Tr=0.0894 Te/Cur=0.1288 Te/Exp=0.2151]100%|██████████| 2/2 [00:19<00:00,  8.51s/it, CE=2.272629e+00 H=2.272551e+00 dV_dx=-1.228596e-05 dV_dθ=-6.537728e-05 ||∇||=4.257968e-01 | Tr=0.0894 Te/Cur=0.1288 Te/Exp=0.2151]100%|██████████| 2/2 [00:19<00:00,  9.75s/it, CE=2.272629e+00 H=2.272551e+00 dV_dx=-1.228596e-05 dV_dθ=-6.537728e-05 ||∇||=4.257968e-01 | Tr=0.0894 Te/Cur=0.1288 Te/Exp=0.2151]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.98s/it] 50%|█████     | 1/2 [00:08<00:04,  4.98s/it, CE=2.261985e+00 H=2.261946e+00 dV_dx=1.087732e-05 dV_dθ=-4.958815e-05 ||∇||=4.075735e-01 | Tr=0.1311 Te/Cur=0.1490 Te/Exp=0.2231]100%|██████████| 2/2 [00:08<00:00,  3.86s/it, CE=2.261985e+00 H=2.261946e+00 dV_dx=1.087732e-05 dV_dθ=-4.958815e-05 ||∇||=4.075735e-01 | Tr=0.1311 Te/Cur=0.1490 Te/Exp=0.2231]100%|██████████| 2/2 [00:08<00:00,  4.03s/it, CE=2.261985e+00 H=2.261946e+00 dV_dx=1.087732e-05 dV_dθ=-4.958815e-05 ||∇||=4.075735e-01 | Tr=0.1311 Te/Cur=0.1490 Te/Exp=0.2231]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.80s/it] 50%|█████     | 1/2 [00:07<00:04,  4.80s/it, CE=2.265197e+00 H=2.265122e+00 dV_dx=-1.316030e-06 dV_dθ=-7.381274e-05 ||∇||=4.175307e-01 | Tr=0.1041 Te/Cur=0.1101 Te/Exp=0.2024]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.265197e+00 H=2.265122e+00 dV_dx=-1.316030e-06 dV_dθ=-7.381274e-05 ||∇||=4.175307e-01 | Tr=0.1041 Te/Cur=0.1101 Te/Exp=0.2024]100%|██████████| 2/2 [00:07<00:00,  3.81s/it, CE=2.265197e+00 H=2.265122e+00 dV_dx=-1.316030e-06 dV_dθ=-7.381274e-05 ||∇||=4.175307e-01 | Tr=0.1041 Te/Cur=0.1101 Te/Exp=0.2024]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.56s/it] 50%|█████     | 1/2 [00:16<00:13, 13.56s/it, CE=2.252713e+00 H=2.252689e+00 dV_dx=-7.718753e-06 dV_dθ=-1.646275e-05 ||∇||=4.111695e-01 | Tr=0.1175 Te/Cur=0.1145 Te/Exp=0.2736]100%|██████████| 2/2 [00:16<00:00,  7.33s/it, CE=2.252713e+00 H=2.252689e+00 dV_dx=-7.718753e-06 dV_dθ=-1.646275e-05 ||∇||=4.111695e-01 | Tr=0.1175 Te/Cur=0.1145 Te/Exp=0.2736]100%|██████████| 2/2 [00:16<00:00,  8.26s/it, CE=2.252713e+00 H=2.252689e+00 dV_dx=-7.718753e-06 dV_dθ=-1.646275e-05 ||∇||=4.111695e-01 | Tr=0.1175 Te/Cur=0.1145 Te/Exp=0.2736]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.44s/it] 50%|█████     | 1/2 [00:16<00:13, 13.44s/it, CE=2.252772e+00 H=2.252768e+00 dV_dx=8.666862e-06 dV_dθ=-1.274358e-05 ||∇||=3.880225e-01 | Tr=0.1370 Te/Cur=0.1327 Te/Exp=0.2688]100%|██████████| 2/2 [00:16<00:00,  7.24s/it, CE=2.252772e+00 H=2.252768e+00 dV_dx=8.666862e-06 dV_dθ=-1.274358e-05 ||∇||=3.880225e-01 | Tr=0.1370 Te/Cur=0.1327 Te/Exp=0.2688]100%|██████████| 2/2 [00:16<00:00,  8.17s/it, CE=2.252772e+00 H=2.252768e+00 dV_dx=8.666862e-06 dV_dθ=-1.274358e-05 ||∇||=3.880225e-01 | Tr=0.1370 Te/Cur=0.1327 Te/Exp=0.2688]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.68s/it] 50%|█████     | 1/2 [00:16<00:13, 13.68s/it, CE=2.253745e+00 H=2.253748e+00 dV_dx=2.921570e-06 dV_dθ=-6.389272e-07 ||∇||=4.034057e-01 | Tr=0.1040 Te/Cur=0.0947 Te/Exp=0.3055]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.253745e+00 H=2.253748e+00 dV_dx=2.921570e-06 dV_dθ=-6.389272e-07 ||∇||=4.034057e-01 | Tr=0.1040 Te/Cur=0.0947 Te/Exp=0.3055]100%|██████████| 2/2 [00:16<00:00,  8.25s/it, CE=2.253745e+00 H=2.253748e+00 dV_dx=2.921570e-06 dV_dθ=-6.389272e-07 ||∇||=4.034057e-01 | Tr=0.1040 Te/Cur=0.0947 Te/Exp=0.3055]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 552, 204, 10]) with loss 2.208636
  Total candidates evaluated: 54
  Original: (3, [507, 612, 144, 10])
  Optimal: (2, [507, 552, 204, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 3→2, feed [507, 612, 144, 10]→[507, 552, 204, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 3)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:23<07:22, 23.30s/it]  5%|▌         | 1/20 [00:27<07:22, 23.30s/it, CE=1.760195e+00 H=1.750266e+00 dV_dx=-3.745170e-06 dV_dθ=-9.926044e-03 ||∇||=4.622367e+00 | Tr=0.7890] 10%|█         | 2/20 [00:27<03:37, 12.10s/it, CE=1.760195e+00 H=1.750266e+00 dV_dx=-3.745170e-06 dV_dθ=-9.926044e-03 ||∇||=4.622367e+00 | Tr=0.7890] 10%|█         | 2/20 [00:32<03:37, 12.10s/it, CE=1.527057e+00 H=1.519461e+00 dV_dx=-6.908889e-07 dV_dθ=-7.595712e-03 ||∇||=4.213754e+00 | Tr=0.7890] 15%|█▌        | 3/20 [00:32<02:29,  8.77s/it, CE=1.527057e+00 H=1.519461e+00 dV_dx=-6.908889e-07 dV_dθ=-7.595712e-03 ||∇||=4.213754e+00 | Tr=0.7890] 15%|█▌        | 3/20 [00:37<02:29,  8.77s/it, CE=1.356970e+00 H=1.344658e+00 dV_dx=-1.038538e-05 dV_dθ=-1.230168e-02 ||∇||=4.711738e+00 | Tr=0.7890] 20%|██        | 4/20 [00:37<01:56,  7.26s/it, CE=1.356970e+00 H=1.344658e+00 dV_dx=-1.038538e-05 dV_dθ=-1.230168e-02 ||∇||=4.711738e+00 | Tr=0.7890] 20%|██        | 4/20 [00:42<01:56,  7.26s/it, CE=1.238027e+00 H=1.222874e+00 dV_dx=-3.315855e-05 dV_dθ=-1.512010e-02 ||∇||=4.979852e+00 | Tr=0.7890] 25%|██▌       | 5/20 [00:42<01:38,  6.59s/it, CE=1.238027e+00 H=1.222874e+00 dV_dx=-3.315855e-05 dV_dθ=-1.512010e-02 ||∇||=4.979852e+00 | Tr=0.7890] 25%|██▌       | 5/20 [00:47<01:38,  6.59s/it, CE=1.149049e+00 H=1.140352e+00 dV_dx=3.817253e-05 dV_dθ=-8.735282e-03 ||∇||=4.508472e+00 | Tr=0.7890]  30%|███       | 6/20 [00:47<01:25,  6.13s/it, CE=1.149049e+00 H=1.140352e+00 dV_dx=3.817253e-05 dV_dθ=-8.735282e-03 ||∇||=4.508472e+00 | Tr=0.7890] 30%|███       | 6/20 [00:52<01:25,  6.13s/it, CE=1.082149e+00 H=1.077127e+00 dV_dx=-4.893814e-05 dV_dθ=-4.972974e-03 ||∇||=4.284203e+00 | Tr=0.7890] 35%|███▌      | 7/20 [00:52<01:13,  5.63s/it, CE=1.082149e+00 H=1.077127e+00 dV_dx=-4.893814e-05 dV_dθ=-4.972974e-03 ||∇||=4.284203e+00 | Tr=0.7890] 35%|███▌      | 7/20 [00:57<01:13,  5.63s/it, CE=1.027082e+00 H=1.022143e+00 dV_dx=2.838006e-05 dV_dθ=-4.967580e-03 ||∇||=4.399007e+00 | Tr=0.7890]  40%|████      | 8/20 [00:57<01:04,  5.40s/it, CE=1.027082e+00 H=1.022143e+00 dV_dx=2.838006e-05 dV_dθ=-4.967580e-03 ||∇||=4.399007e+00 | Tr=0.7890] 40%|████      | 8/20 [01:02<01:04,  5.40s/it, CE=9.809187e-01 H=9.758448e-01 dV_dx=3.995831e-05 dV_dθ=-5.113880e-03 ||∇||=4.395256e+00 | Tr=0.7890] 45%|████▌     | 9/20 [01:02<00:58,  5.31s/it, CE=9.809187e-01 H=9.758448e-01 dV_dx=3.995831e-05 dV_dθ=-5.113880e-03 ||∇||=4.395256e+00 | Tr=0.7890] 45%|████▌     | 9/20 [01:07<00:58,  5.31s/it, CE=9.421224e-01 H=9.360069e-01 dV_dx=-3.285077e-05 dV_dθ=-6.082666e-03 ||∇||=4.530477e+00 | Tr=0.7890] 50%|█████     | 10/20 [01:07<00:51,  5.15s/it, CE=9.421224e-01 H=9.360069e-01 dV_dx=-3.285077e-05 dV_dθ=-6.082666e-03 ||∇||=4.530477e+00 | Tr=0.7890] 50%|█████     | 10/20 [01:10<00:51,  5.15s/it, CE=9.075061e-01 H=9.024876e-01 dV_dx=4.083253e-05 dV_dθ=-5.059252e-03 ||∇||=4.465126e+00 | Tr=0.7890]  55%|█████▌    | 11/20 [01:10<00:41,  4.61s/it, CE=9.075061e-01 H=9.024876e-01 dV_dx=4.083253e-05 dV_dθ=-5.059252e-03 ||∇||=4.465126e+00 | Tr=0.7890] 55%|█████▌    | 11/20 [01:13<00:41,  4.61s/it, CE=8.781701e-01 H=8.732259e-01 dV_dx=1.211616e-05 dV_dθ=-4.956290e-03 ||∇||=4.510613e+00 | Tr=0.7890] 60%|██████    | 12/20 [01:13<00:31,  3.95s/it, CE=8.781701e-01 H=8.732259e-01 dV_dx=1.211616e-05 dV_dθ=-4.956290e-03 ||∇||=4.510613e+00 | Tr=0.7890] 60%|██████    | 12/20 [01:15<00:31,  3.95s/it, CE=8.496781e-01 H=8.454116e-01 dV_dx=3.441693e-05 dV_dθ=-4.300851e-03 ||∇||=4.422641e+00 | Tr=0.7890] 65%|██████▌   | 13/20 [01:15<00:24,  3.50s/it, CE=8.496781e-01 H=8.454116e-01 dV_dx=3.441693e-05 dV_dθ=-4.300851e-03 ||∇||=4.422641e+00 | Tr=0.7890] 65%|██████▌   | 13/20 [01:17<00:24,  3.50s/it, CE=8.261167e-01 H=8.220069e-01 dV_dx=-1.435476e-05 dV_dθ=-4.095414e-03 ||∇||=4.494977e+00 | Tr=0.7890] 70%|███████   | 14/20 [01:17<00:18,  3.09s/it, CE=8.261167e-01 H=8.220069e-01 dV_dx=-1.435476e-05 dV_dθ=-4.095414e-03 ||∇||=4.494977e+00 | Tr=0.7890] 70%|███████   | 14/20 [01:20<00:18,  3.09s/it, CE=8.032783e-01 H=7.994351e-01 dV_dx=-2.903275e-05 dV_dθ=-3.814207e-03 ||∇||=4.480761e+00 | Tr=0.7890] 75%|███████▌  | 15/20 [01:20<00:14,  2.93s/it, CE=8.032783e-01 H=7.994351e-01 dV_dx=-2.903275e-05 dV_dθ=-3.814207e-03 ||∇||=4.480761e+00 | Tr=0.7890] 75%|███████▌  | 15/20 [01:22<00:14,  2.93s/it, CE=7.838840e-01 H=7.794913e-01 dV_dx=-7.033353e-05 dV_dθ=-4.322444e-03 ||∇||=4.598838e+00 | Tr=0.7890] 80%|████████  | 16/20 [01:22<00:10,  2.70s/it, CE=7.838840e-01 H=7.794913e-01 dV_dx=-7.033353e-05 dV_dθ=-4.322444e-03 ||∇||=4.598838e+00 | Tr=0.7890] 80%|████████  | 16/20 [01:24<00:10,  2.70s/it, CE=7.666472e-01 H=7.612419e-01 dV_dx=-7.327976e-05 dV_dθ=-5.332085e-03 ||∇||=4.722865e+00 | Tr=0.7890] 85%|████████▌ | 17/20 [01:24<00:07,  2.56s/it, CE=7.666472e-01 H=7.612419e-01 dV_dx=-7.327976e-05 dV_dθ=-5.332085e-03 ||∇||=4.722865e+00 | Tr=0.7890] 85%|████████▌ | 17/20 [01:26<00:07,  2.56s/it, CE=7.508277e-01 H=7.436385e-01 dV_dx=-2.139446e-05 dV_dθ=-7.167891e-03 ||∇||=4.908520e+00 | Tr=0.7890] 90%|█████████ | 18/20 [01:26<00:04,  2.38s/it, CE=7.508277e-01 H=7.436385e-01 dV_dx=-2.139446e-05 dV_dθ=-7.167891e-03 ||∇||=4.908520e+00 | Tr=0.7890] 90%|█████████ | 18/20 [01:29<00:04,  2.38s/it, CE=7.362753e-01 H=7.265332e-01 dV_dx=4.657617e-08 dV_dθ=-9.742138e-03 ||∇||=5.257977e+00 | Tr=0.7890]  95%|█████████▌| 19/20 [01:29<00:02,  2.36s/it, CE=7.362753e-01 H=7.265332e-01 dV_dx=4.657617e-08 dV_dθ=-9.742138e-03 ||∇||=5.257977e+00 | Tr=0.7890] 95%|█████████▌| 19/20 [01:32<00:02,  2.36s/it, CE=7.174464e-01 H=7.086351e-01 dV_dx=-1.318394e-06 dV_dθ=-8.809978e-03 ||∇||=4.912345e+00 | Tr=0.7890 Te/Cur=0.9368 Te/Exp=0.7398]100%|██████████| 20/20 [01:38<00:00,  4.62s/it, CE=7.174464e-01 H=7.086351e-01 dV_dx=-1.318394e-06 dV_dθ=-8.809978e-03 ||∇||=4.912345e+00 | Tr=0.7890 Te/Cur=0.9368 Te/Exp=0.7398]100%|██████████| 20/20 [01:38<00:00,  4.95s/it, CE=7.174464e-01 H=7.086351e-01 dV_dx=-1.318394e-06 dV_dθ=-8.809978e-03 ||∇||=4.912345e+00 | Tr=0.7890 Te/Cur=0.9368 Te/Exp=0.7398]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.628242
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<01:56,  6.14s/it]  5%|▌         | 1/20 [00:08<01:56,  6.14s/it, CE=7.455913e-01 H=7.299638e-01 dV_dx=9.983665e-05 dV_dθ=-1.572730e-02 ||∇||=5.767837e+00 | Tr=0.7883] 10%|█         | 2/20 [00:08<01:08,  3.81s/it, CE=7.455913e-01 H=7.299638e-01 dV_dx=9.983665e-05 dV_dθ=-1.572730e-02 ||∇||=5.767837e+00 | Tr=0.7883] 10%|█         | 2/20 [00:12<01:08,  3.81s/it, CE=7.220330e-01 H=7.082704e-01 dV_dx=2.627682e-05 dV_dθ=-1.378889e-02 ||∇||=5.432878e+00 | Tr=0.7883] 15%|█▌        | 3/20 [00:12<01:07,  3.97s/it, CE=7.220330e-01 H=7.082704e-01 dV_dx=2.627682e-05 dV_dθ=-1.378889e-02 ||∇||=5.432878e+00 | Tr=0.7883] 15%|█▌        | 3/20 [00:14<01:07,  3.97s/it, CE=7.000734e-01 H=6.903501e-01 dV_dx=-6.251222e-05 dV_dθ=-9.660744e-03 ||∇||=4.845761e+00 | Tr=0.7883] 20%|██        | 4/20 [00:14<00:51,  3.20s/it, CE=7.000734e-01 H=6.903501e-01 dV_dx=-6.251222e-05 dV_dθ=-9.660744e-03 ||∇||=4.845761e+00 | Tr=0.7883] 20%|██        | 4/20 [00:17<00:51,  3.20s/it, CE=6.838313e-01 H=6.765873e-01 dV_dx=-8.015419e-06 dV_dθ=-7.235976e-03 ||∇||=4.615613e+00 | Tr=0.7883] 25%|██▌       | 5/20 [00:17<00:45,  3.00s/it, CE=6.838313e-01 H=6.765873e-01 dV_dx=-8.015419e-06 dV_dθ=-7.235976e-03 ||∇||=4.615613e+00 | Tr=0.7883] 25%|██▌       | 5/20 [00:19<00:45,  3.00s/it, CE=6.712915e-01 H=6.637254e-01 dV_dx=-1.639903e-05 dV_dθ=-7.549642e-03 ||∇||=4.719896e+00 | Tr=0.7883] 30%|███       | 6/20 [00:19<00:37,  2.66s/it, CE=6.712915e-01 H=6.637254e-01 dV_dx=-1.639903e-05 dV_dθ=-7.549642e-03 ||∇||=4.719896e+00 | Tr=0.7883] 30%|███       | 6/20 [00:21<00:37,  2.66s/it, CE=6.586047e-01 H=6.511245e-01 dV_dx=1.238087e-05 dV_dθ=-7.492626e-03 ||∇||=4.695773e+00 | Tr=0.7883]  35%|███▌      | 7/20 [00:21<00:33,  2.56s/it, CE=6.586047e-01 H=6.511245e-01 dV_dx=1.238087e-05 dV_dθ=-7.492626e-03 ||∇||=4.695773e+00 | Tr=0.7883] 35%|███▌      | 7/20 [00:24<00:33,  2.56s/it, CE=6.475002e-01 H=6.391714e-01 dV_dx=-5.405629e-05 dV_dθ=-8.274741e-03 ||∇||=4.723753e+00 | Tr=0.7883] 40%|████      | 8/20 [00:24<00:30,  2.56s/it, CE=6.475002e-01 H=6.391714e-01 dV_dx=-5.405629e-05 dV_dθ=-8.274741e-03 ||∇||=4.723753e+00 | Tr=0.7883] 40%|████      | 8/20 [00:27<00:30,  2.56s/it, CE=6.377033e-01 H=6.299163e-01 dV_dx=5.747481e-05 dV_dθ=-7.844481e-03 ||∇||=4.697144e+00 | Tr=0.7883]  45%|████▌     | 9/20 [00:27<00:30,  2.77s/it, CE=6.377033e-01 H=6.299163e-01 dV_dx=5.747481e-05 dV_dθ=-7.844481e-03 ||∇||=4.697144e+00 | Tr=0.7883] 45%|████▌     | 9/20 [00:29<00:30,  2.77s/it, CE=6.288689e-01 H=6.208079e-01 dV_dx=7.617288e-07 dV_dθ=-8.061728e-03 ||∇||=4.798968e+00 | Tr=0.7883] 50%|█████     | 10/20 [00:29<00:25,  2.54s/it, CE=6.288689e-01 H=6.208079e-01 dV_dx=7.617288e-07 dV_dθ=-8.061728e-03 ||∇||=4.798968e+00 | Tr=0.7883] 50%|█████     | 10/20 [00:31<00:25,  2.54s/it, CE=6.220673e-01 H=6.123846e-01 dV_dx=-9.107023e-05 dV_dθ=-9.591628e-03 ||∇||=4.990925e+00 | Tr=0.7883] 55%|█████▌    | 11/20 [00:31<00:21,  2.40s/it, CE=6.220673e-01 H=6.123846e-01 dV_dx=-9.107023e-05 dV_dθ=-9.591628e-03 ||∇||=4.990925e+00 | Tr=0.7883] 55%|█████▌    | 11/20 [00:33<00:21,  2.40s/it, CE=6.154423e-01 H=6.034980e-01 dV_dx=2.617850e-05 dV_dθ=-1.197046e-02 ||∇||=5.209357e+00 | Tr=0.7883]  60%|██████    | 12/20 [00:33<00:19,  2.40s/it, CE=6.154423e-01 H=6.034980e-01 dV_dx=2.617850e-05 dV_dθ=-1.197046e-02 ||∇||=5.209357e+00 | Tr=0.7883] 60%|██████    | 12/20 [00:35<00:19,  2.40s/it, CE=6.141546e-01 H=5.944947e-01 dV_dx=-5.989330e-06 dV_dθ=-1.965393e-02 ||∇||=5.894208e+00 | Tr=0.7883] 65%|██████▌   | 13/20 [00:35<00:16,  2.29s/it, CE=6.141546e-01 H=5.944947e-01 dV_dx=-5.989330e-06 dV_dθ=-1.965393e-02 ||∇||=5.894208e+00 | Tr=0.7883] 65%|██████▌   | 13/20 [00:37<00:16,  2.29s/it, CE=6.165579e-01 H=5.893946e-01 dV_dx=-2.071137e-05 dV_dθ=-2.714262e-02 ||∇||=6.490368e+00 | Tr=0.7883] 70%|███████   | 14/20 [00:37<00:12,  2.15s/it, CE=6.165579e-01 H=5.893946e-01 dV_dx=-2.071137e-05 dV_dθ=-2.714262e-02 ||∇||=6.490368e+00 | Tr=0.7883] 70%|███████   | 14/20 [00:39<00:12,  2.15s/it, CE=6.019677e-01 H=5.871553e-01 dV_dx=4.953634e-05 dV_dθ=-1.486191e-02 ||∇||=5.517292e+00 | Tr=0.7883]  75%|███████▌  | 15/20 [00:39<00:10,  2.16s/it, CE=6.019677e-01 H=5.871553e-01 dV_dx=4.953634e-05 dV_dθ=-1.486191e-02 ||∇||=5.517292e+00 | Tr=0.7883] 75%|███████▌  | 15/20 [00:41<00:10,  2.16s/it, CE=5.911358e-01 H=5.806771e-01 dV_dx=-3.698002e-05 dV_dθ=-1.042179e-02 ||∇||=5.074214e+00 | Tr=0.7883] 80%|████████  | 16/20 [00:41<00:08,  2.10s/it, CE=5.911358e-01 H=5.806771e-01 dV_dx=-3.698002e-05 dV_dθ=-1.042179e-02 ||∇||=5.074214e+00 | Tr=0.7883] 80%|████████  | 16/20 [00:44<00:08,  2.10s/it, CE=5.860907e-01 H=5.769440e-01 dV_dx=2.246630e-05 dV_dθ=-9.169131e-03 ||∇||=5.085788e+00 | Tr=0.7883]  85%|████████▌ | 17/20 [00:44<00:06,  2.23s/it, CE=5.860907e-01 H=5.769440e-01 dV_dx=2.246630e-05 dV_dθ=-9.169131e-03 ||∇||=5.085788e+00 | Tr=0.7883] 85%|████████▌ | 17/20 [00:46<00:06,  2.23s/it, CE=5.827007e-01 H=5.721505e-01 dV_dx=8.251513e-05 dV_dθ=-1.063271e-02 ||∇||=5.283643e+00 | Tr=0.7883] 90%|█████████ | 18/20 [00:46<00:04,  2.28s/it, CE=5.827007e-01 H=5.721505e-01 dV_dx=8.251513e-05 dV_dθ=-1.063271e-02 ||∇||=5.283643e+00 | Tr=0.7883] 90%|█████████ | 18/20 [00:48<00:04,  2.28s/it, CE=5.806503e-01 H=5.679593e-01 dV_dx=-3.899848e-05 dV_dθ=-1.265202e-02 ||∇||=5.495554e+00 | Tr=0.7883] 95%|█████████▌| 19/20 [00:48<00:02,  2.24s/it, CE=5.806503e-01 H=5.679593e-01 dV_dx=-3.899848e-05 dV_dθ=-1.265202e-02 ||∇||=5.495554e+00 | Tr=0.7883] 95%|█████████▌| 19/20 [00:52<00:02,  2.24s/it, CE=5.801910e-01 H=5.634765e-01 dV_dx=-1.301719e-05 dV_dθ=-1.670149e-02 ||∇||=5.913861e+00 | Tr=0.7883 Te/Cur=0.9602 Te/Exp=0.7828]100%|██████████| 20/20 [00:57<00:00,  4.08s/it, CE=5.801910e-01 H=5.634765e-01 dV_dx=-1.301719e-05 dV_dθ=-1.670149e-02 ||∇||=5.913861e+00 | Tr=0.7883 Te/Cur=0.9602 Te/Exp=0.7828]100%|██████████| 20/20 [00:57<00:00,  2.86s/it, CE=5.801910e-01 H=5.634765e-01 dV_dx=-1.301719e-05 dV_dθ=-1.670149e-02 ||∇||=5.913861e+00 | Tr=0.7883 Te/Cur=0.9602 Te/Exp=0.7828]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.57s/it] 50%|█████     | 1/2 [00:11<00:08,  8.57s/it, CE=5.957487e-01 H=5.956256e-01 dV_dx=3.331601e-05 dV_dθ=-1.564170e-04 ||∇||=9.291500e-01 | Tr=0.9834 Te/Cur=0.9652 Te/Exp=0.8008]100%|██████████| 2/2 [00:11<00:00,  5.05s/it, CE=5.957487e-01 H=5.956256e-01 dV_dx=3.331601e-05 dV_dθ=-1.564170e-04 ||∇||=9.291500e-01 | Tr=0.9834 Te/Cur=0.9652 Te/Exp=0.8008]100%|██████████| 2/2 [00:11<00:00,  5.58s/it, CE=5.957487e-01 H=5.956256e-01 dV_dx=3.331601e-05 dV_dθ=-1.564170e-04 ||∇||=9.291500e-01 | Tr=0.9834 Te/Cur=0.9652 Te/Exp=0.8008]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:36,  8.24s/it]  5%|▌         | 1/20 [00:10<02:36,  8.24s/it, CE=5.842427e-01 H=5.839319e-01 dV_dx=-2.521636e-05 dV_dθ=-2.855156e-04 ||∇||=9.675295e-01 | Tr=0.9849] 10%|█         | 2/20 [00:10<01:26,  4.80s/it, CE=5.842427e-01 H=5.839319e-01 dV_dx=-2.521636e-05 dV_dθ=-2.855156e-04 ||∇||=9.675295e-01 | Tr=0.9849] 10%|█         | 2/20 [00:13<01:26,  4.80s/it, CE=5.752713e-01 H=5.749623e-01 dV_dx=2.748312e-05 dV_dθ=-3.364836e-04 ||∇||=9.910461e-01 | Tr=0.9857]  15%|█▌        | 3/20 [00:13<01:05,  3.87s/it, CE=5.752713e-01 H=5.749623e-01 dV_dx=2.748312e-05 dV_dθ=-3.364836e-04 ||∇||=9.910461e-01 | Tr=0.9857] 15%|█▌        | 3/20 [00:17<01:05,  3.87s/it, CE=5.679218e-01 H=5.677052e-01 dV_dx=1.650868e-04 dV_dθ=-3.816710e-04 ||∇||=1.011048e+00 | Tr=0.9863] 20%|██        | 4/20 [00:17<01:01,  3.84s/it, CE=5.679218e-01 H=5.677052e-01 dV_dx=1.650868e-04 dV_dθ=-3.816710e-04 ||∇||=1.011048e+00 | Tr=0.9863] 20%|██        | 4/20 [00:18<01:01,  3.84s/it, CE=5.612011e-01 H=5.607188e-01 dV_dx=-7.589978e-05 dV_dθ=-4.063509e-04 ||∇||=1.017558e+00 | Tr=0.9869] 25%|██▌       | 5/20 [00:18<00:45,  3.06s/it, CE=5.612011e-01 H=5.607188e-01 dV_dx=-7.589978e-05 dV_dθ=-4.063509e-04 ||∇||=1.017558e+00 | Tr=0.9869] 25%|██▌       | 5/20 [00:22<00:45,  3.06s/it, CE=5.554041e-01 H=5.549298e-01 dV_dx=-5.465054e-05 dV_dθ=-4.196260e-04 ||∇||=1.026618e+00 | Tr=0.9873 Te/Cur=0.9675 Te/Exp=0.7925] 30%|███       | 6/20 [00:22<00:43,  3.11s/it, CE=5.554041e-01 H=5.549298e-01 dV_dx=-5.465054e-05 dV_dθ=-4.196260e-04 ||∇||=1.026618e+00 | Tr=0.9873 Te/Cur=0.9675 Te/Exp=0.7925] 30%|███       | 6/20 [00:24<00:43,  3.11s/it, CE=5.495381e-01 H=5.491551e-01 dV_dx=2.648415e-05 dV_dθ=-4.094709e-04 ||∇||=1.018753e+00 | Tr=0.9875]                              35%|███▌      | 7/20 [00:24<00:35,  2.73s/it, CE=5.495381e-01 H=5.491551e-01 dV_dx=2.648415e-05 dV_dθ=-4.094709e-04 ||∇||=1.018753e+00 | Tr=0.9875] 35%|███▌      | 7/20 [00:25<00:35,  2.73s/it, CE=5.441176e-01 H=5.438479e-01 dV_dx=1.119597e-04 dV_dθ=-3.816400e-04 ||∇||=1.004027e+00 | Tr=0.9879] 40%|████      | 8/20 [00:25<00:29,  2.48s/it, CE=5.441176e-01 H=5.438479e-01 dV_dx=1.119597e-04 dV_dθ=-3.816400e-04 ||∇||=1.004027e+00 | Tr=0.9879] 40%|████      | 8/20 [00:28<00:29,  2.48s/it, CE=5.389380e-01 H=5.385423e-01 dV_dx=-5.269848e-05 dV_dθ=-3.430299e-04 ||∇||=9.845085e-01 | Tr=0.9885] 45%|████▌     | 9/20 [00:28<00:26,  2.41s/it, CE=5.389380e-01 H=5.385423e-01 dV_dx=-5.269848e-05 dV_dθ=-3.430299e-04 ||∇||=9.845085e-01 | Tr=0.9885] 45%|████▌     | 9/20 [00:30<00:26,  2.41s/it, CE=5.339895e-01 H=5.337068e-01 dV_dx=3.462673e-05 dV_dθ=-3.172560e-04 ||∇||=9.700559e-01 | Tr=0.9890]  50%|█████     | 10/20 [00:30<00:23,  2.32s/it, CE=5.339895e-01 H=5.337068e-01 dV_dx=3.462673e-05 dV_dθ=-3.172560e-04 ||∇||=9.700559e-01 | Tr=0.9890] 50%|█████     | 10/20 [00:33<00:23,  2.32s/it, CE=5.294131e-01 H=5.291589e-01 dV_dx=5.649669e-05 dV_dθ=-3.105988e-04 ||∇||=9.676637e-01 | Tr=0.9894 Te/Cur=0.9694 Te/Exp=0.8051] 55%|█████▌    | 11/20 [00:33<00:23,  2.63s/it, CE=5.294131e-01 H=5.291589e-01 dV_dx=5.649669e-05 dV_dθ=-3.105988e-04 ||∇||=9.676637e-01 | Tr=0.9894 Te/Cur=0.9694 Te/Exp=0.8051] 55%|█████▌    | 11/20 [00:35<00:23,  2.63s/it, CE=5.247853e-01 H=5.244247e-01 dV_dx=-8.651579e-05 dV_dθ=-2.741362e-04 ||∇||=9.482948e-01 | Tr=0.9898]                            60%|██████    | 12/20 [00:35<00:18,  2.36s/it, CE=5.247853e-01 H=5.244247e-01 dV_dx=-8.651579e-05 dV_dθ=-2.741362e-04 ||∇||=9.482948e-01 | Tr=0.9898] 60%|██████    | 12/20 [00:37<00:18,  2.36s/it, CE=5.204741e-01 H=5.202757e-01 dV_dx=4.562228e-05 dV_dθ=-2.440505e-04 ||∇||=9.349714e-01 | Tr=0.9903]  65%|██████▌   | 13/20 [00:37<00:15,  2.28s/it, CE=5.204741e-01 H=5.202757e-01 dV_dx=4.562228e-05 dV_dθ=-2.440505e-04 ||∇||=9.349714e-01 | Tr=0.9903] 65%|██████▌   | 13/20 [00:39<00:15,  2.28s/it, CE=5.163189e-01 H=5.160672e-01 dV_dx=-3.387912e-05 dV_dθ=-2.178748e-04 ||∇||=9.266322e-01 | Tr=0.9906] 70%|███████   | 14/20 [00:39<00:13,  2.18s/it, CE=5.163189e-01 H=5.160672e-01 dV_dx=-3.387912e-05 dV_dθ=-2.178748e-04 ||∇||=9.266322e-01 | Tr=0.9906] 70%|███████   | 14/20 [00:41<00:13,  2.18s/it, CE=5.121057e-01 H=5.119456e-01 dV_dx=3.574897e-05 dV_dθ=-1.958325e-04 ||∇||=9.072404e-01 | Tr=0.9910]  75%|███████▌  | 15/20 [00:41<00:10,  2.13s/it, CE=5.121057e-01 H=5.119456e-01 dV_dx=3.574897e-05 dV_dθ=-1.958325e-04 ||∇||=9.072404e-01 | Tr=0.9910] 75%|███████▌  | 15/20 [00:44<00:10,  2.13s/it, CE=5.082050e-01 H=5.080297e-01 dV_dx=1.854088e-07 dV_dθ=-1.754761e-04 ||∇||=8.945158e-01 | Tr=0.9916 Te/Cur=0.9716 Te/Exp=0.8046] 80%|████████  | 16/20 [00:44<00:10,  2.51s/it, CE=5.082050e-01 H=5.080297e-01 dV_dx=1.854088e-07 dV_dθ=-1.754761e-04 ||∇||=8.945158e-01 | Tr=0.9916 Te/Cur=0.9716 Te/Exp=0.8046] 80%|████████  | 16/20 [00:46<00:10,  2.51s/it, CE=5.044817e-01 H=5.042844e-01 dV_dx=-4.037870e-05 dV_dθ=-1.569664e-04 ||∇||=8.876438e-01 | Tr=0.9919]                            85%|████████▌ | 17/20 [00:46<00:06,  2.30s/it, CE=5.044817e-01 H=5.042844e-01 dV_dx=-4.037870e-05 dV_dθ=-1.569664e-04 ||∇||=8.876438e-01 | Tr=0.9919] 85%|████████▌ | 17/20 [00:48<00:06,  2.30s/it, CE=5.009629e-01 H=5.007879e-01 dV_dx=-2.891751e-05 dV_dθ=-1.460341e-04 ||∇||=8.801567e-01 | Tr=0.9924] 90%|█████████ | 18/20 [00:48<00:04,  2.21s/it, CE=5.009629e-01 H=5.007879e-01 dV_dx=-2.891751e-05 dV_dθ=-1.460341e-04 ||∇||=8.801567e-01 | Tr=0.9924] 90%|█████████ | 18/20 [00:50<00:04,  2.21s/it, CE=4.975789e-01 H=4.974166e-01 dV_dx=-2.078544e-05 dV_dθ=-1.415059e-04 ||∇||=8.741221e-01 | Tr=0.9927] 95%|█████████▌| 19/20 [00:50<00:02,  2.13s/it, CE=4.975789e-01 H=4.974166e-01 dV_dx=-2.078544e-05 dV_dθ=-1.415059e-04 ||∇||=8.741221e-01 | Tr=0.9927] 95%|█████████▌| 19/20 [00:53<00:02,  2.13s/it, CE=4.943757e-01 H=4.941499e-01 dV_dx=-8.792364e-05 dV_dθ=-1.378572e-04 ||∇||=8.743879e-01 | Tr=0.9930 Te/Cur=0.9731 Te/Exp=0.8013]100%|██████████| 20/20 [00:53<00:00,  2.45s/it, CE=4.943757e-01 H=4.941499e-01 dV_dx=-8.792364e-05 dV_dθ=-1.378572e-04 ||∇||=8.743879e-01 | Tr=0.9930 Te/Cur=0.9731 Te/Exp=0.8013]100%|██████████| 20/20 [00:53<00:00,  2.69s/it, CE=4.943757e-01 H=4.941499e-01 dV_dx=-8.792364e-05 dV_dθ=-1.378572e-04 ||∇||=8.743879e-01 | Tr=0.9930 Te/Cur=0.9731 Te/Exp=0.8013]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 5 final loss: 0.501290
======================================================================


  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7636
    Task 1: 0.9348
    Task 2: 0.8190
    Task 3: 0.5899
    Task 4: 0.9254
    Task 5: 0.9718

============================================================
Task 6
============================================================
Initial loss on new task: 9.6074, previous: 0.4944, ratio: 19.43
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 6
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:08<?, ?it/s, CE=5.897391e-01 H=5.775985e-01 dV_dx=-4.879621e-05 dV_dθ=-1.209183e-02 ||∇||=4.946622e+00 | Tr=0.5834 Te/Cur=0.7444 Te/Exp=0.8132]100%|██████████| 1/1 [00:08<00:00,  8.88s/it, CE=5.897391e-01 H=5.775985e-01 dV_dx=-4.879621e-05 dV_dθ=-1.209183e-02 ||∇||=4.946622e+00 | Tr=0.5834 Te/Cur=0.7444 Te/Exp=0.8132]100%|██████████| 1/1 [00:08<00:00,  8.88s/it, CE=5.897391e-01 H=5.775985e-01 dV_dx=-4.879621e-05 dV_dθ=-1.209183e-02 ||∇||=4.946622e+00 | Tr=0.5834 Te/Cur=0.7444 Te/Exp=0.8132]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.589739

[STEP 2] Architecture change decision
  Current: 0.589739, Previous: 0.494376
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 39933 samples from 10 classes
  Starting grid architecture search for task 6
  Baseline architecture: (2, [507, 552, 204, 10])
  Baseline loss: 0.589739
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.66s/it] 50%|█████     | 1/2 [00:14<00:12, 12.66s/it, CE=2.256225e+00 H=2.256161e+00 dV_dx=1.503844e-05 dV_dθ=-7.823379e-05 ||∇||=4.660592e-01 | Tr=0.1126 Te/Cur=0.1158 Te/Exp=0.2570]100%|██████████| 2/2 [00:14<00:00,  6.55s/it, CE=2.256225e+00 H=2.256161e+00 dV_dx=1.503844e-05 dV_dθ=-7.823379e-05 ||∇||=4.660592e-01 | Tr=0.1126 Te/Cur=0.1158 Te/Exp=0.2570]100%|██████████| 2/2 [00:14<00:00,  7.47s/it, CE=2.256225e+00 H=2.256161e+00 dV_dx=1.503844e-05 dV_dθ=-7.823379e-05 ||∇||=4.660592e-01 | Tr=0.1126 Te/Cur=0.1158 Te/Exp=0.2570]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.256224626378743
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.12s/it] 50%|█████     | 1/2 [00:10<00:09,  9.12s/it, CE=2.261228e+00 H=2.261089e+00 dV_dx=-3.298725e-06 dV_dθ=-1.357678e-04 ||∇||=4.958074e-01 | Tr=0.1225 Te/Cur=0.1356 Te/Exp=0.2230]100%|██████████| 2/2 [00:10<00:00,  4.83s/it, CE=2.261228e+00 H=2.261089e+00 dV_dx=-3.298725e-06 dV_dθ=-1.357678e-04 ||∇||=4.958074e-01 | Tr=0.1225 Te/Cur=0.1356 Te/Exp=0.2230]100%|██████████| 2/2 [00:10<00:00,  5.47s/it, CE=2.261228e+00 H=2.261089e+00 dV_dx=-3.298725e-06 dV_dθ=-1.357678e-04 ||∇||=4.958074e-01 | Tr=0.1225 Te/Cur=0.1356 Te/Exp=0.2230]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.39s/it] 50%|█████     | 1/2 [00:11<00:09,  9.39s/it, CE=2.250402e+00 H=2.250324e+00 dV_dx=-2.125131e-06 dV_dθ=-7.654912e-05 ||∇||=4.527711e-01 | Tr=0.1617 Te/Cur=0.1798 Te/Exp=0.2753]100%|██████████| 2/2 [00:11<00:00,  4.99s/it, CE=2.250402e+00 H=2.250324e+00 dV_dx=-2.125131e-06 dV_dθ=-7.654912e-05 ||∇||=4.527711e-01 | Tr=0.1617 Te/Cur=0.1798 Te/Exp=0.2753]100%|██████████| 2/2 [00:11<00:00,  5.65s/it, CE=2.250402e+00 H=2.250324e+00 dV_dx=-2.125131e-06 dV_dθ=-7.654912e-05 ||∇||=4.527711e-01 | Tr=0.1617 Te/Cur=0.1798 Te/Exp=0.2753]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 184, 10]) with loss 2.250402
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.36s/it] 50%|█████     | 1/2 [00:11<00:09,  9.36s/it, CE=2.249012e+00 H=2.248882e+00 dV_dx=1.083883e-06 dV_dθ=-1.312373e-04 ||∇||=4.754321e-01 | Tr=0.1293 Te/Cur=0.1381 Te/Exp=0.2568]100%|██████████| 2/2 [00:11<00:00,  4.97s/it, CE=2.249012e+00 H=2.248882e+00 dV_dx=1.083883e-06 dV_dθ=-1.312373e-04 ||∇||=4.754321e-01 | Tr=0.1293 Te/Cur=0.1381 Te/Exp=0.2568]100%|██████████| 2/2 [00:11<00:00,  5.63s/it, CE=2.249012e+00 H=2.248882e+00 dV_dx=1.083883e-06 dV_dθ=-1.312373e-04 ||∇||=4.754321e-01 | Tr=0.1293 Te/Cur=0.1381 Te/Exp=0.2568]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 204, 10]) with loss 2.249012
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.81s/it] 50%|█████     | 1/2 [00:05<00:03,  3.81s/it, CE=2.241498e+00 H=2.241467e+00 dV_dx=-1.185960e-05 dV_dθ=-1.942559e-05 ||∇||=4.514527e-01 | Tr=0.1186 Te/Cur=0.1597 Te/Exp=0.3101]100%|██████████| 2/2 [00:05<00:00,  2.77s/it, CE=2.241498e+00 H=2.241467e+00 dV_dx=-1.185960e-05 dV_dθ=-1.942559e-05 ||∇||=4.514527e-01 | Tr=0.1186 Te/Cur=0.1597 Te/Exp=0.3101]100%|██████████| 2/2 [00:05<00:00,  2.92s/it, CE=2.241498e+00 H=2.241467e+00 dV_dx=-1.185960e-05 dV_dθ=-1.942559e-05 ||∇||=4.514527e-01 | Tr=0.1186 Te/Cur=0.1597 Te/Exp=0.3101]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 204, 10]) with loss 2.241498
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.89s/it] 50%|█████     | 1/2 [00:11<00:09,  9.89s/it, CE=2.261456e+00 H=2.261309e+00 dV_dx=-4.605541e-06 dV_dθ=-1.424149e-04 ||∇||=4.977971e-01 | Tr=0.1216 Te/Cur=0.1476 Te/Exp=0.2679]100%|██████████| 2/2 [00:11<00:00,  5.17s/it, CE=2.261456e+00 H=2.261309e+00 dV_dx=-4.605541e-06 dV_dθ=-1.424149e-04 ||∇||=4.977971e-01 | Tr=0.1216 Te/Cur=0.1476 Te/Exp=0.2679]100%|██████████| 2/2 [00:11<00:00,  5.87s/it, CE=2.261456e+00 H=2.261309e+00 dV_dx=-4.605541e-06 dV_dθ=-1.424149e-04 ||∇||=4.977971e-01 | Tr=0.1216 Te/Cur=0.1476 Te/Exp=0.2679]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.77s/it] 50%|█████     | 1/2 [00:13<00:11, 11.77s/it, CE=2.254555e+00 H=2.254498e+00 dV_dx=1.473690e-05 dV_dθ=-7.232086e-05 ||∇||=4.671081e-01 | Tr=0.1278 Te/Cur=0.1554 Te/Exp=0.3033]100%|██████████| 2/2 [00:13<00:00,  5.79s/it, CE=2.254555e+00 H=2.254498e+00 dV_dx=1.473690e-05 dV_dθ=-7.232086e-05 ||∇||=4.671081e-01 | Tr=0.1278 Te/Cur=0.1554 Te/Exp=0.3033]100%|██████████| 2/2 [00:13<00:00,  6.69s/it, CE=2.254555e+00 H=2.254498e+00 dV_dx=1.473690e-05 dV_dθ=-7.232086e-05 ||∇||=4.671081e-01 | Tr=0.1278 Te/Cur=0.1554 Te/Exp=0.3033]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.94s/it] 50%|█████     | 1/2 [00:12<00:09,  9.94s/it, CE=2.249498e+00 H=2.249345e+00 dV_dx=1.404375e-05 dV_dθ=-1.679423e-04 ||∇||=4.967389e-01 | Tr=0.1296 Te/Cur=0.1443 Te/Exp=0.2734]100%|██████████| 2/2 [00:12<00:00,  5.34s/it, CE=2.249498e+00 H=2.249345e+00 dV_dx=1.404375e-05 dV_dθ=-1.679423e-04 ||∇||=4.967389e-01 | Tr=0.1296 Te/Cur=0.1443 Te/Exp=0.2734]100%|██████████| 2/2 [00:12<00:00,  6.03s/it, CE=2.249498e+00 H=2.249345e+00 dV_dx=1.404375e-05 dV_dθ=-1.679423e-04 ||∇||=4.967389e-01 | Tr=0.1296 Te/Cur=0.1443 Te/Exp=0.2734]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.84s/it] 50%|█████     | 1/2 [00:11<00:09,  9.84s/it, CE=2.251273e+00 H=2.251244e+00 dV_dx=6.357295e-06 dV_dθ=-3.611841e-05 ||∇||=4.685855e-01 | Tr=0.1375 Te/Cur=0.1581 Te/Exp=0.2997]100%|██████████| 2/2 [00:11<00:00,  5.10s/it, CE=2.251273e+00 H=2.251244e+00 dV_dx=6.357295e-06 dV_dθ=-3.611841e-05 ||∇||=4.685855e-01 | Tr=0.1375 Te/Cur=0.1581 Te/Exp=0.2997]100%|██████████| 2/2 [00:11<00:00,  5.81s/it, CE=2.251273e+00 H=2.251244e+00 dV_dx=6.357295e-06 dV_dθ=-3.611841e-05 ||∇||=4.685855e-01 | Tr=0.1375 Te/Cur=0.1581 Te/Exp=0.2997]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.75s/it] 50%|█████     | 1/2 [00:11<00:09,  9.75s/it, CE=2.258983e+00 H=2.258959e+00 dV_dx=1.041290e-05 dV_dθ=-3.449798e-05 ||∇||=3.628362e-01 | Tr=0.1195 Te/Cur=0.1161 Te/Exp=0.2209]100%|██████████| 2/2 [00:11<00:00,  5.11s/it, CE=2.258983e+00 H=2.258959e+00 dV_dx=1.041290e-05 dV_dθ=-3.449798e-05 ||∇||=3.628362e-01 | Tr=0.1195 Te/Cur=0.1161 Te/Exp=0.2209]100%|██████████| 2/2 [00:11<00:00,  5.80s/it, CE=2.258983e+00 H=2.258959e+00 dV_dx=1.041290e-05 dV_dθ=-3.449798e-05 ||∇||=3.628362e-01 | Tr=0.1195 Te/Cur=0.1161 Te/Exp=0.2209]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.65s/it] 50%|█████     | 1/2 [00:11<00:09,  9.65s/it, CE=2.265989e+00 H=2.265974e+00 dV_dx=8.592010e-06 dV_dθ=-2.376545e-05 ||∇||=3.546066e-01 | Tr=0.0758 Te/Cur=0.0831 Te/Exp=0.1993]100%|██████████| 2/2 [00:11<00:00,  5.05s/it, CE=2.265989e+00 H=2.265974e+00 dV_dx=8.592010e-06 dV_dθ=-2.376545e-05 ||∇||=3.546066e-01 | Tr=0.0758 Te/Cur=0.0831 Te/Exp=0.1993]100%|██████████| 2/2 [00:11<00:00,  5.74s/it, CE=2.265989e+00 H=2.265974e+00 dV_dx=8.592010e-06 dV_dθ=-2.376545e-05 ||∇||=3.546066e-01 | Tr=0.0758 Te/Cur=0.0831 Te/Exp=0.1993]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.04s/it] 50%|█████     | 1/2 [00:10<00:09,  9.04s/it, CE=2.253668e+00 H=2.253626e+00 dV_dx=-1.423116e-05 dV_dθ=-2.770519e-05 ||∇||=3.843704e-01 | Tr=0.1084 Te/Cur=0.1206 Te/Exp=0.2311]100%|██████████| 2/2 [00:10<00:00,  4.84s/it, CE=2.253668e+00 H=2.253626e+00 dV_dx=-1.423116e-05 dV_dθ=-2.770519e-05 ||∇||=3.843704e-01 | Tr=0.1084 Te/Cur=0.1206 Te/Exp=0.2311]100%|██████████| 2/2 [00:10<00:00,  5.47s/it, CE=2.253668e+00 H=2.253626e+00 dV_dx=-1.423116e-05 dV_dθ=-2.770519e-05 ||∇||=3.843704e-01 | Tr=0.1084 Te/Cur=0.1206 Te/Exp=0.2311]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.28s/it] 50%|█████     | 1/2 [00:14<00:09,  9.28s/it, CE=2.257713e+00 H=2.257655e+00 dV_dx=-1.243913e-05 dV_dθ=-4.600524e-05 ||∇||=3.792361e-01 | Tr=0.1369 Te/Cur=0.1344 Te/Exp=0.2507]100%|██████████| 2/2 [00:14<00:00,  6.66s/it, CE=2.257713e+00 H=2.257655e+00 dV_dx=-1.243913e-05 dV_dθ=-4.600524e-05 ||∇||=3.792361e-01 | Tr=0.1369 Te/Cur=0.1344 Te/Exp=0.2507]100%|██████████| 2/2 [00:14<00:00,  7.05s/it, CE=2.257713e+00 H=2.257655e+00 dV_dx=-1.243913e-05 dV_dθ=-4.600524e-05 ||∇||=3.792361e-01 | Tr=0.1369 Te/Cur=0.1344 Te/Exp=0.2507]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.91s/it] 50%|█████     | 1/2 [00:05<00:03,  3.91s/it, CE=2.246961e+00 H=2.246990e+00 dV_dx=1.384518e-05 dV_dθ=1.468939e-05 ||∇||=3.573074e-01 | Tr=0.1230 Te/Cur=0.1356 Te/Exp=0.2974]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.246961e+00 H=2.246990e+00 dV_dx=1.384518e-05 dV_dθ=1.468939e-05 ||∇||=3.573074e-01 | Tr=0.1230 Te/Cur=0.1356 Te/Exp=0.2974]100%|██████████| 2/2 [00:05<00:00,  2.76s/it, CE=2.246961e+00 H=2.246990e+00 dV_dx=1.384518e-05 dV_dθ=1.468939e-05 ||∇||=3.573074e-01 | Tr=0.1230 Te/Cur=0.1356 Te/Exp=0.2974]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.37s/it] 50%|█████     | 1/2 [00:11<00:09,  9.37s/it, CE=2.257093e+00 H=2.257080e+00 dV_dx=1.492874e-05 dV_dθ=-2.809336e-05 ||∇||=3.427495e-01 | Tr=0.1160 Te/Cur=0.1132 Te/Exp=0.2536]100%|██████████| 2/2 [00:11<00:00,  4.94s/it, CE=2.257093e+00 H=2.257080e+00 dV_dx=1.492874e-05 dV_dθ=-2.809336e-05 ||∇||=3.427495e-01 | Tr=0.1160 Te/Cur=0.1132 Te/Exp=0.2536]100%|██████████| 2/2 [00:11<00:00,  5.61s/it, CE=2.257093e+00 H=2.257080e+00 dV_dx=1.492874e-05 dV_dθ=-2.809336e-05 ||∇||=3.427495e-01 | Tr=0.1160 Te/Cur=0.1132 Te/Exp=0.2536]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.62s/it] 50%|█████     | 1/2 [00:11<00:09,  9.62s/it, CE=2.265585e+00 H=2.265524e+00 dV_dx=-7.328579e-06 dV_dθ=-5.385111e-05 ||∇||=3.716138e-01 | Tr=0.1303 Te/Cur=0.1258 Te/Exp=0.2255]100%|██████████| 2/2 [00:11<00:00,  5.09s/it, CE=2.265585e+00 H=2.265524e+00 dV_dx=-7.328579e-06 dV_dθ=-5.385111e-05 ||∇||=3.716138e-01 | Tr=0.1303 Te/Cur=0.1258 Te/Exp=0.2255]100%|██████████| 2/2 [00:11<00:00,  5.77s/it, CE=2.265585e+00 H=2.265524e+00 dV_dx=-7.328579e-06 dV_dθ=-5.385111e-05 ||∇||=3.716138e-01 | Tr=0.1303 Te/Cur=0.1258 Te/Exp=0.2255]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.52s/it] 50%|█████     | 1/2 [00:11<00:09,  9.52s/it, CE=2.255525e+00 H=2.255500e+00 dV_dx=-7.785132e-06 dV_dθ=-1.760126e-05 ||∇||=3.545547e-01 | Tr=0.1110 Te/Cur=0.1136 Te/Exp=0.2442]100%|██████████| 2/2 [00:11<00:00,  5.23s/it, CE=2.255525e+00 H=2.255500e+00 dV_dx=-7.785132e-06 dV_dθ=-1.760126e-05 ||∇||=3.545547e-01 | Tr=0.1110 Te/Cur=0.1136 Te/Exp=0.2442]100%|██████████| 2/2 [00:11<00:00,  5.87s/it, CE=2.255525e+00 H=2.255500e+00 dV_dx=-7.785132e-06 dV_dθ=-1.760126e-05 ||∇||=3.545547e-01 | Tr=0.1110 Te/Cur=0.1136 Te/Exp=0.2442]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.61s/it] 50%|█████     | 1/2 [00:10<00:08,  8.61s/it, CE=2.260944e+00 H=2.260877e+00 dV_dx=-9.286965e-06 dV_dθ=-5.713374e-05 ||∇||=3.734283e-01 | Tr=0.0809 Te/Cur=0.0738 Te/Exp=0.1928]100%|██████████| 2/2 [00:10<00:00,  4.49s/it, CE=2.260944e+00 H=2.260877e+00 dV_dx=-9.286965e-06 dV_dθ=-5.713374e-05 ||∇||=3.734283e-01 | Tr=0.0809 Te/Cur=0.0738 Te/Exp=0.1928]100%|██████████| 2/2 [00:10<00:00,  5.11s/it, CE=2.260944e+00 H=2.260877e+00 dV_dx=-9.286965e-06 dV_dθ=-5.713374e-05 ||∇||=3.734283e-01 | Tr=0.0809 Te/Cur=0.0738 Te/Exp=0.1928]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.30s/it] 50%|█████     | 1/2 [00:11<00:09,  9.30s/it, CE=2.264386e+00 H=2.264298e+00 dV_dx=-2.178398e-05 dV_dθ=-6.604612e-05 ||∇||=3.815673e-01 | Tr=0.1536 Te/Cur=0.1182 Te/Exp=0.2562]100%|██████████| 2/2 [00:11<00:00,  4.92s/it, CE=2.264386e+00 H=2.264298e+00 dV_dx=-2.178398e-05 dV_dθ=-6.604612e-05 ||∇||=3.815673e-01 | Tr=0.1536 Te/Cur=0.1182 Te/Exp=0.2562]100%|██████████| 2/2 [00:11<00:00,  5.58s/it, CE=2.264386e+00 H=2.264298e+00 dV_dx=-2.178398e-05 dV_dθ=-6.604612e-05 ||∇||=3.815673e-01 | Tr=0.1536 Te/Cur=0.1182 Te/Exp=0.2562]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.02s/it] 50%|█████     | 1/2 [00:14<00:13, 13.02s/it, CE=2.266290e+00 H=2.266187e+00 dV_dx=-2.426455e-05 dV_dθ=-7.890095e-05 ||∇||=3.665441e-01 | Tr=0.1444 Te/Cur=0.1932 Te/Exp=0.2503]100%|██████████| 2/2 [00:14<00:00,  6.25s/it, CE=2.266290e+00 H=2.266187e+00 dV_dx=-2.426455e-05 dV_dθ=-7.890095e-05 ||∇||=3.665441e-01 | Tr=0.1444 Te/Cur=0.1932 Te/Exp=0.2503]100%|██████████| 2/2 [00:14<00:00,  7.27s/it, CE=2.266290e+00 H=2.266187e+00 dV_dx=-2.426455e-05 dV_dθ=-7.890095e-05 ||∇||=3.665441e-01 | Tr=0.1444 Te/Cur=0.1932 Te/Exp=0.2503]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.94s/it] 50%|█████     | 1/2 [00:11<00:09,  9.94s/it, CE=2.267308e+00 H=2.267249e+00 dV_dx=8.096994e-06 dV_dθ=-6.732093e-05 ||∇||=3.801848e-01 | Tr=0.0614 Te/Cur=0.0691 Te/Exp=0.2273]100%|██████████| 2/2 [00:11<00:00,  5.07s/it, CE=2.267308e+00 H=2.267249e+00 dV_dx=8.096994e-06 dV_dθ=-6.732093e-05 ||∇||=3.801848e-01 | Tr=0.0614 Te/Cur=0.0691 Te/Exp=0.2273]100%|██████████| 2/2 [00:11<00:00,  5.80s/it, CE=2.267308e+00 H=2.267249e+00 dV_dx=8.096994e-06 dV_dθ=-6.732093e-05 ||∇||=3.801848e-01 | Tr=0.0614 Te/Cur=0.0691 Te/Exp=0.2273]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.90s/it] 50%|█████     | 1/2 [00:11<00:09,  9.90s/it, CE=2.269141e+00 H=2.269099e+00 dV_dx=-4.594984e-06 dV_dθ=-3.721224e-05 ||∇||=3.647040e-01 | Tr=0.1057 Te/Cur=0.1024 Te/Exp=0.2459]100%|██████████| 2/2 [00:11<00:00,  5.26s/it, CE=2.269141e+00 H=2.269099e+00 dV_dx=-4.594984e-06 dV_dθ=-3.721224e-05 ||∇||=3.647040e-01 | Tr=0.1057 Te/Cur=0.1024 Te/Exp=0.2459]100%|██████████| 2/2 [00:11<00:00,  5.96s/it, CE=2.269141e+00 H=2.269099e+00 dV_dx=-4.594984e-06 dV_dθ=-3.721224e-05 ||∇||=3.647040e-01 | Tr=0.1057 Te/Cur=0.1024 Te/Exp=0.2459]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.39s/it] 50%|█████     | 1/2 [00:05<00:03,  3.39s/it, CE=2.263013e+00 H=2.262975e+00 dV_dx=9.441838e-07 dV_dθ=-3.900701e-05 ||∇||=3.509004e-01 | Tr=0.1070 Te/Cur=0.1271 Te/Exp=0.2539]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.263013e+00 H=2.262975e+00 dV_dx=9.441838e-07 dV_dθ=-3.900701e-05 ||∇||=3.509004e-01 | Tr=0.1070 Te/Cur=0.1271 Te/Exp=0.2539]100%|██████████| 2/2 [00:05<00:00,  2.69s/it, CE=2.263013e+00 H=2.262975e+00 dV_dx=9.441838e-07 dV_dθ=-3.900701e-05 ||∇||=3.509004e-01 | Tr=0.1070 Te/Cur=0.1271 Te/Exp=0.2539]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.61s/it] 50%|█████     | 1/2 [00:11<00:09,  9.61s/it, CE=2.262203e+00 H=2.262181e+00 dV_dx=3.998742e-06 dV_dθ=-2.591252e-05 ||∇||=3.816568e-01 | Tr=0.0792 Te/Cur=0.0505 Te/Exp=0.2422]100%|██████████| 2/2 [00:11<00:00,  5.10s/it, CE=2.262203e+00 H=2.262181e+00 dV_dx=3.998742e-06 dV_dθ=-2.591252e-05 ||∇||=3.816568e-01 | Tr=0.0792 Te/Cur=0.0505 Te/Exp=0.2422]100%|██████████| 2/2 [00:11<00:00,  5.78s/it, CE=2.262203e+00 H=2.262181e+00 dV_dx=3.998742e-06 dV_dθ=-2.591252e-05 ||∇||=3.816568e-01 | Tr=0.0792 Te/Cur=0.0505 Te/Exp=0.2422]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.11s/it] 50%|█████     | 1/2 [00:11<00:09,  9.11s/it, CE=2.264501e+00 H=2.264455e+00 dV_dx=-1.235033e-06 dV_dθ=-4.393359e-05 ||∇||=3.629921e-01 | Tr=0.0809 Te/Cur=0.0661 Te/Exp=0.2589]100%|██████████| 2/2 [00:11<00:00,  4.97s/it, CE=2.264501e+00 H=2.264455e+00 dV_dx=-1.235033e-06 dV_dθ=-4.393359e-05 ||∇||=3.629921e-01 | Tr=0.0809 Te/Cur=0.0661 Te/Exp=0.2589]100%|██████████| 2/2 [00:11<00:00,  5.59s/it, CE=2.264501e+00 H=2.264455e+00 dV_dx=-1.235033e-06 dV_dθ=-4.393359e-05 ||∇||=3.629921e-01 | Tr=0.0809 Te/Cur=0.0661 Te/Exp=0.2589]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.55s/it] 50%|█████     | 1/2 [00:11<00:09,  9.55s/it, CE=2.249607e+00 H=2.249573e+00 dV_dx=6.032331e-07 dV_dθ=-3.430587e-05 ||∇||=3.500601e-01 | Tr=0.1279 Te/Cur=0.1272 Te/Exp=0.2774]100%|██████████| 2/2 [00:11<00:00,  4.95s/it, CE=2.249607e+00 H=2.249573e+00 dV_dx=6.032331e-07 dV_dθ=-3.430587e-05 ||∇||=3.500601e-01 | Tr=0.1279 Te/Cur=0.1272 Te/Exp=0.2774]100%|██████████| 2/2 [00:11<00:00,  5.64s/it, CE=2.249607e+00 H=2.249573e+00 dV_dx=6.032331e-07 dV_dθ=-3.430587e-05 ||∇||=3.500601e-01 | Tr=0.1279 Te/Cur=0.1272 Te/Exp=0.2774]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.82s/it] 50%|█████     | 1/2 [00:14<00:12, 12.82s/it, CE=2.254317e+00 H=2.254257e+00 dV_dx=-2.536396e-06 dV_dθ=-5.689266e-05 ||∇||=4.103932e-01 | Tr=0.1329 Te/Cur=0.1377 Te/Exp=0.2553]100%|██████████| 2/2 [00:14<00:00,  6.45s/it, CE=2.254317e+00 H=2.254257e+00 dV_dx=-2.536396e-06 dV_dθ=-5.689266e-05 ||∇||=4.103932e-01 | Tr=0.1329 Te/Cur=0.1377 Te/Exp=0.2553]100%|██████████| 2/2 [00:14<00:00,  7.41s/it, CE=2.254317e+00 H=2.254257e+00 dV_dx=-2.536396e-06 dV_dθ=-5.689266e-05 ||∇||=4.103932e-01 | Tr=0.1329 Te/Cur=0.1377 Te/Exp=0.2553]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.51s/it] 50%|█████     | 1/2 [00:11<00:09,  9.51s/it, CE=2.277396e+00 H=2.277384e+00 dV_dx=6.829304e-06 dV_dθ=-1.888295e-05 ||∇||=3.748577e-01 | Tr=0.1631 Te/Cur=0.1937 Te/Exp=0.2016]100%|██████████| 2/2 [00:11<00:00,  5.16s/it, CE=2.277396e+00 H=2.277384e+00 dV_dx=6.829304e-06 dV_dθ=-1.888295e-05 ||∇||=3.748577e-01 | Tr=0.1631 Te/Cur=0.1937 Te/Exp=0.2016]100%|██████████| 2/2 [00:11<00:00,  5.81s/it, CE=2.277396e+00 H=2.277384e+00 dV_dx=6.829304e-06 dV_dθ=-1.888295e-05 ||∇||=3.748577e-01 | Tr=0.1631 Te/Cur=0.1937 Te/Exp=0.2016]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.277395746795006
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.64s/it] 50%|█████     | 1/2 [00:05<00:03,  3.64s/it, CE=2.280241e+00 H=2.280194e+00 dV_dx=7.515924e-06 dV_dθ=-5.441609e-05 ||∇||=3.640774e-01 | Tr=0.1415 Te/Cur=0.1571 Te/Exp=0.1688]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.280241e+00 H=2.280194e+00 dV_dx=7.515924e-06 dV_dθ=-5.441609e-05 ||∇||=3.640774e-01 | Tr=0.1415 Te/Cur=0.1571 Te/Exp=0.1688]100%|██████████| 2/2 [00:05<00:00,  2.75s/it, CE=2.280241e+00 H=2.280194e+00 dV_dx=7.515924e-06 dV_dθ=-5.441609e-05 ||∇||=3.640774e-01 | Tr=0.1415 Te/Cur=0.1571 Te/Exp=0.1688]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.65s/it] 50%|█████     | 1/2 [00:05<00:03,  3.65s/it, CE=2.281143e+00 H=2.281063e+00 dV_dx=-9.928748e-08 dV_dθ=-8.016803e-05 ||∇||=3.434211e-01 | Tr=0.1032 Te/Cur=0.0977 Te/Exp=0.1783]100%|██████████| 2/2 [00:05<00:00,  2.40s/it, CE=2.281143e+00 H=2.281063e+00 dV_dx=-9.928748e-08 dV_dθ=-8.016803e-05 ||∇||=3.434211e-01 | Tr=0.1032 Te/Cur=0.0977 Te/Exp=0.1783]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.281143e+00 H=2.281063e+00 dV_dx=-9.928748e-08 dV_dθ=-8.016803e-05 ||∇||=3.434211e-01 | Tr=0.1032 Te/Cur=0.0977 Te/Exp=0.1783]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.86s/it] 50%|█████     | 1/2 [00:10<00:08,  8.86s/it, CE=2.265597e+00 H=2.265575e+00 dV_dx=6.443480e-06 dV_dθ=-2.806531e-05 ||∇||=3.425213e-01 | Tr=0.1553 Te/Cur=0.1314 Te/Exp=0.2369]100%|██████████| 2/2 [00:10<00:00,  4.80s/it, CE=2.265597e+00 H=2.265575e+00 dV_dx=6.443480e-06 dV_dθ=-2.806531e-05 ||∇||=3.425213e-01 | Tr=0.1553 Te/Cur=0.1314 Te/Exp=0.2369]100%|██████████| 2/2 [00:10<00:00,  5.41s/it, CE=2.265597e+00 H=2.265575e+00 dV_dx=6.443480e-06 dV_dθ=-2.806531e-05 ||∇||=3.425213e-01 | Tr=0.1553 Te/Cur=0.1314 Te/Exp=0.2369]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 204, 10]) with loss 2.265597
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.34s/it] 50%|█████     | 1/2 [00:05<00:03,  3.34s/it, CE=2.265673e+00 H=2.265593e+00 dV_dx=-6.108617e-06 dV_dθ=-7.383241e-05 ||∇||=3.836453e-01 | Tr=0.1465 Te/Cur=0.1564 Te/Exp=0.1846]100%|██████████| 2/2 [00:05<00:00,  2.45s/it, CE=2.265673e+00 H=2.265593e+00 dV_dx=-6.108617e-06 dV_dθ=-7.383241e-05 ||∇||=3.836453e-01 | Tr=0.1465 Te/Cur=0.1564 Te/Exp=0.1846]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.265673e+00 H=2.265593e+00 dV_dx=-6.108617e-06 dV_dθ=-7.383241e-05 ||∇||=3.836453e-01 | Tr=0.1465 Te/Cur=0.1564 Te/Exp=0.1846]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.57s/it] 50%|█████     | 1/2 [00:05<00:03,  3.57s/it, CE=2.280585e+00 H=2.280572e+00 dV_dx=1.030551e-06 dV_dθ=-1.399854e-05 ||∇||=3.712907e-01 | Tr=0.1376 Te/Cur=0.1424 Te/Exp=0.1688]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.280585e+00 H=2.280572e+00 dV_dx=1.030551e-06 dV_dθ=-1.399854e-05 ||∇||=3.712907e-01 | Tr=0.1376 Te/Cur=0.1424 Te/Exp=0.1688]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.280585e+00 H=2.280572e+00 dV_dx=1.030551e-06 dV_dθ=-1.399854e-05 ||∇||=3.712907e-01 | Tr=0.1376 Te/Cur=0.1424 Te/Exp=0.1688]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.10s/it] 50%|█████     | 1/2 [00:15<00:13, 13.10s/it, CE=2.272560e+00 H=2.272544e+00 dV_dx=5.664135e-06 dV_dθ=-2.095525e-05 ||∇||=3.303586e-01 | Tr=0.2066 Te/Cur=0.2236 Te/Exp=0.2197]100%|██████████| 2/2 [00:15<00:00,  6.67s/it, CE=2.272560e+00 H=2.272544e+00 dV_dx=5.664135e-06 dV_dθ=-2.095525e-05 ||∇||=3.303586e-01 | Tr=0.2066 Te/Cur=0.2236 Te/Exp=0.2197]100%|██████████| 2/2 [00:15<00:00,  7.63s/it, CE=2.272560e+00 H=2.272544e+00 dV_dx=5.664135e-06 dV_dθ=-2.095525e-05 ||∇||=3.303586e-01 | Tr=0.2066 Te/Cur=0.2236 Te/Exp=0.2197]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.98s/it] 50%|█████     | 1/2 [00:10<00:08,  8.98s/it, CE=2.273794e+00 H=2.273777e+00 dV_dx=1.256809e-05 dV_dθ=-2.991783e-05 ||∇||=3.714908e-01 | Tr=0.1372 Te/Cur=0.1378 Te/Exp=0.2263]100%|██████████| 2/2 [00:10<00:00,  4.86s/it, CE=2.273794e+00 H=2.273777e+00 dV_dx=1.256809e-05 dV_dθ=-2.991783e-05 ||∇||=3.714908e-01 | Tr=0.1372 Te/Cur=0.1378 Te/Exp=0.2263]100%|██████████| 2/2 [00:10<00:00,  5.48s/it, CE=2.273794e+00 H=2.273777e+00 dV_dx=1.256809e-05 dV_dθ=-2.991783e-05 ||∇||=3.714908e-01 | Tr=0.1372 Te/Cur=0.1378 Te/Exp=0.2263]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.20s/it] 50%|█████     | 1/2 [00:10<00:09,  9.20s/it, CE=2.275669e+00 H=2.275602e+00 dV_dx=2.797938e-06 dV_dθ=-7.011516e-05 ||∇||=3.519590e-01 | Tr=0.1058 Te/Cur=0.1104 Te/Exp=0.2265]100%|██████████| 2/2 [00:10<00:00,  4.63s/it, CE=2.275669e+00 H=2.275602e+00 dV_dx=2.797938e-06 dV_dθ=-7.011516e-05 ||∇||=3.519590e-01 | Tr=0.1058 Te/Cur=0.1104 Te/Exp=0.2265]100%|██████████| 2/2 [00:10<00:00,  5.32s/it, CE=2.275669e+00 H=2.275602e+00 dV_dx=2.797938e-06 dV_dθ=-7.011516e-05 ||∇||=3.519590e-01 | Tr=0.1058 Te/Cur=0.1104 Te/Exp=0.2265]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.31s/it] 50%|█████     | 1/2 [00:11<00:09,  9.31s/it, CE=2.230260e+00 H=2.230225e+00 dV_dx=1.409595e-05 dV_dθ=-4.872924e-05 ||∇||=4.527868e-01 | Tr=0.1609 Te/Cur=0.1696 Te/Exp=0.2927]100%|██████████| 2/2 [00:11<00:00,  4.99s/it, CE=2.230260e+00 H=2.230225e+00 dV_dx=1.409595e-05 dV_dθ=-4.872924e-05 ||∇||=4.527868e-01 | Tr=0.1609 Te/Cur=0.1696 Te/Exp=0.2927]100%|██████████| 2/2 [00:11<00:00,  5.64s/it, CE=2.230260e+00 H=2.230225e+00 dV_dx=1.409595e-05 dV_dθ=-4.872924e-05 ||∇||=4.527868e-01 | Tr=0.1609 Te/Cur=0.1696 Te/Exp=0.2927]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 512, 164, 10]) with loss 2.230260
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.62s/it] 50%|█████     | 1/2 [00:05<00:03,  3.62s/it, CE=2.219927e+00 H=2.219835e+00 dV_dx=1.415189e-05 dV_dθ=-1.062836e-04 ||∇||=5.188752e-01 | Tr=0.1014 Te/Cur=0.1108 Te/Exp=0.3426]100%|██████████| 2/2 [00:05<00:00,  2.62s/it, CE=2.219927e+00 H=2.219835e+00 dV_dx=1.415189e-05 dV_dθ=-1.062836e-04 ||∇||=5.188752e-01 | Tr=0.1014 Te/Cur=0.1108 Te/Exp=0.3426]100%|██████████| 2/2 [00:05<00:00,  2.77s/it, CE=2.219927e+00 H=2.219835e+00 dV_dx=1.415189e-05 dV_dθ=-1.062836e-04 ||∇||=5.188752e-01 | Tr=0.1014 Te/Cur=0.1108 Te/Exp=0.3426]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 552, 164, 10]) with loss 2.219927
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.78s/it] 50%|█████     | 1/2 [00:05<00:03,  3.78s/it, CE=2.227941e+00 H=2.227848e+00 dV_dx=-1.892377e-05 dV_dθ=-7.495901e-05 ||∇||=5.303008e-01 | Tr=0.1010 Te/Cur=0.1375 Te/Exp=0.3229]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.227941e+00 H=2.227848e+00 dV_dx=-1.892377e-05 dV_dθ=-7.495901e-05 ||∇||=5.303008e-01 | Tr=0.1010 Te/Cur=0.1375 Te/Exp=0.3229]100%|██████████| 2/2 [00:05<00:00,  2.82s/it, CE=2.227941e+00 H=2.227848e+00 dV_dx=-1.892377e-05 dV_dθ=-7.495901e-05 ||∇||=5.303008e-01 | Tr=0.1010 Te/Cur=0.1375 Te/Exp=0.3229]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.94s/it] 50%|█████     | 1/2 [00:11<00:09,  9.94s/it, CE=2.197135e+00 H=2.197049e+00 dV_dx=-4.876811e-06 dV_dθ=-8.151974e-05 ||∇||=4.805970e-01 | Tr=0.1228 Te/Cur=0.1567 Te/Exp=0.3016]100%|██████████| 2/2 [00:11<00:00,  5.15s/it, CE=2.197135e+00 H=2.197049e+00 dV_dx=-4.876811e-06 dV_dθ=-8.151974e-05 ||∇||=4.805970e-01 | Tr=0.1228 Te/Cur=0.1567 Te/Exp=0.3016]100%|██████████| 2/2 [00:11<00:00,  5.87s/it, CE=2.197135e+00 H=2.197049e+00 dV_dx=-4.876811e-06 dV_dθ=-8.151974e-05 ||∇||=4.805970e-01 | Tr=0.1228 Te/Cur=0.1567 Te/Exp=0.3016]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 512, 204, 10]) with loss 2.197135
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.79s/it] 50%|█████     | 1/2 [00:07<00:03,  3.79s/it, CE=2.201363e+00 H=2.201295e+00 dV_dx=-3.051585e-06 dV_dθ=-6.477874e-05 ||∇||=4.798869e-01 | Tr=0.2108 Te/Cur=0.2269 Te/Exp=0.3230]100%|██████████| 2/2 [00:07<00:00,  4.04s/it, CE=2.201363e+00 H=2.201295e+00 dV_dx=-3.051585e-06 dV_dθ=-6.477874e-05 ||∇||=4.798869e-01 | Tr=0.2108 Te/Cur=0.2269 Te/Exp=0.3230]100%|██████████| 2/2 [00:07<00:00,  4.00s/it, CE=2.201363e+00 H=2.201295e+00 dV_dx=-3.051585e-06 dV_dθ=-6.477874e-05 ||∇||=4.798869e-01 | Tr=0.2108 Te/Cur=0.2269 Te/Exp=0.3230]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.41s/it] 50%|█████     | 1/2 [00:05<00:03,  3.41s/it, CE=2.224633e+00 H=2.224581e+00 dV_dx=8.008951e-06 dV_dθ=-5.999719e-05 ||∇||=4.955391e-01 | Tr=0.1361 Te/Cur=0.1994 Te/Exp=0.2788]100%|██████████| 2/2 [00:05<00:00,  2.42s/it, CE=2.224633e+00 H=2.224581e+00 dV_dx=8.008951e-06 dV_dθ=-5.999719e-05 ||∇||=4.955391e-01 | Tr=0.1361 Te/Cur=0.1994 Te/Exp=0.2788]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.224633e+00 H=2.224581e+00 dV_dx=8.008951e-06 dV_dθ=-5.999719e-05 ||∇||=4.955391e-01 | Tr=0.1361 Te/Cur=0.1994 Te/Exp=0.2788]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.61s/it] 50%|█████     | 1/2 [00:10<00:08,  8.61s/it, CE=2.222973e+00 H=2.222922e+00 dV_dx=3.191156e-07 dV_dθ=-5.114820e-05 ||∇||=4.582782e-01 | Tr=0.1460 Te/Cur=0.1799 Te/Exp=0.3054]100%|██████████| 2/2 [00:10<00:00,  4.46s/it, CE=2.222973e+00 H=2.222922e+00 dV_dx=3.191156e-07 dV_dθ=-5.114820e-05 ||∇||=4.582782e-01 | Tr=0.1460 Te/Cur=0.1799 Te/Exp=0.3054]100%|██████████| 2/2 [00:10<00:00,  5.08s/it, CE=2.222973e+00 H=2.222922e+00 dV_dx=3.191156e-07 dV_dθ=-5.114820e-05 ||∇||=4.582782e-01 | Tr=0.1460 Te/Cur=0.1799 Te/Exp=0.3054]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.29s/it] 50%|█████     | 1/2 [00:11<00:09,  9.29s/it, CE=2.216638e+00 H=2.216550e+00 dV_dx=-9.826181e-06 dV_dθ=-7.779894e-05 ||∇||=4.994163e-01 | Tr=0.2054 Te/Cur=0.2225 Te/Exp=0.3072]100%|██████████| 2/2 [00:11<00:00,  4.88s/it, CE=2.216638e+00 H=2.216550e+00 dV_dx=-9.826181e-06 dV_dθ=-7.779894e-05 ||∇||=4.994163e-01 | Tr=0.2054 Te/Cur=0.2225 Te/Exp=0.3072]100%|██████████| 2/2 [00:11<00:00,  5.54s/it, CE=2.216638e+00 H=2.216550e+00 dV_dx=-9.826181e-06 dV_dθ=-7.779894e-05 ||∇||=4.994163e-01 | Tr=0.2054 Te/Cur=0.2225 Te/Exp=0.3072]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.23s/it] 50%|█████     | 1/2 [00:10<00:08,  8.23s/it, CE=2.219984e+00 H=2.219900e+00 dV_dx=-2.677415e-08 dV_dθ=-8.403549e-05 ||∇||=4.921475e-01 | Tr=0.1406 Te/Cur=0.1899 Te/Exp=0.3313]100%|██████████| 2/2 [00:10<00:00,  4.51s/it, CE=2.219984e+00 H=2.219900e+00 dV_dx=-2.677415e-08 dV_dθ=-8.403549e-05 ||∇||=4.921475e-01 | Tr=0.1406 Te/Cur=0.1899 Te/Exp=0.3313]100%|██████████| 2/2 [00:10<00:00,  5.06s/it, CE=2.219984e+00 H=2.219900e+00 dV_dx=-2.677415e-08 dV_dθ=-8.403549e-05 ||∇||=4.921475e-01 | Tr=0.1406 Te/Cur=0.1899 Te/Exp=0.3313]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.88s/it] 50%|█████     | 1/2 [00:10<00:08,  8.88s/it, CE=2.243645e+00 H=2.243572e+00 dV_dx=2.696145e-06 dV_dθ=-7.498118e-05 ||∇||=4.103555e-01 | Tr=0.1036 Te/Cur=0.1007 Te/Exp=0.2730]100%|██████████| 2/2 [00:10<00:00,  4.85s/it, CE=2.243645e+00 H=2.243572e+00 dV_dx=2.696145e-06 dV_dθ=-7.498118e-05 ||∇||=4.103555e-01 | Tr=0.1036 Te/Cur=0.1007 Te/Exp=0.2730]100%|██████████| 2/2 [00:10<00:00,  5.46s/it, CE=2.243645e+00 H=2.243572e+00 dV_dx=2.696145e-06 dV_dθ=-7.498118e-05 ||∇||=4.103555e-01 | Tr=0.1036 Te/Cur=0.1007 Te/Exp=0.2730]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.45s/it] 50%|█████     | 1/2 [00:06<00:04,  4.45s/it, CE=2.243431e+00 H=2.243334e+00 dV_dx=1.289568e-05 dV_dθ=-1.098356e-04 ||∇||=4.577268e-01 | Tr=0.1341 Te/Cur=0.1455 Te/Exp=0.2493]100%|██████████| 2/2 [00:06<00:00,  3.21s/it, CE=2.243431e+00 H=2.243334e+00 dV_dx=1.289568e-05 dV_dθ=-1.098356e-04 ||∇||=4.577268e-01 | Tr=0.1341 Te/Cur=0.1455 Te/Exp=0.2493]100%|██████████| 2/2 [00:06<00:00,  3.40s/it, CE=2.243431e+00 H=2.243334e+00 dV_dx=1.289568e-05 dV_dθ=-1.098356e-04 ||∇||=4.577268e-01 | Tr=0.1341 Te/Cur=0.1455 Te/Exp=0.2493]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.44s/it] 50%|█████     | 1/2 [00:05<00:03,  3.44s/it, CE=2.245010e+00 H=2.244898e+00 dV_dx=-4.663380e-07 dV_dθ=-1.114509e-04 ||∇||=4.245514e-01 | Tr=0.1481 Te/Cur=0.1493 Te/Exp=0.2495]100%|██████████| 2/2 [00:05<00:00,  2.47s/it, CE=2.245010e+00 H=2.244898e+00 dV_dx=-4.663380e-07 dV_dθ=-1.114509e-04 ||∇||=4.245514e-01 | Tr=0.1481 Te/Cur=0.1493 Te/Exp=0.2495]100%|██████████| 2/2 [00:05<00:00,  2.62s/it, CE=2.245010e+00 H=2.244898e+00 dV_dx=-4.663380e-07 dV_dθ=-1.114509e-04 ||∇||=4.245514e-01 | Tr=0.1481 Te/Cur=0.1493 Te/Exp=0.2495]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.78s/it] 50%|█████     | 1/2 [00:11<00:09,  9.78s/it, CE=2.234110e+00 H=2.234035e+00 dV_dx=1.709957e-05 dV_dθ=-9.184320e-05 ||∇||=4.337233e-01 | Tr=0.1114 Te/Cur=0.1114 Te/Exp=0.2584]100%|██████████| 2/2 [00:11<00:00,  4.89s/it, CE=2.234110e+00 H=2.234035e+00 dV_dx=1.709957e-05 dV_dθ=-9.184320e-05 ||∇||=4.337233e-01 | Tr=0.1114 Te/Cur=0.1114 Te/Exp=0.2584]100%|██████████| 2/2 [00:11<00:00,  5.62s/it, CE=2.234110e+00 H=2.234035e+00 dV_dx=1.709957e-05 dV_dθ=-9.184320e-05 ||∇||=4.337233e-01 | Tr=0.1114 Te/Cur=0.1114 Te/Exp=0.2584]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.95s/it] 50%|█████     | 1/2 [00:04<00:02,  2.95s/it, CE=2.220528e+00 H=2.220436e+00 dV_dx=9.948710e-06 dV_dθ=-1.019121e-04 ||∇||=4.684588e-01 | Tr=0.1923 Te/Cur=0.2300 Te/Exp=0.2759]100%|██████████| 2/2 [00:04<00:00,  2.17s/it, CE=2.220528e+00 H=2.220436e+00 dV_dx=9.948710e-06 dV_dθ=-1.019121e-04 ||∇||=4.684588e-01 | Tr=0.1923 Te/Cur=0.2300 Te/Exp=0.2759]100%|██████████| 2/2 [00:04<00:00,  2.29s/it, CE=2.220528e+00 H=2.220436e+00 dV_dx=9.948710e-06 dV_dθ=-1.019121e-04 ||∇||=4.684588e-01 | Tr=0.1923 Te/Cur=0.2300 Te/Exp=0.2759]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.83s/it] 50%|█████     | 1/2 [00:04<00:02,  2.83s/it, CE=2.252103e+00 H=2.252010e+00 dV_dx=-1.494925e-05 dV_dθ=-7.827408e-05 ||∇||=4.335903e-01 | Tr=0.1813 Te/Cur=0.2270 Te/Exp=0.2299]100%|██████████| 2/2 [00:04<00:00,  2.06s/it, CE=2.252103e+00 H=2.252010e+00 dV_dx=-1.494925e-05 dV_dθ=-7.827408e-05 ||∇||=4.335903e-01 | Tr=0.1813 Te/Cur=0.2270 Te/Exp=0.2299]100%|██████████| 2/2 [00:04<00:00,  2.18s/it, CE=2.252103e+00 H=2.252010e+00 dV_dx=-1.494925e-05 dV_dθ=-7.827408e-05 ||∇||=4.335903e-01 | Tr=0.1813 Te/Cur=0.2270 Te/Exp=0.2299]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.43s/it] 50%|█████     | 1/2 [00:09<00:07,  7.43s/it, CE=2.256819e+00 H=2.256686e+00 dV_dx=-7.927310e-06 dV_dθ=-1.257183e-04 ||∇||=4.151437e-01 | Tr=0.1088 Te/Cur=0.1109 Te/Exp=0.2438]100%|██████████| 2/2 [00:09<00:00,  4.05s/it, CE=2.256819e+00 H=2.256686e+00 dV_dx=-7.927310e-06 dV_dθ=-1.257183e-04 ||∇||=4.151437e-01 | Tr=0.1088 Te/Cur=0.1109 Te/Exp=0.2438]100%|██████████| 2/2 [00:09<00:00,  4.55s/it, CE=2.256819e+00 H=2.256686e+00 dV_dx=-7.927310e-06 dV_dθ=-1.257183e-04 ||∇||=4.151437e-01 | Tr=0.1088 Te/Cur=0.1109 Te/Exp=0.2438]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.38s/it] 50%|█████     | 1/2 [00:09<00:08,  8.38s/it, CE=2.248407e+00 H=2.248310e+00 dV_dx=-7.798509e-06 dV_dθ=-8.943689e-05 ||∇||=4.363309e-01 | Tr=0.1488 Te/Cur=0.1617 Te/Exp=0.2622]100%|██████████| 2/2 [00:09<00:00,  4.35s/it, CE=2.248407e+00 H=2.248310e+00 dV_dx=-7.798509e-06 dV_dθ=-8.943689e-05 ||∇||=4.363309e-01 | Tr=0.1488 Te/Cur=0.1617 Te/Exp=0.2622]100%|██████████| 2/2 [00:09<00:00,  4.95s/it, CE=2.248407e+00 H=2.248310e+00 dV_dx=-7.798509e-06 dV_dθ=-8.943689e-05 ||∇||=4.363309e-01 | Tr=0.1488 Te/Cur=0.1617 Te/Exp=0.2622]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.14s/it] 50%|█████     | 1/2 [00:08<00:07,  7.14s/it, CE=2.236421e+00 H=2.236351e+00 dV_dx=7.506070e-06 dV_dθ=-7.744990e-05 ||∇||=4.454092e-01 | Tr=0.1502 Te/Cur=0.2138 Te/Exp=0.3134]100%|██████████| 2/2 [00:08<00:00,  3.94s/it, CE=2.236421e+00 H=2.236351e+00 dV_dx=7.506070e-06 dV_dθ=-7.744990e-05 ||∇||=4.454092e-01 | Tr=0.1502 Te/Cur=0.2138 Te/Exp=0.3134]100%|██████████| 2/2 [00:08<00:00,  4.42s/it, CE=2.236421e+00 H=2.236351e+00 dV_dx=7.506070e-06 dV_dθ=-7.744990e-05 ||∇||=4.454092e-01 | Tr=0.1502 Te/Cur=0.2138 Te/Exp=0.3134]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (3, [507, 512, 204, 10]) with loss 2.197135
  Total candidates evaluated: 54
  Original: (2, [507, 552, 204, 10])
  Optimal: (3, [507, 512, 204, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→3, feed [507, 552, 204, 10]→[507, 512, 204, 10]
  Conv filter changed: A_conv/B_conv shape = (3, 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:17<05:34, 17.62s/it]  5%|▌         | 1/20 [00:19<05:34, 17.62s/it, CE=2.154575e+00 H=2.156576e+00 dV_dx=-1.270487e-04 dV_dθ=2.128187e-03 ||∇||=5.958369e+00 | Tr=0.7543] 10%|█         | 2/20 [00:19<02:35,  8.61s/it, CE=2.154575e+00 H=2.156576e+00 dV_dx=-1.270487e-04 dV_dθ=2.128187e-03 ||∇||=5.958369e+00 | Tr=0.7543] 10%|█         | 2/20 [00:22<02:35,  8.61s/it, CE=1.816871e+00 H=1.801024e+00 dV_dx=5.716360e-05 dV_dθ=-1.590456e-02 ||∇||=6.331129e+00 | Tr=0.7543] 15%|█▌        | 3/20 [00:22<01:37,  5.75s/it, CE=1.816871e+00 H=1.801024e+00 dV_dx=5.716360e-05 dV_dθ=-1.590456e-02 ||∇||=6.331129e+00 | Tr=0.7543] 15%|█▌        | 3/20 [00:24<01:37,  5.75s/it, CE=1.612615e+00 H=1.587744e+00 dV_dx=-2.022218e-05 dV_dθ=-2.485092e-02 ||∇||=6.528669e+00 | Tr=0.7543] 20%|██        | 4/20 [00:24<01:11,  4.45s/it, CE=1.612615e+00 H=1.587744e+00 dV_dx=-2.022218e-05 dV_dθ=-2.485092e-02 ||∇||=6.528669e+00 | Tr=0.7543] 20%|██        | 4/20 [00:26<01:11,  4.45s/it, CE=1.469437e+00 H=1.378490e+00 dV_dx=8.734064e-05 dV_dθ=-9.103428e-02 ||∇||=9.268554e+00 | Tr=0.7543]  25%|██▌       | 5/20 [00:26<00:53,  3.56s/it, CE=1.469437e+00 H=1.378490e+00 dV_dx=8.734064e-05 dV_dθ=-9.103428e-02 ||∇||=9.268554e+00 | Tr=0.7543] 25%|██▌       | 5/20 [00:28<00:53,  3.56s/it, CE=1.364341e+00 H=1.202359e+00 dV_dx=-2.131515e-04 dV_dθ=-1.617686e-01 ||∇||=1.160275e+01 | Tr=0.7543] 30%|███       | 6/20 [00:28<00:43,  3.12s/it, CE=1.364341e+00 H=1.202359e+00 dV_dx=-2.131515e-04 dV_dθ=-1.617686e-01 ||∇||=1.160275e+01 | Tr=0.7543] 30%|███       | 6/20 [00:31<00:43,  3.12s/it, CE=1.280652e+00 H=1.070210e+00 dV_dx=1.805323e-04 dV_dθ=-2.106221e-01 ||∇||=1.298736e+01 | Tr=0.7543]  35%|███▌      | 7/20 [00:31<00:37,  2.88s/it, CE=1.280652e+00 H=1.070210e+00 dV_dx=1.805323e-04 dV_dθ=-2.106221e-01 ||∇||=1.298736e+01 | Tr=0.7543] 35%|███▌      | 7/20 [00:33<00:37,  2.88s/it, CE=1.209826e+00 H=9.823424e-01 dV_dx=8.943654e-05 dV_dθ=-2.275728e-01 ||∇||=1.332238e+01 | Tr=0.7543] 40%|████      | 8/20 [00:33<00:33,  2.75s/it, CE=1.209826e+00 H=9.823424e-01 dV_dx=8.943654e-05 dV_dθ=-2.275728e-01 ||∇||=1.332238e+01 | Tr=0.7543] 40%|████      | 8/20 [00:35<00:33,  2.75s/it, CE=1.149215e+00 H=9.159936e-01 dV_dx=-8.494463e-06 dV_dθ=-2.332130e-01 ||∇||=1.331623e+01 | Tr=0.7543] 45%|████▌     | 9/20 [00:35<00:27,  2.54s/it, CE=1.149215e+00 H=9.159936e-01 dV_dx=-8.494463e-06 dV_dθ=-2.332130e-01 ||∇||=1.331623e+01 | Tr=0.7543] 45%|████▌     | 9/20 [00:38<00:27,  2.54s/it, CE=1.094527e+00 H=8.829227e-01 dV_dx=1.068217e-04 dV_dθ=-2.117108e-01 ||∇||=1.247637e+01 | Tr=0.7543]  50%|█████     | 10/20 [00:38<00:25,  2.51s/it, CE=1.094527e+00 H=8.829227e-01 dV_dx=1.068217e-04 dV_dθ=-2.117108e-01 ||∇||=1.247637e+01 | Tr=0.7543] 50%|█████     | 10/20 [00:40<00:25,  2.51s/it, CE=1.045832e+00 H=8.595493e-01 dV_dx=2.621533e-05 dV_dθ=-1.863091e-01 ||∇||=1.165956e+01 | Tr=0.7543] 55%|█████▌    | 11/20 [00:40<00:22,  2.51s/it, CE=1.045832e+00 H=8.595493e-01 dV_dx=2.621533e-05 dV_dθ=-1.863091e-01 ||∇||=1.165956e+01 | Tr=0.7543] 55%|█████▌    | 11/20 [00:43<00:22,  2.51s/it, CE=1.002251e+00 H=8.381787e-01 dV_dx=2.786410e-05 dV_dθ=-1.640998e-01 ||∇||=1.094769e+01 | Tr=0.7543] 60%|██████    | 12/20 [00:43<00:20,  2.60s/it, CE=1.002251e+00 H=8.381787e-01 dV_dx=2.786410e-05 dV_dθ=-1.640998e-01 ||∇||=1.094769e+01 | Tr=0.7543] 60%|██████    | 12/20 [00:45<00:20,  2.60s/it, CE=9.646686e-01 H=8.212501e-01 dV_dx=-1.421446e-04 dV_dθ=-1.432764e-01 ||∇||=1.029846e+01 | Tr=0.7543] 65%|██████▌   | 13/20 [00:45<00:17,  2.44s/it, CE=9.646686e-01 H=8.212501e-01 dV_dx=-1.421446e-04 dV_dθ=-1.432764e-01 ||∇||=1.029846e+01 | Tr=0.7543] 65%|██████▌   | 13/20 [00:48<00:17,  2.44s/it, CE=9.301033e-01 H=7.983275e-01 dV_dx=-7.273891e-05 dV_dθ=-1.317031e-01 ||∇||=9.884088e+00 | Tr=0.7543] 70%|███████   | 14/20 [00:48<00:14,  2.46s/it, CE=9.301033e-01 H=7.983275e-01 dV_dx=-7.273891e-05 dV_dθ=-1.317031e-01 ||∇||=9.884088e+00 | Tr=0.7543] 70%|███████   | 14/20 [00:50<00:14,  2.46s/it, CE=8.997708e-01 H=7.685736e-01 dV_dx=-6.706020e-05 dV_dθ=-1.311301e-01 ||∇||=9.869381e+00 | Tr=0.7543] 75%|███████▌  | 15/20 [00:50<00:11,  2.39s/it, CE=8.997708e-01 H=7.685736e-01 dV_dx=-6.706020e-05 dV_dθ=-1.311301e-01 ||∇||=9.869381e+00 | Tr=0.7543] 75%|███████▌  | 15/20 [00:52<00:11,  2.39s/it, CE=8.720009e-01 H=7.393276e-01 dV_dx=6.518245e-05 dV_dθ=-1.327385e-01 ||∇||=9.939031e+00 | Tr=0.7543]  80%|████████  | 16/20 [00:52<00:09,  2.43s/it, CE=8.720009e-01 H=7.393276e-01 dV_dx=6.518245e-05 dV_dθ=-1.327385e-01 ||∇||=9.939031e+00 | Tr=0.7543] 80%|████████  | 16/20 [00:55<00:09,  2.43s/it, CE=8.457583e-01 H=7.249881e-01 dV_dx=8.472384e-06 dV_dθ=-1.207787e-01 ||∇||=9.616073e+00 | Tr=0.7543] 85%|████████▌ | 17/20 [00:55<00:07,  2.44s/it, CE=8.457583e-01 H=7.249881e-01 dV_dx=8.472384e-06 dV_dθ=-1.207787e-01 ||∇||=9.616073e+00 | Tr=0.7543] 85%|████████▌ | 17/20 [00:57<00:07,  2.44s/it, CE=8.217625e-01 H=7.086793e-01 dV_dx=6.008917e-05 dV_dθ=-1.131433e-01 ||∇||=9.365885e+00 | Tr=0.7543] 90%|█████████ | 18/20 [00:57<00:04,  2.45s/it, CE=8.217625e-01 H=7.086793e-01 dV_dx=6.008917e-05 dV_dθ=-1.131433e-01 ||∇||=9.365885e+00 | Tr=0.7543] 90%|█████████ | 18/20 [01:00<00:04,  2.45s/it, CE=7.995613e-01 H=6.933120e-01 dV_dx=5.946176e-05 dV_dθ=-1.063087e-01 ||∇||=9.114314e+00 | Tr=0.7543] 95%|█████████▌| 19/20 [01:00<00:02,  2.36s/it, CE=7.995613e-01 H=6.933120e-01 dV_dx=5.946176e-05 dV_dθ=-1.063087e-01 ||∇||=9.114314e+00 | Tr=0.7543] 95%|█████████▌| 19/20 [01:06<00:02,  2.36s/it, CE=7.788257e-01 H=6.829924e-01 dV_dx=3.622805e-05 dV_dθ=-9.586954e-02 ||∇||=8.746344e+00 | Tr=0.7543 Te/Cur=0.9170 Te/Exp=0.7199]100%|██████████| 20/20 [01:12<00:00,  5.26s/it, CE=7.788257e-01 H=6.829924e-01 dV_dx=3.622805e-05 dV_dθ=-9.586954e-02 ||∇||=8.746344e+00 | Tr=0.7543 Te/Cur=0.9170 Te/Exp=0.7199]100%|██████████| 20/20 [01:12<00:00,  3.61s/it, CE=7.788257e-01 H=6.829924e-01 dV_dx=3.622805e-05 dV_dθ=-9.586954e-02 ||∇||=8.746344e+00 | Tr=0.7543 Te/Cur=0.9170 Te/Exp=0.7199]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.658932
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<02:09,  6.82s/it]  5%|▌         | 1/20 [00:09<02:09,  6.82s/it, CE=7.948545e-01 H=6.080514e-01 dV_dx=-5.138715e-05 dV_dθ=-1.867517e-01 ||∇||=1.220054e+01 | Tr=0.7542] 10%|█         | 2/20 [00:09<01:15,  4.21s/it, CE=7.948545e-01 H=6.080514e-01 dV_dx=-5.138715e-05 dV_dθ=-1.867517e-01 ||∇||=1.220054e+01 | Tr=0.7542] 10%|█         | 2/20 [00:12<01:15,  4.21s/it, CE=7.712096e-01 H=5.768071e-01 dV_dx=7.175533e-06 dV_dθ=-1.944097e-01 ||∇||=1.203416e+01 | Tr=0.7542]  15%|█▌        | 3/20 [00:12<01:01,  3.61s/it, CE=7.712096e-01 H=5.768071e-01 dV_dx=7.175533e-06 dV_dθ=-1.944097e-01 ||∇||=1.203416e+01 | Tr=0.7542] 15%|█▌        | 3/20 [00:14<01:01,  3.61s/it, CE=7.503137e-01 H=5.916865e-01 dV_dx=5.874951e-06 dV_dθ=-1.586331e-01 ||∇||=1.102389e+01 | Tr=0.7542] 20%|██        | 4/20 [00:14<00:50,  3.16s/it, CE=7.503137e-01 H=5.916865e-01 dV_dx=5.874951e-06 dV_dθ=-1.586331e-01 ||∇||=1.102389e+01 | Tr=0.7542] 20%|██        | 4/20 [00:16<00:50,  3.16s/it, CE=7.299274e-01 H=6.137625e-01 dV_dx=-6.142016e-05 dV_dθ=-1.161035e-01 ||∇||=9.680956e+00 | Tr=0.7542] 25%|██▌       | 5/20 [00:16<00:42,  2.83s/it, CE=7.299274e-01 H=6.137625e-01 dV_dx=-6.142016e-05 dV_dθ=-1.161035e-01 ||∇||=9.680956e+00 | Tr=0.7542] 25%|██▌       | 5/20 [00:19<00:42,  2.83s/it, CE=7.121504e-01 H=6.163838e-01 dV_dx=-1.345584e-04 dV_dθ=-9.563204e-02 ||∇||=8.946634e+00 | Tr=0.7542] 30%|███       | 6/20 [00:19<00:36,  2.61s/it, CE=7.121504e-01 H=6.163838e-01 dV_dx=-1.345584e-04 dV_dθ=-9.563204e-02 ||∇||=8.946634e+00 | Tr=0.7542] 30%|███       | 6/20 [00:21<00:36,  2.61s/it, CE=6.966617e-01 H=6.164775e-01 dV_dx=6.043592e-06 dV_dθ=-8.019029e-02 ||∇||=8.371671e+00 | Tr=0.7542]  35%|███▌      | 7/20 [00:21<00:33,  2.60s/it, CE=6.966617e-01 H=6.164775e-01 dV_dx=6.043592e-06 dV_dθ=-8.019029e-02 ||∇||=8.371671e+00 | Tr=0.7542] 35%|███▌      | 7/20 [00:24<00:33,  2.60s/it, CE=6.817875e-01 H=6.093846e-01 dV_dx=-9.156807e-05 dV_dθ=-7.231134e-02 ||∇||=7.963246e+00 | Tr=0.7542] 40%|████      | 8/20 [00:24<00:31,  2.63s/it, CE=6.817875e-01 H=6.093846e-01 dV_dx=-9.156807e-05 dV_dθ=-7.231134e-02 ||∇||=7.963246e+00 | Tr=0.7542] 40%|████      | 8/20 [00:26<00:31,  2.63s/it, CE=6.678511e-01 H=6.022885e-01 dV_dx=-1.056933e-04 dV_dθ=-6.545691e-02 ||∇||=7.642566e+00 | Tr=0.7542] 45%|████▌     | 9/20 [00:26<00:28,  2.57s/it, CE=6.678511e-01 H=6.022885e-01 dV_dx=-1.056933e-04 dV_dθ=-6.545691e-02 ||∇||=7.642566e+00 | Tr=0.7542] 45%|████▌     | 9/20 [00:29<00:28,  2.57s/it, CE=6.552168e-01 H=5.961220e-01 dV_dx=3.836112e-05 dV_dθ=-5.913324e-02 ||∇||=7.367602e+00 | Tr=0.7542]  50%|█████     | 10/20 [00:29<00:26,  2.66s/it, CE=6.552168e-01 H=5.961220e-01 dV_dx=3.836112e-05 dV_dθ=-5.913324e-02 ||∇||=7.367602e+00 | Tr=0.7542] 50%|█████     | 10/20 [00:31<00:26,  2.66s/it, CE=6.428542e-01 H=5.851362e-01 dV_dx=9.641242e-05 dV_dθ=-5.781440e-02 ||∇||=7.231520e+00 | Tr=0.7542] 55%|█████▌    | 11/20 [00:31<00:22,  2.55s/it, CE=6.428542e-01 H=5.851362e-01 dV_dx=9.641242e-05 dV_dθ=-5.781440e-02 ||∇||=7.231520e+00 | Tr=0.7542] 55%|█████▌    | 11/20 [00:34<00:22,  2.55s/it, CE=6.312558e-01 H=5.778806e-01 dV_dx=-9.259145e-06 dV_dθ=-5.336596e-02 ||∇||=7.033360e+00 | Tr=0.7542] 60%|██████    | 12/20 [00:34<00:20,  2.53s/it, CE=6.312558e-01 H=5.778806e-01 dV_dx=-9.259145e-06 dV_dθ=-5.336596e-02 ||∇||=7.033360e+00 | Tr=0.7542] 60%|██████    | 12/20 [00:36<00:20,  2.53s/it, CE=6.206845e-01 H=5.699345e-01 dV_dx=-1.615315e-05 dV_dθ=-5.073381e-02 ||∇||=6.942804e+00 | Tr=0.7542] 65%|██████▌   | 13/20 [00:36<00:17,  2.48s/it, CE=6.206845e-01 H=5.699345e-01 dV_dx=-1.615315e-05 dV_dθ=-5.073381e-02 ||∇||=6.942804e+00 | Tr=0.7542] 65%|██████▌   | 13/20 [00:39<00:17,  2.48s/it, CE=6.107230e-01 H=5.619262e-01 dV_dx=6.865632e-05 dV_dθ=-4.886541e-02 ||∇||=6.836162e+00 | Tr=0.7542]  70%|███████   | 14/20 [00:39<00:14,  2.45s/it, CE=6.107230e-01 H=5.619262e-01 dV_dx=6.865632e-05 dV_dθ=-4.886541e-02 ||∇||=6.836162e+00 | Tr=0.7542] 70%|███████   | 14/20 [00:41<00:14,  2.45s/it, CE=6.006050e-01 H=5.557783e-01 dV_dx=-8.754825e-05 dV_dθ=-4.473916e-02 ||∇||=6.566854e+00 | Tr=0.7542] 75%|███████▌  | 15/20 [00:41<00:12,  2.48s/it, CE=6.006050e-01 H=5.557783e-01 dV_dx=-8.754825e-05 dV_dθ=-4.473916e-02 ||∇||=6.566854e+00 | Tr=0.7542] 75%|███████▌  | 15/20 [00:43<00:12,  2.48s/it, CE=5.918763e-01 H=5.486816e-01 dV_dx=-8.021320e-05 dV_dθ=-4.311448e-02 ||∇||=6.511809e+00 | Tr=0.7542] 80%|████████  | 16/20 [00:43<00:09,  2.43s/it, CE=5.918763e-01 H=5.486816e-01 dV_dx=-8.021320e-05 dV_dθ=-4.311448e-02 ||∇||=6.511809e+00 | Tr=0.7542] 80%|████████  | 16/20 [00:46<00:09,  2.43s/it, CE=5.828915e-01 H=5.410171e-01 dV_dx=-1.167482e-05 dV_dθ=-4.186270e-02 ||∇||=6.374136e+00 | Tr=0.7542] 85%|████████▌ | 17/20 [00:46<00:07,  2.55s/it, CE=5.828915e-01 H=5.410171e-01 dV_dx=-1.167482e-05 dV_dθ=-4.186270e-02 ||∇||=6.374136e+00 | Tr=0.7542] 85%|████████▌ | 17/20 [00:48<00:07,  2.55s/it, CE=5.748349e-01 H=5.351489e-01 dV_dx=3.102004e-06 dV_dθ=-3.968907e-02 ||∇||=6.315563e+00 | Tr=0.7542]  90%|█████████ | 18/20 [00:48<00:04,  2.45s/it, CE=5.748349e-01 H=5.351489e-01 dV_dx=3.102004e-06 dV_dθ=-3.968907e-02 ||∇||=6.315563e+00 | Tr=0.7542] 90%|█████████ | 18/20 [00:51<00:04,  2.45s/it, CE=5.668096e-01 H=5.312831e-01 dV_dx=-1.649268e-04 dV_dθ=-3.536153e-02 ||∇||=6.108328e+00 | Tr=0.7542] 95%|█████████▌| 19/20 [00:51<00:02,  2.53s/it, CE=5.668096e-01 H=5.312831e-01 dV_dx=-1.649268e-04 dV_dθ=-3.536153e-02 ||∇||=6.108328e+00 | Tr=0.7542] 95%|█████████▌| 19/20 [00:55<00:02,  2.53s/it, CE=5.591074e-01 H=5.269754e-01 dV_dx=3.678895e-05 dV_dθ=-3.216882e-02 ||∇||=5.883839e+00 | Tr=0.7542 Te/Cur=0.9506 Te/Exp=0.7817]100%|██████████| 20/20 [00:57<00:00,  3.55s/it, CE=5.591074e-01 H=5.269754e-01 dV_dx=3.678895e-05 dV_dθ=-3.216882e-02 ||∇||=5.883839e+00 | Tr=0.7542 Te/Cur=0.9506 Te/Exp=0.7817]100%|██████████| 20/20 [00:57<00:00,  2.88s/it, CE=5.591074e-01 H=5.269754e-01 dV_dx=3.678895e-05 dV_dθ=-3.216882e-02 ||∇||=5.883839e+00 | Tr=0.7542 Te/Cur=0.9506 Te/Exp=0.7817]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.86s/it] 50%|█████     | 1/2 [00:12<00:08,  8.86s/it, CE=6.048486e-01 H=6.041541e-01 dV_dx=-1.179479e-04 dV_dθ=-5.765652e-04 ||∇||=1.292850e+00 | Tr=0.9657 Te/Cur=0.9526 Te/Exp=0.7921]100%|██████████| 2/2 [00:12<00:00,  5.98s/it, CE=6.048486e-01 H=6.041541e-01 dV_dx=-1.179479e-04 dV_dθ=-5.765652e-04 ||∇||=1.292850e+00 | Tr=0.9657 Te/Cur=0.9526 Te/Exp=0.7921]100%|██████████| 2/2 [00:12<00:00,  6.41s/it, CE=6.048486e-01 H=6.041541e-01 dV_dx=-1.179479e-04 dV_dθ=-5.765652e-04 ||∇||=1.292850e+00 | Tr=0.9657 Te/Cur=0.9526 Te/Exp=0.7921]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<02:10,  6.89s/it]  5%|▌         | 1/20 [00:09<02:10,  6.89s/it, CE=5.938276e-01 H=5.928680e-01 dV_dx=-4.124532e-05 dV_dθ=-9.183076e-04 ||∇||=1.291523e+00 | Tr=0.9676] 10%|█         | 2/20 [00:09<01:15,  4.21s/it, CE=5.938276e-01 H=5.928680e-01 dV_dx=-4.124532e-05 dV_dθ=-9.183076e-04 ||∇||=1.291523e+00 | Tr=0.9676] 10%|█         | 2/20 [00:11<01:15,  4.21s/it, CE=5.820098e-01 H=5.813329e-01 dV_dx=1.306654e-04 dV_dθ=-8.075667e-04 ||∇||=1.260090e+00 | Tr=0.9688]  15%|█▌        | 3/20 [00:11<00:56,  3.35s/it, CE=5.820098e-01 H=5.813329e-01 dV_dx=1.306654e-04 dV_dθ=-8.075667e-04 ||∇||=1.260090e+00 | Tr=0.9688] 15%|█▌        | 3/20 [00:13<00:56,  3.35s/it, CE=5.719740e-01 H=5.712563e-01 dV_dx=-1.409108e-06 dV_dθ=-7.163419e-04 ||∇||=1.228583e+00 | Tr=0.9701] 20%|██        | 4/20 [00:13<00:46,  2.89s/it, CE=5.719740e-01 H=5.712563e-01 dV_dx=-1.409108e-06 dV_dθ=-7.163419e-04 ||∇||=1.228583e+00 | Tr=0.9701] 20%|██        | 4/20 [00:15<00:46,  2.89s/it, CE=5.631567e-01 H=5.625356e-01 dV_dx=9.537222e-05 dV_dθ=-7.165042e-04 ||∇||=1.220003e+00 | Tr=0.9711]  25%|██▌       | 5/20 [00:15<00:39,  2.64s/it, CE=5.631567e-01 H=5.625356e-01 dV_dx=9.537222e-05 dV_dθ=-7.165042e-04 ||∇||=1.220003e+00 | Tr=0.9711] 25%|██▌       | 5/20 [00:19<00:39,  2.64s/it, CE=5.549413e-01 H=5.544530e-01 dV_dx=1.609829e-04 dV_dθ=-6.493242e-04 ||∇||=1.193189e+00 | Tr=0.9723 Te/Cur=0.9563 Te/Exp=0.7926] 30%|███       | 6/20 [00:19<00:40,  2.91s/it, CE=5.549413e-01 H=5.544530e-01 dV_dx=1.609829e-04 dV_dθ=-6.493242e-04 ||∇||=1.193189e+00 | Tr=0.9723 Te/Cur=0.9563 Te/Exp=0.7926] 30%|███       | 6/20 [00:21<00:40,  2.91s/it, CE=5.473897e-01 H=5.466110e-01 dV_dx=-1.829316e-04 dV_dθ=-5.958135e-04 ||∇||=1.175169e+00 | Tr=0.9731]                            35%|███▌      | 7/20 [00:21<00:33,  2.56s/it, CE=5.473897e-01 H=5.466110e-01 dV_dx=-1.829316e-04 dV_dθ=-5.958135e-04 ||∇||=1.175169e+00 | Tr=0.9731] 35%|███▌      | 7/20 [00:23<00:33,  2.56s/it, CE=5.404538e-01 H=5.397389e-01 dV_dx=-1.507286e-04 dV_dθ=-5.642036e-04 ||∇||=1.158800e+00 | Tr=0.9741] 40%|████      | 8/20 [00:23<00:30,  2.52s/it, CE=5.404538e-01 H=5.397389e-01 dV_dx=-1.507286e-04 dV_dθ=-5.642036e-04 ||∇||=1.158800e+00 | Tr=0.9741] 40%|████      | 8/20 [00:25<00:30,  2.52s/it, CE=5.340027e-01 H=5.335484e-01 dV_dx=1.050370e-04 dV_dθ=-5.593573e-04 ||∇||=1.150383e+00 | Tr=0.9749]  45%|████▌     | 9/20 [00:25<00:25,  2.29s/it, CE=5.340027e-01 H=5.335484e-01 dV_dx=1.050370e-04 dV_dθ=-5.593573e-04 ||∇||=1.150383e+00 | Tr=0.9749] 45%|████▌     | 9/20 [00:27<00:25,  2.29s/it, CE=5.279101e-01 H=5.273441e-01 dV_dx=-7.312952e-06 dV_dθ=-5.586786e-04 ||∇||=1.146139e+00 | Tr=0.9758] 50%|█████     | 10/20 [00:27<00:22,  2.24s/it, CE=5.279101e-01 H=5.273441e-01 dV_dx=-7.312952e-06 dV_dθ=-5.586786e-04 ||∇||=1.146139e+00 | Tr=0.9758] 50%|█████     | 10/20 [00:30<00:22,  2.24s/it, CE=5.220168e-01 H=5.216550e-01 dV_dx=1.775054e-04 dV_dθ=-5.393404e-04 ||∇||=1.133411e+00 | Tr=0.9764 Te/Cur=0.9602 Te/Exp=0.7990] 55%|█████▌    | 11/20 [00:30<00:22,  2.53s/it, CE=5.220168e-01 H=5.216550e-01 dV_dx=1.775054e-04 dV_dθ=-5.393404e-04 ||∇||=1.133411e+00 | Tr=0.9764 Te/Cur=0.9602 Te/Exp=0.7990] 55%|█████▌    | 11/20 [00:32<00:22,  2.53s/it, CE=5.165229e-01 H=5.157925e-01 dV_dx=-1.620919e-04 dV_dθ=-5.682935e-04 ||∇||=1.135764e+00 | Tr=0.9770]                            60%|██████    | 12/20 [00:32<00:18,  2.37s/it, CE=5.165229e-01 H=5.157925e-01 dV_dx=-1.620919e-04 dV_dθ=-5.682935e-04 ||∇||=1.135764e+00 | Tr=0.9770] 60%|██████    | 12/20 [00:35<00:18,  2.37s/it, CE=5.110159e-01 H=5.105876e-01 dV_dx=1.115626e-04 dV_dθ=-5.397814e-04 ||∇||=1.118373e+00 | Tr=0.9777]  65%|██████▌   | 13/20 [00:35<00:16,  2.41s/it, CE=5.110159e-01 H=5.105876e-01 dV_dx=1.115626e-04 dV_dθ=-5.397814e-04 ||∇||=1.118373e+00 | Tr=0.9777] 65%|██████▌   | 13/20 [00:37<00:16,  2.41s/it, CE=5.058804e-01 H=5.052284e-01 dV_dx=-9.614806e-05 dV_dθ=-5.559076e-04 ||∇||=1.115086e+00 | Tr=0.9786] 70%|███████   | 14/20 [00:37<00:13,  2.29s/it, CE=5.058804e-01 H=5.052284e-01 dV_dx=-9.614806e-05 dV_dθ=-5.559076e-04 ||∇||=1.115086e+00 | Tr=0.9786] 70%|███████   | 14/20 [00:39<00:13,  2.29s/it, CE=5.010000e-01 H=5.004520e-01 dV_dx=2.352104e-05 dV_dθ=-5.714751e-04 ||∇||=1.115210e+00 | Tr=0.9789]  75%|███████▌  | 15/20 [00:39<00:11,  2.35s/it, CE=5.010000e-01 H=5.004520e-01 dV_dx=2.352104e-05 dV_dθ=-5.714751e-04 ||∇||=1.115210e+00 | Tr=0.9789] 75%|███████▌  | 15/20 [00:43<00:11,  2.35s/it, CE=4.963071e-01 H=4.956565e-01 dV_dx=-4.888641e-05 dV_dθ=-6.017317e-04 ||∇||=1.113491e+00 | Tr=0.9795 Te/Cur=0.9627 Te/Exp=0.8092] 80%|████████  | 16/20 [00:43<00:10,  2.71s/it, CE=4.963071e-01 H=4.956565e-01 dV_dx=-4.888641e-05 dV_dθ=-6.017317e-04 ||∇||=1.113491e+00 | Tr=0.9795 Te/Cur=0.9627 Te/Exp=0.8092] 80%|████████  | 16/20 [00:45<00:10,  2.71s/it, CE=4.916806e-01 H=4.909603e-01 dV_dx=-1.431561e-04 dV_dθ=-5.771608e-04 ||∇||=1.104906e+00 | Tr=0.9802]                             85%|████████▌ | 17/20 [00:45<00:07,  2.53s/it, CE=4.916806e-01 H=4.909603e-01 dV_dx=-1.431561e-04 dV_dθ=-5.771608e-04 ||∇||=1.104906e+00 | Tr=0.9802] 85%|████████▌ | 17/20 [00:47<00:07,  2.53s/it, CE=4.872193e-01 H=4.865857e-01 dV_dx=-8.607246e-05 dV_dθ=-5.475407e-04 ||∇||=1.092564e+00 | Tr=0.9808] 90%|█████████ | 18/20 [00:47<00:04,  2.37s/it, CE=4.872193e-01 H=4.865857e-01 dV_dx=-8.607246e-05 dV_dθ=-5.475407e-04 ||∇||=1.092564e+00 | Tr=0.9808] 90%|█████████ | 18/20 [00:49<00:04,  2.37s/it, CE=4.829515e-01 H=4.824112e-01 dV_dx=-1.233648e-06 dV_dθ=-5.391156e-04 ||∇||=1.085863e+00 | Tr=0.9811] 95%|█████████▌| 19/20 [00:49<00:02,  2.35s/it, CE=4.829515e-01 H=4.824112e-01 dV_dx=-1.233648e-06 dV_dθ=-5.391156e-04 ||∇||=1.085863e+00 | Tr=0.9811] 95%|█████████▌| 19/20 [00:53<00:02,  2.35s/it, CE=4.788230e-01 H=4.783562e-01 dV_dx=4.980134e-05 dV_dθ=-5.165569e-04 ||∇||=1.076511e+00 | Tr=0.9817 Te/Cur=0.9655 Te/Exp=0.8056]100%|██████████| 20/20 [00:53<00:00,  2.72s/it, CE=4.788230e-01 H=4.783562e-01 dV_dx=4.980134e-05 dV_dθ=-5.165569e-04 ||∇||=1.076511e+00 | Tr=0.9817 Te/Cur=0.9655 Te/Exp=0.8056]100%|██████████| 20/20 [00:53<00:00,  2.66s/it, CE=4.788230e-01 H=4.783562e-01 dV_dx=4.980134e-05 dV_dθ=-5.165569e-04 ||∇||=1.076511e+00 | Tr=0.9817 Te/Cur=0.9655 Te/Exp=0.8056]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 6 final loss: 0.487565
======================================================================


  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7389
    Task 1: 0.9224
    Task 2: 0.8009
    Task 3: 0.5636
    Task 4: 0.9177
    Task 5: 0.9013
    Task 6: 0.9653

============================================================
Task 7
============================================================
Initial loss on new task: 5.7904, previous: 0.4788, ratio: 12.09
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 7
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:08<?, ?it/s, CE=6.293307e-01 H=6.256083e-01 dV_dx=-1.120312e-04 dV_dθ=-3.610364e-03 ||∇||=3.522512e+00 | Tr=0.6209 Te/Cur=0.7806 Te/Exp=0.8004]100%|██████████| 1/1 [00:08<00:00,  8.06s/it, CE=6.293307e-01 H=6.256083e-01 dV_dx=-1.120312e-04 dV_dθ=-3.610364e-03 ||∇||=3.522512e+00 | Tr=0.6209 Te/Cur=0.7806 Te/Exp=0.8004]100%|██████████| 1/1 [00:08<00:00,  8.06s/it, CE=6.293307e-01 H=6.256083e-01 dV_dx=-1.120312e-04 dV_dθ=-3.610364e-03 ||∇||=3.522512e+00 | Tr=0.6209 Te/Cur=0.7806 Te/Exp=0.8004]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.629331

[STEP 2] Architecture change decision
  Current: 0.629331, Previous: 0.478823
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 39932 samples from 10 classes
  Starting grid architecture search for task 7
  Baseline architecture: (3, [507, 512, 204, 10])
  Baseline loss: 0.629331
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.81s/it] 50%|█████     | 1/2 [00:10<00:08,  8.81s/it, CE=2.245875e+00 H=2.245791e+00 dV_dx=-4.404762e-06 dV_dθ=-7.898673e-05 ||∇||=4.847733e-01 | Tr=0.1685 Te/Cur=0.1887 Te/Exp=0.2438]100%|██████████| 2/2 [00:10<00:00,  4.63s/it, CE=2.245875e+00 H=2.245791e+00 dV_dx=-4.404762e-06 dV_dθ=-7.898673e-05 ||∇||=4.847733e-01 | Tr=0.1685 Te/Cur=0.1887 Te/Exp=0.2438]100%|██████████| 2/2 [00:10<00:00,  5.25s/it, CE=2.245875e+00 H=2.245791e+00 dV_dx=-4.404762e-06 dV_dθ=-7.898673e-05 ||∇||=4.847733e-01 | Tr=0.1685 Te/Cur=0.1887 Te/Exp=0.2438]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.245874550955617
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.48s/it] 50%|█████     | 1/2 [00:11<00:09,  9.48s/it, CE=2.237947e+00 H=2.237848e+00 dV_dx=1.967105e-06 dV_dθ=-1.002350e-04 ||∇||=4.732837e-01 | Tr=0.1503 Te/Cur=0.1772 Te/Exp=0.2694]100%|██████████| 2/2 [00:11<00:00,  5.04s/it, CE=2.237947e+00 H=2.237848e+00 dV_dx=1.967105e-06 dV_dθ=-1.002350e-04 ||∇||=4.732837e-01 | Tr=0.1503 Te/Cur=0.1772 Te/Exp=0.2694]100%|██████████| 2/2 [00:11<00:00,  5.71s/it, CE=2.237947e+00 H=2.237848e+00 dV_dx=1.967105e-06 dV_dθ=-1.002350e-04 ||∇||=4.732837e-01 | Tr=0.1503 Te/Cur=0.1772 Te/Exp=0.2694]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 184, 10]) with loss 2.237947
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.54s/it] 50%|█████     | 1/2 [00:07<00:06,  6.54s/it, CE=2.244045e+00 H=2.243938e+00 dV_dx=-5.495819e-06 dV_dθ=-1.012906e-04 ||∇||=4.860020e-01 | Tr=0.2096 Te/Cur=0.2038 Te/Exp=0.2916]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.244045e+00 H=2.243938e+00 dV_dx=-5.495819e-06 dV_dθ=-1.012906e-04 ||∇||=4.860020e-01 | Tr=0.2096 Te/Cur=0.2038 Te/Exp=0.2916]100%|██████████| 2/2 [00:07<00:00,  4.00s/it, CE=2.244045e+00 H=2.243938e+00 dV_dx=-5.495819e-06 dV_dθ=-1.012906e-04 ||∇||=4.860020e-01 | Tr=0.2096 Te/Cur=0.2038 Te/Exp=0.2916]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.49s/it] 50%|█████     | 1/2 [00:11<00:09,  9.49s/it, CE=2.251742e+00 H=2.251633e+00 dV_dx=1.931999e-06 dV_dθ=-1.109071e-04 ||∇||=4.458735e-01 | Tr=0.1702 Te/Cur=0.2021 Te/Exp=0.2312]100%|██████████| 2/2 [00:11<00:00,  5.09s/it, CE=2.251742e+00 H=2.251633e+00 dV_dx=1.931999e-06 dV_dθ=-1.109071e-04 ||∇||=4.458735e-01 | Tr=0.1702 Te/Cur=0.2021 Te/Exp=0.2312]100%|██████████| 2/2 [00:11<00:00,  5.75s/it, CE=2.251742e+00 H=2.251633e+00 dV_dx=1.931999e-06 dV_dθ=-1.109071e-04 ||∇||=4.458735e-01 | Tr=0.1702 Te/Cur=0.2021 Te/Exp=0.2312]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.01s/it] 50%|█████     | 1/2 [00:04<00:03,  3.01s/it, CE=2.231336e+00 H=2.231239e+00 dV_dx=3.218961e-07 dV_dθ=-9.679972e-05 ||∇||=4.921220e-01 | Tr=0.1810 Te/Cur=0.1804 Te/Exp=0.2920]100%|██████████| 2/2 [00:04<00:00,  2.39s/it, CE=2.231336e+00 H=2.231239e+00 dV_dx=3.218961e-07 dV_dθ=-9.679972e-05 ||∇||=4.921220e-01 | Tr=0.1810 Te/Cur=0.1804 Te/Exp=0.2920]100%|██████████| 2/2 [00:04<00:00,  2.48s/it, CE=2.231336e+00 H=2.231239e+00 dV_dx=3.218961e-07 dV_dθ=-9.679972e-05 ||∇||=4.921220e-01 | Tr=0.1810 Te/Cur=0.1804 Te/Exp=0.2920]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 204, 10]) with loss 2.231336
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.01s/it] 50%|█████     | 1/2 [00:04<00:03,  3.01s/it, CE=2.243710e+00 H=2.243629e+00 dV_dx=-9.307085e-07 dV_dθ=-8.001873e-05 ||∇||=4.526010e-01 | Tr=0.2291 Te/Cur=0.2464 Te/Exp=0.2294]100%|██████████| 2/2 [00:04<00:00,  2.15s/it, CE=2.243710e+00 H=2.243629e+00 dV_dx=-9.307085e-07 dV_dθ=-8.001873e-05 ||∇||=4.526010e-01 | Tr=0.2291 Te/Cur=0.2464 Te/Exp=0.2294]100%|██████████| 2/2 [00:04<00:00,  2.28s/it, CE=2.243710e+00 H=2.243629e+00 dV_dx=-9.307085e-07 dV_dθ=-8.001873e-05 ||∇||=4.526010e-01 | Tr=0.2291 Te/Cur=0.2464 Te/Exp=0.2294]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.97s/it] 50%|█████     | 1/2 [00:11<00:09,  9.97s/it, CE=2.257871e+00 H=2.257790e+00 dV_dx=-3.772404e-06 dV_dθ=-7.713616e-05 ||∇||=4.425674e-01 | Tr=0.1408 Te/Cur=0.1630 Te/Exp=0.2775]100%|██████████| 2/2 [00:11<00:00,  5.16s/it, CE=2.257871e+00 H=2.257790e+00 dV_dx=-3.772404e-06 dV_dθ=-7.713616e-05 ||∇||=4.425674e-01 | Tr=0.1408 Te/Cur=0.1630 Te/Exp=0.2775]100%|██████████| 2/2 [00:11<00:00,  5.88s/it, CE=2.257871e+00 H=2.257790e+00 dV_dx=-3.772404e-06 dV_dθ=-7.713616e-05 ||∇||=4.425674e-01 | Tr=0.1408 Te/Cur=0.1630 Te/Exp=0.2775]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.67s/it] 50%|█████     | 1/2 [00:11<00:09,  9.67s/it, CE=2.235315e+00 H=2.235240e+00 dV_dx=1.237868e-06 dV_dθ=-7.630617e-05 ||∇||=4.844771e-01 | Tr=0.1421 Te/Cur=0.1801 Te/Exp=0.2684]100%|██████████| 2/2 [00:11<00:00,  5.13s/it, CE=2.235315e+00 H=2.235240e+00 dV_dx=1.237868e-06 dV_dθ=-7.630617e-05 ||∇||=4.844771e-01 | Tr=0.1421 Te/Cur=0.1801 Te/Exp=0.2684]100%|██████████| 2/2 [00:11<00:00,  5.81s/it, CE=2.235315e+00 H=2.235240e+00 dV_dx=1.237868e-06 dV_dθ=-7.630617e-05 ||∇||=4.844771e-01 | Tr=0.1421 Te/Cur=0.1801 Te/Exp=0.2684]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.33s/it] 50%|█████     | 1/2 [00:05<00:03,  3.33s/it, CE=2.232961e+00 H=2.232841e+00 dV_dx=-3.297477e-06 dV_dθ=-1.169116e-04 ||∇||=4.837320e-01 | Tr=0.1982 Te/Cur=0.2079 Te/Exp=0.2699]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.232961e+00 H=2.232841e+00 dV_dx=-3.297477e-06 dV_dθ=-1.169116e-04 ||∇||=4.837320e-01 | Tr=0.1982 Te/Cur=0.2079 Te/Exp=0.2699]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.232961e+00 H=2.232841e+00 dV_dx=-3.297477e-06 dV_dθ=-1.169116e-04 ||∇||=4.837320e-01 | Tr=0.1982 Te/Cur=0.2079 Te/Exp=0.2699]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.80s/it] 50%|█████     | 1/2 [00:14<00:09,  9.80s/it, CE=2.277001e+00 H=2.276849e+00 dV_dx=1.417090e-06 dV_dθ=-1.540045e-04 ||∇||=4.823084e-01 | Tr=0.1260 Te/Cur=0.1462 Te/Exp=0.2239]100%|██████████| 2/2 [00:14<00:00,  6.94s/it, CE=2.277001e+00 H=2.276849e+00 dV_dx=1.417090e-06 dV_dθ=-1.540045e-04 ||∇||=4.823084e-01 | Tr=0.1260 Te/Cur=0.1462 Te/Exp=0.2239]100%|██████████| 2/2 [00:14<00:00,  7.37s/it, CE=2.277001e+00 H=2.276849e+00 dV_dx=1.417090e-06 dV_dθ=-1.540045e-04 ||∇||=4.823084e-01 | Tr=0.1260 Te/Cur=0.1462 Te/Exp=0.2239]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.16s/it] 50%|█████     | 1/2 [00:12<00:10, 10.16s/it, CE=2.283541e+00 H=2.283460e+00 dV_dx=4.062324e-06 dV_dθ=-8.492282e-05 ||∇||=4.101671e-01 | Tr=0.1686 Te/Cur=0.1701 Te/Exp=0.1909]100%|██████████| 2/2 [00:12<00:00,  5.28s/it, CE=2.283541e+00 H=2.283460e+00 dV_dx=4.062324e-06 dV_dθ=-8.492282e-05 ||∇||=4.101671e-01 | Tr=0.1686 Te/Cur=0.1701 Te/Exp=0.1909]100%|██████████| 2/2 [00:12<00:00,  6.01s/it, CE=2.283541e+00 H=2.283460e+00 dV_dx=4.062324e-06 dV_dθ=-8.492282e-05 ||∇||=4.101671e-01 | Tr=0.1686 Te/Cur=0.1701 Te/Exp=0.1909]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.07s/it] 50%|█████     | 1/2 [00:05<00:04,  4.07s/it, CE=2.266967e+00 H=2.266909e+00 dV_dx=-6.616457e-06 dV_dθ=-5.143289e-05 ||∇||=4.727802e-01 | Tr=0.1077 Te/Cur=0.1093 Te/Exp=0.2429]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.266967e+00 H=2.266909e+00 dV_dx=-6.616457e-06 dV_dθ=-5.143289e-05 ||∇||=4.727802e-01 | Tr=0.1077 Te/Cur=0.1093 Te/Exp=0.2429]100%|██████████| 2/2 [00:05<00:00,  2.89s/it, CE=2.266967e+00 H=2.266909e+00 dV_dx=-6.616457e-06 dV_dθ=-5.143289e-05 ||∇||=4.727802e-01 | Tr=0.1077 Te/Cur=0.1093 Te/Exp=0.2429]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.75s/it] 50%|█████     | 1/2 [00:11<00:09,  9.75s/it, CE=2.256992e+00 H=2.256933e+00 dV_dx=2.519419e-06 dV_dθ=-6.162732e-05 ||∇||=4.079027e-01 | Tr=0.0750 Te/Cur=0.0828 Te/Exp=0.2112]100%|██████████| 2/2 [00:11<00:00,  4.82s/it, CE=2.256992e+00 H=2.256933e+00 dV_dx=2.519419e-06 dV_dθ=-6.162732e-05 ||∇||=4.079027e-01 | Tr=0.0750 Te/Cur=0.0828 Te/Exp=0.2112]100%|██████████| 2/2 [00:11<00:00,  5.56s/it, CE=2.256992e+00 H=2.256933e+00 dV_dx=2.519419e-06 dV_dθ=-6.162732e-05 ||∇||=4.079027e-01 | Tr=0.0750 Te/Cur=0.0828 Te/Exp=0.2112]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.20s/it] 50%|█████     | 1/2 [00:04<00:03,  3.20s/it, CE=2.256897e+00 H=2.256805e+00 dV_dx=1.240836e-05 dV_dθ=-1.043403e-04 ||∇||=4.256567e-01 | Tr=0.1073 Te/Cur=0.1370 Te/Exp=0.2009]100%|██████████| 2/2 [00:04<00:00,  2.30s/it, CE=2.256897e+00 H=2.256805e+00 dV_dx=1.240836e-05 dV_dθ=-1.043403e-04 ||∇||=4.256567e-01 | Tr=0.1073 Te/Cur=0.1370 Te/Exp=0.2009]100%|██████████| 2/2 [00:04<00:00,  2.44s/it, CE=2.256897e+00 H=2.256805e+00 dV_dx=1.240836e-05 dV_dθ=-1.043403e-04 ||∇||=4.256567e-01 | Tr=0.1073 Te/Cur=0.1370 Te/Exp=0.2009]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.32s/it] 50%|█████     | 1/2 [00:05<00:03,  3.32s/it, CE=2.263869e+00 H=2.263823e+00 dV_dx=-3.175665e-06 dV_dθ=-4.365202e-05 ||∇||=4.244447e-01 | Tr=0.1288 Te/Cur=0.1417 Te/Exp=0.2313]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.263869e+00 H=2.263823e+00 dV_dx=-3.175665e-06 dV_dθ=-4.365202e-05 ||∇||=4.244447e-01 | Tr=0.1288 Te/Cur=0.1417 Te/Exp=0.2313]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.263869e+00 H=2.263823e+00 dV_dx=-3.175665e-06 dV_dθ=-4.365202e-05 ||∇||=4.244447e-01 | Tr=0.1288 Te/Cur=0.1417 Te/Exp=0.2313]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.85s/it] 50%|█████     | 1/2 [00:12<00:09,  9.85s/it, CE=2.271366e+00 H=2.271315e+00 dV_dx=5.062731e-06 dV_dθ=-5.622525e-05 ||∇||=3.792171e-01 | Tr=0.0323 Te/Cur=0.0449 Te/Exp=0.2302]100%|██████████| 2/2 [00:12<00:00,  5.46s/it, CE=2.271366e+00 H=2.271315e+00 dV_dx=5.062731e-06 dV_dθ=-5.622525e-05 ||∇||=3.792171e-01 | Tr=0.0323 Te/Cur=0.0449 Te/Exp=0.2302]100%|██████████| 2/2 [00:12<00:00,  6.12s/it, CE=2.271366e+00 H=2.271315e+00 dV_dx=5.062731e-06 dV_dθ=-5.622525e-05 ||∇||=3.792171e-01 | Tr=0.0323 Te/Cur=0.0449 Te/Exp=0.2302]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.04s/it] 50%|█████     | 1/2 [00:10<00:09,  9.04s/it, CE=2.270016e+00 H=2.269953e+00 dV_dx=-8.403015e-06 dV_dθ=-5.522157e-05 ||∇||=4.256504e-01 | Tr=0.1011 Te/Cur=0.1044 Te/Exp=0.1844]100%|██████████| 2/2 [00:10<00:00,  4.57s/it, CE=2.270016e+00 H=2.269953e+00 dV_dx=-8.403015e-06 dV_dθ=-5.522157e-05 ||∇||=4.256504e-01 | Tr=0.1011 Te/Cur=0.1044 Te/Exp=0.1844]100%|██████████| 2/2 [00:10<00:00,  5.24s/it, CE=2.270016e+00 H=2.269953e+00 dV_dx=-8.403015e-06 dV_dθ=-5.522157e-05 ||∇||=4.256504e-01 | Tr=0.1011 Te/Cur=0.1044 Te/Exp=0.1844]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.06s/it] 50%|█████     | 1/2 [00:07<00:03,  3.06s/it, CE=2.258568e+00 H=2.258487e+00 dV_dx=-9.430064e-06 dV_dθ=-7.159171e-05 ||∇||=4.183905e-01 | Tr=0.1617 Te/Cur=0.1861 Te/Exp=0.2625]100%|██████████| 2/2 [00:07<00:00,  4.10s/it, CE=2.258568e+00 H=2.258487e+00 dV_dx=-9.430064e-06 dV_dθ=-7.159171e-05 ||∇||=4.183905e-01 | Tr=0.1617 Te/Cur=0.1861 Te/Exp=0.2625]100%|██████████| 2/2 [00:07<00:00,  3.95s/it, CE=2.258568e+00 H=2.258487e+00 dV_dx=-9.430064e-06 dV_dθ=-7.159171e-05 ||∇||=4.183905e-01 | Tr=0.1617 Te/Cur=0.1861 Te/Exp=0.2625]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.45s/it] 50%|█████     | 1/2 [00:11<00:09,  9.45s/it, CE=2.284903e+00 H=2.284676e+00 dV_dx=-6.552821e-06 dV_dθ=-2.200204e-04 ||∇||=4.691700e-01 | Tr=0.1523 Te/Cur=0.1744 Te/Exp=0.1795]100%|██████████| 2/2 [00:11<00:00,  5.04s/it, CE=2.284903e+00 H=2.284676e+00 dV_dx=-6.552821e-06 dV_dθ=-2.200204e-04 ||∇||=4.691700e-01 | Tr=0.1523 Te/Cur=0.1744 Te/Exp=0.1795]100%|██████████| 2/2 [00:11<00:00,  5.70s/it, CE=2.284903e+00 H=2.284676e+00 dV_dx=-6.552821e-06 dV_dθ=-2.200204e-04 ||∇||=4.691700e-01 | Tr=0.1523 Te/Cur=0.1744 Te/Exp=0.1795]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.77s/it] 50%|█████     | 1/2 [00:10<00:08,  8.77s/it, CE=2.284059e+00 H=2.283833e+00 dV_dx=-5.795805e-06 dV_dθ=-2.203453e-04 ||∇||=5.204341e-01 | Tr=0.1222 Te/Cur=0.1297 Te/Exp=0.1866]100%|██████████| 2/2 [00:10<00:00,  4.59s/it, CE=2.284059e+00 H=2.283833e+00 dV_dx=-5.795805e-06 dV_dθ=-2.203453e-04 ||∇||=5.204341e-01 | Tr=0.1222 Te/Cur=0.1297 Te/Exp=0.1866]100%|██████████| 2/2 [00:10<00:00,  5.22s/it, CE=2.284059e+00 H=2.283833e+00 dV_dx=-5.795805e-06 dV_dθ=-2.203453e-04 ||∇||=5.204341e-01 | Tr=0.1222 Te/Cur=0.1297 Te/Exp=0.1866]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.40s/it] 50%|█████     | 1/2 [00:05<00:03,  3.40s/it, CE=2.241834e+00 H=2.241746e+00 dV_dx=-1.139330e-06 dV_dθ=-8.711320e-05 ||∇||=4.638954e-01 | Tr=0.1627 Te/Cur=0.1562 Te/Exp=0.2830]100%|██████████| 2/2 [00:05<00:00,  2.41s/it, CE=2.241834e+00 H=2.241746e+00 dV_dx=-1.139330e-06 dV_dθ=-8.711320e-05 ||∇||=4.638954e-01 | Tr=0.1627 Te/Cur=0.1562 Te/Exp=0.2830]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.241834e+00 H=2.241746e+00 dV_dx=-1.139330e-06 dV_dθ=-8.711320e-05 ||∇||=4.638954e-01 | Tr=0.1627 Te/Cur=0.1562 Te/Exp=0.2830]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.90s/it] 50%|█████     | 1/2 [00:11<00:09,  9.90s/it, CE=2.248363e+00 H=2.248330e+00 dV_dx=4.349924e-06 dV_dθ=-3.703396e-05 ||∇||=4.638135e-01 | Tr=0.1320 Te/Cur=0.1047 Te/Exp=0.2590]100%|██████████| 2/2 [00:11<00:00,  5.30s/it, CE=2.248363e+00 H=2.248330e+00 dV_dx=4.349924e-06 dV_dθ=-3.703396e-05 ||∇||=4.638135e-01 | Tr=0.1320 Te/Cur=0.1047 Te/Exp=0.2590]100%|██████████| 2/2 [00:11<00:00,  5.99s/it, CE=2.248363e+00 H=2.248330e+00 dV_dx=4.349924e-06 dV_dθ=-3.703396e-05 ||∇||=4.638135e-01 | Tr=0.1320 Te/Cur=0.1047 Te/Exp=0.2590]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.61s/it] 50%|█████     | 1/2 [00:05<00:03,  3.61s/it, CE=2.250531e+00 H=2.250459e+00 dV_dx=-7.789208e-06 dV_dθ=-6.455399e-05 ||∇||=4.266933e-01 | Tr=0.1741 Te/Cur=0.1798 Te/Exp=0.2612]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.250531e+00 H=2.250459e+00 dV_dx=-7.789208e-06 dV_dθ=-6.455399e-05 ||∇||=4.266933e-01 | Tr=0.1741 Te/Cur=0.1798 Te/Exp=0.2612]100%|██████████| 2/2 [00:05<00:00,  2.86s/it, CE=2.250531e+00 H=2.250459e+00 dV_dx=-7.789208e-06 dV_dθ=-6.455399e-05 ||∇||=4.266933e-01 | Tr=0.1741 Te/Cur=0.1798 Te/Exp=0.2612]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.51s/it] 50%|█████     | 1/2 [00:05<00:03,  3.51s/it, CE=2.243142e+00 H=2.243052e+00 dV_dx=8.700440e-06 dV_dθ=-9.869933e-05 ||∇||=4.596044e-01 | Tr=0.1455 Te/Cur=0.1658 Te/Exp=0.2416]100%|██████████| 2/2 [00:05<00:00,  2.67s/it, CE=2.243142e+00 H=2.243052e+00 dV_dx=8.700440e-06 dV_dθ=-9.869933e-05 ||∇||=4.596044e-01 | Tr=0.1455 Te/Cur=0.1658 Te/Exp=0.2416]100%|██████████| 2/2 [00:05<00:00,  2.79s/it, CE=2.243142e+00 H=2.243052e+00 dV_dx=8.700440e-06 dV_dθ=-9.869933e-05 ||∇||=4.596044e-01 | Tr=0.1455 Te/Cur=0.1658 Te/Exp=0.2416]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.64s/it] 50%|█████     | 1/2 [00:11<00:09,  9.64s/it, CE=2.249155e+00 H=2.249015e+00 dV_dx=1.599572e-06 dV_dθ=-1.415361e-04 ||∇||=4.848075e-01 | Tr=0.1628 Te/Cur=0.1628 Te/Exp=0.2543]100%|██████████| 2/2 [00:11<00:00,  5.15s/it, CE=2.249155e+00 H=2.249015e+00 dV_dx=1.599572e-06 dV_dθ=-1.415361e-04 ||∇||=4.848075e-01 | Tr=0.1628 Te/Cur=0.1628 Te/Exp=0.2543]100%|██████████| 2/2 [00:11<00:00,  5.83s/it, CE=2.249155e+00 H=2.249015e+00 dV_dx=1.599572e-06 dV_dθ=-1.415361e-04 ||∇||=4.848075e-01 | Tr=0.1628 Te/Cur=0.1628 Te/Exp=0.2543]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.63s/it] 50%|█████     | 1/2 [00:11<00:09,  9.63s/it, CE=2.258233e+00 H=2.258117e+00 dV_dx=1.595683e-06 dV_dθ=-1.169899e-04 ||∇||=4.399912e-01 | Tr=0.1401 Te/Cur=0.1389 Te/Exp=0.2502]100%|██████████| 2/2 [00:11<00:00,  5.00s/it, CE=2.258233e+00 H=2.258117e+00 dV_dx=1.595683e-06 dV_dθ=-1.169899e-04 ||∇||=4.399912e-01 | Tr=0.1401 Te/Cur=0.1389 Te/Exp=0.2502]100%|██████████| 2/2 [00:11<00:00,  5.70s/it, CE=2.258233e+00 H=2.258117e+00 dV_dx=1.595683e-06 dV_dθ=-1.169899e-04 ||∇||=4.399912e-01 | Tr=0.1401 Te/Cur=0.1389 Te/Exp=0.2502]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.35s/it] 50%|█████     | 1/2 [00:07<00:06,  6.35s/it, CE=2.244618e+00 H=2.244552e+00 dV_dx=5.204562e-06 dV_dθ=-7.101094e-05 ||∇||=4.578407e-01 | Tr=0.1588 Te/Cur=0.1680 Te/Exp=0.2666]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.244618e+00 H=2.244552e+00 dV_dx=5.204562e-06 dV_dθ=-7.101094e-05 ||∇||=4.578407e-01 | Tr=0.1588 Te/Cur=0.1680 Te/Exp=0.2666]100%|██████████| 2/2 [00:07<00:00,  3.99s/it, CE=2.244618e+00 H=2.244552e+00 dV_dx=5.204562e-06 dV_dθ=-7.101094e-05 ||∇||=4.578407e-01 | Tr=0.1588 Te/Cur=0.1680 Te/Exp=0.2666]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.07s/it] 50%|█████     | 1/2 [00:11<00:10, 10.07s/it, CE=2.253339e+00 H=2.253255e+00 dV_dx=-2.046182e-05 dV_dθ=-6.337104e-05 ||∇||=4.446473e-01 | Tr=0.1183 Te/Cur=0.1598 Te/Exp=0.2576]100%|██████████| 2/2 [00:11<00:00,  5.27s/it, CE=2.253339e+00 H=2.253255e+00 dV_dx=-2.046182e-05 dV_dθ=-6.337104e-05 ||∇||=4.446473e-01 | Tr=0.1183 Te/Cur=0.1598 Te/Exp=0.2576]100%|██████████| 2/2 [00:11<00:00,  5.99s/it, CE=2.253339e+00 H=2.253255e+00 dV_dx=-2.046182e-05 dV_dθ=-6.337104e-05 ||∇||=4.446473e-01 | Tr=0.1183 Te/Cur=0.1598 Te/Exp=0.2576]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.253338599972446
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.70s/it] 50%|█████     | 1/2 [00:05<00:03,  3.70s/it, CE=2.267765e+00 H=2.267664e+00 dV_dx=9.078480e-06 dV_dθ=-1.105372e-04 ||∇||=4.209862e-01 | Tr=0.1423 Te/Cur=0.1648 Te/Exp=0.2273]100%|██████████| 2/2 [00:05<00:00,  2.64s/it, CE=2.267765e+00 H=2.267664e+00 dV_dx=9.078480e-06 dV_dθ=-1.105372e-04 ||∇||=4.209862e-01 | Tr=0.1423 Te/Cur=0.1648 Te/Exp=0.2273]100%|██████████| 2/2 [00:05<00:00,  2.80s/it, CE=2.267765e+00 H=2.267664e+00 dV_dx=9.078480e-06 dV_dθ=-1.105372e-04 ||∇||=4.209862e-01 | Tr=0.1423 Te/Cur=0.1648 Te/Exp=0.2273]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.52s/it] 50%|█████     | 1/2 [00:04<00:03,  3.52s/it, CE=2.238688e+00 H=2.238582e+00 dV_dx=-4.550414e-06 dV_dθ=-1.012222e-04 ||∇||=4.850172e-01 | Tr=0.1423 Te/Cur=0.1282 Te/Exp=0.3061]100%|██████████| 2/2 [00:04<00:00,  2.29s/it, CE=2.238688e+00 H=2.238582e+00 dV_dx=-4.550414e-06 dV_dθ=-1.012222e-04 ||∇||=4.850172e-01 | Tr=0.1423 Te/Cur=0.1282 Te/Exp=0.3061]100%|██████████| 2/2 [00:04<00:00,  2.47s/it, CE=2.238688e+00 H=2.238582e+00 dV_dx=-4.550414e-06 dV_dθ=-1.012222e-04 ||∇||=4.850172e-01 | Tr=0.1423 Te/Cur=0.1282 Te/Exp=0.3061]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 164, 10]) with loss 2.238688
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.11s/it] 50%|█████     | 1/2 [00:10<00:09,  9.11s/it, CE=2.250404e+00 H=2.250320e+00 dV_dx=4.333574e-06 dV_dθ=-8.831700e-05 ||∇||=4.855119e-01 | Tr=0.1482 Te/Cur=0.1745 Te/Exp=0.2418]100%|██████████| 2/2 [00:10<00:00,  4.71s/it, CE=2.250404e+00 H=2.250320e+00 dV_dx=4.333574e-06 dV_dθ=-8.831700e-05 ||∇||=4.855119e-01 | Tr=0.1482 Te/Cur=0.1745 Te/Exp=0.2418]100%|██████████| 2/2 [00:10<00:00,  5.37s/it, CE=2.250404e+00 H=2.250320e+00 dV_dx=4.333574e-06 dV_dθ=-8.831700e-05 ||∇||=4.855119e-01 | Tr=0.1482 Te/Cur=0.1745 Te/Exp=0.2418]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.90s/it] 50%|█████     | 1/2 [00:05<00:03,  3.90s/it, CE=2.240936e+00 H=2.240726e+00 dV_dx=-3.463816e-06 dV_dθ=-2.066158e-04 ||∇||=5.019259e-01 | Tr=0.1922 Te/Cur=0.1888 Te/Exp=0.3024]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.240936e+00 H=2.240726e+00 dV_dx=-3.463816e-06 dV_dθ=-2.066158e-04 ||∇||=5.019259e-01 | Tr=0.1922 Te/Cur=0.1888 Te/Exp=0.3024]100%|██████████| 2/2 [00:05<00:00,  2.78s/it, CE=2.240936e+00 H=2.240726e+00 dV_dx=-3.463816e-06 dV_dθ=-2.066158e-04 ||∇||=5.019259e-01 | Tr=0.1922 Te/Cur=0.1888 Te/Exp=0.3024]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.91s/it] 50%|█████     | 1/2 [00:04<00:02,  2.91s/it, CE=2.226723e+00 H=2.226659e+00 dV_dx=6.379550e-07 dV_dθ=-6.480396e-05 ||∇||=4.948492e-01 | Tr=0.1272 Te/Cur=0.1472 Te/Exp=0.3299]100%|██████████| 2/2 [00:04<00:00,  2.29s/it, CE=2.226723e+00 H=2.226659e+00 dV_dx=6.379550e-07 dV_dθ=-6.480396e-05 ||∇||=4.948492e-01 | Tr=0.1272 Te/Cur=0.1472 Te/Exp=0.3299]100%|██████████| 2/2 [00:04<00:00,  2.38s/it, CE=2.226723e+00 H=2.226659e+00 dV_dx=6.379550e-07 dV_dθ=-6.480396e-05 ||∇||=4.948492e-01 | Tr=0.1272 Te/Cur=0.1472 Te/Exp=0.3299]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 204, 10]) with loss 2.226723
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.41s/it] 50%|█████     | 1/2 [00:11<00:09,  9.41s/it, CE=2.252598e+00 H=2.252448e+00 dV_dx=-3.518479e-06 dV_dθ=-1.463041e-04 ||∇||=5.207924e-01 | Tr=0.0836 Te/Cur=0.0955 Te/Exp=0.2708]100%|██████████| 2/2 [00:11<00:00,  4.96s/it, CE=2.252598e+00 H=2.252448e+00 dV_dx=-3.518479e-06 dV_dθ=-1.463041e-04 ||∇||=5.207924e-01 | Tr=0.0836 Te/Cur=0.0955 Te/Exp=0.2708]100%|██████████| 2/2 [00:11<00:00,  5.62s/it, CE=2.252598e+00 H=2.252448e+00 dV_dx=-3.518479e-06 dV_dθ=-1.463041e-04 ||∇||=5.207924e-01 | Tr=0.0836 Te/Cur=0.0955 Te/Exp=0.2708]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.47s/it] 50%|█████     | 1/2 [00:08<00:03,  3.47s/it, CE=2.241586e+00 H=2.241482e+00 dV_dx=1.240665e-05 dV_dθ=-1.169987e-04 ||∇||=4.635751e-01 | Tr=0.1717 Te/Cur=0.2092 Te/Exp=0.2938]100%|██████████| 2/2 [00:08<00:00,  4.34s/it, CE=2.241586e+00 H=2.241482e+00 dV_dx=1.240665e-05 dV_dθ=-1.169987e-04 ||∇||=4.635751e-01 | Tr=0.1717 Te/Cur=0.2092 Te/Exp=0.2938]100%|██████████| 2/2 [00:08<00:00,  4.21s/it, CE=2.241586e+00 H=2.241482e+00 dV_dx=1.240665e-05 dV_dθ=-1.169987e-04 ||∇||=4.635751e-01 | Tr=0.1717 Te/Cur=0.2092 Te/Exp=0.2938]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.30s/it] 50%|█████     | 1/2 [00:04<00:03,  3.30s/it, CE=2.251724e+00 H=2.251620e+00 dV_dx=-6.530915e-06 dV_dθ=-9.700344e-05 ||∇||=5.132587e-01 | Tr=0.0794 Te/Cur=0.0979 Te/Exp=0.2823]100%|██████████| 2/2 [00:04<00:00,  2.34s/it, CE=2.251724e+00 H=2.251620e+00 dV_dx=-6.530915e-06 dV_dθ=-9.700344e-05 ||∇||=5.132587e-01 | Tr=0.0794 Te/Cur=0.0979 Te/Exp=0.2823]100%|██████████| 2/2 [00:04<00:00,  2.48s/it, CE=2.251724e+00 H=2.251620e+00 dV_dx=-6.530915e-06 dV_dθ=-9.700344e-05 ||∇||=5.132587e-01 | Tr=0.0794 Te/Cur=0.0979 Te/Exp=0.2823]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.54s/it] 50%|█████     | 1/2 [00:11<00:09,  9.54s/it, CE=2.275356e+00 H=2.275310e+00 dV_dx=7.340948e-06 dV_dθ=-5.400040e-05 ||∇||=3.708015e-01 | Tr=0.0942 Te/Cur=0.1128 Te/Exp=0.2047]100%|██████████| 2/2 [00:11<00:00,  5.05s/it, CE=2.275356e+00 H=2.275310e+00 dV_dx=7.340948e-06 dV_dθ=-5.400040e-05 ||∇||=3.708015e-01 | Tr=0.0942 Te/Cur=0.1128 Te/Exp=0.2047]100%|██████████| 2/2 [00:11<00:00,  5.73s/it, CE=2.275356e+00 H=2.275310e+00 dV_dx=7.340948e-06 dV_dθ=-5.400040e-05 ||∇||=3.708015e-01 | Tr=0.0942 Te/Cur=0.1128 Te/Exp=0.2047]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.38s/it] 50%|█████     | 1/2 [00:05<00:03,  3.38s/it, CE=2.282520e+00 H=2.282481e+00 dV_dx=-1.137965e-05 dV_dθ=-2.767983e-05 ||∇||=3.224300e-01 | Tr=0.1468 Te/Cur=0.1450 Te/Exp=0.2146]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.282520e+00 H=2.282481e+00 dV_dx=-1.137965e-05 dV_dθ=-2.767983e-05 ||∇||=3.224300e-01 | Tr=0.1468 Te/Cur=0.1450 Te/Exp=0.2146]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.282520e+00 H=2.282481e+00 dV_dx=-1.137965e-05 dV_dθ=-2.767983e-05 ||∇||=3.224300e-01 | Tr=0.1468 Te/Cur=0.1450 Te/Exp=0.2146]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.66s/it] 50%|█████     | 1/2 [00:05<00:03,  3.66s/it, CE=2.265505e+00 H=2.265458e+00 dV_dx=-6.948451e-06 dV_dθ=-4.039698e-05 ||∇||=3.723938e-01 | Tr=0.0840 Te/Cur=0.0903 Te/Exp=0.2652]100%|██████████| 2/2 [00:05<00:00,  2.69s/it, CE=2.265505e+00 H=2.265458e+00 dV_dx=-6.948451e-06 dV_dθ=-4.039698e-05 ||∇||=3.723938e-01 | Tr=0.0840 Te/Cur=0.0903 Te/Exp=0.2652]100%|██████████| 2/2 [00:05<00:00,  2.83s/it, CE=2.265505e+00 H=2.265458e+00 dV_dx=-6.948451e-06 dV_dθ=-4.039698e-05 ||∇||=3.723938e-01 | Tr=0.0840 Te/Cur=0.0903 Te/Exp=0.2652]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.62s/it] 50%|█████     | 1/2 [00:11<00:09,  9.62s/it, CE=2.275671e+00 H=2.275628e+00 dV_dx=-6.479196e-06 dV_dθ=-3.682410e-05 ||∇||=3.549561e-01 | Tr=0.0776 Te/Cur=0.0672 Te/Exp=0.2132]100%|██████████| 2/2 [00:11<00:00,  5.20s/it, CE=2.275671e+00 H=2.275628e+00 dV_dx=-6.479196e-06 dV_dθ=-3.682410e-05 ||∇||=3.549561e-01 | Tr=0.0776 Te/Cur=0.0672 Te/Exp=0.2132]100%|██████████| 2/2 [00:11<00:00,  5.86s/it, CE=2.275671e+00 H=2.275628e+00 dV_dx=-6.479196e-06 dV_dθ=-3.682410e-05 ||∇||=3.549561e-01 | Tr=0.0776 Te/Cur=0.0672 Te/Exp=0.2132]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.43s/it] 50%|█████     | 1/2 [00:05<00:03,  3.43s/it, CE=2.272755e+00 H=2.272702e+00 dV_dx=-6.162540e-06 dV_dθ=-4.672149e-05 ||∇||=3.182931e-01 | Tr=0.0895 Te/Cur=0.1221 Te/Exp=0.1983]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.272755e+00 H=2.272702e+00 dV_dx=-6.162540e-06 dV_dθ=-4.672149e-05 ||∇||=3.182931e-01 | Tr=0.0895 Te/Cur=0.1221 Te/Exp=0.1983]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.272755e+00 H=2.272702e+00 dV_dx=-6.162540e-06 dV_dθ=-4.672149e-05 ||∇||=3.182931e-01 | Tr=0.0895 Te/Cur=0.1221 Te/Exp=0.1983]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.38s/it] 50%|█████     | 1/2 [00:05<00:03,  3.38s/it, CE=2.258004e+00 H=2.257960e+00 dV_dx=1.125768e-06 dV_dθ=-4.498836e-05 ||∇||=3.468310e-01 | Tr=0.1027 Te/Cur=0.1166 Te/Exp=0.2451]100%|██████████| 2/2 [00:05<00:00,  2.47s/it, CE=2.258004e+00 H=2.257960e+00 dV_dx=1.125768e-06 dV_dθ=-4.498836e-05 ||∇||=3.468310e-01 | Tr=0.1027 Te/Cur=0.1166 Te/Exp=0.2451]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.258004e+00 H=2.257960e+00 dV_dx=1.125768e-06 dV_dθ=-4.498836e-05 ||∇||=3.468310e-01 | Tr=0.1027 Te/Cur=0.1166 Te/Exp=0.2451]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.04s/it] 50%|█████     | 1/2 [00:10<00:09,  9.04s/it, CE=2.276341e+00 H=2.276273e+00 dV_dx=1.128015e-05 dV_dθ=-7.910763e-05 ||∇||=3.933722e-01 | Tr=0.1350 Te/Cur=0.1385 Te/Exp=0.2243]100%|██████████| 2/2 [00:10<00:00,  4.81s/it, CE=2.276341e+00 H=2.276273e+00 dV_dx=1.128015e-05 dV_dθ=-7.910763e-05 ||∇||=3.933722e-01 | Tr=0.1350 Te/Cur=0.1385 Te/Exp=0.2243]100%|██████████| 2/2 [00:10<00:00,  5.45s/it, CE=2.276341e+00 H=2.276273e+00 dV_dx=1.128015e-05 dV_dθ=-7.910763e-05 ||∇||=3.933722e-01 | Tr=0.1350 Te/Cur=0.1385 Te/Exp=0.2243]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.80s/it] 50%|█████     | 1/2 [00:07<00:05,  5.80s/it, CE=2.263743e+00 H=2.263697e+00 dV_dx=-2.058558e-05 dV_dθ=-2.576635e-05 ||∇||=3.335915e-01 | Tr=0.0821 Te/Cur=0.0932 Te/Exp=0.2080]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.263743e+00 H=2.263697e+00 dV_dx=-2.058558e-05 dV_dθ=-2.576635e-05 ||∇||=3.335915e-01 | Tr=0.0821 Te/Cur=0.0932 Te/Exp=0.2080]100%|██████████| 2/2 [00:07<00:00,  3.89s/it, CE=2.263743e+00 H=2.263697e+00 dV_dx=-2.058558e-05 dV_dθ=-2.576635e-05 ||∇||=3.335915e-01 | Tr=0.0821 Te/Cur=0.0932 Te/Exp=0.2080]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.71s/it] 50%|█████     | 1/2 [00:05<00:03,  3.71s/it, CE=2.261050e+00 H=2.260989e+00 dV_dx=7.597231e-06 dV_dθ=-6.831589e-05 ||∇||=3.576655e-01 | Tr=0.1457 Te/Cur=0.1367 Te/Exp=0.2560]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.261050e+00 H=2.260989e+00 dV_dx=7.597231e-06 dV_dθ=-6.831589e-05 ||∇||=3.576655e-01 | Tr=0.1457 Te/Cur=0.1367 Te/Exp=0.2560]100%|██████████| 2/2 [00:05<00:00,  2.72s/it, CE=2.261050e+00 H=2.260989e+00 dV_dx=7.597231e-06 dV_dθ=-6.831589e-05 ||∇||=3.576655e-01 | Tr=0.1457 Te/Cur=0.1367 Te/Exp=0.2560]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.46s/it] 50%|█████     | 1/2 [00:13<00:11, 11.46s/it, CE=2.274216e+00 H=2.274126e+00 dV_dx=-1.034682e-05 dV_dθ=-8.052284e-05 ||∇||=3.657202e-01 | Tr=0.0910 Te/Cur=0.0904 Te/Exp=0.1945]100%|██████████| 2/2 [00:13<00:00,  5.85s/it, CE=2.274216e+00 H=2.274126e+00 dV_dx=-1.034682e-05 dV_dθ=-8.052284e-05 ||∇||=3.657202e-01 | Tr=0.0910 Te/Cur=0.0904 Te/Exp=0.1945]100%|██████████| 2/2 [00:13<00:00,  6.69s/it, CE=2.274216e+00 H=2.274126e+00 dV_dx=-1.034682e-05 dV_dθ=-8.052284e-05 ||∇||=3.657202e-01 | Tr=0.0910 Te/Cur=0.0904 Te/Exp=0.1945]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.03s/it] 50%|█████     | 1/2 [00:04<00:03,  3.03s/it, CE=2.282948e+00 H=2.282891e+00 dV_dx=1.093487e-05 dV_dθ=-6.730981e-05 ||∇||=3.286280e-01 | Tr=0.0760 Te/Cur=0.1167 Te/Exp=0.2061]100%|██████████| 2/2 [00:04<00:00,  2.33s/it, CE=2.282948e+00 H=2.282891e+00 dV_dx=1.093487e-05 dV_dθ=-6.730981e-05 ||∇||=3.286280e-01 | Tr=0.0760 Te/Cur=0.1167 Te/Exp=0.2061]100%|██████████| 2/2 [00:04<00:00,  2.43s/it, CE=2.282948e+00 H=2.282891e+00 dV_dx=1.093487e-05 dV_dθ=-6.730981e-05 ||∇||=3.286280e-01 | Tr=0.0760 Te/Cur=0.1167 Te/Exp=0.2061]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.58s/it] 50%|█████     | 1/2 [00:05<00:03,  3.58s/it, CE=2.273502e+00 H=2.273419e+00 dV_dx=-4.120805e-06 dV_dθ=-7.866579e-05 ||∇||=3.585157e-01 | Tr=0.1328 Te/Cur=0.1322 Te/Exp=0.2429]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.273502e+00 H=2.273419e+00 dV_dx=-4.120805e-06 dV_dθ=-7.866579e-05 ||∇||=3.585157e-01 | Tr=0.1328 Te/Cur=0.1322 Te/Exp=0.2429]100%|██████████| 2/2 [00:05<00:00,  2.72s/it, CE=2.273502e+00 H=2.273419e+00 dV_dx=-4.120805e-06 dV_dθ=-7.866579e-05 ||∇||=3.585157e-01 | Tr=0.1328 Te/Cur=0.1322 Te/Exp=0.2429]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.03s/it] 50%|█████     | 1/2 [00:11<00:09,  9.03s/it, CE=2.279583e+00 H=2.279486e+00 dV_dx=-1.545392e-05 dV_dθ=-8.210432e-05 ||∇||=3.797287e-01 | Tr=0.0888 Te/Cur=0.0959 Te/Exp=0.1603]100%|██████████| 2/2 [00:11<00:00,  4.94s/it, CE=2.279583e+00 H=2.279486e+00 dV_dx=-1.545392e-05 dV_dθ=-8.210432e-05 ||∇||=3.797287e-01 | Tr=0.0888 Te/Cur=0.0959 Te/Exp=0.1603]100%|██████████| 2/2 [00:11<00:00,  5.55s/it, CE=2.279583e+00 H=2.279486e+00 dV_dx=-1.545392e-05 dV_dθ=-8.210432e-05 ||∇||=3.797287e-01 | Tr=0.0888 Te/Cur=0.0959 Te/Exp=0.1603]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.11s/it] 50%|█████     | 1/2 [00:05<00:03,  3.11s/it, CE=2.277877e+00 H=2.277841e+00 dV_dx=9.791810e-06 dV_dθ=-4.576227e-05 ||∇||=3.056673e-01 | Tr=0.0800 Te/Cur=0.0894 Te/Exp=0.2146]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.277877e+00 H=2.277841e+00 dV_dx=9.791810e-06 dV_dθ=-4.576227e-05 ||∇||=3.056673e-01 | Tr=0.0800 Te/Cur=0.0894 Te/Exp=0.2146]100%|██████████| 2/2 [00:05<00:00,  2.67s/it, CE=2.277877e+00 H=2.277841e+00 dV_dx=9.791810e-06 dV_dθ=-4.576227e-05 ||∇||=3.056673e-01 | Tr=0.0800 Te/Cur=0.0894 Te/Exp=0.2146]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.03s/it] 50%|█████     | 1/2 [00:06<00:04,  4.03s/it, CE=2.263887e+00 H=2.263836e+00 dV_dx=-4.276033e-06 dV_dθ=-4.723279e-05 ||∇||=3.436686e-01 | Tr=0.1445 Te/Cur=0.1748 Te/Exp=0.2368]100%|██████████| 2/2 [00:06<00:00,  2.86s/it, CE=2.263887e+00 H=2.263836e+00 dV_dx=-4.276033e-06 dV_dθ=-4.723279e-05 ||∇||=3.436686e-01 | Tr=0.1445 Te/Cur=0.1748 Te/Exp=0.2368]100%|██████████| 2/2 [00:06<00:00,  3.04s/it, CE=2.263887e+00 H=2.263836e+00 dV_dx=-4.276033e-06 dV_dθ=-4.723279e-05 ||∇||=3.436686e-01 | Tr=0.1445 Te/Cur=0.1748 Te/Exp=0.2368]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.53s/it] 50%|█████     | 1/2 [00:12<00:09,  9.53s/it, CE=2.285885e+00 H=2.285776e+00 dV_dx=5.378059e-06 dV_dθ=-1.149311e-04 ||∇||=3.765479e-01 | Tr=0.1331 Te/Cur=0.1357 Te/Exp=0.2224]100%|██████████| 2/2 [00:12<00:00,  5.44s/it, CE=2.285885e+00 H=2.285776e+00 dV_dx=5.378059e-06 dV_dθ=-1.149311e-04 ||∇||=3.765479e-01 | Tr=0.1331 Te/Cur=0.1357 Te/Exp=0.2224]100%|██████████| 2/2 [00:12<00:00,  6.05s/it, CE=2.285885e+00 H=2.285776e+00 dV_dx=5.378059e-06 dV_dθ=-1.149311e-04 ||∇||=3.765479e-01 | Tr=0.1331 Te/Cur=0.1357 Te/Exp=0.2224]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.55s/it] 50%|█████     | 1/2 [00:09<00:03,  3.55s/it, CE=2.289606e+00 H=2.289514e+00 dV_dx=-6.688188e-06 dV_dθ=-8.554956e-05 ||∇||=3.719701e-01 | Tr=0.1071 Te/Cur=0.0890 Te/Exp=0.2160]100%|██████████| 2/2 [00:09<00:00,  4.75s/it, CE=2.289606e+00 H=2.289514e+00 dV_dx=-6.688188e-06 dV_dθ=-8.554956e-05 ||∇||=3.719701e-01 | Tr=0.1071 Te/Cur=0.0890 Te/Exp=0.2160]100%|██████████| 2/2 [00:09<00:00,  4.57s/it, CE=2.289606e+00 H=2.289514e+00 dV_dx=-6.688188e-06 dV_dθ=-8.554956e-05 ||∇||=3.719701e-01 | Tr=0.1071 Te/Cur=0.0890 Te/Exp=0.2160]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.25s/it] 50%|█████     | 1/2 [00:05<00:03,  3.25s/it, CE=2.272277e+00 H=2.272179e+00 dV_dx=-2.055435e-06 dV_dθ=-9.568686e-05 ||∇||=3.860837e-01 | Tr=0.1624 Te/Cur=0.1806 Te/Exp=0.2613]100%|██████████| 2/2 [00:05<00:00,  2.49s/it, CE=2.272277e+00 H=2.272179e+00 dV_dx=-2.055435e-06 dV_dθ=-9.568686e-05 ||∇||=3.860837e-01 | Tr=0.1624 Te/Cur=0.1806 Te/Exp=0.2613]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.272277e+00 H=2.272179e+00 dV_dx=-2.055435e-06 dV_dθ=-9.568686e-05 ||∇||=3.860837e-01 | Tr=0.1624 Te/Cur=0.1806 Te/Exp=0.2613]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 552, 204, 10]) with loss 2.226723
  Total candidates evaluated: 54
  Original: (3, [507, 512, 204, 10])
  Optimal: (2, [507, 552, 204, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 3→2, feed [507, 512, 204, 10]→[507, 552, 204, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 3)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:12<03:54, 12.35s/it]  5%|▌         | 1/20 [00:14<03:54, 12.35s/it, CE=2.026672e+00 H=1.692417e+00 dV_dx=3.702645e-05 dV_dθ=-3.342921e-01 ||∇||=1.879951e+01 | Tr=0.7913] 10%|█         | 2/20 [00:14<01:57,  6.53s/it, CE=2.026672e+00 H=1.692417e+00 dV_dx=3.702645e-05 dV_dθ=-3.342921e-01 ||∇||=1.879951e+01 | Tr=0.7913] 10%|█         | 2/20 [00:16<01:57,  6.53s/it, CE=1.575493e+00 H=9.620977e-01 dV_dx=-4.773019e-05 dV_dθ=-6.133480e-01 ||∇||=2.267706e+01 | Tr=0.7913] 15%|█▌        | 3/20 [00:16<01:16,  4.48s/it, CE=1.575493e+00 H=9.620977e-01 dV_dx=-4.773019e-05 dV_dθ=-6.133480e-01 ||∇||=2.267706e+01 | Tr=0.7913] 15%|█▌        | 3/20 [00:19<01:16,  4.48s/it, CE=1.356982e+00 H=2.040710e-01 dV_dx=-8.752927e-05 dV_dθ=-1.152823e+00 ||∇||=2.778582e+01 | Tr=0.7913] 20%|██        | 4/20 [00:19<00:58,  3.65s/it, CE=1.356982e+00 H=2.040710e-01 dV_dx=-8.752927e-05 dV_dθ=-1.152823e+00 ||∇||=2.778582e+01 | Tr=0.7913] 20%|██        | 4/20 [00:20<00:58,  3.65s/it, CE=1.202700e+00 H=4.704243e-01 dV_dx=-1.387755e-04 dV_dθ=-7.321366e-01 ||∇||=2.319680e+01 | Tr=0.7913] 25%|██▌       | 5/20 [00:20<00:44,  2.97s/it, CE=1.202700e+00 H=4.704243e-01 dV_dx=-1.387755e-04 dV_dθ=-7.321366e-01 ||∇||=2.319680e+01 | Tr=0.7913] 25%|██▌       | 5/20 [00:23<00:44,  2.97s/it, CE=1.100884e+00 H=7.134314e-02 dV_dx=-5.721401e-05 dV_dθ=-1.029484e+00 ||∇||=2.694982e+01 | Tr=0.7913] 30%|███       | 6/20 [00:23<00:38,  2.72s/it, CE=1.100884e+00 H=7.134314e-02 dV_dx=-5.721401e-05 dV_dθ=-1.029484e+00 ||∇||=2.694982e+01 | Tr=0.7913] 30%|███       | 6/20 [00:25<00:38,  2.72s/it, CE=1.016961e+00 H=2.997504e-01 dV_dx=1.399454e-05 dV_dθ=-7.172242e-01 ||∇||=2.321206e+01 | Tr=0.7913]  35%|███▌      | 7/20 [00:25<00:32,  2.50s/it, CE=1.016961e+00 H=2.997504e-01 dV_dx=1.399454e-05 dV_dθ=-7.172242e-01 ||∇||=2.321206e+01 | Tr=0.7913] 35%|███▌      | 7/20 [00:27<00:32,  2.50s/it, CE=9.498353e-01 H=2.922151e-01 dV_dx=-8.706346e-05 dV_dθ=-6.575332e-01 ||∇||=2.229484e+01 | Tr=0.7913] 40%|████      | 8/20 [00:27<00:27,  2.31s/it, CE=9.498353e-01 H=2.922151e-01 dV_dx=-8.706346e-05 dV_dθ=-6.575332e-01 ||∇||=2.229484e+01 | Tr=0.7913] 40%|████      | 8/20 [00:29<00:27,  2.31s/it, CE=8.953460e-01 H=3.623949e-01 dV_dx=3.667064e-05 dV_dθ=-5.329878e-01 ||∇||=2.033953e+01 | Tr=0.7913]  45%|████▌     | 9/20 [00:29<00:24,  2.20s/it, CE=8.953460e-01 H=3.623949e-01 dV_dx=3.667064e-05 dV_dθ=-5.329878e-01 ||∇||=2.033953e+01 | Tr=0.7913] 45%|████▌     | 9/20 [00:31<00:24,  2.20s/it, CE=8.494237e-01 H=3.912716e-01 dV_dx=-6.879774e-06 dV_dθ=-4.581452e-01 ||∇||=1.912257e+01 | Tr=0.7913] 50%|█████     | 10/20 [00:31<00:22,  2.24s/it, CE=8.494237e-01 H=3.912716e-01 dV_dx=-6.879774e-06 dV_dθ=-4.581452e-01 ||∇||=1.912257e+01 | Tr=0.7913] 50%|█████     | 10/20 [00:33<00:22,  2.24s/it, CE=8.105447e-01 H=3.456825e-01 dV_dx=-8.996773e-06 dV_dθ=-4.648532e-01 ||∇||=1.914900e+01 | Tr=0.7913] 55%|█████▌    | 11/20 [00:33<00:20,  2.30s/it, CE=8.105447e-01 H=3.456825e-01 dV_dx=-8.996773e-06 dV_dθ=-4.648532e-01 ||∇||=1.914900e+01 | Tr=0.7913] 55%|█████▌    | 11/20 [00:36<00:20,  2.30s/it, CE=7.760119e-01 H=3.660558e-01 dV_dx=6.706792e-05 dV_dθ=-4.100231e-01 ||∇||=1.850610e+01 | Tr=0.7913]  60%|██████    | 12/20 [00:36<00:17,  2.25s/it, CE=7.760119e-01 H=3.660558e-01 dV_dx=6.706792e-05 dV_dθ=-4.100231e-01 ||∇||=1.850610e+01 | Tr=0.7913] 60%|██████    | 12/20 [00:38<00:17,  2.25s/it, CE=7.483425e-01 H=3.432721e-01 dV_dx=9.616219e-05 dV_dθ=-4.051666e-01 ||∇||=1.851138e+01 | Tr=0.7913] 65%|██████▌   | 13/20 [00:38<00:15,  2.24s/it, CE=7.483425e-01 H=3.432721e-01 dV_dx=9.616219e-05 dV_dθ=-4.051666e-01 ||∇||=1.851138e+01 | Tr=0.7913] 65%|██████▌   | 13/20 [00:40<00:15,  2.24s/it, CE=7.257979e-01 H=2.974802e-01 dV_dx=1.662155e-05 dV_dθ=-4.283343e-01 ||∇||=1.906335e+01 | Tr=0.7913] 70%|███████   | 14/20 [00:40<00:12,  2.15s/it, CE=7.257979e-01 H=2.974802e-01 dV_dx=1.662155e-05 dV_dθ=-4.283343e-01 ||∇||=1.906335e+01 | Tr=0.7913] 70%|███████   | 14/20 [00:42<00:12,  2.15s/it, CE=7.032485e-01 H=2.948466e-01 dV_dx=-1.212336e-04 dV_dθ=-4.082806e-01 ||∇||=1.873637e+01 | Tr=0.7913] 75%|███████▌  | 15/20 [00:42<00:10,  2.19s/it, CE=7.032485e-01 H=2.948466e-01 dV_dx=-1.212336e-04 dV_dθ=-4.082806e-01 ||∇||=1.873637e+01 | Tr=0.7913] 75%|███████▌  | 15/20 [00:44<00:10,  2.19s/it, CE=6.843037e-01 H=2.871012e-01 dV_dx=4.516684e-05 dV_dθ=-3.972477e-01 ||∇||=1.880392e+01 | Tr=0.7913]  80%|████████  | 16/20 [00:44<00:08,  2.16s/it, CE=6.843037e-01 H=2.871012e-01 dV_dx=4.516684e-05 dV_dθ=-3.972477e-01 ||∇||=1.880392e+01 | Tr=0.7913] 80%|████████  | 16/20 [00:46<00:08,  2.16s/it, CE=6.650091e-01 H=2.429824e-01 dV_dx=-2.731037e-05 dV_dθ=-4.219993e-01 ||∇||=1.943834e+01 | Tr=0.7913] 85%|████████▌ | 17/20 [00:46<00:06,  2.23s/it, CE=6.650091e-01 H=2.429824e-01 dV_dx=-2.731037e-05 dV_dθ=-4.219993e-01 ||∇||=1.943834e+01 | Tr=0.7913] 85%|████████▌ | 17/20 [00:50<00:06,  2.23s/it, CE=6.453099e-01 H=1.720617e-01 dV_dx=2.096863e-04 dV_dθ=-4.734579e-01 ||∇||=1.898238e+01 | Tr=0.7913]  90%|█████████ | 18/20 [00:50<00:05,  2.76s/it, CE=6.453099e-01 H=1.720617e-01 dV_dx=2.096863e-04 dV_dθ=-4.734579e-01 ||∇||=1.898238e+01 | Tr=0.7913] 90%|█████████ | 18/20 [00:53<00:05,  2.76s/it, CE=6.295922e-01 H=1.530284e-01 dV_dx=-1.500426e-05 dV_dθ=-4.765488e-01 ||∇||=2.036450e+01 | Tr=0.7913] 95%|█████████▌| 19/20 [00:53<00:02,  2.73s/it, CE=6.295922e-01 H=1.530284e-01 dV_dx=-1.500426e-05 dV_dθ=-4.765488e-01 ||∇||=2.036450e+01 | Tr=0.7913] 95%|█████████▌| 19/20 [00:58<00:02,  2.73s/it, CE=6.148302e-01 H=1.944029e-01 dV_dx=-6.048871e-05 dV_dθ=-4.203668e-01 ||∇||=1.907984e+01 | Tr=0.7913 Te/Cur=0.9349 Te/Exp=0.7625]100%|██████████| 20/20 [01:00<00:00,  4.00s/it, CE=6.148302e-01 H=1.944029e-01 dV_dx=-6.048871e-05 dV_dθ=-4.203668e-01 ||∇||=1.907984e+01 | Tr=0.7913 Te/Cur=0.9349 Te/Exp=0.7625]100%|██████████| 20/20 [01:00<00:00,  3.03s/it, CE=6.148302e-01 H=1.944029e-01 dV_dx=-6.048871e-05 dV_dθ=-4.203668e-01 ||∇||=1.907984e+01 | Tr=0.7913 Te/Cur=0.9349 Te/Exp=0.7625]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.576934
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:05<01:47,  5.67s/it]  5%|▌         | 1/20 [00:07<01:47,  5.67s/it, CE=6.439791e-01 H=3.584838e-01 dV_dx=-2.250192e-05 dV_dθ=-2.854728e-01 ||∇||=1.641853e+01 | Tr=0.7911] 10%|█         | 2/20 [00:07<01:04,  3.57s/it, CE=6.439791e-01 H=3.584838e-01 dV_dx=-2.250192e-05 dV_dθ=-2.854728e-01 ||∇||=1.641853e+01 | Tr=0.7911] 10%|█         | 2/20 [00:10<01:04,  3.57s/it, CE=6.190368e-01 H=3.293873e-01 dV_dx=2.923799e-04 dV_dθ=-2.899418e-01 ||∇||=1.647878e+01 | Tr=0.7911]  15%|█▌        | 3/20 [00:10<00:50,  2.98s/it, CE=6.190368e-01 H=3.293873e-01 dV_dx=2.923799e-04 dV_dθ=-2.899418e-01 ||∇||=1.647878e+01 | Tr=0.7911] 15%|█▌        | 3/20 [00:12<00:50,  2.98s/it, CE=6.012044e-01 H=3.025101e-01 dV_dx=-6.550929e-05 dV_dθ=-2.986288e-01 ||∇||=1.695915e+01 | Tr=0.7911] 20%|██        | 4/20 [00:12<00:42,  2.68s/it, CE=6.012044e-01 H=3.025101e-01 dV_dx=-6.550929e-05 dV_dθ=-2.986288e-01 ||∇||=1.695915e+01 | Tr=0.7911] 20%|██        | 4/20 [00:14<00:42,  2.68s/it, CE=5.899049e-01 H=1.895388e-01 dV_dx=1.013643e-04 dV_dθ=-4.004674e-01 ||∇||=1.921472e+01 | Tr=0.7911]  25%|██▌       | 5/20 [00:14<00:38,  2.56s/it, CE=5.899049e-01 H=1.895388e-01 dV_dx=1.013643e-04 dV_dθ=-4.004674e-01 ||∇||=1.921472e+01 | Tr=0.7911] 25%|██▌       | 5/20 [00:17<00:38,  2.56s/it, CE=5.744136e-01 H=2.490525e-01 dV_dx=-7.488803e-05 dV_dθ=-3.252862e-01 ||∇||=1.742660e+01 | Tr=0.7911] 30%|███       | 6/20 [00:17<00:35,  2.52s/it, CE=5.744136e-01 H=2.490525e-01 dV_dx=-7.488803e-05 dV_dθ=-3.252862e-01 ||∇||=1.742660e+01 | Tr=0.7911] 30%|███       | 6/20 [00:19<00:35,  2.52s/it, CE=5.594103e-01 H=3.340014e-01 dV_dx=1.576959e-05 dV_dθ=-2.254246e-01 ||∇||=1.471505e+01 | Tr=0.7911]  35%|███▌      | 7/20 [00:19<00:31,  2.45s/it, CE=5.594103e-01 H=3.340014e-01 dV_dx=1.576959e-05 dV_dθ=-2.254246e-01 ||∇||=1.471505e+01 | Tr=0.7911] 35%|███▌      | 7/20 [00:21<00:31,  2.45s/it, CE=5.478546e-01 H=3.558784e-01 dV_dx=-1.228956e-04 dV_dθ=-1.918533e-01 ||∇||=1.389256e+01 | Tr=0.7911] 40%|████      | 8/20 [00:21<00:28,  2.40s/it, CE=5.478546e-01 H=3.558784e-01 dV_dx=-1.228956e-04 dV_dθ=-1.918533e-01 ||∇||=1.389256e+01 | Tr=0.7911] 40%|████      | 8/20 [00:24<00:28,  2.40s/it, CE=5.382100e-01 H=3.517732e-01 dV_dx=-5.330086e-05 dV_dθ=-1.863835e-01 ||∇||=1.346637e+01 | Tr=0.7911] 45%|████▌     | 9/20 [00:24<00:26,  2.40s/it, CE=5.382100e-01 H=3.517732e-01 dV_dx=-5.330086e-05 dV_dθ=-1.863835e-01 ||∇||=1.346637e+01 | Tr=0.7911] 45%|████▌     | 9/20 [00:26<00:26,  2.40s/it, CE=5.296728e-01 H=3.262166e-01 dV_dx=2.145480e-05 dV_dθ=-2.034777e-01 ||∇||=1.377235e+01 | Tr=0.7911]  50%|█████     | 10/20 [00:26<00:23,  2.34s/it, CE=5.296728e-01 H=3.262166e-01 dV_dx=2.145480e-05 dV_dθ=-2.034777e-01 ||∇||=1.377235e+01 | Tr=0.7911] 50%|█████     | 10/20 [00:28<00:23,  2.34s/it, CE=5.241161e-01 H=2.993666e-01 dV_dx=1.089741e-04 dV_dθ=-2.248585e-01 ||∇||=1.449812e+01 | Tr=0.7911] 55%|█████▌    | 11/20 [00:28<00:21,  2.35s/it, CE=5.241161e-01 H=2.993666e-01 dV_dx=1.089741e-04 dV_dθ=-2.248585e-01 ||∇||=1.449812e+01 | Tr=0.7911] 55%|█████▌    | 11/20 [00:30<00:21,  2.35s/it, CE=5.202015e-01 H=2.468980e-01 dV_dx=-3.839191e-05 dV_dθ=-2.732651e-01 ||∇||=1.570718e+01 | Tr=0.7911] 60%|██████    | 12/20 [00:30<00:18,  2.35s/it, CE=5.202015e-01 H=2.468980e-01 dV_dx=-3.839191e-05 dV_dθ=-2.732651e-01 ||∇||=1.570718e+01 | Tr=0.7911] 60%|██████    | 12/20 [00:33<00:18,  2.35s/it, CE=5.134615e-01 H=2.234513e-01 dV_dx=-1.178953e-05 dV_dθ=-2.899984e-01 ||∇||=1.625061e+01 | Tr=0.7911] 65%|██████▌   | 13/20 [00:33<00:16,  2.41s/it, CE=5.134615e-01 H=2.234513e-01 dV_dx=-1.178953e-05 dV_dθ=-2.899984e-01 ||∇||=1.625061e+01 | Tr=0.7911] 65%|██████▌   | 13/20 [00:35<00:16,  2.41s/it, CE=4.949297e-01 H=3.342582e-01 dV_dx=4.853339e-05 dV_dθ=-1.607201e-01 ||∇||=1.280781e+01 | Tr=0.7911]  70%|███████   | 14/20 [00:35<00:14,  2.33s/it, CE=4.949297e-01 H=3.342582e-01 dV_dx=4.853339e-05 dV_dθ=-1.607201e-01 ||∇||=1.280781e+01 | Tr=0.7911] 70%|███████   | 14/20 [00:37<00:14,  2.33s/it, CE=4.790348e-01 H=3.647338e-01 dV_dx=9.122716e-05 dV_dθ=-1.143922e-01 ||∇||=1.119407e+01 | Tr=0.7911] 75%|███████▌  | 15/20 [00:37<00:11,  2.24s/it, CE=4.790348e-01 H=3.647338e-01 dV_dx=9.122716e-05 dV_dθ=-1.143922e-01 ||∇||=1.119407e+01 | Tr=0.7911] 75%|███████▌  | 15/20 [00:39<00:11,  2.24s/it, CE=4.697977e-01 H=3.771597e-01 dV_dx=-2.862964e-05 dV_dθ=-9.260937e-02 ||∇||=1.034844e+01 | Tr=0.7911] 80%|████████  | 16/20 [00:39<00:08,  2.25s/it, CE=4.697977e-01 H=3.771597e-01 dV_dx=-2.862964e-05 dV_dθ=-9.260937e-02 ||∇||=1.034844e+01 | Tr=0.7911] 80%|████████  | 16/20 [00:41<00:08,  2.25s/it, CE=4.638300e-01 H=3.663877e-01 dV_dx=-2.200030e-05 dV_dθ=-9.742023e-02 ||∇||=1.045851e+01 | Tr=0.7911] 85%|████████▌ | 17/20 [00:41<00:06,  2.17s/it, CE=4.638300e-01 H=3.663877e-01 dV_dx=-2.200030e-05 dV_dθ=-9.742023e-02 ||∇||=1.045851e+01 | Tr=0.7911] 85%|████████▌ | 17/20 [00:44<00:06,  2.17s/it, CE=4.575896e-01 H=3.635645e-01 dV_dx=-1.637594e-05 dV_dθ=-9.400870e-02 ||∇||=1.045922e+01 | Tr=0.7911] 90%|█████████ | 18/20 [00:44<00:04,  2.14s/it, CE=4.575896e-01 H=3.635645e-01 dV_dx=-1.637594e-05 dV_dθ=-9.400870e-02 ||∇||=1.045922e+01 | Tr=0.7911] 90%|█████████ | 18/20 [00:45<00:04,  2.14s/it, CE=4.553030e-01 H=3.545932e-01 dV_dx=-4.316160e-05 dV_dθ=-1.006666e-01 ||∇||=1.110815e+01 | Tr=0.7911] 95%|█████████▌| 19/20 [00:45<00:02,  2.01s/it, CE=4.553030e-01 H=3.545932e-01 dV_dx=-4.316160e-05 dV_dθ=-1.006666e-01 ||∇||=1.110815e+01 | Tr=0.7911] 95%|█████████▌| 19/20 [00:49<00:02,  2.01s/it, CE=4.550780e-01 H=3.320501e-01 dV_dx=-4.908034e-05 dV_dθ=-1.229788e-01 ||∇||=1.199222e+01 | Tr=0.7911 Te/Cur=0.9603 Te/Exp=0.8132]100%|██████████| 20/20 [00:53<00:00,  3.59s/it, CE=4.550780e-01 H=3.320501e-01 dV_dx=-4.908034e-05 dV_dθ=-1.229788e-01 ||∇||=1.199222e+01 | Tr=0.7911 Te/Cur=0.9603 Te/Exp=0.8132]100%|██████████| 20/20 [00:53<00:00,  2.65s/it, CE=4.550780e-01 H=3.320501e-01 dV_dx=-4.908034e-05 dV_dθ=-1.229788e-01 ||∇||=1.199222e+01 | Tr=0.7911 Te/Cur=0.9603 Te/Exp=0.8132]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.68s/it] 50%|█████     | 1/2 [00:13<00:09,  9.68s/it, CE=4.992389e-01 H=4.953487e-01 dV_dx=-1.630205e-04 dV_dθ=-3.727166e-03 ||∇||=2.405378e+00 | Tr=0.9816 Te/Cur=0.9651 Te/Exp=0.8210]100%|██████████| 2/2 [00:13<00:00,  6.14s/it, CE=4.992389e-01 H=4.953487e-01 dV_dx=-1.630205e-04 dV_dθ=-3.727166e-03 ||∇||=2.405378e+00 | Tr=0.9816 Te/Cur=0.9651 Te/Exp=0.8210]100%|██████████| 2/2 [00:13<00:00,  6.67s/it, CE=4.992389e-01 H=4.953487e-01 dV_dx=-1.630205e-04 dV_dθ=-3.727166e-03 ||∇||=2.405378e+00 | Tr=0.9816 Te/Cur=0.9651 Te/Exp=0.8210]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:13, 10.20s/it]  5%|▌         | 1/20 [00:12<03:13, 10.20s/it, CE=4.898746e-01 H=4.875370e-01 dV_dx=-2.021975e-04 dV_dθ=-2.135451e-03 ||∇||=2.074464e+00 | Tr=0.9837] 10%|█         | 2/20 [00:12<01:38,  5.45s/it, CE=4.898746e-01 H=4.875370e-01 dV_dx=-2.021975e-04 dV_dθ=-2.135451e-03 ||∇||=2.074464e+00 | Tr=0.9837] 10%|█         | 2/20 [00:14<01:38,  5.45s/it, CE=4.754369e-01 H=4.733680e-01 dV_dx=6.934724e-06 dV_dθ=-2.075819e-03 ||∇||=2.025828e+00 | Tr=0.9845]  15%|█▌        | 3/20 [00:14<01:08,  4.01s/it, CE=4.754369e-01 H=4.733680e-01 dV_dx=6.934724e-06 dV_dθ=-2.075819e-03 ||∇||=2.025828e+00 | Tr=0.9845] 15%|█▌        | 3/20 [00:16<01:08,  4.01s/it, CE=4.636524e-01 H=4.615915e-01 dV_dx=-1.672749e-05 dV_dθ=-2.044169e-03 ||∇||=1.990553e+00 | Tr=0.9851] 20%|██        | 4/20 [00:16<00:52,  3.26s/it, CE=4.636524e-01 H=4.615915e-01 dV_dx=-1.672749e-05 dV_dθ=-2.044169e-03 ||∇||=1.990553e+00 | Tr=0.9851] 20%|██        | 4/20 [00:19<00:52,  3.26s/it, CE=4.530811e-01 H=4.511656e-01 dV_dx=-3.532786e-05 dV_dθ=-1.880192e-03 ||∇||=1.944562e+00 | Tr=0.9859] 25%|██▌       | 5/20 [00:19<00:45,  3.03s/it, CE=4.530811e-01 H=4.511656e-01 dV_dx=-3.532786e-05 dV_dθ=-1.880192e-03 ||∇||=1.944562e+00 | Tr=0.9859] 25%|██▌       | 5/20 [00:22<00:45,  3.03s/it, CE=4.438040e-01 H=4.419537e-01 dV_dx=-4.231585e-05 dV_dθ=-1.808018e-03 ||∇||=1.919249e+00 | Tr=0.9865 Te/Cur=0.9705 Te/Exp=0.8256] 30%|███       | 6/20 [00:22<00:42,  3.06s/it, CE=4.438040e-01 H=4.419537e-01 dV_dx=-4.231585e-05 dV_dθ=-1.808018e-03 ||∇||=1.919249e+00 | Tr=0.9865 Te/Cur=0.9705 Te/Exp=0.8256] 30%|███       | 6/20 [00:24<00:42,  3.06s/it, CE=4.355278e-01 H=4.338513e-01 dV_dx=1.314803e-04 dV_dθ=-1.808004e-03 ||∇||=1.902889e+00 | Tr=0.9870]                              35%|███▌      | 7/20 [00:24<00:34,  2.66s/it, CE=4.355278e-01 H=4.338513e-01 dV_dx=1.314803e-04 dV_dθ=-1.808004e-03 ||∇||=1.902889e+00 | Tr=0.9870] 35%|███▌      | 7/20 [00:26<00:34,  2.66s/it, CE=4.278663e-01 H=4.260977e-01 dV_dx=-3.929721e-05 dV_dθ=-1.729315e-03 ||∇||=1.881851e+00 | Tr=0.9876] 40%|████      | 8/20 [00:26<00:29,  2.44s/it, CE=4.278663e-01 H=4.260977e-01 dV_dx=-3.929721e-05 dV_dθ=-1.729315e-03 ||∇||=1.881851e+00 | Tr=0.9876] 40%|████      | 8/20 [00:27<00:29,  2.44s/it, CE=4.206876e-01 H=4.189767e-01 dV_dx=-3.763905e-06 dV_dθ=-1.707162e-03 ||∇||=1.857239e+00 | Tr=0.9880] 45%|████▌     | 9/20 [00:27<00:24,  2.21s/it, CE=4.206876e-01 H=4.189767e-01 dV_dx=-3.763905e-06 dV_dθ=-1.707162e-03 ||∇||=1.857239e+00 | Tr=0.9880] 45%|████▌     | 9/20 [00:29<00:24,  2.21s/it, CE=4.139615e-01 H=4.123157e-01 dV_dx=2.269915e-05 dV_dθ=-1.668533e-03 ||∇||=1.829744e+00 | Tr=0.9885]  50%|█████     | 10/20 [00:29<00:21,  2.11s/it, CE=4.139615e-01 H=4.123157e-01 dV_dx=2.269915e-05 dV_dθ=-1.668533e-03 ||∇||=1.829744e+00 | Tr=0.9885] 50%|█████     | 10/20 [00:33<00:21,  2.11s/it, CE=4.078750e-01 H=4.063320e-01 dV_dx=3.602734e-05 dV_dθ=-1.579047e-03 ||∇||=1.797584e+00 | Tr=0.9890 Te/Cur=0.9705 Te/Exp=0.8257] 55%|█████▌    | 11/20 [00:33<00:22,  2.52s/it, CE=4.078750e-01 H=4.063320e-01 dV_dx=3.602734e-05 dV_dθ=-1.579047e-03 ||∇||=1.797584e+00 | Tr=0.9890 Te/Cur=0.9705 Te/Exp=0.8257] 55%|█████▌    | 11/20 [00:35<00:22,  2.52s/it, CE=4.020340e-01 H=4.004024e-01 dV_dx=6.364051e-05 dV_dθ=-1.695245e-03 ||∇||=1.800903e+00 | Tr=0.9894]                             60%|██████    | 12/20 [00:35<00:18,  2.34s/it, CE=4.020340e-01 H=4.004024e-01 dV_dx=6.364051e-05 dV_dθ=-1.695245e-03 ||∇||=1.800903e+00 | Tr=0.9894] 60%|██████    | 12/20 [00:37<00:18,  2.34s/it, CE=3.965664e-01 H=3.950867e-01 dV_dx=5.459803e-05 dV_dθ=-1.534328e-03 ||∇||=1.762627e+00 | Tr=0.9901] 65%|██████▌   | 13/20 [00:37<00:15,  2.22s/it, CE=3.965664e-01 H=3.950867e-01 dV_dx=5.459803e-05 dV_dθ=-1.534328e-03 ||∇||=1.762627e+00 | Tr=0.9901] 65%|██████▌   | 13/20 [00:39<00:15,  2.22s/it, CE=3.915035e-01 H=3.898448e-01 dV_dx=-5.527855e-05 dV_dθ=-1.603433e-03 ||∇||=1.761835e+00 | Tr=0.9904] 70%|███████   | 14/20 [00:39<00:13,  2.20s/it, CE=3.915035e-01 H=3.898448e-01 dV_dx=-5.527855e-05 dV_dθ=-1.603433e-03 ||∇||=1.761835e+00 | Tr=0.9904] 70%|███████   | 14/20 [00:41<00:13,  2.20s/it, CE=3.864441e-01 H=3.848611e-01 dV_dx=-5.646855e-06 dV_dθ=-1.577276e-03 ||∇||=1.751947e+00 | Tr=0.9906] 75%|███████▌  | 15/20 [00:41<00:10,  2.13s/it, CE=3.864441e-01 H=3.848611e-01 dV_dx=-5.646855e-06 dV_dθ=-1.577276e-03 ||∇||=1.751947e+00 | Tr=0.9906] 75%|███████▌  | 15/20 [00:44<00:10,  2.13s/it, CE=3.817755e-01 H=3.804429e-01 dV_dx=2.182680e-04 dV_dθ=-1.550815e-03 ||∇||=1.749712e+00 | Tr=0.9908 Te/Cur=0.9710 Te/Exp=0.8383] 80%|████████  | 16/20 [00:44<00:10,  2.56s/it, CE=3.817755e-01 H=3.804429e-01 dV_dx=2.182680e-04 dV_dθ=-1.550815e-03 ||∇||=1.749712e+00 | Tr=0.9908 Te/Cur=0.9710 Te/Exp=0.8383] 80%|████████  | 16/20 [00:46<00:10,  2.56s/it, CE=3.773210e-01 H=3.757425e-01 dV_dx=-3.802301e-05 dV_dθ=-1.540545e-03 ||∇||=1.739232e+00 | Tr=0.9913]                            85%|████████▌ | 17/20 [00:46<00:06,  2.31s/it, CE=3.773210e-01 H=3.757425e-01 dV_dx=-3.802301e-05 dV_dθ=-1.540545e-03 ||∇||=1.739232e+00 | Tr=0.9913] 85%|████████▌ | 17/20 [00:48<00:06,  2.31s/it, CE=3.730979e-01 H=3.715913e-01 dV_dx=-8.206816e-07 dV_dθ=-1.505732e-03 ||∇||=1.719572e+00 | Tr=0.9917] 90%|█████████ | 18/20 [00:48<00:04,  2.32s/it, CE=3.730979e-01 H=3.715913e-01 dV_dx=-8.206816e-07 dV_dθ=-1.505732e-03 ||∇||=1.719572e+00 | Tr=0.9917] 90%|█████████ | 18/20 [00:50<00:04,  2.32s/it, CE=3.689722e-01 H=3.673715e-01 dV_dx=-7.311824e-05 dV_dθ=-1.527573e-03 ||∇||=1.704796e+00 | Tr=0.9922] 95%|█████████▌| 19/20 [00:50<00:02,  2.20s/it, CE=3.689722e-01 H=3.673715e-01 dV_dx=-7.311824e-05 dV_dθ=-1.527573e-03 ||∇||=1.704796e+00 | Tr=0.9922] 95%|█████████▌| 19/20 [00:55<00:02,  2.20s/it, CE=3.650685e-01 H=3.633538e-01 dV_dx=-9.590334e-05 dV_dθ=-1.618816e-03 ||∇||=1.714817e+00 | Tr=0.9925 Te/Cur=0.9724 Te/Exp=0.8339]100%|██████████| 20/20 [00:55<00:00,  2.91s/it, CE=3.650685e-01 H=3.633538e-01 dV_dx=-9.590334e-05 dV_dθ=-1.618816e-03 ||∇||=1.714817e+00 | Tr=0.9925 Te/Cur=0.9724 Te/Exp=0.8339]100%|██████████| 20/20 [00:55<00:00,  2.77s/it, CE=3.650685e-01 H=3.633538e-01 dV_dx=-9.590334e-05 dV_dθ=-1.618816e-03 ||∇||=1.714817e+00 | Tr=0.9925 Te/Cur=0.9724 Te/Exp=0.8339]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 7 final loss: 0.373422
======================================================================


  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7627
    Task 1: 0.9239
    Task 2: 0.8184
    Task 3: 0.5891
    Task 4: 0.9185
    Task 5: 0.9143
    Task 6: 0.9182
    Task 7: 0.9729

============================================================
Task 8
============================================================
Initial loss on new task: 7.7369, previous: 0.3651, ratio: 21.19
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 8
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:08<?, ?it/s, CE=6.147900e-01 H=5.305070e-01 dV_dx=-1.561681e-04 dV_dθ=-8.412680e-02 ||∇||=9.495936e+00 | Tr=0.7075 Te/Cur=0.8396 Te/Exp=0.8128]100%|██████████| 1/1 [00:08<00:00,  8.82s/it, CE=6.147900e-01 H=5.305070e-01 dV_dx=-1.561681e-04 dV_dθ=-8.412680e-02 ||∇||=9.495936e+00 | Tr=0.7075 Te/Cur=0.8396 Te/Exp=0.8128]100%|██████████| 1/1 [00:08<00:00,  8.82s/it, CE=6.147900e-01 H=5.305070e-01 dV_dx=-1.561681e-04 dV_dθ=-8.412680e-02 ||∇||=9.495936e+00 | Tr=0.7075 Te/Cur=0.8396 Te/Exp=0.8128]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.614790

[STEP 2] Architecture change decision
  Current: 0.614790, Previous: 0.365068
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 39932 samples from 10 classes
  Starting grid architecture search for task 8
  Baseline architecture: (2, [507, 552, 204, 10])
  Baseline loss: 0.614790
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.45s/it] 50%|█████     | 1/2 [00:05<00:03,  3.45s/it, CE=2.256019e+00 H=2.255966e+00 dV_dx=4.649040e-06 dV_dθ=-5.727328e-05 ||∇||=4.825421e-01 | Tr=0.0659 Te/Cur=0.0790 Te/Exp=0.1931]100%|██████████| 2/2 [00:05<00:00,  2.39s/it, CE=2.256019e+00 H=2.255966e+00 dV_dx=4.649040e-06 dV_dθ=-5.727328e-05 ||∇||=4.825421e-01 | Tr=0.0659 Te/Cur=0.0790 Te/Exp=0.1931]100%|██████████| 2/2 [00:05<00:00,  2.55s/it, CE=2.256019e+00 H=2.255966e+00 dV_dx=4.649040e-06 dV_dθ=-5.727328e-05 ||∇||=4.825421e-01 | Tr=0.0659 Te/Cur=0.0790 Te/Exp=0.1931]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2560191071527855
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.10s/it] 50%|█████     | 1/2 [00:04<00:03,  3.10s/it, CE=2.265046e+00 H=2.264926e+00 dV_dx=1.555923e-06 dV_dθ=-1.218560e-04 ||∇||=4.740066e-01 | Tr=0.1561 Te/Cur=0.1848 Te/Exp=0.1889]100%|██████████| 2/2 [00:04<00:00,  2.37s/it, CE=2.265046e+00 H=2.264926e+00 dV_dx=1.555923e-06 dV_dθ=-1.218560e-04 ||∇||=4.740066e-01 | Tr=0.1561 Te/Cur=0.1848 Te/Exp=0.1889]100%|██████████| 2/2 [00:04<00:00,  2.48s/it, CE=2.265046e+00 H=2.264926e+00 dV_dx=1.555923e-06 dV_dθ=-1.218560e-04 ||∇||=4.740066e-01 | Tr=0.1561 Te/Cur=0.1848 Te/Exp=0.1889]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.63s/it] 50%|█████     | 1/2 [00:08<00:03,  3.63s/it, CE=2.268602e+00 H=2.268535e+00 dV_dx=-2.708748e-06 dV_dθ=-6.421771e-05 ||∇||=4.224394e-01 | Tr=0.0988 Te/Cur=0.1211 Te/Exp=0.1751]100%|██████████| 2/2 [00:08<00:00,  4.56s/it, CE=2.268602e+00 H=2.268535e+00 dV_dx=-2.708748e-06 dV_dθ=-6.421771e-05 ||∇||=4.224394e-01 | Tr=0.0988 Te/Cur=0.1211 Te/Exp=0.1751]100%|██████████| 2/2 [00:08<00:00,  4.42s/it, CE=2.268602e+00 H=2.268535e+00 dV_dx=-2.708748e-06 dV_dθ=-6.421771e-05 ||∇||=4.224394e-01 | Tr=0.0988 Te/Cur=0.1211 Te/Exp=0.1751]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.90s/it] 50%|█████     | 1/2 [00:05<00:02,  2.90s/it, CE=2.250556e+00 H=2.250540e+00 dV_dx=-3.308810e-06 dV_dθ=-1.335896e-05 ||∇||=4.515571e-01 | Tr=0.1594 Te/Cur=0.1651 Te/Exp=0.2236]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.250556e+00 H=2.250540e+00 dV_dx=-3.308810e-06 dV_dθ=-1.335896e-05 ||∇||=4.515571e-01 | Tr=0.1594 Te/Cur=0.1651 Te/Exp=0.2236]100%|██████████| 2/2 [00:05<00:00,  2.50s/it, CE=2.250556e+00 H=2.250540e+00 dV_dx=-3.308810e-06 dV_dθ=-1.335896e-05 ||∇||=4.515571e-01 | Tr=0.1594 Te/Cur=0.1651 Te/Exp=0.2236]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 204, 10]) with loss 2.250556
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.80s/it] 50%|█████     | 1/2 [00:05<00:03,  3.80s/it, CE=2.248240e+00 H=2.248151e+00 dV_dx=-9.838496e-06 dV_dθ=-7.872980e-05 ||∇||=4.973197e-01 | Tr=0.1815 Te/Cur=0.1803 Te/Exp=0.2670]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.248240e+00 H=2.248151e+00 dV_dx=-9.838496e-06 dV_dθ=-7.872980e-05 ||∇||=4.973197e-01 | Tr=0.1815 Te/Cur=0.1803 Te/Exp=0.2670]100%|██████████| 2/2 [00:05<00:00,  2.85s/it, CE=2.248240e+00 H=2.248151e+00 dV_dx=-9.838496e-06 dV_dθ=-7.872980e-05 ||∇||=4.973197e-01 | Tr=0.1815 Te/Cur=0.1803 Te/Exp=0.2670]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 204, 10]) with loss 2.248240
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.65s/it] 50%|█████     | 1/2 [00:05<00:03,  3.65s/it, CE=2.261977e+00 H=2.261884e+00 dV_dx=-1.416771e-06 dV_dθ=-9.127560e-05 ||∇||=4.728314e-01 | Tr=0.1786 Te/Cur=0.1790 Te/Exp=0.2119]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.261977e+00 H=2.261884e+00 dV_dx=-1.416771e-06 dV_dθ=-9.127560e-05 ||∇||=4.728314e-01 | Tr=0.1786 Te/Cur=0.1790 Te/Exp=0.2119]100%|██████████| 2/2 [00:05<00:00,  2.81s/it, CE=2.261977e+00 H=2.261884e+00 dV_dx=-1.416771e-06 dV_dθ=-9.127560e-05 ||∇||=4.728314e-01 | Tr=0.1786 Te/Cur=0.1790 Te/Exp=0.2119]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.53s/it] 50%|█████     | 1/2 [00:05<00:03,  3.53s/it, CE=2.262079e+00 H=2.262005e+00 dV_dx=2.796836e-06 dV_dθ=-7.679437e-05 ||∇||=4.275131e-01 | Tr=0.1502 Te/Cur=0.1914 Te/Exp=0.2582]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.262079e+00 H=2.262005e+00 dV_dx=2.796836e-06 dV_dθ=-7.679437e-05 ||∇||=4.275131e-01 | Tr=0.1502 Te/Cur=0.1914 Te/Exp=0.2582]100%|██████████| 2/2 [00:05<00:00,  2.81s/it, CE=2.262079e+00 H=2.262005e+00 dV_dx=2.796836e-06 dV_dθ=-7.679437e-05 ||∇||=4.275131e-01 | Tr=0.1502 Te/Cur=0.1914 Te/Exp=0.2582]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.11s/it] 50%|█████     | 1/2 [00:05<00:04,  4.11s/it, CE=2.249384e+00 H=2.249318e+00 dV_dx=-6.239657e-06 dV_dθ=-5.965243e-05 ||∇||=4.597257e-01 | Tr=0.1279 Te/Cur=0.1225 Te/Exp=0.2313]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.249384e+00 H=2.249318e+00 dV_dx=-6.239657e-06 dV_dθ=-5.965243e-05 ||∇||=4.597257e-01 | Tr=0.1279 Te/Cur=0.1225 Te/Exp=0.2313]100%|██████████| 2/2 [00:05<00:00,  2.87s/it, CE=2.249384e+00 H=2.249318e+00 dV_dx=-6.239657e-06 dV_dθ=-5.965243e-05 ||∇||=4.597257e-01 | Tr=0.1279 Te/Cur=0.1225 Te/Exp=0.2313]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.51s/it] 50%|█████     | 1/2 [00:05<00:03,  3.51s/it, CE=2.254125e+00 H=2.254014e+00 dV_dx=-1.045778e-06 dV_dθ=-1.104710e-04 ||∇||=4.795606e-01 | Tr=0.1609 Te/Cur=0.1797 Te/Exp=0.2524]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.254125e+00 H=2.254014e+00 dV_dx=-1.045778e-06 dV_dθ=-1.104710e-04 ||∇||=4.795606e-01 | Tr=0.1609 Te/Cur=0.1797 Te/Exp=0.2524]100%|██████████| 2/2 [00:05<00:00,  2.74s/it, CE=2.254125e+00 H=2.254014e+00 dV_dx=-1.045778e-06 dV_dθ=-1.104710e-04 ||∇||=4.795606e-01 | Tr=0.1609 Te/Cur=0.1797 Te/Exp=0.2524]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.28s/it] 50%|█████     | 1/2 [00:05<00:03,  3.28s/it, CE=2.271771e+00 H=2.271735e+00 dV_dx=9.609021e-06 dV_dθ=-4.546958e-05 ||∇||=3.730870e-01 | Tr=0.1153 Te/Cur=0.1101 Te/Exp=0.2418]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.271771e+00 H=2.271735e+00 dV_dx=9.609021e-06 dV_dθ=-4.546958e-05 ||∇||=3.730870e-01 | Tr=0.1153 Te/Cur=0.1101 Te/Exp=0.2418]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.271771e+00 H=2.271735e+00 dV_dx=9.609021e-06 dV_dθ=-4.546958e-05 ||∇||=3.730870e-01 | Tr=0.1153 Te/Cur=0.1101 Te/Exp=0.2418]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.41s/it] 50%|█████     | 1/2 [00:04<00:03,  3.41s/it, CE=2.265747e+00 H=2.265650e+00 dV_dx=-1.239406e-05 dV_dθ=-8.497943e-05 ||∇||=3.904377e-01 | Tr=0.0937 Te/Cur=0.1345 Te/Exp=0.2024]100%|██████████| 2/2 [00:04<00:00,  2.34s/it, CE=2.265747e+00 H=2.265650e+00 dV_dx=-1.239406e-05 dV_dθ=-8.497943e-05 ||∇||=3.904377e-01 | Tr=0.0937 Te/Cur=0.1345 Te/Exp=0.2024]100%|██████████| 2/2 [00:04<00:00,  2.50s/it, CE=2.265747e+00 H=2.265650e+00 dV_dx=-1.239406e-05 dV_dθ=-8.497943e-05 ||∇||=3.904377e-01 | Tr=0.0937 Te/Cur=0.1345 Te/Exp=0.2024]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.40s/it] 50%|█████     | 1/2 [00:05<00:03,  3.40s/it, CE=2.265536e+00 H=2.265448e+00 dV_dx=-4.431569e-07 dV_dθ=-8.765332e-05 ||∇||=3.719240e-01 | Tr=0.1076 Te/Cur=0.1117 Te/Exp=0.2516]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.265536e+00 H=2.265448e+00 dV_dx=-4.431569e-07 dV_dθ=-8.765332e-05 ||∇||=3.719240e-01 | Tr=0.1076 Te/Cur=0.1117 Te/Exp=0.2516]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.265536e+00 H=2.265448e+00 dV_dx=-4.431569e-07 dV_dθ=-8.765332e-05 ||∇||=3.719240e-01 | Tr=0.1076 Te/Cur=0.1117 Te/Exp=0.2516]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.53s/it] 50%|█████     | 1/2 [00:08<00:06,  6.53s/it, CE=2.255675e+00 H=2.255566e+00 dV_dx=-6.137896e-06 dV_dθ=-1.032934e-04 ||∇||=3.922817e-01 | Tr=0.1718 Te/Cur=0.2365 Te/Exp=0.2451]100%|██████████| 2/2 [00:08<00:00,  3.93s/it, CE=2.255675e+00 H=2.255566e+00 dV_dx=-6.137896e-06 dV_dθ=-1.032934e-04 ||∇||=3.922817e-01 | Tr=0.1718 Te/Cur=0.2365 Te/Exp=0.2451]100%|██████████| 2/2 [00:08<00:00,  4.32s/it, CE=2.255675e+00 H=2.255566e+00 dV_dx=-6.137896e-06 dV_dθ=-1.032934e-04 ||∇||=3.922817e-01 | Tr=0.1718 Te/Cur=0.2365 Te/Exp=0.2451]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.42s/it] 50%|█████     | 1/2 [00:05<00:03,  3.42s/it, CE=2.254340e+00 H=2.254266e+00 dV_dx=-5.588703e-06 dV_dθ=-6.836074e-05 ||∇||=3.993572e-01 | Tr=0.1597 Te/Cur=0.1764 Te/Exp=0.2478]100%|██████████| 2/2 [00:05<00:00,  2.50s/it, CE=2.254340e+00 H=2.254266e+00 dV_dx=-5.588703e-06 dV_dθ=-6.836074e-05 ||∇||=3.993572e-01 | Tr=0.1597 Te/Cur=0.1764 Te/Exp=0.2478]100%|██████████| 2/2 [00:05<00:00,  2.64s/it, CE=2.254340e+00 H=2.254266e+00 dV_dx=-5.588703e-06 dV_dθ=-6.836074e-05 ||∇||=3.993572e-01 | Tr=0.1597 Te/Cur=0.1764 Te/Exp=0.2478]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.64s/it] 50%|█████     | 1/2 [00:05<00:03,  3.64s/it, CE=2.267281e+00 H=2.267215e+00 dV_dx=-8.079894e-06 dV_dθ=-5.804358e-05 ||∇||=3.649800e-01 | Tr=0.1886 Te/Cur=0.2411 Te/Exp=0.2350]100%|██████████| 2/2 [00:05<00:00,  2.76s/it, CE=2.267281e+00 H=2.267215e+00 dV_dx=-8.079894e-06 dV_dθ=-5.804358e-05 ||∇||=3.649800e-01 | Tr=0.1886 Te/Cur=0.2411 Te/Exp=0.2350]100%|██████████| 2/2 [00:05<00:00,  2.89s/it, CE=2.267281e+00 H=2.267215e+00 dV_dx=-8.079894e-06 dV_dθ=-5.804358e-05 ||∇||=3.649800e-01 | Tr=0.1886 Te/Cur=0.2411 Te/Exp=0.2350]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.52s/it] 50%|█████     | 1/2 [00:05<00:03,  3.52s/it, CE=2.265087e+00 H=2.265029e+00 dV_dx=-5.144272e-06 dV_dθ=-5.237587e-05 ||∇||=3.498553e-01 | Tr=0.1491 Te/Cur=0.1965 Te/Exp=0.2490]100%|██████████| 2/2 [00:05<00:00,  2.53s/it, CE=2.265087e+00 H=2.265029e+00 dV_dx=-5.144272e-06 dV_dθ=-5.237587e-05 ||∇||=3.498553e-01 | Tr=0.1491 Te/Cur=0.1965 Te/Exp=0.2490]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.265087e+00 H=2.265029e+00 dV_dx=-5.144272e-06 dV_dθ=-5.237587e-05 ||∇||=3.498553e-01 | Tr=0.1491 Te/Cur=0.1965 Te/Exp=0.2490]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.41s/it] 50%|█████     | 1/2 [00:05<00:03,  3.41s/it, CE=2.259242e+00 H=2.259178e+00 dV_dx=-5.458079e-07 dV_dθ=-6.420999e-05 ||∇||=4.000653e-01 | Tr=0.1058 Te/Cur=0.1120 Te/Exp=0.2468]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.259242e+00 H=2.259178e+00 dV_dx=-5.458079e-07 dV_dθ=-6.420999e-05 ||∇||=4.000653e-01 | Tr=0.1058 Te/Cur=0.1120 Te/Exp=0.2468]100%|██████████| 2/2 [00:05<00:00,  2.77s/it, CE=2.259242e+00 H=2.259178e+00 dV_dx=-5.458079e-07 dV_dθ=-6.420999e-05 ||∇||=4.000653e-01 | Tr=0.1058 Te/Cur=0.1120 Te/Exp=0.2468]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.267162e+00 H=2.267061e+00 dV_dx=2.358217e-07 dV_dθ=-1.014364e-04 ||∇||=4.197629e-01 | Tr=0.1365 Te/Cur=0.1859 Te/Exp=0.2383]100%|██████████| 2/2 [00:05<00:00,  2.44s/it, CE=2.267162e+00 H=2.267061e+00 dV_dx=2.358217e-07 dV_dθ=-1.014364e-04 ||∇||=4.197629e-01 | Tr=0.1365 Te/Cur=0.1859 Te/Exp=0.2383]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.267162e+00 H=2.267061e+00 dV_dx=2.358217e-07 dV_dθ=-1.014364e-04 ||∇||=4.197629e-01 | Tr=0.1365 Te/Cur=0.1859 Te/Exp=0.2383]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.08s/it] 50%|█████     | 1/2 [00:05<00:03,  3.08s/it, CE=2.281443e+00 H=2.281355e+00 dV_dx=-2.244716e-06 dV_dθ=-8.527640e-05 ||∇||=4.053848e-01 | Tr=0.1019 Te/Cur=0.1132 Te/Exp=0.2272]100%|██████████| 2/2 [00:05<00:00,  2.44s/it, CE=2.281443e+00 H=2.281355e+00 dV_dx=-2.244716e-06 dV_dθ=-8.527640e-05 ||∇||=4.053848e-01 | Tr=0.1019 Te/Cur=0.1132 Te/Exp=0.2272]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.281443e+00 H=2.281355e+00 dV_dx=-2.244716e-06 dV_dθ=-8.527640e-05 ||∇||=4.053848e-01 | Tr=0.1019 Te/Cur=0.1132 Te/Exp=0.2272]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.18s/it] 50%|█████     | 1/2 [00:05<00:03,  3.18s/it, CE=2.293254e+00 H=2.293120e+00 dV_dx=-8.733852e-06 dV_dθ=-1.249089e-04 ||∇||=3.856084e-01 | Tr=0.1581 Te/Cur=0.1475 Te/Exp=0.1888]100%|██████████| 2/2 [00:05<00:00,  2.49s/it, CE=2.293254e+00 H=2.293120e+00 dV_dx=-8.733852e-06 dV_dθ=-1.249089e-04 ||∇||=3.856084e-01 | Tr=0.1581 Te/Cur=0.1475 Te/Exp=0.1888]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.293254e+00 H=2.293120e+00 dV_dx=-8.733852e-06 dV_dθ=-1.249089e-04 ||∇||=3.856084e-01 | Tr=0.1581 Te/Cur=0.1475 Te/Exp=0.1888]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.29s/it] 50%|█████     | 1/2 [00:04<00:03,  3.29s/it, CE=2.292439e+00 H=2.292348e+00 dV_dx=6.472722e-06 dV_dθ=-9.703015e-05 ||∇||=3.740231e-01 | Tr=0.0813 Te/Cur=0.0782 Te/Exp=0.1821]100%|██████████| 2/2 [00:04<00:00,  2.35s/it, CE=2.292439e+00 H=2.292348e+00 dV_dx=6.472722e-06 dV_dθ=-9.703015e-05 ||∇||=3.740231e-01 | Tr=0.0813 Te/Cur=0.0782 Te/Exp=0.1821]100%|██████████| 2/2 [00:04<00:00,  2.49s/it, CE=2.292439e+00 H=2.292348e+00 dV_dx=6.472722e-06 dV_dθ=-9.703015e-05 ||∇||=3.740231e-01 | Tr=0.0813 Te/Cur=0.0782 Te/Exp=0.1821]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.12s/it] 50%|█████     | 1/2 [00:05<00:03,  3.12s/it, CE=2.277836e+00 H=2.277733e+00 dV_dx=-6.165476e-06 dV_dθ=-9.677573e-05 ||∇||=3.826716e-01 | Tr=0.1294 Te/Cur=0.1545 Te/Exp=0.2058]100%|██████████| 2/2 [00:05<00:00,  2.40s/it, CE=2.277836e+00 H=2.277733e+00 dV_dx=-6.165476e-06 dV_dθ=-9.677573e-05 ||∇||=3.826716e-01 | Tr=0.1294 Te/Cur=0.1545 Te/Exp=0.2058]100%|██████████| 2/2 [00:05<00:00,  2.51s/it, CE=2.277836e+00 H=2.277733e+00 dV_dx=-6.165476e-06 dV_dθ=-9.677573e-05 ||∇||=3.826716e-01 | Tr=0.1294 Te/Cur=0.1545 Te/Exp=0.2058]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.94s/it] 50%|█████     | 1/2 [00:07<00:05,  5.94s/it, CE=2.270649e+00 H=2.270557e+00 dV_dx=-1.787292e-06 dV_dθ=-9.053605e-05 ||∇||=4.002822e-01 | Tr=0.1333 Te/Cur=0.1656 Te/Exp=0.2167]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.270649e+00 H=2.270557e+00 dV_dx=-1.787292e-06 dV_dθ=-9.053605e-05 ||∇||=4.002822e-01 | Tr=0.1333 Te/Cur=0.1656 Te/Exp=0.2167]100%|██████████| 2/2 [00:07<00:00,  3.92s/it, CE=2.270649e+00 H=2.270557e+00 dV_dx=-1.787292e-06 dV_dθ=-9.053605e-05 ||∇||=4.002822e-01 | Tr=0.1333 Te/Cur=0.1656 Te/Exp=0.2167]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.76s/it] 50%|█████     | 1/2 [00:05<00:03,  3.76s/it, CE=2.281374e+00 H=2.281277e+00 dV_dx=-4.080844e-06 dV_dθ=-9.308218e-05 ||∇||=3.985714e-01 | Tr=0.1026 Te/Cur=0.1003 Te/Exp=0.1849]100%|██████████| 2/2 [00:05<00:00,  2.69s/it, CE=2.281374e+00 H=2.281277e+00 dV_dx=-4.080844e-06 dV_dθ=-9.308218e-05 ||∇||=3.985714e-01 | Tr=0.1026 Te/Cur=0.1003 Te/Exp=0.1849]100%|██████████| 2/2 [00:05<00:00,  2.85s/it, CE=2.281374e+00 H=2.281277e+00 dV_dx=-4.080844e-06 dV_dθ=-9.308218e-05 ||∇||=3.985714e-01 | Tr=0.1026 Te/Cur=0.1003 Te/Exp=0.1849]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.41s/it] 50%|█████     | 1/2 [00:05<00:03,  3.41s/it, CE=2.278213e+00 H=2.278178e+00 dV_dx=1.647052e-05 dV_dθ=-5.226893e-05 ||∇||=3.618914e-01 | Tr=0.0730 Te/Cur=0.0775 Te/Exp=0.2398]100%|██████████| 2/2 [00:05<00:00,  2.47s/it, CE=2.278213e+00 H=2.278178e+00 dV_dx=1.647052e-05 dV_dθ=-5.226893e-05 ||∇||=3.618914e-01 | Tr=0.0730 Te/Cur=0.0775 Te/Exp=0.2398]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.278213e+00 H=2.278178e+00 dV_dx=1.647052e-05 dV_dθ=-5.226893e-05 ||∇||=3.618914e-01 | Tr=0.0730 Te/Cur=0.0775 Te/Exp=0.2398]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.272443e+00 H=2.272350e+00 dV_dx=-3.052119e-06 dV_dθ=-9.020399e-05 ||∇||=3.546923e-01 | Tr=0.1792 Te/Cur=0.1941 Te/Exp=0.2583]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.272443e+00 H=2.272350e+00 dV_dx=-3.052119e-06 dV_dθ=-9.020399e-05 ||∇||=3.546923e-01 | Tr=0.1792 Te/Cur=0.1941 Te/Exp=0.2583]100%|██████████| 2/2 [00:05<00:00,  2.81s/it, CE=2.272443e+00 H=2.272350e+00 dV_dx=-3.052119e-06 dV_dθ=-9.020399e-05 ||∇||=3.546923e-01 | Tr=0.1792 Te/Cur=0.1941 Te/Exp=0.2583]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.45s/it] 50%|█████     | 1/2 [00:05<00:03,  3.45s/it, CE=2.287398e+00 H=2.287244e+00 dV_dx=-1.050175e-05 dV_dθ=-1.433320e-04 ||∇||=4.134423e-01 | Tr=0.1121 Te/Cur=0.1325 Te/Exp=0.2056]100%|██████████| 2/2 [00:05<00:00,  2.41s/it, CE=2.287398e+00 H=2.287244e+00 dV_dx=-1.050175e-05 dV_dθ=-1.433320e-04 ||∇||=4.134423e-01 | Tr=0.1121 Te/Cur=0.1325 Te/Exp=0.2056]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.287398e+00 H=2.287244e+00 dV_dx=-1.050175e-05 dV_dθ=-1.433320e-04 ||∇||=4.134423e-01 | Tr=0.1121 Te/Cur=0.1325 Te/Exp=0.2056]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.68s/it] 50%|█████     | 1/2 [00:05<00:03,  3.68s/it, CE=2.275917e+00 H=2.275868e+00 dV_dx=-4.030984e-06 dV_dθ=-4.521899e-05 ||∇||=3.624162e-01 | Tr=0.1560 Te/Cur=0.1828 Te/Exp=0.1875]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.275917e+00 H=2.275868e+00 dV_dx=-4.030984e-06 dV_dθ=-4.521899e-05 ||∇||=3.624162e-01 | Tr=0.1560 Te/Cur=0.1828 Te/Exp=0.1875]100%|██████████| 2/2 [00:05<00:00,  2.77s/it, CE=2.275917e+00 H=2.275868e+00 dV_dx=-4.030984e-06 dV_dθ=-4.521899e-05 ||∇||=3.624162e-01 | Tr=0.1560 Te/Cur=0.1828 Te/Exp=0.1875]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.275917361937739
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.37s/it] 50%|█████     | 1/2 [00:05<00:03,  3.37s/it, CE=2.272156e+00 H=2.272105e+00 dV_dx=-8.079949e-06 dV_dθ=-4.275689e-05 ||∇||=3.924749e-01 | Tr=0.1314 Te/Cur=0.1326 Te/Exp=0.2130]100%|██████████| 2/2 [00:05<00:00,  2.40s/it, CE=2.272156e+00 H=2.272105e+00 dV_dx=-8.079949e-06 dV_dθ=-4.275689e-05 ||∇||=3.924749e-01 | Tr=0.1314 Te/Cur=0.1326 Te/Exp=0.2130]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.272156e+00 H=2.272105e+00 dV_dx=-8.079949e-06 dV_dθ=-4.275689e-05 ||∇||=3.924749e-01 | Tr=0.1314 Te/Cur=0.1326 Te/Exp=0.2130]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 164, 10]) with loss 2.272156
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.274634e+00 H=2.274569e+00 dV_dx=-8.020218e-06 dV_dθ=-5.714440e-05 ||∇||=4.250211e-01 | Tr=0.1628 Te/Cur=0.1910 Te/Exp=0.1598]100%|██████████| 2/2 [00:05<00:00,  2.49s/it, CE=2.274634e+00 H=2.274569e+00 dV_dx=-8.020218e-06 dV_dθ=-5.714440e-05 ||∇||=4.250211e-01 | Tr=0.1628 Te/Cur=0.1910 Te/Exp=0.1598]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.274634e+00 H=2.274569e+00 dV_dx=-8.020218e-06 dV_dθ=-5.714440e-05 ||∇||=4.250211e-01 | Tr=0.1628 Te/Cur=0.1910 Te/Exp=0.1598]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.20s/it] 50%|█████     | 1/2 [00:05<00:03,  3.20s/it, CE=2.271452e+00 H=2.271396e+00 dV_dx=2.815267e-06 dV_dθ=-5.879020e-05 ||∇||=4.393715e-01 | Tr=0.1716 Te/Cur=0.1817 Te/Exp=0.1880]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.271452e+00 H=2.271396e+00 dV_dx=2.815267e-06 dV_dθ=-5.879020e-05 ||∇||=4.393715e-01 | Tr=0.1716 Te/Cur=0.1817 Te/Exp=0.1880]100%|██████████| 2/2 [00:05<00:00,  2.70s/it, CE=2.271452e+00 H=2.271396e+00 dV_dx=2.815267e-06 dV_dθ=-5.879020e-05 ||∇||=4.393715e-01 | Tr=0.1716 Te/Cur=0.1817 Te/Exp=0.1880]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 204, 10]) with loss 2.271452
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.54s/it] 50%|█████     | 1/2 [00:09<00:07,  7.54s/it, CE=2.264124e+00 H=2.264087e+00 dV_dx=6.300709e-06 dV_dθ=-4.285857e-05 ||∇||=4.265477e-01 | Tr=0.1175 Te/Cur=0.1310 Te/Exp=0.2271]100%|██████████| 2/2 [00:09<00:00,  4.15s/it, CE=2.264124e+00 H=2.264087e+00 dV_dx=6.300709e-06 dV_dθ=-4.285857e-05 ||∇||=4.265477e-01 | Tr=0.1175 Te/Cur=0.1310 Te/Exp=0.2271]100%|██████████| 2/2 [00:09<00:00,  4.66s/it, CE=2.264124e+00 H=2.264087e+00 dV_dx=6.300709e-06 dV_dθ=-4.285857e-05 ||∇||=4.265477e-01 | Tr=0.1175 Te/Cur=0.1310 Te/Exp=0.2271]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 204, 10]) with loss 2.264124
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.14s/it] 50%|█████     | 1/2 [00:05<00:03,  3.14s/it, CE=2.277124e+00 H=2.277065e+00 dV_dx=-1.769261e-06 dV_dθ=-5.734090e-05 ||∇||=4.391634e-01 | Tr=0.1488 Te/Cur=0.1735 Te/Exp=0.1586]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.277124e+00 H=2.277065e+00 dV_dx=-1.769261e-06 dV_dθ=-5.734090e-05 ||∇||=4.391634e-01 | Tr=0.1488 Te/Cur=0.1735 Te/Exp=0.1586]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.277124e+00 H=2.277065e+00 dV_dx=-1.769261e-06 dV_dθ=-5.734090e-05 ||∇||=4.391634e-01 | Tr=0.1488 Te/Cur=0.1735 Te/Exp=0.1586]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.51s/it] 50%|█████     | 1/2 [00:05<00:03,  3.51s/it, CE=2.276396e+00 H=2.276357e+00 dV_dx=-4.873332e-06 dV_dθ=-3.411329e-05 ||∇||=3.695155e-01 | Tr=0.2022 Te/Cur=0.1904 Te/Exp=0.1908]100%|██████████| 2/2 [00:05<00:00,  2.53s/it, CE=2.276396e+00 H=2.276357e+00 dV_dx=-4.873332e-06 dV_dθ=-3.411329e-05 ||∇||=3.695155e-01 | Tr=0.2022 Te/Cur=0.1904 Te/Exp=0.1908]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.276396e+00 H=2.276357e+00 dV_dx=-4.873332e-06 dV_dθ=-3.411329e-05 ||∇||=3.695155e-01 | Tr=0.2022 Te/Cur=0.1904 Te/Exp=0.1908]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.75s/it] 50%|█████     | 1/2 [00:05<00:03,  3.75s/it, CE=2.273754e+00 H=2.273693e+00 dV_dx=-3.457706e-06 dV_dθ=-5.720779e-05 ||∇||=4.366804e-01 | Tr=0.1510 Te/Cur=0.1763 Te/Exp=0.2396]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.273754e+00 H=2.273693e+00 dV_dx=-3.457706e-06 dV_dθ=-5.720779e-05 ||∇||=4.366804e-01 | Tr=0.1510 Te/Cur=0.1763 Te/Exp=0.2396]100%|██████████| 2/2 [00:05<00:00,  2.76s/it, CE=2.273754e+00 H=2.273693e+00 dV_dx=-3.457706e-06 dV_dθ=-5.720779e-05 ||∇||=4.366804e-01 | Tr=0.1510 Te/Cur=0.1763 Te/Exp=0.2396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.259793e+00 H=2.259773e+00 dV_dx=2.113767e-06 dV_dθ=-2.140321e-05 ||∇||=4.162331e-01 | Tr=0.1667 Te/Cur=0.1846 Te/Exp=0.2367]100%|██████████| 2/2 [00:05<00:00,  2.55s/it, CE=2.259793e+00 H=2.259773e+00 dV_dx=2.113767e-06 dV_dθ=-2.140321e-05 ||∇||=4.162331e-01 | Tr=0.1667 Te/Cur=0.1846 Te/Exp=0.2367]100%|██████████| 2/2 [00:05<00:00,  2.70s/it, CE=2.259793e+00 H=2.259773e+00 dV_dx=2.113767e-06 dV_dθ=-2.140321e-05 ||∇||=4.162331e-01 | Tr=0.1667 Te/Cur=0.1846 Te/Exp=0.2367]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 592, 244, 10]) with loss 2.259793
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.95s/it] 50%|█████     | 1/2 [00:04<00:02,  2.95s/it, CE=2.285433e+00 H=2.285394e+00 dV_dx=7.842059e-06 dV_dθ=-4.656465e-05 ||∇||=3.168422e-01 | Tr=0.1686 Te/Cur=0.1803 Te/Exp=0.1834]100%|██████████| 2/2 [00:04<00:00,  2.17s/it, CE=2.285433e+00 H=2.285394e+00 dV_dx=7.842059e-06 dV_dθ=-4.656465e-05 ||∇||=3.168422e-01 | Tr=0.1686 Te/Cur=0.1803 Te/Exp=0.1834]100%|██████████| 2/2 [00:04<00:00,  2.29s/it, CE=2.285433e+00 H=2.285394e+00 dV_dx=7.842059e-06 dV_dθ=-4.656465e-05 ||∇||=3.168422e-01 | Tr=0.1686 Te/Cur=0.1803 Te/Exp=0.1834]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.17s/it] 50%|█████     | 1/2 [00:05<00:04,  4.17s/it, CE=2.290819e+00 H=2.290783e+00 dV_dx=1.739906e-06 dV_dθ=-3.797909e-05 ||∇||=3.456759e-01 | Tr=0.1351 Te/Cur=0.1616 Te/Exp=0.1712]100%|██████████| 2/2 [00:05<00:00,  2.77s/it, CE=2.290819e+00 H=2.290783e+00 dV_dx=1.739906e-06 dV_dθ=-3.797909e-05 ||∇||=3.456759e-01 | Tr=0.1351 Te/Cur=0.1616 Te/Exp=0.1712]100%|██████████| 2/2 [00:05<00:00,  2.98s/it, CE=2.290819e+00 H=2.290783e+00 dV_dx=1.739906e-06 dV_dθ=-3.797909e-05 ||∇||=3.456759e-01 | Tr=0.1351 Te/Cur=0.1616 Te/Exp=0.1712]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.62s/it] 50%|█████     | 1/2 [00:05<00:03,  3.62s/it, CE=2.280571e+00 H=2.280536e+00 dV_dx=1.397853e-05 dV_dθ=-4.940559e-05 ||∇||=3.451585e-01 | Tr=0.1318 Te/Cur=0.1406 Te/Exp=0.2149]100%|██████████| 2/2 [00:05<00:00,  2.37s/it, CE=2.280571e+00 H=2.280536e+00 dV_dx=1.397853e-05 dV_dθ=-4.940559e-05 ||∇||=3.451585e-01 | Tr=0.1318 Te/Cur=0.1406 Te/Exp=0.2149]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.280571e+00 H=2.280536e+00 dV_dx=1.397853e-05 dV_dθ=-4.940559e-05 ||∇||=3.451585e-01 | Tr=0.1318 Te/Cur=0.1406 Te/Exp=0.2149]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.58s/it] 50%|█████     | 1/2 [00:05<00:03,  3.58s/it, CE=2.282733e+00 H=2.282700e+00 dV_dx=-5.655451e-07 dV_dθ=-3.313856e-05 ||∇||=3.268482e-01 | Tr=0.1000 Te/Cur=0.0935 Te/Exp=0.1615]100%|██████████| 2/2 [00:05<00:00,  2.71s/it, CE=2.282733e+00 H=2.282700e+00 dV_dx=-5.655451e-07 dV_dθ=-3.313856e-05 ||∇||=3.268482e-01 | Tr=0.1000 Te/Cur=0.0935 Te/Exp=0.1615]100%|██████████| 2/2 [00:05<00:00,  2.84s/it, CE=2.282733e+00 H=2.282700e+00 dV_dx=-5.655451e-07 dV_dθ=-3.313856e-05 ||∇||=3.268482e-01 | Tr=0.1000 Te/Cur=0.0935 Te/Exp=0.1615]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.68s/it] 50%|█████     | 1/2 [00:05<00:03,  3.68s/it, CE=2.281362e+00 H=2.281333e+00 dV_dx=-2.364596e-06 dV_dθ=-2.671338e-05 ||∇||=3.472533e-01 | Tr=0.1531 Te/Cur=0.1599 Te/Exp=0.1782]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.281362e+00 H=2.281333e+00 dV_dx=-2.364596e-06 dV_dθ=-2.671338e-05 ||∇||=3.472533e-01 | Tr=0.1531 Te/Cur=0.1599 Te/Exp=0.1782]100%|██████████| 2/2 [00:05<00:00,  2.81s/it, CE=2.281362e+00 H=2.281333e+00 dV_dx=-2.364596e-06 dV_dθ=-2.671338e-05 ||∇||=3.472533e-01 | Tr=0.1531 Te/Cur=0.1599 Te/Exp=0.1782]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.19s/it] 50%|█████     | 1/2 [00:08<00:06,  6.19s/it, CE=2.282691e+00 H=2.282632e+00 dV_dx=-1.635552e-05 dV_dθ=-4.217440e-05 ||∇||=3.656298e-01 | Tr=0.1379 Te/Cur=0.1684 Te/Exp=0.1569]100%|██████████| 2/2 [00:08<00:00,  3.65s/it, CE=2.282691e+00 H=2.282632e+00 dV_dx=-1.635552e-05 dV_dθ=-4.217440e-05 ||∇||=3.656298e-01 | Tr=0.1379 Te/Cur=0.1684 Te/Exp=0.1569]100%|██████████| 2/2 [00:08<00:00,  4.03s/it, CE=2.282691e+00 H=2.282632e+00 dV_dx=-1.635552e-05 dV_dθ=-4.217440e-05 ||∇||=3.656298e-01 | Tr=0.1379 Te/Cur=0.1684 Te/Exp=0.1569]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.37s/it] 50%|█████     | 1/2 [00:05<00:03,  3.37s/it, CE=2.277204e+00 H=2.277195e+00 dV_dx=5.667553e-06 dV_dθ=-1.484059e-05 ||∇||=3.088735e-01 | Tr=0.1200 Te/Cur=0.1332 Te/Exp=0.2270]100%|██████████| 2/2 [00:05<00:00,  2.36s/it, CE=2.277204e+00 H=2.277195e+00 dV_dx=5.667553e-06 dV_dθ=-1.484059e-05 ||∇||=3.088735e-01 | Tr=0.1200 Te/Cur=0.1332 Te/Exp=0.2270]100%|██████████| 2/2 [00:05<00:00,  2.51s/it, CE=2.277204e+00 H=2.277195e+00 dV_dx=5.667553e-06 dV_dθ=-1.484059e-05 ||∇||=3.088735e-01 | Tr=0.1200 Te/Cur=0.1332 Te/Exp=0.2270]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.05s/it] 50%|█████     | 1/2 [00:04<00:03,  3.05s/it, CE=2.285993e+00 H=2.285941e+00 dV_dx=-8.519275e-06 dV_dθ=-4.433579e-05 ||∇||=3.270326e-01 | Tr=0.1197 Te/Cur=0.1258 Te/Exp=0.2033]100%|██████████| 2/2 [00:04<00:00,  2.34s/it, CE=2.285993e+00 H=2.285941e+00 dV_dx=-8.519275e-06 dV_dθ=-4.433579e-05 ||∇||=3.270326e-01 | Tr=0.1197 Te/Cur=0.1258 Te/Exp=0.2033]100%|██████████| 2/2 [00:04<00:00,  2.44s/it, CE=2.285993e+00 H=2.285941e+00 dV_dx=-8.519275e-06 dV_dθ=-4.433579e-05 ||∇||=3.270326e-01 | Tr=0.1197 Te/Cur=0.1258 Te/Exp=0.2033]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.87s/it] 50%|█████     | 1/2 [00:05<00:03,  3.87s/it, CE=2.279365e+00 H=2.279362e+00 dV_dx=1.637316e-05 dV_dθ=-1.895322e-05 ||∇||=3.770192e-01 | Tr=0.1147 Te/Cur=0.1244 Te/Exp=0.2106]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.279365e+00 H=2.279362e+00 dV_dx=1.637316e-05 dV_dθ=-1.895322e-05 ||∇||=3.770192e-01 | Tr=0.1147 Te/Cur=0.1244 Te/Exp=0.2106]100%|██████████| 2/2 [00:05<00:00,  2.80s/it, CE=2.279365e+00 H=2.279362e+00 dV_dx=1.637316e-05 dV_dθ=-1.895322e-05 ||∇||=3.770192e-01 | Tr=0.1147 Te/Cur=0.1244 Te/Exp=0.2106]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.49s/it] 50%|█████     | 1/2 [00:05<00:03,  3.49s/it, CE=2.277388e+00 H=2.277340e+00 dV_dx=1.595294e-05 dV_dθ=-6.329956e-05 ||∇||=3.437833e-01 | Tr=0.1160 Te/Cur=0.1242 Te/Exp=0.2157]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.277388e+00 H=2.277340e+00 dV_dx=1.595294e-05 dV_dθ=-6.329956e-05 ||∇||=3.437833e-01 | Tr=0.1160 Te/Cur=0.1242 Te/Exp=0.2157]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.277388e+00 H=2.277340e+00 dV_dx=1.595294e-05 dV_dθ=-6.329956e-05 ||∇||=3.437833e-01 | Tr=0.1160 Te/Cur=0.1242 Te/Exp=0.2157]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.34s/it] 50%|█████     | 1/2 [00:05<00:03,  3.34s/it, CE=2.275624e+00 H=2.275583e+00 dV_dx=8.199642e-06 dV_dθ=-4.915982e-05 ||∇||=3.785215e-01 | Tr=0.0799 Te/Cur=0.1120 Te/Exp=0.2076]100%|██████████| 2/2 [00:05<00:00,  2.53s/it, CE=2.275624e+00 H=2.275583e+00 dV_dx=8.199642e-06 dV_dθ=-4.915982e-05 ||∇||=3.785215e-01 | Tr=0.0799 Te/Cur=0.1120 Te/Exp=0.2076]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.275624e+00 H=2.275583e+00 dV_dx=8.199642e-06 dV_dθ=-4.915982e-05 ||∇||=3.785215e-01 | Tr=0.0799 Te/Cur=0.1120 Te/Exp=0.2076]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.70s/it] 50%|█████     | 1/2 [00:04<00:02,  2.70s/it, CE=2.273615e+00 H=2.273562e+00 dV_dx=6.515918e-06 dV_dθ=-5.931041e-05 ||∇||=3.656681e-01 | Tr=0.1051 Te/Cur=0.1430 Te/Exp=0.2044]100%|██████████| 2/2 [00:04<00:00,  2.07s/it, CE=2.273615e+00 H=2.273562e+00 dV_dx=6.515918e-06 dV_dθ=-5.931041e-05 ||∇||=3.656681e-01 | Tr=0.1051 Te/Cur=0.1430 Te/Exp=0.2044]100%|██████████| 2/2 [00:04<00:00,  2.16s/it, CE=2.273615e+00 H=2.273562e+00 dV_dx=6.515918e-06 dV_dθ=-5.931041e-05 ||∇||=3.656681e-01 | Tr=0.1051 Te/Cur=0.1430 Te/Exp=0.2044]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.11s/it] 50%|█████     | 1/2 [00:04<00:03,  3.11s/it, CE=2.260037e+00 H=2.260004e+00 dV_dx=7.301436e-06 dV_dθ=-4.108377e-05 ||∇||=3.454657e-01 | Tr=0.1473 Te/Cur=0.1977 Te/Exp=0.2122]100%|██████████| 2/2 [00:04<00:00,  2.34s/it, CE=2.260037e+00 H=2.260004e+00 dV_dx=7.301436e-06 dV_dθ=-4.108377e-05 ||∇||=3.454657e-01 | Tr=0.1473 Te/Cur=0.1977 Te/Exp=0.2122]100%|██████████| 2/2 [00:04<00:00,  2.46s/it, CE=2.260037e+00 H=2.260004e+00 dV_dx=7.301436e-06 dV_dθ=-4.108377e-05 ||∇||=3.454657e-01 | Tr=0.1473 Te/Cur=0.1977 Te/Exp=0.2122]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.50s/it] 50%|█████     | 1/2 [00:05<00:03,  3.50s/it, CE=2.260058e+00 H=2.260045e+00 dV_dx=1.280738e-05 dV_dθ=-2.557907e-05 ||∇||=3.464582e-01 | Tr=0.1466 Te/Cur=0.1729 Te/Exp=0.2294]100%|██████████| 2/2 [00:05<00:00,  2.52s/it, CE=2.260058e+00 H=2.260045e+00 dV_dx=1.280738e-05 dV_dθ=-2.557907e-05 ||∇||=3.464582e-01 | Tr=0.1466 Te/Cur=0.1729 Te/Exp=0.2294]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.260058e+00 H=2.260045e+00 dV_dx=1.280738e-05 dV_dθ=-2.557907e-05 ||∇||=3.464582e-01 | Tr=0.1466 Te/Cur=0.1729 Te/Exp=0.2294]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.03s/it] 50%|█████     | 1/2 [00:04<00:03,  3.03s/it, CE=2.262031e+00 H=2.261979e+00 dV_dx=8.352590e-06 dV_dθ=-6.027120e-05 ||∇||=3.689199e-01 | Tr=0.1794 Te/Cur=0.1987 Te/Exp=0.2366]100%|██████████| 2/2 [00:04<00:00,  2.18s/it, CE=2.262031e+00 H=2.261979e+00 dV_dx=8.352590e-06 dV_dθ=-6.027120e-05 ||∇||=3.689199e-01 | Tr=0.1794 Te/Cur=0.1987 Te/Exp=0.2366]100%|██████████| 2/2 [00:04<00:00,  2.31s/it, CE=2.262031e+00 H=2.261979e+00 dV_dx=8.352590e-06 dV_dθ=-6.027120e-05 ||∇||=3.689199e-01 | Tr=0.1794 Te/Cur=0.1987 Te/Exp=0.2366]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.86s/it] 50%|█████     | 1/2 [00:08<00:05,  5.86s/it, CE=2.286124e+00 H=2.286012e+00 dV_dx=-1.064413e-05 dV_dθ=-1.014741e-04 ||∇||=3.929680e-01 | Tr=0.1069 Te/Cur=0.1514 Te/Exp=0.2119]100%|██████████| 2/2 [00:08<00:00,  4.19s/it, CE=2.286124e+00 H=2.286012e+00 dV_dx=-1.064413e-05 dV_dθ=-1.014741e-04 ||∇||=3.929680e-01 | Tr=0.1069 Te/Cur=0.1514 Te/Exp=0.2119]100%|██████████| 2/2 [00:08<00:00,  4.44s/it, CE=2.286124e+00 H=2.286012e+00 dV_dx=-1.064413e-05 dV_dθ=-1.014741e-04 ||∇||=3.929680e-01 | Tr=0.1069 Te/Cur=0.1514 Te/Exp=0.2119]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.87s/it] 50%|█████     | 1/2 [00:05<00:03,  3.87s/it, CE=2.283907e+00 H=2.283820e+00 dV_dx=1.480071e-05 dV_dθ=-1.017656e-04 ||∇||=4.077383e-01 | Tr=0.1473 Te/Cur=0.1672 Te/Exp=0.1904]100%|██████████| 2/2 [00:05<00:00,  2.63s/it, CE=2.283907e+00 H=2.283820e+00 dV_dx=1.480071e-05 dV_dθ=-1.017656e-04 ||∇||=4.077383e-01 | Tr=0.1473 Te/Cur=0.1672 Te/Exp=0.1904]100%|██████████| 2/2 [00:05<00:00,  2.81s/it, CE=2.283907e+00 H=2.283820e+00 dV_dx=1.480071e-05 dV_dθ=-1.017656e-04 ||∇||=4.077383e-01 | Tr=0.1473 Te/Cur=0.1672 Te/Exp=0.1904]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.81s/it] 50%|█████     | 1/2 [00:04<00:02,  2.81s/it, CE=2.274240e+00 H=2.274190e+00 dV_dx=-8.006766e-06 dV_dθ=-4.210458e-05 ||∇||=3.435292e-01 | Tr=0.0929 Te/Cur=0.1282 Te/Exp=0.2179]100%|██████████| 2/2 [00:04<00:00,  2.06s/it, CE=2.274240e+00 H=2.274190e+00 dV_dx=-8.006766e-06 dV_dθ=-4.210458e-05 ||∇||=3.435292e-01 | Tr=0.0929 Te/Cur=0.1282 Te/Exp=0.2179]100%|██████████| 2/2 [00:04<00:00,  2.17s/it, CE=2.274240e+00 H=2.274190e+00 dV_dx=-8.006766e-06 dV_dθ=-4.210458e-05 ||∇||=3.435292e-01 | Tr=0.0929 Te/Cur=0.1282 Te/Exp=0.2179]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 592, 244, 10]) with loss 2.259793
  Total candidates evaluated: 54
  Original: (2, [507, 552, 204, 10])
  Optimal: (2, [507, 592, 244, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→2, feed [507, 552, 204, 10]→[507, 592, 244, 10]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:14<04:29, 14.18s/it]  5%|▌         | 1/20 [00:16<04:29, 14.18s/it, CE=2.484433e+00 H=2.481013e+00 dV_dx=8.367482e-05 dV_dθ=-3.503979e-03 ||∇||=1.267750e+01 | Tr=0.8476] 10%|█         | 2/20 [00:16<02:06,  7.06s/it, CE=2.484433e+00 H=2.481013e+00 dV_dx=8.367482e-05 dV_dθ=-3.503979e-03 ||∇||=1.267750e+01 | Tr=0.8476] 10%|█         | 2/20 [00:18<02:06,  7.06s/it, CE=1.952053e+00 H=1.963375e+00 dV_dx=7.698539e-05 dV_dθ=1.124426e-02 ||∇||=9.740681e+00 | Tr=0.8476]  15%|█▌        | 3/20 [00:18<01:26,  5.07s/it, CE=1.952053e+00 H=1.963375e+00 dV_dx=7.698539e-05 dV_dθ=1.124426e-02 ||∇||=9.740681e+00 | Tr=0.8476] 15%|█▌        | 3/20 [00:21<01:26,  5.07s/it, CE=1.680605e+00 H=1.647827e+00 dV_dx=4.624499e-05 dV_dθ=-3.282496e-02 ||∇||=1.022956e+01 | Tr=0.8476] 20%|██        | 4/20 [00:21<01:02,  3.93s/it, CE=1.680605e+00 H=1.647827e+00 dV_dx=4.624499e-05 dV_dθ=-3.282496e-02 ||∇||=1.022956e+01 | Tr=0.8476] 20%|██        | 4/20 [00:23<01:02,  3.93s/it, CE=1.500082e+00 H=1.438568e+00 dV_dx=5.355214e-05 dV_dθ=-6.156800e-02 ||∇||=1.045888e+01 | Tr=0.8476] 25%|██▌       | 5/20 [00:23<00:50,  3.34s/it, CE=1.500082e+00 H=1.438568e+00 dV_dx=5.355214e-05 dV_dθ=-6.156800e-02 ||∇||=1.045888e+01 | Tr=0.8476] 25%|██▌       | 5/20 [00:25<00:50,  3.34s/it, CE=1.360415e+00 H=1.292137e+00 dV_dx=-7.871042e-05 dV_dθ=-6.819855e-02 ||∇||=1.066350e+01 | Tr=0.8476] 30%|███       | 6/20 [00:25<00:41,  2.93s/it, CE=1.360415e+00 H=1.292137e+00 dV_dx=-7.871042e-05 dV_dθ=-6.819855e-02 ||∇||=1.066350e+01 | Tr=0.8476] 30%|███       | 6/20 [00:28<00:41,  2.93s/it, CE=1.251378e+00 H=1.168084e+00 dV_dx=4.262513e-05 dV_dθ=-8.333725e-02 ||∇||=1.091745e+01 | Tr=0.8476]  35%|███▌      | 7/20 [00:28<00:36,  2.80s/it, CE=1.251378e+00 H=1.168084e+00 dV_dx=4.262513e-05 dV_dθ=-8.333725e-02 ||∇||=1.091745e+01 | Tr=0.8476] 35%|███▌      | 7/20 [00:30<00:36,  2.80s/it, CE=1.164399e+00 H=1.071527e+00 dV_dx=8.461789e-06 dV_dθ=-9.288003e-02 ||∇||=1.120798e+01 | Tr=0.8476] 40%|████      | 8/20 [00:30<00:31,  2.61s/it, CE=1.164399e+00 H=1.071527e+00 dV_dx=8.461789e-06 dV_dθ=-9.288003e-02 ||∇||=1.120798e+01 | Tr=0.8476] 40%|████      | 8/20 [00:32<00:31,  2.61s/it, CE=1.092112e+00 H=9.930980e-01 dV_dx=6.519518e-05 dV_dθ=-9.907870e-02 ||∇||=1.130661e+01 | Tr=0.8476] 45%|████▌     | 9/20 [00:32<00:27,  2.52s/it, CE=1.092112e+00 H=9.930980e-01 dV_dx=6.519518e-05 dV_dθ=-9.907870e-02 ||∇||=1.130661e+01 | Tr=0.8476] 45%|████▌     | 9/20 [00:35<00:27,  2.52s/it, CE=1.032373e+00 H=9.280768e-01 dV_dx=1.425149e-05 dV_dθ=-1.043104e-01 ||∇||=1.138039e+01 | Tr=0.8476] 50%|█████     | 10/20 [00:35<00:24,  2.49s/it, CE=1.032373e+00 H=9.280768e-01 dV_dx=1.425149e-05 dV_dθ=-1.043104e-01 ||∇||=1.138039e+01 | Tr=0.8476] 50%|█████     | 10/20 [00:37<00:24,  2.49s/it, CE=9.788049e-01 H=8.518390e-01 dV_dx=-4.817873e-05 dV_dθ=-1.269177e-01 ||∇||=1.189579e+01 | Tr=0.8476] 55%|█████▌    | 11/20 [00:37<00:22,  2.46s/it, CE=9.788049e-01 H=8.518390e-01 dV_dx=-4.817873e-05 dV_dθ=-1.269177e-01 ||∇||=1.189579e+01 | Tr=0.8476] 55%|█████▌    | 11/20 [00:39<00:22,  2.46s/it, CE=9.335730e-01 H=7.650049e-01 dV_dx=7.343010e-05 dV_dθ=-1.686416e-01 ||∇||=1.310415e+01 | Tr=0.8476]  60%|██████    | 12/20 [00:39<00:18,  2.36s/it, CE=9.335730e-01 H=7.650049e-01 dV_dx=7.343010e-05 dV_dθ=-1.686416e-01 ||∇||=1.310415e+01 | Tr=0.8476] 60%|██████    | 12/20 [00:41<00:18,  2.36s/it, CE=8.952668e-01 H=6.489155e-01 dV_dx=-6.713930e-05 dV_dθ=-2.462841e-01 ||∇||=1.499602e+01 | Tr=0.8476] 65%|██████▌   | 13/20 [00:41<00:16,  2.29s/it, CE=8.952668e-01 H=6.489155e-01 dV_dx=-6.713930e-05 dV_dθ=-2.462841e-01 ||∇||=1.499602e+01 | Tr=0.8476] 65%|██████▌   | 13/20 [00:44<00:16,  2.29s/it, CE=8.577538e-01 H=6.463843e-01 dV_dx=-7.498629e-05 dV_dθ=-2.112945e-01 ||∇||=1.410481e+01 | Tr=0.8476] 70%|███████   | 14/20 [00:44<00:14,  2.41s/it, CE=8.577538e-01 H=6.463843e-01 dV_dx=-7.498629e-05 dV_dθ=-2.112945e-01 ||∇||=1.410481e+01 | Tr=0.8476] 70%|███████   | 14/20 [00:46<00:14,  2.41s/it, CE=8.207287e-01 H=6.865198e-01 dV_dx=-2.753163e-05 dV_dθ=-1.341814e-01 ||∇||=1.180342e+01 | Tr=0.8476] 75%|███████▌  | 15/20 [00:46<00:12,  2.44s/it, CE=8.207287e-01 H=6.865198e-01 dV_dx=-2.753163e-05 dV_dθ=-1.341814e-01 ||∇||=1.180342e+01 | Tr=0.8476] 75%|███████▌  | 15/20 [00:49<00:12,  2.44s/it, CE=7.903491e-01 H=6.826554e-01 dV_dx=-9.482716e-05 dV_dθ=-1.075989e-01 ||∇||=1.095156e+01 | Tr=0.8476] 80%|████████  | 16/20 [00:49<00:09,  2.35s/it, CE=7.903491e-01 H=6.826554e-01 dV_dx=-9.482716e-05 dV_dθ=-1.075989e-01 ||∇||=1.095156e+01 | Tr=0.8476] 80%|████████  | 16/20 [00:51<00:09,  2.35s/it, CE=7.625993e-01 H=6.615938e-01 dV_dx=2.277745e-05 dV_dθ=-1.010283e-01 ||∇||=1.060550e+01 | Tr=0.8476]  85%|████████▌ | 17/20 [00:51<00:06,  2.33s/it, CE=7.625993e-01 H=6.615938e-01 dV_dx=2.277745e-05 dV_dθ=-1.010283e-01 ||∇||=1.060550e+01 | Tr=0.8476] 85%|████████▌ | 17/20 [00:53<00:06,  2.33s/it, CE=7.388745e-01 H=6.374421e-01 dV_dx=-6.549532e-05 dV_dθ=-1.013670e-01 ||∇||=1.063958e+01 | Tr=0.8476] 90%|█████████ | 18/20 [00:53<00:04,  2.35s/it, CE=7.388745e-01 H=6.374421e-01 dV_dx=-6.549532e-05 dV_dθ=-1.013670e-01 ||∇||=1.063958e+01 | Tr=0.8476] 90%|█████████ | 18/20 [00:55<00:04,  2.35s/it, CE=7.174057e-01 H=6.245012e-01 dV_dx=-4.055603e-05 dV_dθ=-9.286390e-02 ||∇||=1.042439e+01 | Tr=0.8476] 95%|█████████▌| 19/20 [00:55<00:02,  2.23s/it, CE=7.174057e-01 H=6.245012e-01 dV_dx=-4.055603e-05 dV_dθ=-9.286390e-02 ||∇||=1.042439e+01 | Tr=0.8476] 95%|█████████▌| 19/20 [01:00<00:02,  2.23s/it, CE=6.978477e-01 H=6.068847e-01 dV_dx=3.271058e-05 dV_dθ=-9.099564e-02 ||∇||=1.033648e+01 | Tr=0.8476 Te/Cur=0.9129 Te/Exp=0.7443]100%|██████████| 20/20 [01:03<00:00,  3.81s/it, CE=6.978477e-01 H=6.068847e-01 dV_dx=3.271058e-05 dV_dθ=-9.099564e-02 ||∇||=1.033648e+01 | Tr=0.8476 Te/Cur=0.9129 Te/Exp=0.7443]100%|██████████| 20/20 [01:03<00:00,  3.16s/it, CE=6.978477e-01 H=6.068847e-01 dV_dx=3.271058e-05 dV_dθ=-9.099564e-02 ||∇||=1.033648e+01 | Tr=0.8476 Te/Cur=0.9129 Te/Exp=0.7443]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.618443
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<02:09,  6.81s/it]  5%|▌         | 1/20 [00:09<02:09,  6.81s/it, CE=7.198334e-01 H=6.429780e-01 dV_dx=4.779674e-05 dV_dθ=-7.690326e-02 ||∇||=9.861897e+00 | Tr=0.8479] 10%|█         | 2/20 [00:09<01:15,  4.19s/it, CE=7.198334e-01 H=6.429780e-01 dV_dx=4.779674e-05 dV_dθ=-7.690326e-02 ||∇||=9.861897e+00 | Tr=0.8479] 10%|█         | 2/20 [00:11<01:15,  4.19s/it, CE=6.916126e-01 H=6.160684e-01 dV_dx=1.029973e-04 dV_dθ=-7.564725e-02 ||∇||=9.774516e+00 | Tr=0.8479] 15%|█▌        | 3/20 [00:11<00:56,  3.31s/it, CE=6.916126e-01 H=6.160684e-01 dV_dx=1.029973e-04 dV_dθ=-7.564725e-02 ||∇||=9.774516e+00 | Tr=0.8479] 15%|█▌        | 3/20 [00:13<00:56,  3.31s/it, CE=6.683332e-01 H=5.941649e-01 dV_dx=-1.112289e-04 dV_dθ=-7.405697e-02 ||∇||=9.592440e+00 | Tr=0.8479] 20%|██        | 4/20 [00:13<00:46,  2.89s/it, CE=6.683332e-01 H=5.941649e-01 dV_dx=-1.112289e-04 dV_dθ=-7.405697e-02 ||∇||=9.592440e+00 | Tr=0.8479] 20%|██        | 4/20 [00:15<00:46,  2.89s/it, CE=6.485586e-01 H=5.743193e-01 dV_dx=8.974834e-05 dV_dθ=-7.432901e-02 ||∇||=9.607128e+00 | Tr=0.8479]  25%|██▌       | 5/20 [00:15<00:36,  2.46s/it, CE=6.485586e-01 H=5.743193e-01 dV_dx=8.974834e-05 dV_dθ=-7.432901e-02 ||∇||=9.607128e+00 | Tr=0.8479] 25%|██▌       | 5/20 [00:17<00:36,  2.46s/it, CE=6.317809e-01 H=5.510995e-01 dV_dx=6.921170e-05 dV_dθ=-8.075058e-02 ||∇||=9.891540e+00 | Tr=0.8479] 30%|███       | 6/20 [00:17<00:32,  2.33s/it, CE=6.317809e-01 H=5.510995e-01 dV_dx=6.921170e-05 dV_dθ=-8.075058e-02 ||∇||=9.891540e+00 | Tr=0.8479] 30%|███       | 6/20 [00:19<00:32,  2.33s/it, CE=6.163028e-01 H=5.281422e-01 dV_dx=-2.066623e-05 dV_dθ=-8.813991e-02 ||∇||=1.025357e+01 | Tr=0.8479] 35%|███▌      | 7/20 [00:19<00:29,  2.26s/it, CE=6.163028e-01 H=5.281422e-01 dV_dx=-2.066623e-05 dV_dθ=-8.813991e-02 ||∇||=1.025357e+01 | Tr=0.8479] 35%|███▌      | 7/20 [00:22<00:29,  2.26s/it, CE=6.028059e-01 H=5.000372e-01 dV_dx=7.880703e-07 dV_dθ=-1.027695e-01 ||∇||=1.087141e+01 | Tr=0.8479]  40%|████      | 8/20 [00:22<00:27,  2.33s/it, CE=6.028059e-01 H=5.000372e-01 dV_dx=7.880703e-07 dV_dθ=-1.027695e-01 ||∇||=1.087141e+01 | Tr=0.8479] 40%|████      | 8/20 [00:24<00:27,  2.33s/it, CE=5.916276e-01 H=4.667403e-01 dV_dx=-5.235646e-06 dV_dθ=-1.248820e-01 ||∇||=1.171045e+01 | Tr=0.8479] 45%|████▌     | 9/20 [00:24<00:24,  2.23s/it, CE=5.916276e-01 H=4.667403e-01 dV_dx=-5.235646e-06 dV_dθ=-1.248820e-01 ||∇||=1.171045e+01 | Tr=0.8479] 45%|████▌     | 9/20 [00:26<00:24,  2.23s/it, CE=5.834651e-01 H=4.190949e-01 dV_dx=-2.869958e-05 dV_dθ=-1.643414e-01 ||∇||=1.304587e+01 | Tr=0.8479] 50%|█████     | 10/20 [00:26<00:22,  2.20s/it, CE=5.834651e-01 H=4.190949e-01 dV_dx=-2.869958e-05 dV_dθ=-1.643414e-01 ||∇||=1.304587e+01 | Tr=0.8479] 50%|█████     | 10/20 [00:28<00:22,  2.20s/it, CE=5.760187e-01 H=3.888361e-01 dV_dx=-1.608612e-04 dV_dθ=-1.870218e-01 ||∇||=1.396128e+01 | Tr=0.8479] 55%|█████▌    | 11/20 [00:28<00:20,  2.28s/it, CE=5.760187e-01 H=3.888361e-01 dV_dx=-1.608612e-04 dV_dθ=-1.870218e-01 ||∇||=1.396128e+01 | Tr=0.8479] 55%|█████▌    | 11/20 [00:30<00:20,  2.28s/it, CE=5.624768e-01 H=4.320926e-01 dV_dx=-4.143334e-05 dV_dθ=-1.303428e-01 ||∇||=1.193401e+01 | Tr=0.8479] 60%|██████    | 12/20 [00:30<00:18,  2.27s/it, CE=5.624768e-01 H=4.320926e-01 dV_dx=-4.143334e-05 dV_dθ=-1.303428e-01 ||∇||=1.193401e+01 | Tr=0.8479] 60%|██████    | 12/20 [00:33<00:18,  2.27s/it, CE=5.493600e-01 H=4.670092e-01 dV_dx=1.964702e-05 dV_dθ=-8.237046e-02 ||∇||=1.018668e+01 | Tr=0.8479]  65%|██████▌   | 13/20 [00:33<00:16,  2.31s/it, CE=5.493600e-01 H=4.670092e-01 dV_dx=1.964702e-05 dV_dθ=-8.237046e-02 ||∇||=1.018668e+01 | Tr=0.8479] 65%|██████▌   | 13/20 [00:35<00:16,  2.31s/it, CE=5.362647e-01 H=4.839449e-01 dV_dx=-4.736961e-06 dV_dθ=-5.231512e-02 ||∇||=8.975034e+00 | Tr=0.8479] 70%|███████   | 14/20 [00:35<00:14,  2.38s/it, CE=5.362647e-01 H=4.839449e-01 dV_dx=-4.736961e-06 dV_dθ=-5.231512e-02 ||∇||=8.975034e+00 | Tr=0.8479] 70%|███████   | 14/20 [00:39<00:14,  2.38s/it, CE=5.266969e-01 H=4.788424e-01 dV_dx=8.252389e-07 dV_dθ=-4.785531e-02 ||∇||=8.853542e+00 | Tr=0.8479]  75%|███████▌  | 15/20 [00:39<00:14,  2.86s/it, CE=5.266969e-01 H=4.788424e-01 dV_dx=8.252389e-07 dV_dθ=-4.785531e-02 ||∇||=8.853542e+00 | Tr=0.8479] 75%|███████▌  | 15/20 [00:42<00:14,  2.86s/it, CE=5.174402e-01 H=4.719393e-01 dV_dx=4.803940e-05 dV_dθ=-4.554887e-02 ||∇||=8.667473e+00 | Tr=0.8479] 80%|████████  | 16/20 [00:42<00:10,  2.67s/it, CE=5.174402e-01 H=4.719393e-01 dV_dx=4.803940e-05 dV_dθ=-4.554887e-02 ||∇||=8.667473e+00 | Tr=0.8479] 80%|████████  | 16/20 [00:44<00:10,  2.67s/it, CE=5.083069e-01 H=4.656012e-01 dV_dx=-2.301256e-05 dV_dθ=-4.268268e-02 ||∇||=8.387017e+00 | Tr=0.8479] 85%|████████▌ | 17/20 [00:44<00:07,  2.50s/it, CE=5.083069e-01 H=4.656012e-01 dV_dx=-2.301256e-05 dV_dθ=-4.268268e-02 ||∇||=8.387017e+00 | Tr=0.8479] 85%|████████▌ | 17/20 [00:46<00:07,  2.50s/it, CE=4.962108e-01 H=4.601249e-01 dV_dx=-3.053584e-05 dV_dθ=-3.605536e-02 ||∇||=7.796048e+00 | Tr=0.8479] 90%|█████████ | 18/20 [00:46<00:05,  2.53s/it, CE=4.962108e-01 H=4.601249e-01 dV_dx=-3.053584e-05 dV_dθ=-3.605536e-02 ||∇||=7.796048e+00 | Tr=0.8479] 90%|█████████ | 18/20 [00:48<00:05,  2.53s/it, CE=4.845511e-01 H=4.484070e-01 dV_dx=-4.811465e-05 dV_dθ=-3.609601e-02 ||∇||=7.602292e+00 | Tr=0.8479] 95%|█████████▌| 19/20 [00:48<00:02,  2.39s/it, CE=4.845511e-01 H=4.484070e-01 dV_dx=-4.811465e-05 dV_dθ=-3.609601e-02 ||∇||=7.602292e+00 | Tr=0.8479] 95%|█████████▌| 19/20 [00:52<00:02,  2.39s/it, CE=4.737091e-01 H=4.384258e-01 dV_dx=-1.937931e-05 dV_dθ=-3.526397e-02 ||∇||=7.404547e+00 | Tr=0.8479 Te/Cur=0.9459 Te/Exp=0.8002]100%|██████████| 20/20 [00:55<00:00,  3.74s/it, CE=4.737091e-01 H=4.384258e-01 dV_dx=-1.937931e-05 dV_dθ=-3.526397e-02 ||∇||=7.404547e+00 | Tr=0.8479 Te/Cur=0.9459 Te/Exp=0.8002]100%|██████████| 20/20 [00:55<00:00,  2.79s/it, CE=4.737091e-01 H=4.384258e-01 dV_dx=-1.937931e-05 dV_dθ=-3.526397e-02 ||∇||=7.404547e+00 | Tr=0.8479 Te/Cur=0.9459 Te/Exp=0.8002]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.83s/it] 50%|█████     | 1/2 [00:12<00:08,  8.83s/it, CE=5.159529e-01 H=5.137666e-01 dV_dx=8.295711e-05 dV_dθ=-2.269320e-03 ||∇||=2.262321e+00 | Tr=0.9716 Te/Cur=0.9489 Te/Exp=0.8062]100%|██████████| 2/2 [00:12<00:00,  5.95s/it, CE=5.159529e-01 H=5.137666e-01 dV_dx=8.295711e-05 dV_dθ=-2.269320e-03 ||∇||=2.262321e+00 | Tr=0.9716 Te/Cur=0.9489 Te/Exp=0.8062]100%|██████████| 2/2 [00:12<00:00,  6.38s/it, CE=5.159529e-01 H=5.137666e-01 dV_dx=8.295711e-05 dV_dθ=-2.269320e-03 ||∇||=2.262321e+00 | Tr=0.9716 Te/Cur=0.9489 Te/Exp=0.8062]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:06,  9.81s/it]  5%|▌         | 1/20 [00:12<03:06,  9.81s/it, CE=5.080297e-01 H=5.058140e-01 dV_dx=-1.335397e-04 dV_dθ=-2.082156e-03 ||∇||=2.166085e+00 | Tr=0.9748] 10%|█         | 2/20 [00:12<01:36,  5.36s/it, CE=5.080297e-01 H=5.058140e-01 dV_dx=-1.335397e-04 dV_dθ=-2.082156e-03 ||∇||=2.166085e+00 | Tr=0.9748] 10%|█         | 2/20 [00:14<01:36,  5.36s/it, CE=4.913435e-01 H=4.888909e-01 dV_dx=-1.065675e-04 dV_dθ=-2.346046e-03 ||∇||=2.174501e+00 | Tr=0.9762] 15%|█▌        | 3/20 [00:14<01:05,  3.84s/it, CE=4.913435e-01 H=4.888909e-01 dV_dx=-1.065675e-04 dV_dθ=-2.346046e-03 ||∇||=2.174501e+00 | Tr=0.9762] 15%|█▌        | 3/20 [00:16<01:05,  3.84s/it, CE=4.776996e-01 H=4.751313e-01 dV_dx=-4.822560e-05 dV_dθ=-2.520096e-03 ||∇||=2.192019e+00 | Tr=0.9775] 20%|██        | 4/20 [00:16<00:49,  3.12s/it, CE=4.776996e-01 H=4.751313e-01 dV_dx=-4.822560e-05 dV_dθ=-2.520096e-03 ||∇||=2.192019e+00 | Tr=0.9775] 20%|██        | 4/20 [00:18<00:49,  3.12s/it, CE=4.660751e-01 H=4.632112e-01 dV_dx=-4.788531e-05 dV_dθ=-2.816056e-03 ||∇||=2.233621e+00 | Tr=0.9785] 25%|██▌       | 5/20 [00:18<00:41,  2.77s/it, CE=4.660751e-01 H=4.632112e-01 dV_dx=-4.788531e-05 dV_dθ=-2.816056e-03 ||∇||=2.233621e+00 | Tr=0.9785] 25%|██▌       | 5/20 [00:22<00:41,  2.77s/it, CE=4.554052e-01 H=4.523485e-01 dV_dx=-1.282952e-04 dV_dθ=-2.928431e-03 ||∇||=2.237748e+00 | Tr=0.9796 Te/Cur=0.9572 Te/Exp=0.8195] 30%|███       | 6/20 [00:22<00:43,  3.11s/it, CE=4.554052e-01 H=4.523485e-01 dV_dx=-1.282952e-04 dV_dθ=-2.928431e-03 ||∇||=2.237748e+00 | Tr=0.9796 Te/Cur=0.9572 Te/Exp=0.8195] 30%|███       | 6/20 [00:24<00:43,  3.11s/it, CE=4.456816e-01 H=4.424952e-01 dV_dx=-6.718127e-05 dV_dθ=-3.119147e-03 ||∇||=2.253402e+00 | Tr=0.9805]                             35%|███▌      | 7/20 [00:24<00:37,  2.88s/it, CE=4.456816e-01 H=4.424952e-01 dV_dx=-6.718127e-05 dV_dθ=-3.119147e-03 ||∇||=2.253402e+00 | Tr=0.9805] 35%|███▌      | 7/20 [00:26<00:37,  2.88s/it, CE=4.367218e-01 H=4.337329e-01 dV_dx=1.063697e-04 dV_dθ=-3.095188e-03 ||∇||=2.236781e+00 | Tr=0.9813]  40%|████      | 8/20 [00:26<00:32,  2.71s/it, CE=4.367218e-01 H=4.337329e-01 dV_dx=1.063697e-04 dV_dθ=-3.095188e-03 ||∇||=2.236781e+00 | Tr=0.9813] 40%|████      | 8/20 [00:29<00:32,  2.71s/it, CE=4.286816e-01 H=4.253716e-01 dV_dx=-2.372604e-05 dV_dθ=-3.286323e-03 ||∇||=2.258973e+00 | Tr=0.9821] 45%|████▌     | 9/20 [00:29<00:30,  2.77s/it, CE=4.286816e-01 H=4.253716e-01 dV_dx=-2.372604e-05 dV_dθ=-3.286323e-03 ||∇||=2.258973e+00 | Tr=0.9821] 45%|████▌     | 9/20 [00:33<00:30,  2.77s/it, CE=4.215265e-01 H=4.179801e-01 dV_dx=-1.734509e-06 dV_dθ=-3.544695e-03 ||∇||=2.292182e+00 | Tr=0.9828] 50%|█████     | 10/20 [00:33<00:29,  2.96s/it, CE=4.215265e-01 H=4.179801e-01 dV_dx=-1.734509e-06 dV_dθ=-3.544695e-03 ||∇||=2.292182e+00 | Tr=0.9828] 50%|█████     | 10/20 [00:37<00:29,  2.96s/it, CE=4.142904e-01 H=4.107768e-01 dV_dx=-6.722368e-06 dV_dθ=-3.506872e-03 ||∇||=2.267436e+00 | Tr=0.9837 Te/Cur=0.9604 Te/Exp=0.8266] 55%|█████▌    | 11/20 [00:37<00:29,  3.28s/it, CE=4.142904e-01 H=4.107768e-01 dV_dx=-6.722368e-06 dV_dθ=-3.506872e-03 ||∇||=2.267436e+00 | Tr=0.9837 Te/Cur=0.9604 Te/Exp=0.8266] 55%|█████▌    | 11/20 [00:39<00:29,  3.28s/it, CE=4.076115e-01 H=4.041315e-01 dV_dx=7.584451e-05 dV_dθ=-3.555880e-03 ||∇||=2.247672e+00 | Tr=0.9842]                              60%|██████    | 12/20 [00:39<00:23,  2.89s/it, CE=4.076115e-01 H=4.041315e-01 dV_dx=7.584451e-05 dV_dθ=-3.555880e-03 ||∇||=2.247672e+00 | Tr=0.9842] 60%|██████    | 12/20 [00:40<00:23,  2.89s/it, CE=4.005449e-01 H=3.973599e-01 dV_dx=-1.193875e-04 dV_dθ=-3.065641e-03 ||∇||=2.153975e+00 | Tr=0.9848] 65%|██████▌   | 13/20 [00:40<00:17,  2.55s/it, CE=4.005449e-01 H=3.973599e-01 dV_dx=-1.193875e-04 dV_dθ=-3.065641e-03 ||∇||=2.153975e+00 | Tr=0.9848] 65%|██████▌   | 13/20 [00:43<00:17,  2.55s/it, CE=3.940555e-01 H=3.914165e-01 dV_dx=4.939967e-05 dV_dθ=-2.688380e-03 ||∇||=2.095545e+00 | Tr=0.9855]  70%|███████   | 14/20 [00:43<00:14,  2.49s/it, CE=3.940555e-01 H=3.914165e-01 dV_dx=4.939967e-05 dV_dθ=-2.688380e-03 ||∇||=2.095545e+00 | Tr=0.9855] 70%|███████   | 14/20 [00:45<00:14,  2.49s/it, CE=3.879359e-01 H=3.855148e-01 dV_dx=5.411321e-05 dV_dθ=-2.475262e-03 ||∇||=2.049007e+00 | Tr=0.9862] 75%|███████▌  | 15/20 [00:45<00:12,  2.45s/it, CE=3.879359e-01 H=3.855148e-01 dV_dx=5.411321e-05 dV_dθ=-2.475262e-03 ||∇||=2.049007e+00 | Tr=0.9862] 75%|███████▌  | 15/20 [00:48<00:12,  2.45s/it, CE=3.816762e-01 H=3.796235e-01 dV_dx=-3.756756e-05 dV_dθ=-2.015139e-03 ||∇||=1.963848e+00 | Tr=0.9868 Te/Cur=0.9627 Te/Exp=0.8335] 80%|████████  | 16/20 [00:48<00:11,  2.75s/it, CE=3.816762e-01 H=3.796235e-01 dV_dx=-3.756756e-05 dV_dθ=-2.015139e-03 ||∇||=1.963848e+00 | Tr=0.9868 Te/Cur=0.9627 Te/Exp=0.8335] 80%|████████  | 16/20 [00:51<00:11,  2.75s/it, CE=3.757353e-01 H=3.740273e-01 dV_dx=1.463671e-05 dV_dθ=-1.722660e-03 ||∇||=1.907305e+00 | Tr=0.9873]                              85%|████████▌ | 17/20 [00:51<00:07,  2.60s/it, CE=3.757353e-01 H=3.740273e-01 dV_dx=1.463671e-05 dV_dθ=-1.722660e-03 ||∇||=1.907305e+00 | Tr=0.9873] 85%|████████▌ | 17/20 [00:52<00:07,  2.60s/it, CE=3.702399e-01 H=3.687021e-01 dV_dx=-4.839918e-05 dV_dθ=-1.489485e-03 ||∇||=1.867909e+00 | Tr=0.9880] 90%|█████████ | 18/20 [00:52<00:04,  2.29s/it, CE=3.702399e-01 H=3.687021e-01 dV_dx=-4.839918e-05 dV_dθ=-1.489485e-03 ||∇||=1.867909e+00 | Tr=0.9880] 90%|█████████ | 18/20 [00:54<00:04,  2.29s/it, CE=3.651739e-01 H=3.637581e-01 dV_dx=-2.525223e-06 dV_dθ=-1.413219e-03 ||∇||=1.847887e+00 | Tr=0.9885] 95%|█████████▌| 19/20 [00:54<00:02,  2.24s/it, CE=3.651739e-01 H=3.637581e-01 dV_dx=-2.525223e-06 dV_dθ=-1.413219e-03 ||∇||=1.847887e+00 | Tr=0.9885] 95%|█████████▌| 19/20 [00:58<00:02,  2.24s/it, CE=3.602887e-01 H=3.589032e-01 dV_dx=2.210638e-05 dV_dθ=-1.407589e-03 ||∇||=1.836930e+00 | Tr=0.9890 Te/Cur=0.9659 Te/Exp=0.8299]100%|██████████| 20/20 [00:58<00:00,  2.66s/it, CE=3.602887e-01 H=3.589032e-01 dV_dx=2.210638e-05 dV_dθ=-1.407589e-03 ||∇||=1.836930e+00 | Tr=0.9890 Te/Cur=0.9659 Te/Exp=0.8299]100%|██████████| 20/20 [00:58<00:00,  2.93s/it, CE=3.602887e-01 H=3.589032e-01 dV_dx=2.210638e-05 dV_dθ=-1.407589e-03 ||∇||=1.836930e+00 | Tr=0.9890 Te/Cur=0.9659 Te/Exp=0.8299]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 8 final loss: 0.370982
======================================================================


  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.7471
    Task 1: 0.9120
    Task 2: 0.8060
    Task 3: 0.5807
    Task 4: 0.9124
    Task 5: 0.9016
    Task 6: 0.9059
    Task 7: 0.9015
    Task 8: 0.9651

============================================================
Task 9
============================================================
Initial loss on new task: 1.9459, previous: 0.3603, ratio: 5.40
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 9
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:09<?, ?it/s, CE=4.514371e-01 H=4.286096e-01 dV_dx=-1.941726e-04 dV_dθ=-2.263329e-02 ||∇||=4.715067e+00 | Tr=0.8178 Te/Cur=0.8826 Te/Exp=0.8392]100%|██████████| 1/1 [00:09<00:00,  9.06s/it, CE=4.514371e-01 H=4.286096e-01 dV_dx=-1.941726e-04 dV_dθ=-2.263329e-02 ||∇||=4.715067e+00 | Tr=0.8178 Te/Cur=0.8826 Te/Exp=0.8392]100%|██████████| 1/1 [00:09<00:00,  9.06s/it, CE=4.514371e-01 H=4.286096e-01 dV_dx=-1.941726e-04 dV_dθ=-2.263329e-02 ||∇||=4.715067e+00 | Tr=0.8178 Te/Cur=0.8826 Te/Exp=0.8392]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.451437

[STEP 2] Architecture change decision
  Current: 0.451437, Previous: 0.360289
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9416 samples from 10 classes
  Created balanced validation set: 39933 samples from 10 classes
  Starting grid architecture search for task 9
  Baseline architecture: (2, [507, 592, 244, 10])
  Baseline loss: 0.451437
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.73s/it] 50%|█████     | 1/2 [00:06<00:04,  4.73s/it, CE=2.244048e+00 H=2.243856e+00 dV_dx=-1.391634e-06 dV_dθ=-1.905739e-04 ||∇||=5.649384e-01 | Tr=0.1675 Te/Cur=0.2209 Te/Exp=0.2434]100%|██████████| 2/2 [00:06<00:00,  3.07s/it, CE=2.244048e+00 H=2.243856e+00 dV_dx=-1.391634e-06 dV_dθ=-1.905739e-04 ||∇||=5.649384e-01 | Tr=0.1675 Te/Cur=0.2209 Te/Exp=0.2434]100%|██████████| 2/2 [00:06<00:00,  3.32s/it, CE=2.244048e+00 H=2.243856e+00 dV_dx=-1.391634e-06 dV_dθ=-1.905739e-04 ||∇||=5.649384e-01 | Tr=0.1675 Te/Cur=0.2209 Te/Exp=0.2434]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.244048167451317
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.39s/it] 50%|█████     | 1/2 [00:11<00:09,  9.39s/it, CE=2.235776e+00 H=2.235636e+00 dV_dx=-1.055095e-05 dV_dθ=-1.295956e-04 ||∇||=4.902052e-01 | Tr=0.2469 Te/Cur=0.2810 Te/Exp=0.2708]100%|██████████| 2/2 [00:11<00:00,  4.97s/it, CE=2.235776e+00 H=2.235636e+00 dV_dx=-1.055095e-05 dV_dθ=-1.295956e-04 ||∇||=4.902052e-01 | Tr=0.2469 Te/Cur=0.2810 Te/Exp=0.2708]100%|██████████| 2/2 [00:11<00:00,  5.63s/it, CE=2.235776e+00 H=2.235636e+00 dV_dx=-1.055095e-05 dV_dθ=-1.295956e-04 ||∇||=4.902052e-01 | Tr=0.2469 Te/Cur=0.2810 Te/Exp=0.2708]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 592, 224, 10]) with loss 2.235776
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.16s/it] 50%|█████     | 1/2 [00:16<00:14, 14.16s/it, CE=2.234981e+00 H=2.234844e+00 dV_dx=6.464961e-06 dV_dθ=-1.435986e-04 ||∇||=5.361648e-01 | Tr=0.1849 Te/Cur=0.2373 Te/Exp=0.2451]100%|██████████| 2/2 [00:16<00:00,  7.04s/it, CE=2.234981e+00 H=2.234844e+00 dV_dx=6.464961e-06 dV_dθ=-1.435986e-04 ||∇||=5.361648e-01 | Tr=0.1849 Te/Cur=0.2373 Te/Exp=0.2451]100%|██████████| 2/2 [00:16<00:00,  8.11s/it, CE=2.234981e+00 H=2.234844e+00 dV_dx=6.464961e-06 dV_dθ=-1.435986e-04 ||∇||=5.361648e-01 | Tr=0.1849 Te/Cur=0.2373 Te/Exp=0.2451]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 224, 10]) with loss 2.234981
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.23s/it] 50%|█████     | 1/2 [00:11<00:10, 10.23s/it, CE=2.255328e+00 H=2.255142e+00 dV_dx=-1.882869e-05 dV_dθ=-1.669017e-04 ||∇||=5.291989e-01 | Tr=0.1419 Te/Cur=0.1599 Te/Exp=0.2404]100%|██████████| 2/2 [00:11<00:00,  5.25s/it, CE=2.255328e+00 H=2.255142e+00 dV_dx=-1.882869e-05 dV_dθ=-1.669017e-04 ||∇||=5.291989e-01 | Tr=0.1419 Te/Cur=0.1599 Te/Exp=0.2404]100%|██████████| 2/2 [00:11<00:00,  6.00s/it, CE=2.255328e+00 H=2.255142e+00 dV_dx=-1.882869e-05 dV_dθ=-1.669017e-04 ||∇||=5.291989e-01 | Tr=0.1419 Te/Cur=0.1599 Te/Exp=0.2404]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.26s/it] 50%|█████     | 1/2 [00:07<00:05,  5.26s/it, CE=2.239858e+00 H=2.239694e+00 dV_dx=6.852625e-06 dV_dθ=-1.709831e-04 ||∇||=5.668353e-01 | Tr=0.2094 Te/Cur=0.2432 Te/Exp=0.2351]100%|██████████| 2/2 [00:07<00:00,  3.46s/it, CE=2.239858e+00 H=2.239694e+00 dV_dx=6.852625e-06 dV_dθ=-1.709831e-04 ||∇||=5.668353e-01 | Tr=0.2094 Te/Cur=0.2432 Te/Exp=0.2351]100%|██████████| 2/2 [00:07<00:00,  3.73s/it, CE=2.239858e+00 H=2.239694e+00 dV_dx=6.852625e-06 dV_dθ=-1.709831e-04 ||∇||=5.668353e-01 | Tr=0.2094 Te/Cur=0.2432 Te/Exp=0.2351]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.64s/it] 50%|█████     | 1/2 [00:11<00:10, 10.64s/it, CE=2.231695e+00 H=2.231544e+00 dV_dx=4.067725e-06 dV_dθ=-1.552328e-04 ||∇||=5.522289e-01 | Tr=0.1528 Te/Cur=0.1834 Te/Exp=0.2689]100%|██████████| 2/2 [00:11<00:00,  5.14s/it, CE=2.231695e+00 H=2.231544e+00 dV_dx=4.067725e-06 dV_dθ=-1.552328e-04 ||∇||=5.522289e-01 | Tr=0.1528 Te/Cur=0.1834 Te/Exp=0.2689]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.231695e+00 H=2.231544e+00 dV_dx=4.067725e-06 dV_dθ=-1.552328e-04 ||∇||=5.522289e-01 | Tr=0.1528 Te/Cur=0.1834 Te/Exp=0.2689]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 244, 10]) with loss 2.231695
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.42s/it] 50%|█████     | 1/2 [00:12<00:10, 10.42s/it, CE=2.253769e+00 H=2.253648e+00 dV_dx=-7.971580e-06 dV_dθ=-1.130455e-04 ||∇||=4.784751e-01 | Tr=0.1480 Te/Cur=0.1897 Te/Exp=0.2399]100%|██████████| 2/2 [00:12<00:00,  5.33s/it, CE=2.253769e+00 H=2.253648e+00 dV_dx=-7.971580e-06 dV_dθ=-1.130455e-04 ||∇||=4.784751e-01 | Tr=0.1480 Te/Cur=0.1897 Te/Exp=0.2399]100%|██████████| 2/2 [00:12<00:00,  6.09s/it, CE=2.253769e+00 H=2.253648e+00 dV_dx=-7.971580e-06 dV_dθ=-1.130455e-04 ||∇||=4.784751e-01 | Tr=0.1480 Te/Cur=0.1897 Te/Exp=0.2399]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.73s/it] 50%|█████     | 1/2 [00:11<00:09,  9.73s/it, CE=2.231267e+00 H=2.231139e+00 dV_dx=-1.333712e-06 dV_dθ=-1.268828e-04 ||∇||=4.826611e-01 | Tr=0.1709 Te/Cur=0.2002 Te/Exp=0.2792]100%|██████████| 2/2 [00:11<00:00,  5.18s/it, CE=2.231267e+00 H=2.231139e+00 dV_dx=-1.333712e-06 dV_dθ=-1.268828e-04 ||∇||=4.826611e-01 | Tr=0.1709 Te/Cur=0.2002 Te/Exp=0.2792]100%|██████████| 2/2 [00:11<00:00,  5.86s/it, CE=2.231267e+00 H=2.231139e+00 dV_dx=-1.333712e-06 dV_dθ=-1.268828e-04 ||∇||=4.826611e-01 | Tr=0.1709 Te/Cur=0.2002 Te/Exp=0.2792]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 592, 264, 10]) with loss 2.231267
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.17s/it] 50%|█████     | 1/2 [00:12<00:10, 10.17s/it, CE=2.241483e+00 H=2.241273e+00 dV_dx=-2.785683e-06 dV_dθ=-2.069690e-04 ||∇||=5.311508e-01 | Tr=0.1967 Te/Cur=0.2309 Te/Exp=0.2396]100%|██████████| 2/2 [00:12<00:00,  5.35s/it, CE=2.241483e+00 H=2.241273e+00 dV_dx=-2.785683e-06 dV_dθ=-2.069690e-04 ||∇||=5.311508e-01 | Tr=0.1967 Te/Cur=0.2309 Te/Exp=0.2396]100%|██████████| 2/2 [00:12<00:00,  6.07s/it, CE=2.241483e+00 H=2.241273e+00 dV_dx=-2.785683e-06 dV_dθ=-2.069690e-04 ||∇||=5.311508e-01 | Tr=0.1967 Te/Cur=0.2309 Te/Exp=0.2396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.50s/it] 50%|█████     | 1/2 [00:07<00:05,  5.50s/it, CE=2.269781e+00 H=2.269712e+00 dV_dx=7.313506e-06 dV_dθ=-7.696834e-05 ||∇||=3.733057e-01 | Tr=0.1231 Te/Cur=0.1477 Te/Exp=0.1857]100%|██████████| 2/2 [00:07<00:00,  3.26s/it, CE=2.269781e+00 H=2.269712e+00 dV_dx=7.313506e-06 dV_dθ=-7.696834e-05 ||∇||=3.733057e-01 | Tr=0.1231 Te/Cur=0.1477 Te/Exp=0.1857]100%|██████████| 2/2 [00:07<00:00,  3.60s/it, CE=2.269781e+00 H=2.269712e+00 dV_dx=7.313506e-06 dV_dθ=-7.696834e-05 ||∇||=3.733057e-01 | Tr=0.1231 Te/Cur=0.1477 Te/Exp=0.1857]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.61s/it] 50%|█████     | 1/2 [00:15<00:13, 13.61s/it, CE=2.264979e+00 H=2.264899e+00 dV_dx=-1.951968e-05 dV_dθ=-5.984791e-05 ||∇||=3.480416e-01 | Tr=0.2151 Te/Cur=0.2344 Te/Exp=0.2382]100%|██████████| 2/2 [00:15<00:00,  6.74s/it, CE=2.264979e+00 H=2.264899e+00 dV_dx=-1.951968e-05 dV_dθ=-5.984791e-05 ||∇||=3.480416e-01 | Tr=0.2151 Te/Cur=0.2344 Te/Exp=0.2382]100%|██████████| 2/2 [00:15<00:00,  7.77s/it, CE=2.264979e+00 H=2.264899e+00 dV_dx=-1.951968e-05 dV_dθ=-5.984791e-05 ||∇||=3.480416e-01 | Tr=0.2151 Te/Cur=0.2344 Te/Exp=0.2382]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.36s/it] 50%|█████     | 1/2 [00:12<00:10, 10.36s/it, CE=2.262049e+00 H=2.262011e+00 dV_dx=9.309060e-06 dV_dθ=-4.681919e-05 ||∇||=3.732493e-01 | Tr=0.1413 Te/Cur=0.1422 Te/Exp=0.2453]100%|██████████| 2/2 [00:12<00:00,  5.26s/it, CE=2.262049e+00 H=2.262011e+00 dV_dx=9.309060e-06 dV_dθ=-4.681919e-05 ||∇||=3.732493e-01 | Tr=0.1413 Te/Cur=0.1422 Te/Exp=0.2453]100%|██████████| 2/2 [00:12<00:00,  6.02s/it, CE=2.262049e+00 H=2.262011e+00 dV_dx=9.309060e-06 dV_dθ=-4.681919e-05 ||∇||=3.732493e-01 | Tr=0.1413 Te/Cur=0.1422 Te/Exp=0.2453]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.08s/it] 50%|█████     | 1/2 [00:10<00:09,  9.08s/it, CE=2.275623e+00 H=2.275512e+00 dV_dx=7.994797e-06 dV_dθ=-1.190051e-04 ||∇||=3.830156e-01 | Tr=0.1233 Te/Cur=0.1447 Te/Exp=0.2204]100%|██████████| 2/2 [00:10<00:00,  4.58s/it, CE=2.275623e+00 H=2.275512e+00 dV_dx=7.994797e-06 dV_dθ=-1.190051e-04 ||∇||=3.830156e-01 | Tr=0.1233 Te/Cur=0.1447 Te/Exp=0.2204]100%|██████████| 2/2 [00:10<00:00,  5.26s/it, CE=2.275623e+00 H=2.275512e+00 dV_dx=7.994797e-06 dV_dθ=-1.190051e-04 ||∇||=3.830156e-01 | Tr=0.1233 Te/Cur=0.1447 Te/Exp=0.2204]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.11s/it] 50%|█████     | 1/2 [00:08<00:06,  6.11s/it, CE=2.273849e+00 H=2.273778e+00 dV_dx=-1.040426e-05 dV_dθ=-6.056425e-05 ||∇||=3.714308e-01 | Tr=0.1249 Te/Cur=0.1298 Te/Exp=0.2118]100%|██████████| 2/2 [00:08<00:00,  3.82s/it, CE=2.273849e+00 H=2.273778e+00 dV_dx=-1.040426e-05 dV_dθ=-6.056425e-05 ||∇||=3.714308e-01 | Tr=0.1249 Te/Cur=0.1298 Te/Exp=0.2118]100%|██████████| 2/2 [00:08<00:00,  4.16s/it, CE=2.273849e+00 H=2.273778e+00 dV_dx=-1.040426e-05 dV_dθ=-6.056425e-05 ||∇||=3.714308e-01 | Tr=0.1249 Te/Cur=0.1298 Te/Exp=0.2118]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.98s/it] 50%|█████     | 1/2 [00:12<00:09,  9.98s/it, CE=2.267282e+00 H=2.267156e+00 dV_dx=-2.336561e-05 dV_dθ=-1.031839e-04 ||∇||=3.708001e-01 | Tr=0.1886 Te/Cur=0.2078 Te/Exp=0.2246]100%|██████████| 2/2 [00:12<00:00,  5.32s/it, CE=2.267282e+00 H=2.267156e+00 dV_dx=-2.336561e-05 dV_dθ=-1.031839e-04 ||∇||=3.708001e-01 | Tr=0.1886 Te/Cur=0.2078 Te/Exp=0.2246]100%|██████████| 2/2 [00:12<00:00,  6.02s/it, CE=2.267282e+00 H=2.267156e+00 dV_dx=-2.336561e-05 dV_dθ=-1.031839e-04 ||∇||=3.708001e-01 | Tr=0.1886 Te/Cur=0.2078 Te/Exp=0.2246]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.72s/it] 50%|█████     | 1/2 [00:12<00:10, 10.72s/it, CE=2.272922e+00 H=2.272890e+00 dV_dx=1.917338e-05 dV_dθ=-5.108052e-05 ||∇||=3.379126e-01 | Tr=0.1542 Te/Cur=0.2142 Te/Exp=0.2236]100%|██████████| 2/2 [00:12<00:00,  5.37s/it, CE=2.272922e+00 H=2.272890e+00 dV_dx=1.917338e-05 dV_dθ=-5.108052e-05 ||∇||=3.379126e-01 | Tr=0.1542 Te/Cur=0.2142 Te/Exp=0.2236]100%|██████████| 2/2 [00:12<00:00,  6.17s/it, CE=2.272922e+00 H=2.272890e+00 dV_dx=1.917338e-05 dV_dθ=-5.108052e-05 ||∇||=3.379126e-01 | Tr=0.1542 Te/Cur=0.2142 Te/Exp=0.2236]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.42s/it] 50%|█████     | 1/2 [00:11<00:09,  9.42s/it, CE=2.272963e+00 H=2.272921e+00 dV_dx=1.691825e-05 dV_dθ=-5.928523e-05 ||∇||=3.362618e-01 | Tr=0.1769 Te/Cur=0.1673 Te/Exp=0.2131]100%|██████████| 2/2 [00:11<00:00,  4.99s/it, CE=2.272963e+00 H=2.272921e+00 dV_dx=1.691825e-05 dV_dθ=-5.928523e-05 ||∇||=3.362618e-01 | Tr=0.1769 Te/Cur=0.1673 Te/Exp=0.2131]100%|██████████| 2/2 [00:11<00:00,  5.66s/it, CE=2.272963e+00 H=2.272921e+00 dV_dx=1.691825e-05 dV_dθ=-5.928523e-05 ||∇||=3.362618e-01 | Tr=0.1769 Te/Cur=0.1673 Te/Exp=0.2131]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.50s/it] 50%|█████     | 1/2 [00:11<00:09,  9.50s/it, CE=2.266314e+00 H=2.266250e+00 dV_dx=4.929254e-06 dV_dθ=-6.971068e-05 ||∇||=3.550063e-01 | Tr=0.1558 Te/Cur=0.1709 Te/Exp=0.2483]100%|██████████| 2/2 [00:11<00:00,  5.17s/it, CE=2.266314e+00 H=2.266250e+00 dV_dx=4.929254e-06 dV_dθ=-6.971068e-05 ||∇||=3.550063e-01 | Tr=0.1558 Te/Cur=0.1709 Te/Exp=0.2483]100%|██████████| 2/2 [00:11<00:00,  5.82s/it, CE=2.266314e+00 H=2.266250e+00 dV_dx=4.929254e-06 dV_dθ=-6.971068e-05 ||∇||=3.550063e-01 | Tr=0.1558 Te/Cur=0.1709 Te/Exp=0.2483]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.56s/it] 50%|█████     | 1/2 [00:07<00:05,  5.56s/it, CE=2.265370e+00 H=2.265241e+00 dV_dx=-9.481949e-06 dV_dθ=-1.192743e-04 ||∇||=4.027185e-01 | Tr=0.1671 Te/Cur=0.1783 Te/Exp=0.2264]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.265370e+00 H=2.265241e+00 dV_dx=-9.481949e-06 dV_dθ=-1.192743e-04 ||∇||=4.027185e-01 | Tr=0.1671 Te/Cur=0.1783 Te/Exp=0.2264]100%|██████████| 2/2 [00:07<00:00,  3.83s/it, CE=2.265370e+00 H=2.265241e+00 dV_dx=-9.481949e-06 dV_dθ=-1.192743e-04 ||∇||=4.027185e-01 | Tr=0.1671 Te/Cur=0.1783 Te/Exp=0.2264]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.03s/it] 50%|█████     | 1/2 [00:15<00:14, 14.03s/it, CE=2.256433e+00 H=2.256320e+00 dV_dx=-2.262497e-05 dV_dθ=-9.084869e-05 ||∇||=3.578963e-01 | Tr=0.1775 Te/Cur=0.2077 Te/Exp=0.2491]100%|██████████| 2/2 [00:15<00:00,  6.69s/it, CE=2.256433e+00 H=2.256320e+00 dV_dx=-2.262497e-05 dV_dθ=-9.084869e-05 ||∇||=3.578963e-01 | Tr=0.1775 Te/Cur=0.2077 Te/Exp=0.2491]100%|██████████| 2/2 [00:15<00:00,  7.79s/it, CE=2.256433e+00 H=2.256320e+00 dV_dx=-2.262497e-05 dV_dθ=-9.084869e-05 ||∇||=3.578963e-01 | Tr=0.1775 Te/Cur=0.2077 Te/Exp=0.2491]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.91s/it] 50%|█████     | 1/2 [00:11<00:09,  9.91s/it, CE=2.265510e+00 H=2.265429e+00 dV_dx=-1.156486e-06 dV_dθ=-7.985197e-05 ||∇||=3.623595e-01 | Tr=0.1856 Te/Cur=0.2336 Te/Exp=0.2216]100%|██████████| 2/2 [00:11<00:00,  5.27s/it, CE=2.265510e+00 H=2.265429e+00 dV_dx=-1.156486e-06 dV_dθ=-7.985197e-05 ||∇||=3.623595e-01 | Tr=0.1856 Te/Cur=0.2336 Te/Exp=0.2216]100%|██████████| 2/2 [00:11<00:00,  5.96s/it, CE=2.265510e+00 H=2.265429e+00 dV_dx=-1.156486e-06 dV_dθ=-7.985197e-05 ||∇||=3.623595e-01 | Tr=0.1856 Te/Cur=0.2336 Te/Exp=0.2216]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.15s/it] 50%|█████     | 1/2 [00:11<00:10, 10.15s/it, CE=2.270671e+00 H=2.270588e+00 dV_dx=-3.600854e-06 dV_dθ=-7.929671e-05 ||∇||=3.773950e-01 | Tr=0.1339 Te/Cur=0.1708 Te/Exp=0.2194]100%|██████████| 2/2 [00:11<00:00,  5.24s/it, CE=2.270671e+00 H=2.270588e+00 dV_dx=-3.600854e-06 dV_dθ=-7.929671e-05 ||∇||=3.773950e-01 | Tr=0.1339 Te/Cur=0.1708 Te/Exp=0.2194]100%|██████████| 2/2 [00:11<00:00,  5.98s/it, CE=2.270671e+00 H=2.270588e+00 dV_dx=-3.600854e-06 dV_dθ=-7.929671e-05 ||∇||=3.773950e-01 | Tr=0.1339 Te/Cur=0.1708 Te/Exp=0.2194]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.51s/it] 50%|█████     | 1/2 [00:07<00:05,  5.51s/it, CE=2.262211e+00 H=2.262096e+00 dV_dx=-1.019722e-05 dV_dθ=-1.049243e-04 ||∇||=3.777498e-01 | Tr=0.1779 Te/Cur=0.1816 Te/Exp=0.1960]100%|██████████| 2/2 [00:07<00:00,  3.28s/it, CE=2.262211e+00 H=2.262096e+00 dV_dx=-1.019722e-05 dV_dθ=-1.049243e-04 ||∇||=3.777498e-01 | Tr=0.1779 Te/Cur=0.1816 Te/Exp=0.1960]100%|██████████| 2/2 [00:07<00:00,  3.61s/it, CE=2.262211e+00 H=2.262096e+00 dV_dx=-1.019722e-05 dV_dθ=-1.049243e-04 ||∇||=3.777498e-01 | Tr=0.1779 Te/Cur=0.1816 Te/Exp=0.1960]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.09s/it] 50%|█████     | 1/2 [00:11<00:10, 10.09s/it, CE=2.265826e+00 H=2.265735e+00 dV_dx=-9.305701e-06 dV_dθ=-8.162370e-05 ||∇||=3.454677e-01 | Tr=0.1780 Te/Cur=0.2119 Te/Exp=0.2340]100%|██████████| 2/2 [00:11<00:00,  5.07s/it, CE=2.265826e+00 H=2.265735e+00 dV_dx=-9.305701e-06 dV_dθ=-8.162370e-05 ||∇||=3.454677e-01 | Tr=0.1780 Te/Cur=0.2119 Te/Exp=0.2340]100%|██████████| 2/2 [00:11<00:00,  5.82s/it, CE=2.265826e+00 H=2.265735e+00 dV_dx=-9.305701e-06 dV_dθ=-8.162370e-05 ||∇||=3.454677e-01 | Tr=0.1780 Te/Cur=0.2119 Te/Exp=0.2340]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.46s/it] 50%|█████     | 1/2 [00:11<00:09,  9.46s/it, CE=2.263363e+00 H=2.263290e+00 dV_dx=6.646308e-06 dV_dθ=-8.035205e-05 ||∇||=3.674914e-01 | Tr=0.1584 Te/Cur=0.1813 Te/Exp=0.2371]100%|██████████| 2/2 [00:11<00:00,  5.07s/it, CE=2.263363e+00 H=2.263290e+00 dV_dx=6.646308e-06 dV_dθ=-8.035205e-05 ||∇||=3.674914e-01 | Tr=0.1584 Te/Cur=0.1813 Te/Exp=0.2371]100%|██████████| 2/2 [00:11<00:00,  5.73s/it, CE=2.263363e+00 H=2.263290e+00 dV_dx=6.646308e-06 dV_dθ=-8.035205e-05 ||∇||=3.674914e-01 | Tr=0.1584 Te/Cur=0.1813 Te/Exp=0.2371]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.01s/it] 50%|█████     | 1/2 [00:11<00:10, 10.01s/it, CE=2.278436e+00 H=2.278341e+00 dV_dx=3.081381e-06 dV_dθ=-9.829419e-05 ||∇||=3.947311e-01 | Tr=0.1731 Te/Cur=0.1765 Te/Exp=0.2361]100%|██████████| 2/2 [00:11<00:00,  5.26s/it, CE=2.278436e+00 H=2.278341e+00 dV_dx=3.081381e-06 dV_dθ=-9.829419e-05 ||∇||=3.947311e-01 | Tr=0.1731 Te/Cur=0.1765 Te/Exp=0.2361]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.278436e+00 H=2.278341e+00 dV_dx=3.081381e-06 dV_dθ=-9.829419e-05 ||∇||=3.947311e-01 | Tr=0.1731 Te/Cur=0.1765 Te/Exp=0.2361]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.04s/it] 50%|█████     | 1/2 [00:11<00:10, 10.04s/it, CE=2.265129e+00 H=2.265042e+00 dV_dx=-8.743055e-06 dV_dθ=-7.822303e-05 ||∇||=3.664076e-01 | Tr=0.2329 Te/Cur=0.2525 Te/Exp=0.2252]100%|██████████| 2/2 [00:11<00:00,  5.19s/it, CE=2.265129e+00 H=2.265042e+00 dV_dx=-8.743055e-06 dV_dθ=-7.822303e-05 ||∇||=3.664076e-01 | Tr=0.2329 Te/Cur=0.2525 Te/Exp=0.2252]100%|██████████| 2/2 [00:11<00:00,  5.92s/it, CE=2.265129e+00 H=2.265042e+00 dV_dx=-8.743055e-06 dV_dθ=-7.822303e-05 ||∇||=3.664076e-01 | Tr=0.2329 Te/Cur=0.2525 Te/Exp=0.2252]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.21s/it] 50%|█████     | 1/2 [00:07<00:05,  5.21s/it, CE=2.222747e+00 H=2.222367e+00 dV_dx=-2.552570e-06 dV_dθ=-3.771363e-04 ||∇||=6.454605e-01 | Tr=0.1833 Te/Cur=0.2423 Te/Exp=0.2732]100%|██████████| 2/2 [00:07<00:00,  3.36s/it, CE=2.222747e+00 H=2.222367e+00 dV_dx=-2.552570e-06 dV_dθ=-3.771363e-04 ||∇||=6.454605e-01 | Tr=0.1833 Te/Cur=0.2423 Te/Exp=0.2732]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.222747e+00 H=2.222367e+00 dV_dx=-2.552570e-06 dV_dθ=-3.771363e-04 ||∇||=6.454605e-01 | Tr=0.1833 Te/Cur=0.2423 Te/Exp=0.2732]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.222746516050807
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.02s/it] 50%|█████     | 1/2 [00:09<00:07,  7.02s/it, CE=2.226980e+00 H=2.226802e+00 dV_dx=-4.220958e-06 dV_dθ=-1.744303e-04 ||∇||=5.922419e-01 | Tr=0.1642 Te/Cur=0.1647 Te/Exp=0.2644]100%|██████████| 2/2 [00:09<00:00,  4.07s/it, CE=2.226980e+00 H=2.226802e+00 dV_dx=-4.220958e-06 dV_dθ=-1.744303e-04 ||∇||=5.922419e-01 | Tr=0.1642 Te/Cur=0.1647 Te/Exp=0.2644]100%|██████████| 2/2 [00:09<00:00,  4.52s/it, CE=2.226980e+00 H=2.226802e+00 dV_dx=-4.220958e-06 dV_dθ=-1.744303e-04 ||∇||=5.922419e-01 | Tr=0.1642 Te/Cur=0.1647 Te/Exp=0.2644]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.23s/it] 50%|█████     | 1/2 [00:11<00:10, 10.23s/it, CE=2.213219e+00 H=2.213016e+00 dV_dx=6.540002e-06 dV_dθ=-2.094855e-04 ||∇||=5.773764e-01 | Tr=0.2045 Te/Cur=0.2682 Te/Exp=0.2955]100%|██████████| 2/2 [00:11<00:00,  5.21s/it, CE=2.213219e+00 H=2.213016e+00 dV_dx=6.540002e-06 dV_dθ=-2.094855e-04 ||∇||=5.773764e-01 | Tr=0.2045 Te/Cur=0.2682 Te/Exp=0.2955]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.213219e+00 H=2.213016e+00 dV_dx=6.540002e-06 dV_dθ=-2.094855e-04 ||∇||=5.773764e-01 | Tr=0.2045 Te/Cur=0.2682 Te/Exp=0.2955]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 224, 10]) with loss 2.213219
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.61s/it] 50%|█████     | 1/2 [00:12<00:10, 10.61s/it, CE=2.230705e+00 H=2.230471e+00 dV_dx=-1.077107e-05 dV_dθ=-2.236132e-04 ||∇||=5.994657e-01 | Tr=0.2599 Te/Cur=0.3065 Te/Exp=0.2731]100%|██████████| 2/2 [00:12<00:00,  5.36s/it, CE=2.230705e+00 H=2.230471e+00 dV_dx=-1.077107e-05 dV_dθ=-2.236132e-04 ||∇||=5.994657e-01 | Tr=0.2599 Te/Cur=0.3065 Te/Exp=0.2731]100%|██████████| 2/2 [00:12<00:00,  6.15s/it, CE=2.230705e+00 H=2.230471e+00 dV_dx=-1.077107e-05 dV_dθ=-2.236132e-04 ||∇||=5.994657e-01 | Tr=0.2599 Te/Cur=0.3065 Te/Exp=0.2731]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.41s/it] 50%|█████     | 1/2 [00:05<00:03,  3.41s/it, CE=2.223740e+00 H=2.223534e+00 dV_dx=-3.737609e-06 dV_dθ=-2.019480e-04 ||∇||=5.664651e-01 | Tr=0.1902 Te/Cur=0.1899 Te/Exp=0.2772]100%|██████████| 2/2 [00:05<00:00,  2.42s/it, CE=2.223740e+00 H=2.223534e+00 dV_dx=-3.737609e-06 dV_dθ=-2.019480e-04 ||∇||=5.664651e-01 | Tr=0.1902 Te/Cur=0.1899 Te/Exp=0.2772]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.223740e+00 H=2.223534e+00 dV_dx=-3.737609e-06 dV_dθ=-2.019480e-04 ||∇||=5.664651e-01 | Tr=0.1902 Te/Cur=0.1899 Te/Exp=0.2772]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.46s/it] 50%|█████     | 1/2 [00:12<00:10, 10.46s/it, CE=2.233463e+00 H=2.233239e+00 dV_dx=-6.562362e-06 dV_dθ=-2.177077e-04 ||∇||=5.406827e-01 | Tr=0.1293 Te/Cur=0.1854 Te/Exp=0.2604]100%|██████████| 2/2 [00:12<00:00,  5.54s/it, CE=2.233463e+00 H=2.233239e+00 dV_dx=-6.562362e-06 dV_dθ=-2.177077e-04 ||∇||=5.406827e-01 | Tr=0.1293 Te/Cur=0.1854 Te/Exp=0.2604]100%|██████████| 2/2 [00:12<00:00,  6.28s/it, CE=2.233463e+00 H=2.233239e+00 dV_dx=-6.562362e-06 dV_dθ=-2.177077e-04 ||∇||=5.406827e-01 | Tr=0.1293 Te/Cur=0.1854 Te/Exp=0.2604]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.99s/it] 50%|█████     | 1/2 [00:12<00:09,  9.99s/it, CE=2.234129e+00 H=2.233895e+00 dV_dx=-1.459564e-05 dV_dθ=-2.193541e-04 ||∇||=5.961756e-01 | Tr=0.1738 Te/Cur=0.2051 Te/Exp=0.2540]100%|██████████| 2/2 [00:12<00:00,  5.34s/it, CE=2.234129e+00 H=2.233895e+00 dV_dx=-1.459564e-05 dV_dθ=-2.193541e-04 ||∇||=5.961756e-01 | Tr=0.1738 Te/Cur=0.2051 Te/Exp=0.2540]100%|██████████| 2/2 [00:12<00:00,  6.04s/it, CE=2.234129e+00 H=2.233895e+00 dV_dx=-1.459564e-05 dV_dθ=-2.193541e-04 ||∇||=5.961756e-01 | Tr=0.1738 Te/Cur=0.2051 Te/Exp=0.2540]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.94s/it] 50%|█████     | 1/2 [00:11<00:09,  9.94s/it, CE=2.202716e+00 H=2.202503e+00 dV_dx=-1.386043e-06 dV_dθ=-2.112550e-04 ||∇||=6.049144e-01 | Tr=0.2226 Te/Cur=0.2826 Te/Exp=0.2880]100%|██████████| 2/2 [00:11<00:00,  5.22s/it, CE=2.202716e+00 H=2.202503e+00 dV_dx=-1.386043e-06 dV_dθ=-2.112550e-04 ||∇||=6.049144e-01 | Tr=0.2226 Te/Cur=0.2826 Te/Exp=0.2880]100%|██████████| 2/2 [00:11<00:00,  5.93s/it, CE=2.202716e+00 H=2.202503e+00 dV_dx=-1.386043e-06 dV_dθ=-2.112550e-04 ||∇||=6.049144e-01 | Tr=0.2226 Te/Cur=0.2826 Te/Exp=0.2880]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 592, 304, 10]) with loss 2.202716
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.46s/it] 50%|█████     | 1/2 [00:11<00:09,  9.46s/it, CE=2.218815e+00 H=2.218648e+00 dV_dx=2.568136e-07 dV_dθ=-1.676378e-04 ||∇||=5.846344e-01 | Tr=0.1630 Te/Cur=0.2246 Te/Exp=0.2770]100%|██████████| 2/2 [00:11<00:00,  5.11s/it, CE=2.218815e+00 H=2.218648e+00 dV_dx=2.568136e-07 dV_dθ=-1.676378e-04 ||∇||=5.846344e-01 | Tr=0.1630 Te/Cur=0.2246 Te/Exp=0.2770]100%|██████████| 2/2 [00:11<00:00,  5.77s/it, CE=2.218815e+00 H=2.218648e+00 dV_dx=2.568136e-07 dV_dθ=-1.676378e-04 ||∇||=5.846344e-01 | Tr=0.1630 Te/Cur=0.2246 Te/Exp=0.2770]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.58s/it] 50%|█████     | 1/2 [00:07<00:05,  5.58s/it, CE=2.248434e+00 H=2.248310e+00 dV_dx=-4.263894e-06 dV_dθ=-1.196370e-04 ||∇||=5.018243e-01 | Tr=0.2014 Te/Cur=0.2112 Te/Exp=0.2384]100%|██████████| 2/2 [00:07<00:00,  3.61s/it, CE=2.248434e+00 H=2.248310e+00 dV_dx=-4.263894e-06 dV_dθ=-1.196370e-04 ||∇||=5.018243e-01 | Tr=0.2014 Te/Cur=0.2112 Te/Exp=0.2384]100%|██████████| 2/2 [00:07<00:00,  3.90s/it, CE=2.248434e+00 H=2.248310e+00 dV_dx=-4.263894e-06 dV_dθ=-1.196370e-04 ||∇||=5.018243e-01 | Tr=0.2014 Te/Cur=0.2112 Te/Exp=0.2384]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.89s/it] 50%|█████     | 1/2 [00:09<00:07,  7.89s/it, CE=2.240091e+00 H=2.239981e+00 dV_dx=-1.776008e-06 dV_dθ=-1.075964e-04 ||∇||=4.674179e-01 | Tr=0.2129 Te/Cur=0.2535 Te/Exp=0.2729]100%|██████████| 2/2 [00:09<00:00,  4.19s/it, CE=2.240091e+00 H=2.239981e+00 dV_dx=-1.776008e-06 dV_dθ=-1.075964e-04 ||∇||=4.674179e-01 | Tr=0.2129 Te/Cur=0.2535 Te/Exp=0.2729]100%|██████████| 2/2 [00:09<00:00,  4.75s/it, CE=2.240091e+00 H=2.239981e+00 dV_dx=-1.776008e-06 dV_dθ=-1.075964e-04 ||∇||=4.674179e-01 | Tr=0.2129 Te/Cur=0.2535 Te/Exp=0.2729]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.37s/it] 50%|█████     | 1/2 [00:11<00:09,  9.37s/it, CE=2.238496e+00 H=2.238356e+00 dV_dx=3.384830e-06 dV_dθ=-1.442102e-04 ||∇||=4.862792e-01 | Tr=0.1865 Te/Cur=0.2119 Te/Exp=0.2544]100%|██████████| 2/2 [00:11<00:00,  5.28s/it, CE=2.238496e+00 H=2.238356e+00 dV_dx=3.384830e-06 dV_dθ=-1.442102e-04 ||∇||=4.862792e-01 | Tr=0.1865 Te/Cur=0.2119 Te/Exp=0.2544]100%|██████████| 2/2 [00:11<00:00,  5.89s/it, CE=2.238496e+00 H=2.238356e+00 dV_dx=3.384830e-06 dV_dθ=-1.442102e-04 ||∇||=4.862792e-01 | Tr=0.1865 Te/Cur=0.2119 Te/Exp=0.2544]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.02s/it] 50%|█████     | 1/2 [00:12<00:10, 10.02s/it, CE=2.249642e+00 H=2.249470e+00 dV_dx=1.175762e-05 dV_dθ=-1.835926e-04 ||∇||=5.263134e-01 | Tr=0.2043 Te/Cur=0.2388 Te/Exp=0.2268]100%|██████████| 2/2 [00:12<00:00,  5.40s/it, CE=2.249642e+00 H=2.249470e+00 dV_dx=1.175762e-05 dV_dθ=-1.835926e-04 ||∇||=5.263134e-01 | Tr=0.2043 Te/Cur=0.2388 Te/Exp=0.2268]100%|██████████| 2/2 [00:12<00:00,  6.09s/it, CE=2.249642e+00 H=2.249470e+00 dV_dx=1.175762e-05 dV_dθ=-1.835926e-04 ||∇||=5.263134e-01 | Tr=0.2043 Te/Cur=0.2388 Te/Exp=0.2268]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.96s/it] 50%|█████     | 1/2 [00:06<00:03,  3.96s/it, CE=2.237333e+00 H=2.237209e+00 dV_dx=3.445858e-06 dV_dθ=-1.268826e-04 ||∇||=4.710599e-01 | Tr=0.2100 Te/Cur=0.2369 Te/Exp=0.2695]100%|██████████| 2/2 [00:06<00:00,  2.84s/it, CE=2.237333e+00 H=2.237209e+00 dV_dx=3.445858e-06 dV_dθ=-1.268826e-04 ||∇||=4.710599e-01 | Tr=0.2100 Te/Cur=0.2369 Te/Exp=0.2695]100%|██████████| 2/2 [00:06<00:00,  3.01s/it, CE=2.237333e+00 H=2.237209e+00 dV_dx=3.445858e-06 dV_dθ=-1.268826e-04 ||∇||=4.710599e-01 | Tr=0.2100 Te/Cur=0.2369 Te/Exp=0.2695]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.02s/it] 50%|█████     | 1/2 [00:12<00:10, 10.02s/it, CE=2.251852e+00 H=2.251704e+00 dV_dx=2.496310e-06 dV_dθ=-1.499665e-04 ||∇||=4.876329e-01 | Tr=0.1968 Te/Cur=0.2588 Te/Exp=0.2428]100%|██████████| 2/2 [00:12<00:00,  5.39s/it, CE=2.251852e+00 H=2.251704e+00 dV_dx=2.496310e-06 dV_dθ=-1.499665e-04 ||∇||=4.876329e-01 | Tr=0.1968 Te/Cur=0.2588 Te/Exp=0.2428]100%|██████████| 2/2 [00:12<00:00,  6.09s/it, CE=2.251852e+00 H=2.251704e+00 dV_dx=2.496310e-06 dV_dθ=-1.499665e-04 ||∇||=4.876329e-01 | Tr=0.1968 Te/Cur=0.2588 Te/Exp=0.2428]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.21s/it] 50%|█████     | 1/2 [00:11<00:10, 10.21s/it, CE=2.247901e+00 H=2.247792e+00 dV_dx=7.649647e-06 dV_dθ=-1.168659e-04 ||∇||=4.542690e-01 | Tr=0.1880 Te/Cur=0.2056 Te/Exp=0.2239]100%|██████████| 2/2 [00:11<00:00,  5.03s/it, CE=2.247901e+00 H=2.247792e+00 dV_dx=7.649647e-06 dV_dθ=-1.168659e-04 ||∇||=4.542690e-01 | Tr=0.1880 Te/Cur=0.2056 Te/Exp=0.2239]100%|██████████| 2/2 [00:11<00:00,  5.81s/it, CE=2.247901e+00 H=2.247792e+00 dV_dx=7.649647e-06 dV_dθ=-1.168659e-04 ||∇||=4.542690e-01 | Tr=0.1880 Te/Cur=0.2056 Te/Exp=0.2239]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.19s/it] 50%|█████     | 1/2 [00:12<00:10, 10.19s/it, CE=2.233176e+00 H=2.233054e+00 dV_dx=2.566161e-06 dV_dθ=-1.239722e-04 ||∇||=4.841868e-01 | Tr=0.1442 Te/Cur=0.2242 Te/Exp=0.2779]100%|██████████| 2/2 [00:12<00:00,  5.34s/it, CE=2.233176e+00 H=2.233054e+00 dV_dx=2.566161e-06 dV_dθ=-1.239722e-04 ||∇||=4.841868e-01 | Tr=0.1442 Te/Cur=0.2242 Te/Exp=0.2779]100%|██████████| 2/2 [00:12<00:00,  6.07s/it, CE=2.233176e+00 H=2.233054e+00 dV_dx=2.566161e-06 dV_dθ=-1.239722e-04 ||∇||=4.841868e-01 | Tr=0.1442 Te/Cur=0.2242 Te/Exp=0.2779]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.20s/it] 50%|█████     | 1/2 [00:10<00:09,  9.20s/it, CE=2.232706e+00 H=2.232577e+00 dV_dx=2.520818e-06 dV_dθ=-1.312970e-04 ||∇||=4.905071e-01 | Tr=0.1167 Te/Cur=0.1768 Te/Exp=0.2519]100%|██████████| 2/2 [00:10<00:00,  4.79s/it, CE=2.232706e+00 H=2.232577e+00 dV_dx=2.520818e-06 dV_dθ=-1.312970e-04 ||∇||=4.905071e-01 | Tr=0.1167 Te/Cur=0.1768 Te/Exp=0.2519]100%|██████████| 2/2 [00:10<00:00,  5.45s/it, CE=2.232706e+00 H=2.232577e+00 dV_dx=2.520818e-06 dV_dθ=-1.312970e-04 ||∇||=4.905071e-01 | Tr=0.1167 Te/Cur=0.1768 Te/Exp=0.2519]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.42s/it] 50%|█████     | 1/2 [00:07<00:05,  5.42s/it, CE=2.263217e+00 H=2.263104e+00 dV_dx=-8.984388e-07 dV_dθ=-1.116408e-04 ||∇||=3.982169e-01 | Tr=0.1442 Te/Cur=0.1826 Te/Exp=0.2153]100%|██████████| 2/2 [00:07<00:00,  3.26s/it, CE=2.263217e+00 H=2.263104e+00 dV_dx=-8.984388e-07 dV_dθ=-1.116408e-04 ||∇||=3.982169e-01 | Tr=0.1442 Te/Cur=0.1826 Te/Exp=0.2153]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.263217e+00 H=2.263104e+00 dV_dx=-8.984388e-07 dV_dθ=-1.116408e-04 ||∇||=3.982169e-01 | Tr=0.1442 Te/Cur=0.1826 Te/Exp=0.2153]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.62s/it] 50%|█████     | 1/2 [00:05<00:03,  3.62s/it, CE=2.246077e+00 H=2.245982e+00 dV_dx=-1.238398e-05 dV_dθ=-8.258760e-05 ||∇||=3.884184e-01 | Tr=0.1187 Te/Cur=0.1495 Te/Exp=0.2342]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.246077e+00 H=2.245982e+00 dV_dx=-1.238398e-05 dV_dθ=-8.258760e-05 ||∇||=3.884184e-01 | Tr=0.1187 Te/Cur=0.1495 Te/Exp=0.2342]100%|██████████| 2/2 [00:05<00:00,  2.71s/it, CE=2.246077e+00 H=2.245982e+00 dV_dx=-1.238398e-05 dV_dθ=-8.258760e-05 ||∇||=3.884184e-01 | Tr=0.1187 Te/Cur=0.1495 Te/Exp=0.2342]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.78s/it] 50%|█████     | 1/2 [00:14<00:12, 12.78s/it, CE=2.246455e+00 H=2.246314e+00 dV_dx=-7.900721e-06 dV_dθ=-1.324568e-04 ||∇||=4.134952e-01 | Tr=0.2064 Te/Cur=0.2218 Te/Exp=0.2229]100%|██████████| 2/2 [00:14<00:00,  6.44s/it, CE=2.246455e+00 H=2.246314e+00 dV_dx=-7.900721e-06 dV_dθ=-1.324568e-04 ||∇||=4.134952e-01 | Tr=0.2064 Te/Cur=0.2218 Te/Exp=0.2229]100%|██████████| 2/2 [00:14<00:00,  7.39s/it, CE=2.246455e+00 H=2.246314e+00 dV_dx=-7.900721e-06 dV_dθ=-1.324568e-04 ||∇||=4.134952e-01 | Tr=0.2064 Te/Cur=0.2218 Te/Exp=0.2229]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.35s/it] 50%|█████     | 1/2 [00:12<00:10, 10.35s/it, CE=2.263094e+00 H=2.262942e+00 dV_dx=9.918242e-07 dV_dθ=-1.532320e-04 ||∇||=4.279120e-01 | Tr=0.1331 Te/Cur=0.1618 Te/Exp=0.2143]100%|██████████| 2/2 [00:12<00:00,  5.33s/it, CE=2.263094e+00 H=2.262942e+00 dV_dx=9.918242e-07 dV_dθ=-1.532320e-04 ||∇||=4.279120e-01 | Tr=0.1331 Te/Cur=0.1618 Te/Exp=0.2143]100%|██████████| 2/2 [00:12<00:00,  6.08s/it, CE=2.263094e+00 H=2.262942e+00 dV_dx=9.918242e-07 dV_dθ=-1.532320e-04 ||∇||=4.279120e-01 | Tr=0.1331 Te/Cur=0.1618 Te/Exp=0.2143]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.80s/it] 50%|█████     | 1/2 [00:05<00:03,  3.80s/it, CE=2.282351e+00 H=2.282248e+00 dV_dx=5.588486e-06 dV_dθ=-1.083935e-04 ||∇||=4.201339e-01 | Tr=0.1565 Te/Cur=0.2259 Te/Exp=0.1746]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.282351e+00 H=2.282248e+00 dV_dx=5.588486e-06 dV_dθ=-1.083935e-04 ||∇||=4.201339e-01 | Tr=0.1565 Te/Cur=0.2259 Te/Exp=0.1746]100%|██████████| 2/2 [00:05<00:00,  2.89s/it, CE=2.282351e+00 H=2.282248e+00 dV_dx=5.588486e-06 dV_dθ=-1.083935e-04 ||∇||=4.201339e-01 | Tr=0.1565 Te/Cur=0.2259 Te/Exp=0.1746]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.17s/it] 50%|█████     | 1/2 [00:10<00:09,  9.17s/it, CE=2.262408e+00 H=2.262244e+00 dV_dx=-1.170975e-06 dV_dθ=-1.628754e-04 ||∇||=4.697621e-01 | Tr=0.1589 Te/Cur=0.2244 Te/Exp=0.2307]100%|██████████| 2/2 [00:10<00:00,  4.72s/it, CE=2.262408e+00 H=2.262244e+00 dV_dx=-1.170975e-06 dV_dθ=-1.628754e-04 ||∇||=4.697621e-01 | Tr=0.1589 Te/Cur=0.2244 Te/Exp=0.2307]100%|██████████| 2/2 [00:10<00:00,  5.39s/it, CE=2.262408e+00 H=2.262244e+00 dV_dx=-1.170975e-06 dV_dθ=-1.628754e-04 ||∇||=4.697621e-01 | Tr=0.1589 Te/Cur=0.2244 Te/Exp=0.2307]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.96s/it] 50%|█████     | 1/2 [00:10<00:08,  8.96s/it, CE=2.253908e+00 H=2.253810e+00 dV_dx=1.126833e-05 dV_dθ=-1.088681e-04 ||∇||=3.887389e-01 | Tr=0.2005 Te/Cur=0.2151 Te/Exp=0.1899]100%|██████████| 2/2 [00:10<00:00,  4.88s/it, CE=2.253908e+00 H=2.253810e+00 dV_dx=1.126833e-05 dV_dθ=-1.088681e-04 ||∇||=3.887389e-01 | Tr=0.2005 Te/Cur=0.2151 Te/Exp=0.1899]100%|██████████| 2/2 [00:10<00:00,  5.49s/it, CE=2.253908e+00 H=2.253810e+00 dV_dx=1.126833e-05 dV_dθ=-1.088681e-04 ||∇||=3.887389e-01 | Tr=0.2005 Te/Cur=0.2151 Te/Exp=0.1899]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.41s/it] 50%|█████     | 1/2 [00:12<00:10, 10.41s/it, CE=2.254815e+00 H=2.254732e+00 dV_dx=1.123179e-05 dV_dθ=-9.368328e-05 ||∇||=3.932543e-01 | Tr=0.1525 Te/Cur=0.2033 Te/Exp=0.2249]100%|██████████| 2/2 [00:12<00:00,  5.54s/it, CE=2.254815e+00 H=2.254732e+00 dV_dx=1.123179e-05 dV_dθ=-9.368328e-05 ||∇||=3.932543e-01 | Tr=0.1525 Te/Cur=0.2033 Te/Exp=0.2249]100%|██████████| 2/2 [00:12<00:00,  6.27s/it, CE=2.254815e+00 H=2.254732e+00 dV_dx=1.123179e-05 dV_dθ=-9.368328e-05 ||∇||=3.932543e-01 | Tr=0.1525 Te/Cur=0.2033 Te/Exp=0.2249]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.50s/it] 50%|█████     | 1/2 [00:13<00:11, 11.50s/it, CE=2.254307e+00 H=2.254156e+00 dV_dx=-6.289156e-06 dV_dθ=-1.440829e-04 ||∇||=3.998670e-01 | Tr=0.1977 Te/Cur=0.2252 Te/Exp=0.1974]100%|██████████| 2/2 [00:13<00:00,  5.80s/it, CE=2.254307e+00 H=2.254156e+00 dV_dx=-6.289156e-06 dV_dθ=-1.440829e-04 ||∇||=3.998670e-01 | Tr=0.1977 Te/Cur=0.2252 Te/Exp=0.1974]100%|██████████| 2/2 [00:13<00:00,  6.65s/it, CE=2.254307e+00 H=2.254156e+00 dV_dx=-6.289156e-06 dV_dθ=-1.440829e-04 ||∇||=3.998670e-01 | Tr=0.1977 Te/Cur=0.2252 Te/Exp=0.1974]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 592, 304, 10]) with loss 2.202716
  Total candidates evaluated: 54
  Original: (2, [507, 592, 244, 10])
  Optimal: (2, [507, 592, 304, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→2, feed [507, 592, 244, 10]→[507, 592, 304, 10]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:15<04:47, 15.15s/it]  5%|▌         | 1/20 [00:17<04:47, 15.15s/it, CE=1.986774e+00 H=1.556427e+00 dV_dx=-2.701146e-06 dV_dθ=-4.303445e-01 ||∇||=2.104500e+01 | Tr=0.8827] 10%|█         | 2/20 [00:17<02:12,  7.38s/it, CE=1.986774e+00 H=1.556427e+00 dV_dx=-2.701146e-06 dV_dθ=-4.303445e-01 ||∇||=2.104500e+01 | Tr=0.8827] 10%|█         | 2/20 [00:19<02:12,  7.38s/it, CE=1.648271e+00 H=9.052036e-01 dV_dx=8.339390e-06 dV_dθ=-7.430754e-01 ||∇||=2.526708e+01 | Tr=0.8827]  15%|█▌        | 3/20 [00:19<01:25,  5.05s/it, CE=1.648271e+00 H=9.052036e-01 dV_dx=8.339390e-06 dV_dθ=-7.430754e-01 ||∇||=2.526708e+01 | Tr=0.8827] 15%|█▌        | 3/20 [00:21<01:25,  5.05s/it, CE=1.412563e+00 H=8.500262e-01 dV_dx=5.864485e-07 dV_dθ=-5.625378e-01 ||∇||=2.258346e+01 | Tr=0.8827] 20%|██        | 4/20 [00:21<01:03,  3.98s/it, CE=1.412563e+00 H=8.500262e-01 dV_dx=5.864485e-07 dV_dθ=-5.625378e-01 ||∇||=2.258346e+01 | Tr=0.8827] 20%|██        | 4/20 [00:23<01:03,  3.98s/it, CE=1.247422e+00 H=6.866382e-01 dV_dx=-7.571921e-06 dV_dθ=-5.607758e-01 ||∇||=2.224062e+01 | Tr=0.8827] 25%|██▌       | 5/20 [00:23<00:50,  3.37s/it, CE=1.247422e+00 H=6.866382e-01 dV_dx=-7.571921e-06 dV_dθ=-5.607758e-01 ||∇||=2.224062e+01 | Tr=0.8827] 25%|██▌       | 5/20 [00:26<00:50,  3.37s/it, CE=1.121635e+00 H=7.428074e-01 dV_dx=1.488299e-05 dV_dθ=-3.788427e-01 ||∇||=1.875208e+01 | Tr=0.8827]  30%|███       | 6/20 [00:26<00:41,  2.97s/it, CE=1.121635e+00 H=7.428074e-01 dV_dx=1.488299e-05 dV_dθ=-3.788427e-01 ||∇||=1.875208e+01 | Tr=0.8827] 30%|███       | 6/20 [00:28<00:41,  2.97s/it, CE=1.021457e+00 H=7.892860e-01 dV_dx=-4.553890e-05 dV_dθ=-2.321258e-01 ||∇||=1.527340e+01 | Tr=0.8827] 35%|███▌      | 7/20 [00:28<00:36,  2.78s/it, CE=1.021457e+00 H=7.892860e-01 dV_dx=-4.553890e-05 dV_dθ=-2.321258e-01 ||∇||=1.527340e+01 | Tr=0.8827] 35%|███▌      | 7/20 [00:31<00:36,  2.78s/it, CE=9.451360e-01 H=7.670233e-01 dV_dx=3.873258e-05 dV_dθ=-1.781514e-01 ||∇||=1.382167e+01 | Tr=0.8827]  40%|████      | 8/20 [00:31<00:33,  2.76s/it, CE=9.451360e-01 H=7.670233e-01 dV_dx=3.873258e-05 dV_dθ=-1.781514e-01 ||∇||=1.382167e+01 | Tr=0.8827] 40%|████      | 8/20 [00:33<00:33,  2.76s/it, CE=8.846832e-01 H=6.877188e-01 dV_dx=-5.805896e-06 dV_dθ=-1.969586e-01 ||∇||=1.427321e+01 | Tr=0.8827] 45%|████▌     | 9/20 [00:33<00:29,  2.65s/it, CE=8.846832e-01 H=6.877188e-01 dV_dx=-5.805896e-06 dV_dθ=-1.969586e-01 ||∇||=1.427321e+01 | Tr=0.8827] 45%|████▌     | 9/20 [00:35<00:29,  2.65s/it, CE=8.334421e-01 H=6.483050e-01 dV_dx=1.476924e-05 dV_dθ=-1.851519e-01 ||∇||=1.383363e+01 | Tr=0.8827]  50%|█████     | 10/20 [00:35<00:25,  2.51s/it, CE=8.334421e-01 H=6.483050e-01 dV_dx=1.476924e-05 dV_dθ=-1.851519e-01 ||∇||=1.383363e+01 | Tr=0.8827] 50%|█████     | 10/20 [00:38<00:25,  2.51s/it, CE=7.917253e-01 H=5.987356e-01 dV_dx=-1.152219e-05 dV_dθ=-1.929781e-01 ||∇||=1.389399e+01 | Tr=0.8827] 55%|█████▌    | 11/20 [00:38<00:22,  2.50s/it, CE=7.917253e-01 H=5.987356e-01 dV_dx=-1.152219e-05 dV_dθ=-1.929781e-01 ||∇||=1.389399e+01 | Tr=0.8827] 55%|█████▌    | 11/20 [00:40<00:22,  2.50s/it, CE=7.574774e-01 H=5.184325e-01 dV_dx=6.271564e-05 dV_dθ=-2.391076e-01 ||∇||=1.532789e+01 | Tr=0.8827]  60%|██████    | 12/20 [00:40<00:19,  2.44s/it, CE=7.574774e-01 H=5.184325e-01 dV_dx=6.271564e-05 dV_dθ=-2.391076e-01 ||∇||=1.532789e+01 | Tr=0.8827] 60%|██████    | 12/20 [00:43<00:19,  2.44s/it, CE=7.233555e-01 H=5.250896e-01 dV_dx=2.556445e-05 dV_dθ=-1.982914e-01 ||∇||=1.442352e+01 | Tr=0.8827] 65%|██████▌   | 13/20 [00:43<00:17,  2.45s/it, CE=7.233555e-01 H=5.250896e-01 dV_dx=2.556445e-05 dV_dθ=-1.982914e-01 ||∇||=1.442352e+01 | Tr=0.8827] 65%|██████▌   | 13/20 [00:47<00:17,  2.45s/it, CE=6.965739e-01 H=4.953414e-01 dV_dx=-5.443520e-05 dV_dθ=-2.011781e-01 ||∇||=1.433284e+01 | Tr=0.8827] 70%|███████   | 14/20 [00:47<00:17,  2.94s/it, CE=6.965739e-01 H=4.953414e-01 dV_dx=-5.443520e-05 dV_dθ=-2.011781e-01 ||∇||=1.433284e+01 | Tr=0.8827] 70%|███████   | 14/20 [00:50<00:17,  2.94s/it, CE=6.734176e-01 H=4.385332e-01 dV_dx=2.986066e-05 dV_dθ=-2.349143e-01 ||∇||=1.473887e+01 | Tr=0.8827]  75%|███████▌  | 15/20 [00:50<00:14,  2.96s/it, CE=6.734176e-01 H=4.385332e-01 dV_dx=2.986066e-05 dV_dθ=-2.349143e-01 ||∇||=1.473887e+01 | Tr=0.8827] 75%|███████▌  | 15/20 [00:53<00:14,  2.96s/it, CE=6.572510e-01 H=3.985595e-01 dV_dx=5.660941e-05 dV_dθ=-2.587481e-01 ||∇||=1.581573e+01 | Tr=0.8827] 80%|████████  | 16/20 [00:53<00:11,  2.93s/it, CE=6.572510e-01 H=3.985595e-01 dV_dx=5.660941e-05 dV_dθ=-2.587481e-01 ||∇||=1.581573e+01 | Tr=0.8827] 80%|████████  | 16/20 [00:55<00:11,  2.93s/it, CE=6.322090e-01 H=3.873078e-01 dV_dx=1.313040e-05 dV_dθ=-2.449143e-01 ||∇||=1.560855e+01 | Tr=0.8827] 85%|████████▌ | 17/20 [00:55<00:08,  2.76s/it, CE=6.322090e-01 H=3.873078e-01 dV_dx=1.313040e-05 dV_dθ=-2.449143e-01 ||∇||=1.560855e+01 | Tr=0.8827] 85%|████████▌ | 17/20 [00:58<00:08,  2.76s/it, CE=6.126911e-01 H=4.066499e-01 dV_dx=4.346680e-05 dV_dθ=-2.060847e-01 ||∇||=1.406513e+01 | Tr=0.8827] 90%|█████████ | 18/20 [00:58<00:05,  2.79s/it, CE=6.126911e-01 H=4.066499e-01 dV_dx=4.346680e-05 dV_dθ=-2.060847e-01 ||∇||=1.406513e+01 | Tr=0.8827] 90%|█████████ | 18/20 [01:00<00:05,  2.79s/it, CE=5.999659e-01 H=4.001927e-01 dV_dx=3.897343e-05 dV_dθ=-1.998122e-01 ||∇||=1.421919e+01 | Tr=0.8827] 95%|█████████▌| 19/20 [01:00<00:02,  2.72s/it, CE=5.999659e-01 H=4.001927e-01 dV_dx=3.897343e-05 dV_dθ=-1.998122e-01 ||∇||=1.421919e+01 | Tr=0.8827] 95%|█████████▌| 19/20 [01:05<00:02,  2.72s/it, CE=5.922058e-01 H=3.753189e-01 dV_dx=-1.783560e-05 dV_dθ=-2.168691e-01 ||∇||=1.531002e+01 | Tr=0.8827 Te/Cur=0.9333 Te/Exp=0.7676]100%|██████████| 20/20 [01:11<00:00,  5.10s/it, CE=5.922058e-01 H=3.753189e-01 dV_dx=-1.783560e-05 dV_dθ=-2.168691e-01 ||∇||=1.531002e+01 | Tr=0.8827 Te/Cur=0.9333 Te/Exp=0.7676]100%|██████████| 20/20 [01:11<00:00,  3.58s/it, CE=5.922058e-01 H=3.753189e-01 dV_dx=-1.783560e-05 dV_dθ=-2.168691e-01 ||∇||=1.531002e+01 | Tr=0.8827 Te/Cur=0.9333 Te/Exp=0.7676]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.565622
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:13, 10.17s/it]  5%|▌         | 1/20 [00:12<03:13, 10.17s/it, CE=6.059470e-01 H=5.195342e-01 dV_dx=-7.925260e-06 dV_dθ=-8.640481e-02 ||∇||=1.062501e+01 | Tr=0.8826] 10%|█         | 2/20 [00:12<01:36,  5.34s/it, CE=6.059470e-01 H=5.195342e-01 dV_dx=-7.925260e-06 dV_dθ=-8.640481e-02 ||∇||=1.062501e+01 | Tr=0.8826] 10%|█         | 2/20 [00:14<01:36,  5.34s/it, CE=5.770201e-01 H=5.012251e-01 dV_dx=2.871911e-05 dV_dθ=-7.582367e-02 ||∇||=9.989602e+00 | Tr=0.8826]  15%|█▌        | 3/20 [00:14<01:05,  3.87s/it, CE=5.770201e-01 H=5.012251e-01 dV_dx=2.871911e-05 dV_dθ=-7.582367e-02 ||∇||=9.989602e+00 | Tr=0.8826] 15%|█▌        | 3/20 [00:16<01:05,  3.87s/it, CE=5.562411e-01 H=4.885929e-01 dV_dx=2.313041e-05 dV_dθ=-6.767135e-02 ||∇||=9.462465e+00 | Tr=0.8826] 20%|██        | 4/20 [00:16<00:51,  3.21s/it, CE=5.562411e-01 H=4.885929e-01 dV_dx=2.313041e-05 dV_dθ=-6.767135e-02 ||∇||=9.462465e+00 | Tr=0.8826] 20%|██        | 4/20 [00:18<00:51,  3.21s/it, CE=5.402584e-01 H=4.472300e-01 dV_dx=-1.046310e-05 dV_dθ=-9.301786e-02 ||∇||=1.022053e+01 | Tr=0.8826] 25%|██▌       | 5/20 [00:18<00:43,  2.90s/it, CE=5.402584e-01 H=4.472300e-01 dV_dx=-1.046310e-05 dV_dθ=-9.301786e-02 ||∇||=1.022053e+01 | Tr=0.8826] 25%|██▌       | 5/20 [00:21<00:43,  2.90s/it, CE=5.306485e-01 H=3.974893e-01 dV_dx=-2.824009e-05 dV_dθ=-1.331309e-01 ||∇||=1.198629e+01 | Tr=0.8826] 30%|███       | 6/20 [00:21<00:37,  2.71s/it, CE=5.306485e-01 H=3.974893e-01 dV_dx=-2.824009e-05 dV_dθ=-1.331309e-01 ||∇||=1.198629e+01 | Tr=0.8826] 30%|███       | 6/20 [00:23<00:37,  2.71s/it, CE=5.300553e-01 H=3.309485e-01 dV_dx=-9.676434e-06 dV_dθ=-1.990971e-01 ||∇||=1.425474e+01 | Tr=0.8826] 35%|███▌      | 7/20 [00:23<00:33,  2.59s/it, CE=5.300553e-01 H=3.309485e-01 dV_dx=-9.676434e-06 dV_dθ=-1.990971e-01 ||∇||=1.425474e+01 | Tr=0.8826] 35%|███▌      | 7/20 [00:25<00:33,  2.59s/it, CE=5.243705e-01 H=3.475975e-01 dV_dx=2.778726e-05 dV_dθ=-1.768008e-01 ||∇||=1.425677e+01 | Tr=0.8826]  40%|████      | 8/20 [00:25<00:29,  2.46s/it, CE=5.243705e-01 H=3.475975e-01 dV_dx=2.778726e-05 dV_dθ=-1.768008e-01 ||∇||=1.425677e+01 | Tr=0.8826] 40%|████      | 8/20 [00:28<00:29,  2.46s/it, CE=5.061398e-01 H=4.138442e-01 dV_dx=-2.668328e-05 dV_dθ=-9.226890e-02 ||∇||=1.121389e+01 | Tr=0.8826] 45%|████▌     | 9/20 [00:28<00:26,  2.43s/it, CE=5.061398e-01 H=4.138442e-01 dV_dx=-2.668328e-05 dV_dθ=-9.226890e-02 ||∇||=1.121389e+01 | Tr=0.8826] 45%|████▌     | 9/20 [00:30<00:26,  2.43s/it, CE=4.958758e-01 H=4.149639e-01 dV_dx=5.203027e-06 dV_dθ=-8.091712e-02 ||∇||=1.077133e+01 | Tr=0.8826]  50%|█████     | 10/20 [00:30<00:25,  2.55s/it, CE=4.958758e-01 H=4.149639e-01 dV_dx=5.203027e-06 dV_dθ=-8.091712e-02 ||∇||=1.077133e+01 | Tr=0.8826] 50%|█████     | 10/20 [00:33<00:25,  2.55s/it, CE=4.894078e-01 H=4.122742e-01 dV_dx=4.956472e-06 dV_dθ=-7.713855e-02 ||∇||=1.046693e+01 | Tr=0.8826] 55%|█████▌    | 11/20 [00:33<00:22,  2.48s/it, CE=4.894078e-01 H=4.122742e-01 dV_dx=4.956472e-06 dV_dθ=-7.713855e-02 ||∇||=1.046693e+01 | Tr=0.8826] 55%|█████▌    | 11/20 [00:35<00:22,  2.48s/it, CE=4.766305e-01 H=4.027809e-01 dV_dx=3.493993e-06 dV_dθ=-7.385310e-02 ||∇||=1.013207e+01 | Tr=0.8826] 60%|██████    | 12/20 [00:35<00:18,  2.37s/it, CE=4.766305e-01 H=4.027809e-01 dV_dx=3.493993e-06 dV_dθ=-7.385310e-02 ||∇||=1.013207e+01 | Tr=0.8826] 60%|██████    | 12/20 [00:37<00:18,  2.37s/it, CE=4.541216e-01 H=3.987140e-01 dV_dx=4.343000e-05 dV_dθ=-5.545099e-02 ||∇||=8.830871e+00 | Tr=0.8826] 65%|██████▌   | 13/20 [00:37<00:16,  2.40s/it, CE=4.541216e-01 H=3.987140e-01 dV_dx=4.343000e-05 dV_dθ=-5.545099e-02 ||∇||=8.830871e+00 | Tr=0.8826] 65%|██████▌   | 13/20 [00:41<00:16,  2.40s/it, CE=4.407063e-01 H=3.919634e-01 dV_dx=9.899459e-06 dV_dθ=-4.875284e-02 ||∇||=8.491938e+00 | Tr=0.8826] 70%|███████   | 14/20 [00:41<00:16,  2.80s/it, CE=4.407063e-01 H=3.919634e-01 dV_dx=9.899459e-06 dV_dθ=-4.875284e-02 ||∇||=8.491938e+00 | Tr=0.8826] 70%|███████   | 14/20 [00:43<00:16,  2.80s/it, CE=4.315127e-01 H=3.791610e-01 dV_dx=1.385052e-05 dV_dθ=-5.236556e-02 ||∇||=8.757549e+00 | Tr=0.8826] 75%|███████▌  | 15/20 [00:43<00:12,  2.57s/it, CE=4.315127e-01 H=3.791610e-01 dV_dx=1.385052e-05 dV_dθ=-5.236556e-02 ||∇||=8.757549e+00 | Tr=0.8826] 75%|███████▌  | 15/20 [00:45<00:12,  2.57s/it, CE=4.227451e-01 H=3.745161e-01 dV_dx=3.553181e-05 dV_dθ=-4.826459e-02 ||∇||=8.567207e+00 | Tr=0.8826] 80%|████████  | 16/20 [00:45<00:10,  2.54s/it, CE=4.227451e-01 H=3.745161e-01 dV_dx=3.553181e-05 dV_dθ=-4.826459e-02 ||∇||=8.567207e+00 | Tr=0.8826] 80%|████████  | 16/20 [00:48<00:10,  2.54s/it, CE=4.158394e-01 H=3.692109e-01 dV_dx=3.151217e-05 dV_dθ=-4.666005e-02 ||∇||=8.412464e+00 | Tr=0.8826] 85%|████████▌ | 17/20 [00:48<00:08,  2.68s/it, CE=4.158394e-01 H=3.692109e-01 dV_dx=3.151217e-05 dV_dθ=-4.666005e-02 ||∇||=8.412464e+00 | Tr=0.8826] 85%|████████▌ | 17/20 [00:51<00:08,  2.68s/it, CE=4.124775e-01 H=3.555856e-01 dV_dx=-3.638414e-06 dV_dθ=-5.688827e-02 ||∇||=8.926166e+00 | Tr=0.8826] 90%|█████████ | 18/20 [00:51<00:05,  2.62s/it, CE=4.124775e-01 H=3.555856e-01 dV_dx=-3.638414e-06 dV_dθ=-5.688827e-02 ||∇||=8.926166e+00 | Tr=0.8826] 90%|█████████ | 18/20 [00:54<00:05,  2.62s/it, CE=4.040242e-01 H=3.511122e-01 dV_dx=5.799729e-05 dV_dθ=-5.296997e-02 ||∇||=8.628641e+00 | Tr=0.8826]  95%|█████████▌| 19/20 [00:54<00:02,  2.61s/it, CE=4.040242e-01 H=3.511122e-01 dV_dx=5.799729e-05 dV_dθ=-5.296997e-02 ||∇||=8.628641e+00 | Tr=0.8826] 95%|█████████▌| 19/20 [00:58<00:02,  2.61s/it, CE=4.016145e-01 H=3.362382e-01 dV_dx=-4.931417e-05 dV_dθ=-6.532702e-02 ||∇||=9.339996e+00 | Tr=0.8826 Te/Cur=0.9547 Te/Exp=0.8144]100%|██████████| 20/20 [01:02<00:00,  4.31s/it, CE=4.016145e-01 H=3.362382e-01 dV_dx=-4.931417e-05 dV_dθ=-6.532702e-02 ||∇||=9.339996e+00 | Tr=0.8826 Te/Cur=0.9547 Te/Exp=0.8144]100%|██████████| 20/20 [01:02<00:00,  3.12s/it, CE=4.016145e-01 H=3.362382e-01 dV_dx=-4.931417e-05 dV_dθ=-6.532702e-02 ||∇||=9.339996e+00 | Tr=0.8826 Te/Cur=0.9547 Te/Exp=0.8144]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.41s/it] 50%|█████     | 1/2 [00:12<00:09,  9.41s/it, CE=4.555240e-01 H=4.529625e-01 dV_dx=2.638837e-05 dV_dθ=-2.587884e-03 ||∇||=2.338692e+00 | Tr=0.9768 Te/Cur=0.9609 Te/Exp=0.8344]100%|██████████| 2/2 [00:12<00:00,  5.71s/it, CE=4.555240e-01 H=4.529625e-01 dV_dx=2.638837e-05 dV_dθ=-2.587884e-03 ||∇||=2.338692e+00 | Tr=0.9768 Te/Cur=0.9609 Te/Exp=0.8344]100%|██████████| 2/2 [00:12<00:00,  6.26s/it, CE=4.555240e-01 H=4.529625e-01 dV_dx=2.638837e-05 dV_dθ=-2.587884e-03 ||∇||=2.338692e+00 | Tr=0.9768 Te/Cur=0.9609 Te/Exp=0.8344]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:07<02:16,  7.17s/it]  5%|▌         | 1/20 [00:08<02:16,  7.17s/it, CE=4.410469e-01 H=4.375708e-01 dV_dx=4.260812e-06 dV_dθ=-3.480395e-03 ||∇||=2.349007e+00 | Tr=0.9789] 10%|█         | 2/20 [00:08<01:08,  3.82s/it, CE=4.410469e-01 H=4.375708e-01 dV_dx=4.260812e-06 dV_dθ=-3.480395e-03 ||∇||=2.349007e+00 | Tr=0.9789] 10%|█         | 2/20 [00:09<01:08,  3.82s/it, CE=4.250806e-01 H=4.217323e-01 dV_dx=-8.240673e-05 dV_dθ=-3.265847e-03 ||∇||=2.277740e+00 | Tr=0.9800] 15%|█▌        | 3/20 [00:09<00:44,  2.60s/it, CE=4.250806e-01 H=4.217323e-01 dV_dx=-8.240673e-05 dV_dθ=-3.265847e-03 ||∇||=2.277740e+00 | Tr=0.9800] 15%|█▌        | 3/20 [00:10<00:44,  2.60s/it, CE=4.117952e-01 H=4.088068e-01 dV_dx=-6.833271e-05 dV_dθ=-2.920066e-03 ||∇||=2.190748e+00 | Tr=0.9805] 20%|██        | 4/20 [00:10<00:32,  2.00s/it, CE=4.117952e-01 H=4.088068e-01 dV_dx=-6.833271e-05 dV_dθ=-2.920066e-03 ||∇||=2.190748e+00 | Tr=0.9805] 20%|██        | 4/20 [00:12<00:32,  2.00s/it, CE=4.007386e-01 H=3.979241e-01 dV_dx=-8.177906e-05 dV_dθ=-2.732737e-03 ||∇||=2.137722e+00 | Tr=0.9811] 25%|██▌       | 5/20 [00:12<00:25,  1.70s/it, CE=4.007386e-01 H=3.979241e-01 dV_dx=-8.177906e-05 dV_dθ=-2.732737e-03 ||∇||=2.137722e+00 | Tr=0.9811] 25%|██▌       | 5/20 [00:14<00:25,  1.70s/it, CE=3.906129e-01 H=3.879083e-01 dV_dx=-1.962272e-04 dV_dθ=-2.508387e-03 ||∇||=2.085544e+00 | Tr=0.9820 Te/Cur=0.9655 Te/Exp=0.8395] 30%|███       | 6/20 [00:14<00:26,  1.88s/it, CE=3.906129e-01 H=3.879083e-01 dV_dx=-1.962272e-04 dV_dθ=-2.508387e-03 ||∇||=2.085544e+00 | Tr=0.9820 Te/Cur=0.9655 Te/Exp=0.8395] 30%|███       | 6/20 [00:15<00:26,  1.88s/it, CE=3.814618e-01 H=3.788201e-01 dV_dx=-1.410234e-04 dV_dθ=-2.500629e-03 ||∇||=2.062305e+00 | Tr=0.9825]                             35%|███▌      | 7/20 [00:15<00:21,  1.69s/it, CE=3.814618e-01 H=3.788201e-01 dV_dx=-1.410234e-04 dV_dθ=-2.500629e-03 ||∇||=2.062305e+00 | Tr=0.9825] 35%|███▌      | 7/20 [00:17<00:21,  1.69s/it, CE=3.731891e-01 H=3.706036e-01 dV_dx=-6.868307e-05 dV_dθ=-2.516824e-03 ||∇||=2.045801e+00 | Tr=0.9831] 40%|████      | 8/20 [00:17<00:19,  1.64s/it, CE=3.731891e-01 H=3.706036e-01 dV_dx=-6.868307e-05 dV_dθ=-2.516824e-03 ||∇||=2.045801e+00 | Tr=0.9831] 40%|████      | 8/20 [00:18<00:19,  1.64s/it, CE=3.656309e-01 H=3.631784e-01 dV_dx=1.249292e-04 dV_dθ=-2.577459e-03 ||∇||=2.041224e+00 | Tr=0.9836]  45%|████▌     | 9/20 [00:18<00:16,  1.47s/it, CE=3.656309e-01 H=3.631784e-01 dV_dx=1.249292e-04 dV_dθ=-2.577459e-03 ||∇||=2.041224e+00 | Tr=0.9836] 45%|████▌     | 9/20 [00:19<00:16,  1.47s/it, CE=3.587711e-01 H=3.561590e-01 dV_dx=1.133113e-04 dV_dθ=-2.725377e-03 ||∇||=2.051910e+00 | Tr=0.9840] 50%|█████     | 10/20 [00:19<00:13,  1.37s/it, CE=3.587711e-01 H=3.561590e-01 dV_dx=1.133113e-04 dV_dθ=-2.725377e-03 ||∇||=2.051910e+00 | Tr=0.9840] 50%|█████     | 10/20 [00:21<00:13,  1.37s/it, CE=3.521077e-01 H=3.494813e-01 dV_dx=2.145525e-05 dV_dθ=-2.647797e-03 ||∇||=2.023478e+00 | Tr=0.9845 Te/Cur=0.9673 Te/Exp=0.8426] 55%|█████▌    | 11/20 [00:21<00:13,  1.53s/it, CE=3.521077e-01 H=3.494813e-01 dV_dx=2.145525e-05 dV_dθ=-2.647797e-03 ||∇||=2.023478e+00 | Tr=0.9845 Te/Cur=0.9673 Te/Exp=0.8426] 55%|█████▌    | 11/20 [00:22<00:13,  1.53s/it, CE=3.458591e-01 H=3.431079e-01 dV_dx=-3.859076e-05 dV_dθ=-2.712623e-03 ||∇||=2.027283e+00 | Tr=0.9847]                            60%|██████    | 12/20 [00:22<00:11,  1.44s/it, CE=3.458591e-01 H=3.431079e-01 dV_dx=-3.859076e-05 dV_dθ=-2.712623e-03 ||∇||=2.027283e+00 | Tr=0.9847] 60%|██████    | 12/20 [00:23<00:11,  1.44s/it, CE=3.398647e-01 H=3.372228e-01 dV_dx=1.340627e-04 dV_dθ=-2.775958e-03 ||∇||=2.022327e+00 | Tr=0.9854]  65%|██████▌   | 13/20 [00:23<00:09,  1.40s/it, CE=3.398647e-01 H=3.372228e-01 dV_dx=1.340627e-04 dV_dθ=-2.775958e-03 ||∇||=2.022327e+00 | Tr=0.9854] 65%|██████▌   | 13/20 [00:25<00:09,  1.40s/it, CE=3.341542e-01 H=3.314625e-01 dV_dx=1.639381e-04 dV_dθ=-2.855649e-03 ||∇||=2.009075e+00 | Tr=0.9858] 70%|███████   | 14/20 [00:25<00:08,  1.35s/it, CE=3.341542e-01 H=3.314625e-01 dV_dx=1.639381e-04 dV_dθ=-2.855649e-03 ||∇||=2.009075e+00 | Tr=0.9858] 70%|███████   | 14/20 [00:26<00:08,  1.35s/it, CE=3.289895e-01 H=3.260390e-01 dV_dx=1.599355e-05 dV_dθ=-2.966481e-03 ||∇||=2.013097e+00 | Tr=0.9862] 75%|███████▌  | 15/20 [00:26<00:06,  1.32s/it, CE=3.289895e-01 H=3.260390e-01 dV_dx=1.599355e-05 dV_dθ=-2.966481e-03 ||∇||=2.013097e+00 | Tr=0.9862] 75%|███████▌  | 15/20 [00:28<00:06,  1.32s/it, CE=3.239915e-01 H=3.209510e-01 dV_dx=-1.087797e-04 dV_dθ=-2.931801e-03 ||∇||=1.993308e+00 | Tr=0.9865 Te/Cur=0.9682 Te/Exp=0.8479] 80%|████████  | 16/20 [00:28<00:06,  1.52s/it, CE=3.239915e-01 H=3.209510e-01 dV_dx=-1.087797e-04 dV_dθ=-2.931801e-03 ||∇||=1.993308e+00 | Tr=0.9865 Te/Cur=0.9682 Te/Exp=0.8479] 80%|████████  | 16/20 [00:29<00:06,  1.52s/it, CE=3.189698e-01 H=3.161576e-01 dV_dx=2.344086e-05 dV_dθ=-2.835637e-03 ||∇||=1.965807e+00 | Tr=0.9867]                              85%|████████▌ | 17/20 [00:29<00:04,  1.45s/it, CE=3.189698e-01 H=3.161576e-01 dV_dx=2.344086e-05 dV_dθ=-2.835637e-03 ||∇||=1.965807e+00 | Tr=0.9867] 85%|████████▌ | 17/20 [00:30<00:04,  1.45s/it, CE=3.144571e-01 H=3.116431e-01 dV_dx=4.019932e-05 dV_dθ=-2.854167e-03 ||∇||=1.955136e+00 | Tr=0.9871] 90%|█████████ | 18/20 [00:30<00:02,  1.31s/it, CE=3.144571e-01 H=3.116431e-01 dV_dx=4.019932e-05 dV_dθ=-2.854167e-03 ||∇||=1.955136e+00 | Tr=0.9871] 90%|█████████ | 18/20 [00:31<00:02,  1.31s/it, CE=3.102344e-01 H=3.073337e-01 dV_dx=4.385290e-05 dV_dθ=-2.944501e-03 ||∇||=1.953901e+00 | Tr=0.9873] 95%|█████████▌| 19/20 [00:31<00:01,  1.28s/it, CE=3.102344e-01 H=3.073337e-01 dV_dx=4.385290e-05 dV_dθ=-2.944501e-03 ||∇||=1.953901e+00 | Tr=0.9873] 95%|█████████▌| 19/20 [00:33<00:01,  1.28s/it, CE=3.060343e-01 H=3.031240e-01 dV_dx=8.065233e-06 dV_dθ=-2.918373e-03 ||∇||=1.942337e+00 | Tr=0.9875 Te/Cur=0.9708 Te/Exp=0.8521]100%|██████████| 20/20 [00:33<00:00,  1.47s/it, CE=3.060343e-01 H=3.031240e-01 dV_dx=8.065233e-06 dV_dθ=-2.918373e-03 ||∇||=1.942337e+00 | Tr=0.9875 Te/Cur=0.9708 Te/Exp=0.8521]100%|██████████| 20/20 [00:33<00:00,  1.68s/it, CE=3.060343e-01 H=3.031240e-01 dV_dx=8.065233e-06 dV_dθ=-2.918373e-03 ||∇||=1.942337e+00 | Tr=0.9875 Te/Cur=0.9708 Te/Exp=0.8521]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 9 final loss: 0.315013
======================================================================


  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7483
    Task 1: 0.9263
    Task 2: 0.8162
    Task 3: 0.5862
    Task 4: 0.9187
    Task 5: 0.9088
    Task 6: 0.9201
    Task 7: 0.9100
    Task 8: 0.9102
    Task 9: 0.9698

======================================================================
ARCHITECTURE EVOLUTION SUMMARY
======================================================================

Task 0:
  Original:       None
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 512, 64, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        False
  Reason:         baseline_task
  Optimal Loss:   0.820984

Task 1:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 512, 64, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [432, 552, 84, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.961810
  Optimal Loss:   0.590443

Task 2:
  Original:       {'model_type': 'CNN', 'feed_sizes': [432, 552, 84, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [432, 552, 84, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Changed:        False
  Reason:         loss_ratio_below_threshold
  Prelim Loss:    0.519786
  Optimal Loss:   0.354010

Task 3:
  Original:       {'model_type': 'CNN', 'feed_sizes': [432, 552, 84, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 572, 104, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.542207
  Optimal Loss:   0.309605

Task 4:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 572, 104, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 612, 144, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.539038
  Optimal Loss:   0.484173

Task 5:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 612, 144, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 552, 204, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.576028
  Optimal Loss:   0.494376

Task 6:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 552, 204, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 512, 204, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.589739
  Optimal Loss:   0.478823

Task 7:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 512, 204, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 552, 204, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.629331
  Optimal Loss:   0.365068

Task 8:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 552, 204, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 592, 244, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.614790
  Optimal Loss:   0.360289

Task 9:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 592, 244, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 592, 304, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.451437
  Optimal Loss:   0.306034

======================================================================
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run0/mnist_condition4_awb_full_run0_run0/classification_mnist_cnn_awb_run0_records.pkl

Training complete!
