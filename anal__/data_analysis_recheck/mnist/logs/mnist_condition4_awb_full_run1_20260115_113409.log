JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition4_awb_full.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: True

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run1
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run1/mnist_condition4_awb_full_run1


############################################################
# Run ID: 1
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:18<05:56, 18.78s/it]  5%|▌         | 1/20 [00:23<05:56, 18.78s/it, CE=2.066192e+00 H=2.065768e+00 dV_dx=-4.471038e-07 dV_dθ=-4.236129e-04 ||∇||=4.518829e-01 | Tr=0.4036] 10%|█         | 2/20 [00:23<03:09, 10.50s/it, CE=2.066192e+00 H=2.065768e+00 dV_dx=-4.471038e-07 dV_dθ=-4.236129e-04 ||∇||=4.518829e-01 | Tr=0.4036] 10%|█         | 2/20 [00:28<03:09, 10.50s/it, CE=1.848490e+00 H=1.847673e+00 dV_dx=6.225985e-07 dV_dθ=-8.176322e-04 ||∇||=6.245805e-01 | Tr=0.4888]  15%|█▌        | 3/20 [00:28<02:17,  8.11s/it, CE=1.848490e+00 H=1.847673e+00 dV_dx=6.225985e-07 dV_dθ=-8.176322e-04 ||∇||=6.245805e-01 | Tr=0.4888] 15%|█▌        | 3/20 [00:34<02:17,  8.11s/it, CE=1.636056e+00 H=1.635015e+00 dV_dx=-7.754806e-08 dV_dθ=-1.040351e-03 ||∇||=7.085171e-01 | Tr=0.5293] 20%|██        | 4/20 [00:34<01:52,  7.06s/it, CE=1.636056e+00 H=1.635015e+00 dV_dx=-7.754806e-08 dV_dθ=-1.040351e-03 ||∇||=7.085171e-01 | Tr=0.5293] 20%|██        | 4/20 [00:39<01:52,  7.06s/it, CE=1.462554e+00 H=1.461561e+00 dV_dx=-5.563062e-07 dV_dθ=-9.923757e-04 ||∇||=7.014357e-01 | Tr=0.5582] 25%|██▌       | 5/20 [00:39<01:34,  6.29s/it, CE=1.462554e+00 H=1.461561e+00 dV_dx=-5.563062e-07 dV_dθ=-9.923757e-04 ||∇||=7.014357e-01 | Tr=0.5582] 25%|██▌       | 5/20 [00:47<01:34,  6.29s/it, CE=1.332743e+00 H=1.331898e+00 dV_dx=-6.639108e-08 dV_dθ=-8.447258e-04 ||∇||=6.598306e-01 | Tr=0.5840 Te/Cur=0.5914 Te/Exp=0.5913] 30%|███       | 6/20 [00:47<01:37,  6.97s/it, CE=1.332743e+00 H=1.331898e+00 dV_dx=-6.639108e-08 dV_dθ=-8.447258e-04 ||∇||=6.598306e-01 | Tr=0.5840 Te/Cur=0.5914 Te/Exp=0.5913] 30%|███       | 6/20 [00:52<01:37,  6.97s/it, CE=1.236607e+00 H=1.235893e+00 dV_dx=2.440522e-08 dV_dθ=-7.133253e-04 ||∇||=6.201662e-01 | Tr=0.6056]                              35%|███▌      | 7/20 [00:52<01:22,  6.34s/it, CE=1.236607e+00 H=1.235893e+00 dV_dx=2.440522e-08 dV_dθ=-7.133253e-04 ||∇||=6.201662e-01 | Tr=0.6056] 35%|███▌      | 7/20 [00:57<01:22,  6.34s/it, CE=1.163230e+00 H=1.162621e+00 dV_dx=-7.408943e-08 dV_dθ=-6.091907e-04 ||∇||=5.872566e-01 | Tr=0.6250] 40%|████      | 8/20 [00:57<01:10,  5.90s/it, CE=1.163230e+00 H=1.162621e+00 dV_dx=-7.408943e-08 dV_dθ=-6.091907e-04 ||∇||=5.872566e-01 | Tr=0.6250] 40%|████      | 8/20 [01:02<01:10,  5.90s/it, CE=1.104967e+00 H=1.104427e+00 dV_dx=8.455303e-07 dV_dθ=-5.409415e-04 ||∇||=5.655534e-01 | Tr=0.6419]  45%|████▌     | 9/20 [01:02<01:00,  5.54s/it, CE=1.104967e+00 H=1.104427e+00 dV_dx=8.455303e-07 dV_dθ=-5.409415e-04 ||∇||=5.655534e-01 | Tr=0.6419] 45%|████▌     | 9/20 [01:06<01:00,  5.54s/it, CE=1.057770e+00 H=1.057272e+00 dV_dx=-3.386541e-07 dV_dθ=-4.976977e-04 ||∇||=5.526006e-01 | Tr=0.6555] 50%|█████     | 10/20 [01:06<00:51,  5.19s/it, CE=1.057770e+00 H=1.057272e+00 dV_dx=-3.386541e-07 dV_dθ=-4.976977e-04 ||∇||=5.526006e-01 | Tr=0.6555] 50%|█████     | 10/20 [01:13<00:51,  5.19s/it, CE=1.017904e+00 H=1.017443e+00 dV_dx=-4.313006e-07 dV_dθ=-4.612469e-04 ||∇||=5.410948e-01 | Tr=0.6669 Te/Cur=0.6678 Te/Exp=0.6687] 55%|█████▌    | 11/20 [01:13<00:51,  5.70s/it, CE=1.017904e+00 H=1.017443e+00 dV_dx=-4.313006e-07 dV_dθ=-4.612469e-04 ||∇||=5.410948e-01 | Tr=0.6669 Te/Cur=0.6678 Te/Exp=0.6687] 55%|█████▌    | 11/20 [01:18<00:51,  5.70s/it, CE=9.836194e-01 H=9.831829e-01 dV_dx=1.104975e-06 dV_dθ=-4.375787e-04 ||∇||=5.351828e-01 | Tr=0.6765]                              60%|██████    | 12/20 [01:18<00:43,  5.45s/it, CE=9.836194e-01 H=9.831829e-01 dV_dx=1.104975e-06 dV_dθ=-4.375787e-04 ||∇||=5.351828e-01 | Tr=0.6765] 60%|██████    | 12/20 [01:23<00:43,  5.45s/it, CE=9.544866e-01 H=9.540590e-01 dV_dx=-1.589205e-06 dV_dθ=-4.259261e-04 ||∇||=5.319755e-01 | Tr=0.6866] 65%|██████▌   | 13/20 [01:23<00:36,  5.25s/it, CE=9.544866e-01 H=9.540590e-01 dV_dx=-1.589205e-06 dV_dθ=-4.259261e-04 ||∇||=5.319755e-01 | Tr=0.6866] 65%|██████▌   | 13/20 [01:28<00:36,  5.25s/it, CE=9.289839e-01 H=9.285627e-01 dV_dx=-2.364518e-06 dV_dθ=-4.188328e-04 ||∇||=5.307289e-01 | Tr=0.6951] 70%|███████   | 14/20 [01:28<00:31,  5.21s/it, CE=9.289839e-01 H=9.285627e-01 dV_dx=-2.364518e-06 dV_dθ=-4.188328e-04 ||∇||=5.307289e-01 | Tr=0.6951] 70%|███████   | 14/20 [01:33<00:31,  5.21s/it, CE=9.061236e-01 H=9.057131e-01 dV_dx=-1.419841e-06 dV_dθ=-4.091097e-04 ||∇||=5.287200e-01 | Tr=0.7016] 75%|███████▌  | 15/20 [01:33<00:26,  5.21s/it, CE=9.061236e-01 H=9.057131e-01 dV_dx=-1.419841e-06 dV_dθ=-4.091097e-04 ||∇||=5.287200e-01 | Tr=0.7016] 75%|███████▌  | 15/20 [01:39<00:26,  5.21s/it, CE=8.855795e-01 H=8.851789e-01 dV_dx=-1.020584e-06 dV_dθ=-3.996031e-04 ||∇||=5.268049e-01 | Tr=0.7068 Te/Cur=0.7067 Te/Exp=0.7080] 80%|████████  | 16/20 [01:39<00:22,  5.54s/it, CE=8.855795e-01 H=8.851789e-01 dV_dx=-1.020584e-06 dV_dθ=-3.996031e-04 ||∇||=5.268049e-01 | Tr=0.7068 Te/Cur=0.7067 Te/Exp=0.7080] 80%|████████  | 16/20 [01:44<00:22,  5.54s/it, CE=8.671306e-01 H=8.667386e-01 dV_dx=9.954258e-07 dV_dθ=-3.930268e-04 ||∇||=5.258969e-01 | Tr=0.7130]                              85%|████████▌ | 17/20 [01:44<00:16,  5.39s/it, CE=8.671306e-01 H=8.667386e-01 dV_dx=9.954258e-07 dV_dθ=-3.930268e-04 ||∇||=5.258969e-01 | Tr=0.7130] 85%|████████▌ | 17/20 [01:49<00:16,  5.39s/it, CE=8.503076e-01 H=8.499242e-01 dV_dx=2.725554e-06 dV_dθ=-3.861881e-04 ||∇||=5.250843e-01 | Tr=0.7185] 90%|█████████ | 18/20 [01:49<00:10,  5.27s/it, CE=8.503076e-01 H=8.499242e-01 dV_dx=2.725554e-06 dV_dθ=-3.861881e-04 ||∇||=5.250843e-01 | Tr=0.7185] 90%|█████████ | 18/20 [01:54<00:10,  5.27s/it, CE=8.347809e-01 H=8.343972e-01 dV_dx=6.877203e-07 dV_dθ=-3.844061e-04 ||∇||=5.261406e-01 | Tr=0.7234] 95%|█████████▌| 19/20 [01:54<00:05,  5.13s/it, CE=8.347809e-01 H=8.343972e-01 dV_dx=6.877203e-07 dV_dθ=-3.844061e-04 ||∇||=5.261406e-01 | Tr=0.7234] 95%|█████████▌| 19/20 [02:01<00:05,  5.13s/it, CE=8.203674e-01 H=8.199872e-01 dV_dx=-9.877015e-08 dV_dθ=-3.801311e-04 ||∇||=5.261210e-01 | Tr=0.7283 Te/Cur=0.7243 Te/Exp=0.7242]100%|██████████| 20/20 [02:01<00:00,  5.53s/it, CE=8.203674e-01 H=8.199872e-01 dV_dx=-9.877015e-08 dV_dθ=-3.801311e-04 ||∇||=5.261210e-01 | Tr=0.7283 Te/Cur=0.7243 Te/Exp=0.7242]100%|██████████| 20/20 [02:01<00:00,  6.05s/it, CE=8.203674e-01 H=8.199872e-01 dV_dx=-9.877015e-08 dV_dθ=-3.801311e-04 ||∇||=5.261210e-01 | Tr=0.7283 Te/Cur=0.7243 Te/Exp=0.7242]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7268

============================================================
Task 1
============================================================
Initial loss on new task: 6.1990, previous: 0.8204, ratio: 7.56
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 1
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:11<?, ?it/s, CE=9.498541e-01 H=9.513613e-01 dV_dx=-2.459950e-05 dV_dθ=1.531727e-03 ||∇||=2.290369e+00 | Tr=0.5103 Te/Cur=0.7279 Te/Exp=0.7219]100%|██████████| 1/1 [00:11<00:00, 11.05s/it, CE=9.498541e-01 H=9.513613e-01 dV_dx=-2.459950e-05 dV_dθ=1.531727e-03 ||∇||=2.290369e+00 | Tr=0.5103 Te/Cur=0.7279 Te/Exp=0.7219]100%|██████████| 1/1 [00:11<00:00, 11.05s/it, CE=9.498541e-01 H=9.513613e-01 dV_dx=-2.459950e-05 dV_dθ=1.531727e-03 ||∇||=2.290369e+00 | Tr=0.5103 Te/Cur=0.7279 Te/Exp=0.7219]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.949854

[STEP 2] Architecture change decision
  Current: 0.949854, Previous: 0.820367
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9418 samples from 10 classes
  Created balanced validation set: 9417 samples from 10 classes
  Starting grid architecture search for task 1
  Baseline architecture: (3, [507, 512, 64, 10])
  Baseline loss: 0.949854
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.70s/it] 50%|█████     | 1/2 [00:19<00:15, 15.70s/it, CE=2.318231e+00 H=2.318136e+00 dV_dx=-7.918888e-07 dV_dθ=-9.424087e-05 ||∇||=3.252046e-01 | Tr=0.0866 Te/Cur=0.0939 Te/Exp=0.1302]100%|██████████| 2/2 [00:19<00:00,  8.46s/it, CE=2.318231e+00 H=2.318136e+00 dV_dx=-7.918888e-07 dV_dθ=-9.424087e-05 ||∇||=3.252046e-01 | Tr=0.0866 Te/Cur=0.0939 Te/Exp=0.1302]100%|██████████| 2/2 [00:19<00:00,  9.55s/it, CE=2.318231e+00 H=2.318136e+00 dV_dx=-7.918888e-07 dV_dθ=-9.424087e-05 ||∇||=3.252046e-01 | Tr=0.0866 Te/Cur=0.0939 Te/Exp=0.1302]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.318231329838903
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.77s/it] 50%|█████     | 1/2 [00:15<00:12, 12.77s/it, CE=2.316674e+00 H=2.316587e+00 dV_dx=-3.422684e-06 dV_dθ=-8.343658e-05 ||∇||=3.256021e-01 | Tr=0.1186 Te/Cur=0.1219 Te/Exp=0.1759]100%|██████████| 2/2 [00:15<00:00,  6.67s/it, CE=2.316674e+00 H=2.316587e+00 dV_dx=-3.422684e-06 dV_dθ=-8.343658e-05 ||∇||=3.256021e-01 | Tr=0.1186 Te/Cur=0.1219 Te/Exp=0.1759]100%|██████████| 2/2 [00:15<00:00,  7.59s/it, CE=2.316674e+00 H=2.316587e+00 dV_dx=-3.422684e-06 dV_dθ=-8.343658e-05 ||∇||=3.256021e-01 | Tr=0.1186 Te/Cur=0.1219 Te/Exp=0.1759]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 44, 10]) with loss 2.316674
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.43s/it] 50%|█████     | 1/2 [00:15<00:12, 12.43s/it, CE=2.328664e+00 H=2.328563e+00 dV_dx=-2.198364e-05 dV_dθ=-7.932560e-05 ||∇||=3.211548e-01 | Tr=0.1228 Te/Cur=0.1225 Te/Exp=0.1203]100%|██████████| 2/2 [00:15<00:00,  6.92s/it, CE=2.328664e+00 H=2.328563e+00 dV_dx=-2.198364e-05 dV_dθ=-7.932560e-05 ||∇||=3.211548e-01 | Tr=0.1228 Te/Cur=0.1225 Te/Exp=0.1203]100%|██████████| 2/2 [00:15<00:00,  7.75s/it, CE=2.328664e+00 H=2.328563e+00 dV_dx=-2.198364e-05 dV_dθ=-7.932560e-05 ||∇||=3.211548e-01 | Tr=0.1228 Te/Cur=0.1225 Te/Exp=0.1203]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.67s/it] 50%|█████     | 1/2 [00:14<00:12, 12.67s/it, CE=2.325967e+00 H=2.325889e+00 dV_dx=1.033928e-05 dV_dθ=-8.844779e-05 ||∇||=3.286928e-01 | Tr=0.1126 Te/Cur=0.1100 Te/Exp=0.0977]100%|██████████| 2/2 [00:14<00:00,  6.59s/it, CE=2.325967e+00 H=2.325889e+00 dV_dx=1.033928e-05 dV_dθ=-8.844779e-05 ||∇||=3.286928e-01 | Tr=0.1126 Te/Cur=0.1100 Te/Exp=0.0977]100%|██████████| 2/2 [00:14<00:00,  7.50s/it, CE=2.325967e+00 H=2.325889e+00 dV_dx=1.033928e-05 dV_dθ=-8.844779e-05 ||∇||=3.286928e-01 | Tr=0.1126 Te/Cur=0.1100 Te/Exp=0.0977]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.45s/it] 50%|█████     | 1/2 [00:15<00:12, 12.45s/it, CE=2.314053e+00 H=2.313930e+00 dV_dx=-9.843991e-06 dV_dθ=-1.130549e-04 ||∇||=3.796551e-01 | Tr=0.0978 Te/Cur=0.0997 Te/Exp=0.1021]100%|██████████| 2/2 [00:15<00:00,  6.80s/it, CE=2.314053e+00 H=2.313930e+00 dV_dx=-9.843991e-06 dV_dθ=-1.130549e-04 ||∇||=3.796551e-01 | Tr=0.0978 Te/Cur=0.0997 Te/Exp=0.1021]100%|██████████| 2/2 [00:15<00:00,  7.64s/it, CE=2.314053e+00 H=2.313930e+00 dV_dx=-9.843991e-06 dV_dθ=-1.130549e-04 ||∇||=3.796551e-01 | Tr=0.0978 Te/Cur=0.0997 Te/Exp=0.1021]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 64, 10]) with loss 2.314053
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.43s/it] 50%|█████     | 1/2 [00:15<00:12, 12.43s/it, CE=2.330670e+00 H=2.330516e+00 dV_dx=-1.116361e-05 dV_dθ=-1.433970e-04 ||∇||=3.840345e-01 | Tr=0.1729 Te/Cur=0.1609 Te/Exp=0.1365]100%|██████████| 2/2 [00:15<00:00,  6.80s/it, CE=2.330670e+00 H=2.330516e+00 dV_dx=-1.116361e-05 dV_dθ=-1.433970e-04 ||∇||=3.840345e-01 | Tr=0.1729 Te/Cur=0.1609 Te/Exp=0.1365]100%|██████████| 2/2 [00:15<00:00,  7.65s/it, CE=2.330670e+00 H=2.330516e+00 dV_dx=-1.116361e-05 dV_dθ=-1.433970e-04 ||∇||=3.840345e-01 | Tr=0.1729 Te/Cur=0.1609 Te/Exp=0.1365]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.46s/it] 50%|█████     | 1/2 [00:15<00:13, 13.46s/it, CE=2.295306e+00 H=2.295167e+00 dV_dx=-1.439496e-05 dV_dθ=-1.244440e-04 ||∇||=3.687180e-01 | Tr=0.1156 Te/Cur=0.1384 Te/Exp=0.1878]100%|██████████| 2/2 [00:15<00:00,  7.02s/it, CE=2.295306e+00 H=2.295167e+00 dV_dx=-1.439496e-05 dV_dθ=-1.244440e-04 ||∇||=3.687180e-01 | Tr=0.1156 Te/Cur=0.1384 Te/Exp=0.1878]100%|██████████| 2/2 [00:15<00:00,  7.99s/it, CE=2.295306e+00 H=2.295167e+00 dV_dx=-1.439496e-05 dV_dθ=-1.244440e-04 ||∇||=3.687180e-01 | Tr=0.1156 Te/Cur=0.1384 Te/Exp=0.1878]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 492, 84, 10]) with loss 2.295306
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.64s/it] 50%|█████     | 1/2 [00:15<00:12, 12.64s/it, CE=2.287389e+00 H=2.287281e+00 dV_dx=-7.317814e-06 dV_dθ=-1.008215e-04 ||∇||=3.522147e-01 | Tr=0.1411 Te/Cur=0.1877 Te/Exp=0.2400]100%|██████████| 2/2 [00:15<00:00,  6.86s/it, CE=2.287389e+00 H=2.287281e+00 dV_dx=-7.317814e-06 dV_dθ=-1.008215e-04 ||∇||=3.522147e-01 | Tr=0.1411 Te/Cur=0.1877 Te/Exp=0.2400]100%|██████████| 2/2 [00:15<00:00,  7.73s/it, CE=2.287389e+00 H=2.287281e+00 dV_dx=-7.317814e-06 dV_dθ=-1.008215e-04 ||∇||=3.522147e-01 | Tr=0.1411 Te/Cur=0.1877 Te/Exp=0.2400]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 84, 10]) with loss 2.287389
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.54s/it] 50%|█████     | 1/2 [00:16<00:13, 13.54s/it, CE=2.293948e+00 H=2.293817e+00 dV_dx=-1.498423e-05 dV_dθ=-1.167553e-04 ||∇||=3.707517e-01 | Tr=0.1123 Te/Cur=0.1301 Te/Exp=0.1260]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.293948e+00 H=2.293817e+00 dV_dx=-1.498423e-05 dV_dθ=-1.167553e-04 ||∇||=3.707517e-01 | Tr=0.1123 Te/Cur=0.1301 Te/Exp=0.1260]100%|██████████| 2/2 [00:16<00:00,  8.15s/it, CE=2.293948e+00 H=2.293817e+00 dV_dx=-1.498423e-05 dV_dθ=-1.167553e-04 ||∇||=3.707517e-01 | Tr=0.1123 Te/Cur=0.1301 Te/Exp=0.1260]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.62s/it] 50%|█████     | 1/2 [00:15<00:12, 12.62s/it, CE=2.314764e+00 H=2.314679e+00 dV_dx=1.204614e-05 dV_dθ=-9.662799e-05 ||∇||=4.270605e-01 | Tr=0.1358 Te/Cur=0.1164 Te/Exp=0.1479]100%|██████████| 2/2 [00:15<00:00,  6.89s/it, CE=2.314764e+00 H=2.314679e+00 dV_dx=1.204614e-05 dV_dθ=-9.662799e-05 ||∇||=4.270605e-01 | Tr=0.1358 Te/Cur=0.1164 Te/Exp=0.1479]100%|██████████| 2/2 [00:15<00:00,  7.75s/it, CE=2.314764e+00 H=2.314679e+00 dV_dx=1.204614e-05 dV_dθ=-9.662799e-05 ||∇||=4.270605e-01 | Tr=0.1358 Te/Cur=0.1164 Te/Exp=0.1479]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.48s/it] 50%|█████     | 1/2 [00:14<00:12, 12.48s/it, CE=2.305898e+00 H=2.305839e+00 dV_dx=1.274625e-05 dV_dθ=-7.170849e-05 ||∇||=4.167748e-01 | Tr=0.1266 Te/Cur=0.1187 Te/Exp=0.1396]100%|██████████| 2/2 [00:14<00:00,  6.53s/it, CE=2.305898e+00 H=2.305839e+00 dV_dx=1.274625e-05 dV_dθ=-7.170849e-05 ||∇||=4.167748e-01 | Tr=0.1266 Te/Cur=0.1187 Te/Exp=0.1396]100%|██████████| 2/2 [00:14<00:00,  7.42s/it, CE=2.305898e+00 H=2.305839e+00 dV_dx=1.274625e-05 dV_dθ=-7.170849e-05 ||∇||=4.167748e-01 | Tr=0.1266 Te/Cur=0.1187 Te/Exp=0.1396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.44s/it] 50%|█████     | 1/2 [00:15<00:12, 12.44s/it, CE=2.301336e+00 H=2.301257e+00 dV_dx=2.205375e-06 dV_dθ=-8.110206e-05 ||∇||=4.322021e-01 | Tr=0.1010 Te/Cur=0.1039 Te/Exp=0.1089]100%|██████████| 2/2 [00:15<00:00,  7.02s/it, CE=2.301336e+00 H=2.301257e+00 dV_dx=2.205375e-06 dV_dθ=-8.110206e-05 ||∇||=4.322021e-01 | Tr=0.1010 Te/Cur=0.1039 Te/Exp=0.1089]100%|██████████| 2/2 [00:15<00:00,  7.83s/it, CE=2.301336e+00 H=2.301257e+00 dV_dx=2.205375e-06 dV_dθ=-8.110206e-05 ||∇||=4.322021e-01 | Tr=0.1010 Te/Cur=0.1039 Te/Exp=0.1089]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.42s/it] 50%|█████     | 1/2 [00:14<00:12, 12.42s/it, CE=2.307452e+00 H=2.307309e+00 dV_dx=3.361854e-06 dV_dθ=-1.464649e-04 ||∇||=4.297143e-01 | Tr=0.1711 Te/Cur=0.1752 Te/Exp=0.1026]100%|██████████| 2/2 [00:14<00:00,  6.46s/it, CE=2.307452e+00 H=2.307309e+00 dV_dx=3.361854e-06 dV_dθ=-1.464649e-04 ||∇||=4.297143e-01 | Tr=0.1711 Te/Cur=0.1752 Te/Exp=0.1026]100%|██████████| 2/2 [00:14<00:00,  7.35s/it, CE=2.307452e+00 H=2.307309e+00 dV_dx=3.361854e-06 dV_dθ=-1.464649e-04 ||∇||=4.297143e-01 | Tr=0.1711 Te/Cur=0.1752 Te/Exp=0.1026]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.63s/it] 50%|█████     | 1/2 [00:09<00:06,  6.63s/it, CE=2.293172e+00 H=2.293075e+00 dV_dx=1.756859e-05 dV_dθ=-1.145697e-04 ||∇||=4.798115e-01 | Tr=0.1741 Te/Cur=0.1893 Te/Exp=0.1857]100%|██████████| 2/2 [00:09<00:00,  4.53s/it, CE=2.293172e+00 H=2.293075e+00 dV_dx=1.756859e-05 dV_dθ=-1.145697e-04 ||∇||=4.798115e-01 | Tr=0.1741 Te/Cur=0.1893 Te/Exp=0.1857]100%|██████████| 2/2 [00:09<00:00,  4.84s/it, CE=2.293172e+00 H=2.293075e+00 dV_dx=1.756859e-05 dV_dθ=-1.145697e-04 ||∇||=4.798115e-01 | Tr=0.1741 Te/Cur=0.1893 Te/Exp=0.1857]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.22s/it] 50%|█████     | 1/2 [00:14<00:12, 12.22s/it, CE=2.315536e+00 H=2.315369e+00 dV_dx=-6.230363e-06 dV_dθ=-1.613823e-04 ||∇||=4.976778e-01 | Tr=0.0968 Te/Cur=0.1065 Te/Exp=0.1487]100%|██████████| 2/2 [00:14<00:00,  6.47s/it, CE=2.315536e+00 H=2.315369e+00 dV_dx=-6.230363e-06 dV_dθ=-1.613823e-04 ||∇||=4.976778e-01 | Tr=0.0968 Te/Cur=0.1065 Te/Exp=0.1487]100%|██████████| 2/2 [00:14<00:00,  7.33s/it, CE=2.315536e+00 H=2.315369e+00 dV_dx=-6.230363e-06 dV_dθ=-1.613823e-04 ||∇||=4.976778e-01 | Tr=0.0968 Te/Cur=0.1065 Te/Exp=0.1487]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.80s/it] 50%|█████     | 1/2 [00:15<00:12, 12.80s/it, CE=2.273999e+00 H=2.273878e+00 dV_dx=5.745958e-06 dV_dθ=-1.267079e-04 ||∇||=4.605051e-01 | Tr=0.1276 Te/Cur=0.1176 Te/Exp=0.1979]100%|██████████| 2/2 [00:15<00:00,  6.78s/it, CE=2.273999e+00 H=2.273878e+00 dV_dx=5.745958e-06 dV_dθ=-1.267079e-04 ||∇||=4.605051e-01 | Tr=0.1276 Te/Cur=0.1176 Te/Exp=0.1979]100%|██████████| 2/2 [00:15<00:00,  7.68s/it, CE=2.273999e+00 H=2.273878e+00 dV_dx=5.745958e-06 dV_dθ=-1.267079e-04 ||∇||=4.605051e-01 | Tr=0.1276 Te/Cur=0.1176 Te/Exp=0.1979]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 492, 84, 10]) with loss 2.273999
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.06s/it] 50%|█████     | 1/2 [00:15<00:13, 13.06s/it, CE=2.272226e+00 H=2.272096e+00 dV_dx=-2.081733e-05 dV_dθ=-1.089922e-04 ||∇||=4.560277e-01 | Tr=0.1577 Te/Cur=0.1696 Te/Exp=0.1912]100%|██████████| 2/2 [00:15<00:00,  6.91s/it, CE=2.272226e+00 H=2.272096e+00 dV_dx=-2.081733e-05 dV_dθ=-1.089922e-04 ||∇||=4.560277e-01 | Tr=0.1577 Te/Cur=0.1696 Te/Exp=0.1912]100%|██████████| 2/2 [00:15<00:00,  7.83s/it, CE=2.272226e+00 H=2.272096e+00 dV_dx=-2.081733e-05 dV_dθ=-1.089922e-04 ||∇||=4.560277e-01 | Tr=0.1577 Te/Cur=0.1696 Te/Exp=0.1912]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 512, 84, 10]) with loss 2.272226
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.84s/it] 50%|█████     | 1/2 [00:15<00:12, 12.84s/it, CE=2.273533e+00 H=2.273443e+00 dV_dx=7.759735e-07 dV_dθ=-9.041836e-05 ||∇||=4.634448e-01 | Tr=0.1084 Te/Cur=0.1269 Te/Exp=0.1819]100%|██████████| 2/2 [00:15<00:00,  6.84s/it, CE=2.273533e+00 H=2.273443e+00 dV_dx=7.759735e-07 dV_dθ=-9.041836e-05 ||∇||=4.634448e-01 | Tr=0.1084 Te/Cur=0.1269 Te/Exp=0.1819]100%|██████████| 2/2 [00:15<00:00,  7.74s/it, CE=2.273533e+00 H=2.273443e+00 dV_dx=7.759735e-07 dV_dθ=-9.041836e-05 ||∇||=4.634448e-01 | Tr=0.1084 Te/Cur=0.1269 Te/Exp=0.1819]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.38s/it] 50%|█████     | 1/2 [00:16<00:13, 13.38s/it, CE=2.334869e+00 H=2.334808e+00 dV_dx=1.949343e-05 dV_dθ=-8.013063e-05 ||∇||=4.259811e-01 | Tr=0.1096 Te/Cur=0.1116 Te/Exp=0.1009]100%|██████████| 2/2 [00:16<00:00,  7.37s/it, CE=2.334869e+00 H=2.334808e+00 dV_dx=1.949343e-05 dV_dθ=-8.013063e-05 ||∇||=4.259811e-01 | Tr=0.1096 Te/Cur=0.1116 Te/Exp=0.1009]100%|██████████| 2/2 [00:16<00:00,  8.27s/it, CE=2.334869e+00 H=2.334808e+00 dV_dx=1.949343e-05 dV_dθ=-8.013063e-05 ||∇||=4.259811e-01 | Tr=0.1096 Te/Cur=0.1116 Te/Exp=0.1009]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.61s/it] 50%|█████     | 1/2 [00:14<00:12, 12.61s/it, CE=2.314838e+00 H=2.314782e+00 dV_dx=8.009371e-06 dV_dθ=-6.325864e-05 ||∇||=4.078829e-01 | Tr=0.1366 Te/Cur=0.1457 Te/Exp=0.1837]100%|██████████| 2/2 [00:14<00:00,  6.55s/it, CE=2.314838e+00 H=2.314782e+00 dV_dx=8.009371e-06 dV_dθ=-6.325864e-05 ||∇||=4.078829e-01 | Tr=0.1366 Te/Cur=0.1457 Te/Exp=0.1837]100%|██████████| 2/2 [00:14<00:00,  7.46s/it, CE=2.314838e+00 H=2.314782e+00 dV_dx=8.009371e-06 dV_dθ=-6.325864e-05 ||∇||=4.078829e-01 | Tr=0.1366 Te/Cur=0.1457 Te/Exp=0.1837]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.94s/it] 50%|█████     | 1/2 [00:16<00:13, 13.94s/it, CE=2.318003e+00 H=2.317891e+00 dV_dx=1.134703e-07 dV_dθ=-1.128147e-04 ||∇||=4.233356e-01 | Tr=0.1764 Te/Cur=0.1929 Te/Exp=0.1582]100%|██████████| 2/2 [00:16<00:00,  7.31s/it, CE=2.318003e+00 H=2.317891e+00 dV_dx=1.134703e-07 dV_dθ=-1.128147e-04 ||∇||=4.233356e-01 | Tr=0.1764 Te/Cur=0.1929 Te/Exp=0.1582]100%|██████████| 2/2 [00:16<00:00,  8.31s/it, CE=2.318003e+00 H=2.317891e+00 dV_dx=1.134703e-07 dV_dθ=-1.128147e-04 ||∇||=4.233356e-01 | Tr=0.1764 Te/Cur=0.1929 Te/Exp=0.1582]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.71s/it] 50%|█████     | 1/2 [00:15<00:12, 12.71s/it, CE=2.334561e+00 H=2.334460e+00 dV_dx=-4.511795e-07 dV_dθ=-1.000539e-04 ||∇||=3.974051e-01 | Tr=0.1243 Te/Cur=0.1262 Te/Exp=0.1315]100%|██████████| 2/2 [00:15<00:00,  6.80s/it, CE=2.334561e+00 H=2.334460e+00 dV_dx=-4.511795e-07 dV_dθ=-1.000539e-04 ||∇||=3.974051e-01 | Tr=0.1243 Te/Cur=0.1262 Te/Exp=0.1315]100%|██████████| 2/2 [00:15<00:00,  7.69s/it, CE=2.334561e+00 H=2.334460e+00 dV_dx=-4.511795e-07 dV_dθ=-1.000539e-04 ||∇||=3.974051e-01 | Tr=0.1243 Te/Cur=0.1262 Te/Exp=0.1315]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.87s/it] 50%|█████     | 1/2 [00:16<00:13, 13.87s/it, CE=2.318034e+00 H=2.317925e+00 dV_dx=-3.896935e-06 dV_dθ=-1.056145e-04 ||∇||=3.972442e-01 | Tr=0.0886 Te/Cur=0.1095 Te/Exp=0.1011]100%|██████████| 2/2 [00:16<00:00,  7.52s/it, CE=2.318034e+00 H=2.317925e+00 dV_dx=-3.896935e-06 dV_dθ=-1.056145e-04 ||∇||=3.972442e-01 | Tr=0.0886 Te/Cur=0.1095 Te/Exp=0.1011]100%|██████████| 2/2 [00:16<00:00,  8.47s/it, CE=2.318034e+00 H=2.317925e+00 dV_dx=-3.896935e-06 dV_dθ=-1.056145e-04 ||∇||=3.972442e-01 | Tr=0.0886 Te/Cur=0.1095 Te/Exp=0.1011]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.92s/it] 50%|█████     | 1/2 [00:14<00:11, 11.92s/it, CE=2.319106e+00 H=2.318953e+00 dV_dx=2.137442e-05 dV_dθ=-1.741229e-04 ||∇||=4.338529e-01 | Tr=0.1497 Te/Cur=0.1716 Te/Exp=0.1331]100%|██████████| 2/2 [00:14<00:00,  6.59s/it, CE=2.319106e+00 H=2.318953e+00 dV_dx=2.137442e-05 dV_dθ=-1.741229e-04 ||∇||=4.338529e-01 | Tr=0.1497 Te/Cur=0.1716 Te/Exp=0.1331]100%|██████████| 2/2 [00:14<00:00,  7.39s/it, CE=2.319106e+00 H=2.318953e+00 dV_dx=2.137442e-05 dV_dθ=-1.741229e-04 ||∇||=4.338529e-01 | Tr=0.1497 Te/Cur=0.1716 Te/Exp=0.1331]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.88s/it] 50%|█████     | 1/2 [00:15<00:12, 12.88s/it, CE=2.306765e+00 H=2.306619e+00 dV_dx=-6.883909e-06 dV_dθ=-1.390547e-04 ||∇||=4.282005e-01 | Tr=0.1712 Te/Cur=0.1794 Te/Exp=0.1760]100%|██████████| 2/2 [00:15<00:00,  6.79s/it, CE=2.306765e+00 H=2.306619e+00 dV_dx=-6.883909e-06 dV_dθ=-1.390547e-04 ||∇||=4.282005e-01 | Tr=0.1712 Te/Cur=0.1794 Te/Exp=0.1760]100%|██████████| 2/2 [00:15<00:00,  7.70s/it, CE=2.306765e+00 H=2.306619e+00 dV_dx=-6.883909e-06 dV_dθ=-1.390547e-04 ||∇||=4.282005e-01 | Tr=0.1712 Te/Cur=0.1794 Te/Exp=0.1760]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.04s/it] 50%|█████     | 1/2 [00:15<00:13, 13.04s/it, CE=2.285027e+00 H=2.284910e+00 dV_dx=8.008878e-06 dV_dθ=-1.252372e-04 ||∇||=4.373076e-01 | Tr=0.1207 Te/Cur=0.1237 Te/Exp=0.2147]100%|██████████| 2/2 [00:15<00:00,  6.91s/it, CE=2.285027e+00 H=2.284910e+00 dV_dx=8.008878e-06 dV_dθ=-1.252372e-04 ||∇||=4.373076e-01 | Tr=0.1207 Te/Cur=0.1237 Te/Exp=0.2147]100%|██████████| 2/2 [00:15<00:00,  7.83s/it, CE=2.285027e+00 H=2.284910e+00 dV_dx=8.008878e-06 dV_dθ=-1.252372e-04 ||∇||=4.373076e-01 | Tr=0.1207 Te/Cur=0.1237 Te/Exp=0.2147]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.79s/it] 50%|█████     | 1/2 [00:15<00:12, 12.79s/it, CE=2.279895e+00 H=2.279773e+00 dV_dx=-2.814993e-06 dV_dθ=-1.191917e-04 ||∇||=4.922053e-01 | Tr=0.1073 Te/Cur=0.1271 Te/Exp=0.1587]100%|██████████| 2/2 [00:15<00:00,  6.69s/it, CE=2.279895e+00 H=2.279773e+00 dV_dx=-2.814993e-06 dV_dθ=-1.191917e-04 ||∇||=4.922053e-01 | Tr=0.1073 Te/Cur=0.1271 Te/Exp=0.1587]100%|██████████| 2/2 [00:15<00:00,  7.61s/it, CE=2.279895e+00 H=2.279773e+00 dV_dx=-2.814993e-06 dV_dθ=-1.191917e-04 ||∇||=4.922053e-01 | Tr=0.1073 Te/Cur=0.1271 Te/Exp=0.1587]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.45s/it] 50%|█████     | 1/2 [00:16<00:13, 13.45s/it, CE=2.304395e+00 H=2.304230e+00 dV_dx=3.135260e-06 dV_dθ=-1.682372e-04 ||∇||=4.565232e-01 | Tr=0.1349 Te/Cur=0.1518 Te/Exp=0.1335]100%|██████████| 2/2 [00:16<00:00,  7.36s/it, CE=2.304395e+00 H=2.304230e+00 dV_dx=3.135260e-06 dV_dθ=-1.682372e-04 ||∇||=4.565232e-01 | Tr=0.1349 Te/Cur=0.1518 Te/Exp=0.1335]100%|██████████| 2/2 [00:16<00:00,  8.27s/it, CE=2.304395e+00 H=2.304230e+00 dV_dx=3.135260e-06 dV_dθ=-1.682372e-04 ||∇||=4.565232e-01 | Tr=0.1349 Te/Cur=0.1518 Te/Exp=0.1335]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.30439542206081
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.07s/it] 50%|█████     | 1/2 [00:07<00:04,  4.07s/it, CE=2.298770e+00 H=2.298575e+00 dV_dx=6.008488e-06 dV_dθ=-2.011471e-04 ||∇||=4.600190e-01 | Tr=0.1530 Te/Cur=0.1383 Te/Exp=0.1087]100%|██████████| 2/2 [00:07<00:00,  3.42s/it, CE=2.298770e+00 H=2.298575e+00 dV_dx=6.008488e-06 dV_dθ=-2.011471e-04 ||∇||=4.600190e-01 | Tr=0.1530 Te/Cur=0.1383 Te/Exp=0.1087]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.298770e+00 H=2.298575e+00 dV_dx=6.008488e-06 dV_dθ=-2.011471e-04 ||∇||=4.600190e-01 | Tr=0.1530 Te/Cur=0.1383 Te/Exp=0.1087]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 44, 10]) with loss 2.298770
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.78s/it] 50%|█████     | 1/2 [00:16<00:13, 13.78s/it, CE=2.305315e+00 H=2.305152e+00 dV_dx=1.507900e-05 dV_dθ=-1.780631e-04 ||∇||=4.914636e-01 | Tr=0.1302 Te/Cur=0.1413 Te/Exp=0.1026]100%|██████████| 2/2 [00:16<00:00,  7.36s/it, CE=2.305315e+00 H=2.305152e+00 dV_dx=1.507900e-05 dV_dθ=-1.780631e-04 ||∇||=4.914636e-01 | Tr=0.1302 Te/Cur=0.1413 Te/Exp=0.1026]100%|██████████| 2/2 [00:16<00:00,  8.32s/it, CE=2.305315e+00 H=2.305152e+00 dV_dx=1.507900e-05 dV_dθ=-1.780631e-04 ||∇||=4.914636e-01 | Tr=0.1302 Te/Cur=0.1413 Te/Exp=0.1026]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.41s/it] 50%|█████     | 1/2 [00:16<00:13, 13.41s/it, CE=2.296366e+00 H=2.296217e+00 dV_dx=6.695921e-07 dV_dθ=-1.505361e-04 ||∇||=5.396528e-01 | Tr=0.1345 Te/Cur=0.1973 Te/Exp=0.1652]100%|██████████| 2/2 [00:16<00:00,  7.25s/it, CE=2.296366e+00 H=2.296217e+00 dV_dx=6.695921e-07 dV_dθ=-1.505361e-04 ||∇||=5.396528e-01 | Tr=0.1345 Te/Cur=0.1973 Te/Exp=0.1652]100%|██████████| 2/2 [00:16<00:00,  8.17s/it, CE=2.296366e+00 H=2.296217e+00 dV_dx=6.695921e-07 dV_dθ=-1.505361e-04 ||∇||=5.396528e-01 | Tr=0.1345 Te/Cur=0.1973 Te/Exp=0.1652]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 472, 84, 10]) with loss 2.296366
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.10s/it] 50%|█████     | 1/2 [00:06<00:04,  4.10s/it, CE=2.279116e+00 H=2.279001e+00 dV_dx=1.817329e-06 dV_dθ=-1.162312e-04 ||∇||=4.409587e-01 | Tr=0.1473 Te/Cur=0.1774 Te/Exp=0.2546]100%|██████████| 2/2 [00:06<00:00,  3.28s/it, CE=2.279116e+00 H=2.279001e+00 dV_dx=1.817329e-06 dV_dθ=-1.162312e-04 ||∇||=4.409587e-01 | Tr=0.1473 Te/Cur=0.1774 Te/Exp=0.2546]100%|██████████| 2/2 [00:06<00:00,  3.40s/it, CE=2.279116e+00 H=2.279001e+00 dV_dx=1.817329e-06 dV_dθ=-1.162312e-04 ||∇||=4.409587e-01 | Tr=0.1473 Te/Cur=0.1774 Te/Exp=0.2546]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 84, 10]) with loss 2.279116
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.38s/it] 50%|█████     | 1/2 [00:16<00:13, 13.38s/it, CE=2.274226e+00 H=2.274151e+00 dV_dx=1.365784e-06 dV_dθ=-7.626260e-05 ||∇||=4.221194e-01 | Tr=0.1813 Te/Cur=0.1986 Te/Exp=0.2674]100%|██████████| 2/2 [00:16<00:00,  7.48s/it, CE=2.274226e+00 H=2.274151e+00 dV_dx=1.365784e-06 dV_dθ=-7.626260e-05 ||∇||=4.221194e-01 | Tr=0.1813 Te/Cur=0.1986 Te/Exp=0.2674]100%|██████████| 2/2 [00:16<00:00,  8.37s/it, CE=2.274226e+00 H=2.274151e+00 dV_dx=1.365784e-06 dV_dθ=-7.626260e-05 ||∇||=4.221194e-01 | Tr=0.1813 Te/Cur=0.1986 Te/Exp=0.2674]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 84, 10]) with loss 2.274226
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.57s/it] 50%|█████     | 1/2 [00:16<00:13, 13.57s/it, CE=2.277509e+00 H=2.277369e+00 dV_dx=1.504527e-07 dV_dθ=-1.405460e-04 ||∇||=4.239412e-01 | Tr=0.0910 Te/Cur=0.1018 Te/Exp=0.2777]100%|██████████| 2/2 [00:16<00:00,  7.42s/it, CE=2.277509e+00 H=2.277369e+00 dV_dx=1.504527e-07 dV_dθ=-1.405460e-04 ||∇||=4.239412e-01 | Tr=0.0910 Te/Cur=0.1018 Te/Exp=0.2777]100%|██████████| 2/2 [00:16<00:00,  8.34s/it, CE=2.277509e+00 H=2.277369e+00 dV_dx=1.504527e-07 dV_dθ=-1.405460e-04 ||∇||=4.239412e-01 | Tr=0.0910 Te/Cur=0.1018 Te/Exp=0.2777]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.63s/it] 50%|█████     | 1/2 [00:15<00:12, 12.63s/it, CE=2.278792e+00 H=2.278677e+00 dV_dx=-1.181465e-05 dV_dθ=-1.031709e-04 ||∇||=4.357779e-01 | Tr=0.1565 Te/Cur=0.1752 Te/Exp=0.1994]100%|██████████| 2/2 [00:15<00:00,  6.63s/it, CE=2.278792e+00 H=2.278677e+00 dV_dx=-1.181465e-05 dV_dθ=-1.031709e-04 ||∇||=4.357779e-01 | Tr=0.1565 Te/Cur=0.1752 Te/Exp=0.1994]100%|██████████| 2/2 [00:15<00:00,  7.53s/it, CE=2.278792e+00 H=2.278677e+00 dV_dx=-1.181465e-05 dV_dθ=-1.031709e-04 ||∇||=4.357779e-01 | Tr=0.1565 Te/Cur=0.1752 Te/Exp=0.1994]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.87s/it] 50%|█████     | 1/2 [00:16<00:13, 13.87s/it, CE=2.282446e+00 H=2.282382e+00 dV_dx=5.447092e-06 dV_dθ=-6.972366e-05 ||∇||=4.718352e-01 | Tr=0.1461 Te/Cur=0.1852 Te/Exp=0.1749]100%|██████████| 2/2 [00:16<00:00,  7.48s/it, CE=2.282446e+00 H=2.282382e+00 dV_dx=5.447092e-06 dV_dθ=-6.972366e-05 ||∇||=4.718352e-01 | Tr=0.1461 Te/Cur=0.1852 Te/Exp=0.1749]100%|██████████| 2/2 [00:16<00:00,  8.44s/it, CE=2.282446e+00 H=2.282382e+00 dV_dx=5.447092e-06 dV_dθ=-6.972366e-05 ||∇||=4.718352e-01 | Tr=0.1461 Te/Cur=0.1852 Te/Exp=0.1749]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.68s/it] 50%|█████     | 1/2 [00:15<00:12, 12.68s/it, CE=2.299070e+00 H=2.298945e+00 dV_dx=7.456598e-06 dV_dθ=-1.326607e-04 ||∇||=4.201113e-01 | Tr=0.1802 Te/Cur=0.1791 Te/Exp=0.1627]100%|██████████| 2/2 [00:15<00:00,  6.73s/it, CE=2.299070e+00 H=2.298945e+00 dV_dx=7.456598e-06 dV_dθ=-1.326607e-04 ||∇||=4.201113e-01 | Tr=0.1802 Te/Cur=0.1791 Te/Exp=0.1627]100%|██████████| 2/2 [00:15<00:00,  7.62s/it, CE=2.299070e+00 H=2.298945e+00 dV_dx=7.456598e-06 dV_dθ=-1.326607e-04 ||∇||=4.201113e-01 | Tr=0.1802 Te/Cur=0.1791 Te/Exp=0.1627]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.34s/it] 50%|█████     | 1/2 [00:07<00:04,  4.34s/it, CE=2.287356e+00 H=2.287217e+00 dV_dx=4.919436e-06 dV_dθ=-1.436953e-04 ||∇||=4.321993e-01 | Tr=0.1760 Te/Cur=0.1844 Te/Exp=0.1160]100%|██████████| 2/2 [00:07<00:00,  3.49s/it, CE=2.287356e+00 H=2.287217e+00 dV_dx=4.919436e-06 dV_dθ=-1.436953e-04 ||∇||=4.321993e-01 | Tr=0.1760 Te/Cur=0.1844 Te/Exp=0.1160]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.287356e+00 H=2.287217e+00 dV_dx=4.919436e-06 dV_dθ=-1.436953e-04 ||∇||=4.321993e-01 | Tr=0.1760 Te/Cur=0.1844 Te/Exp=0.1160]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.81s/it] 50%|█████     | 1/2 [00:16<00:13, 13.81s/it, CE=2.298512e+00 H=2.298369e+00 dV_dx=6.175949e-06 dV_dθ=-1.489297e-04 ||∇||=4.489911e-01 | Tr=0.1597 Te/Cur=0.1668 Te/Exp=0.1744]100%|██████████| 2/2 [00:16<00:00,  7.36s/it, CE=2.298512e+00 H=2.298369e+00 dV_dx=6.175949e-06 dV_dθ=-1.489297e-04 ||∇||=4.489911e-01 | Tr=0.1597 Te/Cur=0.1668 Te/Exp=0.1744]100%|██████████| 2/2 [00:16<00:00,  8.33s/it, CE=2.298512e+00 H=2.298369e+00 dV_dx=6.175949e-06 dV_dθ=-1.489297e-04 ||∇||=4.489911e-01 | Tr=0.1597 Te/Cur=0.1668 Te/Exp=0.1744]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.05s/it] 50%|█████     | 1/2 [00:15<00:13, 13.05s/it, CE=2.268813e+00 H=2.268725e+00 dV_dx=9.843883e-06 dV_dθ=-9.764303e-05 ||∇||=4.691885e-01 | Tr=0.2454 Te/Cur=0.3293 Te/Exp=0.1588]100%|██████████| 2/2 [00:15<00:00,  6.80s/it, CE=2.268813e+00 H=2.268725e+00 dV_dx=9.843883e-06 dV_dθ=-9.764303e-05 ||∇||=4.691885e-01 | Tr=0.2454 Te/Cur=0.3293 Te/Exp=0.1588]100%|██████████| 2/2 [00:15<00:00,  7.74s/it, CE=2.268813e+00 H=2.268725e+00 dV_dx=9.843883e-06 dV_dθ=-9.764303e-05 ||∇||=4.691885e-01 | Tr=0.2454 Te/Cur=0.3293 Te/Exp=0.1588]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 472, 84, 10]) with loss 2.268813
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.10s/it] 50%|█████     | 1/2 [00:06<00:04,  4.10s/it, CE=2.264742e+00 H=2.264601e+00 dV_dx=1.099274e-05 dV_dθ=-1.520132e-04 ||∇||=4.771833e-01 | Tr=0.2211 Te/Cur=0.2535 Te/Exp=0.1986]100%|██████████| 2/2 [00:06<00:00,  3.32s/it, CE=2.264742e+00 H=2.264601e+00 dV_dx=1.099274e-05 dV_dθ=-1.520132e-04 ||∇||=4.771833e-01 | Tr=0.2211 Te/Cur=0.2535 Te/Exp=0.1986]100%|██████████| 2/2 [00:06<00:00,  3.44s/it, CE=2.264742e+00 H=2.264601e+00 dV_dx=1.099274e-05 dV_dθ=-1.520132e-04 ||∇||=4.771833e-01 | Tr=0.2211 Te/Cur=0.2535 Te/Exp=0.1986]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 512, 84, 10]) with loss 2.264742
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.96s/it] 50%|█████     | 1/2 [00:16<00:13, 13.96s/it, CE=2.250767e+00 H=2.250699e+00 dV_dx=1.173645e-05 dV_dθ=-8.023680e-05 ||∇||=4.365656e-01 | Tr=0.2561 Te/Cur=0.3135 Te/Exp=0.3311]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.250767e+00 H=2.250699e+00 dV_dx=1.173645e-05 dV_dθ=-8.023680e-05 ||∇||=4.365656e-01 | Tr=0.2561 Te/Cur=0.3135 Te/Exp=0.3311]100%|██████████| 2/2 [00:16<00:00,  8.38s/it, CE=2.250767e+00 H=2.250699e+00 dV_dx=1.173645e-05 dV_dθ=-8.023680e-05 ||∇||=4.365656e-01 | Tr=0.2561 Te/Cur=0.3135 Te/Exp=0.3311]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 552, 84, 10]) with loss 2.250767
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.18s/it] 50%|█████     | 1/2 [00:14<00:12, 12.18s/it, CE=2.245161e+00 H=2.245118e+00 dV_dx=6.311101e-06 dV_dθ=-4.902110e-05 ||∇||=4.378898e-01 | Tr=0.1471 Te/Cur=0.1720 Te/Exp=0.3287]100%|██████████| 2/2 [00:14<00:00,  6.45s/it, CE=2.245161e+00 H=2.245118e+00 dV_dx=6.311101e-06 dV_dθ=-4.902110e-05 ||∇||=4.378898e-01 | Tr=0.1471 Te/Cur=0.1720 Te/Exp=0.3287]100%|██████████| 2/2 [00:14<00:00,  7.31s/it, CE=2.245161e+00 H=2.245118e+00 dV_dx=6.311101e-06 dV_dθ=-4.902110e-05 ||∇||=4.378898e-01 | Tr=0.1471 Te/Cur=0.1720 Te/Exp=0.3287]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 472, 124, 10]) with loss 2.245161
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.62s/it] 50%|█████     | 1/2 [00:14<00:12, 12.62s/it, CE=2.256381e+00 H=2.256197e+00 dV_dx=3.663928e-06 dV_dθ=-1.876192e-04 ||∇||=5.333076e-01 | Tr=0.2484 Te/Cur=0.3289 Te/Exp=0.3008]100%|██████████| 2/2 [00:14<00:00,  6.59s/it, CE=2.256381e+00 H=2.256197e+00 dV_dx=3.663928e-06 dV_dθ=-1.876192e-04 ||∇||=5.333076e-01 | Tr=0.2484 Te/Cur=0.3289 Te/Exp=0.3008]100%|██████████| 2/2 [00:14<00:00,  7.50s/it, CE=2.256381e+00 H=2.256197e+00 dV_dx=3.663928e-06 dV_dθ=-1.876192e-04 ||∇||=5.333076e-01 | Tr=0.2484 Te/Cur=0.3289 Te/Exp=0.3008]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.92s/it] 50%|█████     | 1/2 [00:16<00:12, 12.92s/it, CE=2.254477e+00 H=2.254368e+00 dV_dx=-1.499737e-05 dV_dθ=-9.462187e-05 ||∇||=4.749313e-01 | Tr=0.1521 Te/Cur=0.2412 Te/Exp=0.3850]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.254477e+00 H=2.254368e+00 dV_dx=-1.499737e-05 dV_dθ=-9.462187e-05 ||∇||=4.749313e-01 | Tr=0.1521 Te/Cur=0.2412 Te/Exp=0.3850]100%|██████████| 2/2 [00:16<00:00,  8.06s/it, CE=2.254477e+00 H=2.254368e+00 dV_dx=-1.499737e-05 dV_dθ=-9.462187e-05 ||∇||=4.749313e-01 | Tr=0.1521 Te/Cur=0.2412 Te/Exp=0.3850]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.72s/it] 50%|█████     | 1/2 [00:15<00:12, 12.72s/it, CE=2.301963e+00 H=2.301747e+00 dV_dx=-2.183764e-06 dV_dθ=-2.138544e-04 ||∇||=5.319800e-01 | Tr=0.1394 Te/Cur=0.1508 Te/Exp=0.1220]100%|██████████| 2/2 [00:15<00:00,  6.75s/it, CE=2.301963e+00 H=2.301747e+00 dV_dx=-2.183764e-06 dV_dθ=-2.138544e-04 ||∇||=5.319800e-01 | Tr=0.1394 Te/Cur=0.1508 Te/Exp=0.1220]100%|██████████| 2/2 [00:15<00:00,  7.65s/it, CE=2.301963e+00 H=2.301747e+00 dV_dx=-2.183764e-06 dV_dθ=-2.138544e-04 ||∇||=5.319800e-01 | Tr=0.1394 Te/Cur=0.1508 Te/Exp=0.1220]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.42s/it] 50%|█████     | 1/2 [00:07<00:04,  4.42s/it, CE=2.296518e+00 H=2.296485e+00 dV_dx=-8.413870e-06 dV_dθ=-2.397558e-05 ||∇||=3.874898e-01 | Tr=0.0933 Te/Cur=0.1033 Te/Exp=0.1013]100%|██████████| 2/2 [00:07<00:00,  3.36s/it, CE=2.296518e+00 H=2.296485e+00 dV_dx=-8.413870e-06 dV_dθ=-2.397558e-05 ||∇||=3.874898e-01 | Tr=0.0933 Te/Cur=0.1033 Te/Exp=0.1013]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.296518e+00 H=2.296485e+00 dV_dx=-8.413870e-06 dV_dθ=-2.397558e-05 ||∇||=3.874898e-01 | Tr=0.0933 Te/Cur=0.1033 Te/Exp=0.1013]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.98s/it] 50%|█████     | 1/2 [00:15<00:12, 12.98s/it, CE=2.277847e+00 H=2.277678e+00 dV_dx=-6.957333e-06 dV_dθ=-1.622061e-04 ||∇||=4.911274e-01 | Tr=0.1000 Te/Cur=0.0988 Te/Exp=0.1667]100%|██████████| 2/2 [00:15<00:00,  6.81s/it, CE=2.277847e+00 H=2.277678e+00 dV_dx=-6.957333e-06 dV_dθ=-1.622061e-04 ||∇||=4.911274e-01 | Tr=0.1000 Te/Cur=0.0988 Te/Exp=0.1667]100%|██████████| 2/2 [00:15<00:00,  7.73s/it, CE=2.277847e+00 H=2.277678e+00 dV_dx=-6.957333e-06 dV_dθ=-1.622061e-04 ||∇||=4.911274e-01 | Tr=0.1000 Te/Cur=0.0988 Te/Exp=0.1667]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.09s/it] 50%|█████     | 1/2 [00:16<00:14, 14.09s/it, CE=2.255141e+00 H=2.255051e+00 dV_dx=3.276679e-06 dV_dθ=-9.362721e-05 ||∇||=4.513249e-01 | Tr=0.1674 Te/Cur=0.1558 Te/Exp=0.2051]100%|██████████| 2/2 [00:16<00:00,  7.33s/it, CE=2.255141e+00 H=2.255051e+00 dV_dx=3.276679e-06 dV_dθ=-9.362721e-05 ||∇||=4.513249e-01 | Tr=0.1674 Te/Cur=0.1558 Te/Exp=0.2051]100%|██████████| 2/2 [00:16<00:00,  8.35s/it, CE=2.255141e+00 H=2.255051e+00 dV_dx=3.276679e-06 dV_dθ=-9.362721e-05 ||∇||=4.513249e-01 | Tr=0.1674 Te/Cur=0.1558 Te/Exp=0.2051]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.21s/it] 50%|█████     | 1/2 [00:06<00:04,  4.21s/it, CE=2.254659e+00 H=2.254549e+00 dV_dx=-1.380923e-05 dV_dθ=-9.641067e-05 ||∇||=5.208951e-01 | Tr=0.0751 Te/Cur=0.0990 Te/Exp=0.1641]100%|██████████| 2/2 [00:06<00:00,  3.27s/it, CE=2.254659e+00 H=2.254549e+00 dV_dx=-1.380923e-05 dV_dθ=-9.641067e-05 ||∇||=5.208951e-01 | Tr=0.0751 Te/Cur=0.0990 Te/Exp=0.1641]100%|██████████| 2/2 [00:06<00:00,  3.42s/it, CE=2.254659e+00 H=2.254549e+00 dV_dx=-1.380923e-05 dV_dθ=-9.641067e-05 ||∇||=5.208951e-01 | Tr=0.0751 Te/Cur=0.0990 Te/Exp=0.1641]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.47s/it] 50%|█████     | 1/2 [00:15<00:12, 12.47s/it, CE=2.222371e+00 H=2.222320e+00 dV_dx=2.092127e-05 dV_dθ=-7.161617e-05 ||∇||=5.081480e-01 | Tr=0.0997 Te/Cur=0.1496 Te/Exp=0.3844]100%|██████████| 2/2 [00:15<00:00,  6.79s/it, CE=2.222371e+00 H=2.222320e+00 dV_dx=2.092127e-05 dV_dθ=-7.161617e-05 ||∇||=5.081480e-01 | Tr=0.0997 Te/Cur=0.1496 Te/Exp=0.3844]100%|██████████| 2/2 [00:15<00:00,  7.65s/it, CE=2.222371e+00 H=2.222320e+00 dV_dx=2.092127e-05 dV_dθ=-7.161617e-05 ||∇||=5.081480e-01 | Tr=0.0997 Te/Cur=0.1496 Te/Exp=0.3844]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 552, 84, 10]) with loss 2.222371
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.05s/it] 50%|█████     | 1/2 [00:16<00:13, 13.05s/it, CE=2.270001e+00 H=2.269832e+00 dV_dx=1.154695e-05 dV_dθ=-1.806667e-04 ||∇||=5.416791e-01 | Tr=0.0680 Te/Cur=0.0685 Te/Exp=0.1271]100%|██████████| 2/2 [00:16<00:00,  7.47s/it, CE=2.270001e+00 H=2.269832e+00 dV_dx=1.154695e-05 dV_dθ=-1.806667e-04 ||∇||=5.416791e-01 | Tr=0.0680 Te/Cur=0.0685 Te/Exp=0.1271]100%|██████████| 2/2 [00:16<00:00,  8.31s/it, CE=2.270001e+00 H=2.269832e+00 dV_dx=1.154695e-05 dV_dθ=-1.806667e-04 ||∇||=5.416791e-01 | Tr=0.0680 Te/Cur=0.0685 Te/Exp=0.1271]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.67s/it] 50%|█████     | 1/2 [00:15<00:12, 12.67s/it, CE=2.256790e+00 H=2.256700e+00 dV_dx=-6.390978e-07 dV_dθ=-8.944175e-05 ||∇||=4.815334e-01 | Tr=0.0962 Te/Cur=0.1126 Te/Exp=0.1165]100%|██████████| 2/2 [00:15<00:00,  6.85s/it, CE=2.256790e+00 H=2.256700e+00 dV_dx=-6.390978e-07 dV_dθ=-8.944175e-05 ||∇||=4.815334e-01 | Tr=0.0962 Te/Cur=0.1126 Te/Exp=0.1165]100%|██████████| 2/2 [00:15<00:00,  7.72s/it, CE=2.256790e+00 H=2.256700e+00 dV_dx=-6.390978e-07 dV_dθ=-8.944175e-05 ||∇||=4.815334e-01 | Tr=0.0962 Te/Cur=0.1126 Te/Exp=0.1165]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.41s/it] 50%|█████     | 1/2 [00:15<00:12, 12.41s/it, CE=2.245865e+00 H=2.245832e+00 dV_dx=2.931582e-05 dV_dθ=-6.209999e-05 ||∇||=4.675512e-01 | Tr=0.1609 Te/Cur=0.1635 Te/Exp=0.1968]100%|██████████| 2/2 [00:15<00:00,  6.68s/it, CE=2.245865e+00 H=2.245832e+00 dV_dx=2.931582e-05 dV_dθ=-6.209999e-05 ||∇||=4.675512e-01 | Tr=0.1609 Te/Cur=0.1635 Te/Exp=0.1968]100%|██████████| 2/2 [00:15<00:00,  7.53s/it, CE=2.245865e+00 H=2.245832e+00 dV_dx=2.931582e-05 dV_dθ=-6.209999e-05 ||∇||=4.675512e-01 | Tr=0.1609 Te/Cur=0.1635 Te/Exp=0.1968]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (4, [432, 552, 84, 10]) with loss 2.222371
  Total candidates evaluated: 54
  Original: (3, [507, 512, 64, 10])
  Optimal: (4, [432, 552, 84, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 3→4, feed [507, 512, 64, 10]→[432, 552, 84, 10]
  Conv filter changed: A_conv/B_conv shape = (4, 3)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:17<05:35, 17.67s/it]  5%|▌         | 1/20 [00:22<05:35, 17.67s/it, CE=1.551625e+00 H=1.550203e+00 dV_dx=1.354267e-05 dV_dθ=-1.436368e-03 ||∇||=1.325446e+00 | Tr=0.7295] 10%|█         | 2/20 [00:22<02:58,  9.93s/it, CE=1.551625e+00 H=1.550203e+00 dV_dx=1.354267e-05 dV_dθ=-1.436368e-03 ||∇||=1.325446e+00 | Tr=0.7295] 10%|█         | 2/20 [00:26<02:58,  9.93s/it, CE=1.326775e+00 H=1.325199e+00 dV_dx=-2.700143e-05 dV_dθ=-1.549275e-03 ||∇||=1.420410e+00 | Tr=0.7295] 15%|█▌        | 3/20 [00:26<02:07,  7.51s/it, CE=1.326775e+00 H=1.325199e+00 dV_dx=-2.700143e-05 dV_dθ=-1.549275e-03 ||∇||=1.420410e+00 | Tr=0.7295] 15%|█▌        | 3/20 [00:31<02:07,  7.51s/it, CE=1.191185e+00 H=1.189286e+00 dV_dx=4.344516e-05 dV_dθ=-1.942833e-03 ||∇||=1.600160e+00 | Tr=0.7295]  20%|██        | 4/20 [00:31<01:42,  6.38s/it, CE=1.191185e+00 H=1.189286e+00 dV_dx=4.344516e-05 dV_dθ=-1.942833e-03 ||∇||=1.600160e+00 | Tr=0.7295] 20%|██        | 4/20 [00:36<01:42,  6.38s/it, CE=1.092484e+00 H=1.090598e+00 dV_dx=9.117345e-05 dV_dθ=-1.977248e-03 ||∇||=1.649848e+00 | Tr=0.7295] 25%|██▌       | 5/20 [00:36<01:28,  5.89s/it, CE=1.092484e+00 H=1.090598e+00 dV_dx=9.117345e-05 dV_dθ=-1.977248e-03 ||∇||=1.649848e+00 | Tr=0.7295] 25%|██▌       | 5/20 [00:41<01:28,  5.89s/it, CE=1.017203e+00 H=1.015251e+00 dV_dx=-1.226199e-05 dV_dθ=-1.940253e-03 ||∇||=1.700733e+00 | Tr=0.7295] 30%|███       | 6/20 [00:41<01:16,  5.45s/it, CE=1.017203e+00 H=1.015251e+00 dV_dx=-1.226199e-05 dV_dθ=-1.940253e-03 ||∇||=1.700733e+00 | Tr=0.7295] 30%|███       | 6/20 [00:45<01:16,  5.45s/it, CE=9.564070e-01 H=9.544565e-01 dV_dx=7.804589e-05 dV_dθ=-2.028583e-03 ||∇||=1.768504e+00 | Tr=0.7295]  35%|███▌      | 7/20 [00:45<01:08,  5.24s/it, CE=9.564070e-01 H=9.544565e-01 dV_dx=7.804589e-05 dV_dθ=-2.028583e-03 ||∇||=1.768504e+00 | Tr=0.7295] 35%|███▌      | 7/20 [00:50<01:08,  5.24s/it, CE=9.064205e-01 H=9.044500e-01 dV_dx=1.209913e-05 dV_dθ=-1.982648e-03 ||∇||=1.778858e+00 | Tr=0.7295] 40%|████      | 8/20 [00:50<00:59,  4.97s/it, CE=9.064205e-01 H=9.044500e-01 dV_dx=1.209913e-05 dV_dθ=-1.982648e-03 ||∇||=1.778858e+00 | Tr=0.7295] 40%|████      | 8/20 [00:54<00:59,  4.97s/it, CE=8.661104e-01 H=8.640825e-01 dV_dx=3.964518e-05 dV_dθ=-2.067564e-03 ||∇||=1.813282e+00 | Tr=0.7295] 45%|████▌     | 9/20 [00:54<00:52,  4.80s/it, CE=8.661104e-01 H=8.640825e-01 dV_dx=3.964518e-05 dV_dθ=-2.067564e-03 ||∇||=1.813282e+00 | Tr=0.7295] 45%|████▌     | 9/20 [00:59<00:52,  4.80s/it, CE=8.330094e-01 H=8.309158e-01 dV_dx=6.186962e-05 dV_dθ=-2.155470e-03 ||∇||=1.849663e+00 | Tr=0.7295] 50%|█████     | 10/20 [00:59<00:47,  4.78s/it, CE=8.330094e-01 H=8.309158e-01 dV_dx=6.186962e-05 dV_dθ=-2.155470e-03 ||∇||=1.849663e+00 | Tr=0.7295] 50%|█████     | 10/20 [01:04<00:47,  4.78s/it, CE=8.054122e-01 H=8.032548e-01 dV_dx=3.733516e-05 dV_dθ=-2.194744e-03 ||∇||=1.863965e+00 | Tr=0.7295] 55%|█████▌    | 11/20 [01:04<00:43,  4.80s/it, CE=8.054122e-01 H=8.032548e-01 dV_dx=3.733516e-05 dV_dθ=-2.194744e-03 ||∇||=1.863965e+00 | Tr=0.7295] 55%|█████▌    | 11/20 [01:09<00:43,  4.80s/it, CE=7.817237e-01 H=7.795417e-01 dV_dx=8.195287e-06 dV_dθ=-2.190201e-03 ||∇||=1.879632e+00 | Tr=0.7295] 60%|██████    | 12/20 [01:09<00:38,  4.82s/it, CE=7.817237e-01 H=7.795417e-01 dV_dx=8.195287e-06 dV_dθ=-2.190201e-03 ||∇||=1.879632e+00 | Tr=0.7295] 60%|██████    | 12/20 [01:13<00:38,  4.82s/it, CE=7.614081e-01 H=7.592010e-01 dV_dx=-5.783937e-05 dV_dθ=-2.149277e-03 ||∇||=1.897865e+00 | Tr=0.7295] 65%|██████▌   | 13/20 [01:13<00:33,  4.74s/it, CE=7.614081e-01 H=7.592010e-01 dV_dx=-5.783937e-05 dV_dθ=-2.149277e-03 ||∇||=1.897865e+00 | Tr=0.7295] 65%|██████▌   | 13/20 [01:18<00:33,  4.74s/it, CE=7.433828e-01 H=7.412349e-01 dV_dx=-7.222634e-05 dV_dθ=-2.075729e-03 ||∇||=1.915032e+00 | Tr=0.7295] 70%|███████   | 14/20 [01:18<00:28,  4.75s/it, CE=7.433828e-01 H=7.412349e-01 dV_dx=-7.222634e-05 dV_dθ=-2.075729e-03 ||∇||=1.915032e+00 | Tr=0.7295] 70%|███████   | 14/20 [01:22<00:28,  4.75s/it, CE=7.275132e-01 H=7.253794e-01 dV_dx=1.720557e-05 dV_dθ=-2.150957e-03 ||∇||=1.958218e+00 | Tr=0.7295]  75%|███████▌  | 15/20 [01:22<00:23,  4.62s/it, CE=7.275132e-01 H=7.253794e-01 dV_dx=1.720557e-05 dV_dθ=-2.150957e-03 ||∇||=1.958218e+00 | Tr=0.7295] 75%|███████▌  | 15/20 [01:27<00:23,  4.62s/it, CE=7.133167e-01 H=7.111235e-01 dV_dx=-2.887917e-05 dV_dθ=-2.164323e-03 ||∇||=1.990225e+00 | Tr=0.7295] 80%|████████  | 16/20 [01:27<00:18,  4.61s/it, CE=7.133167e-01 H=7.111235e-01 dV_dx=-2.887917e-05 dV_dθ=-2.164323e-03 ||∇||=1.990225e+00 | Tr=0.7295] 80%|████████  | 16/20 [01:32<00:18,  4.61s/it, CE=7.008022e-01 H=6.986406e-01 dV_dx=1.668010e-05 dV_dθ=-2.178247e-03 ||∇||=2.033704e+00 | Tr=0.7295]  85%|████████▌ | 17/20 [01:32<00:13,  4.65s/it, CE=7.008022e-01 H=6.986406e-01 dV_dx=1.668010e-05 dV_dθ=-2.178247e-03 ||∇||=2.033704e+00 | Tr=0.7295] 85%|████████▌ | 17/20 [01:36<00:13,  4.65s/it, CE=6.893372e-01 H=6.871075e-01 dV_dx=-6.747667e-05 dV_dθ=-2.162230e-03 ||∇||=2.076176e+00 | Tr=0.7295] 90%|█████████ | 18/20 [01:36<00:09,  4.63s/it, CE=6.893372e-01 H=6.871075e-01 dV_dx=-6.747667e-05 dV_dθ=-2.162230e-03 ||∇||=2.076176e+00 | Tr=0.7295] 90%|█████████ | 18/20 [01:41<00:09,  4.63s/it, CE=6.785301e-01 H=6.763236e-01 dV_dx=-7.984214e-05 dV_dθ=-2.126717e-03 ||∇||=2.103394e+00 | Tr=0.7295] 95%|█████████▌| 19/20 [01:41<00:04,  4.74s/it, CE=6.785301e-01 H=6.763236e-01 dV_dx=-7.984214e-05 dV_dθ=-2.126717e-03 ||∇||=2.103394e+00 | Tr=0.7295] 95%|█████████▌| 19/20 [01:49<00:04,  4.74s/it, CE=6.680804e-01 H=6.661499e-01 dV_dx=-3.723996e-05 dV_dθ=-1.893251e-03 ||∇||=2.080436e+00 | Tr=0.7295 Te/Cur=0.9404 Te/Exp=0.7782]100%|██████████| 20/20 [01:55<00:00,  7.44s/it, CE=6.680804e-01 H=6.661499e-01 dV_dx=-3.723996e-05 dV_dθ=-1.893251e-03 ||∇||=2.080436e+00 | Tr=0.7295 Te/Cur=0.9404 Te/Exp=0.7782]100%|██████████| 20/20 [01:55<00:00,  5.77s/it, CE=6.680804e-01 H=6.661499e-01 dV_dx=-3.723996e-05 dV_dθ=-1.893251e-03 ||∇||=2.080436e+00 | Tr=0.7295 Te/Cur=0.9404 Te/Exp=0.7782]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.668080

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.12s/it] 50%|█████     | 1/2 [00:18<00:12, 12.12s/it, CE=6.453986e-01 H=6.452504e-01 dV_dx=-2.083329e-05 dV_dθ=-1.273874e-04 ||∇||=6.090836e-01 | Tr=0.9506 Te/Cur=0.9426 Te/Exp=0.7770]100%|██████████| 2/2 [00:18<00:00,  8.88s/it, CE=6.453986e-01 H=6.452504e-01 dV_dx=-2.083329e-05 dV_dθ=-1.273874e-04 ||∇||=6.090836e-01 | Tr=0.9506 Te/Cur=0.9426 Te/Exp=0.7770]100%|██████████| 2/2 [00:18<00:00,  9.36s/it, CE=6.453986e-01 H=6.452504e-01 dV_dx=-2.083329e-05 dV_dθ=-1.273874e-04 ||∇||=6.090836e-01 | Tr=0.9506 Te/Cur=0.9426 Te/Exp=0.7770]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:42,  8.54s/it]  5%|▌         | 1/20 [00:13<02:42,  8.54s/it, CE=6.381496e-01 H=6.379915e-01 dV_dx=-2.202500e-05 dV_dθ=-1.360313e-04 ||∇||=6.279239e-01 | Tr=0.9519] 10%|█         | 2/20 [00:13<01:53,  6.29s/it, CE=6.381496e-01 H=6.379915e-01 dV_dx=-2.202500e-05 dV_dθ=-1.360313e-04 ||∇||=6.279239e-01 | Tr=0.9519] 10%|█         | 2/20 [00:17<01:53,  6.29s/it, CE=6.345840e-01 H=6.342807e-01 dV_dx=-1.610000e-04 dV_dθ=-1.423203e-04 ||∇||=6.343933e-01 | Tr=0.9527] 15%|█▌        | 3/20 [00:17<01:33,  5.48s/it, CE=6.345840e-01 H=6.342807e-01 dV_dx=-1.610000e-04 dV_dθ=-1.423203e-04 ||∇||=6.343933e-01 | Tr=0.9527] 15%|█▌        | 3/20 [00:21<01:33,  5.48s/it, CE=6.310801e-01 H=6.309312e-01 dV_dx=-6.565666e-06 dV_dθ=-1.423489e-04 ||∇||=6.379070e-01 | Tr=0.9535] 20%|██        | 4/20 [00:21<01:15,  4.71s/it, CE=6.310801e-01 H=6.309312e-01 dV_dx=-6.565666e-06 dV_dθ=-1.423489e-04 ||∇||=6.379070e-01 | Tr=0.9535] 20%|██        | 4/20 [00:25<01:15,  4.71s/it, CE=6.277162e-01 H=6.275999e-01 dV_dx=2.872392e-05 dV_dθ=-1.450055e-04 ||∇||=6.428610e-01 | Tr=0.9546]  25%|██▌       | 5/20 [00:25<01:09,  4.62s/it, CE=6.277162e-01 H=6.275999e-01 dV_dx=2.872392e-05 dV_dθ=-1.450055e-04 ||∇||=6.428610e-01 | Tr=0.9546] 25%|██▌       | 5/20 [00:32<01:09,  4.62s/it, CE=6.244128e-01 H=6.243732e-01 dV_dx=1.079349e-04 dV_dθ=-1.476013e-04 ||∇||=6.466647e-01 | Tr=0.9556 Te/Cur=0.9482 Te/Exp=0.7849] 30%|███       | 6/20 [00:32<01:14,  5.33s/it, CE=6.244128e-01 H=6.243732e-01 dV_dx=1.079349e-04 dV_dθ=-1.476013e-04 ||∇||=6.466647e-01 | Tr=0.9556 Te/Cur=0.9482 Te/Exp=0.7849] 30%|███       | 6/20 [00:36<01:14,  5.33s/it, CE=6.211708e-01 H=6.211295e-01 dV_dx=1.059564e-04 dV_dθ=-1.472925e-04 ||∇||=6.501933e-01 | Tr=0.9564]                             35%|███▌      | 7/20 [00:36<01:05,  5.03s/it, CE=6.211708e-01 H=6.211295e-01 dV_dx=1.059564e-04 dV_dθ=-1.472925e-04 ||∇||=6.501933e-01 | Tr=0.9564] 35%|███▌      | 7/20 [00:41<01:05,  5.03s/it, CE=6.180399e-01 H=6.179774e-01 dV_dx=8.697477e-05 dV_dθ=-1.494655e-04 ||∇||=6.541907e-01 | Tr=0.9573] 40%|████      | 8/20 [00:41<00:59,  4.97s/it, CE=6.180399e-01 H=6.179774e-01 dV_dx=8.697477e-05 dV_dθ=-1.494655e-04 ||∇||=6.541907e-01 | Tr=0.9573] 40%|████      | 8/20 [00:46<00:59,  4.97s/it, CE=6.149599e-01 H=6.147755e-01 dV_dx=-3.143395e-05 dV_dθ=-1.529490e-04 ||∇||=6.590054e-01 | Tr=0.9578] 45%|████▌     | 9/20 [00:46<00:54,  4.94s/it, CE=6.149599e-01 H=6.147755e-01 dV_dx=-3.143395e-05 dV_dθ=-1.529490e-04 ||∇||=6.590054e-01 | Tr=0.9578] 45%|████▌     | 9/20 [00:51<00:54,  4.94s/it, CE=6.119565e-01 H=6.119036e-01 dV_dx=1.023267e-04 dV_dθ=-1.552951e-04 ||∇||=6.622343e-01 | Tr=0.9583]  50%|█████     | 10/20 [00:51<00:48,  4.89s/it, CE=6.119565e-01 H=6.119036e-01 dV_dx=1.023267e-04 dV_dθ=-1.552951e-04 ||∇||=6.622343e-01 | Tr=0.9583] 50%|█████     | 10/20 [00:57<00:48,  4.89s/it, CE=6.089848e-01 H=6.087664e-01 dV_dx=-6.035961e-05 dV_dθ=-1.579474e-04 ||∇||=6.647868e-01 | Tr=0.9591 Te/Cur=0.9518 Te/Exp=0.7891] 55%|█████▌    | 11/20 [00:57<00:47,  5.25s/it, CE=6.089848e-01 H=6.087664e-01 dV_dx=-6.035961e-05 dV_dθ=-1.579474e-04 ||∇||=6.647868e-01 | Tr=0.9591 Te/Cur=0.9518 Te/Exp=0.7891] 55%|█████▌    | 11/20 [01:01<00:47,  5.25s/it, CE=6.061078e-01 H=6.060983e-01 dV_dx=1.519654e-04 dV_dθ=-1.614798e-04 ||∇||=6.696172e-01 | Tr=0.9596]                              60%|██████    | 12/20 [01:01<00:40,  5.02s/it, CE=6.061078e-01 H=6.060983e-01 dV_dx=1.519654e-04 dV_dθ=-1.614798e-04 ||∇||=6.696172e-01 | Tr=0.9596] 60%|██████    | 12/20 [01:06<00:40,  5.02s/it, CE=6.032814e-01 H=6.031095e-01 dV_dx=-7.866124e-06 dV_dθ=-1.640721e-04 ||∇||=6.739905e-01 | Tr=0.9602] 65%|██████▌   | 13/20 [01:06<00:34,  4.96s/it, CE=6.032814e-01 H=6.031095e-01 dV_dx=-7.866124e-06 dV_dθ=-1.640721e-04 ||∇||=6.739905e-01 | Tr=0.9602] 65%|██████▌   | 13/20 [01:11<00:34,  4.96s/it, CE=6.004929e-01 H=6.002856e-01 dV_dx=-3.667497e-05 dV_dθ=-1.706700e-04 ||∇||=6.798097e-01 | Tr=0.9609] 70%|███████   | 14/20 [01:11<00:29,  4.94s/it, CE=6.004929e-01 H=6.002856e-01 dV_dx=-3.667497e-05 dV_dθ=-1.706700e-04 ||∇||=6.798097e-01 | Tr=0.9609] 70%|███████   | 14/20 [01:16<00:29,  4.94s/it, CE=5.977544e-01 H=5.976683e-01 dV_dx=8.348477e-05 dV_dθ=-1.695349e-04 ||∇||=6.804515e-01 | Tr=0.9613]  75%|███████▌  | 15/20 [01:16<00:24,  4.86s/it, CE=5.977544e-01 H=5.976683e-01 dV_dx=8.348477e-05 dV_dθ=-1.695349e-04 ||∇||=6.804515e-01 | Tr=0.9613] 75%|███████▌  | 15/20 [01:23<00:24,  4.86s/it, CE=5.950584e-01 H=5.949609e-01 dV_dx=7.484421e-05 dV_dθ=-1.723651e-04 ||∇||=6.832605e-01 | Tr=0.9617 Te/Cur=0.9532 Te/Exp=0.7930] 80%|████████  | 16/20 [01:23<00:22,  5.51s/it, CE=5.950584e-01 H=5.949609e-01 dV_dx=7.484421e-05 dV_dθ=-1.723651e-04 ||∇||=6.832605e-01 | Tr=0.9617 Te/Cur=0.9532 Te/Exp=0.7930] 80%|████████  | 16/20 [01:28<00:22,  5.51s/it, CE=5.924433e-01 H=5.923283e-01 dV_dx=5.770873e-05 dV_dθ=-1.726953e-04 ||∇||=6.855915e-01 | Tr=0.9621]                             85%|████████▌ | 17/20 [01:28<00:15,  5.26s/it, CE=5.924433e-01 H=5.923283e-01 dV_dx=5.770873e-05 dV_dθ=-1.726953e-04 ||∇||=6.855915e-01 | Tr=0.9621] 85%|████████▌ | 17/20 [01:33<00:15,  5.26s/it, CE=5.898291e-01 H=5.895333e-01 dV_dx=-1.227448e-04 dV_dθ=-1.730487e-04 ||∇||=6.869813e-01 | Tr=0.9626] 90%|█████████ | 18/20 [01:33<00:10,  5.19s/it, CE=5.898291e-01 H=5.895333e-01 dV_dx=-1.227448e-04 dV_dθ=-1.730487e-04 ||∇||=6.869813e-01 | Tr=0.9626] 90%|█████████ | 18/20 [01:37<00:10,  5.19s/it, CE=5.873092e-01 H=5.870553e-01 dV_dx=-8.125993e-05 dV_dθ=-1.726432e-04 ||∇||=6.887694e-01 | Tr=0.9633] 95%|█████████▌| 19/20 [01:37<00:05,  5.02s/it, CE=5.873092e-01 H=5.870553e-01 dV_dx=-8.125993e-05 dV_dθ=-1.726432e-04 ||∇||=6.887694e-01 | Tr=0.9633] 95%|█████████▌| 19/20 [01:43<00:05,  5.02s/it, CE=5.848560e-01 H=5.847274e-01 dV_dx=5.013552e-05 dV_dθ=-1.787392e-04 ||∇||=6.929346e-01 | Tr=0.9639 Te/Cur=0.9540 Te/Exp=0.7974]100%|██████████| 20/20 [01:43<00:00,  5.41s/it, CE=5.848560e-01 H=5.847274e-01 dV_dx=5.013552e-05 dV_dθ=-1.787392e-04 ||∇||=6.929346e-01 | Tr=0.9639 Te/Cur=0.9540 Te/Exp=0.7974]100%|██████████| 20/20 [01:43<00:00,  5.20s/it, CE=5.848560e-01 H=5.847274e-01 dV_dx=5.013552e-05 dV_dθ=-1.787392e-04 ||∇||=6.929346e-01 | Tr=0.9639 Te/Cur=0.9540 Te/Exp=0.7974]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 1 final loss: 0.589957
======================================================================


  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.7966
    Task 1: 0.9547

============================================================
Task 2
============================================================
Initial loss on new task: 6.2024, previous: 0.5849, ratio: 10.60
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 2
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:11<?, ?it/s, CE=5.143440e-01 H=5.101043e-01 dV_dx=2.961969e-05 dV_dθ=-4.269301e-03 ||∇||=2.972581e+00 | Tr=0.3689 Te/Cur=0.5099 Te/Exp=0.8457]100%|██████████| 1/1 [00:11<00:00, 11.14s/it, CE=5.143440e-01 H=5.101043e-01 dV_dx=2.961969e-05 dV_dθ=-4.269301e-03 ||∇||=2.972581e+00 | Tr=0.3689 Te/Cur=0.5099 Te/Exp=0.8457]100%|██████████| 1/1 [00:11<00:00, 11.14s/it, CE=5.143440e-01 H=5.101043e-01 dV_dx=2.961969e-05 dV_dθ=-4.269301e-03 ||∇||=2.972581e+00 | Tr=0.3689 Te/Cur=0.5099 Te/Exp=0.8457]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.514344

[STEP 2] Architecture change decision
  Current: 0.514344, Previous: 0.584856
  Decision: KEEP
  No change - standard training
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:10<03:38, 10.39s/it]  5%|▍         | 1/22 [00:14<03:38, 10.39s/it, CE=4.284416e-01 H=4.290018e-01 dV_dx=1.930505e-05 dV_dθ=5.409660e-04 ||∇||=8.314608e-01 | Tr=0.6103]  9%|▉         | 2/22 [00:14<02:16,  6.82s/it, CE=4.284416e-01 H=4.290018e-01 dV_dx=1.930505e-05 dV_dθ=5.409660e-04 ||∇||=8.314608e-01 | Tr=0.6103]  9%|▉         | 2/22 [00:19<02:16,  6.82s/it, CE=4.172997e-01 H=4.175669e-01 dV_dx=-6.056780e-05 dV_dθ=3.277880e-04 ||∇||=8.251506e-01 | Tr=0.6509] 14%|█▎        | 3/22 [00:19<01:51,  5.89s/it, CE=4.172997e-01 H=4.175669e-01 dV_dx=-6.056780e-05 dV_dθ=3.277880e-04 ||∇||=8.251506e-01 | Tr=0.6509] 14%|█▎        | 3/22 [00:23<01:51,  5.89s/it, CE=4.080696e-01 H=4.082165e-01 dV_dx=-4.199854e-05 dV_dθ=1.889033e-04 ||∇||=8.193312e-01 | Tr=0.6795] 18%|█▊        | 4/22 [00:23<01:33,  5.20s/it, CE=4.080696e-01 H=4.082165e-01 dV_dx=-4.199854e-05 dV_dθ=1.889033e-04 ||∇||=8.193312e-01 | Tr=0.6795] 18%|█▊        | 4/22 [00:27<01:33,  5.20s/it, CE=4.010271e-01 H=4.010588e-01 dV_dx=8.200744e-07 dV_dθ=3.091761e-05 ||∇||=8.245508e-01 | Tr=0.7025]  23%|██▎       | 5/22 [00:27<01:22,  4.85s/it, CE=4.010271e-01 H=4.010588e-01 dV_dx=8.200744e-07 dV_dθ=3.091761e-05 ||∇||=8.245508e-01 | Tr=0.7025] 23%|██▎       | 5/22 [00:34<01:22,  4.85s/it, CE=3.951207e-01 H=3.949793e-01 dV_dx=-1.338200e-05 dV_dθ=-1.281046e-04 ||∇||=8.381601e-01 | Tr=0.7188 Te/Cur=0.7284 Te/Exp=0.8662] 27%|██▋       | 6/22 [00:34<01:24,  5.30s/it, CE=3.951207e-01 H=3.949793e-01 dV_dx=-1.338200e-05 dV_dθ=-1.281046e-04 ||∇||=8.381601e-01 | Tr=0.7188 Te/Cur=0.7284 Te/Exp=0.8662] 27%|██▋       | 6/22 [00:38<01:24,  5.30s/it, CE=3.901656e-01 H=3.898781e-01 dV_dx=-1.581002e-05 dV_dθ=-2.716628e-04 ||∇||=8.475585e-01 | Tr=0.7332]                             32%|███▏      | 7/22 [00:38<01:13,  4.89s/it, CE=3.901656e-01 H=3.898781e-01 dV_dx=-1.581002e-05 dV_dθ=-2.716628e-04 ||∇||=8.475585e-01 | Tr=0.7332] 32%|███▏      | 7/22 [00:42<01:13,  4.89s/it, CE=3.860246e-01 H=3.855622e-01 dV_dx=-6.677371e-05 dV_dθ=-3.956456e-04 ||∇||=8.567769e-01 | Tr=0.7456] 36%|███▋      | 8/22 [00:42<01:07,  4.80s/it, CE=3.860246e-01 H=3.855622e-01 dV_dx=-6.677371e-05 dV_dθ=-3.956456e-04 ||∇||=8.567769e-01 | Tr=0.7456] 36%|███▋      | 8/22 [00:47<01:07,  4.80s/it, CE=3.824021e-01 H=3.819384e-01 dV_dx=7.324543e-06 dV_dθ=-4.710804e-04 ||∇||=8.614903e-01 | Tr=0.7551]  41%|████      | 9/22 [00:47<01:01,  4.75s/it, CE=3.824021e-01 H=3.819384e-01 dV_dx=7.324543e-06 dV_dθ=-4.710804e-04 ||∇||=8.614903e-01 | Tr=0.7551] 41%|████      | 9/22 [00:51<01:01,  4.75s/it, CE=3.790411e-01 H=3.785602e-01 dV_dx=6.317786e-05 dV_dθ=-5.440572e-04 ||∇||=8.718565e-01 | Tr=0.7636] 45%|████▌     | 10/22 [00:51<00:55,  4.60s/it, CE=3.790411e-01 H=3.785602e-01 dV_dx=6.317786e-05 dV_dθ=-5.440572e-04 ||∇||=8.718565e-01 | Tr=0.7636] 45%|████▌     | 10/22 [00:57<00:55,  4.60s/it, CE=3.757709e-01 H=3.752757e-01 dV_dx=7.413524e-05 dV_dθ=-5.693151e-04 ||∇||=8.706983e-01 | Tr=0.7712 Te/Cur=0.7665 Te/Exp=0.8678] 50%|█████     | 11/22 [00:57<00:56,  5.14s/it, CE=3.757709e-01 H=3.752757e-01 dV_dx=7.413524e-05 dV_dθ=-5.693151e-04 ||∇||=8.706983e-01 | Tr=0.7712 Te/Cur=0.7665 Te/Exp=0.8678] 50%|█████     | 11/22 [01:02<00:56,  5.14s/it, CE=3.727339e-01 H=3.720444e-01 dV_dx=-6.014156e-05 dV_dθ=-6.293707e-04 ||∇||=8.773852e-01 | Tr=0.7773]                            55%|█████▍    | 12/22 [01:02<00:49,  4.99s/it, CE=3.727339e-01 H=3.720444e-01 dV_dx=-6.014156e-05 dV_dθ=-6.293707e-04 ||∇||=8.773852e-01 | Tr=0.7773] 55%|█████▍    | 12/22 [01:06<00:49,  4.99s/it, CE=3.697906e-01 H=3.690752e-01 dV_dx=-4.808176e-05 dV_dθ=-6.673108e-04 ||∇||=8.811744e-01 | Tr=0.7829] 59%|█████▉    | 13/22 [01:06<00:42,  4.77s/it, CE=3.697906e-01 H=3.690752e-01 dV_dx=-4.808176e-05 dV_dθ=-6.673108e-04 ||∇||=8.811744e-01 | Tr=0.7829] 59%|█████▉    | 13/22 [01:11<00:42,  4.77s/it, CE=3.669268e-01 H=3.661453e-01 dV_dx=-7.021462e-05 dV_dθ=-7.113407e-04 ||∇||=8.870933e-01 | Tr=0.7880] 64%|██████▎   | 14/22 [01:11<00:37,  4.70s/it, CE=3.669268e-01 H=3.661453e-01 dV_dx=-7.021462e-05 dV_dθ=-7.113407e-04 ||∇||=8.870933e-01 | Tr=0.7880] 64%|██████▎   | 14/22 [01:15<00:37,  4.70s/it, CE=3.642033e-01 H=3.634024e-01 dV_dx=-4.377366e-05 dV_dθ=-7.570886e-04 ||∇||=8.937774e-01 | Tr=0.7929] 68%|██████▊   | 15/22 [01:15<00:30,  4.36s/it, CE=3.642033e-01 H=3.634024e-01 dV_dx=-4.377366e-05 dV_dθ=-7.570886e-04 ||∇||=8.937774e-01 | Tr=0.7929] 68%|██████▊   | 15/22 [01:21<00:30,  4.36s/it, CE=3.616232e-01 H=3.608769e-01 dV_dx=3.070696e-05 dV_dθ=-7.770369e-04 ||∇||=8.972262e-01 | Tr=0.7974 Te/Cur=0.7906 Te/Exp=0.8685] 73%|███████▎  | 16/22 [01:21<00:29,  4.94s/it, CE=3.616232e-01 H=3.608769e-01 dV_dx=3.070696e-05 dV_dθ=-7.770369e-04 ||∇||=8.972262e-01 | Tr=0.7974 Te/Cur=0.7906 Te/Exp=0.8685] 73%|███████▎  | 16/22 [01:24<00:29,  4.94s/it, CE=3.591496e-01 H=3.582810e-01 dV_dx=-7.291483e-05 dV_dθ=-7.956157e-04 ||∇||=8.996157e-01 | Tr=0.8013]                            77%|███████▋  | 17/22 [01:24<00:22,  4.55s/it, CE=3.591496e-01 H=3.582810e-01 dV_dx=-7.291483e-05 dV_dθ=-7.956157e-04 ||∇||=8.996157e-01 | Tr=0.8013] 77%|███████▋  | 17/22 [01:29<00:22,  4.55s/it, CE=3.567217e-01 H=3.558626e-01 dV_dx=-2.394744e-05 dV_dθ=-8.351142e-04 ||∇||=9.074900e-01 | Tr=0.8052] 82%|████████▏ | 18/22 [01:29<00:18,  4.61s/it, CE=3.567217e-01 H=3.558626e-01 dV_dx=-2.394744e-05 dV_dθ=-8.351142e-04 ||∇||=9.074900e-01 | Tr=0.8052] 82%|████████▏ | 18/22 [01:34<00:18,  4.61s/it, CE=3.544697e-01 H=3.535699e-01 dV_dx=-4.393619e-05 dV_dθ=-8.558800e-04 ||∇||=9.102939e-01 | Tr=0.8084] 86%|████████▋ | 19/22 [01:34<00:13,  4.61s/it, CE=3.544697e-01 H=3.535699e-01 dV_dx=-4.393619e-05 dV_dθ=-8.558800e-04 ||∇||=9.102939e-01 | Tr=0.8084] 86%|████████▋ | 19/22 [01:38<00:13,  4.61s/it, CE=3.522387e-01 H=3.512899e-01 dV_dx=-6.211550e-05 dV_dθ=-8.867090e-04 ||∇||=9.164971e-01 | Tr=0.8116] 91%|█████████ | 20/22 [01:38<00:08,  4.42s/it, CE=3.522387e-01 H=3.512899e-01 dV_dx=-6.211550e-05 dV_dθ=-8.867090e-04 ||∇||=9.164971e-01 | Tr=0.8116] 91%|█████████ | 20/22 [01:44<00:08,  4.42s/it, CE=3.501318e-01 H=3.491423e-01 dV_dx=-6.225142e-05 dV_dθ=-9.272645e-04 ||∇||=9.268763e-01 | Tr=0.8147 Te/Cur=0.8054 Te/Exp=0.8804] 95%|█████████▌| 21/22 [01:44<00:04,  4.89s/it, CE=3.501318e-01 H=3.491423e-01 dV_dx=-6.225142e-05 dV_dθ=-9.272645e-04 ||∇||=9.268763e-01 | Tr=0.8147 Te/Cur=0.8054 Te/Exp=0.8804] 95%|█████████▌| 21/22 [01:50<00:04,  4.89s/it, CE=3.480936e-01 H=3.471026e-01 dV_dx=-2.489641e-05 dV_dθ=-9.661074e-04 ||∇||=9.349233e-01 | Tr=0.8174 Te/Cur=0.8088 Te/Exp=0.8709]100%|██████████| 22/22 [01:50<00:00,  5.31s/it, CE=3.480936e-01 H=3.471026e-01 dV_dx=-2.489641e-05 dV_dθ=-9.661074e-04 ||∇||=9.349233e-01 | Tr=0.8174 Te/Cur=0.8088 Te/Exp=0.8709]100%|██████████| 22/22 [01:50<00:00,  5.02s/it, CE=3.480936e-01 H=3.471026e-01 dV_dx=-2.489641e-05 dV_dθ=-9.661074e-04 ||∇||=9.349233e-01 | Tr=0.8174 Te/Cur=0.8088 Te/Exp=0.8709]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 2 final loss: 0.361623
======================================================================


  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.7931
    Task 1: 0.9553
    Task 2: 0.8083

============================================================
Task 3
============================================================
Initial loss on new task: 4.4721, previous: 0.3481, ratio: 12.85
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 3
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:12<?, ?it/s, CE=5.199502e-01 H=5.108938e-01 dV_dx=3.497083e-05 dV_dθ=-9.091363e-03 ||∇||=3.061671e+00 | Tr=0.3774 Te/Cur=0.4377 Te/Exp=0.8366]100%|██████████| 1/1 [00:12<00:00, 12.71s/it, CE=5.199502e-01 H=5.108938e-01 dV_dx=3.497083e-05 dV_dθ=-9.091363e-03 ||∇||=3.061671e+00 | Tr=0.3774 Te/Cur=0.4377 Te/Exp=0.8366]100%|██████████| 1/1 [00:12<00:00, 12.71s/it, CE=5.199502e-01 H=5.108938e-01 dV_dx=3.497083e-05 dV_dθ=-9.091363e-03 ||∇||=3.061671e+00 | Tr=0.3774 Te/Cur=0.4377 Te/Exp=0.8366]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.519950

[STEP 2] Architecture change decision
  Current: 0.519950, Previous: 0.348094
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9416 samples from 10 classes
  Created balanced validation set: 28667 samples from 10 classes
  Starting grid architecture search for task 3
  Baseline architecture: (4, [432, 552, 84, 10])
  Baseline loss: 0.519950
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.33s/it] 50%|█████     | 1/2 [00:12<00:09,  9.33s/it, CE=2.382042e+00 H=2.381947e+00 dV_dx=-1.816220e-06 dV_dθ=-9.335055e-05 ||∇||=2.814542e-01 | Tr=0.1046 Te/Cur=0.1184 Te/Exp=0.1460]100%|██████████| 2/2 [00:12<00:00,  5.42s/it, CE=2.382042e+00 H=2.381947e+00 dV_dx=-1.816220e-06 dV_dθ=-9.335055e-05 ||∇||=2.814542e-01 | Tr=0.1046 Te/Cur=0.1184 Te/Exp=0.1460]100%|██████████| 2/2 [00:12<00:00,  6.01s/it, CE=2.382042e+00 H=2.381947e+00 dV_dx=-1.816220e-06 dV_dθ=-9.335055e-05 ||∇||=2.814542e-01 | Tr=0.1046 Te/Cur=0.1184 Te/Exp=0.1460]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.382042124417916
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.46s/it] 50%|█████     | 1/2 [00:16<00:13, 13.46s/it, CE=2.381137e+00 H=2.381039e+00 dV_dx=-1.165145e-06 dV_dθ=-9.695892e-05 ||∇||=2.977583e-01 | Tr=0.0988 Te/Cur=0.0966 Te/Exp=0.1019]100%|██████████| 2/2 [00:16<00:00,  7.38s/it, CE=2.381137e+00 H=2.381039e+00 dV_dx=-1.165145e-06 dV_dθ=-9.695892e-05 ||∇||=2.977583e-01 | Tr=0.0988 Te/Cur=0.0966 Te/Exp=0.1019]100%|██████████| 2/2 [00:16<00:00,  8.29s/it, CE=2.381137e+00 H=2.381039e+00 dV_dx=-1.165145e-06 dV_dθ=-9.695892e-05 ||∇||=2.977583e-01 | Tr=0.0988 Te/Cur=0.0966 Te/Exp=0.1019]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 64, 10]) with loss 2.381137
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.37s/it] 50%|█████     | 1/2 [00:17<00:14, 14.37s/it, CE=2.371301e+00 H=2.371228e+00 dV_dx=1.805019e-06 dV_dθ=-7.465875e-05 ||∇||=2.746172e-01 | Tr=0.0944 Te/Cur=0.0962 Te/Exp=0.1354]100%|██████████| 2/2 [00:17<00:00,  7.68s/it, CE=2.371301e+00 H=2.371228e+00 dV_dx=1.805019e-06 dV_dθ=-7.465875e-05 ||∇||=2.746172e-01 | Tr=0.0944 Te/Cur=0.0962 Te/Exp=0.1354]100%|██████████| 2/2 [00:17<00:00,  8.68s/it, CE=2.371301e+00 H=2.371228e+00 dV_dx=1.805019e-06 dV_dθ=-7.465875e-05 ||∇||=2.746172e-01 | Tr=0.0944 Te/Cur=0.0962 Te/Exp=0.1354]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 64, 10]) with loss 2.371301
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.11s/it] 50%|█████     | 1/2 [00:09<00:07,  7.11s/it, CE=2.338669e+00 H=2.338586e+00 dV_dx=-2.571828e-07 dV_dθ=-8.217523e-05 ||∇||=2.748448e-01 | Tr=0.0948 Te/Cur=0.0978 Te/Exp=0.1049]100%|██████████| 2/2 [00:09<00:00,  4.54s/it, CE=2.338669e+00 H=2.338586e+00 dV_dx=-2.571828e-07 dV_dθ=-8.217523e-05 ||∇||=2.748448e-01 | Tr=0.0948 Te/Cur=0.0978 Te/Exp=0.1049]100%|██████████| 2/2 [00:09<00:00,  4.93s/it, CE=2.338669e+00 H=2.338586e+00 dV_dx=-2.571828e-07 dV_dθ=-8.217523e-05 ||∇||=2.748448e-01 | Tr=0.0948 Te/Cur=0.0978 Te/Exp=0.1049]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 84, 10]) with loss 2.338669
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.67s/it] 50%|█████     | 1/2 [00:10<00:07,  7.67s/it, CE=2.345299e+00 H=2.345212e+00 dV_dx=2.593346e-06 dV_dθ=-8.970812e-05 ||∇||=3.022035e-01 | Tr=0.1008 Te/Cur=0.0952 Te/Exp=0.1131]100%|██████████| 2/2 [00:10<00:00,  4.91s/it, CE=2.345299e+00 H=2.345212e+00 dV_dx=2.593346e-06 dV_dθ=-8.970812e-05 ||∇||=3.022035e-01 | Tr=0.1008 Te/Cur=0.0952 Te/Exp=0.1131]100%|██████████| 2/2 [00:10<00:00,  5.33s/it, CE=2.345299e+00 H=2.345212e+00 dV_dx=2.593346e-06 dV_dθ=-8.970812e-05 ||∇||=3.022035e-01 | Tr=0.1008 Te/Cur=0.0952 Te/Exp=0.1131]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.62s/it] 50%|█████     | 1/2 [00:17<00:14, 14.62s/it, CE=2.337971e+00 H=2.337899e+00 dV_dx=-5.162144e-07 dV_dθ=-7.138593e-05 ||∇||=2.678560e-01 | Tr=0.0944 Te/Cur=0.0957 Te/Exp=0.1085]100%|██████████| 2/2 [00:17<00:00,  7.68s/it, CE=2.337971e+00 H=2.337899e+00 dV_dx=-5.162144e-07 dV_dθ=-7.138593e-05 ||∇||=2.678560e-01 | Tr=0.0944 Te/Cur=0.0957 Te/Exp=0.1085]100%|██████████| 2/2 [00:17<00:00,  8.72s/it, CE=2.337971e+00 H=2.337899e+00 dV_dx=-5.162144e-07 dV_dθ=-7.138593e-05 ||∇||=2.678560e-01 | Tr=0.0944 Te/Cur=0.0957 Te/Exp=0.1085]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 84, 10]) with loss 2.337971
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.75s/it] 50%|█████     | 1/2 [00:16<00:13, 13.75s/it, CE=2.340549e+00 H=2.340470e+00 dV_dx=-1.810768e-07 dV_dθ=-7.859991e-05 ||∇||=2.895880e-01 | Tr=0.1100 Te/Cur=0.1178 Te/Exp=0.1507]100%|██████████| 2/2 [00:16<00:00,  7.07s/it, CE=2.340549e+00 H=2.340470e+00 dV_dx=-1.810768e-07 dV_dθ=-7.859991e-05 ||∇||=2.895880e-01 | Tr=0.1100 Te/Cur=0.1178 Te/Exp=0.1507]100%|██████████| 2/2 [00:16<00:00,  8.07s/it, CE=2.340549e+00 H=2.340470e+00 dV_dx=-1.810768e-07 dV_dθ=-7.859991e-05 ||∇||=2.895880e-01 | Tr=0.1100 Te/Cur=0.1178 Te/Exp=0.1507]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.61s/it] 50%|█████     | 1/2 [00:16<00:13, 13.61s/it, CE=2.342551e+00 H=2.342464e+00 dV_dx=-1.114087e-06 dV_dθ=-8.588573e-05 ||∇||=2.957659e-01 | Tr=0.0982 Te/Cur=0.1051 Te/Exp=0.1047]100%|██████████| 2/2 [00:16<00:00,  7.15s/it, CE=2.342551e+00 H=2.342464e+00 dV_dx=-1.114087e-06 dV_dθ=-8.588573e-05 ||∇||=2.957659e-01 | Tr=0.0982 Te/Cur=0.1051 Te/Exp=0.1047]100%|██████████| 2/2 [00:16<00:00,  8.11s/it, CE=2.342551e+00 H=2.342464e+00 dV_dx=-1.114087e-06 dV_dθ=-8.588573e-05 ||∇||=2.957659e-01 | Tr=0.0982 Te/Cur=0.1051 Te/Exp=0.1047]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.70s/it] 50%|█████     | 1/2 [00:17<00:14, 14.70s/it, CE=2.331066e+00 H=2.331004e+00 dV_dx=-4.166431e-07 dV_dθ=-6.150955e-05 ||∇||=2.564228e-01 | Tr=0.1487 Te/Cur=0.1532 Te/Exp=0.1349]100%|██████████| 2/2 [00:17<00:00,  7.55s/it, CE=2.331066e+00 H=2.331004e+00 dV_dx=-4.166431e-07 dV_dθ=-6.150955e-05 ||∇||=2.564228e-01 | Tr=0.1487 Te/Cur=0.1532 Te/Exp=0.1349]100%|██████████| 2/2 [00:17<00:00,  8.63s/it, CE=2.331066e+00 H=2.331004e+00 dV_dx=-4.166431e-07 dV_dθ=-6.150955e-05 ||∇||=2.564228e-01 | Tr=0.1487 Te/Cur=0.1532 Te/Exp=0.1349]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 104, 10]) with loss 2.331066
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.37s/it] 50%|█████     | 1/2 [00:09<00:07,  7.37s/it, CE=2.366493e+00 H=2.366400e+00 dV_dx=-4.615838e-06 dV_dθ=-8.837545e-05 ||∇||=3.072719e-01 | Tr=0.1047 Te/Cur=0.1206 Te/Exp=0.1533]100%|██████████| 2/2 [00:09<00:00,  4.53s/it, CE=2.366493e+00 H=2.366400e+00 dV_dx=-4.615838e-06 dV_dθ=-8.837545e-05 ||∇||=3.072719e-01 | Tr=0.1047 Te/Cur=0.1206 Te/Exp=0.1533]100%|██████████| 2/2 [00:09<00:00,  4.96s/it, CE=2.366493e+00 H=2.366400e+00 dV_dx=-4.615838e-06 dV_dθ=-8.837545e-05 ||∇||=3.072719e-01 | Tr=0.1047 Te/Cur=0.1206 Te/Exp=0.1533]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.76s/it] 50%|█████     | 1/2 [00:16<00:13, 13.76s/it, CE=2.369240e+00 H=2.369155e+00 dV_dx=4.882619e-06 dV_dθ=-8.996071e-05 ||∇||=3.203063e-01 | Tr=0.0968 Te/Cur=0.0979 Te/Exp=0.1504]100%|██████████| 2/2 [00:16<00:00,  7.18s/it, CE=2.369240e+00 H=2.369155e+00 dV_dx=4.882619e-06 dV_dθ=-8.996071e-05 ||∇||=3.203063e-01 | Tr=0.0968 Te/Cur=0.0979 Te/Exp=0.1504]100%|██████████| 2/2 [00:16<00:00,  8.17s/it, CE=2.369240e+00 H=2.369155e+00 dV_dx=4.882619e-06 dV_dθ=-8.996071e-05 ||∇||=3.203063e-01 | Tr=0.0968 Te/Cur=0.0979 Te/Exp=0.1504]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.49s/it] 50%|█████     | 1/2 [00:16<00:13, 13.49s/it, CE=2.374735e+00 H=2.374658e+00 dV_dx=1.694824e-06 dV_dθ=-7.824038e-05 ||∇||=3.123340e-01 | Tr=0.1017 Te/Cur=0.0992 Te/Exp=0.1324]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.374735e+00 H=2.374658e+00 dV_dx=1.694824e-06 dV_dθ=-7.824038e-05 ||∇||=3.123340e-01 | Tr=0.1017 Te/Cur=0.0992 Te/Exp=0.1324]100%|██████████| 2/2 [00:16<00:00,  8.15s/it, CE=2.374735e+00 H=2.374658e+00 dV_dx=1.694824e-06 dV_dθ=-7.824038e-05 ||∇||=3.123340e-01 | Tr=0.1017 Te/Cur=0.0992 Te/Exp=0.1324]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.01s/it] 50%|█████     | 1/2 [00:11<00:09,  9.01s/it, CE=2.327093e+00 H=2.326999e+00 dV_dx=-2.880624e-06 dV_dθ=-9.082711e-05 ||∇||=3.263612e-01 | Tr=0.1032 Te/Cur=0.1128 Te/Exp=0.1253]100%|██████████| 2/2 [00:11<00:00,  5.22s/it, CE=2.327093e+00 H=2.326999e+00 dV_dx=-2.880624e-06 dV_dθ=-9.082711e-05 ||∇||=3.263612e-01 | Tr=0.1032 Te/Cur=0.1128 Te/Exp=0.1253]100%|██████████| 2/2 [00:11<00:00,  5.79s/it, CE=2.327093e+00 H=2.326999e+00 dV_dx=-2.880624e-06 dV_dθ=-9.082711e-05 ||∇||=3.263612e-01 | Tr=0.1032 Te/Cur=0.1128 Te/Exp=0.1253]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 532, 84, 10]) with loss 2.327093
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.84s/it] 50%|█████     | 1/2 [00:10<00:07,  7.84s/it, CE=2.320680e+00 H=2.320599e+00 dV_dx=4.760240e-06 dV_dθ=-8.579085e-05 ||∇||=3.228437e-01 | Tr=0.0972 Te/Cur=0.0978 Te/Exp=0.1200]100%|██████████| 2/2 [00:10<00:00,  4.92s/it, CE=2.320680e+00 H=2.320599e+00 dV_dx=4.760240e-06 dV_dθ=-8.579085e-05 ||∇||=3.228437e-01 | Tr=0.0972 Te/Cur=0.0978 Te/Exp=0.1200]100%|██████████| 2/2 [00:10<00:00,  5.36s/it, CE=2.320680e+00 H=2.320599e+00 dV_dx=4.760240e-06 dV_dθ=-8.579085e-05 ||∇||=3.228437e-01 | Tr=0.0972 Te/Cur=0.0978 Te/Exp=0.1200]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 552, 84, 10]) with loss 2.320680
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.64s/it] 50%|█████     | 1/2 [00:16<00:13, 13.64s/it, CE=2.327899e+00 H=2.327822e+00 dV_dx=3.209993e-07 dV_dθ=-7.682886e-05 ||∇||=3.399510e-01 | Tr=0.0956 Te/Cur=0.0943 Te/Exp=0.1352]100%|██████████| 2/2 [00:16<00:00,  7.17s/it, CE=2.327899e+00 H=2.327822e+00 dV_dx=3.209993e-07 dV_dθ=-7.682886e-05 ||∇||=3.399510e-01 | Tr=0.0956 Te/Cur=0.0943 Te/Exp=0.1352]100%|██████████| 2/2 [00:16<00:00,  8.14s/it, CE=2.327899e+00 H=2.327822e+00 dV_dx=3.209993e-07 dV_dθ=-7.682886e-05 ||∇||=3.399510e-01 | Tr=0.0956 Te/Cur=0.0943 Te/Exp=0.1352]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.02s/it] 50%|█████     | 1/2 [00:17<00:13, 13.02s/it, CE=2.330259e+00 H=2.330173e+00 dV_dx=-1.823779e-06 dV_dθ=-8.393539e-05 ||∇||=3.275781e-01 | Tr=0.1051 Te/Cur=0.1181 Te/Exp=0.1942]100%|██████████| 2/2 [00:17<00:00,  7.89s/it, CE=2.330259e+00 H=2.330173e+00 dV_dx=-1.823779e-06 dV_dθ=-8.393539e-05 ||∇||=3.275781e-01 | Tr=0.1051 Te/Cur=0.1181 Te/Exp=0.1942]100%|██████████| 2/2 [00:17<00:00,  8.66s/it, CE=2.330259e+00 H=2.330173e+00 dV_dx=-1.823779e-06 dV_dθ=-8.393539e-05 ||∇||=3.275781e-01 | Tr=0.1051 Te/Cur=0.1181 Te/Exp=0.1942]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.67s/it] 50%|█████     | 1/2 [00:15<00:12, 12.67s/it, CE=2.333012e+00 H=2.332922e+00 dV_dx=-1.094751e-06 dV_dθ=-8.885156e-05 ||∇||=3.506909e-01 | Tr=0.1010 Te/Cur=0.1053 Te/Exp=0.1326]100%|██████████| 2/2 [00:15<00:00,  7.01s/it, CE=2.333012e+00 H=2.332922e+00 dV_dx=-1.094751e-06 dV_dθ=-8.885156e-05 ||∇||=3.506909e-01 | Tr=0.1010 Te/Cur=0.1053 Te/Exp=0.1326]100%|██████████| 2/2 [00:15<00:00,  7.86s/it, CE=2.333012e+00 H=2.332922e+00 dV_dx=-1.094751e-06 dV_dθ=-8.885156e-05 ||∇||=3.506909e-01 | Tr=0.1010 Te/Cur=0.1053 Te/Exp=0.1326]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.52s/it] 50%|█████     | 1/2 [00:16<00:13, 13.52s/it, CE=2.320285e+00 H=2.320219e+00 dV_dx=-1.926597e-06 dV_dθ=-6.444465e-05 ||∇||=3.296819e-01 | Tr=0.1122 Te/Cur=0.1190 Te/Exp=0.1515]100%|██████████| 2/2 [00:16<00:00,  7.19s/it, CE=2.320285e+00 H=2.320219e+00 dV_dx=-1.926597e-06 dV_dθ=-6.444465e-05 ||∇||=3.296819e-01 | Tr=0.1122 Te/Cur=0.1190 Te/Exp=0.1515]100%|██████████| 2/2 [00:16<00:00,  8.14s/it, CE=2.320285e+00 H=2.320219e+00 dV_dx=-1.926597e-06 dV_dθ=-6.444465e-05 ||∇||=3.296819e-01 | Tr=0.1122 Te/Cur=0.1190 Te/Exp=0.1515]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 104, 10]) with loss 2.320285
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.68s/it] 50%|█████     | 1/2 [00:09<00:06,  6.68s/it, CE=2.341392e+00 H=2.341301e+00 dV_dx=2.226817e-06 dV_dθ=-9.324078e-05 ||∇||=3.585500e-01 | Tr=0.1078 Te/Cur=0.1204 Te/Exp=0.1947]100%|██████████| 2/2 [00:09<00:00,  4.50s/it, CE=2.341392e+00 H=2.341301e+00 dV_dx=2.226817e-06 dV_dθ=-9.324078e-05 ||∇||=3.585500e-01 | Tr=0.1078 Te/Cur=0.1204 Te/Exp=0.1947]100%|██████████| 2/2 [00:09<00:00,  4.83s/it, CE=2.341392e+00 H=2.341301e+00 dV_dx=2.226817e-06 dV_dθ=-9.324078e-05 ||∇||=3.585500e-01 | Tr=0.1078 Te/Cur=0.1204 Te/Exp=0.1947]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.95s/it] 50%|█████     | 1/2 [00:18<00:14, 14.95s/it, CE=2.351440e+00 H=2.351342e+00 dV_dx=-1.896981e-06 dV_dθ=-9.628078e-05 ||∇||=3.714495e-01 | Tr=0.0980 Te/Cur=0.0952 Te/Exp=0.1839]100%|██████████| 2/2 [00:18<00:00,  8.09s/it, CE=2.351440e+00 H=2.351342e+00 dV_dx=-1.896981e-06 dV_dθ=-9.628078e-05 ||∇||=3.714495e-01 | Tr=0.0980 Te/Cur=0.0952 Te/Exp=0.1839]100%|██████████| 2/2 [00:18<00:00,  9.11s/it, CE=2.351440e+00 H=2.351342e+00 dV_dx=-1.896981e-06 dV_dθ=-9.628078e-05 ||∇||=3.714495e-01 | Tr=0.0980 Te/Cur=0.0952 Te/Exp=0.1839]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.17s/it] 50%|█████     | 1/2 [00:16<00:13, 13.17s/it, CE=2.333651e+00 H=2.333551e+00 dV_dx=-4.672337e-06 dV_dθ=-9.553187e-05 ||∇||=3.653431e-01 | Tr=0.1200 Te/Cur=0.1244 Te/Exp=0.1503]100%|██████████| 2/2 [00:16<00:00,  7.33s/it, CE=2.333651e+00 H=2.333551e+00 dV_dx=-4.672337e-06 dV_dθ=-9.553187e-05 ||∇||=3.653431e-01 | Tr=0.1200 Te/Cur=0.1244 Te/Exp=0.1503]100%|██████████| 2/2 [00:16<00:00,  8.21s/it, CE=2.333651e+00 H=2.333551e+00 dV_dx=-4.672337e-06 dV_dθ=-9.553187e-05 ||∇||=3.653431e-01 | Tr=0.1200 Te/Cur=0.1244 Te/Exp=0.1503]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.27s/it] 50%|█████     | 1/2 [00:10<00:07,  7.27s/it, CE=2.298689e+00 H=2.298596e+00 dV_dx=-2.029318e-06 dV_dθ=-9.146624e-05 ||∇||=3.888530e-01 | Tr=0.1015 Te/Cur=0.0961 Te/Exp=0.1502]100%|██████████| 2/2 [00:10<00:00,  4.68s/it, CE=2.298689e+00 H=2.298596e+00 dV_dx=-2.029318e-06 dV_dθ=-9.146624e-05 ||∇||=3.888530e-01 | Tr=0.1015 Te/Cur=0.0961 Te/Exp=0.1502]100%|██████████| 2/2 [00:10<00:00,  5.07s/it, CE=2.298689e+00 H=2.298596e+00 dV_dx=-2.029318e-06 dV_dθ=-9.146624e-05 ||∇||=3.888530e-01 | Tr=0.1015 Te/Cur=0.0961 Te/Exp=0.1502]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 532, 84, 10]) with loss 2.298689
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.82s/it] 50%|█████     | 1/2 [00:11<00:07,  7.82s/it, CE=2.306440e+00 H=2.306338e+00 dV_dx=-3.872366e-06 dV_dθ=-9.752165e-05 ||∇||=3.995557e-01 | Tr=0.1048 Te/Cur=0.1018 Te/Exp=0.1752]100%|██████████| 2/2 [00:11<00:00,  5.54s/it, CE=2.306440e+00 H=2.306338e+00 dV_dx=-3.872366e-06 dV_dθ=-9.752165e-05 ||∇||=3.995557e-01 | Tr=0.1048 Te/Cur=0.1018 Te/Exp=0.1752]100%|██████████| 2/2 [00:11<00:00,  5.89s/it, CE=2.306440e+00 H=2.306338e+00 dV_dx=-3.872366e-06 dV_dθ=-9.752165e-05 ||∇||=3.995557e-01 | Tr=0.1048 Te/Cur=0.1018 Te/Exp=0.1752]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.65s/it] 50%|█████     | 1/2 [00:16<00:13, 13.65s/it, CE=2.302637e+00 H=2.302542e+00 dV_dx=-5.420974e-06 dV_dθ=-8.916645e-05 ||∇||=4.002542e-01 | Tr=0.0964 Te/Cur=0.0963 Te/Exp=0.2082]100%|██████████| 2/2 [00:16<00:00,  7.18s/it, CE=2.302637e+00 H=2.302542e+00 dV_dx=-5.420974e-06 dV_dθ=-8.916645e-05 ||∇||=4.002542e-01 | Tr=0.0964 Te/Cur=0.0963 Te/Exp=0.2082]100%|██████████| 2/2 [00:16<00:00,  8.15s/it, CE=2.302637e+00 H=2.302542e+00 dV_dx=-5.420974e-06 dV_dθ=-8.916645e-05 ||∇||=4.002542e-01 | Tr=0.0964 Te/Cur=0.0963 Te/Exp=0.2082]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.55s/it] 50%|█████     | 1/2 [00:15<00:12, 12.55s/it, CE=2.306788e+00 H=2.306700e+00 dV_dx=-4.646572e-08 dV_dθ=-8.857645e-05 ||∇||=4.066286e-01 | Tr=0.1597 Te/Cur=0.1693 Te/Exp=0.1627]100%|██████████| 2/2 [00:15<00:00,  6.73s/it, CE=2.306788e+00 H=2.306700e+00 dV_dx=-4.646572e-08 dV_dθ=-8.857645e-05 ||∇||=4.066286e-01 | Tr=0.1597 Te/Cur=0.1693 Te/Exp=0.1627]100%|██████████| 2/2 [00:15<00:00,  7.61s/it, CE=2.306788e+00 H=2.306700e+00 dV_dx=-4.646572e-08 dV_dθ=-8.857645e-05 ||∇||=4.066286e-01 | Tr=0.1597 Te/Cur=0.1693 Te/Exp=0.1627]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.19s/it] 50%|█████     | 1/2 [00:15<00:13, 13.19s/it, CE=2.309493e+00 H=2.309384e+00 dV_dx=-1.736686e-06 dV_dθ=-1.066351e-04 ||∇||=4.185736e-01 | Tr=0.1010 Te/Cur=0.1049 Te/Exp=0.1825]100%|██████████| 2/2 [00:15<00:00,  6.82s/it, CE=2.309493e+00 H=2.309384e+00 dV_dx=-1.736686e-06 dV_dθ=-1.066351e-04 ||∇||=4.185736e-01 | Tr=0.1010 Te/Cur=0.1049 Te/Exp=0.1825]100%|██████████| 2/2 [00:15<00:00,  7.78s/it, CE=2.309493e+00 H=2.309384e+00 dV_dx=-1.736686e-06 dV_dθ=-1.066351e-04 ||∇||=4.185736e-01 | Tr=0.1010 Te/Cur=0.1049 Te/Exp=0.1825]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.05s/it] 50%|█████     | 1/2 [00:17<00:14, 14.05s/it, CE=2.296068e+00 H=2.295983e+00 dV_dx=2.308040e-06 dV_dθ=-8.693253e-05 ||∇||=4.113103e-01 | Tr=0.1368 Te/Cur=0.1544 Te/Exp=0.1685]100%|██████████| 2/2 [00:17<00:00,  7.63s/it, CE=2.296068e+00 H=2.295983e+00 dV_dx=2.308040e-06 dV_dθ=-8.693253e-05 ||∇||=4.113103e-01 | Tr=0.1368 Te/Cur=0.1544 Te/Exp=0.1685]100%|██████████| 2/2 [00:17<00:00,  8.59s/it, CE=2.296068e+00 H=2.295983e+00 dV_dx=2.308040e-06 dV_dθ=-8.693253e-05 ||∇||=4.113103e-01 | Tr=0.1368 Te/Cur=0.1544 Te/Exp=0.1685]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 572, 104, 10]) with loss 2.296068
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.95s/it] 50%|█████     | 1/2 [00:07<00:04,  4.95s/it, CE=2.241912e+00 H=2.241858e+00 dV_dx=1.044589e-06 dV_dθ=-5.499293e-05 ||∇||=6.270252e-01 | Tr=0.1145 Te/Cur=0.1110 Te/Exp=0.2434]100%|██████████| 2/2 [00:07<00:00,  3.76s/it, CE=2.241912e+00 H=2.241858e+00 dV_dx=1.044589e-06 dV_dθ=-5.499293e-05 ||∇||=6.270252e-01 | Tr=0.1145 Te/Cur=0.1110 Te/Exp=0.2434]100%|██████████| 2/2 [00:07<00:00,  3.94s/it, CE=2.241912e+00 H=2.241858e+00 dV_dx=1.044589e-06 dV_dθ=-5.499293e-05 ||∇||=6.270252e-01 | Tr=0.1145 Te/Cur=0.1110 Te/Exp=0.2434]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2419116760363145
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.99s/it] 50%|█████     | 1/2 [00:07<00:04,  4.99s/it, CE=2.292719e+00 H=2.292507e+00 dV_dx=3.526996e-06 dV_dθ=-2.156851e-04 ||∇||=6.837060e-01 | Tr=0.0951 Te/Cur=0.0951 Te/Exp=0.1456]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.292719e+00 H=2.292507e+00 dV_dx=3.526996e-06 dV_dθ=-2.156851e-04 ||∇||=6.837060e-01 | Tr=0.0951 Te/Cur=0.0951 Te/Exp=0.1456]100%|██████████| 2/2 [00:07<00:00,  3.90s/it, CE=2.292719e+00 H=2.292507e+00 dV_dx=3.526996e-06 dV_dθ=-2.156851e-04 ||∇||=6.837060e-01 | Tr=0.0951 Te/Cur=0.0951 Te/Exp=0.1456]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.95s/it] 50%|█████     | 1/2 [00:16<00:13, 13.95s/it, CE=2.266096e+00 H=2.265897e+00 dV_dx=3.430520e-06 dV_dθ=-2.032278e-04 ||∇||=7.248659e-01 | Tr=0.1176 Te/Cur=0.1017 Te/Exp=0.1938]100%|██████████| 2/2 [00:16<00:00,  7.52s/it, CE=2.266096e+00 H=2.265897e+00 dV_dx=3.430520e-06 dV_dθ=-2.032278e-04 ||∇||=7.248659e-01 | Tr=0.1176 Te/Cur=0.1017 Te/Exp=0.1938]100%|██████████| 2/2 [00:16<00:00,  8.48s/it, CE=2.266096e+00 H=2.265897e+00 dV_dx=3.430520e-06 dV_dθ=-2.032278e-04 ||∇||=7.248659e-01 | Tr=0.1176 Te/Cur=0.1017 Te/Exp=0.1938]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.18s/it] 50%|█████     | 1/2 [00:08<00:06,  6.18s/it, CE=2.244877e+00 H=2.244585e+00 dV_dx=-2.248468e-06 dV_dθ=-2.906854e-04 ||∇||=8.003464e-01 | Tr=0.1003 Te/Cur=0.1101 Te/Exp=0.2766]100%|██████████| 2/2 [00:08<00:00,  4.10s/it, CE=2.244877e+00 H=2.244585e+00 dV_dx=-2.248468e-06 dV_dθ=-2.906854e-04 ||∇||=8.003464e-01 | Tr=0.1003 Te/Cur=0.1101 Te/Exp=0.2766]100%|██████████| 2/2 [00:08<00:00,  4.41s/it, CE=2.244877e+00 H=2.244585e+00 dV_dx=-2.248468e-06 dV_dθ=-2.906854e-04 ||∇||=8.003464e-01 | Tr=0.1003 Te/Cur=0.1101 Te/Exp=0.2766]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.93s/it] 50%|█████     | 1/2 [00:07<00:04,  4.93s/it, CE=2.185755e+00 H=2.185688e+00 dV_dx=-2.096623e-05 dV_dθ=-4.527327e-05 ||∇||=6.810510e-01 | Tr=0.1141 Te/Cur=0.1082 Te/Exp=0.3072]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.185755e+00 H=2.185688e+00 dV_dx=-2.096623e-05 dV_dθ=-4.527327e-05 ||∇||=6.810510e-01 | Tr=0.1141 Te/Cur=0.1082 Te/Exp=0.3072]100%|██████████| 2/2 [00:07<00:00,  3.85s/it, CE=2.185755e+00 H=2.185688e+00 dV_dx=-2.096623e-05 dV_dθ=-4.527327e-05 ||∇||=6.810510e-01 | Tr=0.1141 Te/Cur=0.1082 Te/Exp=0.3072]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 104, 10]) with loss 2.185755
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.87s/it] 50%|█████     | 1/2 [00:16<00:13, 13.87s/it, CE=2.211464e+00 H=2.211368e+00 dV_dx=-2.722374e-06 dV_dθ=-9.340056e-05 ||∇||=6.708428e-01 | Tr=0.1061 Te/Cur=0.1215 Te/Exp=0.3243]100%|██████████| 2/2 [00:16<00:00,  7.21s/it, CE=2.211464e+00 H=2.211368e+00 dV_dx=-2.722374e-06 dV_dθ=-9.340056e-05 ||∇||=6.708428e-01 | Tr=0.1061 Te/Cur=0.1215 Te/Exp=0.3243]100%|██████████| 2/2 [00:16<00:00,  8.21s/it, CE=2.211464e+00 H=2.211368e+00 dV_dx=-2.722374e-06 dV_dθ=-9.340056e-05 ||∇||=6.708428e-01 | Tr=0.1061 Te/Cur=0.1215 Te/Exp=0.3243]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.59s/it] 50%|█████     | 1/2 [00:17<00:13, 13.59s/it, CE=2.212968e+00 H=2.212884e+00 dV_dx=1.425935e-07 dV_dθ=-8.459278e-05 ||∇||=7.169281e-01 | Tr=0.1123 Te/Cur=0.1082 Te/Exp=0.3105]100%|██████████| 2/2 [00:17<00:00,  7.60s/it, CE=2.212968e+00 H=2.212884e+00 dV_dx=1.425935e-07 dV_dθ=-8.459278e-05 ||∇||=7.169281e-01 | Tr=0.1123 Te/Cur=0.1082 Te/Exp=0.3105]100%|██████████| 2/2 [00:17<00:00,  8.50s/it, CE=2.212968e+00 H=2.212884e+00 dV_dx=1.425935e-07 dV_dθ=-8.459278e-05 ||∇||=7.169281e-01 | Tr=0.1123 Te/Cur=0.1082 Te/Exp=0.3105]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.87s/it] 50%|█████     | 1/2 [00:17<00:14, 14.87s/it, CE=2.221588e+00 H=2.221621e+00 dV_dx=9.913913e-06 dV_dθ=2.241701e-05 ||∇||=6.496764e-01 | Tr=0.1122 Te/Cur=0.1094 Te/Exp=0.2832]100%|██████████| 2/2 [00:17<00:00,  7.57s/it, CE=2.221588e+00 H=2.221621e+00 dV_dx=9.913913e-06 dV_dθ=2.241701e-05 ||∇||=6.496764e-01 | Tr=0.1122 Te/Cur=0.1094 Te/Exp=0.2832]100%|██████████| 2/2 [00:17<00:00,  8.67s/it, CE=2.221588e+00 H=2.221621e+00 dV_dx=9.913913e-06 dV_dθ=2.241701e-05 ||∇||=6.496764e-01 | Tr=0.1122 Te/Cur=0.1094 Te/Exp=0.2832]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 14.00s/it] 50%|█████     | 1/2 [00:16<00:13, 14.00s/it, CE=2.201574e+00 H=2.201438e+00 dV_dx=-2.082631e-06 dV_dθ=-1.339107e-04 ||∇||=7.664654e-01 | Tr=0.1215 Te/Cur=0.1294 Te/Exp=0.3209]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.201574e+00 H=2.201438e+00 dV_dx=-2.082631e-06 dV_dθ=-1.339107e-04 ||∇||=7.664654e-01 | Tr=0.1215 Te/Cur=0.1294 Te/Exp=0.3209]100%|██████████| 2/2 [00:16<00:00,  8.38s/it, CE=2.201574e+00 H=2.201438e+00 dV_dx=-2.082631e-06 dV_dθ=-1.339107e-04 ||∇||=7.664654e-01 | Tr=0.1215 Te/Cur=0.1294 Te/Exp=0.3209]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.53s/it] 50%|█████     | 1/2 [00:07<00:04,  4.53s/it, CE=2.264320e+00 H=2.264251e+00 dV_dx=-3.555596e-06 dV_dθ=-6.460951e-05 ||∇||=4.830708e-01 | Tr=0.1137 Te/Cur=0.1090 Te/Exp=0.2396]100%|██████████| 2/2 [00:07<00:00,  3.36s/it, CE=2.264320e+00 H=2.264251e+00 dV_dx=-3.555596e-06 dV_dθ=-6.460951e-05 ||∇||=4.830708e-01 | Tr=0.1137 Te/Cur=0.1090 Te/Exp=0.2396]100%|██████████| 2/2 [00:07<00:00,  3.54s/it, CE=2.264320e+00 H=2.264251e+00 dV_dx=-3.555596e-06 dV_dθ=-6.460951e-05 ||∇||=4.830708e-01 | Tr=0.1137 Te/Cur=0.1090 Te/Exp=0.2396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.75s/it] 50%|█████     | 1/2 [00:07<00:04,  4.75s/it, CE=2.297789e+00 H=2.297664e+00 dV_dx=5.174878e-06 dV_dθ=-1.294713e-04 ||∇||=5.609120e-01 | Tr=0.0951 Te/Cur=0.0932 Te/Exp=0.1920]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.297789e+00 H=2.297664e+00 dV_dx=5.174878e-06 dV_dθ=-1.294713e-04 ||∇||=5.609120e-01 | Tr=0.0951 Te/Cur=0.0932 Te/Exp=0.1920]100%|██████████| 2/2 [00:07<00:00,  3.89s/it, CE=2.297789e+00 H=2.297664e+00 dV_dx=5.174878e-06 dV_dθ=-1.294713e-04 ||∇||=5.609120e-01 | Tr=0.0951 Te/Cur=0.0932 Te/Exp=0.1920]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.69s/it] 50%|█████     | 1/2 [00:17<00:14, 14.69s/it, CE=2.268969e+00 H=2.268787e+00 dV_dx=4.222405e-06 dV_dθ=-1.857619e-04 ||∇||=6.151466e-01 | Tr=0.0974 Te/Cur=0.0799 Te/Exp=0.2180]100%|██████████| 2/2 [00:17<00:00,  7.83s/it, CE=2.268969e+00 H=2.268787e+00 dV_dx=4.222405e-06 dV_dθ=-1.857619e-04 ||∇||=6.151466e-01 | Tr=0.0974 Te/Cur=0.0799 Te/Exp=0.2180]100%|██████████| 2/2 [00:17<00:00,  8.86s/it, CE=2.268969e+00 H=2.268787e+00 dV_dx=4.222405e-06 dV_dθ=-1.857619e-04 ||∇||=6.151466e-01 | Tr=0.0974 Te/Cur=0.0799 Te/Exp=0.2180]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.75s/it] 50%|█████     | 1/2 [00:07<00:04,  4.75s/it, CE=2.249403e+00 H=2.249287e+00 dV_dx=-6.884275e-07 dV_dθ=-1.159893e-04 ||∇||=5.782041e-01 | Tr=0.1121 Te/Cur=0.1086 Te/Exp=0.2992]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.249403e+00 H=2.249287e+00 dV_dx=-6.884275e-07 dV_dθ=-1.159893e-04 ||∇||=5.782041e-01 | Tr=0.1121 Te/Cur=0.1086 Te/Exp=0.2992]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.249403e+00 H=2.249287e+00 dV_dx=-6.884275e-07 dV_dθ=-1.159893e-04 ||∇||=5.782041e-01 | Tr=0.1121 Te/Cur=0.1086 Te/Exp=0.2992]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.57s/it] 50%|█████     | 1/2 [00:07<00:04,  4.57s/it, CE=2.224136e+00 H=2.224169e+00 dV_dx=1.517328e-05 dV_dθ=1.795515e-05 ||∇||=5.088731e-01 | Tr=0.1543 Te/Cur=0.1144 Te/Exp=0.2611]100%|██████████| 2/2 [00:07<00:00,  3.47s/it, CE=2.224136e+00 H=2.224169e+00 dV_dx=1.517328e-05 dV_dθ=1.795515e-05 ||∇||=5.088731e-01 | Tr=0.1543 Te/Cur=0.1144 Te/Exp=0.2611]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.224136e+00 H=2.224169e+00 dV_dx=1.517328e-05 dV_dθ=1.795515e-05 ||∇||=5.088731e-01 | Tr=0.1543 Te/Cur=0.1144 Te/Exp=0.2611]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.91s/it] 50%|█████     | 1/2 [00:15<00:12, 12.91s/it, CE=2.224035e+00 H=2.223991e+00 dV_dx=-6.970344e-06 dV_dθ=-3.654264e-05 ||∇||=5.070937e-01 | Tr=0.1161 Te/Cur=0.1092 Te/Exp=0.3232]100%|██████████| 2/2 [00:15<00:00,  7.09s/it, CE=2.224035e+00 H=2.223991e+00 dV_dx=-6.970344e-06 dV_dθ=-3.654264e-05 ||∇||=5.070937e-01 | Tr=0.1161 Te/Cur=0.1092 Te/Exp=0.3232]100%|██████████| 2/2 [00:15<00:00,  7.96s/it, CE=2.224035e+00 H=2.223991e+00 dV_dx=-6.970344e-06 dV_dθ=-3.654264e-05 ||∇||=5.070937e-01 | Tr=0.1161 Te/Cur=0.1092 Te/Exp=0.3232]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.31s/it] 50%|█████     | 1/2 [00:18<00:13, 13.31s/it, CE=2.218544e+00 H=2.218536e+00 dV_dx=1.173080e-05 dV_dθ=-2.019669e-05 ||∇||=5.207536e-01 | Tr=0.1075 Te/Cur=0.1090 Te/Exp=0.3071]100%|██████████| 2/2 [00:18<00:00,  8.28s/it, CE=2.218544e+00 H=2.218536e+00 dV_dx=1.173080e-05 dV_dθ=-2.019669e-05 ||∇||=5.207536e-01 | Tr=0.1075 Te/Cur=0.1090 Te/Exp=0.3071]100%|██████████| 2/2 [00:18<00:00,  9.03s/it, CE=2.218544e+00 H=2.218536e+00 dV_dx=1.173080e-05 dV_dθ=-2.019669e-05 ||∇||=5.207536e-01 | Tr=0.1075 Te/Cur=0.1090 Te/Exp=0.3071]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.19s/it] 50%|█████     | 1/2 [00:16<00:13, 13.19s/it, CE=2.218703e+00 H=2.218672e+00 dV_dx=2.592567e-06 dV_dθ=-3.368279e-05 ||∇||=4.926389e-01 | Tr=0.1057 Te/Cur=0.1029 Te/Exp=0.3167]100%|██████████| 2/2 [00:16<00:00,  7.23s/it, CE=2.218703e+00 H=2.218672e+00 dV_dx=2.592567e-06 dV_dθ=-3.368279e-05 ||∇||=4.926389e-01 | Tr=0.1057 Te/Cur=0.1029 Te/Exp=0.3167]100%|██████████| 2/2 [00:16<00:00,  8.13s/it, CE=2.218703e+00 H=2.218672e+00 dV_dx=2.592567e-06 dV_dθ=-3.368279e-05 ||∇||=4.926389e-01 | Tr=0.1057 Te/Cur=0.1029 Te/Exp=0.3167]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.42s/it] 50%|█████     | 1/2 [00:16<00:13, 13.42s/it, CE=2.210579e+00 H=2.210554e+00 dV_dx=-3.597958e-06 dV_dθ=-2.110993e-05 ||∇||=5.228998e-01 | Tr=0.1125 Te/Cur=0.1098 Te/Exp=0.3671]100%|██████████| 2/2 [00:16<00:00,  7.42s/it, CE=2.210579e+00 H=2.210554e+00 dV_dx=-3.597958e-06 dV_dθ=-2.110993e-05 ||∇||=5.228998e-01 | Tr=0.1125 Te/Cur=0.1098 Te/Exp=0.3671]100%|██████████| 2/2 [00:16<00:00,  8.32s/it, CE=2.210579e+00 H=2.210554e+00 dV_dx=-3.597958e-06 dV_dθ=-2.110993e-05 ||∇||=5.228998e-01 | Tr=0.1125 Te/Cur=0.1098 Te/Exp=0.3671]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.62s/it] 50%|█████     | 1/2 [00:07<00:04,  4.62s/it, CE=2.300082e+00 H=2.299960e+00 dV_dx=1.365805e-06 dV_dθ=-1.228780e-04 ||∇||=4.333253e-01 | Tr=0.0957 Te/Cur=0.1132 Te/Exp=0.2196]100%|██████████| 2/2 [00:07<00:00,  3.61s/it, CE=2.300082e+00 H=2.299960e+00 dV_dx=1.365805e-06 dV_dθ=-1.228780e-04 ||∇||=4.333253e-01 | Tr=0.0957 Te/Cur=0.1132 Te/Exp=0.2196]100%|██████████| 2/2 [00:07<00:00,  3.76s/it, CE=2.300082e+00 H=2.299960e+00 dV_dx=1.365805e-06 dV_dθ=-1.228780e-04 ||∇||=4.333253e-01 | Tr=0.0957 Te/Cur=0.1132 Te/Exp=0.2196]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.19s/it] 50%|█████     | 1/2 [00:07<00:04,  4.19s/it, CE=2.294668e+00 H=2.294571e+00 dV_dx=-1.478016e-05 dV_dθ=-8.218171e-05 ||∇||=4.191260e-01 | Tr=0.0941 Te/Cur=0.0979 Te/Exp=0.1506]100%|██████████| 2/2 [00:07<00:00,  3.46s/it, CE=2.294668e+00 H=2.294571e+00 dV_dx=-1.478016e-05 dV_dθ=-8.218171e-05 ||∇||=4.191260e-01 | Tr=0.0941 Te/Cur=0.0979 Te/Exp=0.1506]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.294668e+00 H=2.294571e+00 dV_dx=-1.478016e-05 dV_dθ=-8.218171e-05 ||∇||=4.191260e-01 | Tr=0.0941 Te/Cur=0.0979 Te/Exp=0.1506]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.68s/it] 50%|█████     | 1/2 [00:17<00:14, 14.68s/it, CE=2.288248e+00 H=2.288163e+00 dV_dx=3.988895e-06 dV_dθ=-8.848805e-05 ||∇||=4.762711e-01 | Tr=0.0953 Te/Cur=0.0956 Te/Exp=0.1298]100%|██████████| 2/2 [00:17<00:00,  7.68s/it, CE=2.288248e+00 H=2.288163e+00 dV_dx=3.988895e-06 dV_dθ=-8.848805e-05 ||∇||=4.762711e-01 | Tr=0.0953 Te/Cur=0.0956 Te/Exp=0.1298]100%|██████████| 2/2 [00:17<00:00,  8.73s/it, CE=2.288248e+00 H=2.288163e+00 dV_dx=3.988895e-06 dV_dθ=-8.848805e-05 ||∇||=4.762711e-01 | Tr=0.0953 Te/Cur=0.0956 Te/Exp=0.1298]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.07s/it] 50%|█████     | 1/2 [00:06<00:04,  4.07s/it, CE=2.253642e+00 H=2.253590e+00 dV_dx=-1.847151e-06 dV_dθ=-5.058280e-05 ||∇||=4.486168e-01 | Tr=0.1135 Te/Cur=0.1076 Te/Exp=0.2621]100%|██████████| 2/2 [00:06<00:00,  3.26s/it, CE=2.253642e+00 H=2.253590e+00 dV_dx=-1.847151e-06 dV_dθ=-5.058280e-05 ||∇||=4.486168e-01 | Tr=0.1135 Te/Cur=0.1076 Te/Exp=0.2621]100%|██████████| 2/2 [00:06<00:00,  3.38s/it, CE=2.253642e+00 H=2.253590e+00 dV_dx=-1.847151e-06 dV_dθ=-5.058280e-05 ||∇||=4.486168e-01 | Tr=0.1135 Te/Cur=0.1076 Te/Exp=0.2621]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.88s/it] 50%|█████     | 1/2 [00:07<00:04,  4.88s/it, CE=2.249501e+00 H=2.249476e+00 dV_dx=-5.499830e-06 dV_dθ=-1.935322e-05 ||∇||=4.144371e-01 | Tr=0.1209 Te/Cur=0.1140 Te/Exp=0.2986]100%|██████████| 2/2 [00:07<00:00,  3.40s/it, CE=2.249501e+00 H=2.249476e+00 dV_dx=-5.499830e-06 dV_dθ=-1.935322e-05 ||∇||=4.144371e-01 | Tr=0.1209 Te/Cur=0.1140 Te/Exp=0.2986]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.249501e+00 H=2.249476e+00 dV_dx=-5.499830e-06 dV_dθ=-1.935322e-05 ||∇||=4.144371e-01 | Tr=0.1209 Te/Cur=0.1140 Te/Exp=0.2986]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.59s/it] 50%|█████     | 1/2 [00:16<00:13, 13.59s/it, CE=2.244360e+00 H=2.244340e+00 dV_dx=5.421234e-06 dV_dθ=-2.469386e-05 ||∇||=4.410108e-01 | Tr=0.1525 Te/Cur=0.1354 Te/Exp=0.2468]100%|██████████| 2/2 [00:16<00:00,  7.45s/it, CE=2.244360e+00 H=2.244340e+00 dV_dx=5.421234e-06 dV_dθ=-2.469386e-05 ||∇||=4.410108e-01 | Tr=0.1525 Te/Cur=0.1354 Te/Exp=0.2468]100%|██████████| 2/2 [00:16<00:00,  8.37s/it, CE=2.244360e+00 H=2.244340e+00 dV_dx=5.421234e-06 dV_dθ=-2.469386e-05 ||∇||=4.410108e-01 | Tr=0.1525 Te/Cur=0.1354 Te/Exp=0.2468]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.04s/it] 50%|█████     | 1/2 [00:15<00:13, 13.04s/it, CE=2.245977e+00 H=2.245938e+00 dV_dx=6.006009e-06 dV_dθ=-4.452635e-05 ||∇||=4.334524e-01 | Tr=0.0952 Te/Cur=0.0937 Te/Exp=0.2558]100%|██████████| 2/2 [00:15<00:00,  6.99s/it, CE=2.245977e+00 H=2.245938e+00 dV_dx=6.006009e-06 dV_dθ=-4.452635e-05 ||∇||=4.334524e-01 | Tr=0.0952 Te/Cur=0.0937 Te/Exp=0.2558]100%|██████████| 2/2 [00:15<00:00,  7.90s/it, CE=2.245977e+00 H=2.245938e+00 dV_dx=6.006009e-06 dV_dθ=-4.452635e-05 ||∇||=4.334524e-01 | Tr=0.0952 Te/Cur=0.0937 Te/Exp=0.2558]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.52s/it] 50%|█████     | 1/2 [00:18<00:15, 15.52s/it, CE=2.236200e+00 H=2.236166e+00 dV_dx=4.442691e-06 dV_dθ=-3.763819e-05 ||∇||=4.372787e-01 | Tr=0.1211 Te/Cur=0.1501 Te/Exp=0.3453]100%|██████████| 2/2 [00:18<00:00,  8.32s/it, CE=2.236200e+00 H=2.236166e+00 dV_dx=4.442691e-06 dV_dθ=-3.763819e-05 ||∇||=4.372787e-01 | Tr=0.1211 Te/Cur=0.1501 Te/Exp=0.3453]100%|██████████| 2/2 [00:18<00:00,  9.40s/it, CE=2.236200e+00 H=2.236166e+00 dV_dx=4.442691e-06 dV_dθ=-3.763819e-05 ||∇||=4.372787e-01 | Tr=0.1211 Te/Cur=0.1501 Te/Exp=0.3453]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.20s/it] 50%|█████     | 1/2 [00:16<00:13, 13.20s/it, CE=2.238081e+00 H=2.238029e+00 dV_dx=2.659775e-06 dV_dθ=-5.498195e-05 ||∇||=4.503285e-01 | Tr=0.0839 Te/Cur=0.1017 Te/Exp=0.2722]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.238081e+00 H=2.238029e+00 dV_dx=2.659775e-06 dV_dθ=-5.498195e-05 ||∇||=4.503285e-01 | Tr=0.0839 Te/Cur=0.1017 Te/Exp=0.2722]100%|██████████| 2/2 [00:16<00:00,  8.10s/it, CE=2.238081e+00 H=2.238029e+00 dV_dx=2.659775e-06 dV_dθ=-5.498195e-05 ||∇||=4.503285e-01 | Tr=0.0839 Te/Cur=0.1017 Te/Exp=0.2722]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 572, 104, 10]) with loss 2.185755
  Total candidates evaluated: 54
  Original: (4, [432, 552, 84, 10])
  Optimal: (2, [507, 572, 104, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 4→2, feed [432, 552, 84, 10]→[507, 572, 104, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 4)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:19<06:03, 19.15s/it]  5%|▌         | 1/20 [00:23<06:03, 19.15s/it, CE=1.370019e+00 H=1.358518e+00 dV_dx=1.599967e-07 dV_dθ=-1.150126e-02 ||∇||=3.028319e+00 | Tr=0.4401] 10%|█         | 2/20 [00:23<03:12, 10.71s/it, CE=1.370019e+00 H=1.358518e+00 dV_dx=1.599967e-07 dV_dθ=-1.150126e-02 ||∇||=3.028319e+00 | Tr=0.4401] 10%|█         | 2/20 [00:28<03:12, 10.71s/it, CE=1.105661e+00 H=1.093071e+00 dV_dx=-6.447290e-06 dV_dθ=-1.258305e-02 ||∇||=3.425045e+00 | Tr=0.4401] 15%|█▌        | 3/20 [00:28<02:15,  7.97s/it, CE=1.105661e+00 H=1.093071e+00 dV_dx=-6.447290e-06 dV_dθ=-1.258305e-02 ||∇||=3.425045e+00 | Tr=0.4401] 15%|█▌        | 3/20 [00:33<02:15,  7.97s/it, CE=9.465434e-01 H=9.363592e-01 dV_dx=2.658422e-05 dV_dθ=-1.021082e-02 ||∇||=3.306023e+00 | Tr=0.4401]  20%|██        | 4/20 [00:33<01:47,  6.75s/it, CE=9.465434e-01 H=9.363592e-01 dV_dx=2.658422e-05 dV_dθ=-1.021082e-02 ||∇||=3.306023e+00 | Tr=0.4401] 20%|██        | 4/20 [00:37<01:47,  6.75s/it, CE=8.370036e-01 H=8.233073e-01 dV_dx=-9.100824e-06 dV_dθ=-1.368718e-02 ||∇||=3.787098e+00 | Tr=0.4401] 25%|██▌       | 5/20 [00:37<01:27,  5.85s/it, CE=8.370036e-01 H=8.233073e-01 dV_dx=-9.100824e-06 dV_dθ=-1.368718e-02 ||∇||=3.787098e+00 | Tr=0.4401] 25%|██▌       | 5/20 [00:42<01:27,  5.85s/it, CE=7.570859e-01 H=7.446912e-01 dV_dx=-4.065018e-05 dV_dθ=-1.235405e-02 ||∇||=3.680437e+00 | Tr=0.4401] 30%|███       | 6/20 [00:42<01:14,  5.35s/it, CE=7.570859e-01 H=7.446912e-01 dV_dx=-4.065018e-05 dV_dθ=-1.235405e-02 ||∇||=3.680437e+00 | Tr=0.4401] 30%|███       | 6/20 [00:46<01:14,  5.35s/it, CE=7.009285e-01 H=6.871949e-01 dV_dx=-6.217006e-05 dV_dθ=-1.367141e-02 ||∇||=3.837015e+00 | Tr=0.4401] 35%|███▌      | 7/20 [00:46<01:05,  5.07s/it, CE=7.009285e-01 H=6.871949e-01 dV_dx=-6.217006e-05 dV_dθ=-1.367141e-02 ||∇||=3.837015e+00 | Tr=0.4401] 35%|███▌      | 7/20 [00:50<01:05,  5.07s/it, CE=6.582817e-01 H=6.437805e-01 dV_dx=-3.365431e-05 dV_dθ=-1.446756e-02 ||∇||=3.940119e+00 | Tr=0.4401] 40%|████      | 8/20 [00:50<00:58,  4.84s/it, CE=6.582817e-01 H=6.437805e-01 dV_dx=-3.365431e-05 dV_dθ=-1.446756e-02 ||∇||=3.940119e+00 | Tr=0.4401] 40%|████      | 8/20 [00:55<00:58,  4.84s/it, CE=6.238014e-01 H=6.095750e-01 dV_dx=-2.260782e-05 dV_dθ=-1.420380e-02 ||∇||=3.974402e+00 | Tr=0.4401] 45%|████▌     | 9/20 [00:55<00:52,  4.76s/it, CE=6.238014e-01 H=6.095750e-01 dV_dx=-2.260782e-05 dV_dθ=-1.420380e-02 ||∇||=3.974402e+00 | Tr=0.4401] 45%|████▌     | 9/20 [00:59<00:52,  4.76s/it, CE=5.955783e-01 H=5.815275e-01 dV_dx=1.121675e-06 dV_dθ=-1.405196e-02 ||∇||=3.931565e+00 | Tr=0.4401]  50%|█████     | 10/20 [00:59<00:45,  4.54s/it, CE=5.955783e-01 H=5.815275e-01 dV_dx=1.121675e-06 dV_dθ=-1.405196e-02 ||∇||=3.931565e+00 | Tr=0.4401] 50%|█████     | 10/20 [01:04<00:45,  4.54s/it, CE=5.717957e-01 H=5.584713e-01 dV_dx=1.186554e-05 dV_dθ=-1.333623e-02 ||∇||=3.885076e+00 | Tr=0.4401] 55%|█████▌    | 11/20 [01:04<00:40,  4.50s/it, CE=5.717957e-01 H=5.584713e-01 dV_dx=1.186554e-05 dV_dθ=-1.333623e-02 ||∇||=3.885076e+00 | Tr=0.4401] 55%|█████▌    | 11/20 [01:08<00:40,  4.50s/it, CE=5.507118e-01 H=5.382846e-01 dV_dx=2.758336e-05 dV_dθ=-1.245473e-02 ||∇||=3.791074e+00 | Tr=0.4401] 60%|██████    | 12/20 [01:08<00:36,  4.51s/it, CE=5.507118e-01 H=5.382846e-01 dV_dx=2.758336e-05 dV_dθ=-1.245473e-02 ||∇||=3.791074e+00 | Tr=0.4401] 60%|██████    | 12/20 [01:12<00:36,  4.51s/it, CE=5.319444e-01 H=5.207267e-01 dV_dx=-2.403121e-05 dV_dθ=-1.119367e-02 ||∇||=3.688059e+00 | Tr=0.4401] 65%|██████▌   | 13/20 [01:12<00:31,  4.46s/it, CE=5.319444e-01 H=5.207267e-01 dV_dx=-2.403121e-05 dV_dθ=-1.119367e-02 ||∇||=3.688059e+00 | Tr=0.4401] 65%|██████▌   | 13/20 [01:17<00:31,  4.46s/it, CE=5.152568e-01 H=5.045531e-01 dV_dx=7.453533e-06 dV_dθ=-1.071123e-02 ||∇||=3.634943e+00 | Tr=0.4401]  70%|███████   | 14/20 [01:17<00:26,  4.40s/it, CE=5.152568e-01 H=5.045531e-01 dV_dx=7.453533e-06 dV_dθ=-1.071123e-02 ||∇||=3.634943e+00 | Tr=0.4401] 70%|███████   | 14/20 [01:21<00:26,  4.40s/it, CE=5.005651e-01 H=4.899599e-01 dV_dx=-1.270064e-05 dV_dθ=-1.059247e-02 ||∇||=3.633341e+00 | Tr=0.4401] 75%|███████▌  | 15/20 [01:21<00:22,  4.42s/it, CE=5.005651e-01 H=4.899599e-01 dV_dx=-1.270064e-05 dV_dθ=-1.059247e-02 ||∇||=3.633341e+00 | Tr=0.4401] 75%|███████▌  | 15/20 [01:26<00:22,  4.42s/it, CE=4.872092e-01 H=4.767838e-01 dV_dx=1.408259e-05 dV_dθ=-1.043950e-02 ||∇||=3.632739e+00 | Tr=0.4401]  80%|████████  | 16/20 [01:26<00:18,  4.69s/it, CE=4.872092e-01 H=4.767838e-01 dV_dx=1.408259e-05 dV_dθ=-1.043950e-02 ||∇||=3.632739e+00 | Tr=0.4401] 80%|████████  | 16/20 [01:31<00:18,  4.69s/it, CE=4.750388e-01 H=4.647160e-01 dV_dx=2.575215e-05 dV_dθ=-1.034850e-02 ||∇||=3.638787e+00 | Tr=0.4401] 85%|████████▌ | 17/20 [01:31<00:14,  4.71s/it, CE=4.750388e-01 H=4.647160e-01 dV_dx=2.575215e-05 dV_dθ=-1.034850e-02 ||∇||=3.638787e+00 | Tr=0.4401] 85%|████████▌ | 17/20 [01:36<00:14,  4.71s/it, CE=4.638171e-01 H=4.539537e-01 dV_dx=-4.415972e-05 dV_dθ=-9.819287e-03 ||∇||=3.600843e+00 | Tr=0.4401] 90%|█████████ | 18/20 [01:36<00:09,  4.60s/it, CE=4.638171e-01 H=4.539537e-01 dV_dx=-4.415972e-05 dV_dθ=-9.819287e-03 ||∇||=3.600843e+00 | Tr=0.4401] 90%|█████████ | 18/20 [01:40<00:09,  4.60s/it, CE=4.527940e-01 H=4.431668e-01 dV_dx=1.732830e-05 dV_dθ=-9.644497e-03 ||∇||=3.581653e+00 | Tr=0.4401]  95%|█████████▌| 19/20 [01:40<00:04,  4.45s/it, CE=4.527940e-01 H=4.431668e-01 dV_dx=1.732830e-05 dV_dθ=-9.644497e-03 ||∇||=3.581653e+00 | Tr=0.4401] 95%|█████████▌| 19/20 [01:48<00:04,  4.45s/it, CE=4.425181e-01 H=4.333740e-01 dV_dx=-3.614661e-05 dV_dθ=-9.107991e-03 ||∇||=3.540172e+00 | Tr=0.4401 Te/Cur=0.6025 Te/Exp=0.8368]100%|██████████| 20/20 [01:54<00:00,  7.31s/it, CE=4.425181e-01 H=4.333740e-01 dV_dx=-3.614661e-05 dV_dθ=-9.107991e-03 ||∇||=3.540172e+00 | Tr=0.4401 Te/Cur=0.6025 Te/Exp=0.8368]100%|██████████| 20/20 [01:54<00:00,  5.71s/it, CE=4.425181e-01 H=4.333740e-01 dV_dx=-3.614661e-05 dV_dθ=-9.107991e-03 ||∇||=3.540172e+00 | Tr=0.4401 Te/Cur=0.6025 Te/Exp=0.8368]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.442518
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:11<03:29, 11.04s/it]  5%|▌         | 1/20 [00:15<03:29, 11.04s/it, CE=4.548466e-01 H=4.433880e-01 dV_dx=1.673198e-05 dV_dθ=-1.147534e-02 ||∇||=3.856925e+00 | Tr=0.4401] 10%|█         | 2/20 [00:15<02:07,  7.06s/it, CE=4.548466e-01 H=4.433880e-01 dV_dx=1.673198e-05 dV_dθ=-1.147534e-02 ||∇||=3.856925e+00 | Tr=0.4401] 10%|█         | 2/20 [00:19<02:07,  7.06s/it, CE=4.401338e-01 H=4.319619e-01 dV_dx=5.425657e-05 dV_dθ=-8.226153e-03 ||∇||=3.497876e+00 | Tr=0.4401] 15%|█▌        | 3/20 [00:19<01:39,  5.86s/it, CE=4.401338e-01 H=4.319619e-01 dV_dx=5.425657e-05 dV_dθ=-8.226153e-03 ||∇||=3.497876e+00 | Tr=0.4401] 15%|█▌        | 3/20 [00:23<01:39,  5.86s/it, CE=4.287681e-01 H=4.207107e-01 dV_dx=2.952081e-05 dV_dθ=-8.086924e-03 ||∇||=3.493297e+00 | Tr=0.4401] 20%|██        | 4/20 [00:23<01:23,  5.23s/it, CE=4.287681e-01 H=4.207107e-01 dV_dx=2.952081e-05 dV_dθ=-8.086924e-03 ||∇||=3.493297e+00 | Tr=0.4401] 20%|██        | 4/20 [00:28<01:23,  5.23s/it, CE=4.186156e-01 H=4.109367e-01 dV_dx=-2.905197e-06 dV_dθ=-7.675970e-03 ||∇||=3.467697e+00 | Tr=0.4401] 25%|██▌       | 5/20 [00:28<01:15,  5.01s/it, CE=4.186156e-01 H=4.109367e-01 dV_dx=-2.905197e-06 dV_dθ=-7.675970e-03 ||∇||=3.467697e+00 | Tr=0.4401] 25%|██▌       | 5/20 [00:33<01:15,  5.01s/it, CE=4.096011e-01 H=4.018949e-01 dV_dx=1.160531e-05 dV_dθ=-7.717834e-03 ||∇||=3.495777e+00 | Tr=0.4401]  30%|███       | 6/20 [00:33<01:10,  5.01s/it, CE=4.096011e-01 H=4.018949e-01 dV_dx=1.160531e-05 dV_dθ=-7.717834e-03 ||∇||=3.495777e+00 | Tr=0.4401] 30%|███       | 6/20 [00:38<01:10,  5.01s/it, CE=4.010449e-01 H=3.937954e-01 dV_dx=-6.076004e-06 dV_dθ=-7.243466e-03 ||∇||=3.467351e+00 | Tr=0.4401] 35%|███▌      | 7/20 [00:38<01:03,  4.88s/it, CE=4.010449e-01 H=3.937954e-01 dV_dx=-6.076004e-06 dV_dθ=-7.243466e-03 ||∇||=3.467351e+00 | Tr=0.4401] 35%|███▌      | 7/20 [00:42<01:03,  4.88s/it, CE=3.930486e-01 H=3.859397e-01 dV_dx=1.141282e-05 dV_dθ=-7.120311e-03 ||∇||=3.471927e+00 | Tr=0.4401]  40%|████      | 8/20 [00:42<00:56,  4.69s/it, CE=3.930486e-01 H=3.859397e-01 dV_dx=1.141282e-05 dV_dθ=-7.120311e-03 ||∇||=3.471927e+00 | Tr=0.4401] 40%|████      | 8/20 [00:46<00:56,  4.69s/it, CE=3.851882e-01 H=3.784996e-01 dV_dx=3.181673e-05 dV_dθ=-6.720463e-03 ||∇||=3.431453e+00 | Tr=0.4401] 45%|████▌     | 9/20 [00:46<00:49,  4.52s/it, CE=3.851882e-01 H=3.784996e-01 dV_dx=3.181673e-05 dV_dθ=-6.720463e-03 ||∇||=3.431453e+00 | Tr=0.4401] 45%|████▌     | 9/20 [00:51<00:49,  4.52s/it, CE=3.782573e-01 H=3.715456e-01 dV_dx=-4.277770e-06 dV_dθ=-6.707410e-03 ||∇||=3.446174e+00 | Tr=0.4401] 50%|█████     | 10/20 [00:51<00:45,  4.52s/it, CE=3.782573e-01 H=3.715456e-01 dV_dx=-4.277770e-06 dV_dθ=-6.707410e-03 ||∇||=3.446174e+00 | Tr=0.4401] 50%|█████     | 10/20 [00:55<00:45,  4.52s/it, CE=3.716711e-01 H=3.647983e-01 dV_dx=-2.562248e-05 dV_dθ=-6.847176e-03 ||∇||=3.479139e+00 | Tr=0.4401] 55%|█████▌    | 11/20 [00:55<00:40,  4.50s/it, CE=3.716711e-01 H=3.647983e-01 dV_dx=-2.562248e-05 dV_dθ=-6.847176e-03 ||∇||=3.479139e+00 | Tr=0.4401] 55%|█████▌    | 11/20 [00:59<00:40,  4.50s/it, CE=3.654263e-01 H=3.585268e-01 dV_dx=-5.273848e-05 dV_dθ=-6.846751e-03 ||∇||=3.505096e+00 | Tr=0.4401] 60%|██████    | 12/20 [00:59<00:35,  4.41s/it, CE=3.654263e-01 H=3.585268e-01 dV_dx=-5.273848e-05 dV_dθ=-6.846751e-03 ||∇||=3.505096e+00 | Tr=0.4401] 60%|██████    | 12/20 [01:04<00:35,  4.41s/it, CE=3.597104e-01 H=3.528866e-01 dV_dx=-2.977610e-05 dV_dθ=-6.793960e-03 ||∇||=3.529988e+00 | Tr=0.4401] 65%|██████▌   | 13/20 [01:04<00:31,  4.48s/it, CE=3.597104e-01 H=3.528866e-01 dV_dx=-2.977610e-05 dV_dθ=-6.793960e-03 ||∇||=3.529988e+00 | Tr=0.4401] 65%|██████▌   | 13/20 [01:08<00:31,  4.48s/it, CE=3.542533e-01 H=3.472623e-01 dV_dx=-4.627707e-05 dV_dθ=-6.944723e-03 ||∇||=3.565389e+00 | Tr=0.4401] 70%|███████   | 14/20 [01:08<00:26,  4.43s/it, CE=3.542533e-01 H=3.472623e-01 dV_dx=-4.627707e-05 dV_dθ=-6.944723e-03 ||∇||=3.565389e+00 | Tr=0.4401] 70%|███████   | 14/20 [01:13<00:26,  4.43s/it, CE=3.488361e-01 H=3.420292e-01 dV_dx=-2.193570e-05 dV_dθ=-6.784925e-03 ||∇||=3.568472e+00 | Tr=0.4401] 75%|███████▌  | 15/20 [01:13<00:22,  4.51s/it, CE=3.488361e-01 H=3.420292e-01 dV_dx=-2.193570e-05 dV_dθ=-6.784925e-03 ||∇||=3.568472e+00 | Tr=0.4401] 75%|███████▌  | 15/20 [01:18<00:22,  4.51s/it, CE=3.437267e-01 H=3.368183e-01 dV_dx=-4.870898e-05 dV_dθ=-6.859741e-03 ||∇||=3.586221e+00 | Tr=0.4401] 80%|████████  | 16/20 [01:18<00:18,  4.58s/it, CE=3.437267e-01 H=3.368183e-01 dV_dx=-4.870898e-05 dV_dθ=-6.859741e-03 ||∇||=3.586221e+00 | Tr=0.4401] 80%|████████  | 16/20 [01:23<00:18,  4.58s/it, CE=3.388292e-01 H=3.319617e-01 dV_dx=-5.522295e-06 dV_dθ=-6.861972e-03 ||∇||=3.581140e+00 | Tr=0.4401] 85%|████████▌ | 17/20 [01:23<00:14,  4.68s/it, CE=3.388292e-01 H=3.319617e-01 dV_dx=-5.522295e-06 dV_dθ=-6.861972e-03 ||∇||=3.581140e+00 | Tr=0.4401] 85%|████████▌ | 17/20 [01:27<00:14,  4.68s/it, CE=3.344120e-01 H=3.274364e-01 dV_dx=-4.764834e-05 dV_dθ=-6.927992e-03 ||∇||=3.595832e+00 | Tr=0.4401] 90%|█████████ | 18/20 [01:27<00:09,  4.54s/it, CE=3.344120e-01 H=3.274364e-01 dV_dx=-4.764834e-05 dV_dθ=-6.927992e-03 ||∇||=3.595832e+00 | Tr=0.4401] 90%|█████████ | 18/20 [01:32<00:09,  4.54s/it, CE=3.300523e-01 H=3.229646e-01 dV_dx=-4.796667e-05 dV_dθ=-7.039740e-03 ||∇||=3.621296e+00 | Tr=0.4401] 95%|█████████▌| 19/20 [01:32<00:04,  4.62s/it, CE=3.300523e-01 H=3.229646e-01 dV_dx=-4.796667e-05 dV_dθ=-7.039740e-03 ||∇||=3.621296e+00 | Tr=0.4401] 95%|█████████▌| 19/20 [01:39<00:04,  4.62s/it, CE=3.260901e-01 H=3.187550e-01 dV_dx=-9.839113e-06 dV_dθ=-7.325189e-03 ||∇||=3.669161e+00 | Tr=0.4401 Te/Cur=0.6203 Te/Exp=0.8664]100%|██████████| 20/20 [01:45<00:00,  7.23s/it, CE=3.260901e-01 H=3.187550e-01 dV_dx=-9.839113e-06 dV_dθ=-7.325189e-03 ||∇||=3.669161e+00 | Tr=0.4401 Te/Cur=0.6203 Te/Exp=0.8664]100%|██████████| 20/20 [01:45<00:00,  5.28s/it, CE=3.260901e-01 H=3.187550e-01 dV_dx=-9.839113e-06 dV_dθ=-7.325189e-03 ||∇||=3.669161e+00 | Tr=0.4401 Te/Cur=0.6203 Te/Exp=0.8664]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.11s/it] 50%|█████     | 1/2 [00:19<00:13, 13.11s/it, CE=3.582004e-01 H=3.566460e-01 dV_dx=-5.024097e-05 dV_dθ=-1.504140e-03 ||∇||=1.324126e+00 | Tr=0.6353 Te/Cur=0.6206 Te/Exp=0.8663]100%|██████████| 2/2 [00:19<00:00,  9.18s/it, CE=3.582004e-01 H=3.566460e-01 dV_dx=-5.024097e-05 dV_dθ=-1.504140e-03 ||∇||=1.324126e+00 | Tr=0.6353 Te/Cur=0.6206 Te/Exp=0.8663]100%|██████████| 2/2 [00:19<00:00,  9.77s/it, CE=3.582004e-01 H=3.566460e-01 dV_dx=-5.024097e-05 dV_dθ=-1.504140e-03 ||∇||=1.324126e+00 | Tr=0.6353 Te/Cur=0.6206 Te/Exp=0.8663]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:44,  8.68s/it]  5%|▌         | 1/20 [00:13<02:44,  8.68s/it, CE=3.545559e-01 H=3.534680e-01 dV_dx=-2.622036e-05 dV_dθ=-1.061638e-03 ||∇||=1.250001e+00 | Tr=0.6367] 10%|█         | 2/20 [00:13<01:51,  6.19s/it, CE=3.545559e-01 H=3.534680e-01 dV_dx=-2.622036e-05 dV_dθ=-1.061638e-03 ||∇||=1.250001e+00 | Tr=0.6367] 10%|█         | 2/20 [00:17<01:51,  6.19s/it, CE=3.501128e-01 H=3.491342e-01 dV_dx=1.104865e-04 dV_dθ=-1.089064e-03 ||∇||=1.255410e+00 | Tr=0.6364]  15%|█▌        | 3/20 [00:17<01:31,  5.39s/it, CE=3.501128e-01 H=3.491342e-01 dV_dx=1.104865e-04 dV_dθ=-1.089064e-03 ||∇||=1.255410e+00 | Tr=0.6364] 15%|█▌        | 3/20 [00:21<01:31,  5.39s/it, CE=3.463529e-01 H=3.453365e-01 dV_dx=4.588901e-05 dV_dθ=-1.062312e-03 ||∇||=1.247543e+00 | Tr=0.6368] 20%|██        | 4/20 [00:21<01:19,  4.94s/it, CE=3.463529e-01 H=3.453365e-01 dV_dx=4.588901e-05 dV_dθ=-1.062312e-03 ||∇||=1.247543e+00 | Tr=0.6368] 20%|██        | 4/20 [00:26<01:19,  4.94s/it, CE=3.429056e-01 H=3.419011e-01 dV_dx=1.630242e-05 dV_dθ=-1.020801e-03 ||∇||=1.237710e+00 | Tr=0.6369] 25%|██▌       | 5/20 [00:26<01:11,  4.78s/it, CE=3.429056e-01 H=3.419011e-01 dV_dx=1.630242e-05 dV_dθ=-1.020801e-03 ||∇||=1.237710e+00 | Tr=0.6369] 25%|██▌       | 5/20 [00:32<01:11,  4.78s/it, CE=3.396767e-01 H=3.387421e-01 dV_dx=4.338885e-05 dV_dθ=-9.780350e-04 ||∇||=1.227919e+00 | Tr=0.6372 Te/Cur=0.6263 Te/Exp=0.8686] 30%|███       | 6/20 [00:32<01:12,  5.20s/it, CE=3.396767e-01 H=3.387421e-01 dV_dx=4.338885e-05 dV_dθ=-9.780350e-04 ||∇||=1.227919e+00 | Tr=0.6372 Te/Cur=0.6263 Te/Exp=0.8686] 30%|███       | 6/20 [00:36<01:12,  5.20s/it, CE=3.366995e-01 H=3.357219e-01 dV_dx=-3.403685e-05 dV_dθ=-9.436370e-04 ||∇||=1.219411e+00 | Tr=0.6374]                            35%|███▌      | 7/20 [00:36<01:03,  4.91s/it, CE=3.366995e-01 H=3.357219e-01 dV_dx=-3.403685e-05 dV_dθ=-9.436370e-04 ||∇||=1.219411e+00 | Tr=0.6374] 35%|███▌      | 7/20 [00:41<01:03,  4.91s/it, CE=3.338496e-01 H=3.329822e-01 dV_dx=2.746466e-05 dV_dθ=-8.947986e-04 ||∇||=1.207382e+00 | Tr=0.6376]  40%|████      | 8/20 [00:41<00:58,  4.88s/it, CE=3.338496e-01 H=3.329822e-01 dV_dx=2.746466e-05 dV_dθ=-8.947986e-04 ||∇||=1.207382e+00 | Tr=0.6376] 40%|████      | 8/20 [00:45<00:58,  4.88s/it, CE=3.311826e-01 H=3.303332e-01 dV_dx=6.224833e-05 dV_dθ=-9.115886e-04 ||∇||=1.209443e+00 | Tr=0.6378] 45%|████▌     | 9/20 [00:45<00:50,  4.59s/it, CE=3.311826e-01 H=3.303332e-01 dV_dx=6.224833e-05 dV_dθ=-9.115886e-04 ||∇||=1.209443e+00 | Tr=0.6378] 45%|████▌     | 9/20 [00:49<00:50,  4.59s/it, CE=3.286358e-01 H=3.276413e-01 dV_dx=-9.302622e-05 dV_dθ=-9.014752e-04 ||∇||=1.207774e+00 | Tr=0.6382] 50%|█████     | 10/20 [00:49<00:45,  4.57s/it, CE=3.286358e-01 H=3.276413e-01 dV_dx=-9.302622e-05 dV_dθ=-9.014752e-04 ||∇||=1.207774e+00 | Tr=0.6382] 50%|█████     | 10/20 [00:56<00:45,  4.57s/it, CE=3.261620e-01 H=3.251622e-01 dV_dx=-1.135783e-04 dV_dθ=-8.861600e-04 ||∇||=1.204598e+00 | Tr=0.6385 Te/Cur=0.6263 Te/Exp=0.8698] 55%|█████▌    | 11/20 [00:56<00:46,  5.20s/it, CE=3.261620e-01 H=3.251622e-01 dV_dx=-1.135783e-04 dV_dθ=-8.861600e-04 ||∇||=1.204598e+00 | Tr=0.6385 Te/Cur=0.6263 Te/Exp=0.8698] 55%|█████▌    | 11/20 [01:00<00:46,  5.20s/it, CE=3.238470e-01 H=3.229174e-01 dV_dx=-2.694523e-05 dV_dθ=-9.026460e-04 ||∇||=1.208604e+00 | Tr=0.6389]                             60%|██████    | 12/20 [01:00<00:38,  4.80s/it, CE=3.238470e-01 H=3.229174e-01 dV_dx=-2.694523e-05 dV_dθ=-9.026460e-04 ||∇||=1.208604e+00 | Tr=0.6389] 60%|██████    | 12/20 [01:04<00:38,  4.80s/it, CE=3.215463e-01 H=3.206002e-01 dV_dx=-3.211283e-05 dV_dθ=-9.140066e-04 ||∇||=1.212014e+00 | Tr=0.6394] 65%|██████▌   | 13/20 [01:04<00:32,  4.63s/it, CE=3.215463e-01 H=3.206002e-01 dV_dx=-3.211283e-05 dV_dθ=-9.140066e-04 ||∇||=1.212014e+00 | Tr=0.6394] 65%|██████▌   | 13/20 [01:09<00:32,  4.63s/it, CE=3.192965e-01 H=3.184106e-01 dV_dx=2.436750e-05 dV_dθ=-9.101824e-04 ||∇||=1.212839e+00 | Tr=0.6398]  70%|███████   | 14/20 [01:09<00:28,  4.74s/it, CE=3.192965e-01 H=3.184106e-01 dV_dx=2.436750e-05 dV_dθ=-9.101824e-04 ||∇||=1.212839e+00 | Tr=0.6398] 70%|███████   | 14/20 [01:13<00:28,  4.74s/it, CE=3.171066e-01 H=3.161656e-01 dV_dx=-3.997371e-05 dV_dθ=-9.010212e-04 ||∇||=1.210912e+00 | Tr=0.6402] 75%|███████▌  | 15/20 [01:13<00:22,  4.55s/it, CE=3.171066e-01 H=3.161656e-01 dV_dx=-3.997371e-05 dV_dθ=-9.010212e-04 ||∇||=1.210912e+00 | Tr=0.6402] 75%|███████▌  | 15/20 [01:19<00:22,  4.55s/it, CE=3.149954e-01 H=3.140549e-01 dV_dx=-3.507685e-05 dV_dθ=-9.054051e-04 ||∇||=1.209507e+00 | Tr=0.6402 Te/Cur=0.6300 Te/Exp=0.8729] 80%|████████  | 16/20 [01:19<00:19,  4.96s/it, CE=3.149954e-01 H=3.140549e-01 dV_dx=-3.507685e-05 dV_dθ=-9.054051e-04 ||∇||=1.209507e+00 | Tr=0.6402 Te/Cur=0.6300 Te/Exp=0.8729] 80%|████████  | 16/20 [01:24<00:19,  4.96s/it, CE=3.129436e-01 H=3.119712e-01 dV_dx=-6.130922e-05 dV_dθ=-9.110057e-04 ||∇||=1.211493e+00 | Tr=0.6406]                             85%|████████▌ | 17/20 [01:24<00:14,  4.82s/it, CE=3.129436e-01 H=3.119712e-01 dV_dx=-6.130922e-05 dV_dθ=-9.110057e-04 ||∇||=1.211493e+00 | Tr=0.6406] 85%|████████▌ | 17/20 [01:28<00:14,  4.82s/it, CE=3.109554e-01 H=3.100137e-01 dV_dx=-2.476796e-05 dV_dθ=-9.169339e-04 ||∇||=1.214003e+00 | Tr=0.6406] 90%|█████████ | 18/20 [01:28<00:09,  4.75s/it, CE=3.109554e-01 H=3.100137e-01 dV_dx=-2.476796e-05 dV_dθ=-9.169339e-04 ||∇||=1.214003e+00 | Tr=0.6406] 90%|█████████ | 18/20 [01:32<00:09,  4.75s/it, CE=3.090163e-01 H=3.080128e-01 dV_dx=-7.213891e-05 dV_dθ=-9.312720e-04 ||∇||=1.216186e+00 | Tr=0.6410] 95%|█████████▌| 19/20 [01:32<00:04,  4.58s/it, CE=3.090163e-01 H=3.080128e-01 dV_dx=-7.213891e-05 dV_dθ=-9.312720e-04 ||∇||=1.216186e+00 | Tr=0.6410] 95%|█████████▌| 19/20 [01:41<00:04,  4.58s/it, CE=3.071083e-01 H=3.061498e-01 dV_dx=-1.098209e-05 dV_dθ=-9.475253e-04 ||∇||=1.220244e+00 | Tr=0.6412 Te/Cur=0.6286 Te/Exp=0.8759]100%|██████████| 20/20 [01:41<00:00,  5.87s/it, CE=3.071083e-01 H=3.061498e-01 dV_dx=-1.098209e-05 dV_dθ=-9.475253e-04 ||∇||=1.220244e+00 | Tr=0.6412 Te/Cur=0.6286 Te/Exp=0.8759]100%|██████████| 20/20 [01:41<00:00,  5.09s/it, CE=3.071083e-01 H=3.061498e-01 dV_dx=-1.098209e-05 dV_dθ=-9.475253e-04 ||∇||=1.220244e+00 | Tr=0.6412 Te/Cur=0.6286 Te/Exp=0.8759]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 3 final loss: 0.311052
======================================================================


  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.8011
    Task 1: 0.9616
    Task 2: 0.8624
    Task 3: 0.6279

============================================================
Task 4
============================================================
Initial loss on new task: 1.3599, previous: 0.3071, ratio: 4.43
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 4
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:13<?, ?it/s, CE=5.326872e-01 H=5.305138e-01 dV_dx=-5.895323e-05 dV_dθ=-2.114379e-03 ||∇||=1.806948e+00 | Tr=0.8651 Te/Cur=0.9072 Te/Exp=0.8045]100%|██████████| 1/1 [00:13<00:00, 13.13s/it, CE=5.326872e-01 H=5.305138e-01 dV_dx=-5.895323e-05 dV_dθ=-2.114379e-03 ||∇||=1.806948e+00 | Tr=0.8651 Te/Cur=0.9072 Te/Exp=0.8045]100%|██████████| 1/1 [00:13<00:00, 13.13s/it, CE=5.326872e-01 H=5.305138e-01 dV_dx=-5.895323e-05 dV_dθ=-2.114379e-03 ||∇||=1.806948e+00 | Tr=0.8651 Te/Cur=0.9072 Te/Exp=0.8045]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.532687

[STEP 2] Architecture change decision
  Current: 0.532687, Previous: 0.307108
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 38294 samples from 10 classes
  Starting grid architecture search for task 4
  Baseline architecture: (2, [507, 572, 104, 10])
  Baseline loss: 0.532687
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.35s/it] 50%|█████     | 1/2 [00:10<00:07,  7.35s/it, CE=2.339723e+00 H=2.339583e+00 dV_dx=-2.901897e-07 dV_dθ=-1.396177e-04 ||∇||=3.100082e-01 | Tr=0.1480 Te/Cur=0.1841 Te/Exp=0.1323]100%|██████████| 2/2 [00:10<00:00,  4.63s/it, CE=2.339723e+00 H=2.339583e+00 dV_dx=-2.901897e-07 dV_dθ=-1.396177e-04 ||∇||=3.100082e-01 | Tr=0.1480 Te/Cur=0.1841 Te/Exp=0.1323]100%|██████████| 2/2 [00:10<00:00,  5.04s/it, CE=2.339723e+00 H=2.339583e+00 dV_dx=-2.901897e-07 dV_dθ=-1.396177e-04 ||∇||=3.100082e-01 | Tr=0.1480 Te/Cur=0.1841 Te/Exp=0.1323]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.3397233683633627
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.99s/it] 50%|█████     | 1/2 [00:10<00:07,  7.99s/it, CE=2.342213e+00 H=2.342091e+00 dV_dx=2.306432e-06 dV_dθ=-1.242024e-04 ||∇||=3.089930e-01 | Tr=0.1536 Te/Cur=0.1795 Te/Exp=0.1271]100%|██████████| 2/2 [00:10<00:00,  4.91s/it, CE=2.342213e+00 H=2.342091e+00 dV_dx=2.306432e-06 dV_dθ=-1.242024e-04 ||∇||=3.089930e-01 | Tr=0.1536 Te/Cur=0.1795 Te/Exp=0.1271]100%|██████████| 2/2 [00:10<00:00,  5.37s/it, CE=2.342213e+00 H=2.342091e+00 dV_dx=2.306432e-06 dV_dθ=-1.242024e-04 ||∇||=3.089930e-01 | Tr=0.1536 Te/Cur=0.1795 Te/Exp=0.1271]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.94s/it] 50%|█████     | 1/2 [00:16<00:13, 13.94s/it, CE=2.331445e+00 H=2.331314e+00 dV_dx=-1.165421e-06 dV_dθ=-1.304311e-04 ||∇||=2.857993e-01 | Tr=0.1703 Te/Cur=0.1770 Te/Exp=0.1318]100%|██████████| 2/2 [00:16<00:00,  7.45s/it, CE=2.331445e+00 H=2.331314e+00 dV_dx=-1.165421e-06 dV_dθ=-1.304311e-04 ||∇||=2.857993e-01 | Tr=0.1703 Te/Cur=0.1770 Te/Exp=0.1318]100%|██████████| 2/2 [00:16<00:00,  8.42s/it, CE=2.331445e+00 H=2.331314e+00 dV_dx=-1.165421e-06 dV_dθ=-1.304311e-04 ||∇||=2.857993e-01 | Tr=0.1703 Te/Cur=0.1770 Te/Exp=0.1318]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 592, 84, 10]) with loss 2.331445
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.76s/it] 50%|█████     | 1/2 [00:10<00:07,  7.76s/it, CE=2.345009e+00 H=2.344867e+00 dV_dx=4.234935e-06 dV_dθ=-1.462275e-04 ||∇||=3.260101e-01 | Tr=0.1500 Te/Cur=0.1670 Te/Exp=0.1416]100%|██████████| 2/2 [00:10<00:00,  4.93s/it, CE=2.345009e+00 H=2.344867e+00 dV_dx=4.234935e-06 dV_dθ=-1.462275e-04 ||∇||=3.260101e-01 | Tr=0.1500 Te/Cur=0.1670 Te/Exp=0.1416]100%|██████████| 2/2 [00:10<00:00,  5.35s/it, CE=2.345009e+00 H=2.344867e+00 dV_dx=4.234935e-06 dV_dθ=-1.462275e-04 ||∇||=3.260101e-01 | Tr=0.1500 Te/Cur=0.1670 Te/Exp=0.1416]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.16s/it] 50%|█████     | 1/2 [00:11<00:09,  9.16s/it, CE=2.326659e+00 H=2.326503e+00 dV_dx=7.786972e-06 dV_dθ=-1.638196e-04 ||∇||=2.988355e-01 | Tr=0.1708 Te/Cur=0.1620 Te/Exp=0.1328]100%|██████████| 2/2 [00:11<00:00,  5.36s/it, CE=2.326659e+00 H=2.326503e+00 dV_dx=7.786972e-06 dV_dθ=-1.638196e-04 ||∇||=2.988355e-01 | Tr=0.1708 Te/Cur=0.1620 Te/Exp=0.1328]100%|██████████| 2/2 [00:11<00:00,  5.93s/it, CE=2.326659e+00 H=2.326503e+00 dV_dx=7.786972e-06 dV_dθ=-1.638196e-04 ||∇||=2.988355e-01 | Tr=0.1708 Te/Cur=0.1620 Te/Exp=0.1328]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 104, 10]) with loss 2.326659
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.82s/it] 50%|█████     | 1/2 [00:16<00:13, 13.82s/it, CE=2.329883e+00 H=2.329774e+00 dV_dx=1.499433e-06 dV_dθ=-1.109708e-04 ||∇||=2.829830e-01 | Tr=0.0962 Te/Cur=0.1014 Te/Exp=0.1008]100%|██████████| 2/2 [00:16<00:00,  7.03s/it, CE=2.329883e+00 H=2.329774e+00 dV_dx=1.499433e-06 dV_dθ=-1.109708e-04 ||∇||=2.829830e-01 | Tr=0.0962 Te/Cur=0.1014 Te/Exp=0.1008]100%|██████████| 2/2 [00:16<00:00,  8.05s/it, CE=2.329883e+00 H=2.329774e+00 dV_dx=1.499433e-06 dV_dθ=-1.109708e-04 ||∇||=2.829830e-01 | Tr=0.0962 Te/Cur=0.1014 Te/Exp=0.1008]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.15s/it] 50%|█████     | 1/2 [00:07<00:05,  5.15s/it, CE=2.327408e+00 H=2.327294e+00 dV_dx=1.192681e-06 dV_dθ=-1.155130e-04 ||∇||=2.846938e-01 | Tr=0.2132 Te/Cur=0.2052 Te/Exp=0.1495]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.327408e+00 H=2.327294e+00 dV_dx=1.192681e-06 dV_dθ=-1.155130e-04 ||∇||=2.846938e-01 | Tr=0.2132 Te/Cur=0.2052 Te/Exp=0.1495]100%|██████████| 2/2 [00:07<00:00,  3.88s/it, CE=2.327408e+00 H=2.327294e+00 dV_dx=1.192681e-06 dV_dθ=-1.155130e-04 ||∇||=2.846938e-01 | Tr=0.2132 Te/Cur=0.2052 Te/Exp=0.1495]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.62s/it] 50%|█████     | 1/2 [00:16<00:13, 13.62s/it, CE=2.340145e+00 H=2.340015e+00 dV_dx=-3.712465e-06 dV_dθ=-1.262266e-04 ||∇||=2.823619e-01 | Tr=0.2142 Te/Cur=0.2259 Te/Exp=0.1571]100%|██████████| 2/2 [00:16<00:00,  7.32s/it, CE=2.340145e+00 H=2.340015e+00 dV_dx=-3.712465e-06 dV_dθ=-1.262266e-04 ||∇||=2.823619e-01 | Tr=0.2142 Te/Cur=0.2259 Te/Exp=0.1571]100%|██████████| 2/2 [00:16<00:00,  8.26s/it, CE=2.340145e+00 H=2.340015e+00 dV_dx=-3.712465e-06 dV_dθ=-1.262266e-04 ||∇||=2.823619e-01 | Tr=0.2142 Te/Cur=0.2259 Te/Exp=0.1571]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.36s/it] 50%|█████     | 1/2 [00:16<00:13, 13.36s/it, CE=2.351623e+00 H=2.351506e+00 dV_dx=-1.164464e-06 dV_dθ=-1.154844e-04 ||∇||=3.011117e-01 | Tr=0.1106 Te/Cur=0.1218 Te/Exp=0.1171]100%|██████████| 2/2 [00:16<00:00,  7.38s/it, CE=2.351623e+00 H=2.351506e+00 dV_dx=-1.164464e-06 dV_dθ=-1.154844e-04 ||∇||=3.011117e-01 | Tr=0.1106 Te/Cur=0.1218 Te/Exp=0.1171]100%|██████████| 2/2 [00:16<00:00,  8.28s/it, CE=2.351623e+00 H=2.351506e+00 dV_dx=-1.164464e-06 dV_dθ=-1.154844e-04 ||∇||=3.011117e-01 | Tr=0.1106 Te/Cur=0.1218 Te/Exp=0.1171]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.81s/it] 50%|█████     | 1/2 [00:09<00:06,  6.81s/it, CE=2.321541e+00 H=2.321356e+00 dV_dx=1.693107e-06 dV_dθ=-1.867041e-04 ||∇||=3.398827e-01 | Tr=0.1407 Te/Cur=0.1599 Te/Exp=0.1357]100%|██████████| 2/2 [00:09<00:00,  4.50s/it, CE=2.321541e+00 H=2.321356e+00 dV_dx=1.693107e-06 dV_dθ=-1.867041e-04 ||∇||=3.398827e-01 | Tr=0.1407 Te/Cur=0.1599 Te/Exp=0.1357]100%|██████████| 2/2 [00:09<00:00,  4.84s/it, CE=2.321541e+00 H=2.321356e+00 dV_dx=1.693107e-06 dV_dθ=-1.867041e-04 ||∇||=3.398827e-01 | Tr=0.1407 Te/Cur=0.1599 Te/Exp=0.1357]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 552, 84, 10]) with loss 2.321541
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.87s/it] 50%|█████     | 1/2 [00:10<00:07,  7.87s/it, CE=2.316510e+00 H=2.316345e+00 dV_dx=-2.732557e-07 dV_dθ=-1.640595e-04 ||∇||=3.423140e-01 | Tr=0.1677 Te/Cur=0.1844 Te/Exp=0.1505]100%|██████████| 2/2 [00:10<00:00,  4.87s/it, CE=2.316510e+00 H=2.316345e+00 dV_dx=-2.732557e-07 dV_dθ=-1.640595e-04 ||∇||=3.423140e-01 | Tr=0.1677 Te/Cur=0.1844 Te/Exp=0.1505]100%|██████████| 2/2 [00:10<00:00,  5.32s/it, CE=2.316510e+00 H=2.316345e+00 dV_dx=-2.732557e-07 dV_dθ=-1.640595e-04 ||∇||=3.423140e-01 | Tr=0.1677 Te/Cur=0.1844 Te/Exp=0.1505]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 84, 10]) with loss 2.316510
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.59s/it] 50%|█████     | 1/2 [00:16<00:13, 13.59s/it, CE=2.305578e+00 H=2.305410e+00 dV_dx=1.223476e-06 dV_dθ=-1.692966e-04 ||∇||=3.367441e-01 | Tr=0.1500 Te/Cur=0.1629 Te/Exp=0.1521]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.305578e+00 H=2.305410e+00 dV_dx=1.223476e-06 dV_dθ=-1.692966e-04 ||∇||=3.367441e-01 | Tr=0.1500 Te/Cur=0.1629 Te/Exp=0.1521]100%|██████████| 2/2 [00:16<00:00,  8.32s/it, CE=2.305578e+00 H=2.305410e+00 dV_dx=1.223476e-06 dV_dθ=-1.692966e-04 ||∇||=3.367441e-01 | Tr=0.1500 Te/Cur=0.1629 Te/Exp=0.1521]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 592, 84, 10]) with loss 2.305578
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.08s/it] 50%|█████     | 1/2 [00:11<00:08,  8.08s/it, CE=2.321414e+00 H=2.321170e+00 dV_dx=-5.550649e-06 dV_dθ=-2.380202e-04 ||∇||=3.849764e-01 | Tr=0.1711 Te/Cur=0.1771 Te/Exp=0.1476]100%|██████████| 2/2 [00:11<00:00,  5.07s/it, CE=2.321414e+00 H=2.321170e+00 dV_dx=-5.550649e-06 dV_dθ=-2.380202e-04 ||∇||=3.849764e-01 | Tr=0.1711 Te/Cur=0.1771 Te/Exp=0.1476]100%|██████████| 2/2 [00:11<00:00,  5.52s/it, CE=2.321414e+00 H=2.321170e+00 dV_dx=-5.550649e-06 dV_dθ=-2.380202e-04 ||∇||=3.849764e-01 | Tr=0.1711 Te/Cur=0.1771 Te/Exp=0.1476]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.14s/it] 50%|█████     | 1/2 [00:10<00:07,  7.14s/it, CE=2.305738e+00 H=2.305524e+00 dV_dx=-2.810379e-06 dV_dθ=-2.115158e-04 ||∇||=3.592266e-01 | Tr=0.2096 Te/Cur=0.2267 Te/Exp=0.1843]100%|██████████| 2/2 [00:10<00:00,  4.75s/it, CE=2.305738e+00 H=2.305524e+00 dV_dx=-2.810379e-06 dV_dθ=-2.115158e-04 ||∇||=3.592266e-01 | Tr=0.2096 Te/Cur=0.2267 Te/Exp=0.1843]100%|██████████| 2/2 [00:10<00:00,  5.10s/it, CE=2.305738e+00 H=2.305524e+00 dV_dx=-2.810379e-06 dV_dθ=-2.115158e-04 ||∇||=3.592266e-01 | Tr=0.2096 Te/Cur=0.2267 Te/Exp=0.1843]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.58s/it] 50%|█████     | 1/2 [00:18<00:15, 15.58s/it, CE=2.307708e+00 H=2.307526e+00 dV_dx=-2.973351e-06 dV_dθ=-1.795180e-04 ||∇||=3.507655e-01 | Tr=0.1009 Te/Cur=0.1031 Te/Exp=0.1316]100%|██████████| 2/2 [00:18<00:00,  8.06s/it, CE=2.307708e+00 H=2.307526e+00 dV_dx=-2.973351e-06 dV_dθ=-1.795180e-04 ||∇||=3.507655e-01 | Tr=0.1009 Te/Cur=0.1031 Te/Exp=0.1316]100%|██████████| 2/2 [00:18<00:00,  9.19s/it, CE=2.307708e+00 H=2.307526e+00 dV_dx=-2.973351e-06 dV_dθ=-1.795180e-04 ||∇||=3.507655e-01 | Tr=0.1009 Te/Cur=0.1031 Te/Exp=0.1316]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.82s/it] 50%|█████     | 1/2 [00:07<00:04,  4.82s/it, CE=2.308235e+00 H=2.308091e+00 dV_dx=-2.849718e-06 dV_dθ=-1.412473e-04 ||∇||=3.251801e-01 | Tr=0.1798 Te/Cur=0.1899 Te/Exp=0.1684]100%|██████████| 2/2 [00:07<00:00,  3.51s/it, CE=2.308235e+00 H=2.308091e+00 dV_dx=-2.849718e-06 dV_dθ=-1.412473e-04 ||∇||=3.251801e-01 | Tr=0.1798 Te/Cur=0.1899 Te/Exp=0.1684]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.308235e+00 H=2.308091e+00 dV_dx=-2.849718e-06 dV_dθ=-1.412473e-04 ||∇||=3.251801e-01 | Tr=0.1798 Te/Cur=0.1899 Te/Exp=0.1684]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.25s/it] 50%|█████     | 1/2 [00:16<00:13, 13.25s/it, CE=2.305057e+00 H=2.304841e+00 dV_dx=2.561352e-07 dV_dθ=-2.159096e-04 ||∇||=3.658066e-01 | Tr=0.2004 Te/Cur=0.2058 Te/Exp=0.1936]100%|██████████| 2/2 [00:16<00:00,  7.22s/it, CE=2.305057e+00 H=2.304841e+00 dV_dx=2.561352e-07 dV_dθ=-2.159096e-04 ||∇||=3.658066e-01 | Tr=0.2004 Te/Cur=0.2058 Te/Exp=0.1936]100%|██████████| 2/2 [00:16<00:00,  8.12s/it, CE=2.305057e+00 H=2.304841e+00 dV_dx=2.561352e-07 dV_dθ=-2.159096e-04 ||∇||=3.658066e-01 | Tr=0.2004 Te/Cur=0.2058 Te/Exp=0.1936]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 124, 10]) with loss 2.305057
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.15s/it] 50%|█████     | 1/2 [00:16<00:14, 14.15s/it, CE=2.322331e+00 H=2.322148e+00 dV_dx=1.292534e-06 dV_dθ=-1.839619e-04 ||∇||=3.532815e-01 | Tr=0.1552 Te/Cur=0.1798 Te/Exp=0.1712]100%|██████████| 2/2 [00:16<00:00,  7.49s/it, CE=2.322331e+00 H=2.322148e+00 dV_dx=1.292534e-06 dV_dθ=-1.839619e-04 ||∇||=3.532815e-01 | Tr=0.1552 Te/Cur=0.1798 Te/Exp=0.1712]100%|██████████| 2/2 [00:16<00:00,  8.49s/it, CE=2.322331e+00 H=2.322148e+00 dV_dx=1.292534e-06 dV_dθ=-1.839619e-04 ||∇||=3.532815e-01 | Tr=0.1552 Te/Cur=0.1798 Te/Exp=0.1712]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.04s/it] 50%|█████     | 1/2 [00:10<00:07,  7.04s/it, CE=2.315654e+00 H=2.315444e+00 dV_dx=-3.582977e-06 dV_dθ=-2.056839e-04 ||∇||=3.581885e-01 | Tr=0.1553 Te/Cur=0.1654 Te/Exp=0.1332]100%|██████████| 2/2 [00:10<00:00,  4.78s/it, CE=2.315654e+00 H=2.315444e+00 dV_dx=-3.582977e-06 dV_dθ=-2.056839e-04 ||∇||=3.581885e-01 | Tr=0.1553 Te/Cur=0.1654 Te/Exp=0.1332]100%|██████████| 2/2 [00:10<00:00,  5.12s/it, CE=2.315654e+00 H=2.315444e+00 dV_dx=-3.582977e-06 dV_dθ=-2.056839e-04 ||∇||=3.581885e-01 | Tr=0.1553 Te/Cur=0.1654 Te/Exp=0.1332]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.95s/it] 50%|█████     | 1/2 [00:10<00:07,  7.95s/it, CE=2.325994e+00 H=2.325806e+00 dV_dx=-3.845433e-06 dV_dθ=-1.840479e-04 ||∇||=3.344620e-01 | Tr=0.1363 Te/Cur=0.1405 Te/Exp=0.1320]100%|██████████| 2/2 [00:10<00:00,  4.89s/it, CE=2.325994e+00 H=2.325806e+00 dV_dx=-3.845433e-06 dV_dθ=-1.840479e-04 ||∇||=3.344620e-01 | Tr=0.1363 Te/Cur=0.1405 Te/Exp=0.1320]100%|██████████| 2/2 [00:10<00:00,  5.35s/it, CE=2.325994e+00 H=2.325806e+00 dV_dx=-3.845433e-06 dV_dθ=-1.840479e-04 ||∇||=3.344620e-01 | Tr=0.1363 Te/Cur=0.1405 Te/Exp=0.1320]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.74s/it] 50%|█████     | 1/2 [00:16<00:13, 13.74s/it, CE=2.312394e+00 H=2.312213e+00 dV_dx=-3.119201e-06 dV_dθ=-1.782786e-04 ||∇||=3.257786e-01 | Tr=0.1683 Te/Cur=0.2014 Te/Exp=0.1503]100%|██████████| 2/2 [00:16<00:00,  7.14s/it, CE=2.312394e+00 H=2.312213e+00 dV_dx=-3.119201e-06 dV_dθ=-1.782786e-04 ||∇||=3.257786e-01 | Tr=0.1683 Te/Cur=0.2014 Te/Exp=0.1503]100%|██████████| 2/2 [00:16<00:00,  8.13s/it, CE=2.312394e+00 H=2.312213e+00 dV_dx=-3.119201e-06 dV_dθ=-1.782786e-04 ||∇||=3.257786e-01 | Tr=0.1683 Te/Cur=0.2014 Te/Exp=0.1503]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.16s/it] 50%|█████     | 1/2 [00:11<00:08,  8.16s/it, CE=2.314429e+00 H=2.314142e+00 dV_dx=-7.587746e-06 dV_dθ=-2.791383e-04 ||∇||=3.940367e-01 | Tr=0.1839 Te/Cur=0.1901 Te/Exp=0.1544]100%|██████████| 2/2 [00:11<00:00,  5.06s/it, CE=2.314429e+00 H=2.314142e+00 dV_dx=-7.587746e-06 dV_dθ=-2.791383e-04 ||∇||=3.940367e-01 | Tr=0.1839 Te/Cur=0.1901 Te/Exp=0.1544]100%|██████████| 2/2 [00:11<00:00,  5.53s/it, CE=2.314429e+00 H=2.314142e+00 dV_dx=-7.587746e-06 dV_dθ=-2.791383e-04 ||∇||=3.940367e-01 | Tr=0.1839 Te/Cur=0.1901 Te/Exp=0.1544]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.71s/it] 50%|█████     | 1/2 [00:10<00:07,  7.71s/it, CE=2.310276e+00 H=2.310079e+00 dV_dx=2.999027e-06 dV_dθ=-2.001757e-04 ||∇||=3.414658e-01 | Tr=0.1653 Te/Cur=0.1707 Te/Exp=0.1253]100%|██████████| 2/2 [00:10<00:00,  4.89s/it, CE=2.310276e+00 H=2.310079e+00 dV_dx=2.999027e-06 dV_dθ=-2.001757e-04 ||∇||=3.414658e-01 | Tr=0.1653 Te/Cur=0.1707 Te/Exp=0.1253]100%|██████████| 2/2 [00:10<00:00,  5.31s/it, CE=2.310276e+00 H=2.310079e+00 dV_dx=2.999027e-06 dV_dθ=-2.001757e-04 ||∇||=3.414658e-01 | Tr=0.1653 Te/Cur=0.1707 Te/Exp=0.1253]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.16s/it] 50%|█████     | 1/2 [00:18<00:15, 15.16s/it, CE=2.310777e+00 H=2.310568e+00 dV_dx=-6.999066e-07 dV_dθ=-2.078168e-04 ||∇||=3.461151e-01 | Tr=0.1436 Te/Cur=0.1341 Te/Exp=0.1189]100%|██████████| 2/2 [00:18<00:00,  7.92s/it, CE=2.310777e+00 H=2.310568e+00 dV_dx=-6.999066e-07 dV_dθ=-2.078168e-04 ||∇||=3.461151e-01 | Tr=0.1436 Te/Cur=0.1341 Te/Exp=0.1189]100%|██████████| 2/2 [00:18<00:00,  9.00s/it, CE=2.310777e+00 H=2.310568e+00 dV_dx=-6.999066e-07 dV_dθ=-2.078168e-04 ||∇||=3.461151e-01 | Tr=0.1436 Te/Cur=0.1341 Te/Exp=0.1189]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.25s/it] 50%|█████     | 1/2 [00:08<00:05,  5.25s/it, CE=2.316692e+00 H=2.316460e+00 dV_dx=-1.431793e-06 dV_dθ=-2.306114e-04 ||∇||=3.612064e-01 | Tr=0.2127 Te/Cur=0.2090 Te/Exp=0.1385]100%|██████████| 2/2 [00:08<00:00,  3.83s/it, CE=2.316692e+00 H=2.316460e+00 dV_dx=-1.431793e-06 dV_dθ=-2.306114e-04 ||∇||=3.612064e-01 | Tr=0.2127 Te/Cur=0.2090 Te/Exp=0.1385]100%|██████████| 2/2 [00:08<00:00,  4.04s/it, CE=2.316692e+00 H=2.316460e+00 dV_dx=-1.431793e-06 dV_dθ=-2.306114e-04 ||∇||=3.612064e-01 | Tr=0.2127 Te/Cur=0.2090 Te/Exp=0.1385]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.40s/it] 50%|█████     | 1/2 [00:16<00:13, 13.40s/it, CE=2.308744e+00 H=2.308535e+00 dV_dx=3.330005e-07 dV_dθ=-2.097101e-04 ||∇||=3.499212e-01 | Tr=0.1988 Te/Cur=0.2040 Te/Exp=0.1941]100%|██████████| 2/2 [00:16<00:00,  7.05s/it, CE=2.308744e+00 H=2.308535e+00 dV_dx=3.330005e-07 dV_dθ=-2.097101e-04 ||∇||=3.499212e-01 | Tr=0.1988 Te/Cur=0.2040 Te/Exp=0.1941]100%|██████████| 2/2 [00:16<00:00,  8.01s/it, CE=2.308744e+00 H=2.308535e+00 dV_dx=3.330005e-07 dV_dθ=-2.097101e-04 ||∇||=3.499212e-01 | Tr=0.1988 Te/Cur=0.2040 Te/Exp=0.1941]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.22s/it] 50%|█████     | 1/2 [00:15<00:13, 13.22s/it, CE=2.306281e+00 H=2.306082e+00 dV_dx=-2.124485e-06 dV_dθ=-1.963548e-04 ||∇||=3.559238e-01 | Tr=0.2330 Te/Cur=0.2355 Te/Exp=0.1626]100%|██████████| 2/2 [00:15<00:00,  7.02s/it, CE=2.306281e+00 H=2.306082e+00 dV_dx=-2.124485e-06 dV_dθ=-1.963548e-04 ||∇||=3.559238e-01 | Tr=0.2330 Te/Cur=0.2355 Te/Exp=0.1626]100%|██████████| 2/2 [00:15<00:00,  7.95s/it, CE=2.306281e+00 H=2.306082e+00 dV_dx=-2.124485e-06 dV_dθ=-1.963548e-04 ||∇||=3.559238e-01 | Tr=0.2330 Te/Cur=0.2355 Te/Exp=0.1626]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.66s/it] 50%|█████     | 1/2 [00:09<00:04,  4.66s/it, CE=2.275171e+00 H=2.274999e+00 dV_dx=-1.333677e-05 dV_dθ=-1.593669e-04 ||∇||=3.783044e-01 | Tr=0.1481 Te/Cur=0.1624 Te/Exp=0.1663]100%|██████████| 2/2 [00:09<00:00,  4.92s/it, CE=2.275171e+00 H=2.274999e+00 dV_dx=-1.333677e-05 dV_dθ=-1.593669e-04 ||∇||=3.783044e-01 | Tr=0.1481 Te/Cur=0.1624 Te/Exp=0.1663]100%|██████████| 2/2 [00:09<00:00,  4.89s/it, CE=2.275171e+00 H=2.274999e+00 dV_dx=-1.333677e-05 dV_dθ=-1.593669e-04 ||∇||=3.783044e-01 | Tr=0.1481 Te/Cur=0.1624 Te/Exp=0.1663]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.275171297088496
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.03s/it] 50%|█████     | 1/2 [00:07<00:05,  5.03s/it, CE=2.277889e+00 H=2.277746e+00 dV_dx=3.225106e-06 dV_dθ=-1.462529e-04 ||∇||=4.027107e-01 | Tr=0.1525 Te/Cur=0.1862 Te/Exp=0.2207]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.277889e+00 H=2.277746e+00 dV_dx=3.225106e-06 dV_dθ=-1.462529e-04 ||∇||=4.027107e-01 | Tr=0.1525 Te/Cur=0.1862 Te/Exp=0.2207]100%|██████████| 2/2 [00:07<00:00,  3.84s/it, CE=2.277889e+00 H=2.277746e+00 dV_dx=3.225106e-06 dV_dθ=-1.462529e-04 ||∇||=4.027107e-01 | Tr=0.1525 Te/Cur=0.1862 Te/Exp=0.2207]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.71s/it] 50%|█████     | 1/2 [00:15<00:12, 12.71s/it, CE=2.272474e+00 H=2.272344e+00 dV_dx=1.860456e-05 dV_dθ=-1.478689e-04 ||∇||=3.991140e-01 | Tr=0.2382 Te/Cur=0.2825 Te/Exp=0.2443]100%|██████████| 2/2 [00:15<00:00,  7.10s/it, CE=2.272474e+00 H=2.272344e+00 dV_dx=1.860456e-05 dV_dθ=-1.478689e-04 ||∇||=3.991140e-01 | Tr=0.2382 Te/Cur=0.2825 Te/Exp=0.2443]100%|██████████| 2/2 [00:15<00:00,  7.94s/it, CE=2.272474e+00 H=2.272344e+00 dV_dx=1.860456e-05 dV_dθ=-1.478689e-04 ||∇||=3.991140e-01 | Tr=0.2382 Te/Cur=0.2825 Te/Exp=0.2443]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 84, 10]) with loss 2.272474
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.33s/it] 50%|█████     | 1/2 [00:16<00:13, 13.33s/it, CE=2.261366e+00 H=2.261207e+00 dV_dx=8.494666e-06 dV_dθ=-1.674279e-04 ||∇||=3.900707e-01 | Tr=0.1876 Te/Cur=0.2358 Te/Exp=0.2847]100%|██████████| 2/2 [00:16<00:00,  7.22s/it, CE=2.261366e+00 H=2.261207e+00 dV_dx=8.494666e-06 dV_dθ=-1.674279e-04 ||∇||=3.900707e-01 | Tr=0.1876 Te/Cur=0.2358 Te/Exp=0.2847]100%|██████████| 2/2 [00:16<00:00,  8.14s/it, CE=2.261366e+00 H=2.261207e+00 dV_dx=8.494666e-06 dV_dθ=-1.674279e-04 ||∇||=3.900707e-01 | Tr=0.1876 Te/Cur=0.2358 Te/Exp=0.2847]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 124, 10]) with loss 2.261366
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.90s/it] 50%|█████     | 1/2 [00:07<00:04,  4.90s/it, CE=2.273802e+00 H=2.273660e+00 dV_dx=-9.895885e-06 dV_dθ=-1.318159e-04 ||∇||=3.676968e-01 | Tr=0.2104 Te/Cur=0.2862 Te/Exp=0.2171]100%|██████████| 2/2 [00:07<00:00,  3.78s/it, CE=2.273802e+00 H=2.273660e+00 dV_dx=-9.895885e-06 dV_dθ=-1.318159e-04 ||∇||=3.676968e-01 | Tr=0.2104 Te/Cur=0.2862 Te/Exp=0.2171]100%|██████████| 2/2 [00:07<00:00,  3.95s/it, CE=2.273802e+00 H=2.273660e+00 dV_dx=-9.895885e-06 dV_dθ=-1.318159e-04 ||∇||=3.676968e-01 | Tr=0.2104 Te/Cur=0.2862 Te/Exp=0.2171]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.41s/it] 50%|█████     | 1/2 [00:19<00:16, 16.41s/it, CE=2.265459e+00 H=2.265283e+00 dV_dx=-1.083200e-05 dV_dθ=-1.652345e-04 ||∇||=4.182114e-01 | Tr=0.1336 Te/Cur=0.2008 Te/Exp=0.2842]100%|██████████| 2/2 [00:19<00:00,  8.38s/it, CE=2.265459e+00 H=2.265283e+00 dV_dx=-1.083200e-05 dV_dθ=-1.652345e-04 ||∇||=4.182114e-01 | Tr=0.1336 Te/Cur=0.2008 Te/Exp=0.2842]100%|██████████| 2/2 [00:19<00:00,  9.58s/it, CE=2.265459e+00 H=2.265283e+00 dV_dx=-1.083200e-05 dV_dθ=-1.652345e-04 ||∇||=4.182114e-01 | Tr=0.1336 Te/Cur=0.2008 Te/Exp=0.2842]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.75s/it] 50%|█████     | 1/2 [00:16<00:13, 13.75s/it, CE=2.258780e+00 H=2.258625e+00 dV_dx=-7.038814e-06 dV_dθ=-1.483512e-04 ||∇||=3.589572e-01 | Tr=0.2546 Te/Cur=0.2999 Te/Exp=0.2504]100%|██████████| 2/2 [00:16<00:00,  7.43s/it, CE=2.258780e+00 H=2.258625e+00 dV_dx=-7.038814e-06 dV_dθ=-1.483512e-04 ||∇||=3.589572e-01 | Tr=0.2546 Te/Cur=0.2999 Te/Exp=0.2504]100%|██████████| 2/2 [00:16<00:00,  8.38s/it, CE=2.258780e+00 H=2.258625e+00 dV_dx=-7.038814e-06 dV_dθ=-1.483512e-04 ||∇||=3.589572e-01 | Tr=0.2546 Te/Cur=0.2999 Te/Exp=0.2504]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 164, 10]) with loss 2.258780
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.71s/it] 50%|█████     | 1/2 [00:16<00:13, 13.71s/it, CE=2.272830e+00 H=2.272707e+00 dV_dx=-9.242583e-06 dV_dθ=-1.143582e-04 ||∇||=3.608803e-01 | Tr=0.2134 Te/Cur=0.2624 Te/Exp=0.2624]100%|██████████| 2/2 [00:16<00:00,  7.20s/it, CE=2.272830e+00 H=2.272707e+00 dV_dx=-9.242583e-06 dV_dθ=-1.143582e-04 ||∇||=3.608803e-01 | Tr=0.2134 Te/Cur=0.2624 Te/Exp=0.2624]100%|██████████| 2/2 [00:16<00:00,  8.17s/it, CE=2.272830e+00 H=2.272707e+00 dV_dx=-9.242583e-06 dV_dθ=-1.143582e-04 ||∇||=3.608803e-01 | Tr=0.2134 Te/Cur=0.2624 Te/Exp=0.2624]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.55s/it] 50%|█████     | 1/2 [00:16<00:13, 13.55s/it, CE=2.261734e+00 H=2.261564e+00 dV_dx=9.090163e-07 dV_dθ=-1.708047e-04 ||∇||=4.317364e-01 | Tr=0.1921 Te/Cur=0.2539 Te/Exp=0.2851]100%|██████████| 2/2 [00:16<00:00,  7.49s/it, CE=2.261734e+00 H=2.261564e+00 dV_dx=9.090163e-07 dV_dθ=-1.708047e-04 ||∇||=4.317364e-01 | Tr=0.1921 Te/Cur=0.2539 Te/Exp=0.2851]100%|██████████| 2/2 [00:16<00:00,  8.40s/it, CE=2.261734e+00 H=2.261564e+00 dV_dx=9.090163e-07 dV_dθ=-1.708047e-04 ||∇||=4.317364e-01 | Tr=0.1921 Te/Cur=0.2539 Te/Exp=0.2851]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.65s/it] 50%|█████     | 1/2 [00:07<00:04,  4.65s/it, CE=2.278509e+00 H=2.278275e+00 dV_dx=-4.291945e-06 dV_dθ=-2.295433e-04 ||∇||=3.855579e-01 | Tr=0.2298 Te/Cur=0.2888 Te/Exp=0.1906]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.278509e+00 H=2.278275e+00 dV_dx=-4.291945e-06 dV_dθ=-2.295433e-04 ||∇||=3.855579e-01 | Tr=0.2298 Te/Cur=0.2888 Te/Exp=0.1906]100%|██████████| 2/2 [00:07<00:00,  3.77s/it, CE=2.278509e+00 H=2.278275e+00 dV_dx=-4.291945e-06 dV_dθ=-2.295433e-04 ||∇||=3.855579e-01 | Tr=0.2298 Te/Cur=0.2888 Te/Exp=0.1906]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.29s/it] 50%|█████     | 1/2 [00:10<00:07,  7.29s/it, CE=2.276553e+00 H=2.276330e+00 dV_dx=-3.375829e-06 dV_dθ=-2.194677e-04 ||∇||=4.465493e-01 | Tr=0.1831 Te/Cur=0.2896 Te/Exp=0.2112]100%|██████████| 2/2 [00:10<00:00,  4.62s/it, CE=2.276553e+00 H=2.276330e+00 dV_dx=-3.375829e-06 dV_dθ=-2.194677e-04 ||∇||=4.465493e-01 | Tr=0.1831 Te/Cur=0.2896 Te/Exp=0.2112]100%|██████████| 2/2 [00:10<00:00,  5.02s/it, CE=2.276553e+00 H=2.276330e+00 dV_dx=-3.375829e-06 dV_dθ=-2.194677e-04 ||∇||=4.465493e-01 | Tr=0.1831 Te/Cur=0.2896 Te/Exp=0.2112]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.85s/it] 50%|█████     | 1/2 [00:16<00:13, 13.85s/it, CE=2.256876e+00 H=2.256690e+00 dV_dx=-2.825675e-06 dV_dθ=-1.829385e-04 ||∇||=4.182945e-01 | Tr=0.2599 Te/Cur=0.3501 Te/Exp=0.2227]100%|██████████| 2/2 [00:16<00:00,  7.52s/it, CE=2.256876e+00 H=2.256690e+00 dV_dx=-2.825675e-06 dV_dθ=-1.829385e-04 ||∇||=4.182945e-01 | Tr=0.2599 Te/Cur=0.3501 Te/Exp=0.2227]100%|██████████| 2/2 [00:16<00:00,  8.47s/it, CE=2.256876e+00 H=2.256690e+00 dV_dx=-2.825675e-06 dV_dθ=-1.829385e-04 ||∇||=4.182945e-01 | Tr=0.2599 Te/Cur=0.3501 Te/Exp=0.2227]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 612, 84, 10]) with loss 2.256876
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.44s/it] 50%|█████     | 1/2 [00:16<00:13, 13.44s/it, CE=2.260156e+00 H=2.259941e+00 dV_dx=9.083554e-06 dV_dθ=-2.234497e-04 ||∇||=4.421649e-01 | Tr=0.3151 Te/Cur=0.3805 Te/Exp=0.2337]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.260156e+00 H=2.259941e+00 dV_dx=9.083554e-06 dV_dθ=-2.234497e-04 ||∇||=4.421649e-01 | Tr=0.3151 Te/Cur=0.3805 Te/Exp=0.2337]100%|██████████| 2/2 [00:16<00:00,  8.22s/it, CE=2.260156e+00 H=2.259941e+00 dV_dx=9.083554e-06 dV_dθ=-2.234497e-04 ||∇||=4.421649e-01 | Tr=0.3151 Te/Cur=0.3805 Te/Exp=0.2337]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.17s/it] 50%|█████     | 1/2 [00:07<00:05,  5.17s/it, CE=2.248059e+00 H=2.247842e+00 dV_dx=-4.886116e-06 dV_dθ=-2.115559e-04 ||∇||=4.143448e-01 | Tr=0.2237 Te/Cur=0.2758 Te/Exp=0.2348]100%|██████████| 2/2 [00:07<00:00,  3.79s/it, CE=2.248059e+00 H=2.247842e+00 dV_dx=-4.886116e-06 dV_dθ=-2.115559e-04 ||∇||=4.143448e-01 | Tr=0.2237 Te/Cur=0.2758 Te/Exp=0.2348]100%|██████████| 2/2 [00:07<00:00,  4.00s/it, CE=2.248059e+00 H=2.247842e+00 dV_dx=-4.886116e-06 dV_dθ=-2.115559e-04 ||∇||=4.143448e-01 | Tr=0.2237 Te/Cur=0.2758 Te/Exp=0.2348]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 124, 10]) with loss 2.248059
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.89s/it] 50%|█████     | 1/2 [00:15<00:12, 12.89s/it, CE=2.249064e+00 H=2.248835e+00 dV_dx=-2.316813e-06 dV_dθ=-2.272678e-04 ||∇||=4.425634e-01 | Tr=0.2220 Te/Cur=0.2905 Te/Exp=0.2828]100%|██████████| 2/2 [00:15<00:00,  6.95s/it, CE=2.249064e+00 H=2.248835e+00 dV_dx=-2.316813e-06 dV_dθ=-2.272678e-04 ||∇||=4.425634e-01 | Tr=0.2220 Te/Cur=0.2905 Te/Exp=0.2828]100%|██████████| 2/2 [00:15<00:00,  7.84s/it, CE=2.249064e+00 H=2.248835e+00 dV_dx=-2.316813e-06 dV_dθ=-2.272678e-04 ||∇||=4.425634e-01 | Tr=0.2220 Te/Cur=0.2905 Te/Exp=0.2828]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.17s/it] 50%|█████     | 1/2 [00:19<00:16, 16.17s/it, CE=2.241551e+00 H=2.241350e+00 dV_dx=1.172467e-05 dV_dθ=-2.122817e-04 ||∇||=3.962875e-01 | Tr=0.3555 Te/Cur=0.4044 Te/Exp=0.2687]100%|██████████| 2/2 [00:19<00:00,  8.46s/it, CE=2.241551e+00 H=2.241350e+00 dV_dx=1.172467e-05 dV_dθ=-2.122817e-04 ||∇||=3.962875e-01 | Tr=0.3555 Te/Cur=0.4044 Te/Exp=0.2687]100%|██████████| 2/2 [00:19<00:00,  9.62s/it, CE=2.241551e+00 H=2.241350e+00 dV_dx=1.172467e-05 dV_dθ=-2.122817e-04 ||∇||=3.962875e-01 | Tr=0.3555 Te/Cur=0.4044 Te/Exp=0.2687]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 532, 164, 10]) with loss 2.241551
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.29s/it] 50%|█████     | 1/2 [00:15<00:13, 13.29s/it, CE=2.248820e+00 H=2.248628e+00 dV_dx=-1.167730e-05 dV_dθ=-1.797099e-04 ||∇||=4.082604e-01 | Tr=0.1847 Te/Cur=0.2121 Te/Exp=0.2396]100%|██████████| 2/2 [00:15<00:00,  6.99s/it, CE=2.248820e+00 H=2.248628e+00 dV_dx=-1.167730e-05 dV_dθ=-1.797099e-04 ||∇||=4.082604e-01 | Tr=0.1847 Te/Cur=0.2121 Te/Exp=0.2396]100%|██████████| 2/2 [00:15<00:00,  7.94s/it, CE=2.248820e+00 H=2.248628e+00 dV_dx=-1.167730e-05 dV_dθ=-1.797099e-04 ||∇||=4.082604e-01 | Tr=0.1847 Te/Cur=0.2121 Te/Exp=0.2396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.57s/it] 50%|█████     | 1/2 [00:16<00:13, 13.57s/it, CE=2.250457e+00 H=2.250258e+00 dV_dx=-6.405605e-06 dV_dθ=-1.922276e-04 ||∇||=4.358298e-01 | Tr=0.2308 Te/Cur=0.2569 Te/Exp=0.2536]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.250457e+00 H=2.250258e+00 dV_dx=-6.405605e-06 dV_dθ=-1.922276e-04 ||∇||=4.358298e-01 | Tr=0.2308 Te/Cur=0.2569 Te/Exp=0.2536]100%|██████████| 2/2 [00:16<00:00,  8.31s/it, CE=2.250457e+00 H=2.250258e+00 dV_dx=-6.405605e-06 dV_dθ=-1.922276e-04 ||∇||=4.358298e-01 | Tr=0.2308 Te/Cur=0.2569 Te/Exp=0.2536]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.25s/it] 50%|█████     | 1/2 [00:08<00:05,  5.25s/it, CE=2.272811e+00 H=2.272607e+00 dV_dx=-5.495668e-06 dV_dθ=-1.982528e-04 ||∇||=4.311348e-01 | Tr=0.1844 Te/Cur=0.2047 Te/Exp=0.1930]100%|██████████| 2/2 [00:08<00:00,  3.79s/it, CE=2.272811e+00 H=2.272607e+00 dV_dx=-5.495668e-06 dV_dθ=-1.982528e-04 ||∇||=4.311348e-01 | Tr=0.1844 Te/Cur=0.2047 Te/Exp=0.1930]100%|██████████| 2/2 [00:08<00:00,  4.00s/it, CE=2.272811e+00 H=2.272607e+00 dV_dx=-5.495668e-06 dV_dθ=-1.982528e-04 ||∇||=4.311348e-01 | Tr=0.1844 Te/Cur=0.2047 Te/Exp=0.1930]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.58s/it] 50%|█████     | 1/2 [00:07<00:04,  4.58s/it, CE=2.262837e+00 H=2.262619e+00 dV_dx=-4.425857e-06 dV_dθ=-2.128619e-04 ||∇||=4.148522e-01 | Tr=0.1752 Te/Cur=0.2384 Te/Exp=0.2076]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.262837e+00 H=2.262619e+00 dV_dx=-4.425857e-06 dV_dθ=-2.128619e-04 ||∇||=4.148522e-01 | Tr=0.1752 Te/Cur=0.2384 Te/Exp=0.2076]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.262837e+00 H=2.262619e+00 dV_dx=-4.425857e-06 dV_dθ=-2.128619e-04 ||∇||=4.148522e-01 | Tr=0.1752 Te/Cur=0.2384 Te/Exp=0.2076]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.91s/it] 50%|█████     | 1/2 [00:16<00:13, 13.91s/it, CE=2.246171e+00 H=2.245951e+00 dV_dx=4.560809e-06 dV_dθ=-2.245608e-04 ||∇||=4.276921e-01 | Tr=0.2266 Te/Cur=0.2468 Te/Exp=0.2409]100%|██████████| 2/2 [00:16<00:00,  7.50s/it, CE=2.246171e+00 H=2.245951e+00 dV_dx=4.560809e-06 dV_dθ=-2.245608e-04 ||∇||=4.276921e-01 | Tr=0.2266 Te/Cur=0.2468 Te/Exp=0.2409]100%|██████████| 2/2 [00:16<00:00,  8.47s/it, CE=2.246171e+00 H=2.245951e+00 dV_dx=4.560809e-06 dV_dθ=-2.245608e-04 ||∇||=4.276921e-01 | Tr=0.2266 Te/Cur=0.2468 Te/Exp=0.2409]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.86s/it] 50%|█████     | 1/2 [00:18<00:15, 15.86s/it, CE=2.270060e+00 H=2.269815e+00 dV_dx=7.068780e-07 dV_dθ=-2.465822e-04 ||∇||=4.266452e-01 | Tr=0.2052 Te/Cur=0.2492 Te/Exp=0.2029]100%|██████████| 2/2 [00:18<00:00,  8.24s/it, CE=2.270060e+00 H=2.269815e+00 dV_dx=7.068780e-07 dV_dθ=-2.465822e-04 ||∇||=4.266452e-01 | Tr=0.2052 Te/Cur=0.2492 Te/Exp=0.2029]100%|██████████| 2/2 [00:18<00:00,  9.38s/it, CE=2.270060e+00 H=2.269815e+00 dV_dx=7.068780e-07 dV_dθ=-2.465822e-04 ||∇||=4.266452e-01 | Tr=0.2052 Te/Cur=0.2492 Te/Exp=0.2029]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.47s/it] 50%|█████     | 1/2 [00:07<00:04,  4.47s/it, CE=2.269989e+00 H=2.269790e+00 dV_dx=-2.072377e-05 dV_dθ=-1.783157e-04 ||∇||=4.038695e-01 | Tr=0.2269 Te/Cur=0.2844 Te/Exp=0.2390]100%|██████████| 2/2 [00:07<00:00,  3.41s/it, CE=2.269989e+00 H=2.269790e+00 dV_dx=-2.072377e-05 dV_dθ=-1.783157e-04 ||∇||=4.038695e-01 | Tr=0.2269 Te/Cur=0.2844 Te/Exp=0.2390]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.269989e+00 H=2.269790e+00 dV_dx=-2.072377e-05 dV_dθ=-1.783157e-04 ||∇||=4.038695e-01 | Tr=0.2269 Te/Cur=0.2844 Te/Exp=0.2390]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.17s/it] 50%|█████     | 1/2 [00:16<00:13, 13.17s/it, CE=2.248970e+00 H=2.248747e+00 dV_dx=-2.160446e-06 dV_dθ=-2.210172e-04 ||∇||=4.181655e-01 | Tr=0.1746 Te/Cur=0.2198 Te/Exp=0.2722]100%|██████████| 2/2 [00:16<00:00,  7.16s/it, CE=2.248970e+00 H=2.248747e+00 dV_dx=-2.160446e-06 dV_dθ=-2.210172e-04 ||∇||=4.181655e-01 | Tr=0.1746 Te/Cur=0.2198 Te/Exp=0.2722]100%|██████████| 2/2 [00:16<00:00,  8.06s/it, CE=2.248970e+00 H=2.248747e+00 dV_dx=-2.160446e-06 dV_dθ=-2.210172e-04 ||∇||=4.181655e-01 | Tr=0.1746 Te/Cur=0.2198 Te/Exp=0.2722]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.86s/it] 50%|█████     | 1/2 [00:15<00:12, 12.86s/it, CE=2.270466e+00 H=2.270229e+00 dV_dx=5.478127e-06 dV_dθ=-2.424239e-04 ||∇||=4.477493e-01 | Tr=0.1909 Te/Cur=0.2217 Te/Exp=0.1805]100%|██████████| 2/2 [00:15<00:00,  6.96s/it, CE=2.270466e+00 H=2.270229e+00 dV_dx=5.478127e-06 dV_dθ=-2.424239e-04 ||∇||=4.477493e-01 | Tr=0.1909 Te/Cur=0.2217 Te/Exp=0.1805]100%|██████████| 2/2 [00:15<00:00,  7.85s/it, CE=2.270466e+00 H=2.270229e+00 dV_dx=5.478127e-06 dV_dθ=-2.424239e-04 ||∇||=4.477493e-01 | Tr=0.1909 Te/Cur=0.2217 Te/Exp=0.1805]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.95s/it] 50%|█████     | 1/2 [00:16<00:13, 13.95s/it, CE=2.246916e+00 H=2.246662e+00 dV_dx=5.428508e-06 dV_dθ=-2.594030e-04 ||∇||=4.380677e-01 | Tr=0.2184 Te/Cur=0.2911 Te/Exp=0.2536]100%|██████████| 2/2 [00:16<00:00,  7.53s/it, CE=2.246916e+00 H=2.246662e+00 dV_dx=5.428508e-06 dV_dθ=-2.594030e-04 ||∇||=4.380677e-01 | Tr=0.2184 Te/Cur=0.2911 Te/Exp=0.2536]100%|██████████| 2/2 [00:16<00:00,  8.49s/it, CE=2.246916e+00 H=2.246662e+00 dV_dx=5.428508e-06 dV_dθ=-2.594030e-04 ||∇||=4.380677e-01 | Tr=0.2184 Te/Cur=0.2911 Te/Exp=0.2536]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.87s/it] 50%|█████     | 1/2 [00:18<00:15, 15.87s/it, CE=2.235816e+00 H=2.235567e+00 dV_dx=4.536420e-06 dV_dθ=-2.533191e-04 ||∇||=4.415374e-01 | Tr=0.2427 Te/Cur=0.2620 Te/Exp=0.2536]100%|██████████| 2/2 [00:18<00:00,  8.30s/it, CE=2.235816e+00 H=2.235567e+00 dV_dx=4.536420e-06 dV_dθ=-2.533191e-04 ||∇||=4.415374e-01 | Tr=0.2427 Te/Cur=0.2620 Te/Exp=0.2536]100%|██████████| 2/2 [00:18<00:00,  9.44s/it, CE=2.235816e+00 H=2.235567e+00 dV_dx=4.536420e-06 dV_dθ=-2.533191e-04 ||∇||=4.415374e-01 | Tr=0.2427 Te/Cur=0.2620 Te/Exp=0.2536]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 612, 164, 10]) with loss 2.235816
  Grid search complete.
  Best architecture: (4, [432, 612, 164, 10]) with loss 2.235816
  Total candidates evaluated: 54
  Original: (2, [507, 572, 104, 10])
  Optimal: (4, [432, 612, 164, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→4, feed [507, 572, 104, 10]→[432, 612, 164, 10]
  Conv filter changed: A_conv/B_conv shape = (4, 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:19<06:16, 19.83s/it]  5%|▌         | 1/20 [00:24<06:16, 19.83s/it, CE=1.539843e+00 H=1.537174e+00 dV_dx=4.960853e-06 dV_dθ=-2.674273e-03 ||∇||=2.967972e+00 | Tr=0.8995] 10%|█         | 2/20 [00:24<03:13, 10.76s/it, CE=1.539843e+00 H=1.537174e+00 dV_dx=4.960853e-06 dV_dθ=-2.674273e-03 ||∇||=2.967972e+00 | Tr=0.8995] 10%|█         | 2/20 [00:29<03:13, 10.76s/it, CE=1.344607e+00 H=1.338604e+00 dV_dx=-2.445398e-06 dV_dθ=-6.001257e-03 ||∇||=3.227348e+00 | Tr=0.8995] 15%|█▌        | 3/20 [00:29<02:21,  8.35s/it, CE=1.344607e+00 H=1.338604e+00 dV_dx=-2.445398e-06 dV_dθ=-6.001257e-03 ||∇||=3.227348e+00 | Tr=0.8995] 15%|█▌        | 3/20 [00:34<02:21,  8.35s/it, CE=1.218243e+00 H=1.210184e+00 dV_dx=2.330273e-05 dV_dθ=-8.082445e-03 ||∇||=3.473727e+00 | Tr=0.8995]  20%|██        | 4/20 [00:34<01:49,  6.84s/it, CE=1.218243e+00 H=1.210184e+00 dV_dx=2.330273e-05 dV_dθ=-8.082445e-03 ||∇||=3.473727e+00 | Tr=0.8995] 20%|██        | 4/20 [00:39<01:49,  6.84s/it, CE=1.124612e+00 H=1.114803e+00 dV_dx=-3.344477e-05 dV_dθ=-9.775693e-03 ||∇||=3.658845e+00 | Tr=0.8995] 25%|██▌       | 5/20 [00:39<01:32,  6.15s/it, CE=1.124612e+00 H=1.114803e+00 dV_dx=-3.344477e-05 dV_dθ=-9.775693e-03 ||∇||=3.658845e+00 | Tr=0.8995] 25%|██▌       | 5/20 [00:43<01:32,  6.15s/it, CE=1.053068e+00 H=1.041783e+00 dV_dx=-6.306723e-06 dV_dθ=-1.127874e-02 ||∇||=3.845890e+00 | Tr=0.8995] 30%|███       | 6/20 [00:43<01:15,  5.41s/it, CE=1.053068e+00 H=1.041783e+00 dV_dx=-6.306723e-06 dV_dθ=-1.127874e-02 ||∇||=3.845890e+00 | Tr=0.8995] 30%|███       | 6/20 [00:47<01:15,  5.41s/it, CE=9.942031e-01 H=9.854789e-01 dV_dx=3.574535e-05 dV_dθ=-8.759901e-03 ||∇||=3.641561e+00 | Tr=0.8995]  35%|███▌      | 7/20 [00:47<01:06,  5.08s/it, CE=9.942031e-01 H=9.854789e-01 dV_dx=3.574535e-05 dV_dθ=-8.759901e-03 ||∇||=3.641561e+00 | Tr=0.8995] 35%|███▌      | 7/20 [00:51<01:06,  5.08s/it, CE=9.450503e-01 H=9.367190e-01 dV_dx=-5.314431e-06 dV_dθ=-8.325969e-03 ||∇||=3.635412e+00 | Tr=0.8995] 40%|████      | 8/20 [00:51<00:58,  4.85s/it, CE=9.450503e-01 H=9.367190e-01 dV_dx=-5.314431e-06 dV_dθ=-8.325969e-03 ||∇||=3.635412e+00 | Tr=0.8995] 40%|████      | 8/20 [00:56<00:58,  4.85s/it, CE=9.051459e-01 H=8.968366e-01 dV_dx=5.702564e-05 dV_dθ=-8.366351e-03 ||∇||=3.723079e+00 | Tr=0.8995]  45%|████▌     | 9/20 [00:56<00:52,  4.79s/it, CE=9.051459e-01 H=8.968366e-01 dV_dx=5.702564e-05 dV_dθ=-8.366351e-03 ||∇||=3.723079e+00 | Tr=0.8995] 45%|████▌     | 9/20 [01:01<00:52,  4.79s/it, CE=8.708338e-01 H=8.624784e-01 dV_dx=2.722393e-05 dV_dθ=-8.382646e-03 ||∇||=3.782399e+00 | Tr=0.8995] 50%|█████     | 10/20 [01:01<00:47,  4.70s/it, CE=8.708338e-01 H=8.624784e-01 dV_dx=2.722393e-05 dV_dθ=-8.382646e-03 ||∇||=3.782399e+00 | Tr=0.8995] 50%|█████     | 10/20 [01:05<00:47,  4.70s/it, CE=8.405855e-01 H=8.328021e-01 dV_dx=-1.796160e-05 dV_dθ=-7.765451e-03 ||∇||=3.743137e+00 | Tr=0.8995] 55%|█████▌    | 11/20 [01:05<00:42,  4.76s/it, CE=8.405855e-01 H=8.328021e-01 dV_dx=-1.796160e-05 dV_dθ=-7.765451e-03 ||∇||=3.743137e+00 | Tr=0.8995] 55%|█████▌    | 11/20 [01:10<00:42,  4.76s/it, CE=8.146594e-01 H=8.066416e-01 dV_dx=-3.642328e-05 dV_dθ=-7.981316e-03 ||∇||=3.756101e+00 | Tr=0.8995] 60%|██████    | 12/20 [01:10<00:37,  4.71s/it, CE=8.146594e-01 H=8.066416e-01 dV_dx=-3.642328e-05 dV_dθ=-7.981316e-03 ||∇||=3.756101e+00 | Tr=0.8995] 60%|██████    | 12/20 [01:15<00:37,  4.71s/it, CE=7.926537e-01 H=7.843816e-01 dV_dx=7.178306e-05 dV_dθ=-8.343908e-03 ||∇||=3.811833e+00 | Tr=0.8995]  65%|██████▌   | 13/20 [01:15<00:32,  4.65s/it, CE=7.926537e-01 H=7.843816e-01 dV_dx=7.178306e-05 dV_dθ=-8.343908e-03 ||∇||=3.811833e+00 | Tr=0.8995] 65%|██████▌   | 13/20 [01:20<00:32,  4.65s/it, CE=7.724394e-01 H=7.648809e-01 dV_dx=4.453479e-05 dV_dθ=-7.602990e-03 ||∇||=3.715744e+00 | Tr=0.8995] 70%|███████   | 14/20 [01:20<00:28,  4.78s/it, CE=7.724394e-01 H=7.648809e-01 dV_dx=4.453479e-05 dV_dθ=-7.602990e-03 ||∇||=3.715744e+00 | Tr=0.8995] 70%|███████   | 14/20 [01:24<00:28,  4.78s/it, CE=7.537447e-01 H=7.465672e-01 dV_dx=-4.263324e-05 dV_dθ=-7.134811e-03 ||∇||=3.600257e+00 | Tr=0.8995] 75%|███████▌  | 15/20 [01:24<00:23,  4.67s/it, CE=7.537447e-01 H=7.465672e-01 dV_dx=-4.263324e-05 dV_dθ=-7.134811e-03 ||∇||=3.600257e+00 | Tr=0.8995] 75%|███████▌  | 15/20 [01:29<00:23,  4.67s/it, CE=7.357088e-01 H=7.297759e-01 dV_dx=4.913363e-05 dV_dθ=-5.982003e-03 ||∇||=3.409874e+00 | Tr=0.8995]  80%|████████  | 16/20 [01:29<00:18,  4.75s/it, CE=7.357088e-01 H=7.297759e-01 dV_dx=4.913363e-05 dV_dθ=-5.982003e-03 ||∇||=3.409874e+00 | Tr=0.8995] 80%|████████  | 16/20 [01:34<00:18,  4.75s/it, CE=7.200070e-01 H=7.144847e-01 dV_dx=4.144833e-07 dV_dθ=-5.522707e-03 ||∇||=3.329233e+00 | Tr=0.8995] 85%|████████▌ | 17/20 [01:34<00:14,  4.82s/it, CE=7.200070e-01 H=7.144847e-01 dV_dx=4.144833e-07 dV_dθ=-5.522707e-03 ||∇||=3.329233e+00 | Tr=0.8995] 85%|████████▌ | 17/20 [01:39<00:14,  4.82s/it, CE=7.061389e-01 H=7.005029e-01 dV_dx=-5.251224e-05 dV_dθ=-5.583524e-03 ||∇||=3.305856e+00 | Tr=0.8995] 90%|█████████ | 18/20 [01:39<00:09,  4.78s/it, CE=7.061389e-01 H=7.005029e-01 dV_dx=-5.251224e-05 dV_dθ=-5.583524e-03 ||∇||=3.305856e+00 | Tr=0.8995] 90%|█████████ | 18/20 [01:43<00:09,  4.78s/it, CE=6.935920e-01 H=6.878920e-01 dV_dx=-4.524205e-05 dV_dθ=-5.654745e-03 ||∇||=3.328852e+00 | Tr=0.8995] 95%|█████████▌| 19/20 [01:43<00:04,  4.70s/it, CE=6.935920e-01 H=6.878920e-01 dV_dx=-4.524205e-05 dV_dθ=-5.654745e-03 ||∇||=3.328852e+00 | Tr=0.8995] 95%|█████████▌| 19/20 [01:52<00:04,  4.70s/it, CE=6.825096e-01 H=6.761269e-01 dV_dx=-6.094204e-05 dV_dθ=-6.321708e-03 ||∇||=3.492443e+00 | Tr=0.8995 Te/Cur=0.9434 Te/Exp=0.7485]100%|██████████| 20/20 [01:57<00:00,  7.38s/it, CE=6.825096e-01 H=6.761269e-01 dV_dx=-6.094204e-05 dV_dθ=-6.321708e-03 ||∇||=3.492443e+00 | Tr=0.8995 Te/Cur=0.9434 Te/Exp=0.7485]100%|██████████| 20/20 [01:57<00:00,  5.86s/it, CE=6.825096e-01 H=6.761269e-01 dV_dx=-6.094204e-05 dV_dθ=-6.321708e-03 ||∇||=3.492443e+00 | Tr=0.8995 Te/Cur=0.9434 Te/Exp=0.7485]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.607598
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:20, 10.54s/it]  5%|▌         | 1/20 [00:15<03:20, 10.54s/it, CE=7.070974e-01 H=7.000691e-01 dV_dx=-1.633994e-05 dV_dθ=-7.011983e-03 ||∇||=3.980235e+00 | Tr=0.8997] 10%|█         | 2/20 [00:15<02:08,  7.14s/it, CE=7.070974e-01 H=7.000691e-01 dV_dx=-1.633994e-05 dV_dθ=-7.011983e-03 ||∇||=3.980235e+00 | Tr=0.8997] 10%|█         | 2/20 [00:19<02:08,  7.14s/it, CE=6.971511e-01 H=6.866728e-01 dV_dx=7.367767e-05 dV_dθ=-1.055194e-02 ||∇||=4.467680e+00 | Tr=0.8997]  15%|█▌        | 3/20 [00:19<01:35,  5.61s/it, CE=6.971511e-01 H=6.866728e-01 dV_dx=7.367767e-05 dV_dθ=-1.055194e-02 ||∇||=4.467680e+00 | Tr=0.8997] 15%|█▌        | 3/20 [00:23<01:35,  5.61s/it, CE=6.879285e-01 H=6.743392e-01 dV_dx=-7.376456e-05 dV_dθ=-1.351555e-02 ||∇||=4.703944e+00 | Tr=0.8997] 20%|██        | 4/20 [00:23<01:23,  5.22s/it, CE=6.879285e-01 H=6.743392e-01 dV_dx=-7.376456e-05 dV_dθ=-1.351555e-02 ||∇||=4.703944e+00 | Tr=0.8997] 20%|██        | 4/20 [00:27<01:23,  5.22s/it, CE=6.733871e-01 H=6.619933e-01 dV_dx=-1.063165e-04 dV_dθ=-1.128746e-02 ||∇||=4.332469e+00 | Tr=0.8997] 25%|██▌       | 5/20 [00:27<01:12,  4.86s/it, CE=6.733871e-01 H=6.619933e-01 dV_dx=-1.063165e-04 dV_dθ=-1.128746e-02 ||∇||=4.332469e+00 | Tr=0.8997] 25%|██▌       | 5/20 [00:32<01:12,  4.86s/it, CE=6.624765e-01 H=6.502983e-01 dV_dx=6.614290e-05 dV_dθ=-1.224438e-02 ||∇||=4.372905e+00 | Tr=0.8997]  30%|███       | 6/20 [00:32<01:08,  4.86s/it, CE=6.624765e-01 H=6.502983e-01 dV_dx=6.614290e-05 dV_dθ=-1.224438e-02 ||∇||=4.372905e+00 | Tr=0.8997] 30%|███       | 6/20 [00:37<01:08,  4.86s/it, CE=6.533291e-01 H=6.414057e-01 dV_dx=7.676169e-06 dV_dθ=-1.193115e-02 ||∇||=4.338865e+00 | Tr=0.8997] 35%|███▌      | 7/20 [00:37<01:02,  4.80s/it, CE=6.533291e-01 H=6.414057e-01 dV_dx=7.676169e-06 dV_dθ=-1.193115e-02 ||∇||=4.338865e+00 | Tr=0.8997] 35%|███▌      | 7/20 [00:42<01:02,  4.80s/it, CE=6.461172e-01 H=6.346482e-01 dV_dx=-3.917127e-05 dV_dθ=-1.142982e-02 ||∇||=4.307206e+00 | Tr=0.8997] 40%|████      | 8/20 [00:42<00:57,  4.79s/it, CE=6.461172e-01 H=6.346482e-01 dV_dx=-3.917127e-05 dV_dθ=-1.142982e-02 ||∇||=4.307206e+00 | Tr=0.8997] 40%|████      | 8/20 [00:46<00:57,  4.79s/it, CE=6.356534e-01 H=6.268696e-01 dV_dx=-3.643129e-06 dV_dθ=-8.780132e-03 ||∇||=3.936187e+00 | Tr=0.8997] 45%|████▌     | 9/20 [00:46<00:51,  4.65s/it, CE=6.356534e-01 H=6.268696e-01 dV_dx=-3.643129e-06 dV_dθ=-8.780132e-03 ||∇||=3.936187e+00 | Tr=0.8997] 45%|████▌     | 9/20 [00:51<00:51,  4.65s/it, CE=6.216745e-01 H=6.157970e-01 dV_dx=8.403587e-05 dV_dθ=-5.961556e-03 ||∇||=3.487752e+00 | Tr=0.8997]  50%|█████     | 10/20 [00:51<00:47,  4.75s/it, CE=6.216745e-01 H=6.157970e-01 dV_dx=8.403587e-05 dV_dθ=-5.961556e-03 ||∇||=3.487752e+00 | Tr=0.8997] 50%|█████     | 10/20 [00:55<00:47,  4.75s/it, CE=6.095843e-01 H=6.053501e-01 dV_dx=6.563402e-05 dV_dθ=-4.299765e-03 ||∇||=3.188275e+00 | Tr=0.8997] 55%|█████▌    | 11/20 [00:55<00:41,  4.64s/it, CE=6.095843e-01 H=6.053501e-01 dV_dx=6.563402e-05 dV_dθ=-4.299765e-03 ||∇||=3.188275e+00 | Tr=0.8997] 55%|█████▌    | 11/20 [01:00<00:41,  4.64s/it, CE=6.016113e-01 H=5.975260e-01 dV_dx=9.451679e-07 dV_dθ=-4.086332e-03 ||∇||=3.151433e+00 | Tr=0.8997] 60%|██████    | 12/20 [01:00<00:36,  4.56s/it, CE=6.016113e-01 H=5.975260e-01 dV_dx=9.451679e-07 dV_dθ=-4.086332e-03 ||∇||=3.151433e+00 | Tr=0.8997] 60%|██████    | 12/20 [01:04<00:36,  4.56s/it, CE=5.952281e-01 H=5.910496e-01 dV_dx=5.475280e-05 dV_dθ=-4.233219e-03 ||∇||=3.207445e+00 | Tr=0.8997] 65%|██████▌   | 13/20 [01:04<00:31,  4.46s/it, CE=5.952281e-01 H=5.910496e-01 dV_dx=5.475280e-05 dV_dθ=-4.233219e-03 ||∇||=3.207445e+00 | Tr=0.8997] 65%|██████▌   | 13/20 [01:08<00:31,  4.46s/it, CE=5.893188e-01 H=5.850748e-01 dV_dx=3.140172e-05 dV_dθ=-4.275455e-03 ||∇||=3.219687e+00 | Tr=0.8997] 70%|███████   | 14/20 [01:08<00:26,  4.43s/it, CE=5.893188e-01 H=5.850748e-01 dV_dx=3.140172e-05 dV_dθ=-4.275455e-03 ||∇||=3.219687e+00 | Tr=0.8997] 70%|███████   | 14/20 [01:13<00:26,  4.43s/it, CE=5.838956e-01 H=5.793561e-01 dV_dx=-8.548477e-05 dV_dθ=-4.454062e-03 ||∇||=3.262539e+00 | Tr=0.8997] 75%|███████▌  | 15/20 [01:13<00:22,  4.48s/it, CE=5.838956e-01 H=5.793561e-01 dV_dx=-8.548477e-05 dV_dθ=-4.454062e-03 ||∇||=3.262539e+00 | Tr=0.8997] 75%|███████▌  | 15/20 [01:18<00:22,  4.48s/it, CE=5.780991e-01 H=5.739223e-01 dV_dx=6.008931e-05 dV_dθ=-4.236884e-03 ||∇||=3.241857e+00 | Tr=0.8997]  80%|████████  | 16/20 [01:18<00:18,  4.51s/it, CE=5.780991e-01 H=5.739223e-01 dV_dx=6.008931e-05 dV_dθ=-4.236884e-03 ||∇||=3.241857e+00 | Tr=0.8997] 80%|████████  | 16/20 [01:23<00:18,  4.51s/it, CE=5.732032e-01 H=5.689196e-01 dV_dx=5.009707e-05 dV_dθ=-4.333758e-03 ||∇||=3.268166e+00 | Tr=0.8997] 85%|████████▌ | 17/20 [01:23<00:13,  4.65s/it, CE=5.732032e-01 H=5.689196e-01 dV_dx=5.009707e-05 dV_dθ=-4.333758e-03 ||∇||=3.268166e+00 | Tr=0.8997] 85%|████████▌ | 17/20 [01:27<00:13,  4.65s/it, CE=5.689105e-01 H=5.638431e-01 dV_dx=1.148973e-04 dV_dθ=-5.182341e-03 ||∇||=3.404385e+00 | Tr=0.8997] 90%|█████████ | 18/20 [01:27<00:09,  4.57s/it, CE=5.689105e-01 H=5.638431e-01 dV_dx=1.148973e-04 dV_dθ=-5.182341e-03 ||∇||=3.404385e+00 | Tr=0.8997] 90%|█████████ | 18/20 [01:32<00:09,  4.57s/it, CE=5.644610e-01 H=5.588648e-01 dV_dx=5.118102e-05 dV_dθ=-5.647385e-03 ||∇||=3.505599e+00 | Tr=0.8997] 95%|█████████▌| 19/20 [01:32<00:04,  4.68s/it, CE=5.644610e-01 H=5.588648e-01 dV_dx=5.118102e-05 dV_dθ=-5.647385e-03 ||∇||=3.505599e+00 | Tr=0.8997] 95%|█████████▌| 19/20 [01:39<00:04,  4.68s/it, CE=5.604986e-01 H=5.550669e-01 dV_dx=5.882494e-05 dV_dθ=-5.490585e-03 ||∇||=3.547886e+00 | Tr=0.8997 Te/Cur=0.9616 Te/Exp=0.7683]100%|██████████| 20/20 [01:45<00:00,  7.10s/it, CE=5.604986e-01 H=5.550669e-01 dV_dx=5.882494e-05 dV_dθ=-5.490585e-03 ||∇||=3.547886e+00 | Tr=0.8997 Te/Cur=0.9616 Te/Exp=0.7683]100%|██████████| 20/20 [01:45<00:00,  5.26s/it, CE=5.604986e-01 H=5.550669e-01 dV_dx=5.882494e-05 dV_dθ=-5.490585e-03 ||∇||=3.547886e+00 | Tr=0.8997 Te/Cur=0.9616 Te/Exp=0.7683]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:17<00:17, 17.21s/it] 50%|█████     | 1/2 [00:23<00:17, 17.21s/it, CE=5.866551e-01 H=5.862359e-01 dV_dx=-9.867186e-05 dV_dθ=-3.205199e-04 ||∇||=9.898038e-01 | Tr=0.9865 Te/Cur=0.9701 Te/Exp=0.7850]100%|██████████| 2/2 [00:23<00:00, 10.59s/it, CE=5.866551e-01 H=5.862359e-01 dV_dx=-9.867186e-05 dV_dθ=-3.205199e-04 ||∇||=9.898038e-01 | Tr=0.9865 Te/Cur=0.9701 Te/Exp=0.7850]100%|██████████| 2/2 [00:23<00:00, 11.58s/it, CE=5.866551e-01 H=5.862359e-01 dV_dx=-9.867186e-05 dV_dθ=-3.205199e-04 ||∇||=9.898038e-01 | Tr=0.9865 Te/Cur=0.9701 Te/Exp=0.7850]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:19, 10.52s/it]  5%|▌         | 1/20 [00:14<03:19, 10.52s/it, CE=5.845627e-01 H=5.842575e-01 dV_dx=-3.254818e-05 dV_dθ=-2.726649e-04 ||∇||=1.040649e+00 | Tr=0.9870] 10%|█         | 2/20 [00:14<02:00,  6.68s/it, CE=5.845627e-01 H=5.842575e-01 dV_dx=-3.254818e-05 dV_dθ=-2.726649e-04 ||∇||=1.040649e+00 | Tr=0.9870] 10%|█         | 2/20 [00:19<02:00,  6.68s/it, CE=5.780042e-01 H=5.777618e-01 dV_dx=9.704546e-06 dV_dθ=-2.520918e-04 ||∇||=1.036582e+00 | Tr=0.9874]  15%|█▌        | 3/20 [00:19<01:40,  5.92s/it, CE=5.780042e-01 H=5.777618e-01 dV_dx=9.704546e-06 dV_dθ=-2.520918e-04 ||∇||=1.036582e+00 | Tr=0.9874] 15%|█▌        | 3/20 [00:24<01:40,  5.92s/it, CE=5.725389e-01 H=5.722570e-01 dV_dx=-2.187001e-05 dV_dθ=-2.600613e-04 ||∇||=1.040384e+00 | Tr=0.9880] 20%|██        | 4/20 [00:24<01:29,  5.62s/it, CE=5.725389e-01 H=5.722570e-01 dV_dx=-2.187001e-05 dV_dθ=-2.600613e-04 ||∇||=1.040384e+00 | Tr=0.9880] 20%|██        | 4/20 [00:29<01:29,  5.62s/it, CE=5.677428e-01 H=5.674898e-01 dV_dx=2.837777e-05 dV_dθ=-2.813856e-04 ||∇||=1.042643e+00 | Tr=0.9886]  25%|██▌       | 5/20 [00:29<01:17,  5.16s/it, CE=5.677428e-01 H=5.674898e-01 dV_dx=2.837777e-05 dV_dθ=-2.813856e-04 ||∇||=1.042643e+00 | Tr=0.9886] 25%|██▌       | 5/20 [00:35<01:17,  5.16s/it, CE=5.632896e-01 H=5.629011e-01 dV_dx=-9.915669e-05 dV_dθ=-2.893776e-04 ||∇||=1.039960e+00 | Tr=0.9892 Te/Cur=0.9695 Te/Exp=0.7900] 30%|███       | 6/20 [00:35<01:17,  5.53s/it, CE=5.632896e-01 H=5.629011e-01 dV_dx=-9.915669e-05 dV_dθ=-2.893776e-04 ||∇||=1.039960e+00 | Tr=0.9892 Te/Cur=0.9695 Te/Exp=0.7900] 30%|███       | 6/20 [00:39<01:17,  5.53s/it, CE=5.590742e-01 H=5.588553e-01 dV_dx=5.488487e-05 dV_dθ=-2.737458e-04 ||∇||=1.028011e+00 | Tr=0.9895]                              35%|███▌      | 7/20 [00:39<01:06,  5.11s/it, CE=5.590742e-01 H=5.588553e-01 dV_dx=5.488487e-05 dV_dθ=-2.737458e-04 ||∇||=1.028011e+00 | Tr=0.9895] 35%|███▌      | 7/20 [00:43<01:06,  5.11s/it, CE=5.553475e-01 H=5.550488e-01 dV_dx=-2.033941e-05 dV_dθ=-2.784190e-04 ||∇||=1.030465e+00 | Tr=0.9897] 40%|████      | 8/20 [00:43<00:56,  4.68s/it, CE=5.553475e-01 H=5.550488e-01 dV_dx=-2.033941e-05 dV_dθ=-2.784190e-04 ||∇||=1.030465e+00 | Tr=0.9897] 40%|████      | 8/20 [00:48<00:56,  4.68s/it, CE=5.516828e-01 H=5.515596e-01 dV_dx=1.523602e-04 dV_dθ=-2.756105e-04 ||∇||=1.027713e+00 | Tr=0.9901]  45%|████▌     | 9/20 [00:48<00:52,  4.74s/it, CE=5.516828e-01 H=5.515596e-01 dV_dx=1.523602e-04 dV_dθ=-2.756105e-04 ||∇||=1.027713e+00 | Tr=0.9901] 45%|████▌     | 9/20 [00:52<00:52,  4.74s/it, CE=5.483154e-01 H=5.481266e-01 dV_dx=7.952364e-05 dV_dθ=-2.683730e-04 ||∇||=1.027775e+00 | Tr=0.9904] 50%|█████     | 10/20 [00:52<00:44,  4.48s/it, CE=5.483154e-01 H=5.481266e-01 dV_dx=7.952364e-05 dV_dθ=-2.683730e-04 ||∇||=1.027775e+00 | Tr=0.9904] 50%|█████     | 10/20 [00:58<00:44,  4.48s/it, CE=5.450289e-01 H=5.446674e-01 dV_dx=-9.306867e-05 dV_dθ=-2.683665e-04 ||∇||=1.023903e+00 | Tr=0.9906 Te/Cur=0.9719 Te/Exp=0.7923] 55%|█████▌    | 11/20 [00:58<00:44,  5.00s/it, CE=5.450289e-01 H=5.446674e-01 dV_dx=-9.306867e-05 dV_dθ=-2.683665e-04 ||∇||=1.023903e+00 | Tr=0.9906 Te/Cur=0.9719 Te/Exp=0.7923] 55%|█████▌    | 11/20 [01:01<00:44,  5.00s/it, CE=5.419209e-01 H=5.415384e-01 dV_dx=-1.146088e-04 dV_dθ=-2.678289e-04 ||∇||=1.020059e+00 | Tr=0.9910]                             60%|██████    | 12/20 [01:01<00:36,  4.57s/it, CE=5.419209e-01 H=5.415384e-01 dV_dx=-1.146088e-04 dV_dθ=-2.678289e-04 ||∇||=1.020059e+00 | Tr=0.9910] 60%|██████    | 12/20 [01:06<00:36,  4.57s/it, CE=5.388580e-01 H=5.386247e-01 dV_dx=1.957844e-05 dV_dθ=-2.528274e-04 ||∇||=1.015910e+00 | Tr=0.9912]  65%|██████▌   | 13/20 [01:06<00:31,  4.51s/it, CE=5.388580e-01 H=5.386247e-01 dV_dx=1.957844e-05 dV_dθ=-2.528274e-04 ||∇||=1.015910e+00 | Tr=0.9912] 65%|██████▌   | 13/20 [01:09<00:31,  4.51s/it, CE=5.359979e-01 H=5.359605e-01 dV_dx=2.160369e-04 dV_dθ=-2.534482e-04 ||∇||=1.015547e+00 | Tr=0.9914] 70%|███████   | 14/20 [01:09<00:25,  4.24s/it, CE=5.359979e-01 H=5.359605e-01 dV_dx=2.160369e-04 dV_dθ=-2.534482e-04 ||∇||=1.015547e+00 | Tr=0.9914] 70%|███████   | 14/20 [01:14<00:25,  4.24s/it, CE=5.332357e-01 H=5.329536e-01 dV_dx=-3.564261e-05 dV_dθ=-2.464592e-04 ||∇||=1.014053e+00 | Tr=0.9918] 75%|███████▌  | 15/20 [01:14<00:21,  4.24s/it, CE=5.332357e-01 H=5.329536e-01 dV_dx=-3.564261e-05 dV_dθ=-2.464592e-04 ||∇||=1.014053e+00 | Tr=0.9918] 75%|███████▌  | 15/20 [01:20<00:21,  4.24s/it, CE=5.304973e-01 H=5.301666e-01 dV_dx=-8.925012e-05 dV_dθ=-2.415042e-04 ||∇||=1.012920e+00 | Tr=0.9920 Te/Cur=0.9720 Te/Exp=0.7973] 80%|████████  | 16/20 [01:20<00:19,  4.89s/it, CE=5.304973e-01 H=5.301666e-01 dV_dx=-8.925012e-05 dV_dθ=-2.415042e-04 ||∇||=1.012920e+00 | Tr=0.9920 Te/Cur=0.9720 Te/Exp=0.7973] 80%|████████  | 16/20 [01:23<00:19,  4.89s/it, CE=5.279247e-01 H=5.276300e-01 dV_dx=-5.810411e-05 dV_dθ=-2.366623e-04 ||∇||=1.012658e+00 | Tr=0.9922]                             85%|████████▌ | 17/20 [01:23<00:12,  4.33s/it, CE=5.279247e-01 H=5.276300e-01 dV_dx=-5.810411e-05 dV_dθ=-2.366623e-04 ||∇||=1.012658e+00 | Tr=0.9922] 85%|████████▌ | 17/20 [01:26<00:12,  4.33s/it, CE=5.253060e-01 H=5.250860e-01 dV_dx=1.763452e-05 dV_dθ=-2.376541e-04 ||∇||=1.012172e+00 | Tr=0.9923]  90%|█████████ | 18/20 [01:26<00:07,  3.93s/it, CE=5.253060e-01 H=5.250860e-01 dV_dx=1.763452e-05 dV_dθ=-2.376541e-04 ||∇||=1.012172e+00 | Tr=0.9923] 90%|█████████ | 18/20 [01:29<00:07,  3.93s/it, CE=5.228780e-01 H=5.226597e-01 dV_dx=2.752000e-05 dV_dθ=-2.458600e-04 ||∇||=1.016712e+00 | Tr=0.9925] 95%|█████████▌| 19/20 [01:29<00:03,  3.61s/it, CE=5.228780e-01 H=5.226597e-01 dV_dx=2.752000e-05 dV_dθ=-2.458600e-04 ||∇||=1.016712e+00 | Tr=0.9925] 95%|█████████▌| 19/20 [01:34<00:03,  3.61s/it, CE=5.203442e-01 H=5.201347e-01 dV_dx=3.154504e-05 dV_dθ=-2.411221e-04 ||∇||=1.012337e+00 | Tr=0.9928 Te/Cur=0.9734 Te/Exp=0.7907]100%|██████████| 20/20 [01:34<00:00,  4.13s/it, CE=5.203442e-01 H=5.201347e-01 dV_dx=3.154504e-05 dV_dθ=-2.411221e-04 ||∇||=1.012337e+00 | Tr=0.9928 Te/Cur=0.9734 Te/Exp=0.7907]100%|██████████| 20/20 [01:34<00:00,  4.73s/it, CE=5.203442e-01 H=5.201347e-01 dV_dx=3.154504e-05 dV_dθ=-2.411221e-04 ||∇||=1.012337e+00 | Tr=0.9928 Te/Cur=0.9734 Te/Exp=0.7907]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 4 final loss: 0.525421
======================================================================


  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7804
    Task 1: 0.9498
    Task 2: 0.8401
    Task 3: 0.6080
    Task 4: 0.9741

============================================================
Task 5
============================================================
Initial loss on new task: 8.9471, previous: 0.5203, ratio: 17.19
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 5
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:16<?, ?it/s, CE=6.317769e-01 H=6.124278e-01 dV_dx=7.939340e-05 dV_dθ=-1.942848e-02 ||∇||=4.533710e+00 | Tr=0.5332 Te/Cur=0.7274 Te/Exp=0.8062]100%|██████████| 1/1 [00:16<00:00, 16.06s/it, CE=6.317769e-01 H=6.124278e-01 dV_dx=7.939340e-05 dV_dθ=-1.942848e-02 ||∇||=4.533710e+00 | Tr=0.5332 Te/Cur=0.7274 Te/Exp=0.8062]100%|██████████| 1/1 [00:16<00:00, 16.06s/it, CE=6.317769e-01 H=6.124278e-01 dV_dx=7.939340e-05 dV_dθ=-1.942848e-02 ||∇||=4.533710e+00 | Tr=0.5332 Te/Cur=0.7274 Te/Exp=0.8062]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.631777

[STEP 2] Architecture change decision
  Current: 0.631777, Previous: 0.520344
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 39932 samples from 10 classes
  Starting grid architecture search for task 5
  Baseline architecture: (4, [432, 612, 164, 10])
  Baseline loss: 0.631777
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.42s/it] 50%|█████     | 1/2 [00:16<00:13, 13.42s/it, CE=2.275938e+00 H=2.275853e+00 dV_dx=1.099941e-06 dV_dθ=-8.570745e-05 ||∇||=4.507360e-01 | Tr=0.1669 Te/Cur=0.1857 Te/Exp=0.2235]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.275938e+00 H=2.275853e+00 dV_dx=1.099941e-06 dV_dθ=-8.570745e-05 ||∇||=4.507360e-01 | Tr=0.1669 Te/Cur=0.1857 Te/Exp=0.2235]100%|██████████| 2/2 [00:16<00:00,  8.21s/it, CE=2.275938e+00 H=2.275853e+00 dV_dx=1.099941e-06 dV_dθ=-8.570745e-05 ||∇||=4.507360e-01 | Tr=0.1669 Te/Cur=0.1857 Te/Exp=0.2235]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.275937619011212
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.95s/it] 50%|█████     | 1/2 [00:10<00:07,  7.95s/it, CE=2.270996e+00 H=2.270921e+00 dV_dx=-8.854773e-08 dV_dθ=-7.538154e-05 ||∇||=4.210790e-01 | Tr=0.1058 Te/Cur=0.1199 Te/Exp=0.2411]100%|██████████| 2/2 [00:10<00:00,  5.02s/it, CE=2.270996e+00 H=2.270921e+00 dV_dx=-8.854773e-08 dV_dθ=-7.538154e-05 ||∇||=4.210790e-01 | Tr=0.1058 Te/Cur=0.1199 Te/Exp=0.2411]100%|██████████| 2/2 [00:10<00:00,  5.46s/it, CE=2.270996e+00 H=2.270921e+00 dV_dx=-8.854773e-08 dV_dθ=-7.538154e-05 ||∇||=4.210790e-01 | Tr=0.1058 Te/Cur=0.1199 Te/Exp=0.2411]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 144, 10]) with loss 2.270996
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.04s/it] 50%|█████     | 1/2 [00:17<00:14, 14.04s/it, CE=2.264072e+00 H=2.264043e+00 dV_dx=9.453272e-07 dV_dθ=-3.011209e-05 ||∇||=4.385668e-01 | Tr=0.1271 Te/Cur=0.1528 Te/Exp=0.2937]100%|██████████| 2/2 [00:17<00:00,  7.86s/it, CE=2.264072e+00 H=2.264043e+00 dV_dx=9.453272e-07 dV_dθ=-3.011209e-05 ||∇||=4.385668e-01 | Tr=0.1271 Te/Cur=0.1528 Te/Exp=0.2937]100%|██████████| 2/2 [00:17<00:00,  8.79s/it, CE=2.264072e+00 H=2.264043e+00 dV_dx=9.453272e-07 dV_dθ=-3.011209e-05 ||∇||=4.385668e-01 | Tr=0.1271 Te/Cur=0.1528 Te/Exp=0.2937]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.264072
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:17<00:17, 17.21s/it] 50%|█████     | 1/2 [00:20<00:17, 17.21s/it, CE=2.276963e+00 H=2.276854e+00 dV_dx=-1.920272e-06 dV_dθ=-1.069612e-04 ||∇||=4.729032e-01 | Tr=0.1215 Te/Cur=0.1435 Te/Exp=0.1785]100%|██████████| 2/2 [00:20<00:00,  8.87s/it, CE=2.276963e+00 H=2.276854e+00 dV_dx=-1.920272e-06 dV_dθ=-1.069612e-04 ||∇||=4.729032e-01 | Tr=0.1215 Te/Cur=0.1435 Te/Exp=0.1785]100%|██████████| 2/2 [00:20<00:00, 10.12s/it, CE=2.276963e+00 H=2.276854e+00 dV_dx=-1.920272e-06 dV_dθ=-1.069612e-04 ||∇||=4.729032e-01 | Tr=0.1215 Te/Cur=0.1435 Te/Exp=0.1785]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.33s/it] 50%|█████     | 1/2 [00:08<00:05,  5.33s/it, CE=2.278073e+00 H=2.277899e+00 dV_dx=2.207646e-06 dV_dθ=-1.762441e-04 ||∇||=5.607624e-01 | Tr=0.1415 Te/Cur=0.1709 Te/Exp=0.2174]100%|██████████| 2/2 [00:08<00:00,  3.86s/it, CE=2.278073e+00 H=2.277899e+00 dV_dx=2.207646e-06 dV_dθ=-1.762441e-04 ||∇||=5.607624e-01 | Tr=0.1415 Te/Cur=0.1709 Te/Exp=0.2174]100%|██████████| 2/2 [00:08<00:00,  4.08s/it, CE=2.278073e+00 H=2.277899e+00 dV_dx=2.207646e-06 dV_dθ=-1.762441e-04 ||∇||=5.607624e-01 | Tr=0.1415 Te/Cur=0.1709 Te/Exp=0.2174]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.89s/it] 50%|█████     | 1/2 [00:16<00:13, 13.89s/it, CE=2.281386e+00 H=2.281307e+00 dV_dx=4.845854e-06 dV_dθ=-8.370525e-05 ||∇||=4.801651e-01 | Tr=0.1848 Te/Cur=0.1874 Te/Exp=0.2044]100%|██████████| 2/2 [00:16<00:00,  7.40s/it, CE=2.281386e+00 H=2.281307e+00 dV_dx=4.845854e-06 dV_dθ=-8.370525e-05 ||∇||=4.801651e-01 | Tr=0.1848 Te/Cur=0.1874 Te/Exp=0.2044]100%|██████████| 2/2 [00:16<00:00,  8.37s/it, CE=2.281386e+00 H=2.281307e+00 dV_dx=4.845854e-06 dV_dθ=-8.370525e-05 ||∇||=4.801651e-01 | Tr=0.1848 Te/Cur=0.1874 Te/Exp=0.2044]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.09s/it] 50%|█████     | 1/2 [00:17<00:14, 14.09s/it, CE=2.284729e+00 H=2.284681e+00 dV_dx=-5.311300e-06 dV_dθ=-4.270078e-05 ||∇||=4.502033e-01 | Tr=0.1459 Te/Cur=0.1473 Te/Exp=0.1480]100%|██████████| 2/2 [00:17<00:00,  7.75s/it, CE=2.284729e+00 H=2.284681e+00 dV_dx=-5.311300e-06 dV_dθ=-4.270078e-05 ||∇||=4.502033e-01 | Tr=0.1459 Te/Cur=0.1473 Te/Exp=0.1480]100%|██████████| 2/2 [00:17<00:00,  8.70s/it, CE=2.284729e+00 H=2.284681e+00 dV_dx=-5.311300e-06 dV_dθ=-4.270078e-05 ||∇||=4.502033e-01 | Tr=0.1459 Te/Cur=0.1473 Te/Exp=0.1480]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.94s/it] 50%|█████     | 1/2 [00:16<00:13, 13.94s/it, CE=2.267543e+00 H=2.267472e+00 dV_dx=2.086373e-05 dV_dθ=-9.250547e-05 ||∇||=4.890759e-01 | Tr=0.1666 Te/Cur=0.1762 Te/Exp=0.2476]100%|██████████| 2/2 [00:16<00:00,  7.47s/it, CE=2.267543e+00 H=2.267472e+00 dV_dx=2.086373e-05 dV_dθ=-9.250547e-05 ||∇||=4.890759e-01 | Tr=0.1666 Te/Cur=0.1762 Te/Exp=0.2476]100%|██████████| 2/2 [00:16<00:00,  8.44s/it, CE=2.267543e+00 H=2.267472e+00 dV_dx=2.086373e-05 dV_dθ=-9.250547e-05 ||∇||=4.890759e-01 | Tr=0.1666 Te/Cur=0.1762 Te/Exp=0.2476]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.89s/it] 50%|█████     | 1/2 [00:19<00:16, 16.89s/it, CE=2.281939e+00 H=2.281881e+00 dV_dx=1.302752e-05 dV_dθ=-7.040859e-05 ||∇||=4.230087e-01 | Tr=0.1397 Te/Cur=0.1366 Te/Exp=0.1957]100%|██████████| 2/2 [00:19<00:00,  8.76s/it, CE=2.281939e+00 H=2.281881e+00 dV_dx=1.302752e-05 dV_dθ=-7.040859e-05 ||∇||=4.230087e-01 | Tr=0.1397 Te/Cur=0.1366 Te/Exp=0.1957]100%|██████████| 2/2 [00:19<00:00,  9.98s/it, CE=2.281939e+00 H=2.281881e+00 dV_dx=1.302752e-05 dV_dθ=-7.040859e-05 ||∇||=4.230087e-01 | Tr=0.1397 Te/Cur=0.1366 Te/Exp=0.1957]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.12s/it] 50%|█████     | 1/2 [00:15<00:13, 13.12s/it, CE=2.278291e+00 H=2.278230e+00 dV_dx=1.184987e-05 dV_dθ=-7.270068e-05 ||∇||=3.689157e-01 | Tr=0.1161 Te/Cur=0.1451 Te/Exp=0.2628]100%|██████████| 2/2 [00:15<00:00,  7.07s/it, CE=2.278291e+00 H=2.278230e+00 dV_dx=1.184987e-05 dV_dθ=-7.270068e-05 ||∇||=3.689157e-01 | Tr=0.1161 Te/Cur=0.1451 Te/Exp=0.2628]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.278291e+00 H=2.278230e+00 dV_dx=1.184987e-05 dV_dθ=-7.270068e-05 ||∇||=3.689157e-01 | Tr=0.1161 Te/Cur=0.1451 Te/Exp=0.2628]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.99s/it] 50%|█████     | 1/2 [00:10<00:07,  7.99s/it, CE=2.264818e+00 H=2.264800e+00 dV_dx=7.305536e-06 dV_dθ=-2.573322e-05 ||∇||=3.768886e-01 | Tr=0.0551 Te/Cur=0.0705 Te/Exp=0.3063]100%|██████████| 2/2 [00:10<00:00,  4.96s/it, CE=2.264818e+00 H=2.264800e+00 dV_dx=7.305536e-06 dV_dθ=-2.573322e-05 ||∇||=3.768886e-01 | Tr=0.0551 Te/Cur=0.0705 Te/Exp=0.3063]100%|██████████| 2/2 [00:10<00:00,  5.41s/it, CE=2.264818e+00 H=2.264800e+00 dV_dx=7.305536e-06 dV_dθ=-2.573322e-05 ||∇||=3.768886e-01 | Tr=0.0551 Te/Cur=0.0705 Te/Exp=0.3063]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.22s/it] 50%|█████     | 1/2 [00:16<00:13, 13.22s/it, CE=2.259154e+00 H=2.259170e+00 dV_dx=1.833326e-05 dV_dθ=-2.393254e-06 ||∇||=3.472844e-01 | Tr=0.1431 Te/Cur=0.1588 Te/Exp=0.2170]100%|██████████| 2/2 [00:16<00:00,  7.11s/it, CE=2.259154e+00 H=2.259170e+00 dV_dx=1.833326e-05 dV_dθ=-2.393254e-06 ||∇||=3.472844e-01 | Tr=0.1431 Te/Cur=0.1588 Te/Exp=0.2170]100%|██████████| 2/2 [00:16<00:00,  8.03s/it, CE=2.259154e+00 H=2.259170e+00 dV_dx=1.833326e-05 dV_dθ=-2.393254e-06 ||∇||=3.472844e-01 | Tr=0.1431 Te/Cur=0.1588 Te/Exp=0.2170]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 632, 144, 10]) with loss 2.259154
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.49s/it] 50%|█████     | 1/2 [00:16<00:13, 13.49s/it, CE=2.275106e+00 H=2.275034e+00 dV_dx=-1.001055e-05 dV_dθ=-6.138608e-05 ||∇||=3.632299e-01 | Tr=0.1005 Te/Cur=0.1233 Te/Exp=0.2391]100%|██████████| 2/2 [00:16<00:00,  7.15s/it, CE=2.275106e+00 H=2.275034e+00 dV_dx=-1.001055e-05 dV_dθ=-6.138608e-05 ||∇||=3.632299e-01 | Tr=0.1005 Te/Cur=0.1233 Te/Exp=0.2391]100%|██████████| 2/2 [00:16<00:00,  8.11s/it, CE=2.275106e+00 H=2.275034e+00 dV_dx=-1.001055e-05 dV_dθ=-6.138608e-05 ||∇||=3.632299e-01 | Tr=0.1005 Te/Cur=0.1233 Te/Exp=0.2391]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.43s/it] 50%|█████     | 1/2 [00:10<00:07,  7.43s/it, CE=2.269919e+00 H=2.269838e+00 dV_dx=-1.546983e-05 dV_dθ=-6.549340e-05 ||∇||=4.312761e-01 | Tr=0.1344 Te/Cur=0.1372 Te/Exp=0.2034]100%|██████████| 2/2 [00:10<00:00,  4.68s/it, CE=2.269919e+00 H=2.269838e+00 dV_dx=-1.546983e-05 dV_dθ=-6.549340e-05 ||∇||=4.312761e-01 | Tr=0.1344 Te/Cur=0.1372 Te/Exp=0.2034]100%|██████████| 2/2 [00:10<00:00,  5.09s/it, CE=2.269919e+00 H=2.269838e+00 dV_dx=-1.546983e-05 dV_dθ=-6.549340e-05 ||∇||=4.312761e-01 | Tr=0.1344 Te/Cur=0.1372 Te/Exp=0.2034]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.75s/it] 50%|█████     | 1/2 [00:16<00:13, 13.75s/it, CE=2.274092e+00 H=2.274055e+00 dV_dx=-5.181836e-07 dV_dθ=-3.674948e-05 ||∇||=3.502592e-01 | Tr=0.1552 Te/Cur=0.1886 Te/Exp=0.2601]100%|██████████| 2/2 [00:16<00:00,  7.31s/it, CE=2.274092e+00 H=2.274055e+00 dV_dx=-5.181836e-07 dV_dθ=-3.674948e-05 ||∇||=3.502592e-01 | Tr=0.1552 Te/Cur=0.1886 Te/Exp=0.2601]100%|██████████| 2/2 [00:16<00:00,  8.28s/it, CE=2.274092e+00 H=2.274055e+00 dV_dx=-5.181836e-07 dV_dθ=-3.674948e-05 ||∇||=3.502592e-01 | Tr=0.1552 Te/Cur=0.1886 Te/Exp=0.2601]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.42s/it] 50%|█████     | 1/2 [00:16<00:13, 13.42s/it, CE=2.280826e+00 H=2.280786e+00 dV_dx=-5.133136e-07 dV_dθ=-3.962733e-05 ||∇||=3.640433e-01 | Tr=0.1410 Te/Cur=0.1582 Te/Exp=0.1884]100%|██████████| 2/2 [00:16<00:00,  7.34s/it, CE=2.280826e+00 H=2.280786e+00 dV_dx=-5.133136e-07 dV_dθ=-3.962733e-05 ||∇||=3.640433e-01 | Tr=0.1410 Te/Cur=0.1582 Te/Exp=0.1884]100%|██████████| 2/2 [00:16<00:00,  8.26s/it, CE=2.280826e+00 H=2.280786e+00 dV_dx=-5.133136e-07 dV_dθ=-3.962733e-05 ||∇||=3.640433e-01 | Tr=0.1410 Te/Cur=0.1582 Te/Exp=0.1884]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.71s/it] 50%|█████     | 1/2 [00:16<00:13, 13.71s/it, CE=2.264598e+00 H=2.264567e+00 dV_dx=1.011434e-05 dV_dθ=-4.191231e-05 ||∇||=3.201236e-01 | Tr=0.1508 Te/Cur=0.1627 Te/Exp=0.2729]100%|██████████| 2/2 [00:16<00:00,  7.43s/it, CE=2.264598e+00 H=2.264567e+00 dV_dx=1.011434e-05 dV_dθ=-4.191231e-05 ||∇||=3.201236e-01 | Tr=0.1508 Te/Cur=0.1627 Te/Exp=0.2729]100%|██████████| 2/2 [00:16<00:00,  8.37s/it, CE=2.264598e+00 H=2.264567e+00 dV_dx=1.011434e-05 dV_dθ=-4.191231e-05 ||∇||=3.201236e-01 | Tr=0.1508 Te/Cur=0.1627 Te/Exp=0.2729]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.41s/it] 50%|█████     | 1/2 [00:16<00:13, 13.41s/it, CE=2.271814e+00 H=2.271755e+00 dV_dx=-1.240952e-06 dV_dθ=-5.746790e-05 ||∇||=3.515034e-01 | Tr=0.1511 Te/Cur=0.2152 Te/Exp=0.2349]100%|██████████| 2/2 [00:16<00:00,  7.23s/it, CE=2.271814e+00 H=2.271755e+00 dV_dx=-1.240952e-06 dV_dθ=-5.746790e-05 ||∇||=3.515034e-01 | Tr=0.1511 Te/Cur=0.2152 Te/Exp=0.2349]100%|██████████| 2/2 [00:16<00:00,  8.16s/it, CE=2.271814e+00 H=2.271755e+00 dV_dx=-1.240952e-06 dV_dθ=-5.746790e-05 ||∇||=3.515034e-01 | Tr=0.1511 Te/Cur=0.2152 Te/Exp=0.2349]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.72s/it] 50%|█████     | 1/2 [00:16<00:13, 13.72s/it, CE=2.267823e+00 H=2.267747e+00 dV_dx=-3.024214e-06 dV_dθ=-7.284635e-05 ||∇||=3.467362e-01 | Tr=0.1508 Te/Cur=0.2088 Te/Exp=0.2212]100%|██████████| 2/2 [00:16<00:00,  7.27s/it, CE=2.267823e+00 H=2.267747e+00 dV_dx=-3.024214e-06 dV_dθ=-7.284635e-05 ||∇||=3.467362e-01 | Tr=0.1508 Te/Cur=0.2088 Te/Exp=0.2212]100%|██████████| 2/2 [00:16<00:00,  8.24s/it, CE=2.267823e+00 H=2.267747e+00 dV_dx=-3.024214e-06 dV_dθ=-7.284635e-05 ||∇||=3.467362e-01 | Tr=0.1508 Te/Cur=0.2088 Te/Exp=0.2212]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.46s/it] 50%|█████     | 1/2 [00:14<00:11, 11.46s/it, CE=2.267560e+00 H=2.267504e+00 dV_dx=2.209771e-06 dV_dθ=-5.840957e-05 ||∇||=3.081095e-01 | Tr=0.1392 Te/Cur=0.1508 Te/Exp=0.2775]100%|██████████| 2/2 [00:14<00:00,  6.54s/it, CE=2.267560e+00 H=2.267504e+00 dV_dx=2.209771e-06 dV_dθ=-5.840957e-05 ||∇||=3.081095e-01 | Tr=0.1392 Te/Cur=0.1508 Te/Exp=0.2775]100%|██████████| 2/2 [00:14<00:00,  7.28s/it, CE=2.267560e+00 H=2.267504e+00 dV_dx=2.209771e-06 dV_dθ=-5.840957e-05 ||∇||=3.081095e-01 | Tr=0.1392 Te/Cur=0.1508 Te/Exp=0.2775]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.29s/it] 50%|█████     | 1/2 [00:16<00:14, 14.29s/it, CE=2.263311e+00 H=2.263282e+00 dV_dx=6.177345e-06 dV_dθ=-3.529775e-05 ||∇||=3.676037e-01 | Tr=0.1338 Te/Cur=0.1599 Te/Exp=0.2423]100%|██████████| 2/2 [00:16<00:00,  7.27s/it, CE=2.263311e+00 H=2.263282e+00 dV_dx=6.177345e-06 dV_dθ=-3.529775e-05 ||∇||=3.676037e-01 | Tr=0.1338 Te/Cur=0.1599 Te/Exp=0.2423]100%|██████████| 2/2 [00:16<00:00,  8.33s/it, CE=2.263311e+00 H=2.263282e+00 dV_dx=6.177345e-06 dV_dθ=-3.529775e-05 ||∇||=3.676037e-01 | Tr=0.1338 Te/Cur=0.1599 Te/Exp=0.2423]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.33s/it] 50%|█████     | 1/2 [00:16<00:13, 13.33s/it, CE=2.259257e+00 H=2.259220e+00 dV_dx=1.816209e-06 dV_dθ=-3.853015e-05 ||∇||=3.328184e-01 | Tr=0.1386 Te/Cur=0.1601 Te/Exp=0.2513]100%|██████████| 2/2 [00:16<00:00,  7.34s/it, CE=2.259257e+00 H=2.259220e+00 dV_dx=1.816209e-06 dV_dθ=-3.853015e-05 ||∇||=3.328184e-01 | Tr=0.1386 Te/Cur=0.1601 Te/Exp=0.2513]100%|██████████| 2/2 [00:16<00:00,  8.24s/it, CE=2.259257e+00 H=2.259220e+00 dV_dx=1.816209e-06 dV_dθ=-3.853015e-05 ||∇||=3.328184e-01 | Tr=0.1386 Te/Cur=0.1601 Te/Exp=0.2513]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.60s/it] 50%|█████     | 1/2 [00:07<00:04,  4.60s/it, CE=2.264771e+00 H=2.264719e+00 dV_dx=-1.026198e-05 dV_dθ=-4.205160e-05 ||∇||=3.301569e-01 | Tr=0.1220 Te/Cur=0.1230 Te/Exp=0.2249]100%|██████████| 2/2 [00:07<00:00,  3.67s/it, CE=2.264771e+00 H=2.264719e+00 dV_dx=-1.026198e-05 dV_dθ=-4.205160e-05 ||∇||=3.301569e-01 | Tr=0.1220 Te/Cur=0.1230 Te/Exp=0.2249]100%|██████████| 2/2 [00:07<00:00,  3.81s/it, CE=2.264771e+00 H=2.264719e+00 dV_dx=-1.026198e-05 dV_dθ=-4.205160e-05 ||∇||=3.301569e-01 | Tr=0.1220 Te/Cur=0.1230 Te/Exp=0.2249]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.69s/it] 50%|█████     | 1/2 [00:16<00:13, 13.69s/it, CE=2.280425e+00 H=2.280376e+00 dV_dx=1.775975e-05 dV_dθ=-6.663800e-05 ||∇||=3.341960e-01 | Tr=0.1048 Te/Cur=0.1222 Te/Exp=0.2098]100%|██████████| 2/2 [00:16<00:00,  7.44s/it, CE=2.280425e+00 H=2.280376e+00 dV_dx=1.775975e-05 dV_dθ=-6.663800e-05 ||∇||=3.341960e-01 | Tr=0.1048 Te/Cur=0.1222 Te/Exp=0.2098]100%|██████████| 2/2 [00:16<00:00,  8.38s/it, CE=2.280425e+00 H=2.280376e+00 dV_dx=1.775975e-05 dV_dθ=-6.663800e-05 ||∇||=3.341960e-01 | Tr=0.1048 Te/Cur=0.1222 Te/Exp=0.2098]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.22s/it] 50%|█████     | 1/2 [00:16<00:13, 13.22s/it, CE=2.276378e+00 H=2.276292e+00 dV_dx=-1.697589e-05 dV_dθ=-6.868850e-05 ||∇||=3.497862e-01 | Tr=0.1185 Te/Cur=0.1649 Te/Exp=0.2418]100%|██████████| 2/2 [00:16<00:00,  7.15s/it, CE=2.276378e+00 H=2.276292e+00 dV_dx=-1.697589e-05 dV_dθ=-6.868850e-05 ||∇||=3.497862e-01 | Tr=0.1185 Te/Cur=0.1649 Te/Exp=0.2418]100%|██████████| 2/2 [00:16<00:00,  8.06s/it, CE=2.276378e+00 H=2.276292e+00 dV_dx=-1.697589e-05 dV_dθ=-6.868850e-05 ||∇||=3.497862e-01 | Tr=0.1185 Te/Cur=0.1649 Te/Exp=0.2418]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.96s/it] 50%|█████     | 1/2 [00:19<00:16, 16.96s/it, CE=2.279698e+00 H=2.279620e+00 dV_dx=-2.076664e-05 dV_dθ=-5.706584e-05 ||∇||=3.194223e-01 | Tr=0.1329 Te/Cur=0.1641 Te/Exp=0.2142]100%|██████████| 2/2 [00:19<00:00,  8.73s/it, CE=2.279698e+00 H=2.279620e+00 dV_dx=-2.076664e-05 dV_dθ=-5.706584e-05 ||∇||=3.194223e-01 | Tr=0.1329 Te/Cur=0.1641 Te/Exp=0.2142]100%|██████████| 2/2 [00:19<00:00,  9.97s/it, CE=2.279698e+00 H=2.279620e+00 dV_dx=-2.076664e-05 dV_dθ=-5.706584e-05 ||∇||=3.194223e-01 | Tr=0.1329 Te/Cur=0.1641 Te/Exp=0.2142]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.36s/it] 50%|█████     | 1/2 [00:17<00:14, 14.36s/it, CE=2.275021e+00 H=2.274966e+00 dV_dx=2.509747e-06 dV_dθ=-5.773570e-05 ||∇||=3.283342e-01 | Tr=0.1103 Te/Cur=0.1229 Te/Exp=0.2067]100%|██████████| 2/2 [00:17<00:00,  7.71s/it, CE=2.275021e+00 H=2.274966e+00 dV_dx=2.509747e-06 dV_dθ=-5.773570e-05 ||∇||=3.283342e-01 | Tr=0.1103 Te/Cur=0.1229 Te/Exp=0.2067]100%|██████████| 2/2 [00:17<00:00,  8.71s/it, CE=2.275021e+00 H=2.274966e+00 dV_dx=2.509747e-06 dV_dθ=-5.773570e-05 ||∇||=3.283342e-01 | Tr=0.1103 Te/Cur=0.1229 Te/Exp=0.2067]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.10s/it] 50%|█████     | 1/2 [00:07<00:05,  5.10s/it, CE=2.244592e+00 H=2.244457e+00 dV_dx=-2.847931e-05 dV_dθ=-1.070182e-04 ||∇||=5.272140e-01 | Tr=0.1314 Te/Cur=0.1387 Te/Exp=0.2443]100%|██████████| 2/2 [00:07<00:00,  3.79s/it, CE=2.244592e+00 H=2.244457e+00 dV_dx=-2.847931e-05 dV_dθ=-1.070182e-04 ||∇||=5.272140e-01 | Tr=0.1314 Te/Cur=0.1387 Te/Exp=0.2443]100%|██████████| 2/2 [00:07<00:00,  3.99s/it, CE=2.244592e+00 H=2.244457e+00 dV_dx=-2.847931e-05 dV_dθ=-1.070182e-04 ||∇||=5.272140e-01 | Tr=0.1314 Te/Cur=0.1387 Te/Exp=0.2443]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.244592257542879
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.25s/it] 50%|█████     | 1/2 [00:17<00:14, 14.25s/it, CE=2.235910e+00 H=2.235796e+00 dV_dx=-1.549739e-05 dV_dθ=-9.826304e-05 ||∇||=5.202139e-01 | Tr=0.1241 Te/Cur=0.1499 Te/Exp=0.2763]100%|██████████| 2/2 [00:17<00:00,  7.49s/it, CE=2.235910e+00 H=2.235796e+00 dV_dx=-1.549739e-05 dV_dθ=-9.826304e-05 ||∇||=5.202139e-01 | Tr=0.1241 Te/Cur=0.1499 Te/Exp=0.2763]100%|██████████| 2/2 [00:17<00:00,  8.51s/it, CE=2.235910e+00 H=2.235796e+00 dV_dx=-1.549739e-05 dV_dθ=-9.826304e-05 ||∇||=5.202139e-01 | Tr=0.1241 Te/Cur=0.1499 Te/Exp=0.2763]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 104, 10]) with loss 2.235910
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.18s/it] 50%|█████     | 1/2 [00:17<00:14, 14.18s/it, CE=2.241836e+00 H=2.241815e+00 dV_dx=7.883684e-06 dV_dθ=-2.919183e-05 ||∇||=4.952839e-01 | Tr=0.1188 Te/Cur=0.0935 Te/Exp=0.2678]100%|██████████| 2/2 [00:17<00:00,  7.87s/it, CE=2.241836e+00 H=2.241815e+00 dV_dx=7.883684e-06 dV_dθ=-2.919183e-05 ||∇||=4.952839e-01 | Tr=0.1188 Te/Cur=0.0935 Te/Exp=0.2678]100%|██████████| 2/2 [00:17<00:00,  8.81s/it, CE=2.241836e+00 H=2.241815e+00 dV_dx=7.883684e-06 dV_dθ=-2.919183e-05 ||∇||=4.952839e-01 | Tr=0.1188 Te/Cur=0.0935 Te/Exp=0.2678]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.42s/it] 50%|█████     | 1/2 [00:08<00:05,  5.42s/it, CE=2.240500e+00 H=2.240366e+00 dV_dx=8.672832e-06 dV_dθ=-1.423148e-04 ||∇||=5.656376e-01 | Tr=0.1398 Te/Cur=0.1624 Te/Exp=0.2657]100%|██████████| 2/2 [00:08<00:00,  3.78s/it, CE=2.240500e+00 H=2.240366e+00 dV_dx=8.672832e-06 dV_dθ=-1.423148e-04 ||∇||=5.656376e-01 | Tr=0.1398 Te/Cur=0.1624 Te/Exp=0.2657]100%|██████████| 2/2 [00:08<00:00,  4.02s/it, CE=2.240500e+00 H=2.240366e+00 dV_dx=8.672832e-06 dV_dθ=-1.423148e-04 ||∇||=5.656376e-01 | Tr=0.1398 Te/Cur=0.1624 Te/Exp=0.2657]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.34s/it] 50%|█████     | 1/2 [00:11<00:08,  8.34s/it, CE=2.214141e+00 H=2.214108e+00 dV_dx=1.742216e-05 dV_dθ=-4.977685e-05 ||∇||=5.240074e-01 | Tr=0.1449 Te/Cur=0.1447 Te/Exp=0.2970]100%|██████████| 2/2 [00:11<00:00,  5.12s/it, CE=2.214141e+00 H=2.214108e+00 dV_dx=1.742216e-05 dV_dθ=-4.977685e-05 ||∇||=5.240074e-01 | Tr=0.1449 Te/Cur=0.1447 Te/Exp=0.2970]100%|██████████| 2/2 [00:11<00:00,  5.60s/it, CE=2.214141e+00 H=2.214108e+00 dV_dx=1.742216e-05 dV_dθ=-4.977685e-05 ||∇||=5.240074e-01 | Tr=0.1449 Te/Cur=0.1447 Te/Exp=0.2970]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.214141
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.10s/it] 50%|█████     | 1/2 [00:17<00:14, 14.10s/it, CE=2.224185e+00 H=2.224139e+00 dV_dx=-9.131800e-06 dV_dθ=-3.700969e-05 ||∇||=5.100373e-01 | Tr=0.0908 Te/Cur=0.0917 Te/Exp=0.2853]100%|██████████| 2/2 [00:17<00:00,  7.57s/it, CE=2.224185e+00 H=2.224139e+00 dV_dx=-9.131800e-06 dV_dθ=-3.700969e-05 ||∇||=5.100373e-01 | Tr=0.0908 Te/Cur=0.0917 Te/Exp=0.2853]100%|██████████| 2/2 [00:17<00:00,  8.55s/it, CE=2.224185e+00 H=2.224139e+00 dV_dx=-9.131800e-06 dV_dθ=-3.700969e-05 ||∇||=5.100373e-01 | Tr=0.0908 Te/Cur=0.0917 Te/Exp=0.2853]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.13s/it] 50%|█████     | 1/2 [00:07<00:05,  5.13s/it, CE=2.250050e+00 H=2.250003e+00 dV_dx=-1.009933e-05 dV_dθ=-3.692719e-05 ||∇||=5.284721e-01 | Tr=0.0793 Te/Cur=0.0627 Te/Exp=0.2977]100%|██████████| 2/2 [00:07<00:00,  3.67s/it, CE=2.250050e+00 H=2.250003e+00 dV_dx=-1.009933e-05 dV_dθ=-3.692719e-05 ||∇||=5.284721e-01 | Tr=0.0793 Te/Cur=0.0627 Te/Exp=0.2977]100%|██████████| 2/2 [00:07<00:00,  3.89s/it, CE=2.250050e+00 H=2.250003e+00 dV_dx=-1.009933e-05 dV_dθ=-3.692719e-05 ||∇||=5.284721e-01 | Tr=0.0793 Te/Cur=0.0627 Te/Exp=0.2977]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.94s/it] 50%|█████     | 1/2 [00:07<00:04,  4.94s/it, CE=2.226092e+00 H=2.226002e+00 dV_dx=-1.488758e-05 dV_dθ=-7.510124e-05 ||∇||=5.289640e-01 | Tr=0.1185 Te/Cur=0.1546 Te/Exp=0.3211]100%|██████████| 2/2 [00:07<00:00,  3.79s/it, CE=2.226092e+00 H=2.226002e+00 dV_dx=-1.488758e-05 dV_dθ=-7.510124e-05 ||∇||=5.289640e-01 | Tr=0.1185 Te/Cur=0.1546 Te/Exp=0.3211]100%|██████████| 2/2 [00:07<00:00,  3.96s/it, CE=2.226092e+00 H=2.226002e+00 dV_dx=-1.488758e-05 dV_dθ=-7.510124e-05 ||∇||=5.289640e-01 | Tr=0.1185 Te/Cur=0.1546 Te/Exp=0.3211]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.01s/it] 50%|█████     | 1/2 [00:16<00:14, 14.01s/it, CE=2.225481e+00 H=2.225413e+00 dV_dx=-6.867370e-06 dV_dθ=-6.119853e-05 ||∇||=5.260254e-01 | Tr=0.1817 Te/Cur=0.1916 Te/Exp=0.3169]100%|██████████| 2/2 [00:16<00:00,  7.43s/it, CE=2.225481e+00 H=2.225413e+00 dV_dx=-6.867370e-06 dV_dθ=-6.119853e-05 ||∇||=5.260254e-01 | Tr=0.1817 Te/Cur=0.1916 Te/Exp=0.3169]100%|██████████| 2/2 [00:16<00:00,  8.42s/it, CE=2.225481e+00 H=2.225413e+00 dV_dx=-6.867370e-06 dV_dθ=-6.119853e-05 ||∇||=5.260254e-01 | Tr=0.1817 Te/Cur=0.1916 Te/Exp=0.3169]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.75s/it] 50%|█████     | 1/2 [00:07<00:04,  4.75s/it, CE=2.277599e+00 H=2.277535e+00 dV_dx=-5.170137e-06 dV_dθ=-5.852450e-05 ||∇||=3.446480e-01 | Tr=0.1169 Te/Cur=0.1567 Te/Exp=0.1833]100%|██████████| 2/2 [00:07<00:00,  3.65s/it, CE=2.277599e+00 H=2.277535e+00 dV_dx=-5.170137e-06 dV_dθ=-5.852450e-05 ||∇||=3.446480e-01 | Tr=0.1169 Te/Cur=0.1567 Te/Exp=0.1833]100%|██████████| 2/2 [00:07<00:00,  3.82s/it, CE=2.277599e+00 H=2.277535e+00 dV_dx=-5.170137e-06 dV_dθ=-5.852450e-05 ||∇||=3.446480e-01 | Tr=0.1169 Te/Cur=0.1567 Te/Exp=0.1833]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:17<00:17, 17.14s/it] 50%|█████     | 1/2 [00:20<00:17, 17.14s/it, CE=2.280135e+00 H=2.280057e+00 dV_dx=-1.791036e-05 dV_dθ=-6.000621e-05 ||∇||=3.333967e-01 | Tr=0.1272 Te/Cur=0.1402 Te/Exp=0.1969]100%|██████████| 2/2 [00:20<00:00,  8.81s/it, CE=2.280135e+00 H=2.280057e+00 dV_dx=-1.791036e-05 dV_dθ=-6.000621e-05 ||∇||=3.333967e-01 | Tr=0.1272 Te/Cur=0.1402 Te/Exp=0.1969]100%|██████████| 2/2 [00:20<00:00, 10.06s/it, CE=2.280135e+00 H=2.280057e+00 dV_dx=-1.791036e-05 dV_dθ=-6.000621e-05 ||∇||=3.333967e-01 | Tr=0.1272 Te/Cur=0.1402 Te/Exp=0.1969]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.09s/it] 50%|█████     | 1/2 [00:16<00:14, 14.09s/it, CE=2.278875e+00 H=2.278801e+00 dV_dx=5.714654e-08 dV_dθ=-7.330005e-05 ||∇||=3.346829e-01 | Tr=0.1056 Te/Cur=0.1320 Te/Exp=0.1835]100%|██████████| 2/2 [00:16<00:00,  7.47s/it, CE=2.278875e+00 H=2.278801e+00 dV_dx=5.714654e-08 dV_dθ=-7.330005e-05 ||∇||=3.346829e-01 | Tr=0.1056 Te/Cur=0.1320 Te/Exp=0.1835]100%|██████████| 2/2 [00:16<00:00,  8.46s/it, CE=2.278875e+00 H=2.278801e+00 dV_dx=5.714654e-08 dV_dθ=-7.330005e-05 ||∇||=3.346829e-01 | Tr=0.1056 Te/Cur=0.1320 Te/Exp=0.1835]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.04s/it] 50%|█████     | 1/2 [00:08<00:05,  5.04s/it, CE=2.285454e+00 H=2.285403e+00 dV_dx=8.214017e-06 dV_dθ=-5.933231e-05 ||∇||=3.721888e-01 | Tr=0.0725 Te/Cur=0.0933 Te/Exp=0.1589]100%|██████████| 2/2 [00:08<00:00,  3.89s/it, CE=2.285454e+00 H=2.285403e+00 dV_dx=8.214017e-06 dV_dθ=-5.933231e-05 ||∇||=3.721888e-01 | Tr=0.0725 Te/Cur=0.0933 Te/Exp=0.1589]100%|██████████| 2/2 [00:08<00:00,  4.06s/it, CE=2.285454e+00 H=2.285403e+00 dV_dx=8.214017e-06 dV_dθ=-5.933231e-05 ||∇||=3.721888e-01 | Tr=0.0725 Te/Cur=0.0933 Te/Exp=0.1589]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.93s/it] 50%|█████     | 1/2 [00:08<00:04,  4.93s/it, CE=2.274593e+00 H=2.274522e+00 dV_dx=1.372091e-05 dV_dθ=-8.480761e-05 ||∇||=3.656313e-01 | Tr=0.1061 Te/Cur=0.1390 Te/Exp=0.2053]100%|██████████| 2/2 [00:08<00:00,  3.96s/it, CE=2.274593e+00 H=2.274522e+00 dV_dx=1.372091e-05 dV_dθ=-8.480761e-05 ||∇||=3.656313e-01 | Tr=0.1061 Te/Cur=0.1390 Te/Exp=0.2053]100%|██████████| 2/2 [00:08<00:00,  4.11s/it, CE=2.274593e+00 H=2.274522e+00 dV_dx=1.372091e-05 dV_dθ=-8.480761e-05 ||∇||=3.656313e-01 | Tr=0.1061 Te/Cur=0.1390 Te/Exp=0.2053]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.42s/it] 50%|█████     | 1/2 [00:17<00:14, 14.42s/it, CE=2.269561e+00 H=2.269494e+00 dV_dx=4.387849e-06 dV_dθ=-7.131533e-05 ||∇||=3.676990e-01 | Tr=0.1179 Te/Cur=0.1271 Te/Exp=0.1818]100%|██████████| 2/2 [00:17<00:00,  7.73s/it, CE=2.269561e+00 H=2.269494e+00 dV_dx=4.387849e-06 dV_dθ=-7.131533e-05 ||∇||=3.676990e-01 | Tr=0.1179 Te/Cur=0.1271 Te/Exp=0.1818]100%|██████████| 2/2 [00:17<00:00,  8.74s/it, CE=2.269561e+00 H=2.269494e+00 dV_dx=4.387849e-06 dV_dθ=-7.131533e-05 ||∇||=3.676990e-01 | Tr=0.1179 Te/Cur=0.1271 Te/Exp=0.1818]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.00s/it] 50%|█████     | 1/2 [00:07<00:05,  5.00s/it, CE=2.277388e+00 H=2.277341e+00 dV_dx=-2.541811e-06 dV_dθ=-4.440388e-05 ||∇||=3.829259e-01 | Tr=0.1316 Te/Cur=0.1453 Te/Exp=0.1753]100%|██████████| 2/2 [00:07<00:00,  3.38s/it, CE=2.277388e+00 H=2.277341e+00 dV_dx=-2.541811e-06 dV_dθ=-4.440388e-05 ||∇||=3.829259e-01 | Tr=0.1316 Te/Cur=0.1453 Te/Exp=0.1753]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.277388e+00 H=2.277341e+00 dV_dx=-2.541811e-06 dV_dθ=-4.440388e-05 ||∇||=3.829259e-01 | Tr=0.1316 Te/Cur=0.1453 Te/Exp=0.1753]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.21s/it] 50%|█████     | 1/2 [00:08<00:05,  5.21s/it, CE=2.276473e+00 H=2.276420e+00 dV_dx=7.110559e-06 dV_dθ=-5.945215e-05 ||∇||=3.465772e-01 | Tr=0.1065 Te/Cur=0.1219 Te/Exp=0.2081]100%|██████████| 2/2 [00:08<00:00,  3.98s/it, CE=2.276473e+00 H=2.276420e+00 dV_dx=7.110559e-06 dV_dθ=-5.945215e-05 ||∇||=3.465772e-01 | Tr=0.1065 Te/Cur=0.1219 Te/Exp=0.2081]100%|██████████| 2/2 [00:08<00:00,  4.17s/it, CE=2.276473e+00 H=2.276420e+00 dV_dx=7.110559e-06 dV_dθ=-5.945215e-05 ||∇||=3.465772e-01 | Tr=0.1065 Te/Cur=0.1219 Te/Exp=0.2081]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.61s/it] 50%|█████     | 1/2 [00:19<00:16, 16.61s/it, CE=2.281913e+00 H=2.281829e+00 dV_dx=9.054117e-07 dV_dθ=-8.490973e-05 ||∇||=3.901037e-01 | Tr=0.1085 Te/Cur=0.1160 Te/Exp=0.2305]100%|██████████| 2/2 [00:19<00:00,  8.45s/it, CE=2.281913e+00 H=2.281829e+00 dV_dx=9.054117e-07 dV_dθ=-8.490973e-05 ||∇||=3.901037e-01 | Tr=0.1085 Te/Cur=0.1160 Te/Exp=0.2305]100%|██████████| 2/2 [00:19<00:00,  9.67s/it, CE=2.281913e+00 H=2.281829e+00 dV_dx=9.054117e-07 dV_dθ=-8.490973e-05 ||∇||=3.901037e-01 | Tr=0.1085 Te/Cur=0.1160 Te/Exp=0.2305]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.81s/it] 50%|█████     | 1/2 [00:07<00:04,  4.81s/it, CE=2.267201e+00 H=2.267143e+00 dV_dx=1.287533e-05 dV_dθ=-7.069799e-05 ||∇||=4.253545e-01 | Tr=0.0963 Te/Cur=0.0847 Te/Exp=0.2005]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.267201e+00 H=2.267143e+00 dV_dx=1.287533e-05 dV_dθ=-7.069799e-05 ||∇||=4.253545e-01 | Tr=0.0963 Te/Cur=0.0847 Te/Exp=0.2005]100%|██████████| 2/2 [00:07<00:00,  3.81s/it, CE=2.267201e+00 H=2.267143e+00 dV_dx=1.287533e-05 dV_dθ=-7.069799e-05 ||∇||=4.253545e-01 | Tr=0.0963 Te/Cur=0.0847 Te/Exp=0.2005]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.30s/it] 50%|█████     | 1/2 [00:16<00:13, 13.30s/it, CE=2.267508e+00 H=2.267415e+00 dV_dx=-7.136799e-07 dV_dθ=-9.265694e-05 ||∇||=4.162022e-01 | Tr=0.1319 Te/Cur=0.1501 Te/Exp=0.2153]100%|██████████| 2/2 [00:16<00:00,  7.13s/it, CE=2.267508e+00 H=2.267415e+00 dV_dx=-7.136799e-07 dV_dθ=-9.265694e-05 ||∇||=4.162022e-01 | Tr=0.1319 Te/Cur=0.1501 Te/Exp=0.2153]100%|██████████| 2/2 [00:16<00:00,  8.05s/it, CE=2.267508e+00 H=2.267415e+00 dV_dx=-7.136799e-07 dV_dθ=-9.265694e-05 ||∇||=4.162022e-01 | Tr=0.1319 Te/Cur=0.1501 Te/Exp=0.2153]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.93s/it] 50%|█████     | 1/2 [00:16<00:13, 13.93s/it, CE=2.264240e+00 H=2.264236e+00 dV_dx=1.361523e-05 dV_dθ=-1.770499e-05 ||∇||=4.025063e-01 | Tr=0.0618 Te/Cur=0.0541 Te/Exp=0.2114]100%|██████████| 2/2 [00:16<00:00,  7.28s/it, CE=2.264240e+00 H=2.264236e+00 dV_dx=1.361523e-05 dV_dθ=-1.770499e-05 ||∇||=4.025063e-01 | Tr=0.0618 Te/Cur=0.0541 Te/Exp=0.2114]100%|██████████| 2/2 [00:16<00:00,  8.28s/it, CE=2.264240e+00 H=2.264236e+00 dV_dx=1.361523e-05 dV_dθ=-1.770499e-05 ||∇||=4.025063e-01 | Tr=0.0618 Te/Cur=0.0541 Te/Exp=0.2114]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.83s/it] 50%|█████     | 1/2 [00:07<00:04,  4.83s/it, CE=2.259540e+00 H=2.259473e+00 dV_dx=-1.435178e-05 dV_dθ=-5.319148e-05 ||∇||=3.866335e-01 | Tr=0.0802 Te/Cur=0.0795 Te/Exp=0.2099]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.259540e+00 H=2.259473e+00 dV_dx=-1.435178e-05 dV_dθ=-5.319148e-05 ||∇||=3.866335e-01 | Tr=0.0802 Te/Cur=0.0795 Te/Exp=0.2099]100%|██████████| 2/2 [00:07<00:00,  3.82s/it, CE=2.259540e+00 H=2.259473e+00 dV_dx=-1.435178e-05 dV_dθ=-5.319148e-05 ||∇||=3.866335e-01 | Tr=0.0802 Te/Cur=0.0795 Te/Exp=0.2099]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.06s/it] 50%|█████     | 1/2 [00:08<00:05,  5.06s/it, CE=2.261766e+00 H=2.261649e+00 dV_dx=-1.007655e-05 dV_dθ=-1.074660e-04 ||∇||=4.290428e-01 | Tr=0.1009 Te/Cur=0.1077 Te/Exp=0.2293]100%|██████████| 2/2 [00:08<00:00,  3.93s/it, CE=2.261766e+00 H=2.261649e+00 dV_dx=-1.007655e-05 dV_dθ=-1.074660e-04 ||∇||=4.290428e-01 | Tr=0.1009 Te/Cur=0.1077 Te/Exp=0.2293]100%|██████████| 2/2 [00:08<00:00,  4.10s/it, CE=2.261766e+00 H=2.261649e+00 dV_dx=-1.007655e-05 dV_dθ=-1.074660e-04 ||∇||=4.290428e-01 | Tr=0.1009 Te/Cur=0.1077 Te/Exp=0.2293]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.66s/it] 50%|█████     | 1/2 [00:19<00:13, 13.66s/it, CE=2.257683e+00 H=2.257640e+00 dV_dx=8.540353e-06 dV_dθ=-5.225027e-05 ||∇||=4.283434e-01 | Tr=0.1015 Te/Cur=0.0893 Te/Exp=0.2131]100%|██████████| 2/2 [00:19<00:00,  9.00s/it, CE=2.257683e+00 H=2.257640e+00 dV_dx=8.540353e-06 dV_dθ=-5.225027e-05 ||∇||=4.283434e-01 | Tr=0.1015 Te/Cur=0.0893 Te/Exp=0.2131]100%|██████████| 2/2 [00:19<00:00,  9.70s/it, CE=2.257683e+00 H=2.257640e+00 dV_dx=8.540353e-06 dV_dθ=-5.225027e-05 ||∇||=4.283434e-01 | Tr=0.1015 Te/Cur=0.0893 Te/Exp=0.2131]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.94s/it] 50%|█████     | 1/2 [00:07<00:04,  4.94s/it, CE=2.263800e+00 H=2.263698e+00 dV_dx=-6.046985e-06 dV_dθ=-9.555653e-05 ||∇||=4.168919e-01 | Tr=0.1180 Te/Cur=0.1189 Te/Exp=0.2862]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.263800e+00 H=2.263698e+00 dV_dx=-6.046985e-06 dV_dθ=-9.555653e-05 ||∇||=4.168919e-01 | Tr=0.1180 Te/Cur=0.1189 Te/Exp=0.2862]100%|██████████| 2/2 [00:07<00:00,  3.92s/it, CE=2.263800e+00 H=2.263698e+00 dV_dx=-6.046985e-06 dV_dθ=-9.555653e-05 ||∇||=4.168919e-01 | Tr=0.1180 Te/Cur=0.1189 Te/Exp=0.2862]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.96s/it] 50%|█████     | 1/2 [00:09<00:05,  5.96s/it, CE=2.279534e+00 H=2.279440e+00 dV_dx=-3.872273e-06 dV_dθ=-9.018331e-05 ||∇||=4.450292e-01 | Tr=0.1185 Te/Cur=0.1140 Te/Exp=0.2580]100%|██████████| 2/2 [00:09<00:00,  4.53s/it, CE=2.279534e+00 H=2.279440e+00 dV_dx=-3.872273e-06 dV_dθ=-9.018331e-05 ||∇||=4.450292e-01 | Tr=0.1185 Te/Cur=0.1140 Te/Exp=0.2580]100%|██████████| 2/2 [00:09<00:00,  4.75s/it, CE=2.279534e+00 H=2.279440e+00 dV_dx=-3.872273e-06 dV_dθ=-9.018331e-05 ||∇||=4.450292e-01 | Tr=0.1185 Te/Cur=0.1140 Te/Exp=0.2580]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.25s/it] 50%|█████     | 1/2 [00:16<00:13, 13.25s/it, CE=2.260443e+00 H=2.260368e+00 dV_dx=-3.055182e-06 dV_dθ=-7.242094e-05 ||∇||=4.478764e-01 | Tr=0.0854 Te/Cur=0.1089 Te/Exp=0.2812]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.260443e+00 H=2.260368e+00 dV_dx=-3.055182e-06 dV_dθ=-7.242094e-05 ||∇||=4.478764e-01 | Tr=0.0854 Te/Cur=0.1089 Te/Exp=0.2812]100%|██████████| 2/2 [00:16<00:00,  8.27s/it, CE=2.260443e+00 H=2.260368e+00 dV_dx=-3.055182e-06 dV_dθ=-7.242094e-05 ||∇||=4.478764e-01 | Tr=0.0854 Te/Cur=0.1089 Te/Exp=0.2812]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 632, 144, 10]) with loss 2.214141
  Total candidates evaluated: 54
  Original: (4, [432, 612, 164, 10])
  Optimal: (2, [507, 632, 144, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 4→2, feed [432, 612, 164, 10]→[507, 632, 144, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 4)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:10, 13.21s/it]  5%|▌         | 1/20 [00:15<04:10, 13.21s/it, CE=1.711014e+00 H=1.707514e+00 dV_dx=3.911777e-05 dV_dθ=-3.538534e-03 ||∇||=3.540357e+00 | Tr=0.7438] 10%|█         | 2/20 [00:15<02:04,  6.94s/it, CE=1.711014e+00 H=1.707514e+00 dV_dx=3.911777e-05 dV_dθ=-3.538534e-03 ||∇||=3.540357e+00 | Tr=0.7438] 10%|█         | 2/20 [00:17<02:04,  6.94s/it, CE=1.456517e+00 H=1.445887e+00 dV_dx=2.002060e-05 dV_dθ=-1.065028e-02 ||∇||=4.236011e+00 | Tr=0.7438] 15%|█▌        | 3/20 [00:17<01:20,  4.73s/it, CE=1.456517e+00 H=1.445887e+00 dV_dx=2.002060e-05 dV_dθ=-1.065028e-02 ||∇||=4.236011e+00 | Tr=0.7438] 15%|█▌        | 3/20 [00:20<01:20,  4.73s/it, CE=1.287115e+00 H=1.263603e+00 dV_dx=-2.022052e-05 dV_dθ=-2.349162e-02 ||∇||=5.418665e+00 | Tr=0.7438] 20%|██        | 4/20 [00:20<01:00,  3.77s/it, CE=1.287115e+00 H=1.263603e+00 dV_dx=-2.022052e-05 dV_dθ=-2.349162e-02 ||∇||=5.418665e+00 | Tr=0.7438] 20%|██        | 4/20 [00:22<01:00,  3.77s/it, CE=1.169317e+00 H=1.142778e+00 dV_dx=7.908239e-05 dV_dθ=-2.661798e-02 ||∇||=5.705865e+00 | Tr=0.7438]  25%|██▌       | 5/20 [00:22<00:47,  3.16s/it, CE=1.169317e+00 H=1.142778e+00 dV_dx=7.908239e-05 dV_dθ=-2.661798e-02 ||∇||=5.705865e+00 | Tr=0.7438] 25%|██▌       | 5/20 [00:24<00:47,  3.16s/it, CE=1.085462e+00 H=1.061662e+00 dV_dx=5.560235e-05 dV_dθ=-2.385558e-02 ||∇||=5.575775e+00 | Tr=0.7438] 30%|███       | 6/20 [00:24<00:39,  2.85s/it, CE=1.085462e+00 H=1.061662e+00 dV_dx=5.560235e-05 dV_dθ=-2.385558e-02 ||∇||=5.575775e+00 | Tr=0.7438] 30%|███       | 6/20 [00:26<00:39,  2.85s/it, CE=1.019997e+00 H=9.966949e-01 dV_dx=-2.340837e-05 dV_dθ=-2.327853e-02 ||∇||=5.568933e+00 | Tr=0.7438] 35%|███▌      | 7/20 [00:26<00:32,  2.48s/it, CE=1.019997e+00 H=9.966949e-01 dV_dx=-2.340837e-05 dV_dθ=-2.327853e-02 ||∇||=5.568933e+00 | Tr=0.7438] 35%|███▌      | 7/20 [00:28<00:32,  2.48s/it, CE=9.652987e-01 H=9.445323e-01 dV_dx=1.409100e-05 dV_dθ=-2.078054e-02 ||∇||=5.396510e+00 | Tr=0.7438]  40%|████      | 8/20 [00:28<00:28,  2.42s/it, CE=9.652987e-01 H=9.445323e-01 dV_dx=1.409100e-05 dV_dθ=-2.078054e-02 ||∇||=5.396510e+00 | Tr=0.7438] 40%|████      | 8/20 [00:31<00:28,  2.42s/it, CE=9.204874e-01 H=9.013099e-01 dV_dx=4.256602e-05 dV_dθ=-1.922010e-02 ||∇||=5.375177e+00 | Tr=0.7438] 45%|████▌     | 9/20 [00:31<00:28,  2.55s/it, CE=9.204874e-01 H=9.013099e-01 dV_dx=4.256602e-05 dV_dθ=-1.922010e-02 ||∇||=5.375177e+00 | Tr=0.7438] 45%|████▌     | 9/20 [00:34<00:28,  2.55s/it, CE=8.826442e-01 H=8.637411e-01 dV_dx=3.625590e-05 dV_dθ=-1.893939e-02 ||∇||=5.423019e+00 | Tr=0.7438] 50%|█████     | 10/20 [00:34<00:26,  2.65s/it, CE=8.826442e-01 H=8.637411e-01 dV_dx=3.625590e-05 dV_dθ=-1.893939e-02 ||∇||=5.423019e+00 | Tr=0.7438] 50%|█████     | 10/20 [00:37<00:26,  2.65s/it, CE=8.505635e-01 H=8.309044e-01 dV_dx=1.236860e-05 dV_dθ=-1.967146e-02 ||∇||=5.552724e+00 | Tr=0.7438] 55%|█████▌    | 11/20 [00:37<00:25,  2.78s/it, CE=8.505635e-01 H=8.309044e-01 dV_dx=1.236860e-05 dV_dθ=-1.967146e-02 ||∇||=5.552724e+00 | Tr=0.7438] 55%|█████▌    | 11/20 [00:39<00:25,  2.78s/it, CE=8.228719e-01 H=8.036133e-01 dV_dx=-2.265533e-05 dV_dθ=-1.923597e-02 ||∇||=5.557750e+00 | Tr=0.7438] 60%|██████    | 12/20 [00:39<00:20,  2.57s/it, CE=8.228719e-01 H=8.036133e-01 dV_dx=-2.265533e-05 dV_dθ=-1.923597e-02 ||∇||=5.557750e+00 | Tr=0.7438] 60%|██████    | 12/20 [00:41<00:20,  2.57s/it, CE=7.984020e-01 H=7.791682e-01 dV_dx=-3.984214e-05 dV_dθ=-1.919392e-02 ||∇||=5.588753e+00 | Tr=0.7438] 65%|██████▌   | 13/20 [00:41<00:17,  2.48s/it, CE=7.984020e-01 H=7.791682e-01 dV_dx=-3.984214e-05 dV_dθ=-1.919392e-02 ||∇||=5.588753e+00 | Tr=0.7438] 65%|██████▌   | 13/20 [00:43<00:17,  2.48s/it, CE=7.765412e-01 H=7.586321e-01 dV_dx=7.013907e-05 dV_dθ=-1.797927e-02 ||∇||=5.501804e+00 | Tr=0.7438]  70%|███████   | 14/20 [00:43<00:13,  2.31s/it, CE=7.765412e-01 H=7.586321e-01 dV_dx=7.013907e-05 dV_dθ=-1.797927e-02 ||∇||=5.501804e+00 | Tr=0.7438] 70%|███████   | 14/20 [00:47<00:13,  2.31s/it, CE=7.564954e-01 H=7.401183e-01 dV_dx=-9.296847e-07 dV_dθ=-1.637620e-02 ||∇||=5.389218e+00 | Tr=0.7438] 75%|███████▌  | 15/20 [00:47<00:13,  2.74s/it, CE=7.564954e-01 H=7.401183e-01 dV_dx=-9.296847e-07 dV_dθ=-1.637620e-02 ||∇||=5.389218e+00 | Tr=0.7438] 75%|███████▌  | 15/20 [00:49<00:13,  2.74s/it, CE=7.406651e-01 H=7.220177e-01 dV_dx=-5.583334e-05 dV_dθ=-1.859159e-02 ||∇||=5.644128e+00 | Tr=0.7438] 80%|████████  | 16/20 [00:49<00:10,  2.61s/it, CE=7.406651e-01 H=7.220177e-01 dV_dx=-5.583334e-05 dV_dθ=-1.859159e-02 ||∇||=5.644128e+00 | Tr=0.7438] 80%|████████  | 16/20 [00:51<00:10,  2.61s/it, CE=7.266513e-01 H=7.068437e-01 dV_dx=2.179643e-05 dV_dθ=-1.982946e-02 ||∇||=5.811621e+00 | Tr=0.7438]  85%|████████▌ | 17/20 [00:51<00:07,  2.52s/it, CE=7.266513e-01 H=7.068437e-01 dV_dx=2.179643e-05 dV_dθ=-1.982946e-02 ||∇||=5.811621e+00 | Tr=0.7438] 85%|████████▌ | 17/20 [00:54<00:07,  2.52s/it, CE=7.124538e-01 H=6.935316e-01 dV_dx=-4.660636e-05 dV_dθ=-1.887556e-02 ||∇||=5.742258e+00 | Tr=0.7438] 90%|█████████ | 18/20 [00:54<00:04,  2.41s/it, CE=7.124538e-01 H=6.935316e-01 dV_dx=-4.660636e-05 dV_dθ=-1.887556e-02 ||∇||=5.742258e+00 | Tr=0.7438] 90%|█████████ | 18/20 [00:55<00:04,  2.41s/it, CE=6.980895e-01 H=6.814789e-01 dV_dx=-1.405442e-05 dV_dθ=-1.659650e-02 ||∇||=5.460125e+00 | Tr=0.7438] 95%|█████████▌| 19/20 [00:55<00:02,  2.24s/it, CE=6.980895e-01 H=6.814789e-01 dV_dx=-1.405442e-05 dV_dθ=-1.659650e-02 ||∇||=5.460125e+00 | Tr=0.7438] 95%|█████████▌| 19/20 [00:59<00:02,  2.24s/it, CE=6.846197e-01 H=6.690269e-01 dV_dx=1.278345e-05 dV_dθ=-1.560553e-02 ||∇||=5.321185e+00 | Tr=0.7438 Te/Cur=0.9396 Te/Exp=0.7449]100%|██████████| 20/20 [01:03<00:00,  3.77s/it, CE=6.846197e-01 H=6.690269e-01 dV_dx=1.278345e-05 dV_dθ=-1.560553e-02 ||∇||=5.321185e+00 | Tr=0.7438 Te/Cur=0.9396 Te/Exp=0.7449]100%|██████████| 20/20 [01:03<00:00,  3.16s/it, CE=6.846197e-01 H=6.690269e-01 dV_dx=1.278345e-05 dV_dθ=-1.560553e-02 ||∇||=5.321185e+00 | Tr=0.7438 Te/Cur=0.9396 Te/Exp=0.7449]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.608653
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:46,  8.78s/it]  5%|▌         | 1/20 [00:11<02:46,  8.78s/it, CE=7.062660e-01 H=6.990485e-01 dV_dx=3.415290e-05 dV_dθ=-7.251687e-03 ||∇||=4.371469e+00 | Tr=0.7442] 10%|█         | 2/20 [00:11<01:30,  5.01s/it, CE=7.062660e-01 H=6.990485e-01 dV_dx=3.415290e-05 dV_dθ=-7.251687e-03 ||∇||=4.371469e+00 | Tr=0.7442] 10%|█         | 2/20 [00:13<01:30,  5.01s/it, CE=6.867820e-01 H=6.815648e-01 dV_dx=9.843837e-05 dV_dθ=-5.315612e-03 ||∇||=4.111352e+00 | Tr=0.7442] 15%|█▌        | 3/20 [00:13<01:05,  3.85s/it, CE=6.867820e-01 H=6.815648e-01 dV_dx=9.843837e-05 dV_dθ=-5.315612e-03 ||∇||=4.111352e+00 | Tr=0.7442] 15%|█▌        | 3/20 [00:15<01:05,  3.85s/it, CE=6.715477e-01 H=6.670022e-01 dV_dx=1.473969e-05 dV_dθ=-4.560206e-03 ||∇||=4.061793e+00 | Tr=0.7442] 20%|██        | 4/20 [00:15<00:50,  3.17s/it, CE=6.715477e-01 H=6.670022e-01 dV_dx=1.473969e-05 dV_dθ=-4.560206e-03 ||∇||=4.061793e+00 | Tr=0.7442] 20%|██        | 4/20 [00:17<00:50,  3.17s/it, CE=6.575890e-01 H=6.531543e-01 dV_dx=2.025334e-05 dV_dθ=-4.454965e-03 ||∇||=4.063201e+00 | Tr=0.7442] 25%|██▌       | 5/20 [00:17<00:41,  2.77s/it, CE=6.575890e-01 H=6.531543e-01 dV_dx=2.025334e-05 dV_dθ=-4.454965e-03 ||∇||=4.063201e+00 | Tr=0.7442] 25%|██▌       | 5/20 [00:19<00:41,  2.77s/it, CE=6.453477e-01 H=6.411940e-01 dV_dx=2.216154e-05 dV_dθ=-4.175900e-03 ||∇||=4.029326e+00 | Tr=0.7442] 30%|███       | 6/20 [00:19<00:35,  2.57s/it, CE=6.453477e-01 H=6.411940e-01 dV_dx=2.216154e-05 dV_dθ=-4.175900e-03 ||∇||=4.029326e+00 | Tr=0.7442] 30%|███       | 6/20 [00:22<00:35,  2.57s/it, CE=6.353956e-01 H=6.305605e-01 dV_dx=4.575886e-05 dV_dθ=-4.880872e-03 ||∇||=4.140981e+00 | Tr=0.7442] 35%|███▌      | 7/20 [00:22<00:31,  2.43s/it, CE=6.353956e-01 H=6.305605e-01 dV_dx=4.575886e-05 dV_dθ=-4.880872e-03 ||∇||=4.140981e+00 | Tr=0.7442] 35%|███▌      | 7/20 [00:24<00:31,  2.43s/it, CE=6.258384e-01 H=6.209349e-01 dV_dx=-8.135325e-06 dV_dθ=-4.895361e-03 ||∇||=4.163131e+00 | Tr=0.7442] 40%|████      | 8/20 [00:24<00:28,  2.38s/it, CE=6.258384e-01 H=6.209349e-01 dV_dx=-8.135325e-06 dV_dθ=-4.895361e-03 ||∇||=4.163131e+00 | Tr=0.7442] 40%|████      | 8/20 [00:26<00:28,  2.38s/it, CE=6.167705e-01 H=6.118947e-01 dV_dx=4.701861e-05 dV_dθ=-4.922827e-03 ||∇||=4.157300e+00 | Tr=0.7442]  45%|████▌     | 9/20 [00:26<00:26,  2.40s/it, CE=6.167705e-01 H=6.118947e-01 dV_dx=4.701861e-05 dV_dθ=-4.922827e-03 ||∇||=4.157300e+00 | Tr=0.7442] 45%|████▌     | 9/20 [00:30<00:26,  2.40s/it, CE=6.088167e-01 H=6.037421e-01 dV_dx=-9.915225e-06 dV_dθ=-5.064758e-03 ||∇||=4.228842e+00 | Tr=0.7442] 50%|█████     | 10/20 [00:30<00:27,  2.77s/it, CE=6.088167e-01 H=6.037421e-01 dV_dx=-9.915225e-06 dV_dθ=-5.064758e-03 ||∇||=4.228842e+00 | Tr=0.7442] 50%|█████     | 10/20 [00:32<00:27,  2.77s/it, CE=6.024294e-01 H=5.964938e-01 dV_dx=1.869354e-05 dV_dθ=-5.954246e-03 ||∇||=4.403302e+00 | Tr=0.7442]  55%|█████▌    | 11/20 [00:32<00:23,  2.63s/it, CE=6.024294e-01 H=5.964938e-01 dV_dx=1.869354e-05 dV_dθ=-5.954246e-03 ||∇||=4.403302e+00 | Tr=0.7442] 55%|█████▌    | 11/20 [00:35<00:23,  2.63s/it, CE=5.962896e-01 H=5.897049e-01 dV_dx=2.900537e-05 dV_dθ=-6.613721e-03 ||∇||=4.517729e+00 | Tr=0.7442] 60%|██████    | 12/20 [00:35<00:20,  2.53s/it, CE=5.962896e-01 H=5.897049e-01 dV_dx=2.900537e-05 dV_dθ=-6.613721e-03 ||∇||=4.517729e+00 | Tr=0.7442] 60%|██████    | 12/20 [00:37<00:20,  2.53s/it, CE=5.935024e-01 H=5.851230e-01 dV_dx=8.198322e-06 dV_dθ=-8.387656e-03 ||∇||=4.813294e+00 | Tr=0.7442] 65%|██████▌   | 13/20 [00:37<00:17,  2.51s/it, CE=5.935024e-01 H=5.851230e-01 dV_dx=8.198322e-06 dV_dθ=-8.387656e-03 ||∇||=4.813294e+00 | Tr=0.7442] 65%|██████▌   | 13/20 [00:39<00:17,  2.51s/it, CE=5.942962e-01 H=5.845328e-01 dV_dx=1.628085e-05 dV_dθ=-9.779733e-03 ||∇||=5.109195e+00 | Tr=0.7442] 70%|███████   | 14/20 [00:39<00:14,  2.39s/it, CE=5.942962e-01 H=5.845328e-01 dV_dx=1.628085e-05 dV_dθ=-9.779733e-03 ||∇||=5.109195e+00 | Tr=0.7442] 70%|███████   | 14/20 [00:42<00:14,  2.39s/it, CE=5.959896e-01 H=5.851424e-01 dV_dx=-2.474099e-05 dV_dθ=-1.082237e-02 ||∇||=5.262947e+00 | Tr=0.7442] 75%|███████▌  | 15/20 [00:42<00:12,  2.43s/it, CE=5.959896e-01 H=5.851424e-01 dV_dx=-2.474099e-05 dV_dθ=-1.082237e-02 ||∇||=5.262947e+00 | Tr=0.7442] 75%|███████▌  | 15/20 [00:44<00:12,  2.43s/it, CE=5.780043e-01 H=5.709363e-01 dV_dx=6.074777e-05 dV_dθ=-7.128751e-03 ||∇||=4.568940e+00 | Tr=0.7442]  80%|████████  | 16/20 [00:44<00:09,  2.33s/it, CE=5.780043e-01 H=5.709363e-01 dV_dx=6.074777e-05 dV_dθ=-7.128751e-03 ||∇||=4.568940e+00 | Tr=0.7442] 80%|████████  | 16/20 [00:46<00:09,  2.33s/it, CE=5.656629e-01 H=5.590369e-01 dV_dx=-4.923005e-06 dV_dθ=-6.621149e-03 ||∇||=4.367799e+00 | Tr=0.7442] 85%|████████▌ | 17/20 [00:46<00:06,  2.19s/it, CE=5.656629e-01 H=5.590369e-01 dV_dx=-4.923005e-06 dV_dθ=-6.621149e-03 ||∇||=4.367799e+00 | Tr=0.7442] 85%|████████▌ | 17/20 [00:48<00:06,  2.19s/it, CE=5.579497e-01 H=5.530559e-01 dV_dx=-4.926645e-05 dV_dθ=-4.844510e-03 ||∇||=4.126702e+00 | Tr=0.7442] 90%|█████████ | 18/20 [00:48<00:04,  2.28s/it, CE=5.579497e-01 H=5.530559e-01 dV_dx=-4.926645e-05 dV_dθ=-4.844510e-03 ||∇||=4.126702e+00 | Tr=0.7442] 90%|█████████ | 18/20 [00:50<00:04,  2.28s/it, CE=5.516371e-01 H=5.472868e-01 dV_dx=5.811239e-05 dV_dθ=-4.408395e-03 ||∇||=4.052121e+00 | Tr=0.7442]  95%|█████████▌| 19/20 [00:50<00:02,  2.21s/it, CE=5.516371e-01 H=5.472868e-01 dV_dx=5.811239e-05 dV_dθ=-4.408395e-03 ||∇||=4.052121e+00 | Tr=0.7442] 95%|█████████▌| 19/20 [00:54<00:02,  2.21s/it, CE=5.457208e-01 H=5.415854e-01 dV_dx=2.438891e-05 dV_dθ=-4.159828e-03 ||∇||=4.084307e+00 | Tr=0.7442 Te/Cur=0.9554 Te/Exp=0.7872]100%|██████████| 20/20 [00:57<00:00,  3.46s/it, CE=5.457208e-01 H=5.415854e-01 dV_dx=2.438891e-05 dV_dθ=-4.159828e-03 ||∇||=4.084307e+00 | Tr=0.7442 Te/Cur=0.9554 Te/Exp=0.7872]100%|██████████| 20/20 [00:57<00:00,  2.85s/it, CE=5.457208e-01 H=5.415854e-01 dV_dx=2.438891e-05 dV_dθ=-4.159828e-03 ||∇||=4.084307e+00 | Tr=0.7442 Te/Cur=0.9554 Te/Exp=0.7872]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.34s/it] 50%|█████     | 1/2 [00:12<00:09,  9.34s/it, CE=5.859954e-01 H=5.855851e-01 dV_dx=-1.179782e-04 dV_dθ=-2.923399e-04 ||∇||=1.071143e+00 | Tr=0.9871 Te/Cur=0.9673 Te/Exp=0.7875]100%|██████████| 2/2 [00:12<00:00,  5.89s/it, CE=5.859954e-01 H=5.855851e-01 dV_dx=-1.179782e-04 dV_dθ=-2.923399e-04 ||∇||=1.071143e+00 | Tr=0.9871 Te/Cur=0.9673 Te/Exp=0.7875]100%|██████████| 2/2 [00:12<00:00,  6.41s/it, CE=5.859954e-01 H=5.855851e-01 dV_dx=-1.179782e-04 dV_dθ=-2.923399e-04 ||∇||=1.071143e+00 | Tr=0.9871 Te/Cur=0.9673 Te/Exp=0.7875]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<02:05,  6.62s/it]  5%|▌         | 1/20 [00:08<02:05,  6.62s/it, CE=5.793890e-01 H=5.791404e-01 dV_dx=-2.062648e-06 dV_dθ=-2.465198e-04 ||∇||=1.021390e+00 | Tr=0.9883] 10%|█         | 2/20 [00:08<01:11,  3.99s/it, CE=5.793890e-01 H=5.791404e-01 dV_dx=-2.062648e-06 dV_dθ=-2.465198e-04 ||∇||=1.021390e+00 | Tr=0.9883] 10%|█         | 2/20 [00:10<01:11,  3.99s/it, CE=5.705532e-01 H=5.702031e-01 dV_dx=-9.593540e-05 dV_dθ=-2.542265e-04 ||∇||=1.025112e+00 | Tr=0.9888] 15%|█▌        | 3/20 [00:10<00:49,  2.88s/it, CE=5.705532e-01 H=5.702031e-01 dV_dx=-9.593540e-05 dV_dθ=-2.542265e-04 ||∇||=1.025112e+00 | Tr=0.9888] 15%|█▌        | 3/20 [00:12<00:49,  2.88s/it, CE=5.629828e-01 H=5.626554e-01 dV_dx=-1.103814e-04 dV_dθ=-2.170527e-04 ||∇||=1.000903e+00 | Tr=0.9897] 20%|██        | 4/20 [00:12<00:41,  2.61s/it, CE=5.629828e-01 H=5.626554e-01 dV_dx=-1.103814e-04 dV_dθ=-2.170527e-04 ||∇||=1.000903e+00 | Tr=0.9897] 20%|██        | 4/20 [00:14<00:41,  2.61s/it, CE=5.561673e-01 H=5.558936e-01 dV_dx=-8.956864e-05 dV_dθ=-1.840906e-04 ||∇||=9.793054e-01 | Tr=0.9900] 25%|██▌       | 5/20 [00:14<00:36,  2.41s/it, CE=5.561673e-01 H=5.558936e-01 dV_dx=-8.956864e-05 dV_dθ=-1.840906e-04 ||∇||=9.793054e-01 | Tr=0.9900] 25%|██▌       | 5/20 [00:18<00:36,  2.41s/it, CE=5.501880e-01 H=5.501436e-01 dV_dx=1.266557e-04 dV_dθ=-1.710689e-04 ||∇||=9.731984e-01 | Tr=0.9905 Te/Cur=0.9688 Te/Exp=0.8007] 30%|███       | 6/20 [00:18<00:38,  2.77s/it, CE=5.501880e-01 H=5.501436e-01 dV_dx=1.266557e-04 dV_dθ=-1.710689e-04 ||∇||=9.731984e-01 | Tr=0.9905 Te/Cur=0.9688 Te/Exp=0.8007] 30%|███       | 6/20 [00:19<00:38,  2.77s/it, CE=5.447373e-01 H=5.447342e-01 dV_dx=1.639995e-04 dV_dθ=-1.671532e-04 ||∇||=9.751595e-01 | Tr=0.9909]                             35%|███▌      | 7/20 [00:19<00:32,  2.50s/it, CE=5.447373e-01 H=5.447342e-01 dV_dx=1.639995e-04 dV_dθ=-1.671532e-04 ||∇||=9.751595e-01 | Tr=0.9909] 35%|███▌      | 7/20 [00:22<00:32,  2.50s/it, CE=5.397277e-01 H=5.396157e-01 dV_dx=5.434726e-05 dV_dθ=-1.663341e-04 ||∇||=9.775133e-01 | Tr=0.9911] 40%|████      | 8/20 [00:22<00:28,  2.39s/it, CE=5.397277e-01 H=5.396157e-01 dV_dx=5.434726e-05 dV_dθ=-1.663341e-04 ||∇||=9.775133e-01 | Tr=0.9911] 40%|████      | 8/20 [00:24<00:28,  2.39s/it, CE=5.348537e-01 H=5.347452e-01 dV_dx=4.492120e-05 dV_dθ=-1.534087e-04 ||∇||=9.678585e-01 | Tr=0.9916] 45%|████▌     | 9/20 [00:24<00:25,  2.27s/it, CE=5.348537e-01 H=5.347452e-01 dV_dx=4.492120e-05 dV_dθ=-1.534087e-04 ||∇||=9.678585e-01 | Tr=0.9916] 45%|████▌     | 9/20 [00:26<00:25,  2.27s/it, CE=5.304391e-01 H=5.301875e-01 dV_dx=-1.022129e-04 dV_dθ=-1.494463e-04 ||∇||=9.686321e-01 | Tr=0.9919] 50%|█████     | 10/20 [00:26<00:22,  2.27s/it, CE=5.304391e-01 H=5.301875e-01 dV_dx=-1.022129e-04 dV_dθ=-1.494463e-04 ||∇||=9.686321e-01 | Tr=0.9919] 50%|█████     | 10/20 [00:30<00:22,  2.27s/it, CE=5.261646e-01 H=5.261503e-01 dV_dx=1.188464e-04 dV_dθ=-1.331052e-04 ||∇||=9.604793e-01 | Tr=0.9922 Te/Cur=0.9705 Te/Exp=0.8018] 55%|█████▌    | 11/20 [00:30<00:24,  2.71s/it, CE=5.261646e-01 H=5.261503e-01 dV_dx=1.188464e-04 dV_dθ=-1.331052e-04 ||∇||=9.604793e-01 | Tr=0.9922 Te/Cur=0.9705 Te/Exp=0.8018] 55%|█████▌    | 11/20 [00:32<00:24,  2.71s/it, CE=5.219822e-01 H=5.217866e-01 dV_dx=-7.475721e-05 dV_dθ=-1.208424e-04 ||∇||=9.466604e-01 | Tr=0.9925]                            60%|██████    | 12/20 [00:32<00:21,  2.63s/it, CE=5.219822e-01 H=5.217866e-01 dV_dx=-7.475721e-05 dV_dθ=-1.208424e-04 ||∇||=9.466604e-01 | Tr=0.9925] 60%|██████    | 12/20 [00:34<00:21,  2.63s/it, CE=5.179738e-01 H=5.180975e-01 dV_dx=2.362278e-04 dV_dθ=-1.124810e-04 ||∇||=9.402213e-01 | Tr=0.9929]  65%|██████▌   | 13/20 [00:34<00:17,  2.52s/it, CE=5.179738e-01 H=5.180975e-01 dV_dx=2.362278e-04 dV_dθ=-1.124810e-04 ||∇||=9.402213e-01 | Tr=0.9929] 65%|██████▌   | 13/20 [00:36<00:17,  2.52s/it, CE=5.143227e-01 H=5.142194e-01 dV_dx=1.796029e-05 dV_dθ=-1.213229e-04 ||∇||=9.409186e-01 | Tr=0.9931] 70%|███████   | 14/20 [00:36<00:14,  2.33s/it, CE=5.143227e-01 H=5.142194e-01 dV_dx=1.796029e-05 dV_dθ=-1.213229e-04 ||∇||=9.409186e-01 | Tr=0.9931] 70%|███████   | 14/20 [00:38<00:14,  2.33s/it, CE=5.108301e-01 H=5.106472e-01 dV_dx=-6.493389e-05 dV_dθ=-1.180057e-04 ||∇||=9.335243e-01 | Tr=0.9933] 75%|███████▌  | 15/20 [00:38<00:10,  2.15s/it, CE=5.108301e-01 H=5.106472e-01 dV_dx=-6.493389e-05 dV_dθ=-1.180057e-04 ||∇||=9.335243e-01 | Tr=0.9933] 75%|███████▌  | 15/20 [00:44<00:10,  2.15s/it, CE=5.075034e-01 H=5.074047e-01 dV_dx=2.416879e-05 dV_dθ=-1.228533e-04 ||∇||=9.398114e-01 | Tr=0.9935 Te/Cur=0.9726 Te/Exp=0.7940] 80%|████████  | 16/20 [00:44<00:12,  3.19s/it, CE=5.075034e-01 H=5.074047e-01 dV_dx=2.416879e-05 dV_dθ=-1.228533e-04 ||∇||=9.398114e-01 | Tr=0.9935 Te/Cur=0.9726 Te/Exp=0.7940] 80%|████████  | 16/20 [00:46<00:12,  3.19s/it, CE=5.041524e-01 H=5.040988e-01 dV_dx=6.036250e-05 dV_dθ=-1.140544e-04 ||∇||=9.344290e-01 | Tr=0.9939]                             85%|████████▌ | 17/20 [00:46<00:08,  2.82s/it, CE=5.041524e-01 H=5.040988e-01 dV_dx=6.036250e-05 dV_dθ=-1.140544e-04 ||∇||=9.344290e-01 | Tr=0.9939] 85%|████████▌ | 17/20 [00:47<00:08,  2.82s/it, CE=5.010532e-01 H=5.008929e-01 dV_dx=-4.070366e-05 dV_dθ=-1.195135e-04 ||∇||=9.362022e-01 | Tr=0.9941] 90%|█████████ | 18/20 [00:47<00:05,  2.53s/it, CE=5.010532e-01 H=5.008929e-01 dV_dx=-4.070366e-05 dV_dθ=-1.195135e-04 ||∇||=9.362022e-01 | Tr=0.9941] 90%|█████████ | 18/20 [00:50<00:05,  2.53s/it, CE=4.979128e-01 H=4.977048e-01 dV_dx=-8.536625e-05 dV_dθ=-1.225596e-04 ||∇||=9.314257e-01 | Tr=0.9944] 95%|█████████▌| 19/20 [00:50<00:02,  2.42s/it, CE=4.979128e-01 H=4.977048e-01 dV_dx=-8.536625e-05 dV_dθ=-1.225596e-04 ||∇||=9.314257e-01 | Tr=0.9944] 95%|█████████▌| 19/20 [00:53<00:02,  2.42s/it, CE=4.950154e-01 H=4.948497e-01 dV_dx=-4.602783e-05 dV_dθ=-1.196327e-04 ||∇||=9.331053e-01 | Tr=0.9946 Te/Cur=0.9725 Te/Exp=0.8047]100%|██████████| 20/20 [00:53<00:00,  2.60s/it, CE=4.950154e-01 H=4.948497e-01 dV_dx=-4.602783e-05 dV_dθ=-1.196327e-04 ||∇||=9.331053e-01 | Tr=0.9946 Te/Cur=0.9725 Te/Exp=0.8047]100%|██████████| 20/20 [00:53<00:00,  2.65s/it, CE=4.950154e-01 H=4.948497e-01 dV_dx=-4.602783e-05 dV_dθ=-1.196327e-04 ||∇||=9.331053e-01 | Tr=0.9946 Te/Cur=0.9725 Te/Exp=0.8047]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 5 final loss: 0.501259
======================================================================


  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7677
    Task 1: 0.9348
    Task 2: 0.8250
    Task 3: 0.5704
    Task 4: 0.9219
    Task 5: 0.9725

============================================================
Task 6
============================================================
Initial loss on new task: 10.6052, previous: 0.4950, ratio: 21.42
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 6
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:08<?, ?it/s, CE=6.256286e-01 H=5.992414e-01 dV_dx=2.128636e-04 dV_dθ=-2.660008e-02 ||∇||=5.904091e+00 | Tr=0.6113 Te/Cur=0.7607 Te/Exp=0.8195]100%|██████████| 1/1 [00:08<00:00,  8.77s/it, CE=6.256286e-01 H=5.992414e-01 dV_dx=2.128636e-04 dV_dθ=-2.660008e-02 ||∇||=5.904091e+00 | Tr=0.6113 Te/Cur=0.7607 Te/Exp=0.8195]100%|██████████| 1/1 [00:08<00:00,  8.77s/it, CE=6.256286e-01 H=5.992414e-01 dV_dx=2.128636e-04 dV_dθ=-2.660008e-02 ||∇||=5.904091e+00 | Tr=0.6113 Te/Cur=0.7607 Te/Exp=0.8195]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.625629

[STEP 2] Architecture change decision
  Current: 0.625629, Previous: 0.495015
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 39931 samples from 10 classes
  Starting grid architecture search for task 6
  Baseline architecture: (2, [507, 632, 144, 10])
  Baseline loss: 0.625629
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.03s/it] 50%|█████     | 1/2 [00:04<00:03,  3.03s/it, CE=2.254174e+00 H=2.254183e+00 dV_dx=1.545767e-05 dV_dθ=-6.078256e-06 ||∇||=4.968053e-01 | Tr=0.0783 Te/Cur=0.0867 Te/Exp=0.2516]100%|██████████| 2/2 [00:04<00:00,  2.37s/it, CE=2.254174e+00 H=2.254183e+00 dV_dx=1.545767e-05 dV_dθ=-6.078256e-06 ||∇||=4.968053e-01 | Tr=0.0783 Te/Cur=0.0867 Te/Exp=0.2516]100%|██████████| 2/2 [00:04<00:00,  2.47s/it, CE=2.254174e+00 H=2.254183e+00 dV_dx=1.545767e-05 dV_dθ=-6.078256e-06 ||∇||=4.968053e-01 | Tr=0.0783 Te/Cur=0.0867 Te/Exp=0.2516]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2541740703409863
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.11s/it] 50%|█████     | 1/2 [00:13<00:12, 12.11s/it, CE=2.253713e+00 H=2.253638e+00 dV_dx=-2.722380e-05 dV_dθ=-4.768198e-05 ||∇||=4.644007e-01 | Tr=0.0715 Te/Cur=0.0741 Te/Exp=0.2898]100%|██████████| 2/2 [00:13<00:00,  5.85s/it, CE=2.253713e+00 H=2.253638e+00 dV_dx=-2.722380e-05 dV_dθ=-4.768198e-05 ||∇||=4.644007e-01 | Tr=0.0715 Te/Cur=0.0741 Te/Exp=0.2898]100%|██████████| 2/2 [00:13<00:00,  6.79s/it, CE=2.253713e+00 H=2.253638e+00 dV_dx=-2.722380e-05 dV_dθ=-4.768198e-05 ||∇||=4.644007e-01 | Tr=0.0715 Te/Cur=0.0741 Te/Exp=0.2898]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 124, 10]) with loss 2.253713
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.76s/it] 50%|█████     | 1/2 [00:11<00:09,  9.76s/it, CE=2.252238e+00 H=2.252157e+00 dV_dx=-6.407292e-06 dV_dθ=-7.467218e-05 ||∇||=4.292807e-01 | Tr=0.1404 Te/Cur=0.1482 Te/Exp=0.2922]100%|██████████| 2/2 [00:11<00:00,  5.11s/it, CE=2.252238e+00 H=2.252157e+00 dV_dx=-6.407292e-06 dV_dθ=-7.467218e-05 ||∇||=4.292807e-01 | Tr=0.1404 Te/Cur=0.1482 Te/Exp=0.2922]100%|██████████| 2/2 [00:11<00:00,  5.81s/it, CE=2.252238e+00 H=2.252157e+00 dV_dx=-6.407292e-06 dV_dθ=-7.467218e-05 ||∇||=4.292807e-01 | Tr=0.1404 Te/Cur=0.1482 Te/Exp=0.2922]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 124, 10]) with loss 2.252238
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.86s/it] 50%|█████     | 1/2 [00:05<00:03,  3.86s/it, CE=2.236173e+00 H=2.236131e+00 dV_dx=-2.167624e-05 dV_dθ=-2.006079e-05 ||∇||=4.924134e-01 | Tr=0.1575 Te/Cur=0.1857 Te/Exp=0.3293]100%|██████████| 2/2 [00:05<00:00,  2.67s/it, CE=2.236173e+00 H=2.236131e+00 dV_dx=-2.167624e-05 dV_dθ=-2.006079e-05 ||∇||=4.924134e-01 | Tr=0.1575 Te/Cur=0.1857 Te/Exp=0.3293]100%|██████████| 2/2 [00:05<00:00,  2.85s/it, CE=2.236173e+00 H=2.236131e+00 dV_dx=-2.167624e-05 dV_dθ=-2.006079e-05 ||∇||=4.924134e-01 | Tr=0.1575 Te/Cur=0.1857 Te/Exp=0.3293]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 144, 10]) with loss 2.236173
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.96s/it] 50%|█████     | 1/2 [00:04<00:02,  2.96s/it, CE=2.240184e+00 H=2.240056e+00 dV_dx=-2.343163e-05 dV_dθ=-1.047169e-04 ||∇||=5.205622e-01 | Tr=0.1867 Te/Cur=0.2235 Te/Exp=0.2993]100%|██████████| 2/2 [00:04<00:00,  2.19s/it, CE=2.240184e+00 H=2.240056e+00 dV_dx=-2.343163e-05 dV_dθ=-1.047169e-04 ||∇||=5.205622e-01 | Tr=0.1867 Te/Cur=0.2235 Te/Exp=0.2993]100%|██████████| 2/2 [00:04<00:00,  2.30s/it, CE=2.240184e+00 H=2.240056e+00 dV_dx=-2.343163e-05 dV_dθ=-1.047169e-04 ||∇||=5.205622e-01 | Tr=0.1867 Te/Cur=0.2235 Te/Exp=0.2993]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.53s/it] 50%|█████     | 1/2 [00:11<00:09,  9.53s/it, CE=2.251399e+00 H=2.251387e+00 dV_dx=2.507410e-05 dV_dθ=-3.704539e-05 ||∇||=4.190473e-01 | Tr=0.1044 Te/Cur=0.1023 Te/Exp=0.2796]100%|██████████| 2/2 [00:11<00:00,  5.28s/it, CE=2.251399e+00 H=2.251387e+00 dV_dx=2.507410e-05 dV_dθ=-3.704539e-05 ||∇||=4.190473e-01 | Tr=0.1044 Te/Cur=0.1023 Te/Exp=0.2796]100%|██████████| 2/2 [00:11<00:00,  5.92s/it, CE=2.251399e+00 H=2.251387e+00 dV_dx=2.507410e-05 dV_dθ=-3.704539e-05 ||∇||=4.190473e-01 | Tr=0.1044 Te/Cur=0.1023 Te/Exp=0.2796]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.41s/it] 50%|█████     | 1/2 [00:05<00:03,  3.41s/it, CE=2.246975e+00 H=2.246895e+00 dV_dx=1.516461e-05 dV_dθ=-9.608343e-05 ||∇||=4.934083e-01 | Tr=0.1257 Te/Cur=0.1160 Te/Exp=0.3035]100%|██████████| 2/2 [00:05<00:00,  2.46s/it, CE=2.246975e+00 H=2.246895e+00 dV_dx=1.516461e-05 dV_dθ=-9.608343e-05 ||∇||=4.934083e-01 | Tr=0.1257 Te/Cur=0.1160 Te/Exp=0.3035]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.246975e+00 H=2.246895e+00 dV_dx=1.516461e-05 dV_dθ=-9.608343e-05 ||∇||=4.934083e-01 | Tr=0.1257 Te/Cur=0.1160 Te/Exp=0.3035]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.31s/it] 50%|█████     | 1/2 [00:05<00:03,  3.31s/it, CE=2.255184e+00 H=2.255027e+00 dV_dx=-1.616795e-05 dV_dθ=-1.405948e-04 ||∇||=4.948145e-01 | Tr=0.1310 Te/Cur=0.1221 Te/Exp=0.2661]100%|██████████| 2/2 [00:05<00:00,  2.55s/it, CE=2.255184e+00 H=2.255027e+00 dV_dx=-1.616795e-05 dV_dθ=-1.405948e-04 ||∇||=4.948145e-01 | Tr=0.1310 Te/Cur=0.1221 Te/Exp=0.2661]100%|██████████| 2/2 [00:05<00:00,  2.67s/it, CE=2.255184e+00 H=2.255027e+00 dV_dx=-1.616795e-05 dV_dθ=-1.405948e-04 ||∇||=4.948145e-01 | Tr=0.1310 Te/Cur=0.1221 Te/Exp=0.2661]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.91s/it] 50%|█████     | 1/2 [00:14<00:12, 12.91s/it, CE=2.250827e+00 H=2.250754e+00 dV_dx=-1.410704e-05 dV_dθ=-5.914644e-05 ||∇||=4.722122e-01 | Tr=0.1238 Te/Cur=0.1469 Te/Exp=0.2687]100%|██████████| 2/2 [00:14<00:00,  6.36s/it, CE=2.250827e+00 H=2.250754e+00 dV_dx=-1.410704e-05 dV_dθ=-5.914644e-05 ||∇||=4.722122e-01 | Tr=0.1238 Te/Cur=0.1469 Te/Exp=0.2687]100%|██████████| 2/2 [00:14<00:00,  7.34s/it, CE=2.250827e+00 H=2.250754e+00 dV_dx=-1.410704e-05 dV_dθ=-5.914644e-05 ||∇||=4.722122e-01 | Tr=0.1238 Te/Cur=0.1469 Te/Exp=0.2687]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.43s/it] 50%|█████     | 1/2 [00:04<00:03,  3.43s/it, CE=2.257669e+00 H=2.257652e+00 dV_dx=7.345439e-06 dV_dθ=-2.431851e-05 ||∇||=3.636330e-01 | Tr=0.0725 Te/Cur=0.0842 Te/Exp=0.2719]100%|██████████| 2/2 [00:04<00:00,  2.31s/it, CE=2.257669e+00 H=2.257652e+00 dV_dx=7.345439e-06 dV_dθ=-2.431851e-05 ||∇||=3.636330e-01 | Tr=0.0725 Te/Cur=0.0842 Te/Exp=0.2719]100%|██████████| 2/2 [00:04<00:00,  2.48s/it, CE=2.257669e+00 H=2.257652e+00 dV_dx=7.345439e-06 dV_dθ=-2.431851e-05 ||∇||=3.636330e-01 | Tr=0.0725 Te/Cur=0.0842 Te/Exp=0.2719]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.48s/it] 50%|█████     | 1/2 [00:11<00:09,  9.48s/it, CE=2.254155e+00 H=2.254141e+00 dV_dx=8.514938e-06 dV_dθ=-2.230783e-05 ||∇||=4.000845e-01 | Tr=0.0862 Te/Cur=0.0750 Te/Exp=0.2364]100%|██████████| 2/2 [00:11<00:00,  4.89s/it, CE=2.254155e+00 H=2.254141e+00 dV_dx=8.514938e-06 dV_dθ=-2.230783e-05 ||∇||=4.000845e-01 | Tr=0.0862 Te/Cur=0.0750 Te/Exp=0.2364]100%|██████████| 2/2 [00:11<00:00,  5.58s/it, CE=2.254155e+00 H=2.254141e+00 dV_dx=8.514938e-06 dV_dθ=-2.230783e-05 ||∇||=4.000845e-01 | Tr=0.0862 Te/Cur=0.0750 Te/Exp=0.2364]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.43s/it] 50%|█████     | 1/2 [00:11<00:09,  9.43s/it, CE=2.263230e+00 H=2.263153e+00 dV_dx=-1.096230e-05 dV_dθ=-6.599021e-05 ||∇||=3.522582e-01 | Tr=0.1559 Te/Cur=0.1971 Te/Exp=0.2307]100%|██████████| 2/2 [00:11<00:00,  4.98s/it, CE=2.263230e+00 H=2.263153e+00 dV_dx=-1.096230e-05 dV_dθ=-6.599021e-05 ||∇||=3.522582e-01 | Tr=0.1559 Te/Cur=0.1971 Te/Exp=0.2307]100%|██████████| 2/2 [00:11<00:00,  5.64s/it, CE=2.263230e+00 H=2.263153e+00 dV_dx=-1.096230e-05 dV_dθ=-6.599021e-05 ||∇||=3.522582e-01 | Tr=0.1559 Te/Cur=0.1971 Te/Exp=0.2307]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.77s/it] 50%|█████     | 1/2 [00:05<00:03,  3.77s/it, CE=2.251439e+00 H=2.251398e+00 dV_dx=-1.553656e-05 dV_dθ=-2.585012e-05 ||∇||=3.832167e-01 | Tr=0.0935 Te/Cur=0.0983 Te/Exp=0.2853]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.251439e+00 H=2.251398e+00 dV_dx=-1.553656e-05 dV_dθ=-2.585012e-05 ||∇||=3.832167e-01 | Tr=0.0935 Te/Cur=0.0983 Te/Exp=0.2853]100%|██████████| 2/2 [00:05<00:00,  2.88s/it, CE=2.251439e+00 H=2.251398e+00 dV_dx=-1.553656e-05 dV_dθ=-2.585012e-05 ||∇||=3.832167e-01 | Tr=0.0935 Te/Cur=0.0983 Te/Exp=0.2853]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.46s/it] 50%|█████     | 1/2 [00:05<00:03,  3.46s/it, CE=2.263733e+00 H=2.263683e+00 dV_dx=-7.938291e-06 dV_dθ=-4.215955e-05 ||∇||=3.565592e-01 | Tr=0.1746 Te/Cur=0.1587 Te/Exp=0.2537]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.263733e+00 H=2.263683e+00 dV_dx=-7.938291e-06 dV_dθ=-4.215955e-05 ||∇||=3.565592e-01 | Tr=0.1746 Te/Cur=0.1587 Te/Exp=0.2537]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.263733e+00 H=2.263683e+00 dV_dx=-7.938291e-06 dV_dθ=-4.215955e-05 ||∇||=3.565592e-01 | Tr=0.1746 Te/Cur=0.1587 Te/Exp=0.2537]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.86s/it] 50%|█████     | 1/2 [00:11<00:09,  9.86s/it, CE=2.255169e+00 H=2.255157e+00 dV_dx=4.275810e-06 dV_dθ=-1.604027e-05 ||∇||=3.517630e-01 | Tr=0.0883 Te/Cur=0.0867 Te/Exp=0.2436]100%|██████████| 2/2 [00:11<00:00,  5.24s/it, CE=2.255169e+00 H=2.255157e+00 dV_dx=4.275810e-06 dV_dθ=-1.604027e-05 ||∇||=3.517630e-01 | Tr=0.0883 Te/Cur=0.0867 Te/Exp=0.2436]100%|██████████| 2/2 [00:11<00:00,  5.93s/it, CE=2.255169e+00 H=2.255157e+00 dV_dx=4.275810e-06 dV_dθ=-1.604027e-05 ||∇||=3.517630e-01 | Tr=0.0883 Te/Cur=0.0867 Te/Exp=0.2436]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.62s/it] 50%|█████     | 1/2 [00:08<00:06,  6.62s/it, CE=2.240992e+00 H=2.240998e+00 dV_dx=2.242321e-05 dV_dθ=-1.641273e-05 ||∇||=3.804225e-01 | Tr=0.0673 Te/Cur=0.0819 Te/Exp=0.3013]100%|██████████| 2/2 [00:08<00:00,  3.86s/it, CE=2.240992e+00 H=2.240998e+00 dV_dx=2.242321e-05 dV_dθ=-1.641273e-05 ||∇||=3.804225e-01 | Tr=0.0673 Te/Cur=0.0819 Te/Exp=0.3013]100%|██████████| 2/2 [00:08<00:00,  4.27s/it, CE=2.240992e+00 H=2.240998e+00 dV_dx=2.242321e-05 dV_dθ=-1.641273e-05 ||∇||=3.804225e-01 | Tr=0.0673 Te/Cur=0.0819 Te/Exp=0.3013]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.39s/it] 50%|█████     | 1/2 [00:05<00:03,  3.39s/it, CE=2.271009e+00 H=2.270931e+00 dV_dx=-2.149845e-05 dV_dθ=-5.632055e-05 ||∇||=3.823927e-01 | Tr=0.1290 Te/Cur=0.1420 Te/Exp=0.2188]100%|██████████| 2/2 [00:05<00:00,  2.71s/it, CE=2.271009e+00 H=2.270931e+00 dV_dx=-2.149845e-05 dV_dθ=-5.632055e-05 ||∇||=3.823927e-01 | Tr=0.1290 Te/Cur=0.1420 Te/Exp=0.2188]100%|██████████| 2/2 [00:05<00:00,  2.81s/it, CE=2.271009e+00 H=2.270931e+00 dV_dx=-2.149845e-05 dV_dθ=-5.632055e-05 ||∇||=3.823927e-01 | Tr=0.1290 Te/Cur=0.1420 Te/Exp=0.2188]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.54s/it] 50%|█████     | 1/2 [00:11<00:09,  9.54s/it, CE=2.267403e+00 H=2.267338e+00 dV_dx=-1.923309e-05 dV_dθ=-4.508264e-05 ||∇||=3.521574e-01 | Tr=0.1201 Te/Cur=0.1191 Te/Exp=0.2197]100%|██████████| 2/2 [00:11<00:00,  5.02s/it, CE=2.267403e+00 H=2.267338e+00 dV_dx=-1.923309e-05 dV_dθ=-4.508264e-05 ||∇||=3.521574e-01 | Tr=0.1201 Te/Cur=0.1191 Te/Exp=0.2197]100%|██████████| 2/2 [00:11<00:00,  5.70s/it, CE=2.267403e+00 H=2.267338e+00 dV_dx=-1.923309e-05 dV_dθ=-4.508264e-05 ||∇||=3.521574e-01 | Tr=0.1201 Te/Cur=0.1191 Te/Exp=0.2197]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.31s/it] 50%|█████     | 1/2 [00:05<00:03,  3.31s/it, CE=2.265373e+00 H=2.265300e+00 dV_dx=-2.606270e-06 dV_dθ=-7.025561e-05 ||∇||=3.541888e-01 | Tr=0.0981 Te/Cur=0.1019 Te/Exp=0.1983]100%|██████████| 2/2 [00:05<00:00,  2.47s/it, CE=2.265373e+00 H=2.265300e+00 dV_dx=-2.606270e-06 dV_dθ=-7.025561e-05 ||∇||=3.541888e-01 | Tr=0.0981 Te/Cur=0.1019 Te/Exp=0.1983]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.265373e+00 H=2.265300e+00 dV_dx=-2.606270e-06 dV_dθ=-7.025561e-05 ||∇||=3.541888e-01 | Tr=0.0981 Te/Cur=0.1019 Te/Exp=0.1983]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.35s/it] 50%|█████     | 1/2 [00:12<00:10, 10.35s/it, CE=2.271907e+00 H=2.271869e+00 dV_dx=1.542747e-06 dV_dθ=-3.970003e-05 ||∇||=3.597585e-01 | Tr=0.1291 Te/Cur=0.1269 Te/Exp=0.2147]100%|██████████| 2/2 [00:12<00:00,  5.45s/it, CE=2.271907e+00 H=2.271869e+00 dV_dx=1.542747e-06 dV_dθ=-3.970003e-05 ||∇||=3.597585e-01 | Tr=0.1291 Te/Cur=0.1269 Te/Exp=0.2147]100%|██████████| 2/2 [00:12<00:00,  6.19s/it, CE=2.271907e+00 H=2.271869e+00 dV_dx=1.542747e-06 dV_dθ=-3.970003e-05 ||∇||=3.597585e-01 | Tr=0.1291 Te/Cur=0.1269 Te/Exp=0.2147]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.86s/it] 50%|█████     | 1/2 [00:11<00:09,  9.86s/it, CE=2.268721e+00 H=2.268664e+00 dV_dx=-1.689348e-06 dV_dθ=-5.531955e-05 ||∇||=3.740889e-01 | Tr=0.1160 Te/Cur=0.1228 Te/Exp=0.1852]100%|██████████| 2/2 [00:11<00:00,  5.29s/it, CE=2.268721e+00 H=2.268664e+00 dV_dx=-1.689348e-06 dV_dθ=-5.531955e-05 ||∇||=3.740889e-01 | Tr=0.1160 Te/Cur=0.1228 Te/Exp=0.1852]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.268721e+00 H=2.268664e+00 dV_dx=-1.689348e-06 dV_dθ=-5.531955e-05 ||∇||=3.740889e-01 | Tr=0.1160 Te/Cur=0.1228 Te/Exp=0.1852]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.52s/it] 50%|█████     | 1/2 [00:05<00:03,  3.52s/it, CE=2.274673e+00 H=2.274637e+00 dV_dx=8.404798e-06 dV_dθ=-4.406998e-05 ||∇||=3.611943e-01 | Tr=0.0912 Te/Cur=0.0820 Te/Exp=0.2050]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.274673e+00 H=2.274637e+00 dV_dx=8.404798e-06 dV_dθ=-4.406998e-05 ||∇||=3.611943e-01 | Tr=0.0912 Te/Cur=0.0820 Te/Exp=0.2050]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.274673e+00 H=2.274637e+00 dV_dx=8.404798e-06 dV_dθ=-4.406998e-05 ||∇||=3.611943e-01 | Tr=0.0912 Te/Cur=0.0820 Te/Exp=0.2050]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.93s/it] 50%|█████     | 1/2 [00:07<00:05,  5.93s/it, CE=2.259211e+00 H=2.259154e+00 dV_dx=1.678292e-05 dV_dθ=-7.362156e-05 ||∇||=3.957261e-01 | Tr=0.1008 Te/Cur=0.0973 Te/Exp=0.1943]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.259211e+00 H=2.259154e+00 dV_dx=1.678292e-05 dV_dθ=-7.362156e-05 ||∇||=3.957261e-01 | Tr=0.1008 Te/Cur=0.0973 Te/Exp=0.1943]100%|██████████| 2/2 [00:07<00:00,  3.92s/it, CE=2.259211e+00 H=2.259154e+00 dV_dx=1.678292e-05 dV_dθ=-7.362156e-05 ||∇||=3.957261e-01 | Tr=0.1008 Te/Cur=0.0973 Te/Exp=0.1943]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.58s/it] 50%|█████     | 1/2 [00:11<00:09,  9.58s/it, CE=2.264540e+00 H=2.264493e+00 dV_dx=-6.413308e-06 dV_dθ=-4.056040e-05 ||∇||=3.784933e-01 | Tr=0.0806 Te/Cur=0.0785 Te/Exp=0.2201]100%|██████████| 2/2 [00:11<00:00,  5.01s/it, CE=2.264540e+00 H=2.264493e+00 dV_dx=-6.413308e-06 dV_dθ=-4.056040e-05 ||∇||=3.784933e-01 | Tr=0.0806 Te/Cur=0.0785 Te/Exp=0.2201]100%|██████████| 2/2 [00:11<00:00,  5.70s/it, CE=2.264540e+00 H=2.264493e+00 dV_dx=-6.413308e-06 dV_dθ=-4.056040e-05 ||∇||=3.784933e-01 | Tr=0.0806 Te/Cur=0.0785 Te/Exp=0.2201]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.63s/it] 50%|█████     | 1/2 [00:05<00:03,  3.63s/it, CE=2.257542e+00 H=2.257499e+00 dV_dx=4.818080e-06 dV_dθ=-4.781938e-05 ||∇||=3.628368e-01 | Tr=0.0943 Te/Cur=0.0821 Te/Exp=0.2722]100%|██████████| 2/2 [00:05<00:00,  2.47s/it, CE=2.257542e+00 H=2.257499e+00 dV_dx=4.818080e-06 dV_dθ=-4.781938e-05 ||∇||=3.628368e-01 | Tr=0.0943 Te/Cur=0.0821 Te/Exp=0.2722]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.257542e+00 H=2.257499e+00 dV_dx=4.818080e-06 dV_dθ=-4.781938e-05 ||∇||=3.628368e-01 | Tr=0.0943 Te/Cur=0.0821 Te/Exp=0.2722]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.261405e+00 H=2.261328e+00 dV_dx=-1.060638e-05 dV_dθ=-6.588182e-05 ||∇||=3.936135e-01 | Tr=0.0915 Te/Cur=0.0917 Te/Exp=0.2349]100%|██████████| 2/2 [00:05<00:00,  2.53s/it, CE=2.261405e+00 H=2.261328e+00 dV_dx=-1.060638e-05 dV_dθ=-6.588182e-05 ||∇||=3.936135e-01 | Tr=0.0915 Te/Cur=0.0917 Te/Exp=0.2349]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.261405e+00 H=2.261328e+00 dV_dx=-1.060638e-05 dV_dθ=-6.588182e-05 ||∇||=3.936135e-01 | Tr=0.0915 Te/Cur=0.0917 Te/Exp=0.2349]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.46s/it] 50%|█████     | 1/2 [00:11<00:09,  9.46s/it, CE=2.266068e+00 H=2.266015e+00 dV_dx=-4.979743e-06 dV_dθ=-4.779104e-05 ||∇||=3.580059e-01 | Tr=0.0853 Te/Cur=0.0678 Te/Exp=0.2384]100%|██████████| 2/2 [00:11<00:00,  5.13s/it, CE=2.266068e+00 H=2.266015e+00 dV_dx=-4.979743e-06 dV_dθ=-4.779104e-05 ||∇||=3.580059e-01 | Tr=0.0853 Te/Cur=0.0678 Te/Exp=0.2384]100%|██████████| 2/2 [00:11<00:00,  5.78s/it, CE=2.266068e+00 H=2.266015e+00 dV_dx=-4.979743e-06 dV_dθ=-4.779104e-05 ||∇||=3.580059e-01 | Tr=0.0853 Te/Cur=0.0678 Te/Exp=0.2384]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.42s/it] 50%|█████     | 1/2 [00:05<00:03,  3.42s/it, CE=2.280464e+00 H=2.280402e+00 dV_dx=-2.451734e-06 dV_dθ=-5.925860e-05 ||∇||=3.541796e-01 | Tr=0.0829 Te/Cur=0.0840 Te/Exp=0.1932]100%|██████████| 2/2 [00:05<00:00,  2.40s/it, CE=2.280464e+00 H=2.280402e+00 dV_dx=-2.451734e-06 dV_dθ=-5.925860e-05 ||∇||=3.541796e-01 | Tr=0.0829 Te/Cur=0.0840 Te/Exp=0.1932]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.280464e+00 H=2.280402e+00 dV_dx=-2.451734e-06 dV_dθ=-5.925860e-05 ||∇||=3.541796e-01 | Tr=0.0829 Te/Cur=0.0840 Te/Exp=0.1932]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2804640564508487
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.42s/it] 50%|█████     | 1/2 [00:07<00:05,  5.42s/it, CE=2.278534e+00 H=2.278500e+00 dV_dx=1.160107e-05 dV_dθ=-4.495266e-05 ||∇||=3.205015e-01 | Tr=0.1895 Te/Cur=0.2201 Te/Exp=0.1859]100%|██████████| 2/2 [00:07<00:00,  3.33s/it, CE=2.278534e+00 H=2.278500e+00 dV_dx=1.160107e-05 dV_dθ=-4.495266e-05 ||∇||=3.205015e-01 | Tr=0.1895 Te/Cur=0.2201 Te/Exp=0.1859]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.278534e+00 H=2.278500e+00 dV_dx=1.160107e-05 dV_dθ=-4.495266e-05 ||∇||=3.205015e-01 | Tr=0.1895 Te/Cur=0.2201 Te/Exp=0.1859]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 104, 10]) with loss 2.278534
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.64s/it] 50%|█████     | 1/2 [00:13<00:11, 11.64s/it, CE=2.268877e+00 H=2.268868e+00 dV_dx=6.776726e-06 dV_dθ=-1.620441e-05 ||∇||=3.489676e-01 | Tr=0.1685 Te/Cur=0.1680 Te/Exp=0.2349]100%|██████████| 2/2 [00:13<00:00,  5.78s/it, CE=2.268877e+00 H=2.268868e+00 dV_dx=6.776726e-06 dV_dθ=-1.620441e-05 ||∇||=3.489676e-01 | Tr=0.1685 Te/Cur=0.1680 Te/Exp=0.2349]100%|██████████| 2/2 [00:13<00:00,  6.66s/it, CE=2.268877e+00 H=2.268868e+00 dV_dx=6.776726e-06 dV_dθ=-1.620441e-05 ||∇||=3.489676e-01 | Tr=0.1685 Te/Cur=0.1680 Te/Exp=0.2349]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 104, 10]) with loss 2.268877
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.64s/it] 50%|█████     | 1/2 [00:07<00:05,  5.64s/it, CE=2.272623e+00 H=2.272576e+00 dV_dx=1.079280e-06 dV_dθ=-4.814504e-05 ||∇||=3.852143e-01 | Tr=0.1853 Te/Cur=0.2267 Te/Exp=0.2514]100%|██████████| 2/2 [00:07<00:00,  3.40s/it, CE=2.272623e+00 H=2.272576e+00 dV_dx=1.079280e-06 dV_dθ=-4.814504e-05 ||∇||=3.852143e-01 | Tr=0.1853 Te/Cur=0.2267 Te/Exp=0.2514]100%|██████████| 2/2 [00:07<00:00,  3.73s/it, CE=2.272623e+00 H=2.272576e+00 dV_dx=1.079280e-06 dV_dθ=-4.814504e-05 ||∇||=3.852143e-01 | Tr=0.1853 Te/Cur=0.2267 Te/Exp=0.2514]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.272789e+00 H=2.272750e+00 dV_dx=1.282667e-06 dV_dθ=-4.035134e-05 ||∇||=3.783731e-01 | Tr=0.1849 Te/Cur=0.2053 Te/Exp=0.1805]100%|██████████| 2/2 [00:05<00:00,  2.71s/it, CE=2.272789e+00 H=2.272750e+00 dV_dx=1.282667e-06 dV_dθ=-4.035134e-05 ||∇||=3.783731e-01 | Tr=0.1849 Te/Cur=0.2053 Te/Exp=0.1805]100%|██████████| 2/2 [00:05<00:00,  2.84s/it, CE=2.272789e+00 H=2.272750e+00 dV_dx=1.282667e-06 dV_dθ=-4.035134e-05 ||∇||=3.783731e-01 | Tr=0.1849 Te/Cur=0.2053 Te/Exp=0.1805]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.23s/it] 50%|█████     | 1/2 [00:05<00:03,  3.23s/it, CE=2.264890e+00 H=2.264824e+00 dV_dx=2.246183e-06 dV_dθ=-6.849953e-05 ||∇||=3.640303e-01 | Tr=0.1722 Te/Cur=0.2121 Te/Exp=0.2521]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.264890e+00 H=2.264824e+00 dV_dx=2.246183e-06 dV_dθ=-6.849953e-05 ||∇||=3.640303e-01 | Tr=0.1722 Te/Cur=0.2121 Te/Exp=0.2521]100%|██████████| 2/2 [00:05<00:00,  2.70s/it, CE=2.264890e+00 H=2.264824e+00 dV_dx=2.246183e-06 dV_dθ=-6.849953e-05 ||∇||=3.640303e-01 | Tr=0.1722 Te/Cur=0.2121 Te/Exp=0.2521]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 144, 10]) with loss 2.264890
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.53s/it] 50%|█████     | 1/2 [00:11<00:09,  9.53s/it, CE=2.280653e+00 H=2.280618e+00 dV_dx=4.772951e-06 dV_dθ=-3.967818e-05 ||∇||=3.719304e-01 | Tr=0.1098 Te/Cur=0.1570 Te/Exp=0.2468]100%|██████████| 2/2 [00:11<00:00,  5.09s/it, CE=2.280653e+00 H=2.280618e+00 dV_dx=4.772951e-06 dV_dθ=-3.967818e-05 ||∇||=3.719304e-01 | Tr=0.1098 Te/Cur=0.1570 Te/Exp=0.2468]100%|██████████| 2/2 [00:11<00:00,  5.75s/it, CE=2.280653e+00 H=2.280618e+00 dV_dx=4.772951e-06 dV_dθ=-3.967818e-05 ||∇||=3.719304e-01 | Tr=0.1098 Te/Cur=0.1570 Te/Exp=0.2468]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.21s/it] 50%|█████     | 1/2 [00:05<00:03,  3.21s/it, CE=2.275289e+00 H=2.275236e+00 dV_dx=2.109908e-06 dV_dθ=-5.510373e-05 ||∇||=3.403511e-01 | Tr=0.1566 Te/Cur=0.1803 Te/Exp=0.1900]100%|██████████| 2/2 [00:05<00:00,  2.45s/it, CE=2.275289e+00 H=2.275236e+00 dV_dx=2.109908e-06 dV_dθ=-5.510373e-05 ||∇||=3.403511e-01 | Tr=0.1566 Te/Cur=0.1803 Te/Exp=0.1900]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.275289e+00 H=2.275236e+00 dV_dx=2.109908e-06 dV_dθ=-5.510373e-05 ||∇||=3.403511e-01 | Tr=0.1566 Te/Cur=0.1803 Te/Exp=0.1900]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.32s/it] 50%|█████     | 1/2 [00:11<00:09,  9.32s/it, CE=2.275258e+00 H=2.275203e+00 dV_dx=-3.679782e-06 dV_dθ=-5.133742e-05 ||∇||=3.430370e-01 | Tr=0.1480 Te/Cur=0.1709 Te/Exp=0.2160]100%|██████████| 2/2 [00:11<00:00,  5.15s/it, CE=2.275258e+00 H=2.275203e+00 dV_dx=-3.679782e-06 dV_dθ=-5.133742e-05 ||∇||=3.430370e-01 | Tr=0.1480 Te/Cur=0.1709 Te/Exp=0.2160]100%|██████████| 2/2 [00:11<00:00,  5.78s/it, CE=2.275258e+00 H=2.275203e+00 dV_dx=-3.679782e-06 dV_dθ=-5.133742e-05 ||∇||=3.430370e-01 | Tr=0.1480 Te/Cur=0.1709 Te/Exp=0.2160]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.08s/it] 50%|█████     | 1/2 [00:07<00:06,  6.08s/it, CE=2.217935e+00 H=2.217900e+00 dV_dx=2.075350e-05 dV_dθ=-5.608291e-05 ||∇||=5.053999e-01 | Tr=0.1110 Te/Cur=0.1176 Te/Exp=0.2643]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.217935e+00 H=2.217900e+00 dV_dx=2.075350e-05 dV_dθ=-5.608291e-05 ||∇||=5.053999e-01 | Tr=0.1110 Te/Cur=0.1176 Te/Exp=0.2643]100%|██████████| 2/2 [00:07<00:00,  3.99s/it, CE=2.217935e+00 H=2.217900e+00 dV_dx=2.075350e-05 dV_dθ=-5.608291e-05 ||∇||=5.053999e-01 | Tr=0.1110 Te/Cur=0.1176 Te/Exp=0.2643]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 104, 10]) with loss 2.217935
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.08s/it] 50%|█████     | 1/2 [00:07<00:05,  5.08s/it, CE=2.213169e+00 H=2.213052e+00 dV_dx=-1.066013e-05 dV_dθ=-1.063622e-04 ||∇||=5.046950e-01 | Tr=0.1034 Te/Cur=0.1329 Te/Exp=0.3146]100%|██████████| 2/2 [00:07<00:00,  3.34s/it, CE=2.213169e+00 H=2.213052e+00 dV_dx=-1.066013e-05 dV_dθ=-1.063622e-04 ||∇||=5.046950e-01 | Tr=0.1034 Te/Cur=0.1329 Te/Exp=0.3146]100%|██████████| 2/2 [00:07<00:00,  3.60s/it, CE=2.213169e+00 H=2.213052e+00 dV_dx=-1.066013e-05 dV_dθ=-1.063622e-04 ||∇||=5.046950e-01 | Tr=0.1034 Te/Cur=0.1329 Te/Exp=0.3146]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 612, 104, 10]) with loss 2.213169
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.36s/it] 50%|█████     | 1/2 [00:11<00:09,  9.36s/it, CE=2.213514e+00 H=2.213461e+00 dV_dx=5.671792e-06 dV_dθ=-5.896475e-05 ||∇||=4.968126e-01 | Tr=0.1477 Te/Cur=0.1307 Te/Exp=0.3024]100%|██████████| 2/2 [00:11<00:00,  4.93s/it, CE=2.213514e+00 H=2.213461e+00 dV_dx=5.671792e-06 dV_dθ=-5.896475e-05 ||∇||=4.968126e-01 | Tr=0.1477 Te/Cur=0.1307 Te/Exp=0.3024]100%|██████████| 2/2 [00:11<00:00,  5.59s/it, CE=2.213514e+00 H=2.213461e+00 dV_dx=5.671792e-06 dV_dθ=-5.896475e-05 ||∇||=4.968126e-01 | Tr=0.1477 Te/Cur=0.1307 Te/Exp=0.3024]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.64s/it] 50%|█████     | 1/2 [00:07<00:05,  5.64s/it, CE=2.231686e+00 H=2.231592e+00 dV_dx=-7.618646e-07 dV_dθ=-9.273711e-05 ||∇||=4.607125e-01 | Tr=0.1236 Te/Cur=0.1396 Te/Exp=0.2530]100%|██████████| 2/2 [00:07<00:00,  3.30s/it, CE=2.231686e+00 H=2.231592e+00 dV_dx=-7.618646e-07 dV_dθ=-9.273711e-05 ||∇||=4.607125e-01 | Tr=0.1236 Te/Cur=0.1396 Te/Exp=0.2530]100%|██████████| 2/2 [00:07<00:00,  3.65s/it, CE=2.231686e+00 H=2.231592e+00 dV_dx=-7.618646e-07 dV_dθ=-9.273711e-05 ||∇||=4.607125e-01 | Tr=0.1236 Te/Cur=0.1396 Te/Exp=0.2530]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.42s/it] 50%|█████     | 1/2 [00:05<00:03,  3.42s/it, CE=2.216982e+00 H=2.216910e+00 dV_dx=2.171306e-06 dV_dθ=-7.416398e-05 ||∇||=4.711040e-01 | Tr=0.1000 Te/Cur=0.1143 Te/Exp=0.3363]100%|██████████| 2/2 [00:05<00:00,  2.41s/it, CE=2.216982e+00 H=2.216910e+00 dV_dx=2.171306e-06 dV_dθ=-7.416398e-05 ||∇||=4.711040e-01 | Tr=0.1000 Te/Cur=0.1143 Te/Exp=0.3363]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.216982e+00 H=2.216910e+00 dV_dx=2.171306e-06 dV_dθ=-7.416398e-05 ||∇||=4.711040e-01 | Tr=0.1000 Te/Cur=0.1143 Te/Exp=0.3363]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.94s/it] 50%|█████     | 1/2 [00:05<00:03,  3.94s/it, CE=2.192475e+00 H=2.192409e+00 dV_dx=-6.794317e-06 dV_dθ=-5.886537e-05 ||∇||=4.941416e-01 | Tr=0.1259 Te/Cur=0.1318 Te/Exp=0.3293]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.192475e+00 H=2.192409e+00 dV_dx=-6.794317e-06 dV_dθ=-5.886537e-05 ||∇||=4.941416e-01 | Tr=0.1259 Te/Cur=0.1318 Te/Exp=0.3293]100%|██████████| 2/2 [00:05<00:00,  2.86s/it, CE=2.192475e+00 H=2.192409e+00 dV_dx=-6.794317e-06 dV_dθ=-5.886537e-05 ||∇||=4.941416e-01 | Tr=0.1259 Te/Cur=0.1318 Te/Exp=0.3293]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 652, 144, 10]) with loss 2.192475
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.95s/it] 50%|█████     | 1/2 [00:10<00:08,  8.95s/it, CE=2.202953e+00 H=2.202877e+00 dV_dx=4.078853e-06 dV_dθ=-7.998281e-05 ||∇||=4.947471e-01 | Tr=0.1133 Te/Cur=0.1278 Te/Exp=0.3515]100%|██████████| 2/2 [00:10<00:00,  4.80s/it, CE=2.202953e+00 H=2.202877e+00 dV_dx=4.078853e-06 dV_dθ=-7.998281e-05 ||∇||=4.947471e-01 | Tr=0.1133 Te/Cur=0.1278 Te/Exp=0.3515]100%|██████████| 2/2 [00:10<00:00,  5.42s/it, CE=2.202953e+00 H=2.202877e+00 dV_dx=4.078853e-06 dV_dθ=-7.998281e-05 ||∇||=4.947471e-01 | Tr=0.1133 Te/Cur=0.1278 Te/Exp=0.3515]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.52s/it] 50%|█████     | 1/2 [00:05<00:03,  3.52s/it, CE=2.213857e+00 H=2.213795e+00 dV_dx=-9.693125e-06 dV_dθ=-5.258497e-05 ||∇||=4.730111e-01 | Tr=0.1435 Te/Cur=0.1793 Te/Exp=0.3294]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.213857e+00 H=2.213795e+00 dV_dx=-9.693125e-06 dV_dθ=-5.258497e-05 ||∇||=4.730111e-01 | Tr=0.1435 Te/Cur=0.1793 Te/Exp=0.3294]100%|██████████| 2/2 [00:05<00:00,  2.70s/it, CE=2.213857e+00 H=2.213795e+00 dV_dx=-9.693125e-06 dV_dθ=-5.258497e-05 ||∇||=4.730111e-01 | Tr=0.1435 Te/Cur=0.1793 Te/Exp=0.3294]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.50s/it] 50%|█████     | 1/2 [00:13<00:11, 11.50s/it, CE=2.217570e+00 H=2.217481e+00 dV_dx=1.202669e-05 dV_dθ=-1.010004e-04 ||∇||=5.102034e-01 | Tr=0.1273 Te/Cur=0.1742 Te/Exp=0.2725]100%|██████████| 2/2 [00:13<00:00,  5.74s/it, CE=2.217570e+00 H=2.217481e+00 dV_dx=1.202669e-05 dV_dθ=-1.010004e-04 ||∇||=5.102034e-01 | Tr=0.1273 Te/Cur=0.1742 Te/Exp=0.2725]100%|██████████| 2/2 [00:13<00:00,  6.60s/it, CE=2.217570e+00 H=2.217481e+00 dV_dx=1.202669e-05 dV_dθ=-1.010004e-04 ||∇||=5.102034e-01 | Tr=0.1273 Te/Cur=0.1742 Te/Exp=0.2725]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.86s/it] 50%|█████     | 1/2 [00:05<00:03,  3.86s/it, CE=2.257366e+00 H=2.257283e+00 dV_dx=1.768193e-05 dV_dθ=-1.000986e-04 ||∇||=4.004199e-01 | Tr=0.1051 Te/Cur=0.1040 Te/Exp=0.2305]100%|██████████| 2/2 [00:05<00:00,  2.75s/it, CE=2.257366e+00 H=2.257283e+00 dV_dx=1.768193e-05 dV_dθ=-1.000986e-04 ||∇||=4.004199e-01 | Tr=0.1051 Te/Cur=0.1040 Te/Exp=0.2305]100%|██████████| 2/2 [00:05<00:00,  2.92s/it, CE=2.257366e+00 H=2.257283e+00 dV_dx=1.768193e-05 dV_dθ=-1.000986e-04 ||∇||=4.004199e-01 | Tr=0.1051 Te/Cur=0.1040 Te/Exp=0.2305]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.30s/it] 50%|█████     | 1/2 [00:06<00:05,  5.30s/it, CE=2.253149e+00 H=2.252994e+00 dV_dx=-1.671364e-05 dV_dθ=-1.390057e-04 ||∇||=4.592579e-01 | Tr=0.1163 Te/Cur=0.1241 Te/Exp=0.2729]100%|██████████| 2/2 [00:06<00:00,  3.08s/it, CE=2.253149e+00 H=2.252994e+00 dV_dx=-1.671364e-05 dV_dθ=-1.390057e-04 ||∇||=4.592579e-01 | Tr=0.1163 Te/Cur=0.1241 Te/Exp=0.2729]100%|██████████| 2/2 [00:06<00:00,  3.42s/it, CE=2.253149e+00 H=2.252994e+00 dV_dx=-1.671364e-05 dV_dθ=-1.390057e-04 ||∇||=4.592579e-01 | Tr=0.1163 Te/Cur=0.1241 Te/Exp=0.2729]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.19s/it] 50%|█████     | 1/2 [00:12<00:10, 10.19s/it, CE=2.256773e+00 H=2.256669e+00 dV_dx=4.730401e-06 dV_dθ=-1.084742e-04 ||∇||=4.306875e-01 | Tr=0.1474 Te/Cur=0.1716 Te/Exp=0.2708]100%|██████████| 2/2 [00:12<00:00,  5.29s/it, CE=2.256773e+00 H=2.256669e+00 dV_dx=4.730401e-06 dV_dθ=-1.084742e-04 ||∇||=4.306875e-01 | Tr=0.1474 Te/Cur=0.1716 Te/Exp=0.2708]100%|██████████| 2/2 [00:12<00:00,  6.03s/it, CE=2.256773e+00 H=2.256669e+00 dV_dx=4.730401e-06 dV_dθ=-1.084742e-04 ||∇||=4.306875e-01 | Tr=0.1474 Te/Cur=0.1716 Te/Exp=0.2708]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.22s/it] 50%|█████     | 1/2 [00:06<00:05,  5.22s/it, CE=2.239329e+00 H=2.239209e+00 dV_dx=-1.853650e-05 dV_dθ=-1.010245e-04 ||∇||=4.521610e-01 | Tr=0.1132 Te/Cur=0.1102 Te/Exp=0.2316]100%|██████████| 2/2 [00:06<00:00,  3.05s/it, CE=2.239329e+00 H=2.239209e+00 dV_dx=-1.853650e-05 dV_dθ=-1.010245e-04 ||∇||=4.521610e-01 | Tr=0.1132 Te/Cur=0.1102 Te/Exp=0.2316]100%|██████████| 2/2 [00:06<00:00,  3.38s/it, CE=2.239329e+00 H=2.239209e+00 dV_dx=-1.853650e-05 dV_dθ=-1.010245e-04 ||∇||=4.521610e-01 | Tr=0.1132 Te/Cur=0.1102 Te/Exp=0.2316]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.51s/it] 50%|█████     | 1/2 [00:05<00:03,  3.51s/it, CE=2.253730e+00 H=2.253675e+00 dV_dx=7.493262e-07 dV_dθ=-5.604089e-05 ||∇||=4.155013e-01 | Tr=0.1314 Te/Cur=0.1236 Te/Exp=0.2294]100%|██████████| 2/2 [00:05<00:00,  2.70s/it, CE=2.253730e+00 H=2.253675e+00 dV_dx=7.493262e-07 dV_dθ=-5.604089e-05 ||∇||=4.155013e-01 | Tr=0.1314 Te/Cur=0.1236 Te/Exp=0.2294]100%|██████████| 2/2 [00:05<00:00,  2.82s/it, CE=2.253730e+00 H=2.253675e+00 dV_dx=7.493262e-07 dV_dθ=-5.604089e-05 ||∇||=4.155013e-01 | Tr=0.1314 Te/Cur=0.1236 Te/Exp=0.2294]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.50s/it] 50%|█████     | 1/2 [00:05<00:03,  3.50s/it, CE=2.236207e+00 H=2.236070e+00 dV_dx=-2.446685e-05 dV_dθ=-1.117934e-04 ||∇||=4.322793e-01 | Tr=0.1344 Te/Cur=0.1509 Te/Exp=0.2675]100%|██████████| 2/2 [00:05<00:00,  2.38s/it, CE=2.236207e+00 H=2.236070e+00 dV_dx=-2.446685e-05 dV_dθ=-1.117934e-04 ||∇||=4.322793e-01 | Tr=0.1344 Te/Cur=0.1509 Te/Exp=0.2675]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.236207e+00 H=2.236070e+00 dV_dx=-2.446685e-05 dV_dθ=-1.117934e-04 ||∇||=4.322793e-01 | Tr=0.1344 Te/Cur=0.1509 Te/Exp=0.2675]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.33s/it] 50%|█████     | 1/2 [00:13<00:11, 11.33s/it, CE=2.246729e+00 H=2.246627e+00 dV_dx=4.029382e-06 dV_dθ=-1.061431e-04 ||∇||=4.413910e-01 | Tr=0.1741 Te/Cur=0.2057 Te/Exp=0.3106]100%|██████████| 2/2 [00:13<00:00,  5.89s/it, CE=2.246729e+00 H=2.246627e+00 dV_dx=4.029382e-06 dV_dθ=-1.061431e-04 ||∇||=4.413910e-01 | Tr=0.1741 Te/Cur=0.2057 Te/Exp=0.3106]100%|██████████| 2/2 [00:13<00:00,  6.71s/it, CE=2.246729e+00 H=2.246627e+00 dV_dx=4.029382e-06 dV_dθ=-1.061431e-04 ||∇||=4.413910e-01 | Tr=0.1741 Te/Cur=0.2057 Te/Exp=0.3106]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.10s/it] 50%|█████     | 1/2 [00:05<00:03,  3.10s/it, CE=2.257615e+00 H=2.257522e+00 dV_dx=5.903471e-08 dV_dθ=-9.320193e-05 ||∇||=4.255206e-01 | Tr=0.1050 Te/Cur=0.1166 Te/Exp=0.2641]100%|██████████| 2/2 [00:05<00:00,  2.49s/it, CE=2.257615e+00 H=2.257522e+00 dV_dx=5.903471e-08 dV_dθ=-9.320193e-05 ||∇||=4.255206e-01 | Tr=0.1050 Te/Cur=0.1166 Te/Exp=0.2641]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.257615e+00 H=2.257522e+00 dV_dx=5.903471e-08 dV_dθ=-9.320193e-05 ||∇||=4.255206e-01 | Tr=0.1050 Te/Cur=0.1166 Te/Exp=0.2641]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.30s/it] 50%|█████     | 1/2 [00:11<00:09,  9.30s/it, CE=2.262996e+00 H=2.262879e+00 dV_dx=-4.974871e-06 dV_dθ=-1.123017e-04 ||∇||=4.553025e-01 | Tr=0.1465 Te/Cur=0.1952 Te/Exp=0.2748]100%|██████████| 2/2 [00:11<00:00,  4.90s/it, CE=2.262996e+00 H=2.262879e+00 dV_dx=-4.974871e-06 dV_dθ=-1.123017e-04 ||∇||=4.553025e-01 | Tr=0.1465 Te/Cur=0.1952 Te/Exp=0.2748]100%|██████████| 2/2 [00:11<00:00,  5.56s/it, CE=2.262996e+00 H=2.262879e+00 dV_dx=-4.974871e-06 dV_dθ=-1.123017e-04 ||∇||=4.553025e-01 | Tr=0.1465 Te/Cur=0.1952 Te/Exp=0.2748]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (3, [507, 652, 144, 10]) with loss 2.192475
  Total candidates evaluated: 54
  Original: (2, [507, 632, 144, 10])
  Optimal: (3, [507, 652, 144, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→3, feed [507, 632, 144, 10]→[507, 652, 144, 10]
  Conv filter changed: A_conv/B_conv shape = (3, 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:14<04:34, 14.44s/it]  5%|▌         | 1/20 [00:16<04:34, 14.44s/it, CE=2.032284e+00 H=1.962413e+00 dV_dx=-2.056704e-05 dV_dθ=-6.985090e-02 ||∇||=1.147879e+01 | Tr=0.7704] 10%|█         | 2/20 [00:16<02:13,  7.40s/it, CE=2.032284e+00 H=1.962413e+00 dV_dx=-2.056704e-05 dV_dθ=-6.985090e-02 ||∇||=1.147879e+01 | Tr=0.7704] 10%|█         | 2/20 [00:19<02:13,  7.40s/it, CE=1.684684e+00 H=1.523418e+00 dV_dx=3.368328e-05 dV_dθ=-1.613003e-01 ||∇||=1.238680e+01 | Tr=0.7704]  15%|█▌        | 3/20 [00:19<01:28,  5.21s/it, CE=1.684684e+00 H=1.523418e+00 dV_dx=3.368328e-05 dV_dθ=-1.613003e-01 ||∇||=1.238680e+01 | Tr=0.7704] 15%|█▌        | 3/20 [00:22<01:28,  5.21s/it, CE=1.477051e+00 H=1.200306e+00 dV_dx=3.049846e-05 dV_dθ=-2.767762e-01 ||∇||=1.533846e+01 | Tr=0.7704] 20%|██        | 4/20 [00:22<01:07,  4.20s/it, CE=1.477051e+00 H=1.200306e+00 dV_dx=3.049846e-05 dV_dθ=-2.767762e-01 ||∇||=1.533846e+01 | Tr=0.7704] 20%|██        | 4/20 [00:24<01:07,  4.20s/it, CE=1.334976e+00 H=6.895266e-01 dV_dx=1.918670e-05 dV_dθ=-6.454686e-01 ||∇||=2.183783e+01 | Tr=0.7704] 25%|██▌       | 5/20 [00:24<00:52,  3.51s/it, CE=1.334976e+00 H=6.895266e-01 dV_dx=1.918670e-05 dV_dθ=-6.454686e-01 ||∇||=2.183783e+01 | Tr=0.7704] 25%|██▌       | 5/20 [00:26<00:52,  3.51s/it, CE=1.232389e+00 H=3.941518e-01 dV_dx=-5.495324e-05 dV_dθ=-8.381823e-01 ||∇||=2.453920e+01 | Tr=0.7704] 30%|███       | 6/20 [00:26<00:44,  3.17s/it, CE=1.232389e+00 H=3.941518e-01 dV_dx=-5.495324e-05 dV_dθ=-8.381823e-01 ||∇||=2.453920e+01 | Tr=0.7704] 30%|███       | 6/20 [00:29<00:44,  3.17s/it, CE=1.149992e+00 H=5.138234e-01 dV_dx=5.581666e-05 dV_dθ=-6.362240e-01 ||∇||=2.209688e+01 | Tr=0.7704]  35%|███▌      | 7/20 [00:29<00:37,  2.89s/it, CE=1.149992e+00 H=5.138234e-01 dV_dx=5.581666e-05 dV_dθ=-6.362240e-01 ||∇||=2.209688e+01 | Tr=0.7704] 35%|███▌      | 7/20 [00:32<00:37,  2.89s/it, CE=1.084420e+00 H=5.694912e-01 dV_dx=-5.707023e-05 dV_dθ=-5.148715e-01 ||∇||=1.971129e+01 | Tr=0.7704] 40%|████      | 8/20 [00:32<00:34,  2.86s/it, CE=1.084420e+00 H=5.694912e-01 dV_dx=-5.707023e-05 dV_dθ=-5.148715e-01 ||∇||=1.971129e+01 | Tr=0.7704] 40%|████      | 8/20 [00:34<00:34,  2.86s/it, CE=1.031182e+00 H=5.289064e-01 dV_dx=7.536125e-06 dV_dθ=-5.022830e-01 ||∇||=1.934822e+01 | Tr=0.7704]  45%|████▌     | 9/20 [00:34<00:29,  2.72s/it, CE=1.031182e+00 H=5.289064e-01 dV_dx=7.536125e-06 dV_dθ=-5.022830e-01 ||∇||=1.934822e+01 | Tr=0.7704] 45%|████▌     | 9/20 [00:37<00:29,  2.72s/it, CE=9.860991e-01 H=4.746093e-01 dV_dx=1.290547e-06 dV_dθ=-5.114911e-01 ||∇||=1.964588e+01 | Tr=0.7704] 50%|█████     | 10/20 [00:37<00:26,  2.67s/it, CE=9.860991e-01 H=4.746093e-01 dV_dx=1.290547e-06 dV_dθ=-5.114911e-01 ||∇||=1.964588e+01 | Tr=0.7704] 50%|█████     | 10/20 [00:39<00:26,  2.67s/it, CE=9.476056e-01 H=4.525319e-01 dV_dx=-5.055386e-05 dV_dθ=-4.950231e-01 ||∇||=1.947305e+01 | Tr=0.7704] 55%|█████▌    | 11/20 [00:39<00:23,  2.61s/it, CE=9.476056e-01 H=4.525319e-01 dV_dx=-5.055386e-05 dV_dθ=-4.950231e-01 ||∇||=1.947305e+01 | Tr=0.7704] 55%|█████▌    | 11/20 [00:42<00:23,  2.61s/it, CE=9.128577e-01 H=4.679234e-01 dV_dx=6.630425e-06 dV_dθ=-4.449409e-01 ||∇||=1.877392e+01 | Tr=0.7704]  60%|██████    | 12/20 [00:42<00:20,  2.57s/it, CE=9.128577e-01 H=4.679234e-01 dV_dx=6.630425e-06 dV_dθ=-4.449409e-01 ||∇||=1.877392e+01 | Tr=0.7704] 60%|██████    | 12/20 [00:44<00:20,  2.57s/it, CE=8.819551e-01 H=4.910958e-01 dV_dx=-4.768545e-05 dV_dθ=-3.908117e-01 ||∇||=1.780277e+01 | Tr=0.7704] 65%|██████▌   | 13/20 [00:44<00:17,  2.53s/it, CE=8.819551e-01 H=4.910958e-01 dV_dx=-4.768545e-05 dV_dθ=-3.908117e-01 ||∇||=1.780277e+01 | Tr=0.7704] 65%|██████▌   | 13/20 [00:46<00:17,  2.53s/it, CE=8.537897e-01 H=4.977097e-01 dV_dx=-3.674178e-05 dV_dθ=-3.560433e-01 ||∇||=1.698873e+01 | Tr=0.7704] 70%|███████   | 14/20 [00:46<00:14,  2.46s/it, CE=8.537897e-01 H=4.977097e-01 dV_dx=-3.674178e-05 dV_dθ=-3.560433e-01 ||∇||=1.698873e+01 | Tr=0.7704] 70%|███████   | 14/20 [00:49<00:14,  2.46s/it, CE=8.280412e-01 H=4.924586e-01 dV_dx=1.844156e-05 dV_dθ=-3.356010e-01 ||∇||=1.650920e+01 | Tr=0.7704]  75%|███████▌  | 15/20 [00:49<00:12,  2.55s/it, CE=8.280412e-01 H=4.924586e-01 dV_dx=1.844156e-05 dV_dθ=-3.356010e-01 ||∇||=1.650920e+01 | Tr=0.7704] 75%|███████▌  | 15/20 [00:52<00:12,  2.55s/it, CE=8.041078e-01 H=4.809464e-01 dV_dx=-5.303761e-05 dV_dθ=-3.231085e-01 ||∇||=1.617800e+01 | Tr=0.7704] 80%|████████  | 16/20 [00:52<00:10,  2.55s/it, CE=8.041078e-01 H=4.809464e-01 dV_dx=-5.303761e-05 dV_dθ=-3.231085e-01 ||∇||=1.617800e+01 | Tr=0.7704] 80%|████████  | 16/20 [00:54<00:10,  2.55s/it, CE=7.819134e-01 H=4.842288e-01 dV_dx=5.967229e-06 dV_dθ=-2.976906e-01 ||∇||=1.571092e+01 | Tr=0.7704]  85%|████████▌ | 17/20 [00:54<00:07,  2.56s/it, CE=7.819134e-01 H=4.842288e-01 dV_dx=5.967229e-06 dV_dθ=-2.976906e-01 ||∇||=1.571092e+01 | Tr=0.7704] 85%|████████▌ | 17/20 [00:57<00:07,  2.56s/it, CE=7.620111e-01 H=5.007844e-01 dV_dx=3.176784e-05 dV_dθ=-2.612585e-01 ||∇||=1.501478e+01 | Tr=0.7704] 90%|█████████ | 18/20 [00:57<00:05,  2.65s/it, CE=7.620111e-01 H=5.007844e-01 dV_dx=3.176784e-05 dV_dθ=-2.612585e-01 ||∇||=1.501478e+01 | Tr=0.7704] 90%|█████████ | 18/20 [00:59<00:05,  2.65s/it, CE=7.427584e-01 H=5.005462e-01 dV_dx=4.795635e-06 dV_dθ=-2.422170e-01 ||∇||=1.466758e+01 | Tr=0.7704] 95%|█████████▌| 19/20 [00:59<00:02,  2.55s/it, CE=7.427584e-01 H=5.005462e-01 dV_dx=4.795635e-06 dV_dθ=-2.422170e-01 ||∇||=1.466758e+01 | Tr=0.7704] 95%|█████████▌| 19/20 [01:05<00:02,  2.55s/it, CE=7.249261e-01 H=5.004810e-01 dV_dx=-3.345965e-05 dV_dθ=-2.244116e-01 ||∇||=1.407013e+01 | Tr=0.7704 Te/Cur=0.9238 Te/Exp=0.7354]100%|██████████| 20/20 [01:09<00:00,  4.80s/it, CE=7.249261e-01 H=5.004810e-01 dV_dx=-3.345965e-05 dV_dθ=-2.244116e-01 ||∇||=1.407013e+01 | Tr=0.7704 Te/Cur=0.9238 Te/Exp=0.7354]100%|██████████| 20/20 [01:09<00:00,  3.49s/it, CE=7.249261e-01 H=5.004810e-01 dV_dx=-3.345965e-05 dV_dθ=-2.244116e-01 ||∇||=1.407013e+01 | Tr=0.7704 Te/Cur=0.9238 Te/Exp=0.7354]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.628807
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:07<02:22,  7.48s/it]  5%|▌         | 1/20 [00:09<02:22,  7.48s/it, CE=7.480538e-01 H=1.749643e-01 dV_dx=-3.452790e-05 dV_dθ=-5.730549e-01 ||∇||=2.181487e+01 | Tr=0.7701] 10%|█         | 2/20 [00:09<01:21,  4.52s/it, CE=7.480538e-01 H=1.749643e-01 dV_dx=-3.452790e-05 dV_dθ=-5.730549e-01 ||∇||=2.181487e+01 | Tr=0.7701] 10%|█         | 2/20 [00:12<01:21,  4.52s/it, CE=7.211404e-01 H=4.011891e-01 dV_dx=2.216529e-05 dV_dθ=-3.199735e-01 ||∇||=1.729667e+01 | Tr=0.7701]  15%|█▌        | 3/20 [00:12<01:00,  3.57s/it, CE=7.211404e-01 H=4.011891e-01 dV_dx=2.216529e-05 dV_dθ=-3.199735e-01 ||∇||=1.729667e+01 | Tr=0.7701] 15%|█▌        | 3/20 [00:14<01:00,  3.57s/it, CE=6.996152e-01 H=4.631575e-01 dV_dx=3.196518e-05 dV_dθ=-2.364897e-01 ||∇||=1.513602e+01 | Tr=0.7701] 20%|██        | 4/20 [00:14<00:50,  3.15s/it, CE=6.996152e-01 H=4.631575e-01 dV_dx=3.196518e-05 dV_dθ=-2.364897e-01 ||∇||=1.513602e+01 | Tr=0.7701] 20%|██        | 4/20 [00:17<00:50,  3.15s/it, CE=6.819321e-01 H=4.588654e-01 dV_dx=-2.156069e-05 dV_dθ=-2.230451e-01 ||∇||=1.468135e+01 | Tr=0.7701] 25%|██▌       | 5/20 [00:17<00:44,  2.97s/it, CE=6.819321e-01 H=4.588654e-01 dV_dx=-2.156069e-05 dV_dθ=-2.230451e-01 ||∇||=1.468135e+01 | Tr=0.7701] 25%|██▌       | 5/20 [00:19<00:44,  2.97s/it, CE=6.657390e-01 H=4.772318e-01 dV_dx=1.890838e-05 dV_dθ=-1.885261e-01 ||∇||=1.370902e+01 | Tr=0.7701]  30%|███       | 6/20 [00:19<00:39,  2.80s/it, CE=6.657390e-01 H=4.772318e-01 dV_dx=1.890838e-05 dV_dθ=-1.885261e-01 ||∇||=1.370902e+01 | Tr=0.7701] 30%|███       | 6/20 [00:22<00:39,  2.80s/it, CE=6.505964e-01 H=4.753640e-01 dV_dx=-6.279509e-05 dV_dθ=-1.751696e-01 ||∇||=1.327952e+01 | Tr=0.7701] 35%|███▌      | 7/20 [00:22<00:35,  2.74s/it, CE=6.505964e-01 H=4.753640e-01 dV_dx=-6.279509e-05 dV_dθ=-1.751696e-01 ||∇||=1.327952e+01 | Tr=0.7701] 35%|███▌      | 7/20 [00:24<00:35,  2.74s/it, CE=6.367245e-01 H=4.871026e-01 dV_dx=-2.235329e-05 dV_dθ=-1.495995e-01 ||∇||=1.255654e+01 | Tr=0.7701] 40%|████      | 8/20 [00:24<00:31,  2.60s/it, CE=6.367245e-01 H=4.871026e-01 dV_dx=-2.235329e-05 dV_dθ=-1.495995e-01 ||∇||=1.255654e+01 | Tr=0.7701] 40%|████      | 8/20 [00:27<00:31,  2.60s/it, CE=6.237470e-01 H=4.821721e-01 dV_dx=-3.742957e-05 dV_dθ=-1.415374e-01 ||∇||=1.226970e+01 | Tr=0.7701] 45%|████▌     | 9/20 [00:27<00:27,  2.46s/it, CE=6.237470e-01 H=4.821721e-01 dV_dx=-3.742957e-05 dV_dθ=-1.415374e-01 ||∇||=1.226970e+01 | Tr=0.7701] 45%|████▌     | 9/20 [00:29<00:27,  2.46s/it, CE=6.119997e-01 H=4.710546e-01 dV_dx=-8.649556e-05 dV_dθ=-1.408586e-01 ||∇||=1.227065e+01 | Tr=0.7701] 50%|█████     | 10/20 [00:29<00:23,  2.38s/it, CE=6.119997e-01 H=4.710546e-01 dV_dx=-8.649556e-05 dV_dθ=-1.408586e-01 ||∇||=1.227065e+01 | Tr=0.7701] 50%|█████     | 10/20 [00:31<00:23,  2.38s/it, CE=6.009466e-01 H=4.705314e-01 dV_dx=1.827555e-05 dV_dθ=-1.304335e-01 ||∇||=1.197803e+01 | Tr=0.7701]  55%|█████▌    | 11/20 [00:31<00:20,  2.32s/it, CE=6.009466e-01 H=4.705314e-01 dV_dx=1.827555e-05 dV_dθ=-1.304335e-01 ||∇||=1.197803e+01 | Tr=0.7701] 55%|█████▌    | 11/20 [00:33<00:20,  2.32s/it, CE=5.914453e-01 H=4.552114e-01 dV_dx=4.872720e-05 dV_dθ=-1.362826e-01 ||∇||=1.214908e+01 | Tr=0.7701] 60%|██████    | 12/20 [00:33<00:18,  2.29s/it, CE=5.914453e-01 H=4.552114e-01 dV_dx=4.872720e-05 dV_dθ=-1.362826e-01 ||∇||=1.214908e+01 | Tr=0.7701] 60%|██████    | 12/20 [00:35<00:18,  2.29s/it, CE=5.812821e-01 H=4.662651e-01 dV_dx=3.885481e-05 dV_dθ=-1.150559e-01 ||∇||=1.136919e+01 | Tr=0.7701] 65%|██████▌   | 13/20 [00:35<00:15,  2.28s/it, CE=5.812821e-01 H=4.662651e-01 dV_dx=3.885481e-05 dV_dθ=-1.150559e-01 ||∇||=1.136919e+01 | Tr=0.7701] 65%|██████▌   | 13/20 [00:38<00:15,  2.28s/it, CE=5.732010e-01 H=4.606175e-01 dV_dx=1.829377e-05 dV_dθ=-1.126019e-01 ||∇||=1.129601e+01 | Tr=0.7701] 70%|███████   | 14/20 [00:38<00:13,  2.30s/it, CE=5.732010e-01 H=4.606175e-01 dV_dx=1.829377e-05 dV_dθ=-1.126019e-01 ||∇||=1.129601e+01 | Tr=0.7701] 70%|███████   | 14/20 [00:40<00:13,  2.30s/it, CE=5.667848e-01 H=4.492550e-01 dV_dx=-3.699244e-05 dV_dθ=-1.174928e-01 ||∇||=1.155205e+01 | Tr=0.7701] 75%|███████▌  | 15/20 [00:40<00:11,  2.26s/it, CE=5.667848e-01 H=4.492550e-01 dV_dx=-3.699244e-05 dV_dθ=-1.174928e-01 ||∇||=1.155205e+01 | Tr=0.7701] 75%|███████▌  | 15/20 [00:43<00:11,  2.26s/it, CE=5.601869e-01 H=4.535114e-01 dV_dx=2.575337e-05 dV_dθ=-1.067013e-01 ||∇||=1.124830e+01 | Tr=0.7701]  80%|████████  | 16/20 [00:43<00:09,  2.38s/it, CE=5.601869e-01 H=4.535114e-01 dV_dx=2.575337e-05 dV_dθ=-1.067013e-01 ||∇||=1.124830e+01 | Tr=0.7701] 80%|████████  | 16/20 [00:46<00:09,  2.38s/it, CE=5.553829e-01 H=4.630113e-01 dV_dx=-6.374756e-05 dV_dθ=-9.230787e-02 ||∇||=1.094005e+01 | Tr=0.7701] 85%|████████▌ | 17/20 [00:46<00:07,  2.56s/it, CE=5.553829e-01 H=4.630113e-01 dV_dx=-6.374756e-05 dV_dθ=-9.230787e-02 ||∇||=1.094005e+01 | Tr=0.7701] 85%|████████▌ | 17/20 [00:48<00:07,  2.56s/it, CE=5.513784e-01 H=4.404309e-01 dV_dx=3.321161e-05 dV_dθ=-1.109807e-01 ||∇||=1.142650e+01 | Tr=0.7701]  90%|█████████ | 18/20 [00:48<00:04,  2.48s/it, CE=5.513784e-01 H=4.404309e-01 dV_dx=3.321161e-05 dV_dθ=-1.109807e-01 ||∇||=1.142650e+01 | Tr=0.7701] 90%|█████████ | 18/20 [00:50<00:04,  2.48s/it, CE=5.497143e-01 H=3.878099e-01 dV_dx=3.378930e-05 dV_dθ=-1.619382e-01 ||∇||=1.298639e+01 | Tr=0.7701] 95%|█████████▌| 19/20 [00:50<00:02,  2.48s/it, CE=5.497143e-01 H=3.878099e-01 dV_dx=3.378930e-05 dV_dθ=-1.619382e-01 ||∇||=1.298639e+01 | Tr=0.7701] 95%|█████████▌| 19/20 [00:54<00:02,  2.48s/it, CE=5.452319e-01 H=3.320792e-01 dV_dx=-1.158028e-05 dV_dθ=-2.131411e-01 ||∇||=1.418069e+01 | Tr=0.7701 Te/Cur=0.9490 Te/Exp=0.7864]100%|██████████| 20/20 [00:57<00:00,  3.75s/it, CE=5.452319e-01 H=3.320792e-01 dV_dx=-1.158028e-05 dV_dθ=-2.131411e-01 ||∇||=1.418069e+01 | Tr=0.7701 Te/Cur=0.9490 Te/Exp=0.7864]100%|██████████| 20/20 [00:57<00:00,  2.88s/it, CE=5.452319e-01 H=3.320792e-01 dV_dx=-1.158028e-05 dV_dθ=-2.131411e-01 ||∇||=1.418069e+01 | Tr=0.7701 Te/Cur=0.9490 Te/Exp=0.7864]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.56s/it] 50%|█████     | 1/2 [00:15<00:11, 11.56s/it, CE=5.781467e-01 H=5.762250e-01 dV_dx=1.615827e-04 dV_dθ=-2.083279e-03 ||∇||=1.925426e+00 | Tr=0.9714 Te/Cur=0.9581 Te/Exp=0.8015]100%|██████████| 2/2 [00:15<00:00,  7.10s/it, CE=5.781467e-01 H=5.762250e-01 dV_dx=1.615827e-04 dV_dθ=-2.083279e-03 ||∇||=1.925426e+00 | Tr=0.9714 Te/Cur=0.9581 Te/Exp=0.8015]100%|██████████| 2/2 [00:15<00:00,  7.77s/it, CE=5.781467e-01 H=5.762250e-01 dV_dx=1.615827e-04 dV_dθ=-2.083279e-03 ||∇||=1.925426e+00 | Tr=0.9714 Te/Cur=0.9581 Te/Exp=0.8015]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:49,  8.90s/it]  5%|▌         | 1/20 [00:10<02:49,  8.90s/it, CE=5.697713e-01 H=5.662354e-01 dV_dx=4.660539e-06 dV_dθ=-3.540558e-03 ||∇||=2.050824e+00 | Tr=0.9738] 10%|█         | 2/20 [00:10<01:24,  4.69s/it, CE=5.697713e-01 H=5.662354e-01 dV_dx=4.660539e-06 dV_dθ=-3.540558e-03 ||∇||=2.050824e+00 | Tr=0.9738] 10%|█         | 2/20 [00:12<01:24,  4.69s/it, CE=5.580441e-01 H=5.552053e-01 dV_dx=9.976098e-05 dV_dθ=-2.938542e-03 ||∇||=1.964336e+00 | Tr=0.9748] 15%|█▌        | 3/20 [00:12<00:58,  3.44s/it, CE=5.580441e-01 H=5.552053e-01 dV_dx=9.976098e-05 dV_dθ=-2.938542e-03 ||∇||=1.964336e+00 | Tr=0.9748] 15%|█▌        | 3/20 [00:14<00:58,  3.44s/it, CE=5.484367e-01 H=5.456996e-01 dV_dx=1.012426e-04 dV_dθ=-2.838327e-03 ||∇||=1.949131e+00 | Tr=0.9756] 20%|██        | 4/20 [00:14<00:46,  2.89s/it, CE=5.484367e-01 H=5.456996e-01 dV_dx=1.012426e-04 dV_dθ=-2.838327e-03 ||∇||=1.949131e+00 | Tr=0.9756] 20%|██        | 4/20 [00:16<00:46,  2.89s/it, CE=5.403931e-01 H=5.373914e-01 dV_dx=5.999516e-05 dV_dθ=-3.061664e-03 ||∇||=1.983706e+00 | Tr=0.9764] 25%|██▌       | 5/20 [00:16<00:40,  2.67s/it, CE=5.403931e-01 H=5.373914e-01 dV_dx=5.999516e-05 dV_dθ=-3.061664e-03 ||∇||=1.983706e+00 | Tr=0.9764] 25%|██▌       | 5/20 [00:20<00:40,  2.67s/it, CE=5.333040e-01 H=5.302797e-01 dV_dx=2.271768e-04 dV_dθ=-3.251541e-03 ||∇||=2.019496e+00 | Tr=0.9771 Te/Cur=0.9621 Te/Exp=0.8034] 30%|███       | 6/20 [00:20<00:43,  3.12s/it, CE=5.333040e-01 H=5.302797e-01 dV_dx=2.271768e-04 dV_dθ=-3.251541e-03 ||∇||=2.019496e+00 | Tr=0.9771 Te/Cur=0.9621 Te/Exp=0.8034] 30%|███       | 6/20 [00:22<00:43,  3.12s/it, CE=5.266342e-01 H=5.233608e-01 dV_dx=-2.451046e-05 dV_dθ=-3.248891e-03 ||∇||=2.013872e+00 | Tr=0.9776]                            35%|███▌      | 7/20 [00:22<00:34,  2.66s/it, CE=5.266342e-01 H=5.233608e-01 dV_dx=-2.451046e-05 dV_dθ=-3.248891e-03 ||∇||=2.013872e+00 | Tr=0.9776] 35%|███▌      | 7/20 [00:24<00:34,  2.66s/it, CE=5.200174e-01 H=5.166847e-01 dV_dx=-1.132920e-04 dV_dθ=-3.219472e-03 ||∇||=1.990162e+00 | Tr=0.9779] 40%|████      | 8/20 [00:24<00:30,  2.55s/it, CE=5.200174e-01 H=5.166847e-01 dV_dx=-1.132920e-04 dV_dθ=-3.219472e-03 ||∇||=1.990162e+00 | Tr=0.9779] 40%|████      | 8/20 [00:26<00:30,  2.55s/it, CE=5.131038e-01 H=5.103124e-01 dV_dx=1.780905e-07 dV_dθ=-2.791525e-03 ||∇||=1.895227e+00 | Tr=0.9787]  45%|████▌     | 9/20 [00:26<00:26,  2.39s/it, CE=5.131038e-01 H=5.103124e-01 dV_dx=1.780905e-07 dV_dθ=-2.791525e-03 ||∇||=1.895227e+00 | Tr=0.9787] 45%|████▌     | 9/20 [00:29<00:26,  2.39s/it, CE=5.063878e-01 H=5.040919e-01 dV_dx=-7.003974e-05 dV_dθ=-2.225861e-03 ||∇||=1.774252e+00 | Tr=0.9797] 50%|█████     | 10/20 [00:29<00:23,  2.32s/it, CE=5.063878e-01 H=5.040919e-01 dV_dx=-7.003974e-05 dV_dθ=-2.225861e-03 ||∇||=1.774252e+00 | Tr=0.9797] 50%|█████     | 10/20 [00:32<00:23,  2.32s/it, CE=5.004019e-01 H=4.985712e-01 dV_dx=3.717863e-05 dV_dθ=-1.867865e-03 ||∇||=1.696648e+00 | Tr=0.9805 Te/Cur=0.9635 Te/Exp=0.8091] 55%|█████▌    | 11/20 [00:32<00:24,  2.73s/it, CE=5.004019e-01 H=4.985712e-01 dV_dx=3.717863e-05 dV_dθ=-1.867865e-03 ||∇||=1.696648e+00 | Tr=0.9805 Te/Cur=0.9635 Te/Exp=0.8091] 55%|█████▌    | 11/20 [00:35<00:24,  2.73s/it, CE=4.947359e-01 H=4.930184e-01 dV_dx=-4.329667e-05 dV_dθ=-1.674144e-03 ||∇||=1.642035e+00 | Tr=0.9812]                            60%|██████    | 12/20 [00:35<00:21,  2.69s/it, CE=4.947359e-01 H=4.930184e-01 dV_dx=-4.329667e-05 dV_dθ=-1.674144e-03 ||∇||=1.642035e+00 | Tr=0.9812] 60%|██████    | 12/20 [00:37<00:21,  2.69s/it, CE=4.896909e-01 H=4.880214e-01 dV_dx=-2.332122e-05 dV_dθ=-1.646223e-03 ||∇||=1.626803e+00 | Tr=0.9820] 65%|██████▌   | 13/20 [00:37<00:17,  2.52s/it, CE=4.896909e-01 H=4.880214e-01 dV_dx=-2.332122e-05 dV_dθ=-1.646223e-03 ||∇||=1.626803e+00 | Tr=0.9820] 65%|██████▌   | 13/20 [00:39<00:17,  2.52s/it, CE=4.847986e-01 H=4.832558e-01 dV_dx=4.303465e-05 dV_dθ=-1.585858e-03 ||∇||=1.610484e+00 | Tr=0.9826]  70%|███████   | 14/20 [00:39<00:14,  2.47s/it, CE=4.847986e-01 H=4.832558e-01 dV_dx=4.303465e-05 dV_dθ=-1.585858e-03 ||∇||=1.610484e+00 | Tr=0.9826] 70%|███████   | 14/20 [00:42<00:14,  2.47s/it, CE=4.801371e-01 H=4.786570e-01 dV_dx=1.001821e-04 dV_dθ=-1.580296e-03 ||∇||=1.601429e+00 | Tr=0.9831] 75%|███████▌  | 15/20 [00:42<00:12,  2.43s/it, CE=4.801371e-01 H=4.786570e-01 dV_dx=1.001821e-04 dV_dθ=-1.580296e-03 ||∇||=1.601429e+00 | Tr=0.9831] 75%|███████▌  | 15/20 [00:45<00:12,  2.43s/it, CE=4.756917e-01 H=4.741301e-01 dV_dx=1.772726e-05 dV_dθ=-1.579296e-03 ||∇||=1.593220e+00 | Tr=0.9836 Te/Cur=0.9667 Te/Exp=0.8109] 80%|████████  | 16/20 [00:45<00:10,  2.64s/it, CE=4.756917e-01 H=4.741301e-01 dV_dx=1.772726e-05 dV_dθ=-1.579296e-03 ||∇||=1.593220e+00 | Tr=0.9836 Te/Cur=0.9667 Te/Exp=0.8109] 80%|████████  | 16/20 [00:47<00:10,  2.64s/it, CE=4.712850e-01 H=4.696476e-01 dV_dx=-1.356706e-04 dV_dθ=-1.501694e-03 ||∇||=1.579793e+00 | Tr=0.9841]                            85%|████████▌ | 17/20 [00:47<00:07,  2.55s/it, CE=4.712850e-01 H=4.696476e-01 dV_dx=-1.356706e-04 dV_dθ=-1.501694e-03 ||∇||=1.579793e+00 | Tr=0.9841] 85%|████████▌ | 17/20 [00:51<00:07,  2.55s/it, CE=4.670146e-01 H=4.656678e-01 dV_dx=4.718875e-05 dV_dθ=-1.394040e-03 ||∇||=1.550707e+00 | Tr=0.9845]  90%|█████████ | 18/20 [00:51<00:05,  2.78s/it, CE=4.670146e-01 H=4.656678e-01 dV_dx=4.718875e-05 dV_dθ=-1.394040e-03 ||∇||=1.550707e+00 | Tr=0.9845] 90%|█████████ | 18/20 [00:53<00:05,  2.78s/it, CE=4.628603e-01 H=4.616156e-01 dV_dx=7.097642e-05 dV_dθ=-1.315665e-03 ||∇||=1.531593e+00 | Tr=0.9849] 95%|█████████▌| 19/20 [00:53<00:02,  2.60s/it, CE=4.628603e-01 H=4.616156e-01 dV_dx=7.097642e-05 dV_dθ=-1.315665e-03 ||∇||=1.531593e+00 | Tr=0.9849] 95%|█████████▌| 19/20 [00:56<00:02,  2.60s/it, CE=4.589423e-01 H=4.576214e-01 dV_dx=-5.652332e-05 dV_dθ=-1.264358e-03 ||∇||=1.520239e+00 | Tr=0.9856 Te/Cur=0.9700 Te/Exp=0.8179]100%|██████████| 20/20 [00:56<00:00,  2.80s/it, CE=4.589423e-01 H=4.576214e-01 dV_dx=-5.652332e-05 dV_dθ=-1.264358e-03 ||∇||=1.520239e+00 | Tr=0.9856 Te/Cur=0.9700 Te/Exp=0.8179]100%|██████████| 20/20 [00:56<00:00,  2.82s/it, CE=4.589423e-01 H=4.576214e-01 dV_dx=-5.652332e-05 dV_dθ=-1.264358e-03 ||∇||=1.520239e+00 | Tr=0.9856 Te/Cur=0.9700 Te/Exp=0.8179]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 6 final loss: 0.467317
======================================================================


  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7493
    Task 1: 0.9265
    Task 2: 0.8245
    Task 3: 0.5694
    Task 4: 0.9250
    Task 5: 0.9076
    Task 6: 0.9690

============================================================
Task 7
============================================================
Initial loss on new task: 5.4750, previous: 0.4589, ratio: 11.93
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 7
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:09<?, ?it/s, CE=5.924408e-01 H=5.830665e-01 dV_dx=3.692802e-05 dV_dθ=-9.411235e-03 ||∇||=5.694782e+00 | Tr=0.6489 Te/Cur=0.8031 Te/Exp=0.8038]100%|██████████| 1/1 [00:09<00:00,  9.19s/it, CE=5.924408e-01 H=5.830665e-01 dV_dx=3.692802e-05 dV_dθ=-9.411235e-03 ||∇||=5.694782e+00 | Tr=0.6489 Te/Cur=0.8031 Te/Exp=0.8038]100%|██████████| 1/1 [00:09<00:00,  9.19s/it, CE=5.924408e-01 H=5.830665e-01 dV_dx=3.692802e-05 dV_dθ=-9.411235e-03 ||∇||=5.694782e+00 | Tr=0.6489 Te/Cur=0.8031 Te/Exp=0.8038]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.592441

[STEP 2] Architecture change decision
  Current: 0.592441, Previous: 0.458942
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9418 samples from 10 classes
  Created balanced validation set: 39930 samples from 10 classes
  Starting grid architecture search for task 7
  Baseline architecture: (3, [507, 652, 144, 10])
  Baseline loss: 0.592441
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.99s/it] 50%|█████     | 1/2 [00:08<00:06,  6.99s/it, CE=2.242403e+00 H=2.242325e+00 dV_dx=2.665799e-06 dV_dθ=-8.110775e-05 ||∇||=4.656929e-01 | Tr=0.1365 Te/Cur=0.1583 Te/Exp=0.2547]100%|██████████| 2/2 [00:08<00:00,  3.94s/it, CE=2.242403e+00 H=2.242325e+00 dV_dx=2.665799e-06 dV_dθ=-8.110775e-05 ||∇||=4.656929e-01 | Tr=0.1365 Te/Cur=0.1583 Te/Exp=0.2547]100%|██████████| 2/2 [00:08<00:00,  4.40s/it, CE=2.242403e+00 H=2.242325e+00 dV_dx=2.665799e-06 dV_dθ=-8.110775e-05 ||∇||=4.656929e-01 | Tr=0.1365 Te/Cur=0.1583 Te/Exp=0.2547]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.242403335084974
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.59s/it] 50%|█████     | 1/2 [00:07<00:05,  5.59s/it, CE=2.234188e+00 H=2.234156e+00 dV_dx=2.334362e-06 dV_dθ=-3.394158e-05 ||∇||=4.847378e-01 | Tr=0.1349 Te/Cur=0.1515 Te/Exp=0.2944]100%|██████████| 2/2 [00:07<00:00,  3.14s/it, CE=2.234188e+00 H=2.234156e+00 dV_dx=2.334362e-06 dV_dθ=-3.394158e-05 ||∇||=4.847378e-01 | Tr=0.1349 Te/Cur=0.1515 Te/Exp=0.2944]100%|██████████| 2/2 [00:07<00:00,  3.50s/it, CE=2.234188e+00 H=2.234156e+00 dV_dx=2.334362e-06 dV_dθ=-3.394158e-05 ||∇||=4.847378e-01 | Tr=0.1349 Te/Cur=0.1515 Te/Exp=0.2944]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 124, 10]) with loss 2.234188
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.81s/it] 50%|█████     | 1/2 [00:14<00:12, 12.81s/it, CE=2.243835e+00 H=2.243784e+00 dV_dx=3.563643e-06 dV_dθ=-5.508538e-05 ||∇||=4.903757e-01 | Tr=0.1096 Te/Cur=0.1125 Te/Exp=0.2896]100%|██████████| 2/2 [00:14<00:00,  6.22s/it, CE=2.243835e+00 H=2.243784e+00 dV_dx=3.563643e-06 dV_dθ=-5.508538e-05 ||∇||=4.903757e-01 | Tr=0.1096 Te/Cur=0.1125 Te/Exp=0.2896]100%|██████████| 2/2 [00:14<00:00,  7.21s/it, CE=2.243835e+00 H=2.243784e+00 dV_dx=3.563643e-06 dV_dθ=-5.508538e-05 ||∇||=4.903757e-01 | Tr=0.1096 Te/Cur=0.1125 Te/Exp=0.2896]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.70s/it] 50%|█████     | 1/2 [00:07<00:04,  4.70s/it, CE=2.230756e+00 H=2.230666e+00 dV_dx=9.719145e-07 dV_dθ=-9.085271e-05 ||∇||=5.087350e-01 | Tr=0.1785 Te/Cur=0.1852 Te/Exp=0.2493]100%|██████████| 2/2 [00:07<00:00,  3.41s/it, CE=2.230756e+00 H=2.230666e+00 dV_dx=9.719145e-07 dV_dθ=-9.085271e-05 ||∇||=5.087350e-01 | Tr=0.1785 Te/Cur=0.1852 Te/Exp=0.2493]100%|██████████| 2/2 [00:07<00:00,  3.60s/it, CE=2.230756e+00 H=2.230666e+00 dV_dx=9.719145e-07 dV_dθ=-9.085271e-05 ||∇||=5.087350e-01 | Tr=0.1785 Te/Cur=0.1852 Te/Exp=0.2493]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.230756
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.68s/it] 50%|█████     | 1/2 [00:07<00:05,  5.68s/it, CE=2.224137e+00 H=2.224112e+00 dV_dx=6.152545e-06 dV_dθ=-3.052168e-05 ||∇||=4.764746e-01 | Tr=0.1861 Te/Cur=0.1909 Te/Exp=0.2607]100%|██████████| 2/2 [00:07<00:00,  3.50s/it, CE=2.224137e+00 H=2.224112e+00 dV_dx=6.152545e-06 dV_dθ=-3.052168e-05 ||∇||=4.764746e-01 | Tr=0.1861 Te/Cur=0.1909 Te/Exp=0.2607]100%|██████████| 2/2 [00:07<00:00,  3.82s/it, CE=2.224137e+00 H=2.224112e+00 dV_dx=6.152545e-06 dV_dθ=-3.052168e-05 ||∇||=4.764746e-01 | Tr=0.1861 Te/Cur=0.1909 Te/Exp=0.2607]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 144, 10]) with loss 2.224137
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.59s/it] 50%|█████     | 1/2 [00:07<00:05,  5.59s/it, CE=2.236346e+00 H=2.236263e+00 dV_dx=-2.911788e-06 dV_dθ=-8.042025e-05 ||∇||=4.753816e-01 | Tr=0.1322 Te/Cur=0.1437 Te/Exp=0.2681]100%|██████████| 2/2 [00:07<00:00,  3.35s/it, CE=2.236346e+00 H=2.236263e+00 dV_dx=-2.911788e-06 dV_dθ=-8.042025e-05 ||∇||=4.753816e-01 | Tr=0.1322 Te/Cur=0.1437 Te/Exp=0.2681]100%|██████████| 2/2 [00:07<00:00,  3.69s/it, CE=2.236346e+00 H=2.236263e+00 dV_dx=-2.911788e-06 dV_dθ=-8.042025e-05 ||∇||=4.753816e-01 | Tr=0.1322 Te/Cur=0.1437 Te/Exp=0.2681]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.83s/it] 50%|█████     | 1/2 [00:07<00:05,  5.83s/it, CE=2.246393e+00 H=2.246310e+00 dV_dx=-5.066948e-06 dV_dθ=-7.777045e-05 ||∇||=4.743282e-01 | Tr=0.1427 Te/Cur=0.1680 Te/Exp=0.2513]100%|██████████| 2/2 [00:07<00:00,  3.37s/it, CE=2.246393e+00 H=2.246310e+00 dV_dx=-5.066948e-06 dV_dθ=-7.777045e-05 ||∇||=4.743282e-01 | Tr=0.1427 Te/Cur=0.1680 Te/Exp=0.2513]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.246393e+00 H=2.246310e+00 dV_dx=-5.066948e-06 dV_dθ=-7.777045e-05 ||∇||=4.743282e-01 | Tr=0.1427 Te/Cur=0.1680 Te/Exp=0.2513]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.69s/it] 50%|█████     | 1/2 [00:07<00:05,  5.69s/it, CE=2.211920e+00 H=2.211882e+00 dV_dx=-8.747969e-07 dV_dθ=-3.745130e-05 ||∇||=5.306364e-01 | Tr=0.2122 Te/Cur=0.2022 Te/Exp=0.2908]100%|██████████| 2/2 [00:07<00:00,  3.42s/it, CE=2.211920e+00 H=2.211882e+00 dV_dx=-8.747969e-07 dV_dθ=-3.745130e-05 ||∇||=5.306364e-01 | Tr=0.2122 Te/Cur=0.2022 Te/Exp=0.2908]100%|██████████| 2/2 [00:07<00:00,  3.76s/it, CE=2.211920e+00 H=2.211882e+00 dV_dx=-8.747969e-07 dV_dθ=-3.745130e-05 ||∇||=5.306364e-01 | Tr=0.2122 Te/Cur=0.2022 Te/Exp=0.2908]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 164, 10]) with loss 2.211920
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.41s/it] 50%|█████     | 1/2 [00:12<00:10, 10.41s/it, CE=2.234072e+00 H=2.234015e+00 dV_dx=-3.339329e-06 dV_dθ=-5.337025e-05 ||∇||=5.269142e-01 | Tr=0.1547 Te/Cur=0.1830 Te/Exp=0.2459]100%|██████████| 2/2 [00:12<00:00,  5.48s/it, CE=2.234072e+00 H=2.234015e+00 dV_dx=-3.339329e-06 dV_dθ=-5.337025e-05 ||∇||=5.269142e-01 | Tr=0.1547 Te/Cur=0.1830 Te/Exp=0.2459]100%|██████████| 2/2 [00:12<00:00,  6.22s/it, CE=2.234072e+00 H=2.234015e+00 dV_dx=-3.339329e-06 dV_dθ=-5.337025e-05 ||∇||=5.269142e-01 | Tr=0.1547 Te/Cur=0.1830 Te/Exp=0.2459]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.60s/it] 50%|█████     | 1/2 [00:10<00:08,  8.60s/it, CE=2.267578e+00 H=2.267537e+00 dV_dx=1.704760e-06 dV_dθ=-4.336885e-05 ||∇||=4.147497e-01 | Tr=0.0973 Te/Cur=0.0818 Te/Exp=0.1860]100%|██████████| 2/2 [00:10<00:00,  4.51s/it, CE=2.267578e+00 H=2.267537e+00 dV_dx=1.704760e-06 dV_dθ=-4.336885e-05 ||∇||=4.147497e-01 | Tr=0.0973 Te/Cur=0.0818 Te/Exp=0.1860]100%|██████████| 2/2 [00:10<00:00,  5.12s/it, CE=2.267578e+00 H=2.267537e+00 dV_dx=1.704760e-06 dV_dθ=-4.336885e-05 ||∇||=4.147497e-01 | Tr=0.0973 Te/Cur=0.0818 Te/Exp=0.1860]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.52s/it] 50%|█████     | 1/2 [00:07<00:05,  5.52s/it, CE=2.260064e+00 H=2.259994e+00 dV_dx=-7.393617e-06 dV_dθ=-6.197556e-05 ||∇||=4.677035e-01 | Tr=0.0953 Te/Cur=0.1187 Te/Exp=0.2453]100%|██████████| 2/2 [00:07<00:00,  3.35s/it, CE=2.260064e+00 H=2.259994e+00 dV_dx=-7.393617e-06 dV_dθ=-6.197556e-05 ||∇||=4.677035e-01 | Tr=0.0953 Te/Cur=0.1187 Te/Exp=0.2453]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.260064e+00 H=2.259994e+00 dV_dx=-7.393617e-06 dV_dθ=-6.197556e-05 ||∇||=4.677035e-01 | Tr=0.0953 Te/Cur=0.1187 Te/Exp=0.2453]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.78s/it] 50%|█████     | 1/2 [00:11<00:09,  9.78s/it, CE=2.264126e+00 H=2.264016e+00 dV_dx=-5.495238e-06 dV_dθ=-1.039149e-04 ||∇||=4.289556e-01 | Tr=0.1378 Te/Cur=0.1366 Te/Exp=0.2168]100%|██████████| 2/2 [00:11<00:00,  5.08s/it, CE=2.264126e+00 H=2.264016e+00 dV_dx=-5.495238e-06 dV_dθ=-1.039149e-04 ||∇||=4.289556e-01 | Tr=0.1378 Te/Cur=0.1366 Te/Exp=0.2168]100%|██████████| 2/2 [00:11<00:00,  5.78s/it, CE=2.264126e+00 H=2.264016e+00 dV_dx=-5.495238e-06 dV_dθ=-1.039149e-04 ||∇||=4.289556e-01 | Tr=0.1378 Te/Cur=0.1366 Te/Exp=0.2168]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.20s/it] 50%|█████     | 1/2 [00:07<00:05,  5.20s/it, CE=2.250894e+00 H=2.250846e+00 dV_dx=-1.080051e-05 dV_dθ=-3.682717e-05 ||∇||=4.593663e-01 | Tr=0.1323 Te/Cur=0.1521 Te/Exp=0.2413]100%|██████████| 2/2 [00:07<00:00,  3.25s/it, CE=2.250894e+00 H=2.250846e+00 dV_dx=-1.080051e-05 dV_dθ=-3.682717e-05 ||∇||=4.593663e-01 | Tr=0.1323 Te/Cur=0.1521 Te/Exp=0.2413]100%|██████████| 2/2 [00:07<00:00,  3.54s/it, CE=2.250894e+00 H=2.250846e+00 dV_dx=-1.080051e-05 dV_dθ=-3.682717e-05 ||∇||=4.593663e-01 | Tr=0.1323 Te/Cur=0.1521 Te/Exp=0.2413]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.22s/it] 50%|█████     | 1/2 [00:08<00:06,  6.22s/it, CE=2.247750e+00 H=2.247652e+00 dV_dx=-1.227978e-06 dV_dθ=-9.684909e-05 ||∇||=4.380204e-01 | Tr=0.1360 Te/Cur=0.1329 Te/Exp=0.2862]100%|██████████| 2/2 [00:08<00:00,  3.77s/it, CE=2.247750e+00 H=2.247652e+00 dV_dx=-1.227978e-06 dV_dθ=-9.684909e-05 ||∇||=4.380204e-01 | Tr=0.1360 Te/Cur=0.1329 Te/Exp=0.2862]100%|██████████| 2/2 [00:08<00:00,  4.14s/it, CE=2.247750e+00 H=2.247652e+00 dV_dx=-1.227978e-06 dV_dθ=-9.684909e-05 ||∇||=4.380204e-01 | Tr=0.1360 Te/Cur=0.1329 Te/Exp=0.2862]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.70s/it] 50%|█████     | 1/2 [00:07<00:05,  5.70s/it, CE=2.270868e+00 H=2.270817e+00 dV_dx=-6.608432e-06 dV_dθ=-4.474754e-05 ||∇||=4.207464e-01 | Tr=0.0499 Te/Cur=0.0803 Te/Exp=0.2166]100%|██████████| 2/2 [00:07<00:00,  3.40s/it, CE=2.270868e+00 H=2.270817e+00 dV_dx=-6.608432e-06 dV_dθ=-4.474754e-05 ||∇||=4.207464e-01 | Tr=0.0499 Te/Cur=0.0803 Te/Exp=0.2166]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.270868e+00 H=2.270817e+00 dV_dx=-6.608432e-06 dV_dθ=-4.474754e-05 ||∇||=4.207464e-01 | Tr=0.0499 Te/Cur=0.0803 Te/Exp=0.2166]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.75s/it] 50%|█████     | 1/2 [00:07<00:05,  5.75s/it, CE=2.272296e+00 H=2.272186e+00 dV_dx=-7.056173e-06 dV_dθ=-1.033333e-04 ||∇||=4.519301e-01 | Tr=0.1348 Te/Cur=0.1496 Te/Exp=0.2138]100%|██████████| 2/2 [00:07<00:00,  3.34s/it, CE=2.272296e+00 H=2.272186e+00 dV_dx=-7.056173e-06 dV_dθ=-1.033333e-04 ||∇||=4.519301e-01 | Tr=0.1348 Te/Cur=0.1496 Te/Exp=0.2138]100%|██████████| 2/2 [00:07<00:00,  3.70s/it, CE=2.272296e+00 H=2.272186e+00 dV_dx=-7.056173e-06 dV_dθ=-1.033333e-04 ||∇||=4.519301e-01 | Tr=0.1348 Te/Cur=0.1496 Te/Exp=0.2138]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.99s/it] 50%|█████     | 1/2 [00:07<00:05,  5.99s/it, CE=2.245300e+00 H=2.245227e+00 dV_dx=-1.060359e-05 dV_dθ=-6.237152e-05 ||∇||=4.555373e-01 | Tr=0.1206 Te/Cur=0.1155 Te/Exp=0.2898]100%|██████████| 2/2 [00:07<00:00,  3.44s/it, CE=2.245300e+00 H=2.245227e+00 dV_dx=-1.060359e-05 dV_dθ=-6.237152e-05 ||∇||=4.555373e-01 | Tr=0.1206 Te/Cur=0.1155 Te/Exp=0.2898]100%|██████████| 2/2 [00:07<00:00,  3.82s/it, CE=2.245300e+00 H=2.245227e+00 dV_dx=-1.060359e-05 dV_dθ=-6.237152e-05 ||∇||=4.555373e-01 | Tr=0.1206 Te/Cur=0.1155 Te/Exp=0.2898]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.54s/it] 50%|█████     | 1/2 [00:14<00:12, 12.54s/it, CE=2.250397e+00 H=2.250336e+00 dV_dx=-1.252792e-06 dV_dθ=-5.953523e-05 ||∇||=4.288046e-01 | Tr=0.1098 Te/Cur=0.1191 Te/Exp=0.2618]100%|██████████| 2/2 [00:14<00:00,  6.32s/it, CE=2.250397e+00 H=2.250336e+00 dV_dx=-1.252792e-06 dV_dθ=-5.953523e-05 ||∇||=4.288046e-01 | Tr=0.1098 Te/Cur=0.1191 Te/Exp=0.2618]100%|██████████| 2/2 [00:14<00:00,  7.25s/it, CE=2.250397e+00 H=2.250336e+00 dV_dx=-1.252792e-06 dV_dθ=-5.953523e-05 ||∇||=4.288046e-01 | Tr=0.1098 Te/Cur=0.1191 Te/Exp=0.2618]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.75s/it] 50%|█████     | 1/2 [00:07<00:05,  5.75s/it, CE=2.251679e+00 H=2.251593e+00 dV_dx=7.955787e-06 dV_dθ=-9.402232e-05 ||∇||=4.370089e-01 | Tr=0.1572 Te/Cur=0.1895 Te/Exp=0.2161]100%|██████████| 2/2 [00:07<00:00,  3.54s/it, CE=2.251679e+00 H=2.251593e+00 dV_dx=7.955787e-06 dV_dθ=-9.402232e-05 ||∇||=4.370089e-01 | Tr=0.1572 Te/Cur=0.1895 Te/Exp=0.2161]100%|██████████| 2/2 [00:07<00:00,  3.87s/it, CE=2.251679e+00 H=2.251593e+00 dV_dx=7.955787e-06 dV_dθ=-9.402232e-05 ||∇||=4.370089e-01 | Tr=0.1572 Te/Cur=0.1895 Te/Exp=0.2161]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.61s/it] 50%|█████     | 1/2 [00:07<00:05,  5.61s/it, CE=2.252159e+00 H=2.252060e+00 dV_dx=3.628244e-06 dV_dθ=-1.030177e-04 ||∇||=4.797231e-01 | Tr=0.1861 Te/Cur=0.1892 Te/Exp=0.2243]100%|██████████| 2/2 [00:07<00:00,  3.44s/it, CE=2.252159e+00 H=2.252060e+00 dV_dx=3.628244e-06 dV_dθ=-1.030177e-04 ||∇||=4.797231e-01 | Tr=0.1861 Te/Cur=0.1892 Te/Exp=0.2243]100%|██████████| 2/2 [00:07<00:00,  3.76s/it, CE=2.252159e+00 H=2.252060e+00 dV_dx=3.628244e-06 dV_dθ=-1.030177e-04 ||∇||=4.797231e-01 | Tr=0.1861 Te/Cur=0.1892 Te/Exp=0.2243]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.60s/it] 50%|█████     | 1/2 [00:12<00:10, 10.60s/it, CE=2.253074e+00 H=2.252997e+00 dV_dx=-1.306742e-05 dV_dθ=-6.387118e-05 ||∇||=4.577063e-01 | Tr=0.1410 Te/Cur=0.1448 Te/Exp=0.2076]100%|██████████| 2/2 [00:12<00:00,  5.42s/it, CE=2.253074e+00 H=2.252997e+00 dV_dx=-1.306742e-05 dV_dθ=-6.387118e-05 ||∇||=4.577063e-01 | Tr=0.1410 Te/Cur=0.1448 Te/Exp=0.2076]100%|██████████| 2/2 [00:12<00:00,  6.20s/it, CE=2.253074e+00 H=2.252997e+00 dV_dx=-1.306742e-05 dV_dθ=-6.387118e-05 ||∇||=4.577063e-01 | Tr=0.1410 Te/Cur=0.1448 Te/Exp=0.2076]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.04s/it] 50%|█████     | 1/2 [00:08<00:06,  6.04s/it, CE=2.225604e+00 H=2.225480e+00 dV_dx=-1.383501e-05 dV_dθ=-1.103621e-04 ||∇||=4.911381e-01 | Tr=0.1973 Te/Cur=0.2135 Te/Exp=0.2925]100%|██████████| 2/2 [00:08<00:00,  3.80s/it, CE=2.225604e+00 H=2.225480e+00 dV_dx=-1.383501e-05 dV_dθ=-1.103621e-04 ||∇||=4.911381e-01 | Tr=0.1973 Te/Cur=0.2135 Te/Exp=0.2925]100%|██████████| 2/2 [00:08<00:00,  4.13s/it, CE=2.225604e+00 H=2.225480e+00 dV_dx=-1.383501e-05 dV_dθ=-1.103621e-04 ||∇||=4.911381e-01 | Tr=0.1973 Te/Cur=0.2135 Te/Exp=0.2925]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.15s/it] 50%|█████     | 1/2 [00:07<00:06,  6.15s/it, CE=2.246099e+00 H=2.246020e+00 dV_dx=4.086861e-06 dV_dθ=-8.255087e-05 ||∇||=4.556430e-01 | Tr=0.1272 Te/Cur=0.1290 Te/Exp=0.2635]100%|██████████| 2/2 [00:07<00:00,  3.32s/it, CE=2.246099e+00 H=2.246020e+00 dV_dx=4.086861e-06 dV_dθ=-8.255087e-05 ||∇||=4.556430e-01 | Tr=0.1272 Te/Cur=0.1290 Te/Exp=0.2635]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.246099e+00 H=2.246020e+00 dV_dx=4.086861e-06 dV_dθ=-8.255087e-05 ||∇||=4.556430e-01 | Tr=0.1272 Te/Cur=0.1290 Te/Exp=0.2635]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.70s/it] 50%|█████     | 1/2 [00:07<00:05,  5.70s/it, CE=2.244195e+00 H=2.244144e+00 dV_dx=-7.803890e-07 dV_dθ=-5.051512e-05 ||∇||=4.691407e-01 | Tr=0.1190 Te/Cur=0.1376 Te/Exp=0.2398]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.244195e+00 H=2.244144e+00 dV_dx=-7.803890e-07 dV_dθ=-5.051512e-05 ||∇||=4.691407e-01 | Tr=0.1190 Te/Cur=0.1376 Te/Exp=0.2398]100%|██████████| 2/2 [00:07<00:00,  3.94s/it, CE=2.244195e+00 H=2.244144e+00 dV_dx=-7.803890e-07 dV_dθ=-5.051512e-05 ||∇||=4.691407e-01 | Tr=0.1190 Te/Cur=0.1376 Te/Exp=0.2398]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.72s/it] 50%|█████     | 1/2 [00:07<00:05,  5.72s/it, CE=2.248778e+00 H=2.248711e+00 dV_dx=1.483467e-05 dV_dθ=-8.236093e-05 ||∇||=4.631351e-01 | Tr=0.2239 Te/Cur=0.2351 Te/Exp=0.2357]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.248778e+00 H=2.248711e+00 dV_dx=1.483467e-05 dV_dθ=-8.236093e-05 ||∇||=4.631351e-01 | Tr=0.2239 Te/Cur=0.2351 Te/Exp=0.2357]100%|██████████| 2/2 [00:07<00:00,  3.88s/it, CE=2.248778e+00 H=2.248711e+00 dV_dx=1.483467e-05 dV_dθ=-8.236093e-05 ||∇||=4.631351e-01 | Tr=0.2239 Te/Cur=0.2351 Te/Exp=0.2357]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.61s/it] 50%|█████     | 1/2 [00:11<00:09,  9.61s/it, CE=2.253144e+00 H=2.253035e+00 dV_dx=5.037663e-06 dV_dθ=-1.141901e-04 ||∇||=4.735961e-01 | Tr=0.1659 Te/Cur=0.1686 Te/Exp=0.2367]100%|██████████| 2/2 [00:11<00:00,  5.08s/it, CE=2.253144e+00 H=2.253035e+00 dV_dx=5.037663e-06 dV_dθ=-1.141901e-04 ||∇||=4.735961e-01 | Tr=0.1659 Te/Cur=0.1686 Te/Exp=0.2367]100%|██████████| 2/2 [00:11<00:00,  5.76s/it, CE=2.253144e+00 H=2.253035e+00 dV_dx=5.037663e-06 dV_dθ=-1.141901e-04 ||∇||=4.735961e-01 | Tr=0.1659 Te/Cur=0.1686 Te/Exp=0.2367]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.47s/it] 50%|█████     | 1/2 [00:11<00:09,  9.47s/it, CE=2.238973e+00 H=2.238894e+00 dV_dx=-1.823777e-06 dV_dθ=-7.729517e-05 ||∇||=4.835175e-01 | Tr=0.1095 Te/Cur=0.1033 Te/Exp=0.2663]100%|██████████| 2/2 [00:11<00:00,  5.08s/it, CE=2.238973e+00 H=2.238894e+00 dV_dx=-1.823777e-06 dV_dθ=-7.729517e-05 ||∇||=4.835175e-01 | Tr=0.1095 Te/Cur=0.1033 Te/Exp=0.2663]100%|██████████| 2/2 [00:11<00:00,  5.74s/it, CE=2.238973e+00 H=2.238894e+00 dV_dx=-1.823777e-06 dV_dθ=-7.729517e-05 ||∇||=4.835175e-01 | Tr=0.1095 Te/Cur=0.1033 Te/Exp=0.2663]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.63s/it] 50%|█████     | 1/2 [00:07<00:05,  5.63s/it, CE=2.255871e+00 H=2.255766e+00 dV_dx=1.238548e-06 dV_dθ=-1.057013e-04 ||∇||=4.744194e-01 | Tr=0.1049 Te/Cur=0.1187 Te/Exp=0.2337]100%|██████████| 2/2 [00:07<00:00,  3.33s/it, CE=2.255871e+00 H=2.255766e+00 dV_dx=1.238548e-06 dV_dθ=-1.057013e-04 ||∇||=4.744194e-01 | Tr=0.1049 Te/Cur=0.1187 Te/Exp=0.2337]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.255871e+00 H=2.255766e+00 dV_dx=1.238548e-06 dV_dθ=-1.057013e-04 ||∇||=4.744194e-01 | Tr=0.1049 Te/Cur=0.1187 Te/Exp=0.2337]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.25587054207426
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.86s/it] 50%|█████     | 1/2 [00:05<00:03,  3.86s/it, CE=2.236298e+00 H=2.236229e+00 dV_dx=-8.507696e-07 dV_dθ=-6.817307e-05 ||∇||=4.731790e-01 | Tr=0.1386 Te/Cur=0.1541 Te/Exp=0.3314]100%|██████████| 2/2 [00:05<00:00,  2.47s/it, CE=2.236298e+00 H=2.236229e+00 dV_dx=-8.507696e-07 dV_dθ=-6.817307e-05 ||∇||=4.731790e-01 | Tr=0.1386 Te/Cur=0.1541 Te/Exp=0.3314]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.236298e+00 H=2.236229e+00 dV_dx=-8.507696e-07 dV_dθ=-6.817307e-05 ||∇||=4.731790e-01 | Tr=0.1386 Te/Cur=0.1541 Te/Exp=0.3314]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 124, 10]) with loss 2.236298
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.30s/it] 50%|█████     | 1/2 [00:12<00:10, 10.30s/it, CE=2.245207e+00 H=2.245122e+00 dV_dx=-2.523469e-06 dV_dθ=-8.241244e-05 ||∇||=4.489519e-01 | Tr=0.1317 Te/Cur=0.1720 Te/Exp=0.3162]100%|██████████| 2/2 [00:12<00:00,  5.33s/it, CE=2.245207e+00 H=2.245122e+00 dV_dx=-2.523469e-06 dV_dθ=-8.241244e-05 ||∇||=4.489519e-01 | Tr=0.1317 Te/Cur=0.1720 Te/Exp=0.3162]100%|██████████| 2/2 [00:12<00:00,  6.08s/it, CE=2.245207e+00 H=2.245122e+00 dV_dx=-2.523469e-06 dV_dθ=-8.241244e-05 ||∇||=4.489519e-01 | Tr=0.1317 Te/Cur=0.1720 Te/Exp=0.3162]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.38s/it] 50%|█████     | 1/2 [00:07<00:05,  5.38s/it, CE=2.243924e+00 H=2.243745e+00 dV_dx=3.540911e-06 dV_dθ=-1.825141e-04 ||∇||=5.202534e-01 | Tr=0.1098 Te/Cur=0.1174 Te/Exp=0.2786]100%|██████████| 2/2 [00:07<00:00,  3.47s/it, CE=2.243924e+00 H=2.243745e+00 dV_dx=3.540911e-06 dV_dθ=-1.825141e-04 ||∇||=5.202534e-01 | Tr=0.1098 Te/Cur=0.1174 Te/Exp=0.2786]100%|██████████| 2/2 [00:07<00:00,  3.75s/it, CE=2.243924e+00 H=2.243745e+00 dV_dx=3.540911e-06 dV_dθ=-1.825141e-04 ||∇||=5.202534e-01 | Tr=0.1098 Te/Cur=0.1174 Te/Exp=0.2786]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.25s/it] 50%|█████     | 1/2 [00:04<00:03,  3.25s/it, CE=2.225023e+00 H=2.224957e+00 dV_dx=2.693382e-06 dV_dθ=-6.874696e-05 ||∇||=5.391227e-01 | Tr=0.1430 Te/Cur=0.1359 Te/Exp=0.3215]100%|██████████| 2/2 [00:04<00:00,  2.32s/it, CE=2.225023e+00 H=2.224957e+00 dV_dx=2.693382e-06 dV_dθ=-6.874696e-05 ||∇||=5.391227e-01 | Tr=0.1430 Te/Cur=0.1359 Te/Exp=0.3215]100%|██████████| 2/2 [00:04<00:00,  2.46s/it, CE=2.225023e+00 H=2.224957e+00 dV_dx=2.693382e-06 dV_dθ=-6.874696e-05 ||∇||=5.391227e-01 | Tr=0.1430 Te/Cur=0.1359 Te/Exp=0.3215]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 164, 10]) with loss 2.225023
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.50s/it] 50%|█████     | 1/2 [00:14<00:09,  9.50s/it, CE=2.232415e+00 H=2.232346e+00 dV_dx=-7.406521e-06 dV_dθ=-6.146296e-05 ||∇||=5.022584e-01 | Tr=0.1240 Te/Cur=0.1128 Te/Exp=0.3001]100%|██████████| 2/2 [00:14<00:00,  6.94s/it, CE=2.232415e+00 H=2.232346e+00 dV_dx=-7.406521e-06 dV_dθ=-6.146296e-05 ||∇||=5.022584e-01 | Tr=0.1240 Te/Cur=0.1128 Te/Exp=0.3001]100%|██████████| 2/2 [00:14<00:00,  7.32s/it, CE=2.232415e+00 H=2.232346e+00 dV_dx=-7.406521e-06 dV_dθ=-6.146296e-05 ||∇||=5.022584e-01 | Tr=0.1240 Te/Cur=0.1128 Te/Exp=0.3001]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.37s/it] 50%|█████     | 1/2 [00:12<00:10, 10.37s/it, CE=2.257271e+00 H=2.257080e+00 dV_dx=2.704324e-07 dV_dθ=-1.910856e-04 ||∇||=5.351091e-01 | Tr=0.1866 Te/Cur=0.1903 Te/Exp=0.2487]100%|██████████| 2/2 [00:12<00:00,  5.67s/it, CE=2.257271e+00 H=2.257080e+00 dV_dx=2.704324e-07 dV_dθ=-1.910856e-04 ||∇||=5.351091e-01 | Tr=0.1866 Te/Cur=0.1903 Te/Exp=0.2487]100%|██████████| 2/2 [00:12<00:00,  6.37s/it, CE=2.257271e+00 H=2.257080e+00 dV_dx=2.704324e-07 dV_dθ=-1.910856e-04 ||∇||=5.351091e-01 | Tr=0.1866 Te/Cur=0.1903 Te/Exp=0.2487]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.12s/it] 50%|█████     | 1/2 [00:10<00:09,  9.12s/it, CE=2.237698e+00 H=2.237521e+00 dV_dx=-8.712916e-07 dV_dθ=-1.760389e-04 ||∇||=5.139982e-01 | Tr=0.1310 Te/Cur=0.1508 Te/Exp=0.2964]100%|██████████| 2/2 [00:10<00:00,  4.84s/it, CE=2.237698e+00 H=2.237521e+00 dV_dx=-8.712916e-07 dV_dθ=-1.760389e-04 ||∇||=5.139982e-01 | Tr=0.1310 Te/Cur=0.1508 Te/Exp=0.2964]100%|██████████| 2/2 [00:10<00:00,  5.48s/it, CE=2.237698e+00 H=2.237521e+00 dV_dx=-8.712916e-07 dV_dθ=-1.760389e-04 ||∇||=5.139982e-01 | Tr=0.1310 Te/Cur=0.1508 Te/Exp=0.2964]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.86s/it] 50%|█████     | 1/2 [00:11<00:09,  9.86s/it, CE=2.238868e+00 H=2.238745e+00 dV_dx=5.629956e-06 dV_dθ=-1.282329e-04 ||∇||=5.196972e-01 | Tr=0.1508 Te/Cur=0.1633 Te/Exp=0.3348]100%|██████████| 2/2 [00:11<00:00,  5.13s/it, CE=2.238868e+00 H=2.238745e+00 dV_dx=5.629956e-06 dV_dθ=-1.282329e-04 ||∇||=5.196972e-01 | Tr=0.1508 Te/Cur=0.1633 Te/Exp=0.3348]100%|██████████| 2/2 [00:11<00:00,  5.84s/it, CE=2.238868e+00 H=2.238745e+00 dV_dx=5.629956e-06 dV_dθ=-1.282329e-04 ||∇||=5.196972e-01 | Tr=0.1508 Te/Cur=0.1633 Te/Exp=0.3348]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.86s/it] 50%|█████     | 1/2 [00:07<00:05,  5.86s/it, CE=2.268915e+00 H=2.268863e+00 dV_dx=-2.265885e-06 dV_dθ=-5.003864e-05 ||∇||=3.481487e-01 | Tr=0.0766 Te/Cur=0.0706 Te/Exp=0.2003]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.268915e+00 H=2.268863e+00 dV_dx=-2.265885e-06 dV_dθ=-5.003864e-05 ||∇||=3.481487e-01 | Tr=0.0766 Te/Cur=0.0706 Te/Exp=0.2003]100%|██████████| 2/2 [00:07<00:00,  3.90s/it, CE=2.268915e+00 H=2.268863e+00 dV_dx=-2.265885e-06 dV_dθ=-5.003864e-05 ||∇||=3.481487e-01 | Tr=0.0766 Te/Cur=0.0706 Te/Exp=0.2003]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.51s/it] 50%|█████     | 1/2 [00:05<00:03,  3.51s/it, CE=2.268085e+00 H=2.268035e+00 dV_dx=-8.853008e-06 dV_dθ=-4.142532e-05 ||∇||=3.729659e-01 | Tr=0.0809 Te/Cur=0.0984 Te/Exp=0.2299]100%|██████████| 2/2 [00:05<00:00,  2.76s/it, CE=2.268085e+00 H=2.268035e+00 dV_dx=-8.853008e-06 dV_dθ=-4.142532e-05 ||∇||=3.729659e-01 | Tr=0.0809 Te/Cur=0.0984 Te/Exp=0.2299]100%|██████████| 2/2 [00:05<00:00,  2.87s/it, CE=2.268085e+00 H=2.268035e+00 dV_dx=-8.853008e-06 dV_dθ=-4.142532e-05 ||∇||=3.729659e-01 | Tr=0.0809 Te/Cur=0.0984 Te/Exp=0.2299]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.22s/it] 50%|█████     | 1/2 [00:12<00:10, 10.22s/it, CE=2.270626e+00 H=2.270579e+00 dV_dx=-1.502719e-05 dV_dθ=-3.161475e-05 ||∇||=3.114284e-01 | Tr=0.1201 Te/Cur=0.1228 Te/Exp=0.1722]100%|██████████| 2/2 [00:12<00:00,  5.31s/it, CE=2.270626e+00 H=2.270579e+00 dV_dx=-1.502719e-05 dV_dθ=-3.161475e-05 ||∇||=3.114284e-01 | Tr=0.1201 Te/Cur=0.1228 Te/Exp=0.1722]100%|██████████| 2/2 [00:12<00:00,  6.05s/it, CE=2.270626e+00 H=2.270579e+00 dV_dx=-1.502719e-05 dV_dθ=-3.161475e-05 ||∇||=3.114284e-01 | Tr=0.1201 Te/Cur=0.1228 Te/Exp=0.1722]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.88s/it] 50%|█████     | 1/2 [00:07<00:05,  5.88s/it, CE=2.259120e+00 H=2.259125e+00 dV_dx=1.205362e-05 dV_dθ=-7.468976e-06 ||∇||=3.432990e-01 | Tr=0.1132 Te/Cur=0.1222 Te/Exp=0.2593]100%|██████████| 2/2 [00:07<00:00,  3.41s/it, CE=2.259120e+00 H=2.259125e+00 dV_dx=1.205362e-05 dV_dθ=-7.468976e-06 ||∇||=3.432990e-01 | Tr=0.1132 Te/Cur=0.1222 Te/Exp=0.2593]100%|██████████| 2/2 [00:07<00:00,  3.78s/it, CE=2.259120e+00 H=2.259125e+00 dV_dx=1.205362e-05 dV_dθ=-7.468976e-06 ||∇||=3.432990e-01 | Tr=0.1132 Te/Cur=0.1222 Te/Exp=0.2593]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.62s/it] 50%|█████     | 1/2 [00:09<00:03,  3.62s/it, CE=2.260333e+00 H=2.260328e+00 dV_dx=1.523933e-05 dV_dθ=-2.015743e-05 ||∇||=3.791428e-01 | Tr=0.0720 Te/Cur=0.0890 Te/Exp=0.2262]100%|██████████| 2/2 [00:09<00:00,  4.70s/it, CE=2.260333e+00 H=2.260328e+00 dV_dx=1.523933e-05 dV_dθ=-2.015743e-05 ||∇||=3.791428e-01 | Tr=0.0720 Te/Cur=0.0890 Te/Exp=0.2262]100%|██████████| 2/2 [00:09<00:00,  4.54s/it, CE=2.260333e+00 H=2.260328e+00 dV_dx=1.523933e-05 dV_dθ=-2.015743e-05 ||∇||=3.791428e-01 | Tr=0.0720 Te/Cur=0.0890 Te/Exp=0.2262]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.57s/it] 50%|█████     | 1/2 [00:11<00:09,  9.57s/it, CE=2.269285e+00 H=2.269272e+00 dV_dx=-8.782779e-06 dV_dθ=-4.430919e-06 ||∇||=3.587188e-01 | Tr=0.0696 Te/Cur=0.0777 Te/Exp=0.2395]100%|██████████| 2/2 [00:11<00:00,  4.92s/it, CE=2.269285e+00 H=2.269272e+00 dV_dx=-8.782779e-06 dV_dθ=-4.430919e-06 ||∇||=3.587188e-01 | Tr=0.0696 Te/Cur=0.0777 Te/Exp=0.2395]100%|██████████| 2/2 [00:11<00:00,  5.61s/it, CE=2.269285e+00 H=2.269272e+00 dV_dx=-8.782779e-06 dV_dθ=-4.430919e-06 ||∇||=3.587188e-01 | Tr=0.0696 Te/Cur=0.0777 Te/Exp=0.2395]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.52s/it] 50%|█████     | 1/2 [00:11<00:09,  9.52s/it, CE=2.264421e+00 H=2.264368e+00 dV_dx=3.650974e-07 dV_dθ=-5.301494e-05 ||∇||=3.699431e-01 | Tr=0.0928 Te/Cur=0.0993 Te/Exp=0.2359]100%|██████████| 2/2 [00:11<00:00,  5.13s/it, CE=2.264421e+00 H=2.264368e+00 dV_dx=3.650974e-07 dV_dθ=-5.301494e-05 ||∇||=3.699431e-01 | Tr=0.0928 Te/Cur=0.0993 Te/Exp=0.2359]100%|██████████| 2/2 [00:11<00:00,  5.79s/it, CE=2.264421e+00 H=2.264368e+00 dV_dx=3.650974e-07 dV_dθ=-5.301494e-05 ||∇||=3.699431e-01 | Tr=0.0928 Te/Cur=0.0993 Te/Exp=0.2359]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.82s/it] 50%|█████     | 1/2 [00:11<00:09,  9.82s/it, CE=2.258880e+00 H=2.258838e+00 dV_dx=-1.223579e-05 dV_dθ=-3.056153e-05 ||∇||=3.874583e-01 | Tr=0.0840 Te/Cur=0.0766 Te/Exp=0.2574]100%|██████████| 2/2 [00:11<00:00,  5.05s/it, CE=2.258880e+00 H=2.258838e+00 dV_dx=-1.223579e-05 dV_dθ=-3.056153e-05 ||∇||=3.874583e-01 | Tr=0.0840 Te/Cur=0.0766 Te/Exp=0.2574]100%|██████████| 2/2 [00:11<00:00,  5.76s/it, CE=2.258880e+00 H=2.258838e+00 dV_dx=-1.223579e-05 dV_dθ=-3.056153e-05 ||∇||=3.874583e-01 | Tr=0.0840 Te/Cur=0.0766 Te/Exp=0.2574]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.29s/it] 50%|█████     | 1/2 [00:10<00:09,  9.29s/it, CE=2.261378e+00 H=2.261354e+00 dV_dx=1.931599e-06 dV_dθ=-2.625957e-05 ||∇||=3.699293e-01 | Tr=0.1081 Te/Cur=0.1228 Te/Exp=0.2711]100%|██████████| 2/2 [00:10<00:00,  4.80s/it, CE=2.261378e+00 H=2.261354e+00 dV_dx=1.931599e-06 dV_dθ=-2.625957e-05 ||∇||=3.699293e-01 | Tr=0.1081 Te/Cur=0.1228 Te/Exp=0.2711]100%|██████████| 2/2 [00:10<00:00,  5.47s/it, CE=2.261378e+00 H=2.261354e+00 dV_dx=1.931599e-06 dV_dθ=-2.625957e-05 ||∇||=3.699293e-01 | Tr=0.1081 Te/Cur=0.1228 Te/Exp=0.2711]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.17s/it] 50%|█████     | 1/2 [00:08<00:06,  6.17s/it, CE=2.272646e+00 H=2.272552e+00 dV_dx=-1.377879e-05 dV_dθ=-8.054428e-05 ||∇||=3.597835e-01 | Tr=0.1370 Te/Cur=0.1571 Te/Exp=0.2325]100%|██████████| 2/2 [00:08<00:00,  3.81s/it, CE=2.272646e+00 H=2.272552e+00 dV_dx=-1.377879e-05 dV_dθ=-8.054428e-05 ||∇||=3.597835e-01 | Tr=0.1370 Te/Cur=0.1571 Te/Exp=0.2325]100%|██████████| 2/2 [00:08<00:00,  4.17s/it, CE=2.272646e+00 H=2.272552e+00 dV_dx=-1.377879e-05 dV_dθ=-8.054428e-05 ||∇||=3.597835e-01 | Tr=0.1370 Te/Cur=0.1571 Te/Exp=0.2325]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.16s/it] 50%|█████     | 1/2 [00:05<00:03,  3.16s/it, CE=2.275553e+00 H=2.275488e+00 dV_dx=2.325080e-06 dV_dθ=-6.742821e-05 ||∇||=3.447214e-01 | Tr=0.1509 Te/Cur=0.1585 Te/Exp=0.1879]100%|██████████| 2/2 [00:05<00:00,  2.45s/it, CE=2.275553e+00 H=2.275488e+00 dV_dx=2.325080e-06 dV_dθ=-6.742821e-05 ||∇||=3.447214e-01 | Tr=0.1509 Te/Cur=0.1585 Te/Exp=0.1879]100%|██████████| 2/2 [00:05<00:00,  2.55s/it, CE=2.275553e+00 H=2.275488e+00 dV_dx=2.325080e-06 dV_dθ=-6.742821e-05 ||∇||=3.447214e-01 | Tr=0.1509 Te/Cur=0.1585 Te/Exp=0.1879]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.58s/it] 50%|█████     | 1/2 [00:10<00:08,  8.58s/it, CE=2.266962e+00 H=2.266889e+00 dV_dx=7.785234e-06 dV_dθ=-8.108161e-05 ||∇||=3.542941e-01 | Tr=0.1055 Te/Cur=0.1174 Te/Exp=0.1965]100%|██████████| 2/2 [00:10<00:00,  4.76s/it, CE=2.266962e+00 H=2.266889e+00 dV_dx=7.785234e-06 dV_dθ=-8.108161e-05 ||∇||=3.542941e-01 | Tr=0.1055 Te/Cur=0.1174 Te/Exp=0.1965]100%|██████████| 2/2 [00:10<00:00,  5.34s/it, CE=2.266962e+00 H=2.266889e+00 dV_dx=7.785234e-06 dV_dθ=-8.108161e-05 ||∇||=3.542941e-01 | Tr=0.1055 Te/Cur=0.1174 Te/Exp=0.1965]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.00s/it] 50%|█████     | 1/2 [00:07<00:06,  6.00s/it, CE=2.263463e+00 H=2.263364e+00 dV_dx=-4.947456e-06 dV_dθ=-9.418485e-05 ||∇||=3.579555e-01 | Tr=0.0976 Te/Cur=0.1209 Te/Exp=0.2388]100%|██████████| 2/2 [00:07<00:00,  3.29s/it, CE=2.263463e+00 H=2.263364e+00 dV_dx=-4.947456e-06 dV_dθ=-9.418485e-05 ||∇||=3.579555e-01 | Tr=0.0976 Te/Cur=0.1209 Te/Exp=0.2388]100%|██████████| 2/2 [00:07<00:00,  3.69s/it, CE=2.263463e+00 H=2.263364e+00 dV_dx=-4.947456e-06 dV_dθ=-9.418485e-05 ||∇||=3.579555e-01 | Tr=0.0976 Te/Cur=0.1209 Te/Exp=0.2388]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.09s/it] 50%|█████     | 1/2 [00:07<00:06,  6.09s/it, CE=2.262693e+00 H=2.262590e+00 dV_dx=-1.568323e-05 dV_dθ=-8.664753e-05 ||∇||=3.583788e-01 | Tr=0.1132 Te/Cur=0.1126 Te/Exp=0.2256]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.262693e+00 H=2.262590e+00 dV_dx=-1.568323e-05 dV_dθ=-8.664753e-05 ||∇||=3.583788e-01 | Tr=0.1132 Te/Cur=0.1126 Te/Exp=0.2256]100%|██████████| 2/2 [00:07<00:00,  3.97s/it, CE=2.262693e+00 H=2.262590e+00 dV_dx=-1.568323e-05 dV_dθ=-8.664753e-05 ||∇||=3.583788e-01 | Tr=0.1132 Te/Cur=0.1126 Te/Exp=0.2256]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.40s/it] 50%|█████     | 1/2 [00:10<00:08,  8.40s/it, CE=2.259370e+00 H=2.259323e+00 dV_dx=7.866360e-06 dV_dθ=-5.495423e-05 ||∇||=3.481763e-01 | Tr=0.1326 Te/Cur=0.1417 Te/Exp=0.2275]100%|██████████| 2/2 [00:10<00:00,  4.62s/it, CE=2.259370e+00 H=2.259323e+00 dV_dx=7.866360e-06 dV_dθ=-5.495423e-05 ||∇||=3.481763e-01 | Tr=0.1326 Te/Cur=0.1417 Te/Exp=0.2275]100%|██████████| 2/2 [00:10<00:00,  5.19s/it, CE=2.259370e+00 H=2.259323e+00 dV_dx=7.866360e-06 dV_dθ=-5.495423e-05 ||∇||=3.481763e-01 | Tr=0.1326 Te/Cur=0.1417 Te/Exp=0.2275]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.45s/it] 50%|█████     | 1/2 [00:11<00:09,  9.45s/it, CE=2.268681e+00 H=2.268639e+00 dV_dx=4.497041e-06 dV_dθ=-4.658150e-05 ||∇||=3.249836e-01 | Tr=0.0947 Te/Cur=0.0993 Te/Exp=0.2463]100%|██████████| 2/2 [00:11<00:00,  5.04s/it, CE=2.268681e+00 H=2.268639e+00 dV_dx=4.497041e-06 dV_dθ=-4.658150e-05 ||∇||=3.249836e-01 | Tr=0.0947 Te/Cur=0.0993 Te/Exp=0.2463]100%|██████████| 2/2 [00:11<00:00,  5.70s/it, CE=2.268681e+00 H=2.268639e+00 dV_dx=4.497041e-06 dV_dθ=-4.658150e-05 ||∇||=3.249836e-01 | Tr=0.0947 Te/Cur=0.0993 Te/Exp=0.2463]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.96s/it] 50%|█████     | 1/2 [00:09<00:07,  7.96s/it, CE=2.270718e+00 H=2.270645e+00 dV_dx=1.423789e-07 dV_dθ=-7.395727e-05 ||∇||=3.424729e-01 | Tr=0.1494 Te/Cur=0.1683 Te/Exp=0.2566]100%|██████████| 2/2 [00:09<00:00,  4.35s/it, CE=2.270718e+00 H=2.270645e+00 dV_dx=1.423789e-07 dV_dθ=-7.395727e-05 ||∇||=3.424729e-01 | Tr=0.1494 Te/Cur=0.1683 Te/Exp=0.2566]100%|██████████| 2/2 [00:09<00:00,  4.89s/it, CE=2.270718e+00 H=2.270645e+00 dV_dx=1.423789e-07 dV_dθ=-7.395727e-05 ||∇||=3.424729e-01 | Tr=0.1494 Te/Cur=0.1683 Te/Exp=0.2566]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.13s/it] 50%|█████     | 1/2 [00:12<00:11, 11.13s/it, CE=2.255409e+00 H=2.255366e+00 dV_dx=7.762440e-07 dV_dθ=-4.377942e-05 ||∇||=3.255684e-01 | Tr=0.1147 Te/Cur=0.1207 Te/Exp=0.2697]100%|██████████| 2/2 [00:12<00:00,  5.56s/it, CE=2.255409e+00 H=2.255366e+00 dV_dx=7.762440e-07 dV_dθ=-4.377942e-05 ||∇||=3.255684e-01 | Tr=0.1147 Te/Cur=0.1207 Te/Exp=0.2697]100%|██████████| 2/2 [00:12<00:00,  6.39s/it, CE=2.255409e+00 H=2.255366e+00 dV_dx=7.762440e-07 dV_dθ=-4.377942e-05 ||∇||=3.255684e-01 | Tr=0.1147 Te/Cur=0.1207 Te/Exp=0.2697]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 652, 164, 10]) with loss 2.225023
  Total candidates evaluated: 54
  Original: (3, [507, 652, 144, 10])
  Optimal: (2, [507, 652, 164, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 3→2, feed [507, 652, 144, 10]→[507, 652, 164, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 3)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:19, 13.66s/it]  5%|▌         | 1/20 [00:15<04:19, 13.66s/it, CE=2.561395e+00 H=2.250196e+00 dV_dx=2.373673e-05 dV_dθ=-3.112223e-01 ||∇||=2.217405e+01 | Tr=0.8114] 10%|█         | 2/20 [00:15<02:05,  6.97s/it, CE=2.561395e+00 H=2.250196e+00 dV_dx=2.373673e-05 dV_dθ=-3.112223e-01 ||∇||=2.217405e+01 | Tr=0.8114] 10%|█         | 2/20 [00:18<02:05,  6.97s/it, CE=2.000773e+00 H=1.607394e+00 dV_dx=-6.811751e-05 dV_dθ=-3.933111e-01 ||∇||=2.061594e+01 | Tr=0.8114] 15%|█▌        | 3/20 [00:18<01:23,  4.92s/it, CE=2.000773e+00 H=1.607394e+00 dV_dx=-6.811751e-05 dV_dθ=-3.933111e-01 ||∇||=2.061594e+01 | Tr=0.8114] 15%|█▌        | 3/20 [00:20<01:23,  4.92s/it, CE=1.727847e+00 H=1.223463e+00 dV_dx=1.893849e-05 dV_dθ=-5.044027e-01 ||∇||=2.205044e+01 | Tr=0.8114]  20%|██        | 4/20 [00:20<01:01,  3.86s/it, CE=1.727847e+00 H=1.223463e+00 dV_dx=1.893849e-05 dV_dθ=-5.044027e-01 ||∇||=2.205044e+01 | Tr=0.8114] 20%|██        | 4/20 [00:22<01:01,  3.86s/it, CE=1.547019e+00 H=8.300083e-01 dV_dx=8.862254e-05 dV_dθ=-7.170991e-01 ||∇||=2.440267e+01 | Tr=0.8114] 25%|██▌       | 5/20 [00:22<00:48,  3.26s/it, CE=1.547019e+00 H=8.300083e-01 dV_dx=8.862254e-05 dV_dθ=-7.170991e-01 ||∇||=2.440267e+01 | Tr=0.8114] 25%|██▌       | 5/20 [00:24<00:48,  3.26s/it, CE=1.411810e+00 H=4.995754e-01 dV_dx=-5.994531e-05 dV_dθ=-9.121743e-01 ||∇||=2.693943e+01 | Tr=0.8114] 30%|███       | 6/20 [00:24<00:39,  2.82s/it, CE=1.411810e+00 H=4.995754e-01 dV_dx=-5.994531e-05 dV_dθ=-9.121743e-01 ||∇||=2.693943e+01 | Tr=0.8114] 30%|███       | 6/20 [00:27<00:39,  2.82s/it, CE=1.304026e+00 H=3.791231e-01 dV_dx=-1.691984e-06 dV_dθ=-9.249015e-01 ||∇||=2.783029e+01 | Tr=0.8114] 35%|███▌      | 7/20 [00:27<00:35,  2.72s/it, CE=1.304026e+00 H=3.791231e-01 dV_dx=-1.691984e-06 dV_dθ=-9.249015e-01 ||∇||=2.783029e+01 | Tr=0.8114] 35%|███▌      | 7/20 [00:29<00:35,  2.72s/it, CE=1.216136e+00 H=2.811610e-01 dV_dx=4.062713e-05 dV_dθ=-9.350157e-01 ||∇||=2.790353e+01 | Tr=0.8114]  40%|████      | 8/20 [00:29<00:30,  2.55s/it, CE=1.216136e+00 H=2.811610e-01 dV_dx=4.062713e-05 dV_dθ=-9.350157e-01 ||∇||=2.790353e+01 | Tr=0.8114] 40%|████      | 8/20 [00:31<00:30,  2.55s/it, CE=1.143387e+00 H=3.097905e-01 dV_dx=-2.868025e-05 dV_dθ=-8.335681e-01 ||∇||=2.623467e+01 | Tr=0.8114] 45%|████▌     | 9/20 [00:31<00:26,  2.42s/it, CE=1.143387e+00 H=3.097905e-01 dV_dx=-2.868025e-05 dV_dθ=-8.335681e-01 ||∇||=2.623467e+01 | Tr=0.8114] 45%|████▌     | 9/20 [00:33<00:26,  2.42s/it, CE=1.085023e+00 H=1.440557e-01 dV_dx=-1.438904e-05 dV_dθ=-9.409534e-01 ||∇||=2.758840e+01 | Tr=0.8114] 50%|█████     | 10/20 [00:33<00:22,  2.25s/it, CE=1.085023e+00 H=1.440557e-01 dV_dx=-1.438904e-05 dV_dθ=-9.409534e-01 ||∇||=2.758840e+01 | Tr=0.8114] 50%|█████     | 10/20 [00:35<00:22,  2.25s/it, CE=1.035440e+00 H=4.383849e-02 dV_dx=-3.754329e-05 dV_dθ=-9.915638e-01 ||∇||=2.846891e+01 | Tr=0.8114] 55%|█████▌    | 11/20 [00:35<00:20,  2.23s/it, CE=1.035440e+00 H=4.383849e-02 dV_dx=-3.754329e-05 dV_dθ=-9.915638e-01 ||∇||=2.846891e+01 | Tr=0.8114] 55%|█████▌    | 11/20 [00:37<00:20,  2.23s/it, CE=9.907131e-01 H=5.563871e-02 dV_dx=1.317129e-05 dV_dθ=-9.350875e-01 ||∇||=2.865511e+01 | Tr=0.8114]  60%|██████    | 12/20 [00:37<00:17,  2.23s/it, CE=9.907131e-01 H=5.563871e-02 dV_dx=1.317129e-05 dV_dθ=-9.350875e-01 ||∇||=2.865511e+01 | Tr=0.8114] 60%|██████    | 12/20 [00:39<00:17,  2.23s/it, CE=9.510811e-01 H=1.088395e-01 dV_dx=-3.734583e-05 dV_dθ=-8.422042e-01 ||∇||=2.685177e+01 | Tr=0.8114] 65%|██████▌   | 13/20 [00:39<00:15,  2.16s/it, CE=9.510811e-01 H=1.088395e-01 dV_dx=-3.734583e-05 dV_dθ=-8.422042e-01 ||∇||=2.685177e+01 | Tr=0.8114] 65%|██████▌   | 13/20 [00:42<00:15,  2.16s/it, CE=9.135821e-01 H=2.679684e-01 dV_dx=-6.167646e-05 dV_dθ=-6.455520e-01 ||∇||=2.388254e+01 | Tr=0.8114] 70%|███████   | 14/20 [00:42<00:12,  2.14s/it, CE=9.135821e-01 H=2.679684e-01 dV_dx=-6.167646e-05 dV_dθ=-6.455520e-01 ||∇||=2.388254e+01 | Tr=0.8114] 70%|███████   | 14/20 [00:44<00:12,  2.14s/it, CE=8.795036e-01 H=4.109648e-01 dV_dx=-2.728639e-05 dV_dθ=-4.685115e-01 ||∇||=2.095416e+01 | Tr=0.8114] 75%|███████▌  | 15/20 [00:44<00:11,  2.29s/it, CE=8.795036e-01 H=4.109648e-01 dV_dx=-2.728639e-05 dV_dθ=-4.685115e-01 ||∇||=2.095416e+01 | Tr=0.8114] 75%|███████▌  | 15/20 [00:46<00:11,  2.29s/it, CE=8.505997e-01 H=4.573107e-01 dV_dx=7.110025e-05 dV_dθ=-3.933601e-01 ||∇||=1.954486e+01 | Tr=0.8114]  80%|████████  | 16/20 [00:46<00:09,  2.28s/it, CE=8.505997e-01 H=4.573107e-01 dV_dx=7.110025e-05 dV_dθ=-3.933601e-01 ||∇||=1.954486e+01 | Tr=0.8114] 80%|████████  | 16/20 [00:49<00:09,  2.28s/it, CE=8.248832e-01 H=4.642630e-01 dV_dx=-2.644127e-05 dV_dθ=-3.605938e-01 ||∇||=1.874467e+01 | Tr=0.8114] 85%|████████▌ | 17/20 [00:49<00:06,  2.25s/it, CE=8.248832e-01 H=4.642630e-01 dV_dx=-2.644127e-05 dV_dθ=-3.605938e-01 ||∇||=1.874467e+01 | Tr=0.8114] 85%|████████▌ | 17/20 [00:51<00:06,  2.25s/it, CE=8.013012e-01 H=4.526363e-01 dV_dx=-2.423979e-05 dV_dθ=-3.486406e-01 ||∇||=1.841045e+01 | Tr=0.8114] 90%|█████████ | 18/20 [00:51<00:04,  2.33s/it, CE=8.013012e-01 H=4.526363e-01 dV_dx=-2.423979e-05 dV_dθ=-3.486406e-01 ||∇||=1.841045e+01 | Tr=0.8114] 90%|█████████ | 18/20 [00:53<00:04,  2.33s/it, CE=7.789685e-01 H=4.485257e-01 dV_dx=-2.040222e-05 dV_dθ=-3.304223e-01 ||∇||=1.781629e+01 | Tr=0.8114] 95%|█████████▌| 19/20 [00:53<00:02,  2.34s/it, CE=7.789685e-01 H=4.485257e-01 dV_dx=-2.040222e-05 dV_dθ=-3.304223e-01 ||∇||=1.781629e+01 | Tr=0.8114] 95%|█████████▌| 19/20 [00:57<00:02,  2.34s/it, CE=7.590698e-01 H=4.526059e-01 dV_dx=-1.857782e-05 dV_dθ=-3.064454e-01 ||∇||=1.729619e+01 | Tr=0.8114 Te/Cur=0.9124 Te/Exp=0.7268]100%|██████████| 20/20 [01:00<00:00,  3.62s/it, CE=7.590698e-01 H=4.526059e-01 dV_dx=-1.857782e-05 dV_dθ=-3.064454e-01 ||∇||=1.729619e+01 | Tr=0.8114 Te/Cur=0.9124 Te/Exp=0.7268]100%|██████████| 20/20 [01:00<00:00,  3.03s/it, CE=7.590698e-01 H=4.526059e-01 dV_dx=-1.857782e-05 dV_dθ=-3.064454e-01 ||∇||=1.729619e+01 | Tr=0.8114 Te/Cur=0.9124 Te/Exp=0.7268]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.645878
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:07<02:21,  7.46s/it]  5%|▌         | 1/20 [00:11<02:21,  7.46s/it, CE=7.866895e-01 H=2.046803e-01 dV_dx=6.014774e-05 dV_dθ=-5.820694e-01 ||∇||=2.245812e+01 | Tr=0.8109] 10%|█         | 2/20 [00:11<01:35,  5.29s/it, CE=7.866895e-01 H=2.046803e-01 dV_dx=6.014774e-05 dV_dθ=-5.820694e-01 ||∇||=2.245812e+01 | Tr=0.8109] 10%|█         | 2/20 [00:14<01:35,  5.29s/it, CE=7.598220e-01 H=1.186825e-01 dV_dx=-1.785213e-07 dV_dθ=-6.411392e-01 ||∇||=2.379318e+01 | Tr=0.8109] 15%|█▌        | 3/20 [00:14<01:10,  4.18s/it, CE=7.598220e-01 H=1.186825e-01 dV_dx=-1.785213e-07 dV_dθ=-6.411392e-01 ||∇||=2.379318e+01 | Tr=0.8109] 15%|█▌        | 3/20 [00:16<01:10,  4.18s/it, CE=7.371286e-01 H=1.286458e-01 dV_dx=-6.523082e-05 dV_dθ=-6.084175e-01 ||∇||=2.341113e+01 | Tr=0.8109] 20%|██        | 4/20 [00:16<00:58,  3.65s/it, CE=7.371286e-01 H=1.286458e-01 dV_dx=-6.523082e-05 dV_dθ=-6.084175e-01 ||∇||=2.341113e+01 | Tr=0.8109] 20%|██        | 4/20 [00:19<00:58,  3.65s/it, CE=7.142564e-01 H=2.079368e-01 dV_dx=5.380336e-06 dV_dθ=-5.063250e-01 ||∇||=2.139317e+01 | Tr=0.8109]  25%|██▌       | 5/20 [00:19<00:48,  3.21s/it, CE=7.142564e-01 H=2.079368e-01 dV_dx=5.380336e-06 dV_dθ=-5.063250e-01 ||∇||=2.139317e+01 | Tr=0.8109] 25%|██▌       | 5/20 [00:21<00:48,  3.21s/it, CE=6.940304e-01 H=2.830895e-01 dV_dx=-2.818739e-05 dV_dθ=-4.109127e-01 ||∇||=1.989729e+01 | Tr=0.8109] 30%|███       | 6/20 [00:21<00:41,  2.94s/it, CE=6.940304e-01 H=2.830895e-01 dV_dx=-2.818739e-05 dV_dθ=-4.109127e-01 ||∇||=1.989729e+01 | Tr=0.8109] 30%|███       | 6/20 [00:24<00:41,  2.94s/it, CE=6.767000e-01 H=2.794556e-01 dV_dx=4.116867e-05 dV_dθ=-3.972855e-01 ||∇||=1.970918e+01 | Tr=0.8109]  35%|███▌      | 7/20 [00:24<00:35,  2.71s/it, CE=6.767000e-01 H=2.794556e-01 dV_dx=4.116867e-05 dV_dθ=-3.972855e-01 ||∇||=1.970918e+01 | Tr=0.8109] 35%|███▌      | 7/20 [00:26<00:35,  2.71s/it, CE=6.636494e-01 H=1.687173e-01 dV_dx=7.360729e-06 dV_dθ=-4.949394e-01 ||∇||=2.146257e+01 | Tr=0.8109] 40%|████      | 8/20 [00:26<00:32,  2.72s/it, CE=6.636494e-01 H=1.687173e-01 dV_dx=7.360729e-06 dV_dθ=-4.949394e-01 ||∇||=2.146257e+01 | Tr=0.8109] 40%|████      | 8/20 [00:28<00:32,  2.72s/it, CE=6.546668e-01 H=-3.848677e-02 dV_dx=-6.695941e-05 dV_dθ=-6.930867e-01 ||∇||=2.458800e+01 | Tr=0.8109] 45%|████▌     | 9/20 [00:28<00:27,  2.52s/it, CE=6.546668e-01 H=-3.848677e-02 dV_dx=-6.695941e-05 dV_dθ=-6.930867e-01 ||∇||=2.458800e+01 | Tr=0.8109] 45%|████▌     | 9/20 [00:31<00:27,  2.52s/it, CE=6.537415e-01 H=-4.751637e-01 dV_dx=-4.047890e-05 dV_dθ=-1.128865e+00 ||∇||=2.999861e+01 | Tr=0.8109] 50%|█████     | 10/20 [00:31<00:24,  2.45s/it, CE=6.537415e-01 H=-4.751637e-01 dV_dx=-4.047890e-05 dV_dθ=-1.128865e+00 ||∇||=2.999861e+01 | Tr=0.8109] 50%|█████     | 10/20 [00:33<00:24,  2.45s/it, CE=6.400148e-01 H=-1.873257e-01 dV_dx=2.644028e-05 dV_dθ=-8.273670e-01 ||∇||=2.692853e+01 | Tr=0.8109]  55%|█████▌    | 11/20 [00:33<00:20,  2.33s/it, CE=6.400148e-01 H=-1.873257e-01 dV_dx=2.644028e-05 dV_dθ=-8.273670e-01 ||∇||=2.692853e+01 | Tr=0.8109] 55%|█████▌    | 11/20 [00:35<00:20,  2.33s/it, CE=6.078090e-01 H=4.295730e-01 dV_dx=3.248714e-05 dV_dθ=-1.782684e-01 ||∇||=1.425426e+01 | Tr=0.8109]  60%|██████    | 12/20 [00:35<00:18,  2.26s/it, CE=6.078090e-01 H=4.295730e-01 dV_dx=3.248714e-05 dV_dθ=-1.782684e-01 ||∇||=1.425426e+01 | Tr=0.8109] 60%|██████    | 12/20 [00:37<00:18,  2.26s/it, CE=5.954669e-01 H=4.441749e-01 dV_dx=6.786007e-05 dV_dθ=-1.513599e-01 ||∇||=1.349305e+01 | Tr=0.8109] 65%|██████▌   | 13/20 [00:37<00:15,  2.25s/it, CE=5.954669e-01 H=4.441749e-01 dV_dx=6.786007e-05 dV_dθ=-1.513599e-01 ||∇||=1.349305e+01 | Tr=0.8109] 65%|██████▌   | 13/20 [00:39<00:15,  2.25s/it, CE=5.860630e-01 H=3.957299e-01 dV_dx=4.314749e-05 dV_dθ=-1.903762e-01 ||∇||=1.477826e+01 | Tr=0.8109] 70%|███████   | 14/20 [00:39<00:13,  2.22s/it, CE=5.860630e-01 H=3.957299e-01 dV_dx=4.314749e-05 dV_dθ=-1.903762e-01 ||∇||=1.477826e+01 | Tr=0.8109] 70%|███████   | 14/20 [00:41<00:13,  2.22s/it, CE=5.772487e-01 H=3.762300e-01 dV_dx=5.681850e-05 dV_dθ=-2.010755e-01 ||∇||=1.497103e+01 | Tr=0.8109] 75%|███████▌  | 15/20 [00:41<00:11,  2.22s/it, CE=5.772487e-01 H=3.762300e-01 dV_dx=5.681850e-05 dV_dθ=-2.010755e-01 ||∇||=1.497103e+01 | Tr=0.8109] 75%|███████▌  | 15/20 [00:44<00:11,  2.22s/it, CE=5.666470e-01 H=4.161830e-01 dV_dx=-4.708700e-05 dV_dθ=-1.504170e-01 ||∇||=1.327190e+01 | Tr=0.8109] 80%|████████  | 16/20 [00:44<00:09,  2.31s/it, CE=5.666470e-01 H=4.161830e-01 dV_dx=-4.708700e-05 dV_dθ=-1.504170e-01 ||∇||=1.327190e+01 | Tr=0.8109] 80%|████████  | 16/20 [00:46<00:09,  2.31s/it, CE=5.587369e-01 H=4.177247e-01 dV_dx=-3.194323e-05 dV_dθ=-1.409802e-01 ||∇||=1.285674e+01 | Tr=0.8109] 85%|████████▌ | 17/20 [00:46<00:06,  2.20s/it, CE=5.587369e-01 H=4.177247e-01 dV_dx=-3.194323e-05 dV_dθ=-1.409802e-01 ||∇||=1.285674e+01 | Tr=0.8109] 85%|████████▌ | 17/20 [00:48<00:06,  2.20s/it, CE=5.484932e-01 H=4.208552e-01 dV_dx=2.516854e-05 dV_dθ=-1.276632e-01 ||∇||=1.257365e+01 | Tr=0.8109]  90%|█████████ | 18/20 [00:48<00:04,  2.28s/it, CE=5.484932e-01 H=4.208552e-01 dV_dx=2.516854e-05 dV_dθ=-1.276632e-01 ||∇||=1.257365e+01 | Tr=0.8109] 90%|█████████ | 18/20 [00:51<00:04,  2.28s/it, CE=5.395440e-01 H=4.294350e-01 dV_dx=-2.955986e-05 dV_dθ=-1.100794e-01 ||∇||=1.204528e+01 | Tr=0.8109] 95%|█████████▌| 19/20 [00:51<00:02,  2.28s/it, CE=5.395440e-01 H=4.294350e-01 dV_dx=-2.955986e-05 dV_dθ=-1.100794e-01 ||∇||=1.204528e+01 | Tr=0.8109] 95%|█████████▌| 19/20 [00:59<00:02,  2.28s/it, CE=5.307696e-01 H=4.245166e-01 dV_dx=-2.239357e-05 dV_dθ=-1.062306e-01 ||∇||=1.199897e+01 | Tr=0.8109 Te/Cur=0.9482 Te/Exp=0.7902]100%|██████████| 20/20 [01:04<00:00,  5.62s/it, CE=5.307696e-01 H=4.245166e-01 dV_dx=-2.239357e-05 dV_dθ=-1.062306e-01 ||∇||=1.199897e+01 | Tr=0.8109 Te/Cur=0.9482 Te/Exp=0.7902]100%|██████████| 20/20 [01:04<00:00,  3.22s/it, CE=5.307696e-01 H=4.245166e-01 dV_dx=-2.239357e-05 dV_dθ=-1.062306e-01 ||∇||=1.199897e+01 | Tr=0.8109 Te/Cur=0.9482 Te/Exp=0.7902]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.90s/it] 50%|█████     | 1/2 [00:12<00:08,  8.90s/it, CE=5.709025e-01 H=5.666798e-01 dV_dx=3.614869e-05 dV_dθ=-4.258889e-03 ||∇||=2.612837e+00 | Tr=0.9710 Te/Cur=0.9548 Te/Exp=0.8012]100%|██████████| 2/2 [00:12<00:00,  5.98s/it, CE=5.709025e-01 H=5.666798e-01 dV_dx=3.614869e-05 dV_dθ=-4.258889e-03 ||∇||=2.612837e+00 | Tr=0.9710 Te/Cur=0.9548 Te/Exp=0.8012]100%|██████████| 2/2 [00:12<00:00,  6.41s/it, CE=5.709025e-01 H=5.666798e-01 dV_dx=3.614869e-05 dV_dθ=-4.258889e-03 ||∇||=2.612837e+00 | Tr=0.9710 Te/Cur=0.9548 Te/Exp=0.8012]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<01:58,  6.25s/it]  5%|▌         | 1/20 [00:08<01:58,  6.25s/it, CE=5.468130e-01 H=5.443326e-01 dV_dx=1.389580e-04 dV_dθ=-2.619350e-03 ||∇||=2.411179e+00 | Tr=0.9744] 10%|█         | 2/20 [00:08<01:06,  3.67s/it, CE=5.468130e-01 H=5.443326e-01 dV_dx=1.389580e-04 dV_dθ=-2.619350e-03 ||∇||=2.411179e+00 | Tr=0.9744] 10%|█         | 2/20 [00:10<01:06,  3.67s/it, CE=5.298722e-01 H=5.273439e-01 dV_dx=3.865646e-05 dV_dθ=-2.566939e-03 ||∇||=2.356379e+00 | Tr=0.9755] 15%|█▌        | 3/20 [00:10<00:51,  3.01s/it, CE=5.298722e-01 H=5.273439e-01 dV_dx=3.865646e-05 dV_dθ=-2.566939e-03 ||∇||=2.356379e+00 | Tr=0.9755] 15%|█▌        | 3/20 [00:12<00:51,  3.01s/it, CE=5.158986e-01 H=5.135026e-01 dV_dx=-1.205013e-04 dV_dθ=-2.275477e-03 ||∇||=2.291779e+00 | Tr=0.9764] 20%|██        | 4/20 [00:12<00:41,  2.62s/it, CE=5.158986e-01 H=5.135026e-01 dV_dx=-1.205013e-04 dV_dθ=-2.275477e-03 ||∇||=2.291779e+00 | Tr=0.9764] 20%|██        | 4/20 [00:14<00:41,  2.62s/it, CE=5.037588e-01 H=5.016512e-01 dV_dx=-1.926153e-05 dV_dθ=-2.088361e-03 ||∇||=2.249260e+00 | Tr=0.9773] 25%|██▌       | 5/20 [00:14<00:34,  2.31s/it, CE=5.037588e-01 H=5.016512e-01 dV_dx=-1.926153e-05 dV_dθ=-2.088361e-03 ||∇||=2.249260e+00 | Tr=0.9773] 25%|██▌       | 5/20 [00:17<00:34,  2.31s/it, CE=4.930357e-01 H=4.911500e-01 dV_dx=1.029683e-04 dV_dθ=-1.988682e-03 ||∇||=2.214244e+00 | Tr=0.9783 Te/Cur=0.9571 Te/Exp=0.8080] 30%|███       | 6/20 [00:17<00:37,  2.69s/it, CE=4.930357e-01 H=4.911500e-01 dV_dx=1.029683e-04 dV_dθ=-1.988682e-03 ||∇||=2.214244e+00 | Tr=0.9783 Te/Cur=0.9571 Te/Exp=0.8080] 30%|███       | 6/20 [00:19<00:37,  2.69s/it, CE=4.830773e-01 H=4.812433e-01 dV_dx=1.774703e-04 dV_dθ=-2.011476e-03 ||∇||=2.203955e+00 | Tr=0.9793]                             35%|███▌      | 7/20 [00:19<00:32,  2.47s/it, CE=4.830773e-01 H=4.812433e-01 dV_dx=1.774703e-04 dV_dθ=-2.011476e-03 ||∇||=2.203955e+00 | Tr=0.9793] 35%|███▌      | 7/20 [00:21<00:32,  2.47s/it, CE=4.739397e-01 H=4.720382e-01 dV_dx=5.936015e-05 dV_dθ=-1.960859e-03 ||∇||=2.179433e+00 | Tr=0.9801] 40%|████      | 8/20 [00:21<00:28,  2.34s/it, CE=4.739397e-01 H=4.720382e-01 dV_dx=5.936015e-05 dV_dθ=-1.960859e-03 ||∇||=2.179433e+00 | Tr=0.9801] 40%|████      | 8/20 [00:23<00:28,  2.34s/it, CE=4.655072e-01 H=4.634776e-01 dV_dx=-1.410742e-04 dV_dθ=-1.888519e-03 ||∇||=2.153001e+00 | Tr=0.9811] 45%|████▌     | 9/20 [00:23<00:25,  2.31s/it, CE=4.655072e-01 H=4.634776e-01 dV_dx=-1.410742e-04 dV_dθ=-1.888519e-03 ||∇||=2.153001e+00 | Tr=0.9811] 45%|████▌     | 9/20 [00:26<00:25,  2.31s/it, CE=4.573976e-01 H=4.555839e-01 dV_dx=-1.842661e-05 dV_dθ=-1.795267e-03 ||∇||=2.108517e+00 | Tr=0.9816] 50%|█████     | 10/20 [00:26<00:22,  2.25s/it, CE=4.573976e-01 H=4.555839e-01 dV_dx=-1.842661e-05 dV_dθ=-1.795267e-03 ||∇||=2.108517e+00 | Tr=0.9816] 50%|█████     | 10/20 [00:29<00:22,  2.25s/it, CE=4.498949e-01 H=4.481439e-01 dV_dx=2.203742e-05 dV_dθ=-1.773075e-03 ||∇||=2.086734e+00 | Tr=0.9822 Te/Cur=0.9607 Te/Exp=0.8156] 55%|█████▌    | 11/20 [00:29<00:22,  2.49s/it, CE=4.498949e-01 H=4.481439e-01 dV_dx=2.203742e-05 dV_dθ=-1.773075e-03 ||∇||=2.086734e+00 | Tr=0.9822 Te/Cur=0.9607 Te/Exp=0.8156] 55%|█████▌    | 11/20 [00:31<00:22,  2.49s/it, CE=4.428864e-01 H=4.412414e-01 dV_dx=2.824435e-05 dV_dθ=-1.673302e-03 ||∇||=2.045845e+00 | Tr=0.9829]                             60%|██████    | 12/20 [00:31<00:19,  2.43s/it, CE=4.428864e-01 H=4.412414e-01 dV_dx=2.824435e-05 dV_dθ=-1.673302e-03 ||∇||=2.045845e+00 | Tr=0.9829] 60%|██████    | 12/20 [00:33<00:19,  2.43s/it, CE=4.363470e-01 H=4.345820e-01 dV_dx=-2.952992e-05 dV_dθ=-1.735544e-03 ||∇||=2.051277e+00 | Tr=0.9837] 65%|██████▌   | 13/20 [00:33<00:17,  2.46s/it, CE=4.363470e-01 H=4.345820e-01 dV_dx=-2.952992e-05 dV_dθ=-1.735544e-03 ||∇||=2.051277e+00 | Tr=0.9837] 65%|██████▌   | 13/20 [00:35<00:17,  2.46s/it, CE=4.302465e-01 H=4.284245e-01 dV_dx=6.167062e-05 dV_dθ=-1.883606e-03 ||∇||=2.066063e+00 | Tr=0.9845]  70%|███████   | 14/20 [00:35<00:13,  2.33s/it, CE=4.302465e-01 H=4.284245e-01 dV_dx=6.167062e-05 dV_dθ=-1.883606e-03 ||∇||=2.066063e+00 | Tr=0.9845] 70%|███████   | 14/20 [00:38<00:13,  2.33s/it, CE=4.239202e-01 H=4.220626e-01 dV_dx=-1.218386e-05 dV_dθ=-1.845491e-03 ||∇||=2.041878e+00 | Tr=0.9852] 75%|███████▌  | 15/20 [00:38<00:11,  2.39s/it, CE=4.239202e-01 H=4.220626e-01 dV_dx=-1.218386e-05 dV_dθ=-1.845491e-03 ||∇||=2.041878e+00 | Tr=0.9852] 75%|███████▌  | 15/20 [00:41<00:11,  2.39s/it, CE=4.182107e-01 H=4.163959e-01 dV_dx=1.184295e-04 dV_dθ=-1.933242e-03 ||∇||=2.037912e+00 | Tr=0.9855 Te/Cur=0.9662 Te/Exp=0.8203] 80%|████████  | 16/20 [00:41<00:10,  2.62s/it, CE=4.182107e-01 H=4.163959e-01 dV_dx=1.184295e-04 dV_dθ=-1.933242e-03 ||∇||=2.037912e+00 | Tr=0.9855 Te/Cur=0.9662 Te/Exp=0.8203] 80%|████████  | 16/20 [00:43<00:10,  2.62s/it, CE=4.127469e-01 H=4.106299e-01 dV_dx=-5.936525e-05 dV_dθ=-2.057592e-03 ||∇||=2.031201e+00 | Tr=0.9862]                            85%|████████▌ | 17/20 [00:43<00:07,  2.46s/it, CE=4.127469e-01 H=4.106299e-01 dV_dx=-5.936525e-05 dV_dθ=-2.057592e-03 ||∇||=2.031201e+00 | Tr=0.9862] 85%|████████▌ | 17/20 [00:45<00:07,  2.46s/it, CE=4.076178e-01 H=4.056200e-01 dV_dx=1.454420e-04 dV_dθ=-2.143246e-03 ||∇||=2.044386e+00 | Tr=0.9866]  90%|█████████ | 18/20 [00:45<00:04,  2.34s/it, CE=4.076178e-01 H=4.056200e-01 dV_dx=1.454420e-04 dV_dθ=-2.143246e-03 ||∇||=2.044386e+00 | Tr=0.9866] 90%|█████████ | 18/20 [00:47<00:04,  2.34s/it, CE=4.023240e-01 H=4.003963e-01 dV_dx=-2.685079e-05 dV_dθ=-1.900899e-03 ||∇||=1.991401e+00 | Tr=0.9872] 95%|█████████▌| 19/20 [00:47<00:02,  2.32s/it, CE=4.023240e-01 H=4.003963e-01 dV_dx=-2.685079e-05 dV_dθ=-1.900899e-03 ||∇||=1.991401e+00 | Tr=0.9872] 95%|█████████▌| 19/20 [00:51<00:02,  2.32s/it, CE=3.974617e-01 H=3.954791e-01 dV_dx=-5.413933e-06 dV_dθ=-1.977222e-03 ||∇||=1.999548e+00 | Tr=0.9877 Te/Cur=0.9676 Te/Exp=0.8280]100%|██████████| 20/20 [00:51<00:00,  2.69s/it, CE=3.974617e-01 H=3.954791e-01 dV_dx=-5.413933e-06 dV_dθ=-1.977222e-03 ||∇||=1.999548e+00 | Tr=0.9877 Te/Cur=0.9676 Te/Exp=0.8280]100%|██████████| 20/20 [00:51<00:00,  2.58s/it, CE=3.974617e-01 H=3.954791e-01 dV_dx=-5.413933e-06 dV_dθ=-1.977222e-03 ||∇||=1.999548e+00 | Tr=0.9877 Te/Cur=0.9676 Te/Exp=0.8280]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 7 final loss: 0.407836
======================================================================


  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7496
    Task 1: 0.9147
    Task 2: 0.8076
    Task 3: 0.5837
    Task 4: 0.9151
    Task 5: 0.8995
    Task 6: 0.9093
    Task 7: 0.9676

============================================================
Task 8
============================================================
Initial loss on new task: 6.2435, previous: 0.3975, ratio: 15.71
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 8
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:12<?, ?it/s, CE=6.029652e-01 H=5.044188e-01 dV_dx=1.073760e-04 dV_dθ=-9.865383e-02 ||∇||=9.862505e+00 | Tr=0.6971 Te/Cur=0.8362 Te/Exp=0.8087]100%|██████████| 1/1 [00:12<00:00, 12.15s/it, CE=6.029652e-01 H=5.044188e-01 dV_dx=1.073760e-04 dV_dθ=-9.865383e-02 ||∇||=9.862505e+00 | Tr=0.6971 Te/Cur=0.8362 Te/Exp=0.8087]100%|██████████| 1/1 [00:12<00:00, 12.15s/it, CE=6.029652e-01 H=5.044188e-01 dV_dx=1.073760e-04 dV_dθ=-9.865383e-02 ||∇||=9.862505e+00 | Tr=0.6971 Te/Cur=0.8362 Te/Exp=0.8087]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.602965

[STEP 2] Architecture change decision
  Current: 0.602965, Previous: 0.397462
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 39931 samples from 10 classes
  Starting grid architecture search for task 8
  Baseline architecture: (2, [507, 652, 164, 10])
  Baseline loss: 0.602965
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.34s/it] 50%|█████     | 1/2 [00:05<00:03,  3.34s/it, CE=2.248218e+00 H=2.248156e+00 dV_dx=8.224800e-06 dV_dθ=-7.105750e-05 ||∇||=4.632354e-01 | Tr=0.1364 Te/Cur=0.1465 Te/Exp=0.2686]100%|██████████| 2/2 [00:05<00:00,  2.39s/it, CE=2.248218e+00 H=2.248156e+00 dV_dx=8.224800e-06 dV_dθ=-7.105750e-05 ||∇||=4.632354e-01 | Tr=0.1364 Te/Cur=0.1465 Te/Exp=0.2686]100%|██████████| 2/2 [00:05<00:00,  2.53s/it, CE=2.248218e+00 H=2.248156e+00 dV_dx=8.224800e-06 dV_dθ=-7.105750e-05 ||∇||=4.632354e-01 | Tr=0.1364 Te/Cur=0.1465 Te/Exp=0.2686]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.248218487857269
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.21s/it] 50%|█████     | 1/2 [00:06<00:04,  4.21s/it, CE=2.258958e+00 H=2.258869e+00 dV_dx=-7.760682e-06 dV_dθ=-8.103976e-05 ||∇||=4.586829e-01 | Tr=0.0920 Te/Cur=0.1099 Te/Exp=0.2325]100%|██████████| 2/2 [00:06<00:00,  2.92s/it, CE=2.258958e+00 H=2.258869e+00 dV_dx=-7.760682e-06 dV_dθ=-8.103976e-05 ||∇||=4.586829e-01 | Tr=0.0920 Te/Cur=0.1099 Te/Exp=0.2325]100%|██████████| 2/2 [00:06<00:00,  3.11s/it, CE=2.258958e+00 H=2.258869e+00 dV_dx=-7.760682e-06 dV_dθ=-8.103976e-05 ||∇||=4.586829e-01 | Tr=0.0920 Te/Cur=0.1099 Te/Exp=0.2325]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.43s/it] 50%|█████     | 1/2 [00:05<00:03,  3.43s/it, CE=2.267081e+00 H=2.266998e+00 dV_dx=4.234524e-06 dV_dθ=-8.759119e-05 ||∇||=4.564168e-01 | Tr=0.0923 Te/Cur=0.1010 Te/Exp=0.2189]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.267081e+00 H=2.266998e+00 dV_dx=4.234524e-06 dV_dθ=-8.759119e-05 ||∇||=4.564168e-01 | Tr=0.0923 Te/Cur=0.1010 Te/Exp=0.2189]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.267081e+00 H=2.266998e+00 dV_dx=4.234524e-06 dV_dθ=-8.759119e-05 ||∇||=4.564168e-01 | Tr=0.0923 Te/Cur=0.1010 Te/Exp=0.2189]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.56s/it] 50%|█████     | 1/2 [00:05<00:03,  3.56s/it, CE=2.265278e+00 H=2.265167e+00 dV_dx=1.303274e-05 dV_dθ=-1.244114e-04 ||∇||=4.643208e-01 | Tr=0.1334 Te/Cur=0.1203 Te/Exp=0.2201]100%|██████████| 2/2 [00:05<00:00,  2.87s/it, CE=2.265278e+00 H=2.265167e+00 dV_dx=1.303274e-05 dV_dθ=-1.244114e-04 ||∇||=4.643208e-01 | Tr=0.1334 Te/Cur=0.1203 Te/Exp=0.2201]100%|██████████| 2/2 [00:05<00:00,  2.98s/it, CE=2.265278e+00 H=2.265167e+00 dV_dx=1.303274e-05 dV_dθ=-1.244114e-04 ||∇||=4.643208e-01 | Tr=0.1334 Te/Cur=0.1203 Te/Exp=0.2201]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.92s/it] 50%|█████     | 1/2 [00:04<00:02,  2.92s/it, CE=2.251665e+00 H=2.251595e+00 dV_dx=2.702244e-06 dV_dθ=-7.248563e-05 ||∇||=4.451683e-01 | Tr=0.1070 Te/Cur=0.1410 Te/Exp=0.2606]100%|██████████| 2/2 [00:04<00:00,  2.19s/it, CE=2.251665e+00 H=2.251595e+00 dV_dx=2.702244e-06 dV_dθ=-7.248563e-05 ||∇||=4.451683e-01 | Tr=0.1070 Te/Cur=0.1410 Te/Exp=0.2606]100%|██████████| 2/2 [00:04<00:00,  2.30s/it, CE=2.251665e+00 H=2.251595e+00 dV_dx=2.702244e-06 dV_dθ=-7.248563e-05 ||∇||=4.451683e-01 | Tr=0.1070 Te/Cur=0.1410 Te/Exp=0.2606]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.69s/it] 50%|█████     | 1/2 [00:07<00:05,  5.69s/it, CE=2.252986e+00 H=2.252911e+00 dV_dx=-6.754028e-06 dV_dθ=-6.796530e-05 ||∇||=4.616286e-01 | Tr=0.1157 Te/Cur=0.1245 Te/Exp=0.2477]100%|██████████| 2/2 [00:07<00:00,  3.32s/it, CE=2.252986e+00 H=2.252911e+00 dV_dx=-6.754028e-06 dV_dθ=-6.796530e-05 ||∇||=4.616286e-01 | Tr=0.1157 Te/Cur=0.1245 Te/Exp=0.2477]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.252986e+00 H=2.252911e+00 dV_dx=-6.754028e-06 dV_dθ=-6.796530e-05 ||∇||=4.616286e-01 | Tr=0.1157 Te/Cur=0.1245 Te/Exp=0.2477]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.19s/it] 50%|█████     | 1/2 [00:04<00:03,  3.19s/it, CE=2.257064e+00 H=2.256975e+00 dV_dx=3.250206e-06 dV_dθ=-9.213254e-05 ||∇||=4.757088e-01 | Tr=0.1233 Te/Cur=0.1754 Te/Exp=0.2061]100%|██████████| 2/2 [00:04<00:00,  2.34s/it, CE=2.257064e+00 H=2.256975e+00 dV_dx=3.250206e-06 dV_dθ=-9.213254e-05 ||∇||=4.757088e-01 | Tr=0.1233 Te/Cur=0.1754 Te/Exp=0.2061]100%|██████████| 2/2 [00:04<00:00,  2.47s/it, CE=2.257064e+00 H=2.256975e+00 dV_dx=3.250206e-06 dV_dθ=-9.213254e-05 ||∇||=4.757088e-01 | Tr=0.1233 Te/Cur=0.1754 Te/Exp=0.2061]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.88s/it] 50%|█████     | 1/2 [00:08<00:06,  6.88s/it, CE=2.271618e+00 H=2.271486e+00 dV_dx=2.199662e-07 dV_dθ=-1.323203e-04 ||∇||=5.010276e-01 | Tr=0.1111 Te/Cur=0.1218 Te/Exp=0.2007]100%|██████████| 2/2 [00:08<00:00,  3.87s/it, CE=2.271618e+00 H=2.271486e+00 dV_dx=2.199662e-07 dV_dθ=-1.323203e-04 ||∇||=5.010276e-01 | Tr=0.1111 Te/Cur=0.1218 Te/Exp=0.2007]100%|██████████| 2/2 [00:08<00:00,  4.32s/it, CE=2.271618e+00 H=2.271486e+00 dV_dx=2.199662e-07 dV_dθ=-1.323203e-04 ||∇||=5.010276e-01 | Tr=0.1111 Te/Cur=0.1218 Te/Exp=0.2007]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.82s/it] 50%|█████     | 1/2 [00:05<00:03,  3.82s/it, CE=2.248969e+00 H=2.248883e+00 dV_dx=6.910749e-06 dV_dθ=-9.279869e-05 ||∇||=4.793909e-01 | Tr=0.1123 Te/Cur=0.1514 Te/Exp=0.2768]100%|██████████| 2/2 [00:05<00:00,  2.77s/it, CE=2.248969e+00 H=2.248883e+00 dV_dx=6.910749e-06 dV_dθ=-9.279869e-05 ||∇||=4.793909e-01 | Tr=0.1123 Te/Cur=0.1514 Te/Exp=0.2768]100%|██████████| 2/2 [00:05<00:00,  2.93s/it, CE=2.248969e+00 H=2.248883e+00 dV_dx=6.910749e-06 dV_dθ=-9.279869e-05 ||∇||=4.793909e-01 | Tr=0.1123 Te/Cur=0.1514 Te/Exp=0.2768]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.91s/it] 50%|█████     | 1/2 [00:05<00:03,  3.91s/it, CE=2.261335e+00 H=2.261293e+00 dV_dx=9.365261e-06 dV_dθ=-5.184846e-05 ||∇||=3.950207e-01 | Tr=0.1532 Te/Cur=0.1470 Te/Exp=0.2299]100%|██████████| 2/2 [00:05<00:00,  2.71s/it, CE=2.261335e+00 H=2.261293e+00 dV_dx=9.365261e-06 dV_dθ=-5.184846e-05 ||∇||=3.950207e-01 | Tr=0.1532 Te/Cur=0.1470 Te/Exp=0.2299]100%|██████████| 2/2 [00:05<00:00,  2.89s/it, CE=2.261335e+00 H=2.261293e+00 dV_dx=9.365261e-06 dV_dθ=-5.184846e-05 ||∇||=3.950207e-01 | Tr=0.1532 Te/Cur=0.1470 Te/Exp=0.2299]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.81s/it] 50%|█████     | 1/2 [00:05<00:03,  3.81s/it, CE=2.264865e+00 H=2.264832e+00 dV_dx=8.135091e-06 dV_dθ=-4.050739e-05 ||∇||=3.757575e-01 | Tr=0.1092 Te/Cur=0.1123 Te/Exp=0.2697]100%|██████████| 2/2 [00:05<00:00,  2.76s/it, CE=2.264865e+00 H=2.264832e+00 dV_dx=8.135091e-06 dV_dθ=-4.050739e-05 ||∇||=3.757575e-01 | Tr=0.1092 Te/Cur=0.1123 Te/Exp=0.2697]100%|██████████| 2/2 [00:05<00:00,  2.92s/it, CE=2.264865e+00 H=2.264832e+00 dV_dx=8.135091e-06 dV_dθ=-4.050739e-05 ||∇||=3.757575e-01 | Tr=0.1092 Te/Cur=0.1123 Te/Exp=0.2697]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.58s/it] 50%|█████     | 1/2 [00:05<00:03,  3.58s/it, CE=2.275484e+00 H=2.275420e+00 dV_dx=-3.059477e-06 dV_dθ=-6.085850e-05 ||∇||=3.646862e-01 | Tr=0.1189 Te/Cur=0.1270 Te/Exp=0.1543]100%|██████████| 2/2 [00:05<00:00,  2.72s/it, CE=2.275484e+00 H=2.275420e+00 dV_dx=-3.059477e-06 dV_dθ=-6.085850e-05 ||∇||=3.646862e-01 | Tr=0.1189 Te/Cur=0.1270 Te/Exp=0.1543]100%|██████████| 2/2 [00:05<00:00,  2.85s/it, CE=2.275484e+00 H=2.275420e+00 dV_dx=-3.059477e-06 dV_dθ=-6.085850e-05 ||∇||=3.646862e-01 | Tr=0.1189 Te/Cur=0.1270 Te/Exp=0.1543]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.49s/it] 50%|█████     | 1/2 [00:05<00:03,  3.49s/it, CE=2.271353e+00 H=2.271285e+00 dV_dx=-1.153733e-05 dV_dθ=-5.590853e-05 ||∇||=3.892845e-01 | Tr=0.1835 Te/Cur=0.1837 Te/Exp=0.1953]100%|██████████| 2/2 [00:05<00:00,  2.53s/it, CE=2.271353e+00 H=2.271285e+00 dV_dx=-1.153733e-05 dV_dθ=-5.590853e-05 ||∇||=3.892845e-01 | Tr=0.1835 Te/Cur=0.1837 Te/Exp=0.1953]100%|██████████| 2/2 [00:05<00:00,  2.67s/it, CE=2.271353e+00 H=2.271285e+00 dV_dx=-1.153733e-05 dV_dθ=-5.590853e-05 ||∇||=3.892845e-01 | Tr=0.1835 Te/Cur=0.1837 Te/Exp=0.1953]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.18s/it] 50%|█████     | 1/2 [00:05<00:03,  3.18s/it, CE=2.264028e+00 H=2.263975e+00 dV_dx=-8.986228e-06 dV_dθ=-4.472075e-05 ||∇||=3.925513e-01 | Tr=0.1194 Te/Cur=0.1535 Te/Exp=0.2688]100%|██████████| 2/2 [00:05<00:00,  2.44s/it, CE=2.264028e+00 H=2.263975e+00 dV_dx=-8.986228e-06 dV_dθ=-4.472075e-05 ||∇||=3.925513e-01 | Tr=0.1194 Te/Cur=0.1535 Te/Exp=0.2688]100%|██████████| 2/2 [00:05<00:00,  2.55s/it, CE=2.264028e+00 H=2.263975e+00 dV_dx=-8.986228e-06 dV_dθ=-4.472075e-05 ||∇||=3.925513e-01 | Tr=0.1194 Te/Cur=0.1535 Te/Exp=0.2688]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.32s/it] 50%|█████     | 1/2 [00:07<00:05,  5.32s/it, CE=2.253777e+00 H=2.253747e+00 dV_dx=7.424092e-06 dV_dθ=-3.721770e-05 ||∇||=3.744724e-01 | Tr=0.1454 Te/Cur=0.1563 Te/Exp=0.2596]100%|██████████| 2/2 [00:07<00:00,  3.26s/it, CE=2.253777e+00 H=2.253747e+00 dV_dx=7.424092e-06 dV_dθ=-3.721770e-05 ||∇||=3.744724e-01 | Tr=0.1454 Te/Cur=0.1563 Te/Exp=0.2596]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.253777e+00 H=2.253747e+00 dV_dx=7.424092e-06 dV_dθ=-3.721770e-05 ||∇||=3.744724e-01 | Tr=0.1454 Te/Cur=0.1563 Te/Exp=0.2596]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.64s/it] 50%|█████     | 1/2 [00:05<00:03,  3.64s/it, CE=2.262730e+00 H=2.262664e+00 dV_dx=2.430319e-06 dV_dθ=-6.896481e-05 ||∇||=3.956393e-01 | Tr=0.1528 Te/Cur=0.1915 Te/Exp=0.2475]100%|██████████| 2/2 [00:05<00:00,  2.69s/it, CE=2.262730e+00 H=2.262664e+00 dV_dx=2.430319e-06 dV_dθ=-6.896481e-05 ||∇||=3.956393e-01 | Tr=0.1528 Te/Cur=0.1915 Te/Exp=0.2475]100%|██████████| 2/2 [00:05<00:00,  2.83s/it, CE=2.262730e+00 H=2.262664e+00 dV_dx=2.430319e-06 dV_dθ=-6.896481e-05 ||∇||=3.956393e-01 | Tr=0.1528 Te/Cur=0.1915 Te/Exp=0.2475]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.18s/it] 50%|█████     | 1/2 [00:05<00:03,  3.18s/it, CE=2.275843e+00 H=2.275752e+00 dV_dx=-1.262257e-06 dV_dθ=-8.984768e-05 ||∇||=3.960527e-01 | Tr=0.1387 Te/Cur=0.1575 Te/Exp=0.2078]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.275843e+00 H=2.275752e+00 dV_dx=-1.262257e-06 dV_dθ=-8.984768e-05 ||∇||=3.960527e-01 | Tr=0.1387 Te/Cur=0.1575 Te/Exp=0.2078]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.275843e+00 H=2.275752e+00 dV_dx=-1.262257e-06 dV_dθ=-8.984768e-05 ||∇||=3.960527e-01 | Tr=0.1387 Te/Cur=0.1575 Te/Exp=0.2078]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.75s/it] 50%|█████     | 1/2 [00:08<00:06,  6.75s/it, CE=2.259195e+00 H=2.259107e+00 dV_dx=-1.011172e-05 dV_dθ=-7.761815e-05 ||∇||=4.152960e-01 | Tr=0.1200 Te/Cur=0.1428 Te/Exp=0.2561]100%|██████████| 2/2 [00:08<00:00,  3.88s/it, CE=2.259195e+00 H=2.259107e+00 dV_dx=-1.011172e-05 dV_dθ=-7.761815e-05 ||∇||=4.152960e-01 | Tr=0.1200 Te/Cur=0.1428 Te/Exp=0.2561]100%|██████████| 2/2 [00:08<00:00,  4.31s/it, CE=2.259195e+00 H=2.259107e+00 dV_dx=-1.011172e-05 dV_dθ=-7.761815e-05 ||∇||=4.152960e-01 | Tr=0.1200 Te/Cur=0.1428 Te/Exp=0.2561]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.278885e+00 H=2.278793e+00 dV_dx=-1.804845e-06 dV_dθ=-8.990952e-05 ||∇||=3.737494e-01 | Tr=0.1376 Te/Cur=0.1440 Te/Exp=0.1884]100%|██████████| 2/2 [00:05<00:00,  2.45s/it, CE=2.278885e+00 H=2.278793e+00 dV_dx=-1.804845e-06 dV_dθ=-8.990952e-05 ||∇||=3.737494e-01 | Tr=0.1376 Te/Cur=0.1440 Te/Exp=0.1884]100%|██████████| 2/2 [00:05<00:00,  2.62s/it, CE=2.278885e+00 H=2.278793e+00 dV_dx=-1.804845e-06 dV_dθ=-8.990952e-05 ||∇||=3.737494e-01 | Tr=0.1376 Te/Cur=0.1440 Te/Exp=0.1884]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.44s/it] 50%|█████     | 1/2 [00:05<00:03,  3.44s/it, CE=2.276761e+00 H=2.276695e+00 dV_dx=-4.270537e-06 dV_dθ=-6.216278e-05 ||∇||=3.499952e-01 | Tr=0.1418 Te/Cur=0.1280 Te/Exp=0.2040]100%|██████████| 2/2 [00:05<00:00,  2.53s/it, CE=2.276761e+00 H=2.276695e+00 dV_dx=-4.270537e-06 dV_dθ=-6.216278e-05 ||∇||=3.499952e-01 | Tr=0.1418 Te/Cur=0.1280 Te/Exp=0.2040]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.276761e+00 H=2.276695e+00 dV_dx=-4.270537e-06 dV_dθ=-6.216278e-05 ||∇||=3.499952e-01 | Tr=0.1418 Te/Cur=0.1280 Te/Exp=0.2040]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.50s/it] 50%|█████     | 1/2 [00:05<00:03,  3.50s/it, CE=2.289151e+00 H=2.289082e+00 dV_dx=-3.522817e-06 dV_dθ=-6.573490e-05 ||∇||=3.497291e-01 | Tr=0.1047 Te/Cur=0.1159 Te/Exp=0.1908]100%|██████████| 2/2 [00:05<00:00,  2.64s/it, CE=2.289151e+00 H=2.289082e+00 dV_dx=-3.522817e-06 dV_dθ=-6.573490e-05 ||∇||=3.497291e-01 | Tr=0.1047 Te/Cur=0.1159 Te/Exp=0.1908]100%|██████████| 2/2 [00:05<00:00,  2.77s/it, CE=2.289151e+00 H=2.289082e+00 dV_dx=-3.522817e-06 dV_dθ=-6.573490e-05 ||∇||=3.497291e-01 | Tr=0.1047 Te/Cur=0.1159 Te/Exp=0.1908]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.72s/it] 50%|█████     | 1/2 [00:05<00:03,  3.72s/it, CE=2.283596e+00 H=2.283497e+00 dV_dx=-5.677225e-06 dV_dθ=-9.324284e-05 ||∇||=3.675474e-01 | Tr=0.0808 Te/Cur=0.0806 Te/Exp=0.1777]100%|██████████| 2/2 [00:05<00:00,  2.76s/it, CE=2.283596e+00 H=2.283497e+00 dV_dx=-5.677225e-06 dV_dθ=-9.324284e-05 ||∇||=3.675474e-01 | Tr=0.0808 Te/Cur=0.0806 Te/Exp=0.1777]100%|██████████| 2/2 [00:05<00:00,  2.91s/it, CE=2.283596e+00 H=2.283497e+00 dV_dx=-5.677225e-06 dV_dθ=-9.324284e-05 ||∇||=3.675474e-01 | Tr=0.0808 Te/Cur=0.0806 Te/Exp=0.1777]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.278138e+00 H=2.278037e+00 dV_dx=-4.692194e-06 dV_dθ=-9.632879e-05 ||∇||=3.689839e-01 | Tr=0.1366 Te/Cur=0.1394 Te/Exp=0.1843]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.278138e+00 H=2.278037e+00 dV_dx=-4.692194e-06 dV_dθ=-9.632879e-05 ||∇||=3.689839e-01 | Tr=0.1366 Te/Cur=0.1394 Te/Exp=0.1843]100%|██████████| 2/2 [00:05<00:00,  2.75s/it, CE=2.278138e+00 H=2.278037e+00 dV_dx=-4.692194e-06 dV_dθ=-9.632879e-05 ||∇||=3.689839e-01 | Tr=0.1366 Te/Cur=0.1394 Te/Exp=0.1843]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.02s/it] 50%|█████     | 1/2 [00:06<00:05,  5.02s/it, CE=2.279643e+00 H=2.279567e+00 dV_dx=5.906530e-06 dV_dθ=-8.112807e-05 ||∇||=3.688550e-01 | Tr=0.1438 Te/Cur=0.1528 Te/Exp=0.1896]100%|██████████| 2/2 [00:06<00:00,  3.13s/it, CE=2.279643e+00 H=2.279567e+00 dV_dx=5.906530e-06 dV_dθ=-8.112807e-05 ||∇||=3.688550e-01 | Tr=0.1438 Te/Cur=0.1528 Te/Exp=0.1896]100%|██████████| 2/2 [00:06<00:00,  3.41s/it, CE=2.279643e+00 H=2.279567e+00 dV_dx=5.906530e-06 dV_dθ=-8.112807e-05 ||∇||=3.688550e-01 | Tr=0.1438 Te/Cur=0.1528 Te/Exp=0.1896]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.28s/it] 50%|█████     | 1/2 [00:05<00:03,  3.28s/it, CE=2.285755e+00 H=2.285678e+00 dV_dx=-5.770855e-06 dV_dθ=-7.048327e-05 ||∇||=3.417075e-01 | Tr=0.0710 Te/Cur=0.0802 Te/Exp=0.2081]100%|██████████| 2/2 [00:05<00:00,  2.38s/it, CE=2.285755e+00 H=2.285678e+00 dV_dx=-5.770855e-06 dV_dθ=-7.048327e-05 ||∇||=3.417075e-01 | Tr=0.0710 Te/Cur=0.0802 Te/Exp=0.2081]100%|██████████| 2/2 [00:05<00:00,  2.51s/it, CE=2.285755e+00 H=2.285678e+00 dV_dx=-5.770855e-06 dV_dθ=-7.048327e-05 ||∇||=3.417075e-01 | Tr=0.0710 Te/Cur=0.0802 Te/Exp=0.2081]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.30s/it] 50%|█████     | 1/2 [00:05<00:03,  3.30s/it, CE=2.286692e+00 H=2.286576e+00 dV_dx=-5.822932e-06 dV_dθ=-1.104614e-04 ||∇||=3.892463e-01 | Tr=0.1385 Te/Cur=0.1280 Te/Exp=0.2121]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.286692e+00 H=2.286576e+00 dV_dx=-5.822932e-06 dV_dθ=-1.104614e-04 ||∇||=3.892463e-01 | Tr=0.1385 Te/Cur=0.1280 Te/Exp=0.2121]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.286692e+00 H=2.286576e+00 dV_dx=-5.822932e-06 dV_dθ=-1.104614e-04 ||∇||=3.892463e-01 | Tr=0.1385 Te/Cur=0.1280 Te/Exp=0.2121]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.44s/it] 50%|█████     | 1/2 [00:08<00:03,  3.44s/it, CE=2.272522e+00 H=2.272441e+00 dV_dx=-2.025511e-06 dV_dθ=-7.889750e-05 ||∇||=3.639717e-01 | Tr=0.1342 Te/Cur=0.1384 Te/Exp=0.2471]100%|██████████| 2/2 [00:08<00:00,  4.35s/it, CE=2.272522e+00 H=2.272441e+00 dV_dx=-2.025511e-06 dV_dθ=-7.889750e-05 ||∇||=3.639717e-01 | Tr=0.1342 Te/Cur=0.1384 Te/Exp=0.2471]100%|██████████| 2/2 [00:08<00:00,  4.21s/it, CE=2.272522e+00 H=2.272441e+00 dV_dx=-2.025511e-06 dV_dθ=-7.889750e-05 ||∇||=3.639717e-01 | Tr=0.1342 Te/Cur=0.1384 Te/Exp=0.2471]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    No improvement found (patience: 1)
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.34s/it] 50%|█████     | 1/2 [00:05<00:03,  3.34s/it, CE=2.272465e+00 H=2.272393e+00 dV_dx=-1.480317e-05 dV_dθ=-5.715140e-05 ||∇||=4.227494e-01 | Tr=0.1301 Te/Cur=0.1277 Te/Exp=0.1595]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.272465e+00 H=2.272393e+00 dV_dx=-1.480317e-05 dV_dθ=-5.715140e-05 ||∇||=4.227494e-01 | Tr=0.1301 Te/Cur=0.1277 Te/Exp=0.1595]100%|██████████| 2/2 [00:05<00:00,  2.67s/it, CE=2.272465e+00 H=2.272393e+00 dV_dx=-1.480317e-05 dV_dθ=-5.715140e-05 ||∇||=4.227494e-01 | Tr=0.1301 Te/Cur=0.1277 Te/Exp=0.1595]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2724646188213713
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.21s/it] 50%|█████     | 1/2 [00:04<00:03,  3.21s/it, CE=2.277539e+00 H=2.277533e+00 dV_dx=7.268308e-06 dV_dθ=-1.347119e-05 ||∇||=4.022140e-01 | Tr=0.1319 Te/Cur=0.1778 Te/Exp=0.1943]100%|██████████| 2/2 [00:04<00:00,  2.33s/it, CE=2.277539e+00 H=2.277533e+00 dV_dx=7.268308e-06 dV_dθ=-1.347119e-05 ||∇||=4.022140e-01 | Tr=0.1319 Te/Cur=0.1778 Te/Exp=0.1943]100%|██████████| 2/2 [00:04<00:00,  2.46s/it, CE=2.277539e+00 H=2.277533e+00 dV_dx=7.268308e-06 dV_dθ=-1.347119e-05 ||∇||=4.022140e-01 | Tr=0.1319 Te/Cur=0.1778 Te/Exp=0.1943]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.39s/it] 50%|█████     | 1/2 [00:06<00:05,  5.39s/it, CE=2.272956e+00 H=2.272892e+00 dV_dx=9.265086e-06 dV_dθ=-7.256907e-05 ||∇||=4.083999e-01 | Tr=0.1830 Te/Cur=0.2109 Te/Exp=0.1884]100%|██████████| 2/2 [00:06<00:00,  3.12s/it, CE=2.272956e+00 H=2.272892e+00 dV_dx=9.265086e-06 dV_dθ=-7.256907e-05 ||∇||=4.083999e-01 | Tr=0.1830 Te/Cur=0.2109 Te/Exp=0.1884]100%|██████████| 2/2 [00:06<00:00,  3.46s/it, CE=2.272956e+00 H=2.272892e+00 dV_dx=9.265086e-06 dV_dθ=-7.256907e-05 ||∇||=4.083999e-01 | Tr=0.1830 Te/Cur=0.2109 Te/Exp=0.1884]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.67s/it] 50%|█████     | 1/2 [00:05<00:03,  3.67s/it, CE=2.265678e+00 H=2.265552e+00 dV_dx=-1.795883e-05 dV_dθ=-1.080597e-04 ||∇||=5.185570e-01 | Tr=0.1587 Te/Cur=0.1983 Te/Exp=0.2393]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.265678e+00 H=2.265552e+00 dV_dx=-1.795883e-05 dV_dθ=-1.080597e-04 ||∇||=5.185570e-01 | Tr=0.1587 Te/Cur=0.1983 Te/Exp=0.2393]100%|██████████| 2/2 [00:05<00:00,  2.75s/it, CE=2.265678e+00 H=2.265552e+00 dV_dx=-1.795883e-05 dV_dθ=-1.080597e-04 ||∇||=5.185570e-01 | Tr=0.1587 Te/Cur=0.1983 Te/Exp=0.2393]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 164, 10]) with loss 2.265678
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.69s/it] 50%|█████     | 1/2 [00:05<00:03,  3.69s/it, CE=2.275761e+00 H=2.275732e+00 dV_dx=2.673827e-06 dV_dθ=-3.232909e-05 ||∇||=4.080053e-01 | Tr=0.1390 Te/Cur=0.1678 Te/Exp=0.2017]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.275761e+00 H=2.275732e+00 dV_dx=2.673827e-06 dV_dθ=-3.232909e-05 ||∇||=4.080053e-01 | Tr=0.1390 Te/Cur=0.1678 Te/Exp=0.2017]100%|██████████| 2/2 [00:05<00:00,  2.77s/it, CE=2.275761e+00 H=2.275732e+00 dV_dx=2.673827e-06 dV_dθ=-3.232909e-05 ||∇||=4.080053e-01 | Tr=0.1390 Te/Cur=0.1678 Te/Exp=0.2017]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.17s/it] 50%|█████     | 1/2 [00:07<00:05,  5.17s/it, CE=2.265832e+00 H=2.265783e+00 dV_dx=-7.321450e-06 dV_dθ=-4.248050e-05 ||∇||=4.329513e-01 | Tr=0.1305 Te/Cur=0.1376 Te/Exp=0.1706]100%|██████████| 2/2 [00:07<00:00,  3.27s/it, CE=2.265832e+00 H=2.265783e+00 dV_dx=-7.321450e-06 dV_dθ=-4.248050e-05 ||∇||=4.329513e-01 | Tr=0.1305 Te/Cur=0.1376 Te/Exp=0.1706]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.265832e+00 H=2.265783e+00 dV_dx=-7.321450e-06 dV_dθ=-4.248050e-05 ||∇||=4.329513e-01 | Tr=0.1305 Te/Cur=0.1376 Te/Exp=0.1706]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.95s/it] 50%|█████     | 1/2 [00:06<00:04,  4.95s/it, CE=2.276006e+00 H=2.275954e+00 dV_dx=7.405497e-07 dV_dθ=-5.228962e-05 ||∇||=4.773008e-01 | Tr=0.1261 Te/Cur=0.1085 Te/Exp=0.2072]100%|██████████| 2/2 [00:06<00:00,  3.16s/it, CE=2.276006e+00 H=2.275954e+00 dV_dx=7.405497e-07 dV_dθ=-5.228962e-05 ||∇||=4.773008e-01 | Tr=0.1261 Te/Cur=0.1085 Te/Exp=0.2072]100%|██████████| 2/2 [00:06<00:00,  3.43s/it, CE=2.276006e+00 H=2.275954e+00 dV_dx=7.405497e-07 dV_dθ=-5.228962e-05 ||∇||=4.773008e-01 | Tr=0.1261 Te/Cur=0.1085 Te/Exp=0.2072]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.86s/it] 50%|█████     | 1/2 [00:07<00:05,  5.86s/it, CE=2.264215e+00 H=2.264176e+00 dV_dx=-5.418737e-07 dV_dθ=-3.930155e-05 ||∇||=4.634449e-01 | Tr=0.1915 Te/Cur=0.1816 Te/Exp=0.2354]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.264215e+00 H=2.264176e+00 dV_dx=-5.418737e-07 dV_dθ=-3.930155e-05 ||∇||=4.634449e-01 | Tr=0.1915 Te/Cur=0.1816 Te/Exp=0.2354]100%|██████████| 2/2 [00:07<00:00,  3.90s/it, CE=2.264215e+00 H=2.264176e+00 dV_dx=-5.418737e-07 dV_dθ=-3.930155e-05 ||∇||=4.634449e-01 | Tr=0.1915 Te/Cur=0.1816 Te/Exp=0.2354]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 204, 10]) with loss 2.264215
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.99s/it] 50%|█████     | 1/2 [00:07<00:04,  4.99s/it, CE=2.274836e+00 H=2.274798e+00 dV_dx=-6.524791e-07 dV_dθ=-3.743707e-05 ||∇||=4.359198e-01 | Tr=0.1386 Te/Cur=0.1520 Te/Exp=0.1613]100%|██████████| 2/2 [00:07<00:00,  3.32s/it, CE=2.274836e+00 H=2.274798e+00 dV_dx=-6.524791e-07 dV_dθ=-3.743707e-05 ||∇||=4.359198e-01 | Tr=0.1386 Te/Cur=0.1520 Te/Exp=0.1613]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.274836e+00 H=2.274798e+00 dV_dx=-6.524791e-07 dV_dθ=-3.743707e-05 ||∇||=4.359198e-01 | Tr=0.1386 Te/Cur=0.1520 Te/Exp=0.1613]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.64s/it] 50%|█████     | 1/2 [00:09<00:07,  7.64s/it, CE=2.276454e+00 H=2.276421e+00 dV_dx=6.102914e-06 dV_dθ=-3.852213e-05 ||∇||=3.527060e-01 | Tr=0.1121 Te/Cur=0.1137 Te/Exp=0.2316]100%|██████████| 2/2 [00:09<00:00,  4.34s/it, CE=2.276454e+00 H=2.276421e+00 dV_dx=6.102914e-06 dV_dθ=-3.852213e-05 ||∇||=3.527060e-01 | Tr=0.1121 Te/Cur=0.1137 Te/Exp=0.2316]100%|██████████| 2/2 [00:09<00:00,  4.83s/it, CE=2.276454e+00 H=2.276421e+00 dV_dx=6.102914e-06 dV_dθ=-3.852213e-05 ||∇||=3.527060e-01 | Tr=0.1121 Te/Cur=0.1137 Te/Exp=0.2316]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.51s/it] 50%|█████     | 1/2 [00:05<00:03,  3.51s/it, CE=2.290446e+00 H=2.290356e+00 dV_dx=-5.880941e-06 dV_dθ=-8.441558e-05 ||∇||=3.876024e-01 | Tr=0.0961 Te/Cur=0.0703 Te/Exp=0.2146]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.290446e+00 H=2.290356e+00 dV_dx=-5.880941e-06 dV_dθ=-8.441558e-05 ||∇||=3.876024e-01 | Tr=0.0961 Te/Cur=0.0703 Te/Exp=0.2146]100%|██████████| 2/2 [00:05<00:00,  2.72s/it, CE=2.290446e+00 H=2.290356e+00 dV_dx=-5.880941e-06 dV_dθ=-8.441558e-05 ||∇||=3.876024e-01 | Tr=0.0961 Te/Cur=0.0703 Te/Exp=0.2146]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.43s/it] 50%|█████     | 1/2 [00:08<00:06,  6.43s/it, CE=2.282325e+00 H=2.282293e+00 dV_dx=8.612785e-06 dV_dθ=-4.102108e-05 ||∇||=3.353601e-01 | Tr=0.1306 Te/Cur=0.1386 Te/Exp=0.2387]100%|██████████| 2/2 [00:08<00:00,  3.70s/it, CE=2.282325e+00 H=2.282293e+00 dV_dx=8.612785e-06 dV_dθ=-4.102108e-05 ||∇||=3.353601e-01 | Tr=0.1306 Te/Cur=0.1386 Te/Exp=0.2387]100%|██████████| 2/2 [00:08<00:00,  4.11s/it, CE=2.282325e+00 H=2.282293e+00 dV_dx=8.612785e-06 dV_dθ=-4.102108e-05 ||∇||=3.353601e-01 | Tr=0.1306 Te/Cur=0.1386 Te/Exp=0.2387]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.11s/it] 50%|█████     | 1/2 [00:04<00:03,  3.11s/it, CE=2.281574e+00 H=2.281528e+00 dV_dx=2.595423e-06 dV_dθ=-4.791959e-05 ||∇||=3.463993e-01 | Tr=0.1252 Te/Cur=0.1086 Te/Exp=0.1886]100%|██████████| 2/2 [00:04<00:00,  2.30s/it, CE=2.281574e+00 H=2.281528e+00 dV_dx=2.595423e-06 dV_dθ=-4.791959e-05 ||∇||=3.463993e-01 | Tr=0.1252 Te/Cur=0.1086 Te/Exp=0.1886]100%|██████████| 2/2 [00:04<00:00,  2.42s/it, CE=2.281574e+00 H=2.281528e+00 dV_dx=2.595423e-06 dV_dθ=-4.791959e-05 ||∇||=3.463993e-01 | Tr=0.1252 Te/Cur=0.1086 Te/Exp=0.1886]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.53s/it] 50%|█████     | 1/2 [00:05<00:03,  3.53s/it, CE=2.274157e+00 H=2.274103e+00 dV_dx=-4.953018e-06 dV_dθ=-4.860241e-05 ||∇||=3.734276e-01 | Tr=0.1437 Te/Cur=0.1570 Te/Exp=0.2217]100%|██████████| 2/2 [00:05<00:00,  2.41s/it, CE=2.274157e+00 H=2.274103e+00 dV_dx=-4.953018e-06 dV_dθ=-4.860241e-05 ||∇||=3.734276e-01 | Tr=0.1437 Te/Cur=0.1570 Te/Exp=0.2217]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.274157e+00 H=2.274103e+00 dV_dx=-4.953018e-06 dV_dθ=-4.860241e-05 ||∇||=3.734276e-01 | Tr=0.1437 Te/Cur=0.1570 Te/Exp=0.2217]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.79s/it] 50%|█████     | 1/2 [00:06<00:04,  4.79s/it, CE=2.278429e+00 H=2.278403e+00 dV_dx=9.769591e-07 dV_dθ=-2.782286e-05 ||∇||=3.425164e-01 | Tr=0.1214 Te/Cur=0.1540 Te/Exp=0.1869]100%|██████████| 2/2 [00:06<00:00,  2.92s/it, CE=2.278429e+00 H=2.278403e+00 dV_dx=9.769591e-07 dV_dθ=-2.782286e-05 ||∇||=3.425164e-01 | Tr=0.1214 Te/Cur=0.1540 Te/Exp=0.1869]100%|██████████| 2/2 [00:06<00:00,  3.20s/it, CE=2.278429e+00 H=2.278403e+00 dV_dx=9.769591e-07 dV_dθ=-2.782286e-05 ||∇||=3.425164e-01 | Tr=0.1214 Te/Cur=0.1540 Te/Exp=0.1869]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.97s/it] 50%|█████     | 1/2 [00:06<00:04,  4.97s/it, CE=2.283337e+00 H=2.283280e+00 dV_dx=-4.277770e-06 dV_dθ=-5.226622e-05 ||∇||=3.439979e-01 | Tr=0.1249 Te/Cur=0.1596 Te/Exp=0.1775]100%|██████████| 2/2 [00:06<00:00,  3.11s/it, CE=2.283337e+00 H=2.283280e+00 dV_dx=-4.277770e-06 dV_dθ=-5.226622e-05 ||∇||=3.439979e-01 | Tr=0.1249 Te/Cur=0.1596 Te/Exp=0.1775]100%|██████████| 2/2 [00:06<00:00,  3.38s/it, CE=2.283337e+00 H=2.283280e+00 dV_dx=-4.277770e-06 dV_dθ=-5.226622e-05 ||∇||=3.439979e-01 | Tr=0.1249 Te/Cur=0.1596 Te/Exp=0.1775]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.18s/it] 50%|█████     | 1/2 [00:07<00:05,  5.18s/it, CE=2.272574e+00 H=2.272532e+00 dV_dx=2.483374e-05 dV_dθ=-6.614757e-05 ||∇||=3.810484e-01 | Tr=0.1366 Te/Cur=0.1479 Te/Exp=0.1795]100%|██████████| 2/2 [00:07<00:00,  3.47s/it, CE=2.272574e+00 H=2.272532e+00 dV_dx=2.483374e-05 dV_dθ=-6.614757e-05 ||∇||=3.810484e-01 | Tr=0.1366 Te/Cur=0.1479 Te/Exp=0.1795]100%|██████████| 2/2 [00:07<00:00,  3.73s/it, CE=2.272574e+00 H=2.272532e+00 dV_dx=2.483374e-05 dV_dθ=-6.614757e-05 ||∇||=3.810484e-01 | Tr=0.1366 Te/Cur=0.1479 Te/Exp=0.1795]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.13s/it] 50%|█████     | 1/2 [00:06<00:05,  5.13s/it, CE=2.278097e+00 H=2.278020e+00 dV_dx=-1.455480e-06 dV_dθ=-7.606856e-05 ||∇||=4.108545e-01 | Tr=0.0801 Te/Cur=0.0946 Te/Exp=0.1933]100%|██████████| 2/2 [00:06<00:00,  3.11s/it, CE=2.278097e+00 H=2.278020e+00 dV_dx=-1.455480e-06 dV_dθ=-7.606856e-05 ||∇||=4.108545e-01 | Tr=0.0801 Te/Cur=0.0946 Te/Exp=0.1933]100%|██████████| 2/2 [00:06<00:00,  3.41s/it, CE=2.278097e+00 H=2.278020e+00 dV_dx=-1.455480e-06 dV_dθ=-7.606856e-05 ||∇||=4.108545e-01 | Tr=0.0801 Te/Cur=0.0946 Te/Exp=0.1933]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.76s/it] 50%|█████     | 1/2 [00:08<00:06,  6.76s/it, CE=2.279171e+00 H=2.279134e+00 dV_dx=1.228006e-05 dV_dθ=-4.870669e-05 ||∇||=3.226350e-01 | Tr=0.1329 Te/Cur=0.1547 Te/Exp=0.2004]100%|██████████| 2/2 [00:08<00:00,  3.90s/it, CE=2.279171e+00 H=2.279134e+00 dV_dx=1.228006e-05 dV_dθ=-4.870669e-05 ||∇||=3.226350e-01 | Tr=0.1329 Te/Cur=0.1547 Te/Exp=0.2004]100%|██████████| 2/2 [00:08<00:00,  4.33s/it, CE=2.279171e+00 H=2.279134e+00 dV_dx=1.228006e-05 dV_dθ=-4.870669e-05 ||∇||=3.226350e-01 | Tr=0.1329 Te/Cur=0.1547 Te/Exp=0.2004]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.03s/it] 50%|█████     | 1/2 [00:06<00:04,  4.03s/it, CE=2.280127e+00 H=2.280050e+00 dV_dx=-1.529448e-06 dV_dθ=-7.641538e-05 ||∇||=3.662756e-01 | Tr=0.1040 Te/Cur=0.1347 Te/Exp=0.2012]100%|██████████| 2/2 [00:06<00:00,  2.88s/it, CE=2.280127e+00 H=2.280050e+00 dV_dx=-1.529448e-06 dV_dθ=-7.641538e-05 ||∇||=3.662756e-01 | Tr=0.1040 Te/Cur=0.1347 Te/Exp=0.2012]100%|██████████| 2/2 [00:06<00:00,  3.05s/it, CE=2.280127e+00 H=2.280050e+00 dV_dx=-1.529448e-06 dV_dθ=-7.641538e-05 ||∇||=3.662756e-01 | Tr=0.1040 Te/Cur=0.1347 Te/Exp=0.2012]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.79s/it] 50%|█████     | 1/2 [00:07<00:05,  5.79s/it, CE=2.263862e+00 H=2.263801e+00 dV_dx=-5.136338e-06 dV_dθ=-5.636617e-05 ||∇||=3.634945e-01 | Tr=0.1133 Te/Cur=0.1311 Te/Exp=0.2099]100%|██████████| 2/2 [00:07<00:00,  3.32s/it, CE=2.263862e+00 H=2.263801e+00 dV_dx=-5.136338e-06 dV_dθ=-5.636617e-05 ||∇||=3.634945e-01 | Tr=0.1133 Te/Cur=0.1311 Te/Exp=0.2099]100%|██████████| 2/2 [00:07<00:00,  3.69s/it, CE=2.263862e+00 H=2.263801e+00 dV_dx=-5.136338e-06 dV_dθ=-5.636617e-05 ||∇||=3.634945e-01 | Tr=0.1133 Te/Cur=0.1311 Te/Exp=0.2099]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 692, 124, 10]) with loss 2.263862
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.31s/it] 50%|█████     | 1/2 [00:05<00:03,  3.31s/it, CE=2.269457e+00 H=2.269429e+00 dV_dx=8.797086e-06 dV_dθ=-3.689273e-05 ||∇||=3.588660e-01 | Tr=0.1734 Te/Cur=0.1759 Te/Exp=0.2151]100%|██████████| 2/2 [00:05<00:00,  2.37s/it, CE=2.269457e+00 H=2.269429e+00 dV_dx=8.797086e-06 dV_dθ=-3.689273e-05 ||∇||=3.588660e-01 | Tr=0.1734 Te/Cur=0.1759 Te/Exp=0.2151]100%|██████████| 2/2 [00:05<00:00,  2.51s/it, CE=2.269457e+00 H=2.269429e+00 dV_dx=8.797086e-06 dV_dθ=-3.689273e-05 ||∇||=3.588660e-01 | Tr=0.1734 Te/Cur=0.1759 Te/Exp=0.2151]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.58s/it] 50%|█████     | 1/2 [00:05<00:03,  3.58s/it, CE=2.270050e+00 H=2.269998e+00 dV_dx=-6.546545e-06 dV_dθ=-4.475113e-05 ||∇||=3.552690e-01 | Tr=0.1365 Te/Cur=0.1304 Te/Exp=0.2108]100%|██████████| 2/2 [00:05<00:00,  2.69s/it, CE=2.270050e+00 H=2.269998e+00 dV_dx=-6.546545e-06 dV_dθ=-4.475113e-05 ||∇||=3.552690e-01 | Tr=0.1365 Te/Cur=0.1304 Te/Exp=0.2108]100%|██████████| 2/2 [00:05<00:00,  2.83s/it, CE=2.270050e+00 H=2.269998e+00 dV_dx=-6.546545e-06 dV_dθ=-4.475113e-05 ||∇||=3.552690e-01 | Tr=0.1365 Te/Cur=0.1304 Te/Exp=0.2108]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.48s/it] 50%|█████     | 1/2 [00:08<00:06,  6.48s/it, CE=2.265017e+00 H=2.264960e+00 dV_dx=7.861521e-06 dV_dθ=-6.507996e-05 ||∇||=3.778273e-01 | Tr=0.0863 Te/Cur=0.0800 Te/Exp=0.2195]100%|██████████| 2/2 [00:08<00:00,  3.62s/it, CE=2.265017e+00 H=2.264960e+00 dV_dx=7.861521e-06 dV_dθ=-6.507996e-05 ||∇||=3.778273e-01 | Tr=0.0863 Te/Cur=0.0800 Te/Exp=0.2195]100%|██████████| 2/2 [00:08<00:00,  4.05s/it, CE=2.265017e+00 H=2.264960e+00 dV_dx=7.861521e-06 dV_dθ=-6.507996e-05 ||∇||=3.778273e-01 | Tr=0.0863 Te/Cur=0.0800 Te/Exp=0.2195]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.70s/it] 50%|█████     | 1/2 [00:06<00:04,  4.70s/it, CE=2.269628e+00 H=2.269583e+00 dV_dx=1.178341e-06 dV_dθ=-4.605646e-05 ||∇||=3.567491e-01 | Tr=0.1003 Te/Cur=0.1122 Te/Exp=0.2364]100%|██████████| 2/2 [00:06<00:00,  2.76s/it, CE=2.269628e+00 H=2.269583e+00 dV_dx=1.178341e-06 dV_dθ=-4.605646e-05 ||∇||=3.567491e-01 | Tr=0.1003 Te/Cur=0.1122 Te/Exp=0.2364]100%|██████████| 2/2 [00:06<00:00,  3.05s/it, CE=2.269628e+00 H=2.269583e+00 dV_dx=1.178341e-06 dV_dθ=-4.605646e-05 ||∇||=3.567491e-01 | Tr=0.1003 Te/Cur=0.1122 Te/Exp=0.2364]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.73s/it] 50%|█████     | 1/2 [00:06<00:04,  4.73s/it, CE=2.268092e+00 H=2.268041e+00 dV_dx=2.267865e-07 dV_dθ=-5.099918e-05 ||∇||=3.617660e-01 | Tr=0.1046 Te/Cur=0.1218 Te/Exp=0.2345]100%|██████████| 2/2 [00:06<00:00,  2.95s/it, CE=2.268092e+00 H=2.268041e+00 dV_dx=2.267865e-07 dV_dθ=-5.099918e-05 ||∇||=3.617660e-01 | Tr=0.1046 Te/Cur=0.1218 Te/Exp=0.2345]100%|██████████| 2/2 [00:06<00:00,  3.22s/it, CE=2.268092e+00 H=2.268041e+00 dV_dx=2.267865e-07 dV_dθ=-5.099918e-05 ||∇||=3.617660e-01 | Tr=0.1046 Te/Cur=0.1218 Te/Exp=0.2345]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.75s/it] 50%|█████     | 1/2 [00:06<00:04,  4.75s/it, CE=2.258383e+00 H=2.258323e+00 dV_dx=-7.627872e-06 dV_dθ=-5.187371e-05 ||∇||=3.633944e-01 | Tr=0.1155 Te/Cur=0.1228 Te/Exp=0.2770]100%|██████████| 2/2 [00:06<00:00,  2.99s/it, CE=2.258383e+00 H=2.258323e+00 dV_dx=-7.627872e-06 dV_dθ=-5.187371e-05 ||∇||=3.633944e-01 | Tr=0.1155 Te/Cur=0.1228 Te/Exp=0.2770]100%|██████████| 2/2 [00:06<00:00,  3.25s/it, CE=2.258383e+00 H=2.258323e+00 dV_dx=-7.627872e-06 dV_dθ=-5.187371e-05 ||∇||=3.633944e-01 | Tr=0.1155 Te/Cur=0.1228 Te/Exp=0.2770]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 692, 204, 10]) with loss 2.258383
  Grid search complete.
  Best architecture: (4, [432, 692, 204, 10]) with loss 2.258383
  Total candidates evaluated: 54
  Original: (2, [507, 652, 164, 10])
  Optimal: (4, [432, 692, 204, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→4, feed [507, 652, 164, 10]→[432, 692, 204, 10]
  Conv filter changed: A_conv/B_conv shape = (4, 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:16<05:18, 16.74s/it]  5%|▌         | 1/20 [00:19<05:18, 16.74s/it, CE=3.001095e+00 H=2.911997e+00 dV_dx=2.305210e-05 dV_dθ=-8.912060e-02 ||∇||=1.888895e+01 | Tr=0.8400] 10%|█         | 2/20 [00:19<02:30,  8.36s/it, CE=3.001095e+00 H=2.911997e+00 dV_dx=2.305210e-05 dV_dθ=-8.912060e-02 ||∇||=1.888895e+01 | Tr=0.8400] 10%|█         | 2/20 [00:21<02:30,  8.36s/it, CE=2.290247e+00 H=2.054865e+00 dV_dx=3.215282e-05 dV_dθ=-2.354145e-01 ||∇||=1.942778e+01 | Tr=0.8400] 15%|█▌        | 3/20 [00:21<01:37,  5.72s/it, CE=2.290247e+00 H=2.054865e+00 dV_dx=3.215282e-05 dV_dθ=-2.354145e-01 ||∇||=1.942778e+01 | Tr=0.8400] 15%|█▌        | 3/20 [00:24<01:37,  5.72s/it, CE=2.016537e+00 H=1.655077e+00 dV_dx=-1.047228e-06 dV_dθ=-3.614592e-01 ||∇||=2.253026e+01 | Tr=0.8400] 20%|██        | 4/20 [00:24<01:10,  4.38s/it, CE=2.016537e+00 H=1.655077e+00 dV_dx=-1.047228e-06 dV_dθ=-3.614592e-01 ||∇||=2.253026e+01 | Tr=0.8400] 20%|██        | 4/20 [00:26<01:10,  4.38s/it, CE=1.844601e+00 H=1.343448e+00 dV_dx=1.579664e-05 dV_dθ=-5.011693e-01 ||∇||=2.362781e+01 | Tr=0.8400]  25%|██▌       | 5/20 [00:26<00:54,  3.66s/it, CE=1.844601e+00 H=1.343448e+00 dV_dx=1.579664e-05 dV_dθ=-5.011693e-01 ||∇||=2.362781e+01 | Tr=0.8400] 25%|██▌       | 5/20 [00:29<00:54,  3.66s/it, CE=1.724593e+00 H=9.150118e-01 dV_dx=-5.959287e-05 dV_dθ=-8.095215e-01 ||∇||=2.717315e+01 | Tr=0.8400] 30%|███       | 6/20 [00:29<00:48,  3.48s/it, CE=1.724593e+00 H=9.150118e-01 dV_dx=-5.959287e-05 dV_dθ=-8.095215e-01 ||∇||=2.717315e+01 | Tr=0.8400] 30%|███       | 6/20 [00:32<00:48,  3.48s/it, CE=1.626221e+00 H=6.719008e-01 dV_dx=-3.304403e-05 dV_dθ=-9.542868e-01 ||∇||=2.913685e+01 | Tr=0.8400] 35%|███▌      | 7/20 [00:32<00:41,  3.16s/it, CE=1.626221e+00 H=6.719008e-01 dV_dx=-3.304403e-05 dV_dθ=-9.542868e-01 ||∇||=2.913685e+01 | Tr=0.8400] 35%|███▌      | 7/20 [00:34<00:41,  3.16s/it, CE=1.544811e+00 H=4.492078e-01 dV_dx=6.190251e-05 dV_dθ=-1.095665e+00 ||∇||=3.137148e+01 | Tr=0.8400]  40%|████      | 8/20 [00:34<00:35,  2.92s/it, CE=1.544811e+00 H=4.492078e-01 dV_dx=6.190251e-05 dV_dθ=-1.095665e+00 ||∇||=3.137148e+01 | Tr=0.8400] 40%|████      | 8/20 [00:36<00:35,  2.92s/it, CE=1.467037e+00 H=6.954977e-01 dV_dx=3.743704e-05 dV_dθ=-7.715773e-01 ||∇||=2.557149e+01 | Tr=0.8400] 45%|████▌     | 9/20 [00:36<00:29,  2.69s/it, CE=1.467037e+00 H=6.954977e-01 dV_dx=3.743704e-05 dV_dθ=-7.715773e-01 ||∇||=2.557149e+01 | Tr=0.8400] 45%|████▌     | 9/20 [00:38<00:29,  2.69s/it, CE=1.398419e+00 H=8.361878e-01 dV_dx=-1.022799e-04 dV_dθ=-5.621285e-01 ||∇||=2.255754e+01 | Tr=0.8400] 50%|█████     | 10/20 [00:38<00:25,  2.51s/it, CE=1.398419e+00 H=8.361878e-01 dV_dx=-1.022799e-04 dV_dθ=-5.621285e-01 ||∇||=2.255754e+01 | Tr=0.8400] 50%|█████     | 10/20 [00:41<00:25,  2.51s/it, CE=1.339766e+00 H=7.952242e-01 dV_dx=1.811359e-06 dV_dθ=-5.445440e-01 ||∇||=2.213836e+01 | Tr=0.8400]  55%|█████▌    | 11/20 [00:41<00:21,  2.42s/it, CE=1.339766e+00 H=7.952242e-01 dV_dx=1.811359e-06 dV_dθ=-5.445440e-01 ||∇||=2.213836e+01 | Tr=0.8400] 55%|█████▌    | 11/20 [00:43<00:21,  2.42s/it, CE=1.284780e+00 H=8.398259e-01 dV_dx=-1.609940e-06 dV_dθ=-4.449528e-01 ||∇||=2.055345e+01 | Tr=0.8400] 60%|██████    | 12/20 [00:43<00:19,  2.47s/it, CE=1.284780e+00 H=8.398259e-01 dV_dx=-1.609940e-06 dV_dθ=-4.449528e-01 ||∇||=2.055345e+01 | Tr=0.8400] 60%|██████    | 12/20 [00:46<00:19,  2.47s/it, CE=1.234663e+00 H=8.430741e-01 dV_dx=-1.037581e-04 dV_dθ=-3.914853e-01 ||∇||=1.952660e+01 | Tr=0.8400] 65%|██████▌   | 13/20 [00:46<00:17,  2.51s/it, CE=1.234663e+00 H=8.430741e-01 dV_dx=-1.037581e-04 dV_dθ=-3.914853e-01 ||∇||=1.952660e+01 | Tr=0.8400] 65%|██████▌   | 13/20 [00:48<00:17,  2.51s/it, CE=1.190223e+00 H=8.026184e-01 dV_dx=5.402087e-05 dV_dθ=-3.876588e-01 ||∇||=1.934042e+01 | Tr=0.8400]  70%|███████   | 14/20 [00:48<00:14,  2.40s/it, CE=1.190223e+00 H=8.026184e-01 dV_dx=5.402087e-05 dV_dθ=-3.876588e-01 ||∇||=1.934042e+01 | Tr=0.8400] 70%|███████   | 14/20 [00:50<00:14,  2.40s/it, CE=1.148353e+00 H=7.795972e-01 dV_dx=-2.985401e-06 dV_dθ=-3.687528e-01 ||∇||=1.864679e+01 | Tr=0.8400] 75%|███████▌  | 15/20 [00:50<00:12,  2.43s/it, CE=1.148353e+00 H=7.795972e-01 dV_dx=-2.985401e-06 dV_dθ=-3.687528e-01 ||∇||=1.864679e+01 | Tr=0.8400] 75%|███████▌  | 15/20 [00:53<00:12,  2.43s/it, CE=1.109988e+00 H=7.284106e-01 dV_dx=4.909325e-05 dV_dθ=-3.816261e-01 ||∇||=1.854670e+01 | Tr=0.8400]  80%|████████  | 16/20 [00:53<00:09,  2.49s/it, CE=1.109988e+00 H=7.284106e-01 dV_dx=4.909325e-05 dV_dθ=-3.816261e-01 ||∇||=1.854670e+01 | Tr=0.8400] 80%|████████  | 16/20 [00:55<00:09,  2.49s/it, CE=1.074515e+00 H=7.260823e-01 dV_dx=-3.236845e-05 dV_dθ=-3.484002e-01 ||∇||=1.786003e+01 | Tr=0.8400] 85%|████████▌ | 17/20 [00:55<00:07,  2.44s/it, CE=1.074515e+00 H=7.260823e-01 dV_dx=-3.236845e-05 dV_dθ=-3.484002e-01 ||∇||=1.786003e+01 | Tr=0.8400] 85%|████████▌ | 17/20 [00:58<00:07,  2.44s/it, CE=1.043070e+00 H=7.230255e-01 dV_dx=-3.870581e-05 dV_dθ=-3.200061e-01 ||∇||=1.770668e+01 | Tr=0.8400] 90%|█████████ | 18/20 [00:58<00:04,  2.40s/it, CE=1.043070e+00 H=7.230255e-01 dV_dx=-3.870581e-05 dV_dθ=-3.200061e-01 ||∇||=1.770668e+01 | Tr=0.8400] 90%|█████████ | 18/20 [01:00<00:04,  2.40s/it, CE=1.013545e+00 H=7.353496e-01 dV_dx=6.441368e-06 dV_dθ=-2.782015e-01 ||∇||=1.728478e+01 | Tr=0.8400]  95%|█████████▌| 19/20 [01:00<00:02,  2.36s/it, CE=1.013545e+00 H=7.353496e-01 dV_dx=6.441368e-06 dV_dθ=-2.782015e-01 ||∇||=1.728478e+01 | Tr=0.8400] 95%|█████████▌| 19/20 [01:04<00:02,  2.36s/it, CE=9.846288e-01 H=7.155215e-01 dV_dx=-3.835768e-05 dV_dθ=-2.690690e-01 ||∇||=1.700303e+01 | Tr=0.8400 Te/Cur=0.8584 Te/Exp=0.6329]100%|██████████| 20/20 [01:08<00:00,  4.05s/it, CE=9.846288e-01 H=7.155215e-01 dV_dx=-3.835768e-05 dV_dθ=-2.690690e-01 ||∇||=1.700303e+01 | Tr=0.8400 Te/Cur=0.8584 Te/Exp=0.6329]100%|██████████| 20/20 [01:08<00:00,  3.42s/it, CE=9.846288e-01 H=7.155215e-01 dV_dx=-3.835768e-05 dV_dθ=-2.690690e-01 ||∇||=1.700303e+01 | Tr=0.8400 Te/Cur=0.8584 Te/Exp=0.6329]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.758658
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<01:57,  6.18s/it]  5%|▌         | 1/20 [00:08<01:57,  6.18s/it, CE=9.832092e-01 H=5.059864e-01 dV_dx=-4.449254e-06 dV_dθ=-4.772183e-01 ||∇||=2.184511e+01 | Tr=0.8399] 10%|█         | 2/20 [00:08<01:14,  4.14s/it, CE=9.832092e-01 H=5.059864e-01 dV_dx=-4.449254e-06 dV_dθ=-4.772183e-01 ||∇||=2.184511e+01 | Tr=0.8399] 10%|█         | 2/20 [00:11<01:14,  4.14s/it, CE=9.497167e-01 H=5.386419e-01 dV_dx=-1.716668e-05 dV_dθ=-4.110576e-01 ||∇||=2.058816e+01 | Tr=0.8399] 15%|█▌        | 3/20 [00:11<00:55,  3.27s/it, CE=9.497167e-01 H=5.386419e-01 dV_dx=-1.716668e-05 dV_dθ=-4.110576e-01 ||∇||=2.058816e+01 | Tr=0.8399] 15%|█▌        | 3/20 [00:13<00:55,  3.27s/it, CE=9.207776e-01 H=5.600612e-01 dV_dx=1.979622e-05 dV_dθ=-3.607363e-01 ||∇||=1.944738e+01 | Tr=0.8399]  20%|██        | 4/20 [00:13<00:46,  2.89s/it, CE=9.207776e-01 H=5.600612e-01 dV_dx=1.979622e-05 dV_dθ=-3.607363e-01 ||∇||=1.944738e+01 | Tr=0.8399] 20%|██        | 4/20 [00:17<00:46,  2.89s/it, CE=8.971353e-01 H=5.969665e-01 dV_dx=-3.312951e-05 dV_dθ=-3.001356e-01 ||∇||=1.793252e+01 | Tr=0.8399] 25%|██▌       | 5/20 [00:17<00:51,  3.43s/it, CE=8.971353e-01 H=5.969665e-01 dV_dx=-3.312951e-05 dV_dθ=-3.001356e-01 ||∇||=1.793252e+01 | Tr=0.8399] 25%|██▌       | 5/20 [00:21<00:51,  3.43s/it, CE=8.771592e-01 H=5.959131e-01 dV_dx=4.571271e-05 dV_dθ=-2.812918e-01 ||∇||=1.786455e+01 | Tr=0.8399]  30%|███       | 6/20 [00:21<00:47,  3.37s/it, CE=8.771592e-01 H=5.959131e-01 dV_dx=4.571271e-05 dV_dθ=-2.812918e-01 ||∇||=1.786455e+01 | Tr=0.8399] 30%|███       | 6/20 [00:23<00:47,  3.37s/it, CE=8.540392e-01 H=5.932653e-01 dV_dx=-6.561245e-05 dV_dθ=-2.607083e-01 ||∇||=1.736542e+01 | Tr=0.8399] 35%|███▌      | 7/20 [00:23<00:40,  3.11s/it, CE=8.540392e-01 H=5.932653e-01 dV_dx=-6.561245e-05 dV_dθ=-2.607083e-01 ||∇||=1.736542e+01 | Tr=0.8399] 35%|███▌      | 7/20 [00:26<00:40,  3.11s/it, CE=8.416842e-01 H=5.520320e-01 dV_dx=3.225946e-06 dV_dθ=-2.896554e-01 ||∇||=1.817245e+01 | Tr=0.8399]  40%|████      | 8/20 [00:26<00:34,  2.89s/it, CE=8.416842e-01 H=5.520320e-01 dV_dx=3.225946e-06 dV_dθ=-2.896554e-01 ||∇||=1.817245e+01 | Tr=0.8399] 40%|████      | 8/20 [00:29<00:34,  2.89s/it, CE=8.237342e-01 H=5.431588e-01 dV_dx=3.336083e-05 dV_dθ=-2.806088e-01 ||∇||=1.793153e+01 | Tr=0.8399] 45%|████▌     | 9/20 [00:29<00:32,  3.00s/it, CE=8.237342e-01 H=5.431588e-01 dV_dx=3.336083e-05 dV_dθ=-2.806088e-01 ||∇||=1.793153e+01 | Tr=0.8399] 45%|████▌     | 9/20 [00:31<00:32,  3.00s/it, CE=8.058924e-01 H=4.954798e-01 dV_dx=4.140231e-05 dV_dθ=-3.104540e-01 ||∇||=1.865007e+01 | Tr=0.8399] 50%|█████     | 10/20 [00:31<00:28,  2.84s/it, CE=8.058924e-01 H=4.954798e-01 dV_dx=4.140231e-05 dV_dθ=-3.104540e-01 ||∇||=1.865007e+01 | Tr=0.8399] 50%|█████     | 10/20 [00:34<00:28,  2.84s/it, CE=7.894119e-01 H=5.101578e-01 dV_dx=-1.927948e-05 dV_dθ=-2.792348e-01 ||∇||=1.797454e+01 | Tr=0.8399] 55%|█████▌    | 11/20 [00:34<00:24,  2.78s/it, CE=7.894119e-01 H=5.101578e-01 dV_dx=-1.927948e-05 dV_dθ=-2.792348e-01 ||∇||=1.797454e+01 | Tr=0.8399] 55%|█████▌    | 11/20 [00:36<00:24,  2.78s/it, CE=7.792809e-01 H=4.902313e-01 dV_dx=2.758811e-05 dV_dθ=-2.890771e-01 ||∇||=1.817301e+01 | Tr=0.8399]  60%|██████    | 12/20 [00:36<00:20,  2.59s/it, CE=7.792809e-01 H=4.902313e-01 dV_dx=2.758811e-05 dV_dθ=-2.890771e-01 ||∇||=1.817301e+01 | Tr=0.8399] 60%|██████    | 12/20 [00:38<00:20,  2.59s/it, CE=7.670137e-01 H=4.571041e-01 dV_dx=9.150542e-07 dV_dθ=-3.099105e-01 ||∇||=1.824569e+01 | Tr=0.8399] 65%|██████▌   | 13/20 [00:38<00:17,  2.52s/it, CE=7.670137e-01 H=4.571041e-01 dV_dx=9.150542e-07 dV_dθ=-3.099105e-01 ||∇||=1.824569e+01 | Tr=0.8399] 65%|██████▌   | 13/20 [00:41<00:17,  2.52s/it, CE=7.391789e-01 H=4.959433e-01 dV_dx=1.943076e-05 dV_dθ=-2.432550e-01 ||∇||=1.600006e+01 | Tr=0.8399] 70%|███████   | 14/20 [00:41<00:14,  2.49s/it, CE=7.391789e-01 H=4.959433e-01 dV_dx=1.943076e-05 dV_dθ=-2.432550e-01 ||∇||=1.600006e+01 | Tr=0.8399] 70%|███████   | 14/20 [00:43<00:14,  2.49s/it, CE=7.196841e-01 H=5.013498e-01 dV_dx=-4.332298e-05 dV_dθ=-2.182910e-01 ||∇||=1.508548e+01 | Tr=0.8399] 75%|███████▌  | 15/20 [00:43<00:12,  2.45s/it, CE=7.196841e-01 H=5.013498e-01 dV_dx=-4.332298e-05 dV_dθ=-2.182910e-01 ||∇||=1.508548e+01 | Tr=0.8399] 75%|███████▌  | 15/20 [00:46<00:12,  2.45s/it, CE=7.070545e-01 H=4.989580e-01 dV_dx=-3.414737e-06 dV_dθ=-2.080931e-01 ||∇||=1.488882e+01 | Tr=0.8399] 80%|████████  | 16/20 [00:46<00:10,  2.50s/it, CE=7.070545e-01 H=4.989580e-01 dV_dx=-3.414737e-06 dV_dθ=-2.080931e-01 ||∇||=1.488882e+01 | Tr=0.8399] 80%|████████  | 16/20 [00:48<00:10,  2.50s/it, CE=6.947399e-01 H=4.730206e-01 dV_dx=-6.217912e-06 dV_dθ=-2.217131e-01 ||∇||=1.517284e+01 | Tr=0.8399] 85%|████████▌ | 17/20 [00:48<00:07,  2.40s/it, CE=6.947399e-01 H=4.730206e-01 dV_dx=-6.217912e-06 dV_dθ=-2.217131e-01 ||∇||=1.517284e+01 | Tr=0.8399] 85%|████████▌ | 17/20 [00:50<00:07,  2.40s/it, CE=6.868100e-01 H=4.108082e-01 dV_dx=-2.283087e-05 dV_dθ=-2.759790e-01 ||∇||=1.664046e+01 | Tr=0.8399] 90%|█████████ | 18/20 [00:50<00:04,  2.22s/it, CE=6.868100e-01 H=4.108082e-01 dV_dx=-2.283087e-05 dV_dθ=-2.759790e-01 ||∇||=1.664046e+01 | Tr=0.8399] 90%|█████████ | 18/20 [00:52<00:04,  2.22s/it, CE=6.841131e-01 H=3.249712e-01 dV_dx=1.106492e-05 dV_dθ=-3.591529e-01 ||∇||=1.875073e+01 | Tr=0.8399]  95%|█████████▌| 19/20 [00:52<00:02,  2.24s/it, CE=6.841131e-01 H=3.249712e-01 dV_dx=1.106492e-05 dV_dθ=-3.591529e-01 ||∇||=1.875073e+01 | Tr=0.8399] 95%|█████████▌| 19/20 [00:56<00:02,  2.24s/it, CE=6.882883e-01 H=1.814371e-01 dV_dx=7.365647e-05 dV_dθ=-5.069248e-01 ||∇||=2.233057e+01 | Tr=0.8399 Te/Cur=0.9123 Te/Exp=0.7372]100%|██████████| 20/20 [01:04<00:00,  5.12s/it, CE=6.882883e-01 H=1.814371e-01 dV_dx=7.365647e-05 dV_dθ=-5.069248e-01 ||∇||=2.233057e+01 | Tr=0.8399 Te/Cur=0.9123 Te/Exp=0.7372]100%|██████████| 20/20 [01:04<00:00,  3.22s/it, CE=6.882883e-01 H=1.814371e-01 dV_dx=7.365647e-05 dV_dθ=-5.069248e-01 ||∇||=2.233057e+01 | Tr=0.8399 Te/Cur=0.9123 Te/Exp=0.7372]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.91s/it] 50%|█████     | 1/2 [00:13<00:09,  9.91s/it, CE=6.861303e-01 H=6.774050e-01 dV_dx=-1.561387e-04 dV_dθ=-8.569095e-03 ||∇||=3.222428e+00 | Tr=0.9457 Te/Cur=0.9273 Te/Exp=0.7564]100%|██████████| 2/2 [00:13<00:00,  6.11s/it, CE=6.861303e-01 H=6.774050e-01 dV_dx=-1.561387e-04 dV_dθ=-8.569095e-03 ||∇||=3.222428e+00 | Tr=0.9457 Te/Cur=0.9273 Te/Exp=0.7564]100%|██████████| 2/2 [00:13<00:00,  6.68s/it, CE=6.861303e-01 H=6.774050e-01 dV_dx=-1.561387e-04 dV_dθ=-8.569095e-03 ||∇||=3.222428e+00 | Tr=0.9457 Te/Cur=0.9273 Te/Exp=0.7564]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:07<02:15,  7.12s/it]  5%|▌         | 1/20 [00:08<02:15,  7.12s/it, CE=6.622309e-01 H=6.524646e-01 dV_dx=-4.431665e-05 dV_dθ=-9.721980e-03 ||∇||=3.326919e+00 | Tr=0.9500] 10%|█         | 2/20 [00:08<01:12,  4.00s/it, CE=6.622309e-01 H=6.524646e-01 dV_dx=-4.431665e-05 dV_dθ=-9.721980e-03 ||∇||=3.326919e+00 | Tr=0.9500] 10%|█         | 2/20 [00:11<01:12,  4.00s/it, CE=6.412463e-01 H=6.314929e-01 dV_dx=1.164006e-04 dV_dθ=-9.869802e-03 ||∇||=3.322095e+00 | Tr=0.9523]  15%|█▌        | 3/20 [00:11<00:58,  3.41s/it, CE=6.412463e-01 H=6.314929e-01 dV_dx=1.164006e-04 dV_dθ=-9.869802e-03 ||∇||=3.322095e+00 | Tr=0.9523] 15%|█▌        | 3/20 [00:14<00:58,  3.41s/it, CE=6.231449e-01 H=6.136463e-01 dV_dx=5.765862e-05 dV_dθ=-9.556257e-03 ||∇||=3.265676e+00 | Tr=0.9541] 20%|██        | 4/20 [00:14<00:48,  3.02s/it, CE=6.231449e-01 H=6.136463e-01 dV_dx=5.765862e-05 dV_dθ=-9.556257e-03 ||∇||=3.265676e+00 | Tr=0.9541] 20%|██        | 4/20 [00:16<00:48,  3.02s/it, CE=6.073116e-01 H=5.978371e-01 dV_dx=-1.588746e-04 dV_dθ=-9.315630e-03 ||∇||=3.220375e+00 | Tr=0.9567] 25%|██▌       | 5/20 [00:16<00:42,  2.85s/it, CE=6.073116e-01 H=5.978371e-01 dV_dx=-1.588746e-04 dV_dθ=-9.315630e-03 ||∇||=3.220375e+00 | Tr=0.9567] 25%|██▌       | 5/20 [00:21<00:42,  2.85s/it, CE=5.933166e-01 H=5.838573e-01 dV_dx=6.234273e-05 dV_dθ=-9.521560e-03 ||∇||=3.209507e+00 | Tr=0.9582 Te/Cur=0.9387 Te/Exp=0.7731] 30%|███       | 6/20 [00:21<00:48,  3.49s/it, CE=5.933166e-01 H=5.838573e-01 dV_dx=6.234273e-05 dV_dθ=-9.521560e-03 ||∇||=3.209507e+00 | Tr=0.9582 Te/Cur=0.9387 Te/Exp=0.7731] 30%|███       | 6/20 [00:24<00:48,  3.49s/it, CE=5.803126e-01 H=5.713140e-01 dV_dx=2.411081e-04 dV_dθ=-9.239648e-03 ||∇||=3.175912e+00 | Tr=0.9597]                             35%|███▌      | 7/20 [00:24<00:41,  3.22s/it, CE=5.803126e-01 H=5.713140e-01 dV_dx=2.411081e-04 dV_dθ=-9.239648e-03 ||∇||=3.175912e+00 | Tr=0.9597] 35%|███▌      | 7/20 [00:26<00:41,  3.22s/it, CE=5.687765e-01 H=5.589184e-01 dV_dx=1.751032e-05 dV_dθ=-9.875641e-03 ||∇||=3.212831e+00 | Tr=0.9613] 40%|████      | 8/20 [00:26<00:36,  3.01s/it, CE=5.687765e-01 H=5.589184e-01 dV_dx=1.751032e-05 dV_dθ=-9.875641e-03 ||∇||=3.212831e+00 | Tr=0.9613] 40%|████      | 8/20 [00:28<00:36,  3.01s/it, CE=5.580124e-01 H=5.483382e-01 dV_dx=7.252139e-05 dV_dθ=-9.746780e-03 ||∇||=3.195006e+00 | Tr=0.9627] 45%|████▌     | 9/20 [00:28<00:30,  2.73s/it, CE=5.580124e-01 H=5.483382e-01 dV_dx=7.252139e-05 dV_dθ=-9.746780e-03 ||∇||=3.195006e+00 | Tr=0.9627] 45%|████▌     | 9/20 [00:30<00:30,  2.73s/it, CE=5.478762e-01 H=5.382888e-01 dV_dx=-8.550293e-05 dV_dθ=-9.501952e-03 ||∇||=3.171613e+00 | Tr=0.9638] 50%|█████     | 10/20 [00:30<00:24,  2.43s/it, CE=5.478762e-01 H=5.382888e-01 dV_dx=-8.550293e-05 dV_dθ=-9.501952e-03 ||∇||=3.171613e+00 | Tr=0.9638] 50%|█████     | 10/20 [00:34<00:24,  2.43s/it, CE=5.380624e-01 H=5.287673e-01 dV_dx=4.140878e-05 dV_dθ=-9.336509e-03 ||∇||=3.144894e+00 | Tr=0.9651 Te/Cur=0.9431 Te/Exp=0.7816] 55%|█████▌    | 11/20 [00:34<00:25,  2.88s/it, CE=5.380624e-01 H=5.287673e-01 dV_dx=4.140878e-05 dV_dθ=-9.336509e-03 ||∇||=3.144894e+00 | Tr=0.9651 Te/Cur=0.9431 Te/Exp=0.7816] 55%|█████▌    | 11/20 [00:36<00:25,  2.88s/it, CE=5.285451e-01 H=5.193086e-01 dV_dx=1.149028e-04 dV_dθ=-9.351406e-03 ||∇||=3.150398e+00 | Tr=0.9664]                             60%|██████    | 12/20 [00:36<00:20,  2.57s/it, CE=5.285451e-01 H=5.193086e-01 dV_dx=1.149028e-04 dV_dθ=-9.351406e-03 ||∇||=3.150398e+00 | Tr=0.9664] 60%|██████    | 12/20 [00:38<00:20,  2.57s/it, CE=5.198650e-01 H=5.105592e-01 dV_dx=-3.542766e-05 dV_dθ=-9.270377e-03 ||∇||=3.141643e+00 | Tr=0.9677] 65%|██████▌   | 13/20 [00:38<00:17,  2.56s/it, CE=5.198650e-01 H=5.105592e-01 dV_dx=-3.542766e-05 dV_dθ=-9.270377e-03 ||∇||=3.141643e+00 | Tr=0.9677] 65%|██████▌   | 13/20 [00:41<00:17,  2.56s/it, CE=5.113869e-01 H=5.031172e-01 dV_dx=1.159910e-04 dV_dθ=-8.385733e-03 ||∇||=3.028911e+00 | Tr=0.9686]  70%|███████   | 14/20 [00:41<00:15,  2.59s/it, CE=5.113869e-01 H=5.031172e-01 dV_dx=1.159910e-04 dV_dθ=-8.385733e-03 ||∇||=3.028911e+00 | Tr=0.9686] 70%|███████   | 14/20 [00:43<00:15,  2.59s/it, CE=5.031784e-01 H=4.952090e-01 dV_dx=2.513513e-05 dV_dθ=-7.994567e-03 ||∇||=2.985447e+00 | Tr=0.9696] 75%|███████▌  | 15/20 [00:43<00:12,  2.53s/it, CE=5.031784e-01 H=4.952090e-01 dV_dx=2.513513e-05 dV_dθ=-7.994567e-03 ||∇||=2.985447e+00 | Tr=0.9696] 75%|███████▌  | 15/20 [00:46<00:12,  2.53s/it, CE=4.956433e-01 H=4.874145e-01 dV_dx=2.608924e-06 dV_dθ=-8.231321e-03 ||∇||=3.023632e+00 | Tr=0.9706 Te/Cur=0.9491 Te/Exp=0.7878] 80%|████████  | 16/20 [00:46<00:10,  2.68s/it, CE=4.956433e-01 H=4.874145e-01 dV_dx=2.608924e-06 dV_dθ=-8.231321e-03 ||∇||=3.023632e+00 | Tr=0.9706 Te/Cur=0.9491 Te/Exp=0.7878] 80%|████████  | 16/20 [00:48<00:10,  2.68s/it, CE=4.895886e-01 H=4.799965e-01 dV_dx=2.187284e-05 dV_dθ=-9.613970e-03 ||∇||=3.156220e+00 | Tr=0.9710]                             85%|████████▌ | 17/20 [00:48<00:07,  2.45s/it, CE=4.895886e-01 H=4.799965e-01 dV_dx=2.187284e-05 dV_dθ=-9.613970e-03 ||∇||=3.156220e+00 | Tr=0.9710] 85%|████████▌ | 17/20 [00:51<00:07,  2.45s/it, CE=4.836161e-01 H=4.737909e-01 dV_dx=6.482974e-05 dV_dθ=-9.890003e-03 ||∇||=3.193589e+00 | Tr=0.9720] 90%|█████████ | 18/20 [00:51<00:05,  2.52s/it, CE=4.836161e-01 H=4.737909e-01 dV_dx=6.482974e-05 dV_dθ=-9.890003e-03 ||∇||=3.193589e+00 | Tr=0.9720] 90%|█████████ | 18/20 [00:53<00:05,  2.52s/it, CE=4.774547e-01 H=4.676623e-01 dV_dx=-5.675876e-06 dV_dθ=-9.786691e-03 ||∇||=3.206677e+00 | Tr=0.9731] 95%|█████████▌| 19/20 [00:53<00:02,  2.32s/it, CE=4.774547e-01 H=4.676623e-01 dV_dx=-5.675876e-06 dV_dθ=-9.786691e-03 ||∇||=3.206677e+00 | Tr=0.9731] 95%|█████████▌| 19/20 [00:57<00:02,  2.32s/it, CE=4.726508e-01 H=4.616971e-01 dV_dx=-1.004122e-04 dV_dθ=-1.085323e-02 ||∇||=3.321474e+00 | Tr=0.9738 Te/Cur=0.9530 Te/Exp=0.7861]100%|██████████| 20/20 [00:57<00:00,  2.76s/it, CE=4.726508e-01 H=4.616971e-01 dV_dx=-1.004122e-04 dV_dθ=-1.085323e-02 ||∇||=3.321474e+00 | Tr=0.9738 Te/Cur=0.9530 Te/Exp=0.7861]100%|██████████| 20/20 [00:57<00:00,  2.85s/it, CE=4.726508e-01 H=4.616971e-01 dV_dx=-1.004122e-04 dV_dθ=-1.085323e-02 ||∇||=3.321474e+00 | Tr=0.9738 Te/Cur=0.9530 Te/Exp=0.7861]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 8 final loss: 0.484147
======================================================================


  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.6817
    Task 1: 0.8826
    Task 2: 0.7593
    Task 3: 0.5512
    Task 4: 0.8833
    Task 5: 0.8353
    Task 6: 0.8657
    Task 7: 0.8559
    Task 8: 0.9523

============================================================
Task 9
============================================================
Initial loss on new task: 2.2374, previous: 0.4727, ratio: 4.73
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 9
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:09<?, ?it/s, CE=5.714368e-01 H=5.037340e-01 dV_dx=-3.151238e-05 dV_dθ=-6.767124e-02 ||∇||=7.416616e+00 | Tr=0.7437 Te/Cur=0.8227 Te/Exp=0.7981]100%|██████████| 1/1 [00:09<00:00,  9.02s/it, CE=5.714368e-01 H=5.037340e-01 dV_dx=-3.151238e-05 dV_dθ=-6.767124e-02 ||∇||=7.416616e+00 | Tr=0.7437 Te/Cur=0.8227 Te/Exp=0.7981]100%|██████████| 1/1 [00:09<00:00,  9.02s/it, CE=5.714368e-01 H=5.037340e-01 dV_dx=-3.151238e-05 dV_dθ=-6.767124e-02 ||∇||=7.416616e+00 | Tr=0.7437 Te/Cur=0.8227 Te/Exp=0.7981]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.571437

[STEP 2] Architecture change decision
  Current: 0.571437, Previous: 0.472651
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9418 samples from 10 classes
  Created balanced validation set: 39932 samples from 10 classes
  Starting grid architecture search for task 9
  Baseline architecture: (4, [432, 692, 204, 10])
  Baseline loss: 0.571437
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.61s/it] 50%|█████     | 1/2 [00:07<00:05,  5.61s/it, CE=2.242934e+00 H=2.242708e+00 dV_dx=-6.215065e-06 dV_dθ=-2.202785e-04 ||∇||=5.270389e-01 | Tr=0.2206 Te/Cur=0.2643 Te/Exp=0.2518]100%|██████████| 2/2 [00:07<00:00,  3.23s/it, CE=2.242934e+00 H=2.242708e+00 dV_dx=-6.215065e-06 dV_dθ=-2.202785e-04 ||∇||=5.270389e-01 | Tr=0.2206 Te/Cur=0.2643 Te/Exp=0.2518]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.242934e+00 H=2.242708e+00 dV_dx=-6.215065e-06 dV_dθ=-2.202785e-04 ||∇||=5.270389e-01 | Tr=0.2206 Te/Cur=0.2643 Te/Exp=0.2518]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.242934297496615
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.31s/it] 50%|█████     | 1/2 [00:12<00:10, 10.31s/it, CE=2.233166e+00 H=2.232970e+00 dV_dx=1.092564e-05 dV_dθ=-2.068244e-04 ||∇||=5.327983e-01 | Tr=0.2455 Te/Cur=0.2730 Te/Exp=0.2443]100%|██████████| 2/2 [00:12<00:00,  5.31s/it, CE=2.233166e+00 H=2.232970e+00 dV_dx=1.092564e-05 dV_dθ=-2.068244e-04 ||∇||=5.327983e-01 | Tr=0.2455 Te/Cur=0.2730 Te/Exp=0.2443]100%|██████████| 2/2 [00:12<00:00,  6.06s/it, CE=2.233166e+00 H=2.232970e+00 dV_dx=1.092564e-05 dV_dθ=-2.068244e-04 ||∇||=5.327983e-01 | Tr=0.2455 Te/Cur=0.2730 Te/Exp=0.2443]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 692, 184, 10]) with loss 2.233166
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.73s/it] 50%|█████     | 1/2 [00:12<00:10, 10.73s/it, CE=2.235172e+00 H=2.234979e+00 dV_dx=1.023019e-05 dV_dθ=-2.036053e-04 ||∇||=5.880196e-01 | Tr=0.2446 Te/Cur=0.3065 Te/Exp=0.2517]100%|██████████| 2/2 [00:12<00:00,  5.61s/it, CE=2.235172e+00 H=2.234979e+00 dV_dx=1.023019e-05 dV_dθ=-2.036053e-04 ||∇||=5.880196e-01 | Tr=0.2446 Te/Cur=0.3065 Te/Exp=0.2517]100%|██████████| 2/2 [00:12<00:00,  6.38s/it, CE=2.235172e+00 H=2.234979e+00 dV_dx=1.023019e-05 dV_dθ=-2.036053e-04 ||∇||=5.880196e-01 | Tr=0.2446 Te/Cur=0.3065 Te/Exp=0.2517]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.12s/it] 50%|█████     | 1/2 [00:13<00:11, 11.12s/it, CE=2.249232e+00 H=2.249060e+00 dV_dx=-1.682669e-06 dV_dθ=-1.699794e-04 ||∇||=5.324714e-01 | Tr=0.1626 Te/Cur=0.2226 Te/Exp=0.2527]100%|██████████| 2/2 [00:13<00:00,  6.05s/it, CE=2.249232e+00 H=2.249060e+00 dV_dx=-1.682669e-06 dV_dθ=-1.699794e-04 ||∇||=5.324714e-01 | Tr=0.1626 Te/Cur=0.2226 Te/Exp=0.2527]100%|██████████| 2/2 [00:13<00:00,  6.81s/it, CE=2.249232e+00 H=2.249060e+00 dV_dx=-1.682669e-06 dV_dθ=-1.699794e-04 ||∇||=5.324714e-01 | Tr=0.1626 Te/Cur=0.2226 Te/Exp=0.2527]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.55s/it] 50%|█████     | 1/2 [00:09<00:07,  7.55s/it, CE=2.229027e+00 H=2.228804e+00 dV_dx=5.972312e-06 dV_dθ=-2.284027e-04 ||∇||=6.163704e-01 | Tr=0.2263 Te/Cur=0.2506 Te/Exp=0.2914]100%|██████████| 2/2 [00:09<00:00,  4.28s/it, CE=2.229027e+00 H=2.228804e+00 dV_dx=5.972312e-06 dV_dθ=-2.284027e-04 ||∇||=6.163704e-01 | Tr=0.2263 Te/Cur=0.2506 Te/Exp=0.2914]100%|██████████| 2/2 [00:09<00:00,  4.77s/it, CE=2.229027e+00 H=2.228804e+00 dV_dx=5.972312e-06 dV_dθ=-2.284027e-04 ||∇||=6.163704e-01 | Tr=0.2263 Te/Cur=0.2506 Te/Exp=0.2914]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 692, 204, 10]) with loss 2.229027
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.82s/it] 50%|█████     | 1/2 [00:12<00:10, 10.82s/it, CE=2.225985e+00 H=2.225650e+00 dV_dx=-3.721820e-06 dV_dθ=-3.314068e-04 ||∇||=6.920304e-01 | Tr=0.2481 Te/Cur=0.2744 Te/Exp=0.2627]100%|██████████| 2/2 [00:12<00:00,  5.62s/it, CE=2.225985e+00 H=2.225650e+00 dV_dx=-3.721820e-06 dV_dθ=-3.314068e-04 ||∇||=6.920304e-01 | Tr=0.2481 Te/Cur=0.2744 Te/Exp=0.2627]100%|██████████| 2/2 [00:12<00:00,  6.40s/it, CE=2.225985e+00 H=2.225650e+00 dV_dx=-3.721820e-06 dV_dθ=-3.314068e-04 ||∇||=6.920304e-01 | Tr=0.2481 Te/Cur=0.2744 Te/Exp=0.2627]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 712, 204, 10]) with loss 2.225985
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.76s/it] 50%|█████     | 1/2 [00:11<00:09,  9.76s/it, CE=2.241434e+00 H=2.241282e+00 dV_dx=9.953055e-06 dV_dθ=-1.621848e-04 ||∇||=5.333115e-01 | Tr=0.2262 Te/Cur=0.2331 Te/Exp=0.2746]100%|██████████| 2/2 [00:11<00:00,  5.09s/it, CE=2.241434e+00 H=2.241282e+00 dV_dx=9.953055e-06 dV_dθ=-1.621848e-04 ||∇||=5.333115e-01 | Tr=0.2262 Te/Cur=0.2331 Te/Exp=0.2746]100%|██████████| 2/2 [00:11<00:00,  5.79s/it, CE=2.241434e+00 H=2.241282e+00 dV_dx=9.953055e-06 dV_dθ=-1.621848e-04 ||∇||=5.333115e-01 | Tr=0.2262 Te/Cur=0.2331 Te/Exp=0.2746]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.80s/it] 50%|█████     | 1/2 [00:12<00:09,  9.80s/it, CE=2.223714e+00 H=2.223441e+00 dV_dx=5.844595e-06 dV_dθ=-2.795925e-04 ||∇||=6.585129e-01 | Tr=0.1662 Te/Cur=0.1979 Te/Exp=0.2901]100%|██████████| 2/2 [00:12<00:00,  5.34s/it, CE=2.223714e+00 H=2.223441e+00 dV_dx=5.844595e-06 dV_dθ=-2.795925e-04 ||∇||=6.585129e-01 | Tr=0.1662 Te/Cur=0.1979 Te/Exp=0.2901]100%|██████████| 2/2 [00:12<00:00,  6.01s/it, CE=2.223714e+00 H=2.223441e+00 dV_dx=5.844595e-06 dV_dθ=-2.795925e-04 ||∇||=6.585129e-01 | Tr=0.1662 Te/Cur=0.1979 Te/Exp=0.2901]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 692, 224, 10]) with loss 2.223714
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.94s/it] 50%|█████     | 1/2 [00:11<00:09,  9.94s/it, CE=2.228976e+00 H=2.228774e+00 dV_dx=3.080684e-06 dV_dθ=-2.047532e-04 ||∇||=5.705672e-01 | Tr=0.2578 Te/Cur=0.2874 Te/Exp=0.2865]100%|██████████| 2/2 [00:11<00:00,  5.23s/it, CE=2.228976e+00 H=2.228774e+00 dV_dx=3.080684e-06 dV_dθ=-2.047532e-04 ||∇||=5.705672e-01 | Tr=0.2578 Te/Cur=0.2874 Te/Exp=0.2865]100%|██████████| 2/2 [00:11<00:00,  5.94s/it, CE=2.228976e+00 H=2.228774e+00 dV_dx=3.080684e-06 dV_dθ=-2.047532e-04 ||∇||=5.705672e-01 | Tr=0.2578 Te/Cur=0.2874 Te/Exp=0.2865]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.83s/it] 50%|█████     | 1/2 [00:07<00:05,  5.83s/it, CE=2.272353e+00 H=2.272269e+00 dV_dx=-8.278691e-06 dV_dθ=-7.553159e-05 ||∇||=3.458263e-01 | Tr=0.1664 Te/Cur=0.2038 Te/Exp=0.2187]100%|██████████| 2/2 [00:07<00:00,  3.39s/it, CE=2.272353e+00 H=2.272269e+00 dV_dx=-8.278691e-06 dV_dθ=-7.553159e-05 ||∇||=3.458263e-01 | Tr=0.1664 Te/Cur=0.2038 Te/Exp=0.2187]100%|██████████| 2/2 [00:07<00:00,  3.75s/it, CE=2.272353e+00 H=2.272269e+00 dV_dx=-8.278691e-06 dV_dθ=-7.553159e-05 ||∇||=3.458263e-01 | Tr=0.1664 Te/Cur=0.2038 Te/Exp=0.2187]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.56s/it] 50%|█████     | 1/2 [00:11<00:09,  9.56s/it, CE=2.270926e+00 H=2.270871e+00 dV_dx=1.742105e-05 dV_dθ=-7.262838e-05 ||∇||=3.724561e-01 | Tr=0.1068 Te/Cur=0.1434 Te/Exp=0.2099]100%|██████████| 2/2 [00:11<00:00,  4.98s/it, CE=2.270926e+00 H=2.270871e+00 dV_dx=1.742105e-05 dV_dθ=-7.262838e-05 ||∇||=3.724561e-01 | Tr=0.1068 Te/Cur=0.1434 Te/Exp=0.2099]100%|██████████| 2/2 [00:11<00:00,  5.66s/it, CE=2.270926e+00 H=2.270871e+00 dV_dx=1.742105e-05 dV_dθ=-7.262838e-05 ||∇||=3.724561e-01 | Tr=0.1068 Te/Cur=0.1434 Te/Exp=0.2099]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.78s/it] 50%|█████     | 1/2 [00:13<00:10, 10.78s/it, CE=2.272753e+00 H=2.272693e+00 dV_dx=1.790618e-06 dV_dθ=-6.146618e-05 ||∇||=3.990457e-01 | Tr=0.1826 Te/Cur=0.2220 Te/Exp=0.2143]100%|██████████| 2/2 [00:13<00:00,  5.76s/it, CE=2.272753e+00 H=2.272693e+00 dV_dx=1.790618e-06 dV_dθ=-6.146618e-05 ||∇||=3.990457e-01 | Tr=0.1826 Te/Cur=0.2220 Te/Exp=0.2143]100%|██████████| 2/2 [00:13<00:00,  6.51s/it, CE=2.272753e+00 H=2.272693e+00 dV_dx=1.790618e-06 dV_dθ=-6.146618e-05 ||∇||=3.990457e-01 | Tr=0.1826 Te/Cur=0.2220 Te/Exp=0.2143]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.22s/it] 50%|█████     | 1/2 [00:15<00:13, 13.22s/it, CE=2.264894e+00 H=2.264847e+00 dV_dx=8.825241e-06 dV_dθ=-5.581109e-05 ||∇||=3.485530e-01 | Tr=0.1955 Te/Cur=0.2213 Te/Exp=0.2200]100%|██████████| 2/2 [00:15<00:00,  6.62s/it, CE=2.264894e+00 H=2.264847e+00 dV_dx=8.825241e-06 dV_dθ=-5.581109e-05 ||∇||=3.485530e-01 | Tr=0.1955 Te/Cur=0.2213 Te/Exp=0.2200]100%|██████████| 2/2 [00:15<00:00,  7.61s/it, CE=2.264894e+00 H=2.264847e+00 dV_dx=8.825241e-06 dV_dθ=-5.581109e-05 ||∇||=3.485530e-01 | Tr=0.1955 Te/Cur=0.2213 Te/Exp=0.2200]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.93s/it] 50%|█████     | 1/2 [00:05<00:03,  3.93s/it, CE=2.255776e+00 H=2.255653e+00 dV_dx=-2.517534e-06 dV_dθ=-1.211146e-04 ||∇||=4.142549e-01 | Tr=0.1431 Te/Cur=0.1777 Te/Exp=0.2154]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.255776e+00 H=2.255653e+00 dV_dx=-2.517534e-06 dV_dθ=-1.211146e-04 ||∇||=4.142549e-01 | Tr=0.1431 Te/Cur=0.1777 Te/Exp=0.2154]100%|██████████| 2/2 [00:05<00:00,  2.75s/it, CE=2.255776e+00 H=2.255653e+00 dV_dx=-2.517534e-06 dV_dθ=-1.211146e-04 ||∇||=4.142549e-01 | Tr=0.1431 Te/Cur=0.1777 Te/Exp=0.2154]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.01s/it] 50%|█████     | 1/2 [00:11<00:10, 10.01s/it, CE=2.266976e+00 H=2.266866e+00 dV_dx=6.230219e-07 dV_dθ=-1.107250e-04 ||∇||=4.133117e-01 | Tr=0.2393 Te/Cur=0.2755 Te/Exp=0.2395]100%|██████████| 2/2 [00:11<00:00,  5.12s/it, CE=2.266976e+00 H=2.266866e+00 dV_dx=6.230219e-07 dV_dθ=-1.107250e-04 ||∇||=4.133117e-01 | Tr=0.2393 Te/Cur=0.2755 Te/Exp=0.2395]100%|██████████| 2/2 [00:11<00:00,  5.85s/it, CE=2.266976e+00 H=2.266866e+00 dV_dx=6.230219e-07 dV_dθ=-1.107250e-04 ||∇||=4.133117e-01 | Tr=0.2393 Te/Cur=0.2755 Te/Exp=0.2395]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.72s/it] 50%|█████     | 1/2 [00:11<00:09,  9.72s/it, CE=2.261359e+00 H=2.261287e+00 dV_dx=-1.474564e-05 dV_dθ=-5.740854e-05 ||∇||=3.549004e-01 | Tr=0.1445 Te/Cur=0.1197 Te/Exp=0.2153]100%|██████████| 2/2 [00:11<00:00,  4.94s/it, CE=2.261359e+00 H=2.261287e+00 dV_dx=-1.474564e-05 dV_dθ=-5.740854e-05 ||∇||=3.549004e-01 | Tr=0.1445 Te/Cur=0.1197 Te/Exp=0.2153]100%|██████████| 2/2 [00:11<00:00,  5.65s/it, CE=2.261359e+00 H=2.261287e+00 dV_dx=-1.474564e-05 dV_dθ=-5.740854e-05 ||∇||=3.549004e-01 | Tr=0.1445 Te/Cur=0.1197 Te/Exp=0.2153]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.37s/it] 50%|█████     | 1/2 [00:11<00:10, 10.37s/it, CE=2.263693e+00 H=2.263574e+00 dV_dx=4.951771e-06 dV_dθ=-1.240094e-04 ||∇||=4.272106e-01 | Tr=0.1306 Te/Cur=0.1551 Te/Exp=0.2271]100%|██████████| 2/2 [00:11<00:00,  5.19s/it, CE=2.263693e+00 H=2.263574e+00 dV_dx=4.951771e-06 dV_dθ=-1.240094e-04 ||∇||=4.272106e-01 | Tr=0.1306 Te/Cur=0.1551 Te/Exp=0.2271]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.263693e+00 H=2.263574e+00 dV_dx=4.951771e-06 dV_dθ=-1.240094e-04 ||∇||=4.272106e-01 | Tr=0.1306 Te/Cur=0.1551 Te/Exp=0.2271]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.96s/it] 50%|█████     | 1/2 [00:11<00:08,  8.96s/it, CE=2.270047e+00 H=2.269999e+00 dV_dx=2.164221e-05 dV_dθ=-6.913925e-05 ||∇||=3.578362e-01 | Tr=0.1072 Te/Cur=0.1327 Te/Exp=0.2174]100%|██████████| 2/2 [00:11<00:00,  4.91s/it, CE=2.270047e+00 H=2.269999e+00 dV_dx=2.164221e-05 dV_dθ=-6.913925e-05 ||∇||=3.578362e-01 | Tr=0.1072 Te/Cur=0.1327 Te/Exp=0.2174]100%|██████████| 2/2 [00:11<00:00,  5.52s/it, CE=2.270047e+00 H=2.269999e+00 dV_dx=2.164221e-05 dV_dθ=-6.913925e-05 ||∇||=3.578362e-01 | Tr=0.1072 Te/Cur=0.1327 Te/Exp=0.2174]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.86s/it] 50%|█████     | 1/2 [00:07<00:05,  5.86s/it, CE=2.267610e+00 H=2.267517e+00 dV_dx=-1.149112e-05 dV_dθ=-8.183460e-05 ||∇||=3.670475e-01 | Tr=0.1290 Te/Cur=0.1855 Te/Exp=0.2422]100%|██████████| 2/2 [00:07<00:00,  3.58s/it, CE=2.267610e+00 H=2.267517e+00 dV_dx=-1.149112e-05 dV_dθ=-8.183460e-05 ||∇||=3.670475e-01 | Tr=0.1290 Te/Cur=0.1855 Te/Exp=0.2422]100%|██████████| 2/2 [00:07<00:00,  3.92s/it, CE=2.267610e+00 H=2.267517e+00 dV_dx=-1.149112e-05 dV_dθ=-8.183460e-05 ||∇||=3.670475e-01 | Tr=0.1290 Te/Cur=0.1855 Te/Exp=0.2422]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.61s/it] 50%|█████     | 1/2 [00:12<00:10, 10.61s/it, CE=2.262610e+00 H=2.262515e+00 dV_dx=4.021443e-06 dV_dθ=-9.923350e-05 ||∇||=4.099304e-01 | Tr=0.1212 Te/Cur=0.1509 Te/Exp=0.2158]100%|██████████| 2/2 [00:12<00:00,  5.48s/it, CE=2.262610e+00 H=2.262515e+00 dV_dx=4.021443e-06 dV_dθ=-9.923350e-05 ||∇||=4.099304e-01 | Tr=0.1212 Te/Cur=0.1509 Te/Exp=0.2158]100%|██████████| 2/2 [00:12<00:00,  6.25s/it, CE=2.262610e+00 H=2.262515e+00 dV_dx=4.021443e-06 dV_dθ=-9.923350e-05 ||∇||=4.099304e-01 | Tr=0.1212 Te/Cur=0.1509 Te/Exp=0.2158]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.23s/it] 50%|█████     | 1/2 [00:11<00:10, 10.23s/it, CE=2.261366e+00 H=2.261272e+00 dV_dx=-4.375038e-06 dV_dθ=-8.957230e-05 ||∇||=3.972602e-01 | Tr=0.1504 Te/Cur=0.1967 Te/Exp=0.2379]100%|██████████| 2/2 [00:11<00:00,  5.22s/it, CE=2.261366e+00 H=2.261272e+00 dV_dx=-4.375038e-06 dV_dθ=-8.957230e-05 ||∇||=3.972602e-01 | Tr=0.1504 Te/Cur=0.1967 Te/Exp=0.2379]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.261366e+00 H=2.261272e+00 dV_dx=-4.375038e-06 dV_dθ=-8.957230e-05 ||∇||=3.972602e-01 | Tr=0.1504 Te/Cur=0.1967 Te/Exp=0.2379]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.60s/it] 50%|█████     | 1/2 [00:14<00:12, 12.60s/it, CE=2.250602e+00 H=2.250491e+00 dV_dx=-8.924558e-06 dV_dθ=-1.018325e-04 ||∇||=4.000892e-01 | Tr=0.2281 Te/Cur=0.2734 Te/Exp=0.2553]100%|██████████| 2/2 [00:14<00:00,  6.27s/it, CE=2.250602e+00 H=2.250491e+00 dV_dx=-8.924558e-06 dV_dθ=-1.018325e-04 ||∇||=4.000892e-01 | Tr=0.2281 Te/Cur=0.2734 Te/Exp=0.2553]100%|██████████| 2/2 [00:14<00:00,  7.22s/it, CE=2.250602e+00 H=2.250491e+00 dV_dx=-8.924558e-06 dV_dθ=-1.018325e-04 ||∇||=4.000892e-01 | Tr=0.2281 Te/Cur=0.2734 Te/Exp=0.2553]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.75s/it] 50%|█████     | 1/2 [00:05<00:03,  3.75s/it, CE=2.252688e+00 H=2.252611e+00 dV_dx=-1.493966e-05 dV_dθ=-6.215166e-05 ||∇||=3.973561e-01 | Tr=0.1704 Te/Cur=0.2070 Te/Exp=0.2584]100%|██████████| 2/2 [00:05<00:00,  2.70s/it, CE=2.252688e+00 H=2.252611e+00 dV_dx=-1.493966e-05 dV_dθ=-6.215166e-05 ||∇||=3.973561e-01 | Tr=0.1704 Te/Cur=0.2070 Te/Exp=0.2584]100%|██████████| 2/2 [00:05<00:00,  2.86s/it, CE=2.252688e+00 H=2.252611e+00 dV_dx=-1.493966e-05 dV_dθ=-6.215166e-05 ||∇||=3.973561e-01 | Tr=0.1704 Te/Cur=0.2070 Te/Exp=0.2584]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.75s/it] 50%|█████     | 1/2 [00:11<00:09,  9.75s/it, CE=2.247633e+00 H=2.247522e+00 dV_dx=-5.565847e-07 dV_dθ=-1.109670e-04 ||∇||=4.101935e-01 | Tr=0.1435 Te/Cur=0.1874 Te/Exp=0.2468]100%|██████████| 2/2 [00:11<00:00,  5.18s/it, CE=2.247633e+00 H=2.247522e+00 dV_dx=-5.565847e-07 dV_dθ=-1.109670e-04 ||∇||=4.101935e-01 | Tr=0.1435 Te/Cur=0.1874 Te/Exp=0.2468]100%|██████████| 2/2 [00:11<00:00,  5.87s/it, CE=2.247633e+00 H=2.247522e+00 dV_dx=-5.565847e-07 dV_dθ=-1.109670e-04 ||∇||=4.101935e-01 | Tr=0.1435 Te/Cur=0.1874 Te/Exp=0.2468]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.65s/it] 50%|█████     | 1/2 [00:11<00:09,  9.65s/it, CE=2.263155e+00 H=2.263076e+00 dV_dx=6.992758e-07 dV_dθ=-8.026751e-05 ||∇||=3.697091e-01 | Tr=0.2429 Te/Cur=0.2897 Te/Exp=0.2561]100%|██████████| 2/2 [00:11<00:00,  5.22s/it, CE=2.263155e+00 H=2.263076e+00 dV_dx=6.992758e-07 dV_dθ=-8.026751e-05 ||∇||=3.697091e-01 | Tr=0.2429 Te/Cur=0.2897 Te/Exp=0.2561]100%|██████████| 2/2 [00:11<00:00,  5.89s/it, CE=2.263155e+00 H=2.263076e+00 dV_dx=6.992758e-07 dV_dθ=-8.026751e-05 ||∇||=3.697091e-01 | Tr=0.2429 Te/Cur=0.2897 Te/Exp=0.2561]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.62s/it] 50%|█████     | 1/2 [00:11<00:09,  9.62s/it, CE=2.248950e+00 H=2.248874e+00 dV_dx=-8.174132e-06 dV_dθ=-6.767132e-05 ||∇||=3.894415e-01 | Tr=0.1826 Te/Cur=0.2125 Te/Exp=0.2651]100%|██████████| 2/2 [00:11<00:00,  5.01s/it, CE=2.248950e+00 H=2.248874e+00 dV_dx=-8.174132e-06 dV_dθ=-6.767132e-05 ||∇||=3.894415e-01 | Tr=0.1826 Te/Cur=0.2125 Te/Exp=0.2651]100%|██████████| 2/2 [00:11<00:00,  5.70s/it, CE=2.248950e+00 H=2.248874e+00 dV_dx=-8.174132e-06 dV_dθ=-6.767132e-05 ||∇||=3.894415e-01 | Tr=0.1826 Te/Cur=0.2125 Te/Exp=0.2651]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.05s/it] 50%|█████     | 1/2 [00:11<00:10, 10.05s/it, CE=2.252852e+00 H=2.252747e+00 dV_dx=3.667740e-06 dV_dθ=-1.083676e-04 ||∇||=3.992438e-01 | Tr=0.1536 Te/Cur=0.1911 Te/Exp=0.2692]100%|██████████| 2/2 [00:11<00:00,  5.19s/it, CE=2.252852e+00 H=2.252747e+00 dV_dx=3.667740e-06 dV_dθ=-1.083676e-04 ||∇||=3.992438e-01 | Tr=0.1536 Te/Cur=0.1911 Te/Exp=0.2692]100%|██████████| 2/2 [00:11<00:00,  5.92s/it, CE=2.252852e+00 H=2.252747e+00 dV_dx=3.667740e-06 dV_dθ=-1.083676e-04 ||∇||=3.992438e-01 | Tr=0.1536 Te/Cur=0.1911 Te/Exp=0.2692]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.49s/it] 50%|█████     | 1/2 [00:07<00:05,  5.49s/it, CE=2.228802e+00 H=2.228463e+00 dV_dx=1.354215e-06 dV_dθ=-3.403648e-04 ||∇||=6.636408e-01 | Tr=0.1709 Te/Cur=0.2032 Te/Exp=0.2422]100%|██████████| 2/2 [00:07<00:00,  3.19s/it, CE=2.228802e+00 H=2.228463e+00 dV_dx=1.354215e-06 dV_dθ=-3.403648e-04 ||∇||=6.636408e-01 | Tr=0.1709 Te/Cur=0.2032 Te/Exp=0.2422]100%|██████████| 2/2 [00:07<00:00,  3.53s/it, CE=2.228802e+00 H=2.228463e+00 dV_dx=1.354215e-06 dV_dθ=-3.403648e-04 ||∇||=6.636408e-01 | Tr=0.1709 Te/Cur=0.2032 Te/Exp=0.2422]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2288022829211065
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.69s/it] 50%|█████     | 1/2 [00:05<00:03,  3.69s/it, CE=2.230412e+00 H=2.230204e+00 dV_dx=-4.646353e-06 dV_dθ=-2.030041e-04 ||∇||=5.678331e-01 | Tr=0.1832 Te/Cur=0.2454 Te/Exp=0.2417]100%|██████████| 2/2 [00:05<00:00,  2.64s/it, CE=2.230412e+00 H=2.230204e+00 dV_dx=-4.646353e-06 dV_dθ=-2.030041e-04 ||∇||=5.678331e-01 | Tr=0.1832 Te/Cur=0.2454 Te/Exp=0.2417]100%|██████████| 2/2 [00:05<00:00,  2.80s/it, CE=2.230412e+00 H=2.230204e+00 dV_dx=-4.646353e-06 dV_dθ=-2.030041e-04 ||∇||=5.678331e-01 | Tr=0.1832 Te/Cur=0.2454 Te/Exp=0.2417]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.33s/it] 50%|█████     | 1/2 [00:12<00:10, 10.33s/it, CE=2.222000e+00 H=2.221745e+00 dV_dx=-8.252039e-06 dV_dθ=-2.464333e-04 ||∇||=6.259214e-01 | Tr=0.1771 Te/Cur=0.2540 Te/Exp=0.2714]100%|██████████| 2/2 [00:12<00:00,  5.55s/it, CE=2.222000e+00 H=2.221745e+00 dV_dx=-8.252039e-06 dV_dθ=-2.464333e-04 ||∇||=6.259214e-01 | Tr=0.1771 Te/Cur=0.2540 Te/Exp=0.2714]100%|██████████| 2/2 [00:12<00:00,  6.26s/it, CE=2.222000e+00 H=2.221745e+00 dV_dx=-8.252039e-06 dV_dθ=-2.464333e-04 ||∇||=6.259214e-01 | Tr=0.1771 Te/Cur=0.2540 Te/Exp=0.2714]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 732, 184, 10]) with loss 2.222000
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.92s/it] 50%|█████     | 1/2 [00:16<00:09,  9.92s/it, CE=2.209755e+00 H=2.209464e+00 dV_dx=-2.441852e-07 dV_dθ=-2.905397e-04 ||∇||=6.168113e-01 | Tr=0.2161 Te/Cur=0.2533 Te/Exp=0.2954]100%|██████████| 2/2 [00:16<00:00,  7.89s/it, CE=2.209755e+00 H=2.209464e+00 dV_dx=-2.441852e-07 dV_dθ=-2.905397e-04 ||∇||=6.168113e-01 | Tr=0.2161 Te/Cur=0.2533 Te/Exp=0.2954]100%|██████████| 2/2 [00:16<00:00,  8.20s/it, CE=2.209755e+00 H=2.209464e+00 dV_dx=-2.441852e-07 dV_dθ=-2.905397e-04 ||∇||=6.168113e-01 | Tr=0.2161 Te/Cur=0.2533 Te/Exp=0.2954]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 224, 10]) with loss 2.209755
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.62s/it] 50%|█████     | 1/2 [00:05<00:03,  3.62s/it, CE=2.216963e+00 H=2.216628e+00 dV_dx=7.012877e-06 dV_dθ=-3.425955e-04 ||∇||=6.538733e-01 | Tr=0.1821 Te/Cur=0.1841 Te/Exp=0.2589]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.216963e+00 H=2.216628e+00 dV_dx=7.012877e-06 dV_dθ=-3.425955e-04 ||∇||=6.538733e-01 | Tr=0.1821 Te/Cur=0.1841 Te/Exp=0.2589]100%|██████████| 2/2 [00:05<00:00,  2.74s/it, CE=2.216963e+00 H=2.216628e+00 dV_dx=7.012877e-06 dV_dθ=-3.425955e-04 ||∇||=6.538733e-01 | Tr=0.1821 Te/Cur=0.1841 Te/Exp=0.2589]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.65s/it] 50%|█████     | 1/2 [00:11<00:09,  9.65s/it, CE=2.193640e+00 H=2.193296e+00 dV_dx=-5.019362e-07 dV_dθ=-3.432679e-04 ||∇||=6.745550e-01 | Tr=0.2549 Te/Cur=0.3143 Te/Exp=0.3233]100%|██████████| 2/2 [00:11<00:00,  4.97s/it, CE=2.193640e+00 H=2.193296e+00 dV_dx=-5.019362e-07 dV_dθ=-3.432679e-04 ||∇||=6.745550e-01 | Tr=0.2549 Te/Cur=0.3143 Te/Exp=0.3233]100%|██████████| 2/2 [00:11<00:00,  5.67s/it, CE=2.193640e+00 H=2.193296e+00 dV_dx=-5.019362e-07 dV_dθ=-3.432679e-04 ||∇||=6.745550e-01 | Tr=0.2549 Te/Cur=0.3143 Te/Exp=0.3233]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 732, 224, 10]) with loss 2.193640
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.51s/it] 50%|█████     | 1/2 [00:12<00:10, 10.51s/it, CE=2.227941e+00 H=2.227699e+00 dV_dx=8.227330e-08 dV_dθ=-2.418539e-04 ||∇||=5.868282e-01 | Tr=0.1620 Te/Cur=0.2284 Te/Exp=0.2600]100%|██████████| 2/2 [00:12<00:00,  5.77s/it, CE=2.227941e+00 H=2.227699e+00 dV_dx=8.227330e-08 dV_dθ=-2.418539e-04 ||∇||=5.868282e-01 | Tr=0.1620 Te/Cur=0.2284 Te/Exp=0.2600]100%|██████████| 2/2 [00:12<00:00,  6.48s/it, CE=2.227941e+00 H=2.227699e+00 dV_dx=8.227330e-08 dV_dθ=-2.418539e-04 ||∇||=5.868282e-01 | Tr=0.1620 Te/Cur=0.2284 Te/Exp=0.2600]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.38s/it] 50%|█████     | 1/2 [00:11<00:10, 10.38s/it, CE=2.223060e+00 H=2.222857e+00 dV_dx=1.741361e-06 dV_dθ=-2.048399e-04 ||∇||=6.085001e-01 | Tr=0.2365 Te/Cur=0.2678 Te/Exp=0.3030]100%|██████████| 2/2 [00:11<00:00,  5.13s/it, CE=2.223060e+00 H=2.222857e+00 dV_dx=1.741361e-06 dV_dθ=-2.048399e-04 ||∇||=6.085001e-01 | Tr=0.2365 Te/Cur=0.2678 Te/Exp=0.3030]100%|██████████| 2/2 [00:11<00:00,  5.92s/it, CE=2.223060e+00 H=2.222857e+00 dV_dx=1.741361e-06 dV_dθ=-2.048399e-04 ||∇||=6.085001e-01 | Tr=0.2365 Te/Cur=0.2678 Te/Exp=0.3030]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.73s/it] 50%|█████     | 1/2 [00:11<00:09,  9.73s/it, CE=2.202617e+00 H=2.202294e+00 dV_dx=1.264843e-07 dV_dθ=-3.231140e-04 ||∇||=6.418943e-01 | Tr=0.1981 Te/Cur=0.2703 Te/Exp=0.3296]100%|██████████| 2/2 [00:11<00:00,  5.06s/it, CE=2.202617e+00 H=2.202294e+00 dV_dx=1.264843e-07 dV_dθ=-3.231140e-04 ||∇||=6.418943e-01 | Tr=0.1981 Te/Cur=0.2703 Te/Exp=0.3296]100%|██████████| 2/2 [00:11<00:00,  5.76s/it, CE=2.202617e+00 H=2.202294e+00 dV_dx=1.264843e-07 dV_dθ=-3.231140e-04 ||∇||=6.418943e-01 | Tr=0.1981 Te/Cur=0.2703 Te/Exp=0.3296]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.64s/it] 50%|█████     | 1/2 [00:07<00:05,  5.64s/it, CE=2.242148e+00 H=2.241994e+00 dV_dx=6.877690e-06 dV_dθ=-1.606046e-04 ||∇||=5.206021e-01 | Tr=0.1881 Te/Cur=0.1824 Te/Exp=0.2038]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.242148e+00 H=2.241994e+00 dV_dx=6.877690e-06 dV_dθ=-1.606046e-04 ||∇||=5.206021e-01 | Tr=0.1881 Te/Cur=0.1824 Te/Exp=0.2038]100%|██████████| 2/2 [00:07<00:00,  3.86s/it, CE=2.242148e+00 H=2.241994e+00 dV_dx=6.877690e-06 dV_dθ=-1.606046e-04 ||∇||=5.206021e-01 | Tr=0.1881 Te/Cur=0.1824 Te/Exp=0.2038]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.26s/it] 50%|█████     | 1/2 [00:04<00:03,  3.26s/it, CE=2.250651e+00 H=2.250500e+00 dV_dx=2.932369e-06 dV_dθ=-1.534292e-04 ||∇||=4.785330e-01 | Tr=0.1695 Te/Cur=0.1862 Te/Exp=0.2504]100%|██████████| 2/2 [00:04<00:00,  2.30s/it, CE=2.250651e+00 H=2.250500e+00 dV_dx=2.932369e-06 dV_dθ=-1.534292e-04 ||∇||=4.785330e-01 | Tr=0.1695 Te/Cur=0.1862 Te/Exp=0.2504]100%|██████████| 2/2 [00:04<00:00,  2.44s/it, CE=2.250651e+00 H=2.250500e+00 dV_dx=2.932369e-06 dV_dθ=-1.534292e-04 ||∇||=4.785330e-01 | Tr=0.1695 Te/Cur=0.1862 Te/Exp=0.2504]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.19s/it] 50%|█████     | 1/2 [00:11<00:10, 10.19s/it, CE=2.239245e+00 H=2.239115e+00 dV_dx=7.711295e-06 dV_dθ=-1.371744e-04 ||∇||=5.246225e-01 | Tr=0.2031 Te/Cur=0.2125 Te/Exp=0.2541]100%|██████████| 2/2 [00:11<00:00,  5.23s/it, CE=2.239245e+00 H=2.239115e+00 dV_dx=7.711295e-06 dV_dθ=-1.371744e-04 ||∇||=5.246225e-01 | Tr=0.2031 Te/Cur=0.2125 Te/Exp=0.2541]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.239245e+00 H=2.239115e+00 dV_dx=7.711295e-06 dV_dθ=-1.371744e-04 ||∇||=5.246225e-01 | Tr=0.2031 Te/Cur=0.2125 Te/Exp=0.2541]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.47s/it] 50%|█████     | 1/2 [00:11<00:09,  9.47s/it, CE=2.242238e+00 H=2.242088e+00 dV_dx=-1.198809e-06 dV_dθ=-1.490140e-04 ||∇||=4.930127e-01 | Tr=0.2226 Te/Cur=0.2414 Te/Exp=0.2540]100%|██████████| 2/2 [00:11<00:00,  5.05s/it, CE=2.242238e+00 H=2.242088e+00 dV_dx=-1.198809e-06 dV_dθ=-1.490140e-04 ||∇||=4.930127e-01 | Tr=0.2226 Te/Cur=0.2414 Te/Exp=0.2540]100%|██████████| 2/2 [00:11<00:00,  5.71s/it, CE=2.242238e+00 H=2.242088e+00 dV_dx=-1.198809e-06 dV_dθ=-1.490140e-04 ||∇||=4.930127e-01 | Tr=0.2226 Te/Cur=0.2414 Te/Exp=0.2540]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.02s/it] 50%|█████     | 1/2 [00:10<00:08,  8.02s/it, CE=2.246618e+00 H=2.246474e+00 dV_dx=8.158428e-06 dV_dθ=-1.514987e-04 ||∇||=5.023389e-01 | Tr=0.1062 Te/Cur=0.1261 Te/Exp=0.2200]100%|██████████| 2/2 [00:10<00:00,  4.54s/it, CE=2.246618e+00 H=2.246474e+00 dV_dx=8.158428e-06 dV_dθ=-1.514987e-04 ||∇||=5.023389e-01 | Tr=0.1062 Te/Cur=0.1261 Te/Exp=0.2200]100%|██████████| 2/2 [00:10<00:00,  5.06s/it, CE=2.246618e+00 H=2.246474e+00 dV_dx=8.158428e-06 dV_dθ=-1.514987e-04 ||∇||=5.023389e-01 | Tr=0.1062 Te/Cur=0.1261 Te/Exp=0.2200]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.63s/it] 50%|█████     | 1/2 [00:11<00:09,  9.63s/it, CE=2.222536e+00 H=2.222377e+00 dV_dx=-5.450270e-06 dV_dθ=-1.529506e-04 ||∇||=5.479084e-01 | Tr=0.1675 Te/Cur=0.1895 Te/Exp=0.2829]100%|██████████| 2/2 [00:11<00:00,  5.24s/it, CE=2.222536e+00 H=2.222377e+00 dV_dx=-5.450270e-06 dV_dθ=-1.529506e-04 ||∇||=5.479084e-01 | Tr=0.1675 Te/Cur=0.1895 Te/Exp=0.2829]100%|██████████| 2/2 [00:11<00:00,  5.89s/it, CE=2.222536e+00 H=2.222377e+00 dV_dx=-5.450270e-06 dV_dθ=-1.529506e-04 ||∇||=5.479084e-01 | Tr=0.1675 Te/Cur=0.1895 Te/Exp=0.2829]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.28s/it] 50%|█████     | 1/2 [00:12<00:10, 10.28s/it, CE=2.260912e+00 H=2.260738e+00 dV_dx=1.904896e-06 dV_dθ=-1.758686e-04 ||∇||=5.140006e-01 | Tr=0.1755 Te/Cur=0.1953 Te/Exp=0.2396]100%|██████████| 2/2 [00:12<00:00,  5.46s/it, CE=2.260912e+00 H=2.260738e+00 dV_dx=1.904896e-06 dV_dθ=-1.758686e-04 ||∇||=5.140006e-01 | Tr=0.1755 Te/Cur=0.1953 Te/Exp=0.2396]100%|██████████| 2/2 [00:12<00:00,  6.19s/it, CE=2.260912e+00 H=2.260738e+00 dV_dx=1.904896e-06 dV_dθ=-1.758686e-04 ||∇||=5.140006e-01 | Tr=0.1755 Te/Cur=0.1953 Te/Exp=0.2396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.62s/it] 50%|█████     | 1/2 [00:12<00:10, 10.62s/it, CE=2.225323e+00 H=2.225180e+00 dV_dx=-6.816535e-07 dV_dθ=-1.421595e-04 ||∇||=4.909582e-01 | Tr=0.1924 Te/Cur=0.2556 Te/Exp=0.2850]100%|██████████| 2/2 [00:12<00:00,  5.39s/it, CE=2.225323e+00 H=2.225180e+00 dV_dx=-6.816535e-07 dV_dθ=-1.421595e-04 ||∇||=4.909582e-01 | Tr=0.1924 Te/Cur=0.2556 Te/Exp=0.2850]100%|██████████| 2/2 [00:12<00:00,  6.17s/it, CE=2.225323e+00 H=2.225180e+00 dV_dx=-6.816535e-07 dV_dθ=-1.421595e-04 ||∇||=4.909582e-01 | Tr=0.1924 Te/Cur=0.2556 Te/Exp=0.2850]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.75s/it] 50%|█████     | 1/2 [00:10<00:08,  8.75s/it, CE=2.225875e+00 H=2.225728e+00 dV_dx=1.992537e-06 dV_dθ=-1.492124e-04 ||∇||=5.150576e-01 | Tr=0.1458 Te/Cur=0.1903 Te/Exp=0.2644]100%|██████████| 2/2 [00:10<00:00,  4.71s/it, CE=2.225875e+00 H=2.225728e+00 dV_dx=1.992537e-06 dV_dθ=-1.492124e-04 ||∇||=5.150576e-01 | Tr=0.1458 Te/Cur=0.1903 Te/Exp=0.2644]100%|██████████| 2/2 [00:10<00:00,  5.32s/it, CE=2.225875e+00 H=2.225728e+00 dV_dx=1.992537e-06 dV_dθ=-1.492124e-04 ||∇||=5.150576e-01 | Tr=0.1458 Te/Cur=0.1903 Te/Exp=0.2644]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.90s/it] 50%|█████     | 1/2 [00:07<00:05,  5.90s/it, CE=2.272477e+00 H=2.272316e+00 dV_dx=-1.093522e-05 dV_dθ=-1.493860e-04 ||∇||=4.297992e-01 | Tr=0.1592 Te/Cur=0.1855 Te/Exp=0.1938]100%|██████████| 2/2 [00:07<00:00,  3.51s/it, CE=2.272477e+00 H=2.272316e+00 dV_dx=-1.093522e-05 dV_dθ=-1.493860e-04 ||∇||=4.297992e-01 | Tr=0.1592 Te/Cur=0.1855 Te/Exp=0.1938]100%|██████████| 2/2 [00:07<00:00,  3.87s/it, CE=2.272477e+00 H=2.272316e+00 dV_dx=-1.093522e-05 dV_dθ=-1.493860e-04 ||∇||=4.297992e-01 | Tr=0.1592 Te/Cur=0.1855 Te/Exp=0.1938]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.44s/it] 50%|█████     | 1/2 [00:05<00:03,  3.44s/it, CE=2.266817e+00 H=2.266681e+00 dV_dx=-1.161999e-06 dV_dθ=-1.347258e-04 ||∇||=4.250900e-01 | Tr=0.1830 Te/Cur=0.2492 Te/Exp=0.2101]100%|██████████| 2/2 [00:05<00:00,  2.52s/it, CE=2.266817e+00 H=2.266681e+00 dV_dx=-1.161999e-06 dV_dθ=-1.347258e-04 ||∇||=4.250900e-01 | Tr=0.1830 Te/Cur=0.2492 Te/Exp=0.2101]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.266817e+00 H=2.266681e+00 dV_dx=-1.161999e-06 dV_dθ=-1.347258e-04 ||∇||=4.250900e-01 | Tr=0.1830 Te/Cur=0.2492 Te/Exp=0.2101]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.89s/it] 50%|█████     | 1/2 [00:11<00:09,  9.89s/it, CE=2.248245e+00 H=2.248149e+00 dV_dx=7.906659e-07 dV_dθ=-9.701572e-05 ||∇||=4.311923e-01 | Tr=0.1400 Te/Cur=0.1429 Te/Exp=0.2410]100%|██████████| 2/2 [00:11<00:00,  5.19s/it, CE=2.248245e+00 H=2.248149e+00 dV_dx=7.906659e-07 dV_dθ=-9.701572e-05 ||∇||=4.311923e-01 | Tr=0.1400 Te/Cur=0.1429 Te/Exp=0.2410]100%|██████████| 2/2 [00:11<00:00,  5.90s/it, CE=2.248245e+00 H=2.248149e+00 dV_dx=7.906659e-07 dV_dθ=-9.701572e-05 ||∇||=4.311923e-01 | Tr=0.1400 Te/Cur=0.1429 Te/Exp=0.2410]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.88s/it] 50%|█████     | 1/2 [00:11<00:08,  8.88s/it, CE=2.252462e+00 H=2.252350e+00 dV_dx=2.898439e-06 dV_dθ=-1.155144e-04 ||∇||=3.908974e-01 | Tr=0.1824 Te/Cur=0.2249 Te/Exp=0.2131]100%|██████████| 2/2 [00:11<00:00,  5.10s/it, CE=2.252462e+00 H=2.252350e+00 dV_dx=2.898439e-06 dV_dθ=-1.155144e-04 ||∇||=3.908974e-01 | Tr=0.1824 Te/Cur=0.2249 Te/Exp=0.2131]100%|██████████| 2/2 [00:11<00:00,  5.67s/it, CE=2.252462e+00 H=2.252350e+00 dV_dx=2.898439e-06 dV_dθ=-1.155144e-04 ||∇||=3.908974e-01 | Tr=0.1824 Te/Cur=0.2249 Te/Exp=0.2131]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.34s/it] 50%|█████     | 1/2 [00:06<00:04,  4.34s/it, CE=2.249262e+00 H=2.249188e+00 dV_dx=1.679172e-06 dV_dθ=-7.585283e-05 ||∇||=4.150217e-01 | Tr=0.1862 Te/Cur=0.1953 Te/Exp=0.2296]100%|██████████| 2/2 [00:06<00:00,  2.99s/it, CE=2.249262e+00 H=2.249188e+00 dV_dx=1.679172e-06 dV_dθ=-7.585283e-05 ||∇||=4.150217e-01 | Tr=0.1862 Te/Cur=0.1953 Te/Exp=0.2296]100%|██████████| 2/2 [00:06<00:00,  3.19s/it, CE=2.249262e+00 H=2.249188e+00 dV_dx=1.679172e-06 dV_dθ=-7.585283e-05 ||∇||=4.150217e-01 | Tr=0.1862 Te/Cur=0.1953 Te/Exp=0.2296]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.78s/it] 50%|█████     | 1/2 [00:15<00:13, 13.78s/it, CE=2.252837e+00 H=2.252736e+00 dV_dx=1.388823e-06 dV_dθ=-1.018856e-04 ||∇||=4.178482e-01 | Tr=0.1363 Te/Cur=0.1610 Te/Exp=0.2411]100%|██████████| 2/2 [00:15<00:00,  6.60s/it, CE=2.252837e+00 H=2.252736e+00 dV_dx=1.388823e-06 dV_dθ=-1.018856e-04 ||∇||=4.178482e-01 | Tr=0.1363 Te/Cur=0.1610 Te/Exp=0.2411]100%|██████████| 2/2 [00:15<00:00,  7.68s/it, CE=2.252837e+00 H=2.252736e+00 dV_dx=1.388823e-06 dV_dθ=-1.018856e-04 ||∇||=4.178482e-01 | Tr=0.1363 Te/Cur=0.1610 Te/Exp=0.2411]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.52s/it] 50%|█████     | 1/2 [00:10<00:08,  8.52s/it, CE=2.255514e+00 H=2.255344e+00 dV_dx=-4.706054e-06 dV_dθ=-1.651220e-04 ||∇||=4.559946e-01 | Tr=0.2328 Te/Cur=0.2795 Te/Exp=0.2093]100%|██████████| 2/2 [00:10<00:00,  4.50s/it, CE=2.255514e+00 H=2.255344e+00 dV_dx=-4.706054e-06 dV_dθ=-1.651220e-04 ||∇||=4.559946e-01 | Tr=0.2328 Te/Cur=0.2795 Te/Exp=0.2093]100%|██████████| 2/2 [00:10<00:00,  5.11s/it, CE=2.255514e+00 H=2.255344e+00 dV_dx=-4.706054e-06 dV_dθ=-1.651220e-04 ||∇||=4.559946e-01 | Tr=0.2328 Te/Cur=0.2795 Te/Exp=0.2093]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.42s/it] 50%|█████     | 1/2 [00:09<00:08,  8.42s/it, CE=2.254238e+00 H=2.254129e+00 dV_dx=-5.319540e-06 dV_dθ=-1.039961e-04 ||∇||=4.081253e-01 | Tr=0.2207 Te/Cur=0.2192 Te/Exp=0.2211]100%|██████████| 2/2 [00:09<00:00,  4.39s/it, CE=2.254238e+00 H=2.254129e+00 dV_dx=-5.319540e-06 dV_dθ=-1.039961e-04 ||∇||=4.081253e-01 | Tr=0.2207 Te/Cur=0.2192 Te/Exp=0.2211]100%|██████████| 2/2 [00:09<00:00,  5.00s/it, CE=2.254238e+00 H=2.254129e+00 dV_dx=-5.319540e-06 dV_dθ=-1.039961e-04 ||∇||=4.081253e-01 | Tr=0.2207 Te/Cur=0.2192 Te/Exp=0.2211]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.75s/it] 50%|█████     | 1/2 [00:11<00:08,  8.75s/it, CE=2.252591e+00 H=2.252449e+00 dV_dx=-6.942465e-06 dV_dθ=-1.347630e-04 ||∇||=4.280736e-01 | Tr=0.2178 Te/Cur=0.2711 Te/Exp=0.2460]100%|██████████| 2/2 [00:11<00:00,  5.46s/it, CE=2.252591e+00 H=2.252449e+00 dV_dx=-6.942465e-06 dV_dθ=-1.347630e-04 ||∇||=4.280736e-01 | Tr=0.2178 Te/Cur=0.2711 Te/Exp=0.2460]100%|██████████| 2/2 [00:11<00:00,  5.96s/it, CE=2.252591e+00 H=2.252449e+00 dV_dx=-6.942465e-06 dV_dθ=-1.347630e-04 ||∇||=4.280736e-01 | Tr=0.2178 Te/Cur=0.2711 Te/Exp=0.2460]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 732, 224, 10]) with loss 2.193640
  Total candidates evaluated: 54
  Original: (4, [432, 692, 204, 10])
  Optimal: (2, [507, 732, 224, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 4→2, feed [432, 692, 204, 10]→[507, 732, 224, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 4)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:07, 13.02s/it]  5%|▌         | 1/20 [00:15<04:07, 13.02s/it, CE=2.337265e+00 H=2.291745e+00 dV_dx=3.567786e-05 dV_dθ=-4.555605e-02 ||∇||=1.043303e+01 | Tr=0.8273] 10%|█         | 2/20 [00:15<02:00,  6.67s/it, CE=2.337265e+00 H=2.291745e+00 dV_dx=3.567786e-05 dV_dθ=-4.555605e-02 ||∇||=1.043303e+01 | Tr=0.8273] 10%|█         | 2/20 [00:17<02:00,  6.67s/it, CE=1.922790e+00 H=1.894270e+00 dV_dx=1.220129e-04 dV_dθ=-2.864269e-02 ||∇||=8.631300e+00 | Tr=0.8273] 15%|█▌        | 3/20 [00:17<01:18,  4.62s/it, CE=1.922790e+00 H=1.894270e+00 dV_dx=1.220129e-04 dV_dθ=-2.864269e-02 ||∇||=8.631300e+00 | Tr=0.8273] 15%|█▌        | 3/20 [00:20<01:18,  4.62s/it, CE=1.668141e+00 H=1.629352e+00 dV_dx=-1.118826e-04 dV_dθ=-3.867747e-02 ||∇||=8.863560e+00 | Tr=0.8273] 20%|██        | 4/20 [00:20<01:06,  4.17s/it, CE=1.668141e+00 H=1.629352e+00 dV_dx=-1.118826e-04 dV_dθ=-3.867747e-02 ||∇||=8.863560e+00 | Tr=0.8273] 20%|██        | 4/20 [00:24<01:06,  4.17s/it, CE=1.470842e+00 H=1.420596e+00 dV_dx=-1.204245e-04 dV_dθ=-5.012621e-02 ||∇||=9.408218e+00 | Tr=0.8273] 25%|██▌       | 5/20 [00:24<00:57,  3.85s/it, CE=1.470842e+00 H=1.420596e+00 dV_dx=-1.204245e-04 dV_dθ=-5.012621e-02 ||∇||=9.408218e+00 | Tr=0.8273] 25%|██▌       | 5/20 [00:26<00:57,  3.85s/it, CE=1.314406e+00 H=1.265999e+00 dV_dx=-1.027808e-05 dV_dθ=-4.839693e-02 ||∇||=9.080037e+00 | Tr=0.8273] 30%|███       | 6/20 [00:26<00:46,  3.31s/it, CE=1.314406e+00 H=1.265999e+00 dV_dx=-1.027808e-05 dV_dθ=-4.839693e-02 ||∇||=9.080037e+00 | Tr=0.8273] 30%|███       | 6/20 [00:28<00:46,  3.31s/it, CE=1.193887e+00 H=1.133298e+00 dV_dx=6.050165e-05 dV_dθ=-6.064979e-02 ||∇||=9.455563e+00 | Tr=0.8273]  35%|███▌      | 7/20 [00:28<00:37,  2.92s/it, CE=1.193887e+00 H=1.133298e+00 dV_dx=6.050165e-05 dV_dθ=-6.064979e-02 ||∇||=9.455563e+00 | Tr=0.8273] 35%|███▌      | 7/20 [00:30<00:37,  2.92s/it, CE=1.097794e+00 H=1.021087e+00 dV_dx=5.250501e-05 dV_dθ=-7.675921e-02 ||∇||=1.009292e+01 | Tr=0.8273] 40%|████      | 8/20 [00:30<00:30,  2.58s/it, CE=1.097794e+00 H=1.021087e+00 dV_dx=5.250501e-05 dV_dθ=-7.675921e-02 ||∇||=1.009292e+01 | Tr=0.8273] 40%|████      | 8/20 [00:32<00:30,  2.58s/it, CE=1.017909e+00 H=9.290625e-01 dV_dx=-4.335568e-05 dV_dθ=-8.880317e-02 ||∇||=1.044719e+01 | Tr=0.8273] 45%|████▌     | 9/20 [00:32<00:27,  2.51s/it, CE=1.017909e+00 H=9.290625e-01 dV_dx=-4.335568e-05 dV_dθ=-8.880317e-02 ||∇||=1.044719e+01 | Tr=0.8273] 45%|████▌     | 9/20 [00:35<00:27,  2.51s/it, CE=9.532504e-01 H=8.599289e-01 dV_dx=-1.119842e-04 dV_dθ=-9.320950e-02 ||∇||=1.080129e+01 | Tr=0.8273] 50%|█████     | 10/20 [00:35<00:25,  2.52s/it, CE=9.532504e-01 H=8.599289e-01 dV_dx=-1.119842e-04 dV_dθ=-9.320950e-02 ||∇||=1.080129e+01 | Tr=0.8273] 50%|█████     | 10/20 [00:37<00:25,  2.52s/it, CE=8.992565e-01 H=7.969235e-01 dV_dx=-1.208583e-06 dV_dθ=-1.023318e-01 ||∇||=1.146684e+01 | Tr=0.8273] 55%|█████▌    | 11/20 [00:37<00:22,  2.54s/it, CE=8.992565e-01 H=7.969235e-01 dV_dx=-1.208583e-06 dV_dθ=-1.023318e-01 ||∇||=1.146684e+01 | Tr=0.8273] 55%|█████▌    | 11/20 [00:39<00:22,  2.54s/it, CE=8.535740e-01 H=7.382813e-01 dV_dx=-5.463265e-05 dV_dθ=-1.152380e-01 ||∇||=1.205736e+01 | Tr=0.8273] 60%|██████    | 12/20 [00:39<00:19,  2.40s/it, CE=8.535740e-01 H=7.382813e-01 dV_dx=-5.463265e-05 dV_dθ=-1.152380e-01 ||∇||=1.205736e+01 | Tr=0.8273] 60%|██████    | 12/20 [00:41<00:19,  2.40s/it, CE=8.124331e-01 H=6.655020e-01 dV_dx=2.462046e-05 dV_dθ=-1.469557e-01 ||∇||=1.300865e+01 | Tr=0.8273]  65%|██████▌   | 13/20 [00:41<00:15,  2.24s/it, CE=8.124331e-01 H=6.655020e-01 dV_dx=2.462046e-05 dV_dθ=-1.469557e-01 ||∇||=1.300865e+01 | Tr=0.8273] 65%|██████▌   | 13/20 [00:43<00:15,  2.24s/it, CE=7.753975e-01 H=6.127209e-01 dV_dx=-1.144373e-04 dV_dθ=-1.625622e-01 ||∇||=1.360697e+01 | Tr=0.8273] 70%|███████   | 14/20 [00:43<00:12,  2.16s/it, CE=7.753975e-01 H=6.127209e-01 dV_dx=-1.144373e-04 dV_dθ=-1.625622e-01 ||∇||=1.360697e+01 | Tr=0.8273] 70%|███████   | 14/20 [00:45<00:12,  2.16s/it, CE=7.488932e-01 H=5.341200e-01 dV_dx=4.098151e-05 dV_dθ=-2.148142e-01 ||∇||=1.532850e+01 | Tr=0.8273]  75%|███████▌  | 15/20 [00:45<00:10,  2.10s/it, CE=7.488932e-01 H=5.341200e-01 dV_dx=4.098151e-05 dV_dθ=-2.148142e-01 ||∇||=1.532850e+01 | Tr=0.8273] 75%|███████▌  | 15/20 [00:48<00:10,  2.10s/it, CE=7.218323e-01 H=5.210624e-01 dV_dx=-9.493937e-05 dV_dθ=-2.006750e-01 ||∇||=1.510079e+01 | Tr=0.8273] 80%|████████  | 16/20 [00:48<00:08,  2.16s/it, CE=7.218323e-01 H=5.210624e-01 dV_dx=-9.493937e-05 dV_dθ=-2.006750e-01 ||∇||=1.510079e+01 | Tr=0.8273] 80%|████████  | 16/20 [00:50<00:08,  2.16s/it, CE=6.918541e-01 H=5.603066e-01 dV_dx=-1.555829e-05 dV_dθ=-1.315320e-01 ||∇||=1.288172e+01 | Tr=0.8273] 85%|████████▌ | 17/20 [00:50<00:06,  2.17s/it, CE=6.918541e-01 H=5.603066e-01 dV_dx=-1.555829e-05 dV_dθ=-1.315320e-01 ||∇||=1.288172e+01 | Tr=0.8273] 85%|████████▌ | 17/20 [00:52<00:06,  2.17s/it, CE=6.624559e-01 H=5.844062e-01 dV_dx=-7.222549e-05 dV_dθ=-7.797749e-02 ||∇||=1.076711e+01 | Tr=0.8273] 90%|█████████ | 18/20 [00:52<00:04,  2.15s/it, CE=6.624559e-01 H=5.844062e-01 dV_dx=-7.222549e-05 dV_dθ=-7.797749e-02 ||∇||=1.076711e+01 | Tr=0.8273] 90%|█████████ | 18/20 [00:54<00:04,  2.15s/it, CE=6.370132e-01 H=5.804230e-01 dV_dx=1.496874e-05 dV_dθ=-5.660519e-02 ||∇||=9.606433e+00 | Tr=0.8273]  95%|█████████▌| 19/20 [00:54<00:02,  2.16s/it, CE=6.370132e-01 H=5.804230e-01 dV_dx=1.496874e-05 dV_dθ=-5.660519e-02 ||∇||=9.606433e+00 | Tr=0.8273] 95%|█████████▌| 19/20 [00:59<00:02,  2.16s/it, CE=6.167753e-01 H=5.634040e-01 dV_dx=-1.346029e-04 dV_dθ=-5.323669e-02 ||∇||=9.507921e+00 | Tr=0.8273 Te/Cur=0.9101 Te/Exp=0.7428]100%|██████████| 20/20 [01:02<00:00,  4.04s/it, CE=6.167753e-01 H=5.634040e-01 dV_dx=-1.346029e-04 dV_dθ=-5.323669e-02 ||∇||=9.507921e+00 | Tr=0.8273 Te/Cur=0.9101 Te/Exp=0.7428]100%|██████████| 20/20 [01:02<00:00,  3.15s/it, CE=6.167753e-01 H=5.634040e-01 dV_dx=-1.346029e-04 dV_dθ=-5.323669e-02 ||∇||=9.507921e+00 | Tr=0.8273 Te/Cur=0.9101 Te/Exp=0.7428]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.574731
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<01:55,  6.09s/it]  5%|▌         | 1/20 [00:09<01:55,  6.09s/it, CE=6.792883e-01 H=5.847100e-01 dV_dx=-1.408711e-04 dV_dθ=-9.443752e-02 ||∇||=1.181747e+01 | Tr=0.8277] 10%|█         | 2/20 [00:09<01:17,  4.29s/it, CE=6.792883e-01 H=5.847100e-01 dV_dx=-1.408711e-04 dV_dθ=-9.443752e-02 ||∇||=1.181747e+01 | Tr=0.8277] 10%|█         | 2/20 [00:11<01:17,  4.29s/it, CE=6.466595e-01 H=5.539225e-01 dV_dx=2.942739e-05 dV_dθ=-9.276636e-02 ||∇||=1.169221e+01 | Tr=0.8277]  15%|█▌        | 3/20 [00:11<00:59,  3.49s/it, CE=6.466595e-01 H=5.539225e-01 dV_dx=2.942739e-05 dV_dθ=-9.276636e-02 ||∇||=1.169221e+01 | Tr=0.8277] 15%|█▌        | 3/20 [00:14<00:59,  3.49s/it, CE=6.170408e-01 H=5.412522e-01 dV_dx=1.523416e-05 dV_dθ=-7.580385e-02 ||∇||=1.066215e+01 | Tr=0.8277] 20%|██        | 4/20 [00:14<00:49,  3.09s/it, CE=6.170408e-01 H=5.412522e-01 dV_dx=1.523416e-05 dV_dθ=-7.580385e-02 ||∇||=1.066215e+01 | Tr=0.8277] 20%|██        | 4/20 [00:16<00:49,  3.09s/it, CE=5.952150e-01 H=5.131317e-01 dV_dx=3.238642e-05 dV_dθ=-8.211565e-02 ||∇||=1.096053e+01 | Tr=0.8277] 25%|██▌       | 5/20 [00:16<00:44,  2.96s/it, CE=5.952150e-01 H=5.131317e-01 dV_dx=3.238642e-05 dV_dθ=-8.211565e-02 ||∇||=1.096053e+01 | Tr=0.8277] 25%|██▌       | 5/20 [00:20<00:44,  2.96s/it, CE=5.803799e-01 H=4.665821e-01 dV_dx=5.772885e-05 dV_dθ=-1.138556e-01 ||∇||=1.207248e+01 | Tr=0.8277] 30%|███       | 6/20 [00:20<00:42,  3.06s/it, CE=5.803799e-01 H=4.665821e-01 dV_dx=5.772885e-05 dV_dθ=-1.138556e-01 ||∇||=1.207248e+01 | Tr=0.8277] 30%|███       | 6/20 [00:23<00:42,  3.06s/it, CE=5.560755e-01 H=4.880971e-01 dV_dx=1.201538e-07 dV_dθ=-6.797850e-02 ||∇||=1.015267e+01 | Tr=0.8277] 35%|███▌      | 7/20 [00:23<00:39,  3.02s/it, CE=5.560755e-01 H=4.880971e-01 dV_dx=1.201538e-07 dV_dθ=-6.797850e-02 ||∇||=1.015267e+01 | Tr=0.8277] 35%|███▌      | 7/20 [00:24<00:39,  3.02s/it, CE=5.325563e-01 H=5.031487e-01 dV_dx=-3.971498e-05 dV_dθ=-2.936794e-02 ||∇||=8.030848e+00 | Tr=0.8277] 40%|████      | 8/20 [00:24<00:32,  2.68s/it, CE=5.325563e-01 H=5.031487e-01 dV_dx=-3.971498e-05 dV_dθ=-2.936794e-02 ||∇||=8.030848e+00 | Tr=0.8277] 40%|████      | 8/20 [00:26<00:32,  2.68s/it, CE=5.170446e-01 H=4.914759e-01 dV_dx=-4.017503e-05 dV_dθ=-2.552852e-02 ||∇||=8.008547e+00 | Tr=0.8277] 45%|████▌     | 9/20 [00:26<00:25,  2.35s/it, CE=5.170446e-01 H=4.914759e-01 dV_dx=-4.017503e-05 dV_dθ=-2.552852e-02 ||∇||=8.008547e+00 | Tr=0.8277] 45%|████▌     | 9/20 [00:28<00:25,  2.35s/it, CE=5.069690e-01 H=4.649412e-01 dV_dx=-1.498511e-04 dV_dθ=-4.187794e-02 ||∇||=9.130711e+00 | Tr=0.8277] 50%|█████     | 10/20 [00:28<00:22,  2.21s/it, CE=5.069690e-01 H=4.649412e-01 dV_dx=-1.498511e-04 dV_dθ=-4.187794e-02 ||∇||=9.130711e+00 | Tr=0.8277] 50%|█████     | 10/20 [00:30<00:22,  2.21s/it, CE=5.021420e-01 H=4.388209e-01 dV_dx=6.020232e-05 dV_dθ=-6.338126e-02 ||∇||=1.031494e+01 | Tr=0.8277]  55%|█████▌    | 11/20 [00:30<00:20,  2.24s/it, CE=5.021420e-01 H=4.388209e-01 dV_dx=6.020232e-05 dV_dθ=-6.338126e-02 ||∇||=1.031494e+01 | Tr=0.8277] 55%|█████▌    | 11/20 [00:33<00:20,  2.24s/it, CE=4.879487e-01 H=4.432956e-01 dV_dx=1.777923e-04 dV_dθ=-4.483092e-02 ||∇||=9.177142e+00 | Tr=0.8277] 60%|██████    | 12/20 [00:33<00:18,  2.30s/it, CE=4.879487e-01 H=4.432956e-01 dV_dx=1.777923e-04 dV_dθ=-4.483092e-02 ||∇||=9.177142e+00 | Tr=0.8277] 60%|██████    | 12/20 [00:35<00:18,  2.30s/it, CE=4.779608e-01 H=4.252022e-01 dV_dx=2.888015e-05 dV_dθ=-5.278757e-02 ||∇||=9.561767e+00 | Tr=0.8277] 65%|██████▌   | 13/20 [00:35<00:15,  2.25s/it, CE=4.779608e-01 H=4.252022e-01 dV_dx=2.888015e-05 dV_dθ=-5.278757e-02 ||∇||=9.561767e+00 | Tr=0.8277] 65%|██████▌   | 13/20 [00:37<00:15,  2.25s/it, CE=4.626943e-01 H=4.006224e-01 dV_dx=-7.845486e-05 dV_dθ=-6.199347e-02 ||∇||=9.710408e+00 | Tr=0.8277] 70%|███████   | 14/20 [00:37<00:13,  2.26s/it, CE=4.626943e-01 H=4.006224e-01 dV_dx=-7.845486e-05 dV_dθ=-6.199347e-02 ||∇||=9.710408e+00 | Tr=0.8277] 70%|███████   | 14/20 [00:39<00:13,  2.26s/it, CE=4.538051e-01 H=3.787092e-01 dV_dx=-8.026099e-05 dV_dθ=-7.501559e-02 ||∇||=1.030480e+01 | Tr=0.8277] 75%|███████▌  | 15/20 [00:39<00:10,  2.12s/it, CE=4.538051e-01 H=3.787092e-01 dV_dx=-8.026099e-05 dV_dθ=-7.501559e-02 ||∇||=1.030480e+01 | Tr=0.8277] 75%|███████▌  | 15/20 [00:41<00:10,  2.12s/it, CE=4.542504e-01 H=3.591272e-01 dV_dx=1.795820e-05 dV_dθ=-9.514119e-02 ||∇||=1.141046e+01 | Tr=0.8277]  80%|████████  | 16/20 [00:41<00:08,  2.12s/it, CE=4.542504e-01 H=3.591272e-01 dV_dx=1.795820e-05 dV_dθ=-9.514119e-02 ||∇||=1.141046e+01 | Tr=0.8277] 80%|████████  | 16/20 [00:43<00:08,  2.12s/it, CE=4.552964e-01 H=3.396198e-01 dV_dx=-4.869822e-05 dV_dθ=-1.156279e-01 ||∇||=1.240106e+01 | Tr=0.8277] 85%|████████▌ | 17/20 [00:43<00:06,  2.06s/it, CE=4.552964e-01 H=3.396198e-01 dV_dx=-4.869822e-05 dV_dθ=-1.156279e-01 ||∇||=1.240106e+01 | Tr=0.8277] 85%|████████▌ | 17/20 [00:44<00:06,  2.06s/it, CE=4.458968e-01 H=3.397524e-01 dV_dx=2.932225e-05 dV_dθ=-1.061737e-01 ||∇||=1.213153e+01 | Tr=0.8277]  90%|█████████ | 18/20 [00:44<00:03,  1.83s/it, CE=4.458968e-01 H=3.397524e-01 dV_dx=2.932225e-05 dV_dθ=-1.061737e-01 ||∇||=1.213153e+01 | Tr=0.8277] 90%|█████████ | 18/20 [00:46<00:03,  1.83s/it, CE=4.377947e-01 H=3.394472e-01 dV_dx=7.991803e-05 dV_dθ=-9.842747e-02 ||∇||=1.160996e+01 | Tr=0.8277] 95%|█████████▌| 19/20 [00:46<00:01,  1.68s/it, CE=4.377947e-01 H=3.394472e-01 dV_dx=7.991803e-05 dV_dθ=-9.842747e-02 ||∇||=1.160996e+01 | Tr=0.8277] 95%|█████████▌| 19/20 [00:48<00:01,  1.68s/it, CE=4.369417e-01 H=2.988076e-01 dV_dx=-1.010206e-05 dV_dθ=-1.381240e-01 ||∇||=1.324949e+01 | Tr=0.8277 Te/Cur=0.9273 Te/Exp=0.7995]100%|██████████| 20/20 [00:51<00:00,  2.86s/it, CE=4.369417e-01 H=2.988076e-01 dV_dx=-1.010206e-05 dV_dθ=-1.381240e-01 ||∇||=1.324949e+01 | Tr=0.8277 Te/Cur=0.9273 Te/Exp=0.7995]100%|██████████| 20/20 [00:51<00:00,  2.59s/it, CE=4.369417e-01 H=2.988076e-01 dV_dx=-1.010206e-05 dV_dθ=-1.381240e-01 ||∇||=1.324949e+01 | Tr=0.8277 Te/Cur=0.9273 Te/Exp=0.7995]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.78s/it] 50%|█████     | 1/2 [00:10<00:08,  8.78s/it, CE=4.806520e-01 H=4.775976e-01 dV_dx=-1.410239e-04 dV_dθ=-2.913420e-03 ||∇||=2.213700e+00 | Tr=0.9719 Te/Cur=0.9541 Te/Exp=0.8209]100%|██████████| 2/2 [00:10<00:00,  4.71s/it, CE=4.806520e-01 H=4.775976e-01 dV_dx=-1.410239e-04 dV_dθ=-2.913420e-03 ||∇||=2.213700e+00 | Tr=0.9719 Te/Cur=0.9541 Te/Exp=0.8209]100%|██████████| 2/2 [00:10<00:00,  5.32s/it, CE=4.806520e-01 H=4.775976e-01 dV_dx=-1.410239e-04 dV_dθ=-2.913420e-03 ||∇||=2.213700e+00 | Tr=0.9719 Te/Cur=0.9541 Te/Exp=0.8209]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:04<01:18,  4.14s/it]  5%|▌         | 1/20 [00:05<01:18,  4.14s/it, CE=4.675914e-01 H=4.670186e-01 dV_dx=-1.174040e-04 dV_dθ=-4.553925e-04 ||∇||=1.914701e+00 | Tr=0.9740] 10%|█         | 2/20 [00:05<00:43,  2.40s/it, CE=4.675914e-01 H=4.670186e-01 dV_dx=-1.174040e-04 dV_dθ=-4.553925e-04 ||∇||=1.914701e+00 | Tr=0.9740] 10%|█         | 2/20 [00:06<00:43,  2.40s/it, CE=4.475865e-01 H=4.471257e-01 dV_dx=5.015011e-05 dV_dθ=-5.109175e-04 ||∇||=1.873596e+00 | Tr=0.9753]  15%|█▌        | 3/20 [00:06<00:30,  1.82s/it, CE=4.475865e-01 H=4.471257e-01 dV_dx=5.015011e-05 dV_dθ=-5.109175e-04 ||∇||=1.873596e+00 | Tr=0.9753] 15%|█▌        | 3/20 [00:07<00:30,  1.82s/it, CE=4.311032e-01 H=4.306392e-01 dV_dx=9.111878e-05 dV_dθ=-5.551692e-04 ||∇||=1.844236e+00 | Tr=0.9768] 20%|██        | 4/20 [00:07<00:27,  1.70s/it, CE=4.311032e-01 H=4.306392e-01 dV_dx=9.111878e-05 dV_dθ=-5.551692e-04 ||∇||=1.844236e+00 | Tr=0.9768] 20%|██        | 4/20 [00:09<00:27,  1.70s/it, CE=4.171904e-01 H=4.165326e-01 dV_dx=-2.576741e-06 dV_dθ=-6.552963e-04 ||∇||=1.827017e+00 | Tr=0.9778] 25%|██▌       | 5/20 [00:09<00:22,  1.51s/it, CE=4.171904e-01 H=4.165326e-01 dV_dx=-2.576741e-06 dV_dθ=-6.552963e-04 ||∇||=1.827017e+00 | Tr=0.9778] 25%|██▌       | 5/20 [00:11<00:22,  1.51s/it, CE=4.044756e-01 H=4.036960e-01 dV_dx=-1.473651e-04 dV_dθ=-6.322959e-04 ||∇||=1.796016e+00 | Tr=0.9786 Te/Cur=0.9574 Te/Exp=0.8263] 30%|███       | 6/20 [00:11<00:23,  1.65s/it, CE=4.044756e-01 H=4.036960e-01 dV_dx=-1.473651e-04 dV_dθ=-6.322959e-04 ||∇||=1.796016e+00 | Tr=0.9786 Te/Cur=0.9574 Te/Exp=0.8263] 30%|███       | 6/20 [00:12<00:23,  1.65s/it, CE=3.930227e-01 H=3.923434e-01 dV_dx=-6.913282e-05 dV_dθ=-6.101704e-04 ||∇||=1.758241e+00 | Tr=0.9795]                             35%|███▌      | 7/20 [00:12<00:19,  1.51s/it, CE=3.930227e-01 H=3.923434e-01 dV_dx=-6.913282e-05 dV_dθ=-6.101704e-04 ||∇||=1.758241e+00 | Tr=0.9795] 35%|███▌      | 7/20 [00:13<00:19,  1.51s/it, CE=3.825465e-01 H=3.820606e-01 dV_dx=7.432505e-05 dV_dθ=-5.602214e-04 ||∇||=1.717890e+00 | Tr=0.9805]  40%|████      | 8/20 [00:13<00:17,  1.42s/it, CE=3.825465e-01 H=3.820606e-01 dV_dx=7.432505e-05 dV_dθ=-5.602214e-04 ||∇||=1.717890e+00 | Tr=0.9805] 40%|████      | 8/20 [00:14<00:17,  1.42s/it, CE=3.732949e-01 H=3.725615e-01 dV_dx=-1.485536e-05 dV_dθ=-7.185982e-04 ||∇||=1.726036e+00 | Tr=0.9810] 45%|████▌     | 9/20 [00:14<00:15,  1.41s/it, CE=3.732949e-01 H=3.725615e-01 dV_dx=-1.485536e-05 dV_dθ=-7.185982e-04 ||∇||=1.726036e+00 | Tr=0.9810] 45%|████▌     | 9/20 [00:16<00:15,  1.41s/it, CE=3.643771e-01 H=3.637528e-01 dV_dx=9.878538e-05 dV_dθ=-7.231294e-04 ||∇||=1.701857e+00 | Tr=0.9818]  50%|█████     | 10/20 [00:16<00:13,  1.40s/it, CE=3.643771e-01 H=3.637528e-01 dV_dx=9.878538e-05 dV_dθ=-7.231294e-04 ||∇||=1.701857e+00 | Tr=0.9818] 50%|█████     | 10/20 [00:18<00:13,  1.40s/it, CE=3.558725e-01 H=3.554335e-01 dV_dx=1.536845e-04 dV_dθ=-5.927164e-04 ||∇||=1.646266e+00 | Tr=0.9825 Te/Cur=0.9585 Te/Exp=0.8315] 55%|█████▌    | 11/20 [00:18<00:13,  1.52s/it, CE=3.558725e-01 H=3.554335e-01 dV_dx=1.536845e-04 dV_dθ=-5.927164e-04 ||∇||=1.646266e+00 | Tr=0.9825 Te/Cur=0.9585 Te/Exp=0.8315] 55%|█████▌    | 11/20 [00:19<00:13,  1.52s/it, CE=3.482875e-01 H=3.476321e-01 dV_dx=8.346316e-05 dV_dθ=-7.389191e-04 ||∇||=1.661710e+00 | Tr=0.9831]                             60%|██████    | 12/20 [00:19<00:10,  1.37s/it, CE=3.482875e-01 H=3.476321e-01 dV_dx=8.346316e-05 dV_dθ=-7.389191e-04 ||∇||=1.661710e+00 | Tr=0.9831] 60%|██████    | 12/20 [00:20<00:10,  1.37s/it, CE=3.410164e-01 H=3.402914e-01 dV_dx=2.844924e-05 dV_dθ=-7.534304e-04 ||∇||=1.649910e+00 | Tr=0.9837] 65%|██████▌   | 13/20 [00:20<00:08,  1.25s/it, CE=3.410164e-01 H=3.402914e-01 dV_dx=2.844924e-05 dV_dθ=-7.534304e-04 ||∇||=1.649910e+00 | Tr=0.9837] 65%|██████▌   | 13/20 [00:21<00:08,  1.25s/it, CE=3.338805e-01 H=3.330142e-01 dV_dx=-8.051134e-05 dV_dθ=-7.858432e-04 ||∇||=1.640261e+00 | Tr=0.9842] 70%|███████   | 14/20 [00:21<00:07,  1.23s/it, CE=3.338805e-01 H=3.330142e-01 dV_dx=-8.051134e-05 dV_dθ=-7.858432e-04 ||∇||=1.640261e+00 | Tr=0.9842] 70%|███████   | 14/20 [00:22<00:07,  1.23s/it, CE=3.273394e-01 H=3.263491e-01 dV_dx=2.660759e-05 dV_dθ=-1.016817e-03 ||∇||=1.667843e+00 | Tr=0.9848]  75%|███████▌  | 15/20 [00:22<00:05,  1.18s/it, CE=3.273394e-01 H=3.263491e-01 dV_dx=2.660759e-05 dV_dθ=-1.016817e-03 ||∇||=1.667843e+00 | Tr=0.9848] 75%|███████▌  | 15/20 [00:24<00:05,  1.18s/it, CE=3.214362e-01 H=3.200706e-01 dV_dx=-7.255038e-05 dV_dθ=-1.293044e-03 ||∇||=1.717222e+00 | Tr=0.9851 Te/Cur=0.9580 Te/Exp=0.8279] 80%|████████  | 16/20 [00:24<00:05,  1.36s/it, CE=3.214362e-01 H=3.200706e-01 dV_dx=-7.255038e-05 dV_dθ=-1.293044e-03 ||∇||=1.717222e+00 | Tr=0.9851 Te/Cur=0.9580 Te/Exp=0.8279] 80%|████████  | 16/20 [00:25<00:05,  1.36s/it, CE=3.159378e-01 H=3.145105e-01 dV_dx=-4.917702e-05 dV_dθ=-1.378119e-03 ||∇||=1.731680e+00 | Tr=0.9854]                             85%|████████▌ | 17/20 [00:25<00:03,  1.29s/it, CE=3.159378e-01 H=3.145105e-01 dV_dx=-4.917702e-05 dV_dθ=-1.378119e-03 ||∇||=1.731680e+00 | Tr=0.9854] 85%|████████▌ | 17/20 [00:26<00:03,  1.29s/it, CE=3.108914e-01 H=3.091710e-01 dV_dx=-1.408161e-04 dV_dθ=-1.579557e-03 ||∇||=1.764494e+00 | Tr=0.9856] 90%|█████████ | 18/20 [00:26<00:02,  1.23s/it, CE=3.108914e-01 H=3.091710e-01 dV_dx=-1.408161e-04 dV_dθ=-1.579557e-03 ||∇||=1.764494e+00 | Tr=0.9856] 90%|█████████ | 18/20 [00:27<00:02,  1.23s/it, CE=3.061390e-01 H=3.044142e-01 dV_dx=4.406850e-05 dV_dθ=-1.768873e-03 ||∇||=1.786651e+00 | Tr=0.9864]  95%|█████████▌| 19/20 [00:27<00:01,  1.20s/it, CE=3.061390e-01 H=3.044142e-01 dV_dx=4.406850e-05 dV_dθ=-1.768873e-03 ||∇||=1.786651e+00 | Tr=0.9864] 95%|█████████▌| 19/20 [00:29<00:01,  1.20s/it, CE=3.018615e-01 H=2.996709e-01 dV_dx=-1.190768e-05 dV_dθ=-2.178734e-03 ||∇||=1.844931e+00 | Tr=0.9866 Te/Cur=0.9630 Te/Exp=0.8439]100%|██████████| 20/20 [00:29<00:00,  1.41s/it, CE=3.018615e-01 H=2.996709e-01 dV_dx=-1.190768e-05 dV_dθ=-2.178734e-03 ||∇||=1.844931e+00 | Tr=0.9866 Te/Cur=0.9630 Te/Exp=0.8439]100%|██████████| 20/20 [00:29<00:00,  1.47s/it, CE=3.018615e-01 H=2.996709e-01 dV_dx=-1.190768e-05 dV_dθ=-2.178734e-03 ||∇||=1.844931e+00 | Tr=0.9866 Te/Cur=0.9630 Te/Exp=0.8439]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 9 final loss: 0.311649
======================================================================


  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7387
    Task 1: 0.9138
    Task 2: 0.8087
    Task 3: 0.5868
    Task 4: 0.9049
    Task 5: 0.8855
    Task 6: 0.8964
    Task 7: 0.8902
    Task 8: 0.8980
    Task 9: 0.9629

======================================================================
ARCHITECTURE EVOLUTION SUMMARY
======================================================================

Task 0:
  Original:       None
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 512, 64, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        False
  Reason:         baseline_task
  Optimal Loss:   0.820367

Task 1:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 512, 64, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [432, 552, 84, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.949854
  Optimal Loss:   0.584856

Task 2:
  Original:       {'model_type': 'CNN', 'feed_sizes': [432, 552, 84, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [432, 552, 84, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Changed:        False
  Reason:         loss_ratio_below_threshold
  Prelim Loss:    0.514344
  Optimal Loss:   0.348094

Task 3:
  Original:       {'model_type': 'CNN', 'feed_sizes': [432, 552, 84, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 572, 104, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.519950
  Optimal Loss:   0.307108

Task 4:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 572, 104, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [432, 612, 164, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.532687
  Optimal Loss:   0.520344

Task 5:
  Original:       {'model_type': 'CNN', 'feed_sizes': [432, 612, 164, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 632, 144, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.631777
  Optimal Loss:   0.495015

Task 6:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 632, 144, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 652, 144, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.625629
  Optimal Loss:   0.458942

Task 7:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 652, 144, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 652, 164, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.592441
  Optimal Loss:   0.397462

Task 8:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 652, 164, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [432, 692, 204, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.602965
  Optimal Loss:   0.472651

Task 9:
  Original:       {'model_type': 'CNN', 'feed_sizes': [432, 692, 204, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 732, 224, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.571437
  Optimal Loss:   0.301862

======================================================================
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run1/mnist_condition4_awb_full_run1_run1/classification_mnist_cnn_awb_run1_records.pkl

Training complete!
