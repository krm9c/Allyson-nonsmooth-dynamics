JAX Backend: gpu
JAX Devices: [CudaDevice(id=0)]

Loaded config from: /home/kraghavan/projects/ContLearn/runs__/configs/mnist_condition4_awb_full.json
Problem type: classification
Dataset: mnist
Tasks: 10
AWB enabled: True

Output directory: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run2
Model path: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run2/mnist_condition4_awb_full_run2


############################################################
# Run ID: 2
############################################################
Loading MNIST dataset

============================================================
Task 0
============================================================
Standard CL training (lr=0.000100, adaptive_lr_min=1.00e-06, loss_ratio=1.00)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:19<06:04, 19.19s/it]  5%|▌         | 1/20 [00:24<06:04, 19.19s/it, CE=2.068080e+00 H=2.067644e+00 dV_dx=-3.339394e-08 dV_dθ=-4.364965e-04 ||∇||=4.578916e-01 | Tr=0.4011] 10%|█         | 2/20 [00:24<03:15, 10.86s/it, CE=2.068080e+00 H=2.067644e+00 dV_dx=-3.339394e-08 dV_dθ=-4.364965e-04 ||∇||=4.578916e-01 | Tr=0.4011] 10%|█         | 2/20 [00:29<03:15, 10.86s/it, CE=1.863523e+00 H=1.862708e+00 dV_dx=-5.053509e-08 dV_dθ=-8.147027e-04 ||∇||=6.230969e-01 | Tr=0.4785] 15%|█▌        | 3/20 [00:29<02:19,  8.20s/it, CE=1.863523e+00 H=1.862708e+00 dV_dx=-5.053509e-08 dV_dθ=-8.147027e-04 ||∇||=6.230969e-01 | Tr=0.4785] 15%|█▌        | 3/20 [00:34<02:19,  8.20s/it, CE=1.658066e+00 H=1.657035e+00 dV_dx=4.912976e-07 dV_dθ=-1.031352e-03 ||∇||=7.055055e-01 | Tr=0.5220]  20%|██        | 4/20 [00:34<01:51,  6.95s/it, CE=1.658066e+00 H=1.657035e+00 dV_dx=4.912976e-07 dV_dθ=-1.031352e-03 ||∇||=7.055055e-01 | Tr=0.5220] 20%|██        | 4/20 [00:39<01:51,  6.95s/it, CE=1.481559e+00 H=1.480543e+00 dV_dx=-3.313333e-08 dV_dθ=-1.016166e-03 ||∇||=7.090408e-01 | Tr=0.5555] 25%|██▌       | 5/20 [00:39<01:33,  6.24s/it, CE=1.481559e+00 H=1.480543e+00 dV_dx=-3.313333e-08 dV_dθ=-1.016166e-03 ||∇||=7.090408e-01 | Tr=0.5555] 25%|██▌       | 5/20 [00:47<01:33,  6.24s/it, CE=1.348879e+00 H=1.347986e+00 dV_dx=-2.359326e-06 dV_dθ=-8.908046e-04 ||∇||=6.760705e-01 | Tr=0.5818 Te/Cur=0.5893 Te/Exp=0.5861] 30%|███       | 6/20 [00:47<01:36,  6.90s/it, CE=1.348879e+00 H=1.347986e+00 dV_dx=-2.359326e-06 dV_dθ=-8.908046e-04 ||∇||=6.760705e-01 | Tr=0.5818 Te/Cur=0.5893 Te/Exp=0.5861] 30%|███       | 6/20 [00:52<01:36,  6.90s/it, CE=1.249034e+00 H=1.248266e+00 dV_dx=7.402849e-07 dV_dθ=-7.692679e-04 ||∇||=6.416343e-01 | Tr=0.6042]                              35%|███▌      | 7/20 [00:52<01:21,  6.30s/it, CE=1.249034e+00 H=1.248266e+00 dV_dx=7.402849e-07 dV_dθ=-7.692679e-04 ||∇||=6.416343e-01 | Tr=0.6042] 35%|███▌      | 7/20 [00:57<01:21,  6.30s/it, CE=1.172174e+00 H=1.171497e+00 dV_dx=-3.912163e-07 dV_dθ=-6.767348e-04 ||∇||=6.137245e-01 | Tr=0.6223] 40%|████      | 8/20 [00:57<01:09,  5.79s/it, CE=1.172174e+00 H=1.171497e+00 dV_dx=-3.912163e-07 dV_dθ=-6.767348e-04 ||∇||=6.137245e-01 | Tr=0.6223] 40%|████      | 8/20 [01:01<01:09,  5.79s/it, CE=1.111908e+00 H=1.111316e+00 dV_dx=-1.097467e-07 dV_dθ=-5.911506e-04 ||∇||=5.872393e-01 | Tr=0.6390] 45%|████▌     | 9/20 [01:01<00:59,  5.44s/it, CE=1.111908e+00 H=1.111316e+00 dV_dx=-1.097467e-07 dV_dθ=-5.911506e-04 ||∇||=5.872393e-01 | Tr=0.6390] 45%|████▌     | 9/20 [01:06<00:59,  5.44s/it, CE=1.063511e+00 H=1.062979e+00 dV_dx=-9.417597e-07 dV_dθ=-5.313961e-04 ||∇||=5.690068e-01 | Tr=0.6537] 50%|█████     | 10/20 [01:06<00:52,  5.27s/it, CE=1.063511e+00 H=1.062979e+00 dV_dx=-9.417597e-07 dV_dθ=-5.313961e-04 ||∇||=5.690068e-01 | Tr=0.6537] 50%|█████     | 10/20 [01:13<00:52,  5.27s/it, CE=1.023415e+00 H=1.022933e+00 dV_dx=5.852589e-07 dV_dθ=-4.824980e-04 ||∇||=5.544804e-01 | Tr=0.6649 Te/Cur=0.6674 Te/Exp=0.6642] 55%|█████▌    | 11/20 [01:13<00:50,  5.63s/it, CE=1.023415e+00 H=1.022933e+00 dV_dx=5.852589e-07 dV_dθ=-4.824980e-04 ||∇||=5.544804e-01 | Tr=0.6649 Te/Cur=0.6674 Te/Exp=0.6642] 55%|█████▌    | 11/20 [01:18<00:50,  5.63s/it, CE=9.896676e-01 H=9.892195e-01 dV_dx=1.415734e-07 dV_dθ=-4.482157e-04 ||∇||=5.451955e-01 | Tr=0.6758]                             60%|██████    | 12/20 [01:18<00:43,  5.39s/it, CE=9.896676e-01 H=9.892195e-01 dV_dx=1.415734e-07 dV_dθ=-4.482157e-04 ||∇||=5.451955e-01 | Tr=0.6758] 60%|██████    | 12/20 [01:23<00:43,  5.39s/it, CE=9.605456e-01 H=9.601193e-01 dV_dx=-2.161352e-06 dV_dθ=-4.241548e-04 ||∇||=5.398457e-01 | Tr=0.6852] 65%|██████▌   | 13/20 [01:23<00:36,  5.27s/it, CE=9.605456e-01 H=9.601193e-01 dV_dx=-2.161352e-06 dV_dθ=-4.241548e-04 ||∇||=5.398457e-01 | Tr=0.6852] 65%|██████▌   | 13/20 [01:28<00:36,  5.27s/it, CE=9.341975e-01 H=9.337878e-01 dV_dx=-1.218260e-06 dV_dθ=-4.084275e-04 ||∇||=5.373052e-01 | Tr=0.6935] 70%|███████   | 14/20 [01:28<00:31,  5.22s/it, CE=9.341975e-01 H=9.337878e-01 dV_dx=-1.218260e-06 dV_dθ=-4.084275e-04 ||∇||=5.373052e-01 | Tr=0.6935] 70%|███████   | 14/20 [01:33<00:31,  5.22s/it, CE=9.105755e-01 H=9.101785e-01 dV_dx=6.526423e-07 dV_dθ=-3.976968e-04 ||∇||=5.360703e-01 | Tr=0.7003]  75%|███████▌  | 15/20 [01:33<00:25,  5.18s/it, CE=9.105755e-01 H=9.101785e-01 dV_dx=6.526423e-07 dV_dθ=-3.976968e-04 ||∇||=5.360703e-01 | Tr=0.7003] 75%|███████▌  | 15/20 [01:40<00:25,  5.18s/it, CE=8.893326e-01 H=8.889518e-01 dV_dx=-2.034541e-06 dV_dθ=-3.787486e-04 ||∇||=5.314589e-01 | Tr=0.7068 Te/Cur=0.7011 Te/Exp=0.7060] 80%|████████  | 16/20 [01:40<00:22,  5.68s/it, CE=8.893326e-01 H=8.889518e-01 dV_dx=-2.034541e-06 dV_dθ=-3.787486e-04 ||∇||=5.314589e-01 | Tr=0.7068 Te/Cur=0.7011 Te/Exp=0.7060] 80%|████████  | 16/20 [01:45<00:22,  5.68s/it, CE=8.700307e-01 H=8.696577e-01 dV_dx=-6.472812e-07 dV_dθ=-3.723139e-04 ||∇||=5.311463e-01 | Tr=0.7127]                             85%|████████▌ | 17/20 [01:45<00:16,  5.48s/it, CE=8.700307e-01 H=8.696577e-01 dV_dx=-6.472812e-07 dV_dθ=-3.723139e-04 ||∇||=5.311463e-01 | Tr=0.7127] 85%|████████▌ | 17/20 [01:50<00:16,  5.48s/it, CE=8.524456e-01 H=8.520757e-01 dV_dx=-9.445956e-08 dV_dθ=-3.698554e-04 ||∇||=5.329053e-01 | Tr=0.7188] 90%|█████████ | 18/20 [01:50<00:10,  5.40s/it, CE=8.524456e-01 H=8.520757e-01 dV_dx=-9.445956e-08 dV_dθ=-3.698554e-04 ||∇||=5.329053e-01 | Tr=0.7188] 90%|█████████ | 18/20 [01:55<00:10,  5.40s/it, CE=8.361963e-01 H=8.358281e-01 dV_dx=6.464915e-07 dV_dθ=-3.688236e-04 ||∇||=5.351449e-01 | Tr=0.7242]  95%|█████████▌| 19/20 [01:55<00:05,  5.29s/it, CE=8.361963e-01 H=8.358281e-01 dV_dx=6.464915e-07 dV_dθ=-3.688236e-04 ||∇||=5.351449e-01 | Tr=0.7242] 95%|█████████▌| 19/20 [02:02<00:05,  5.29s/it, CE=8.210454e-01 H=8.206766e-01 dV_dx=-3.375911e-07 dV_dθ=-3.683981e-04 ||∇||=5.369517e-01 | Tr=0.7290 Te/Cur=0.7245 Te/Exp=0.7282]100%|██████████| 20/20 [02:02<00:00,  5.70s/it, CE=8.210454e-01 H=8.206766e-01 dV_dx=-3.375911e-07 dV_dθ=-3.683981e-04 ||∇||=5.369517e-01 | Tr=0.7290 Te/Cur=0.7245 Te/Exp=0.7282]100%|██████████| 20/20 [02:02<00:00,  6.10s/it, CE=8.210454e-01 H=8.206766e-01 dV_dx=-3.375911e-07 dV_dθ=-3.683981e-04 ||∇||=5.369517e-01 | Tr=0.7290 Te/Cur=0.7245 Te/Exp=0.7282]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

  Evaluating on all tasks 0..0 for CL metrics...
    Task 0: 0.7283

============================================================
Task 1
============================================================
Initial loss on new task: 6.0550, previous: 0.8210, ratio: 7.37
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 1
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:10<?, ?it/s, CE=9.509697e-01 H=9.522294e-01 dV_dx=-1.998113e-05 dV_dθ=1.279667e-03 ||∇||=2.273607e+00 | Tr=0.5107 Te/Cur=0.7377 Te/Exp=0.7224]100%|██████████| 1/1 [00:10<00:00, 10.41s/it, CE=9.509697e-01 H=9.522294e-01 dV_dx=-1.998113e-05 dV_dθ=1.279667e-03 ||∇||=2.273607e+00 | Tr=0.5107 Te/Cur=0.7377 Te/Exp=0.7224]100%|██████████| 1/1 [00:10<00:00, 10.41s/it, CE=9.509697e-01 H=9.522294e-01 dV_dx=-1.998113e-05 dV_dθ=1.279667e-03 ||∇||=2.273607e+00 | Tr=0.5107 Te/Cur=0.7377 Te/Exp=0.7224]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.950970

[STEP 2] Architecture change decision
  Current: 0.950970, Previous: 0.821045
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 9416 samples from 10 classes
  Starting grid architecture search for task 1
  Baseline architecture: (3, [507, 512, 64, 10])
  Baseline loss: 0.950970
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.52s/it] 50%|█████     | 1/2 [00:17<00:14, 14.52s/it, CE=2.320593e+00 H=2.320490e+00 dV_dx=-1.677269e-05 dV_dθ=-8.611332e-05 ||∇||=3.267758e-01 | Tr=0.0897 Te/Cur=0.0963 Te/Exp=0.1353]100%|██████████| 2/2 [00:17<00:00,  8.02s/it, CE=2.320593e+00 H=2.320490e+00 dV_dx=-1.677269e-05 dV_dθ=-8.611332e-05 ||∇||=3.267758e-01 | Tr=0.0897 Te/Cur=0.0963 Te/Exp=0.1353]100%|██████████| 2/2 [00:17<00:00,  8.99s/it, CE=2.320593e+00 H=2.320490e+00 dV_dx=-1.677269e-05 dV_dθ=-8.611332e-05 ||∇||=3.267758e-01 | Tr=0.0897 Te/Cur=0.0963 Te/Exp=0.1353]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.3205929738078215
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.13s/it] 50%|█████     | 1/2 [00:15<00:13, 13.13s/it, CE=2.317387e+00 H=2.317309e+00 dV_dx=7.756903e-06 dV_dθ=-8.495735e-05 ||∇||=3.243076e-01 | Tr=0.1146 Te/Cur=0.1218 Te/Exp=0.1750]100%|██████████| 2/2 [00:15<00:00,  7.00s/it, CE=2.317387e+00 H=2.317309e+00 dV_dx=7.756903e-06 dV_dθ=-8.495735e-05 ||∇||=3.243076e-01 | Tr=0.1146 Te/Cur=0.1218 Te/Exp=0.1750]100%|██████████| 2/2 [00:15<00:00,  7.92s/it, CE=2.317387e+00 H=2.317309e+00 dV_dx=7.756903e-06 dV_dθ=-8.495735e-05 ||∇||=3.243076e-01 | Tr=0.1146 Te/Cur=0.1218 Te/Exp=0.1750]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 44, 10]) with loss 2.317387
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.84s/it] 50%|█████     | 1/2 [00:16<00:13, 13.84s/it, CE=2.331458e+00 H=2.331371e+00 dV_dx=1.042213e-06 dV_dθ=-8.758416e-05 ||∇||=3.214373e-01 | Tr=0.1191 Te/Cur=0.1280 Te/Exp=0.1254]100%|██████████| 2/2 [00:16<00:00,  7.55s/it, CE=2.331458e+00 H=2.331371e+00 dV_dx=1.042213e-06 dV_dθ=-8.758416e-05 ||∇||=3.214373e-01 | Tr=0.1191 Te/Cur=0.1280 Te/Exp=0.1254]100%|██████████| 2/2 [00:16<00:00,  8.49s/it, CE=2.331458e+00 H=2.331371e+00 dV_dx=1.042213e-06 dV_dθ=-8.758416e-05 ||∇||=3.214373e-01 | Tr=0.1191 Te/Cur=0.1280 Te/Exp=0.1254]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.02s/it] 50%|█████     | 1/2 [00:15<00:13, 13.02s/it, CE=2.324972e+00 H=2.324890e+00 dV_dx=9.636966e-06 dV_dθ=-9.151063e-05 ||∇||=3.180138e-01 | Tr=0.1223 Te/Cur=0.1260 Te/Exp=0.0966]100%|██████████| 2/2 [00:15<00:00,  6.97s/it, CE=2.324972e+00 H=2.324890e+00 dV_dx=9.636966e-06 dV_dθ=-9.151063e-05 ||∇||=3.180138e-01 | Tr=0.1223 Te/Cur=0.1260 Te/Exp=0.0966]100%|██████████| 2/2 [00:15<00:00,  7.88s/it, CE=2.324972e+00 H=2.324890e+00 dV_dx=9.636966e-06 dV_dθ=-9.151063e-05 ||∇||=3.180138e-01 | Tr=0.1223 Te/Cur=0.1260 Te/Exp=0.0966]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.90s/it] 50%|█████     | 1/2 [00:15<00:12, 12.90s/it, CE=2.317041e+00 H=2.316932e+00 dV_dx=-6.437239e-07 dV_dθ=-1.088940e-04 ||∇||=3.878667e-01 | Tr=0.0997 Te/Cur=0.0983 Te/Exp=0.1031]100%|██████████| 2/2 [00:15<00:00,  6.77s/it, CE=2.317041e+00 H=2.316932e+00 dV_dx=-6.437239e-07 dV_dθ=-1.088940e-04 ||∇||=3.878667e-01 | Tr=0.0997 Te/Cur=0.0983 Te/Exp=0.1031]100%|██████████| 2/2 [00:15<00:00,  7.69s/it, CE=2.317041e+00 H=2.316932e+00 dV_dx=-6.437239e-07 dV_dθ=-1.088940e-04 ||∇||=3.878667e-01 | Tr=0.0997 Te/Cur=0.0983 Te/Exp=0.1031]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 64, 10]) with loss 2.317041
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.57s/it] 50%|█████     | 1/2 [00:14<00:12, 12.57s/it, CE=2.329894e+00 H=2.329770e+00 dV_dx=2.178426e-05 dV_dθ=-1.457672e-04 ||∇||=3.898666e-01 | Tr=0.1727 Te/Cur=0.1656 Te/Exp=0.1318]100%|██████████| 2/2 [00:14<00:00,  6.36s/it, CE=2.329894e+00 H=2.329770e+00 dV_dx=2.178426e-05 dV_dθ=-1.457672e-04 ||∇||=3.898666e-01 | Tr=0.1727 Te/Cur=0.1656 Te/Exp=0.1318]100%|██████████| 2/2 [00:14<00:00,  7.30s/it, CE=2.329894e+00 H=2.329770e+00 dV_dx=2.178426e-05 dV_dθ=-1.457672e-04 ||∇||=3.898666e-01 | Tr=0.1727 Te/Cur=0.1656 Te/Exp=0.1318]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.68s/it] 50%|█████     | 1/2 [00:15<00:12, 12.68s/it, CE=2.296761e+00 H=2.296634e+00 dV_dx=-1.408267e-05 dV_dθ=-1.134950e-04 ||∇||=3.586112e-01 | Tr=0.1200 Te/Cur=0.1377 Te/Exp=0.2140]100%|██████████| 2/2 [00:15<00:00,  7.15s/it, CE=2.296761e+00 H=2.296634e+00 dV_dx=-1.408267e-05 dV_dθ=-1.134950e-04 ||∇||=3.586112e-01 | Tr=0.1200 Te/Cur=0.1377 Te/Exp=0.2140]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.296761e+00 H=2.296634e+00 dV_dx=-1.408267e-05 dV_dθ=-1.134950e-04 ||∇||=3.586112e-01 | Tr=0.1200 Te/Cur=0.1377 Te/Exp=0.2140]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 492, 84, 10]) with loss 2.296761
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.71s/it] 50%|█████     | 1/2 [00:15<00:12, 12.71s/it, CE=2.287456e+00 H=2.287363e+00 dV_dx=-2.023745e-06 dV_dθ=-9.138010e-05 ||∇||=3.602063e-01 | Tr=0.1352 Te/Cur=0.1666 Te/Exp=0.1822]100%|██████████| 2/2 [00:15<00:00,  7.05s/it, CE=2.287456e+00 H=2.287363e+00 dV_dx=-2.023745e-06 dV_dθ=-9.138010e-05 ||∇||=3.602063e-01 | Tr=0.1352 Te/Cur=0.1666 Te/Exp=0.1822]100%|██████████| 2/2 [00:15<00:00,  7.90s/it, CE=2.287456e+00 H=2.287363e+00 dV_dx=-2.023745e-06 dV_dθ=-9.138010e-05 ||∇||=3.602063e-01 | Tr=0.1352 Te/Cur=0.1666 Te/Exp=0.1822]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 512, 84, 10]) with loss 2.287456
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.78s/it] 50%|█████     | 1/2 [00:15<00:12, 12.78s/it, CE=2.293791e+00 H=2.293653e+00 dV_dx=-4.275068e-06 dV_dθ=-1.336968e-04 ||∇||=3.844041e-01 | Tr=0.1045 Te/Cur=0.1195 Te/Exp=0.1127]100%|██████████| 2/2 [00:15<00:00,  7.15s/it, CE=2.293791e+00 H=2.293653e+00 dV_dx=-4.275068e-06 dV_dθ=-1.336968e-04 ||∇||=3.844041e-01 | Tr=0.1045 Te/Cur=0.1195 Te/Exp=0.1127]100%|██████████| 2/2 [00:15<00:00,  8.00s/it, CE=2.293791e+00 H=2.293653e+00 dV_dx=-4.275068e-06 dV_dθ=-1.336968e-04 ||∇||=3.844041e-01 | Tr=0.1045 Te/Cur=0.1195 Te/Exp=0.1127]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.52s/it] 50%|█████     | 1/2 [00:15<00:12, 12.52s/it, CE=2.314381e+00 H=2.314285e+00 dV_dx=-2.925256e-06 dV_dθ=-9.340960e-05 ||∇||=4.359784e-01 | Tr=0.1388 Te/Cur=0.1140 Te/Exp=0.1387]100%|██████████| 2/2 [00:15<00:00,  6.74s/it, CE=2.314381e+00 H=2.314285e+00 dV_dx=-2.925256e-06 dV_dθ=-9.340960e-05 ||∇||=4.359784e-01 | Tr=0.1388 Te/Cur=0.1140 Te/Exp=0.1387]100%|██████████| 2/2 [00:15<00:00,  7.61s/it, CE=2.314381e+00 H=2.314285e+00 dV_dx=-2.925256e-06 dV_dθ=-9.340960e-05 ||∇||=4.359784e-01 | Tr=0.1388 Te/Cur=0.1140 Te/Exp=0.1387]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.60s/it] 50%|█████     | 1/2 [00:16<00:12, 12.60s/it, CE=2.300909e+00 H=2.300861e+00 dV_dx=5.649975e-06 dV_dθ=-5.363351e-05 ||∇||=3.986876e-01 | Tr=0.1282 Te/Cur=0.1158 Te/Exp=0.1408]100%|██████████| 2/2 [00:16<00:00,  7.30s/it, CE=2.300909e+00 H=2.300861e+00 dV_dx=5.649975e-06 dV_dθ=-5.363351e-05 ||∇||=3.986876e-01 | Tr=0.1282 Te/Cur=0.1158 Te/Exp=0.1408]100%|██████████| 2/2 [00:16<00:00,  8.09s/it, CE=2.300909e+00 H=2.300861e+00 dV_dx=5.649975e-06 dV_dθ=-5.363351e-05 ||∇||=3.986876e-01 | Tr=0.1282 Te/Cur=0.1158 Te/Exp=0.1408]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.36s/it] 50%|█████     | 1/2 [00:16<00:13, 13.36s/it, CE=2.303030e+00 H=2.302954e+00 dV_dx=1.126486e-05 dV_dθ=-8.825417e-05 ||∇||=4.164567e-01 | Tr=0.1013 Te/Cur=0.1018 Te/Exp=0.1190]100%|██████████| 2/2 [00:16<00:00,  7.10s/it, CE=2.303030e+00 H=2.302954e+00 dV_dx=1.126486e-05 dV_dθ=-8.825417e-05 ||∇||=4.164567e-01 | Tr=0.1013 Te/Cur=0.1018 Te/Exp=0.1190]100%|██████████| 2/2 [00:16<00:00,  8.04s/it, CE=2.303030e+00 H=2.302954e+00 dV_dx=1.126486e-05 dV_dθ=-8.825417e-05 ||∇||=4.164567e-01 | Tr=0.1013 Te/Cur=0.1018 Te/Exp=0.1190]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.62s/it] 50%|█████     | 1/2 [00:15<00:12, 12.62s/it, CE=2.308160e+00 H=2.308003e+00 dV_dx=-1.283278e-05 dV_dθ=-1.444698e-04 ||∇||=4.226259e-01 | Tr=0.1660 Te/Cur=0.1713 Te/Exp=0.0994]100%|██████████| 2/2 [00:15<00:00,  7.08s/it, CE=2.308160e+00 H=2.308003e+00 dV_dx=-1.283278e-05 dV_dθ=-1.444698e-04 ||∇||=4.226259e-01 | Tr=0.1660 Te/Cur=0.1713 Te/Exp=0.0994]100%|██████████| 2/2 [00:15<00:00,  7.91s/it, CE=2.308160e+00 H=2.308003e+00 dV_dx=-1.283278e-05 dV_dθ=-1.444698e-04 ||∇||=4.226259e-01 | Tr=0.1660 Te/Cur=0.1713 Te/Exp=0.0994]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.35s/it] 50%|█████     | 1/2 [00:10<00:07,  7.35s/it, CE=2.291764e+00 H=2.291630e+00 dV_dx=-9.795497e-06 dV_dθ=-1.238318e-04 ||∇||=4.782676e-01 | Tr=0.1666 Te/Cur=0.1858 Te/Exp=0.1809]100%|██████████| 2/2 [00:10<00:00,  4.72s/it, CE=2.291764e+00 H=2.291630e+00 dV_dx=-9.795497e-06 dV_dθ=-1.238318e-04 ||∇||=4.782676e-01 | Tr=0.1666 Te/Cur=0.1858 Te/Exp=0.1809]100%|██████████| 2/2 [00:10<00:00,  5.11s/it, CE=2.291764e+00 H=2.291630e+00 dV_dx=-9.795497e-06 dV_dθ=-1.238318e-04 ||∇||=4.782676e-01 | Tr=0.1666 Te/Cur=0.1858 Te/Exp=0.1809]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.41s/it] 50%|█████     | 1/2 [00:15<00:12, 12.41s/it, CE=2.311988e+00 H=2.311819e+00 dV_dx=-5.541830e-06 dV_dθ=-1.641056e-04 ||∇||=4.775190e-01 | Tr=0.0912 Te/Cur=0.1127 Te/Exp=0.1596]100%|██████████| 2/2 [00:15<00:00,  6.87s/it, CE=2.311988e+00 H=2.311819e+00 dV_dx=-5.541830e-06 dV_dθ=-1.641056e-04 ||∇||=4.775190e-01 | Tr=0.0912 Te/Cur=0.1127 Te/Exp=0.1596]100%|██████████| 2/2 [00:15<00:00,  7.70s/it, CE=2.311988e+00 H=2.311819e+00 dV_dx=-5.541830e-06 dV_dθ=-1.641056e-04 ||∇||=4.775190e-01 | Tr=0.0912 Te/Cur=0.1127 Te/Exp=0.1596]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.73s/it] 50%|█████     | 1/2 [00:15<00:12, 12.73s/it, CE=2.274131e+00 H=2.273977e+00 dV_dx=-1.106116e-05 dV_dθ=-1.431120e-04 ||∇||=4.551008e-01 | Tr=0.1278 Te/Cur=0.1183 Te/Exp=0.2082]100%|██████████| 2/2 [00:15<00:00,  6.65s/it, CE=2.274131e+00 H=2.273977e+00 dV_dx=-1.106116e-05 dV_dθ=-1.431120e-04 ||∇||=4.551008e-01 | Tr=0.1278 Te/Cur=0.1183 Te/Exp=0.2082]100%|██████████| 2/2 [00:15<00:00,  7.56s/it, CE=2.274131e+00 H=2.273977e+00 dV_dx=-1.106116e-05 dV_dθ=-1.431120e-04 ||∇||=4.551008e-01 | Tr=0.1278 Te/Cur=0.1183 Te/Exp=0.2082]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 492, 84, 10]) with loss 2.274131
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.34s/it] 50%|█████     | 1/2 [00:15<00:12, 12.34s/it, CE=2.273472e+00 H=2.273368e+00 dV_dx=-8.628553e-06 dV_dθ=-9.493115e-05 ||∇||=4.498591e-01 | Tr=0.1514 Te/Cur=0.1689 Te/Exp=0.1900]100%|██████████| 2/2 [00:15<00:00,  6.73s/it, CE=2.273472e+00 H=2.273368e+00 dV_dx=-8.628553e-06 dV_dθ=-9.493115e-05 ||∇||=4.498591e-01 | Tr=0.1514 Te/Cur=0.1689 Te/Exp=0.1900]100%|██████████| 2/2 [00:15<00:00,  7.57s/it, CE=2.273472e+00 H=2.273368e+00 dV_dx=-8.628553e-06 dV_dθ=-9.493115e-05 ||∇||=4.498591e-01 | Tr=0.1514 Te/Cur=0.1689 Te/Exp=0.1900]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 512, 84, 10]) with loss 2.273472
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.27s/it] 50%|█████     | 1/2 [00:16<00:13, 13.27s/it, CE=2.271229e+00 H=2.271144e+00 dV_dx=4.767379e-06 dV_dθ=-8.952294e-05 ||∇||=4.507973e-01 | Tr=0.1109 Te/Cur=0.1258 Te/Exp=0.1757]100%|██████████| 2/2 [00:16<00:00,  7.22s/it, CE=2.271229e+00 H=2.271144e+00 dV_dx=4.767379e-06 dV_dθ=-8.952294e-05 ||∇||=4.507973e-01 | Tr=0.1109 Te/Cur=0.1258 Te/Exp=0.1757]100%|██████████| 2/2 [00:16<00:00,  8.13s/it, CE=2.271229e+00 H=2.271144e+00 dV_dx=4.767379e-06 dV_dθ=-8.952294e-05 ||∇||=4.507973e-01 | Tr=0.1109 Te/Cur=0.1258 Te/Exp=0.1757]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 532, 84, 10]) with loss 2.271229
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.03s/it] 50%|█████     | 1/2 [00:16<00:13, 13.03s/it, CE=2.333473e+00 H=2.333408e+00 dV_dx=1.462222e-05 dV_dθ=-7.993118e-05 ||∇||=4.259927e-01 | Tr=0.1079 Te/Cur=0.1128 Te/Exp=0.1002]100%|██████████| 2/2 [00:16<00:00,  7.37s/it, CE=2.333473e+00 H=2.333408e+00 dV_dx=1.462222e-05 dV_dθ=-7.993118e-05 ||∇||=4.259927e-01 | Tr=0.1079 Te/Cur=0.1128 Te/Exp=0.1002]100%|██████████| 2/2 [00:16<00:00,  8.22s/it, CE=2.333473e+00 H=2.333408e+00 dV_dx=1.462222e-05 dV_dθ=-7.993118e-05 ||∇||=4.259927e-01 | Tr=0.1079 Te/Cur=0.1128 Te/Exp=0.1002]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.49s/it] 50%|█████     | 1/2 [00:15<00:13, 13.49s/it, CE=2.313158e+00 H=2.313087e+00 dV_dx=-4.299623e-06 dV_dθ=-6.650559e-05 ||∇||=3.925042e-01 | Tr=0.1329 Te/Cur=0.1415 Te/Exp=0.1801]100%|██████████| 2/2 [00:15<00:00,  6.89s/it, CE=2.313158e+00 H=2.313087e+00 dV_dx=-4.299623e-06 dV_dθ=-6.650559e-05 ||∇||=3.925042e-01 | Tr=0.1329 Te/Cur=0.1415 Te/Exp=0.1801]100%|██████████| 2/2 [00:15<00:00,  7.88s/it, CE=2.313158e+00 H=2.313087e+00 dV_dx=-4.299623e-06 dV_dθ=-6.650559e-05 ||∇||=3.925042e-01 | Tr=0.1329 Te/Cur=0.1415 Te/Exp=0.1801]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.36s/it] 50%|█████     | 1/2 [00:15<00:13, 13.36s/it, CE=2.317207e+00 H=2.317085e+00 dV_dx=-6.507921e-06 dV_dθ=-1.151557e-04 ||∇||=4.268146e-01 | Tr=0.1840 Te/Cur=0.1889 Te/Exp=0.1565]100%|██████████| 2/2 [00:15<00:00,  7.01s/it, CE=2.317207e+00 H=2.317085e+00 dV_dx=-6.507921e-06 dV_dθ=-1.151557e-04 ||∇||=4.268146e-01 | Tr=0.1840 Te/Cur=0.1889 Te/Exp=0.1565]100%|██████████| 2/2 [00:15<00:00,  7.97s/it, CE=2.317207e+00 H=2.317085e+00 dV_dx=-6.507921e-06 dV_dθ=-1.151557e-04 ||∇||=4.268146e-01 | Tr=0.1840 Te/Cur=0.1889 Te/Exp=0.1565]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.39s/it] 50%|█████     | 1/2 [00:15<00:13, 13.39s/it, CE=2.333405e+00 H=2.333303e+00 dV_dx=2.243026e-06 dV_dθ=-1.047940e-04 ||∇||=3.848536e-01 | Tr=0.1347 Te/Cur=0.1343 Te/Exp=0.1149]100%|██████████| 2/2 [00:15<00:00,  6.85s/it, CE=2.333405e+00 H=2.333303e+00 dV_dx=2.243026e-06 dV_dθ=-1.047940e-04 ||∇||=3.848536e-01 | Tr=0.1347 Te/Cur=0.1343 Te/Exp=0.1149]100%|██████████| 2/2 [00:15<00:00,  7.83s/it, CE=2.333405e+00 H=2.333303e+00 dV_dx=2.243026e-06 dV_dθ=-1.047940e-04 ||∇||=3.848536e-01 | Tr=0.1347 Te/Cur=0.1343 Te/Exp=0.1149]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.32s/it] 50%|█████     | 1/2 [00:14<00:12, 12.32s/it, CE=2.318821e+00 H=2.318718e+00 dV_dx=3.911486e-06 dV_dθ=-1.065369e-04 ||∇||=3.921935e-01 | Tr=0.0870 Te/Cur=0.1030 Te/Exp=0.1012]100%|██████████| 2/2 [00:14<00:00,  6.37s/it, CE=2.318821e+00 H=2.318718e+00 dV_dx=3.911486e-06 dV_dθ=-1.065369e-04 ||∇||=3.921935e-01 | Tr=0.0870 Te/Cur=0.1030 Te/Exp=0.1012]100%|██████████| 2/2 [00:14<00:00,  7.26s/it, CE=2.318821e+00 H=2.318718e+00 dV_dx=3.911486e-06 dV_dθ=-1.065369e-04 ||∇||=3.921935e-01 | Tr=0.0870 Te/Cur=0.1030 Te/Exp=0.1012]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.81s/it] 50%|█████     | 1/2 [00:16<00:13, 13.81s/it, CE=2.315250e+00 H=2.315091e+00 dV_dx=1.178733e-05 dV_dθ=-1.703422e-04 ||∇||=4.349536e-01 | Tr=0.1490 Te/Cur=0.1692 Te/Exp=0.1306]100%|██████████| 2/2 [00:16<00:00,  7.12s/it, CE=2.315250e+00 H=2.315091e+00 dV_dx=1.178733e-05 dV_dθ=-1.703422e-04 ||∇||=4.349536e-01 | Tr=0.1490 Te/Cur=0.1692 Te/Exp=0.1306]100%|██████████| 2/2 [00:16<00:00,  8.12s/it, CE=2.315250e+00 H=2.315091e+00 dV_dx=1.178733e-05 dV_dθ=-1.703422e-04 ||∇||=4.349536e-01 | Tr=0.1490 Te/Cur=0.1692 Te/Exp=0.1306]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.89s/it] 50%|█████     | 1/2 [00:15<00:12, 12.89s/it, CE=2.306270e+00 H=2.306133e+00 dV_dx=1.077842e-06 dV_dθ=-1.376770e-04 ||∇||=4.257599e-01 | Tr=0.1649 Te/Cur=0.1793 Te/Exp=0.1615]100%|██████████| 2/2 [00:15<00:00,  6.84s/it, CE=2.306270e+00 H=2.306133e+00 dV_dx=1.077842e-06 dV_dθ=-1.376770e-04 ||∇||=4.257599e-01 | Tr=0.1649 Te/Cur=0.1793 Te/Exp=0.1615]100%|██████████| 2/2 [00:15<00:00,  7.74s/it, CE=2.306270e+00 H=2.306133e+00 dV_dx=1.077842e-06 dV_dθ=-1.376770e-04 ||∇||=4.257599e-01 | Tr=0.1649 Te/Cur=0.1793 Te/Exp=0.1615]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.10s/it] 50%|█████     | 1/2 [00:14<00:12, 12.10s/it, CE=2.284209e+00 H=2.284101e+00 dV_dx=1.278200e-05 dV_dθ=-1.201092e-04 ||∇||=4.276524e-01 | Tr=0.1290 Te/Cur=0.1288 Te/Exp=0.2084]100%|██████████| 2/2 [00:14<00:00,  6.50s/it, CE=2.284209e+00 H=2.284101e+00 dV_dx=1.278200e-05 dV_dθ=-1.201092e-04 ||∇||=4.276524e-01 | Tr=0.1290 Te/Cur=0.1288 Te/Exp=0.2084]100%|██████████| 2/2 [00:14<00:00,  7.34s/it, CE=2.284209e+00 H=2.284101e+00 dV_dx=1.278200e-05 dV_dθ=-1.201092e-04 ||∇||=4.276524e-01 | Tr=0.1290 Te/Cur=0.1288 Te/Exp=0.2084]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.12s/it] 50%|█████     | 1/2 [00:15<00:13, 13.12s/it, CE=2.281042e+00 H=2.280943e+00 dV_dx=1.903474e-05 dV_dθ=-1.180922e-04 ||∇||=4.794715e-01 | Tr=0.1060 Te/Cur=0.1329 Te/Exp=0.1622]100%|██████████| 2/2 [00:15<00:00,  6.93s/it, CE=2.281042e+00 H=2.280943e+00 dV_dx=1.903474e-05 dV_dθ=-1.180922e-04 ||∇||=4.794715e-01 | Tr=0.1060 Te/Cur=0.1329 Te/Exp=0.1622]100%|██████████| 2/2 [00:15<00:00,  7.86s/it, CE=2.281042e+00 H=2.280943e+00 dV_dx=1.903474e-05 dV_dθ=-1.180922e-04 ||∇||=4.794715e-01 | Tr=0.1060 Te/Cur=0.1329 Te/Exp=0.1622]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.39s/it] 50%|█████     | 1/2 [00:07<00:04,  4.39s/it, CE=2.310909e+00 H=2.310691e+00 dV_dx=-2.796226e-06 dV_dθ=-2.159935e-04 ||∇||=5.170476e-01 | Tr=0.1142 Te/Cur=0.1260 Te/Exp=0.1437]100%|██████████| 2/2 [00:07<00:00,  3.40s/it, CE=2.310909e+00 H=2.310691e+00 dV_dx=-2.796226e-06 dV_dθ=-2.159935e-04 ||∇||=5.170476e-01 | Tr=0.1142 Te/Cur=0.1260 Te/Exp=0.1437]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.310909e+00 H=2.310691e+00 dV_dx=-2.796226e-06 dV_dθ=-2.159935e-04 ||∇||=5.170476e-01 | Tr=0.1142 Te/Cur=0.1260 Te/Exp=0.1437]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.3109094565998074
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.66s/it] 50%|█████     | 1/2 [00:07<00:04,  4.66s/it, CE=2.304605e+00 H=2.304505e+00 dV_dx=1.207955e-05 dV_dθ=-1.123310e-04 ||∇||=4.371539e-01 | Tr=0.1619 Te/Cur=0.1876 Te/Exp=0.1322]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.304605e+00 H=2.304505e+00 dV_dx=1.207955e-05 dV_dθ=-1.123310e-04 ||∇||=4.371539e-01 | Tr=0.1619 Te/Cur=0.1876 Te/Exp=0.1322]100%|██████████| 2/2 [00:07<00:00,  3.79s/it, CE=2.304605e+00 H=2.304505e+00 dV_dx=1.207955e-05 dV_dθ=-1.123310e-04 ||∇||=4.371539e-01 | Tr=0.1619 Te/Cur=0.1876 Te/Exp=0.1322]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 44, 10]) with loss 2.304605
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.55s/it] 50%|█████     | 1/2 [00:17<00:14, 14.55s/it, CE=2.328364e+00 H=2.328233e+00 dV_dx=5.685827e-06 dV_dθ=-1.359263e-04 ||∇||=4.242495e-01 | Tr=0.0660 Te/Cur=0.0501 Te/Exp=0.1063]100%|██████████| 2/2 [00:17<00:00,  7.69s/it, CE=2.328364e+00 H=2.328233e+00 dV_dx=5.685827e-06 dV_dθ=-1.359263e-04 ||∇||=4.242495e-01 | Tr=0.0660 Te/Cur=0.0501 Te/Exp=0.1063]100%|██████████| 2/2 [00:17<00:00,  8.72s/it, CE=2.328364e+00 H=2.328233e+00 dV_dx=5.685827e-06 dV_dθ=-1.359263e-04 ||∇||=4.242495e-01 | Tr=0.0660 Te/Cur=0.0501 Te/Exp=0.1063]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.47s/it] 50%|█████     | 1/2 [00:06<00:03,  3.47s/it, CE=2.287160e+00 H=2.287006e+00 dV_dx=1.445436e-05 dV_dθ=-1.683220e-04 ||∇||=4.687436e-01 | Tr=0.1176 Te/Cur=0.1215 Te/Exp=0.2485]100%|██████████| 2/2 [00:06<00:00,  3.09s/it, CE=2.287160e+00 H=2.287006e+00 dV_dx=1.445436e-05 dV_dθ=-1.683220e-04 ||∇||=4.687436e-01 | Tr=0.1176 Te/Cur=0.1215 Te/Exp=0.2485]100%|██████████| 2/2 [00:06<00:00,  3.15s/it, CE=2.287160e+00 H=2.287006e+00 dV_dx=1.445436e-05 dV_dθ=-1.683220e-04 ||∇||=4.687436e-01 | Tr=0.1176 Te/Cur=0.1215 Te/Exp=0.2485]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 492, 84, 10]) with loss 2.287160
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.33s/it] 50%|█████     | 1/2 [00:06<00:04,  4.33s/it, CE=2.277996e+00 H=2.277862e+00 dV_dx=6.355305e-06 dV_dθ=-1.401195e-04 ||∇||=4.699699e-01 | Tr=0.1647 Te/Cur=0.1769 Te/Exp=0.2726]100%|██████████| 2/2 [00:06<00:00,  3.35s/it, CE=2.277996e+00 H=2.277862e+00 dV_dx=6.355305e-06 dV_dθ=-1.401195e-04 ||∇||=4.699699e-01 | Tr=0.1647 Te/Cur=0.1769 Te/Exp=0.2726]100%|██████████| 2/2 [00:06<00:00,  3.50s/it, CE=2.277996e+00 H=2.277862e+00 dV_dx=6.355305e-06 dV_dθ=-1.401195e-04 ||∇||=4.699699e-01 | Tr=0.1647 Te/Cur=0.1769 Te/Exp=0.2726]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 84, 10]) with loss 2.277996
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.77s/it] 50%|█████     | 1/2 [00:16<00:13, 13.77s/it, CE=2.287873e+00 H=2.287808e+00 dV_dx=4.435904e-06 dV_dθ=-6.995409e-05 ||∇||=4.648081e-01 | Tr=0.1089 Te/Cur=0.1325 Te/Exp=0.1089]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.287873e+00 H=2.287808e+00 dV_dx=4.435904e-06 dV_dθ=-6.995409e-05 ||∇||=4.648081e-01 | Tr=0.1089 Te/Cur=0.1325 Te/Exp=0.1089]100%|██████████| 2/2 [00:16<00:00,  8.34s/it, CE=2.287873e+00 H=2.287808e+00 dV_dx=4.435904e-06 dV_dθ=-6.995409e-05 ||∇||=4.648081e-01 | Tr=0.1089 Te/Cur=0.1325 Te/Exp=0.1089]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.09s/it] 50%|█████     | 1/2 [00:16<00:13, 13.09s/it, CE=2.277369e+00 H=2.277317e+00 dV_dx=-8.492062e-06 dV_dθ=-4.363718e-05 ||∇||=4.852731e-01 | Tr=0.1691 Te/Cur=0.1876 Te/Exp=0.1957]100%|██████████| 2/2 [00:16<00:00,  7.18s/it, CE=2.277369e+00 H=2.277317e+00 dV_dx=-8.492062e-06 dV_dθ=-4.363718e-05 ||∇||=4.852731e-01 | Tr=0.1691 Te/Cur=0.1876 Te/Exp=0.1957]100%|██████████| 2/2 [00:16<00:00,  8.07s/it, CE=2.277369e+00 H=2.277317e+00 dV_dx=-8.492062e-06 dV_dθ=-4.363718e-05 ||∇||=4.852731e-01 | Tr=0.1691 Te/Cur=0.1876 Te/Exp=0.1957]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 492, 124, 10]) with loss 2.277369
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.47s/it] 50%|█████     | 1/2 [00:16<00:13, 13.47s/it, CE=2.276957e+00 H=2.276823e+00 dV_dx=-9.730191e-07 dV_dθ=-1.335254e-04 ||∇||=4.444378e-01 | Tr=0.1837 Te/Cur=0.2572 Te/Exp=0.2914]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.276957e+00 H=2.276823e+00 dV_dx=-9.730191e-07 dV_dθ=-1.335254e-04 ||∇||=4.444378e-01 | Tr=0.1837 Te/Cur=0.2572 Te/Exp=0.2914]100%|██████████| 2/2 [00:16<00:00,  8.22s/it, CE=2.276957e+00 H=2.276823e+00 dV_dx=-9.730191e-07 dV_dθ=-1.335254e-04 ||∇||=4.444378e-01 | Tr=0.1837 Te/Cur=0.2572 Te/Exp=0.2914]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 124, 10]) with loss 2.276957
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.57s/it] 50%|█████     | 1/2 [00:15<00:12, 12.57s/it, CE=2.278527e+00 H=2.278376e+00 dV_dx=-1.465707e-07 dV_dθ=-1.507539e-04 ||∇||=5.029581e-01 | Tr=0.1866 Te/Cur=0.2825 Te/Exp=0.1418]100%|██████████| 2/2 [00:15<00:00,  6.93s/it, CE=2.278527e+00 H=2.278376e+00 dV_dx=-1.465707e-07 dV_dθ=-1.507539e-04 ||∇||=5.029581e-01 | Tr=0.1866 Te/Cur=0.2825 Te/Exp=0.1418]100%|██████████| 2/2 [00:15<00:00,  7.78s/it, CE=2.278527e+00 H=2.278376e+00 dV_dx=-1.465707e-07 dV_dθ=-1.507539e-04 ||∇||=5.029581e-01 | Tr=0.1866 Te/Cur=0.2825 Te/Exp=0.1418]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.22s/it] 50%|█████     | 1/2 [00:07<00:04,  4.22s/it, CE=2.287157e+00 H=2.286994e+00 dV_dx=1.073962e-05 dV_dθ=-1.744985e-04 ||∇||=4.315856e-01 | Tr=0.1522 Te/Cur=0.1714 Te/Exp=0.1271]100%|██████████| 2/2 [00:07<00:00,  3.49s/it, CE=2.287157e+00 H=2.286994e+00 dV_dx=1.073962e-05 dV_dθ=-1.744985e-04 ||∇||=4.315856e-01 | Tr=0.1522 Te/Cur=0.1714 Te/Exp=0.1271]100%|██████████| 2/2 [00:07<00:00,  3.60s/it, CE=2.287157e+00 H=2.286994e+00 dV_dx=1.073962e-05 dV_dθ=-1.744985e-04 ||∇||=4.315856e-01 | Tr=0.1522 Te/Cur=0.1714 Te/Exp=0.1271]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.19s/it] 50%|█████     | 1/2 [00:08<00:04,  4.19s/it, CE=2.285436e+00 H=2.285348e+00 dV_dx=4.251931e-06 dV_dθ=-9.227411e-05 ||∇||=4.008757e-01 | Tr=0.1159 Te/Cur=0.1294 Te/Exp=0.1204]100%|██████████| 2/2 [00:08<00:00,  4.07s/it, CE=2.285436e+00 H=2.285348e+00 dV_dx=4.251931e-06 dV_dθ=-9.227411e-05 ||∇||=4.008757e-01 | Tr=0.1159 Te/Cur=0.1294 Te/Exp=0.1204]100%|██████████| 2/2 [00:08<00:00,  4.09s/it, CE=2.285436e+00 H=2.285348e+00 dV_dx=4.251931e-06 dV_dθ=-9.227411e-05 ||∇||=4.008757e-01 | Tr=0.1159 Te/Cur=0.1294 Te/Exp=0.1204]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.09s/it] 50%|█████     | 1/2 [00:15<00:13, 13.09s/it, CE=2.301927e+00 H=2.301821e+00 dV_dx=1.664995e-05 dV_dθ=-1.220133e-04 ||∇||=3.945040e-01 | Tr=0.1136 Te/Cur=0.1237 Te/Exp=0.1319]100%|██████████| 2/2 [00:15<00:00,  7.06s/it, CE=2.301927e+00 H=2.301821e+00 dV_dx=1.664995e-05 dV_dθ=-1.220133e-04 ||∇||=3.945040e-01 | Tr=0.1136 Te/Cur=0.1237 Te/Exp=0.1319]100%|██████████| 2/2 [00:15<00:00,  7.97s/it, CE=2.301927e+00 H=2.301821e+00 dV_dx=1.664995e-05 dV_dθ=-1.220133e-04 ||∇||=3.945040e-01 | Tr=0.1136 Te/Cur=0.1237 Te/Exp=0.1319]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.89s/it] 50%|█████     | 1/2 [00:06<00:03,  3.89s/it, CE=2.251124e+00 H=2.251016e+00 dV_dx=-8.730344e-06 dV_dθ=-9.887753e-05 ||∇||=4.714648e-01 | Tr=0.2171 Te/Cur=0.2281 Te/Exp=0.2512]100%|██████████| 2/2 [00:06<00:00,  3.06s/it, CE=2.251124e+00 H=2.251016e+00 dV_dx=-8.730344e-06 dV_dθ=-9.887753e-05 ||∇||=4.714648e-01 | Tr=0.2171 Te/Cur=0.2281 Te/Exp=0.2512]100%|██████████| 2/2 [00:06<00:00,  3.19s/it, CE=2.251124e+00 H=2.251016e+00 dV_dx=-8.730344e-06 dV_dθ=-9.887753e-05 ||∇||=4.714648e-01 | Tr=0.2171 Te/Cur=0.2281 Te/Exp=0.2512]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 492, 84, 10]) with loss 2.251124
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.14s/it] 50%|█████     | 1/2 [00:06<00:04,  4.14s/it, CE=2.260055e+00 H=2.259947e+00 dV_dx=-1.563316e-05 dV_dθ=-9.220199e-05 ||∇||=4.604488e-01 | Tr=0.1617 Te/Cur=0.1981 Te/Exp=0.2292]100%|██████████| 2/2 [00:06<00:00,  3.35s/it, CE=2.260055e+00 H=2.259947e+00 dV_dx=-1.563316e-05 dV_dθ=-9.220199e-05 ||∇||=4.604488e-01 | Tr=0.1617 Te/Cur=0.1981 Te/Exp=0.2292]100%|██████████| 2/2 [00:06<00:00,  3.47s/it, CE=2.260055e+00 H=2.259947e+00 dV_dx=-1.563316e-05 dV_dθ=-9.220199e-05 ||∇||=4.604488e-01 | Tr=0.1617 Te/Cur=0.1981 Te/Exp=0.2292]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.49s/it] 50%|█████     | 1/2 [00:15<00:13, 13.49s/it, CE=2.268091e+00 H=2.268009e+00 dV_dx=-6.267948e-07 dV_dθ=-8.200510e-05 ||∇||=4.466855e-01 | Tr=0.2051 Te/Cur=0.2588 Te/Exp=0.2824]100%|██████████| 2/2 [00:15<00:00,  6.92s/it, CE=2.268091e+00 H=2.268009e+00 dV_dx=-6.267948e-07 dV_dθ=-8.200510e-05 ||∇||=4.466855e-01 | Tr=0.2051 Te/Cur=0.2588 Te/Exp=0.2824]100%|██████████| 2/2 [00:15<00:00,  7.91s/it, CE=2.268091e+00 H=2.268009e+00 dV_dx=-6.267948e-07 dV_dθ=-8.200510e-05 ||∇||=4.466855e-01 | Tr=0.2051 Te/Cur=0.2588 Te/Exp=0.2824]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.97s/it] 50%|█████     | 1/2 [00:15<00:12, 12.97s/it, CE=2.255426e+00 H=2.255338e+00 dV_dx=1.612979e-05 dV_dθ=-1.037977e-04 ||∇||=4.702153e-01 | Tr=0.2575 Te/Cur=0.2671 Te/Exp=0.3097]100%|██████████| 2/2 [00:15<00:00,  6.97s/it, CE=2.255426e+00 H=2.255338e+00 dV_dx=1.612979e-05 dV_dθ=-1.037977e-04 ||∇||=4.702153e-01 | Tr=0.2575 Te/Cur=0.2671 Te/Exp=0.3097]100%|██████████| 2/2 [00:15<00:00,  7.87s/it, CE=2.255426e+00 H=2.255338e+00 dV_dx=1.612979e-05 dV_dθ=-1.037977e-04 ||∇||=4.702153e-01 | Tr=0.2575 Te/Cur=0.2671 Te/Exp=0.3097]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.96s/it] 50%|█████     | 1/2 [00:15<00:12, 12.96s/it, CE=2.256305e+00 H=2.256199e+00 dV_dx=-1.455487e-06 dV_dθ=-1.046552e-04 ||∇||=4.450136e-01 | Tr=0.2426 Te/Cur=0.2533 Te/Exp=0.2821]100%|██████████| 2/2 [00:15<00:00,  7.11s/it, CE=2.256305e+00 H=2.256199e+00 dV_dx=-1.455487e-06 dV_dθ=-1.046552e-04 ||∇||=4.450136e-01 | Tr=0.2426 Te/Cur=0.2533 Te/Exp=0.2821]100%|██████████| 2/2 [00:15<00:00,  7.99s/it, CE=2.256305e+00 H=2.256199e+00 dV_dx=-1.455487e-06 dV_dθ=-1.046552e-04 ||∇||=4.450136e-01 | Tr=0.2426 Te/Cur=0.2533 Te/Exp=0.2821]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.52s/it] 50%|█████     | 1/2 [00:16<00:13, 13.52s/it, CE=2.227097e+00 H=2.227019e+00 dV_dx=-5.965274e-07 dV_dθ=-7.744426e-05 ||∇||=4.637882e-01 | Tr=0.2380 Te/Cur=0.3433 Te/Exp=0.3067]100%|██████████| 2/2 [00:16<00:00,  7.12s/it, CE=2.227097e+00 H=2.227019e+00 dV_dx=-5.965274e-07 dV_dθ=-7.744426e-05 ||∇||=4.637882e-01 | Tr=0.2380 Te/Cur=0.3433 Te/Exp=0.3067]100%|██████████| 2/2 [00:16<00:00,  8.08s/it, CE=2.227097e+00 H=2.227019e+00 dV_dx=-5.965274e-07 dV_dθ=-7.744426e-05 ||∇||=4.637882e-01 | Tr=0.2380 Te/Cur=0.3433 Te/Exp=0.3067]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 124, 10]) with loss 2.227097
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.31s/it] 50%|█████     | 1/2 [00:07<00:04,  4.31s/it, CE=2.290394e+00 H=2.290257e+00 dV_dx=-2.186161e-05 dV_dθ=-1.151545e-04 ||∇||=4.539693e-01 | Tr=0.1636 Te/Cur=0.1445 Te/Exp=0.1458]100%|██████████| 2/2 [00:07<00:00,  3.48s/it, CE=2.290394e+00 H=2.290257e+00 dV_dx=-2.186161e-05 dV_dθ=-1.151545e-04 ||∇||=4.539693e-01 | Tr=0.1636 Te/Cur=0.1445 Te/Exp=0.1458]100%|██████████| 2/2 [00:07<00:00,  3.60s/it, CE=2.290394e+00 H=2.290257e+00 dV_dx=-2.186161e-05 dV_dθ=-1.151545e-04 ||∇||=4.539693e-01 | Tr=0.1636 Te/Cur=0.1445 Te/Exp=0.1458]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.40s/it] 50%|█████     | 1/2 [00:06<00:04,  4.40s/it, CE=2.299242e+00 H=2.299122e+00 dV_dx=-3.511376e-06 dV_dθ=-1.168756e-04 ||∇||=4.658369e-01 | Tr=0.1219 Te/Cur=0.1106 Te/Exp=0.1064]100%|██████████| 2/2 [00:06<00:00,  3.17s/it, CE=2.299242e+00 H=2.299122e+00 dV_dx=-3.511376e-06 dV_dθ=-1.168756e-04 ||∇||=4.658369e-01 | Tr=0.1219 Te/Cur=0.1106 Te/Exp=0.1064]100%|██████████| 2/2 [00:06<00:00,  3.35s/it, CE=2.299242e+00 H=2.299122e+00 dV_dx=-3.511376e-06 dV_dθ=-1.168756e-04 ||∇||=4.658369e-01 | Tr=0.1219 Te/Cur=0.1106 Te/Exp=0.1064]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.50s/it] 50%|█████     | 1/2 [00:16<00:13, 13.50s/it, CE=2.302347e+00 H=2.302260e+00 dV_dx=5.961013e-06 dV_dθ=-9.261617e-05 ||∇||=4.259466e-01 | Tr=0.1231 Te/Cur=0.1159 Te/Exp=0.1594]100%|██████████| 2/2 [00:16<00:00,  7.17s/it, CE=2.302347e+00 H=2.302260e+00 dV_dx=5.961013e-06 dV_dθ=-9.261617e-05 ||∇||=4.259466e-01 | Tr=0.1231 Te/Cur=0.1159 Te/Exp=0.1594]100%|██████████| 2/2 [00:16<00:00,  8.12s/it, CE=2.302347e+00 H=2.302260e+00 dV_dx=5.961013e-06 dV_dθ=-9.261617e-05 ||∇||=4.259466e-01 | Tr=0.1231 Te/Cur=0.1159 Te/Exp=0.1594]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.08s/it] 50%|█████     | 1/2 [00:06<00:04,  4.08s/it, CE=2.256718e+00 H=2.256590e+00 dV_dx=-1.183021e-05 dV_dθ=-1.161849e-04 ||∇||=4.709836e-01 | Tr=0.1288 Te/Cur=0.1314 Te/Exp=0.2640]100%|██████████| 2/2 [00:06<00:00,  3.17s/it, CE=2.256718e+00 H=2.256590e+00 dV_dx=-1.183021e-05 dV_dθ=-1.161849e-04 ||∇||=4.709836e-01 | Tr=0.1288 Te/Cur=0.1314 Te/Exp=0.2640]100%|██████████| 2/2 [00:06<00:00,  3.31s/it, CE=2.256718e+00 H=2.256590e+00 dV_dx=-1.183021e-05 dV_dθ=-1.161849e-04 ||∇||=4.709836e-01 | Tr=0.1288 Te/Cur=0.1314 Te/Exp=0.2640]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.48s/it] 50%|█████     | 1/2 [00:06<00:04,  4.48s/it, CE=2.246821e+00 H=2.246715e+00 dV_dx=-7.118478e-06 dV_dθ=-9.861694e-05 ||∇||=5.258289e-01 | Tr=0.1200 Te/Cur=0.1525 Te/Exp=0.2090]100%|██████████| 2/2 [00:06<00:00,  3.31s/it, CE=2.246821e+00 H=2.246715e+00 dV_dx=-7.118478e-06 dV_dθ=-9.861694e-05 ||∇||=5.258289e-01 | Tr=0.1200 Te/Cur=0.1525 Te/Exp=0.2090]100%|██████████| 2/2 [00:06<00:00,  3.49s/it, CE=2.246821e+00 H=2.246715e+00 dV_dx=-7.118478e-06 dV_dθ=-9.861694e-05 ||∇||=5.258289e-01 | Tr=0.1200 Te/Cur=0.1525 Te/Exp=0.2090]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.91s/it] 50%|█████     | 1/2 [00:15<00:12, 12.91s/it, CE=2.275671e+00 H=2.275608e+00 dV_dx=6.411885e-06 dV_dθ=-6.949312e-05 ||∇||=5.561779e-01 | Tr=0.1558 Te/Cur=0.1759 Te/Exp=0.2401]100%|██████████| 2/2 [00:15<00:00,  6.63s/it, CE=2.275671e+00 H=2.275608e+00 dV_dx=6.411885e-06 dV_dθ=-6.949312e-05 ||∇||=5.561779e-01 | Tr=0.1558 Te/Cur=0.1759 Te/Exp=0.2401]100%|██████████| 2/2 [00:15<00:00,  7.57s/it, CE=2.275671e+00 H=2.275608e+00 dV_dx=6.411885e-06 dV_dθ=-6.949312e-05 ||∇||=5.561779e-01 | Tr=0.1558 Te/Cur=0.1759 Te/Exp=0.2401]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.33s/it] 50%|█████     | 1/2 [00:15<00:13, 13.33s/it, CE=2.253927e+00 H=2.253854e+00 dV_dx=-1.742658e-05 dV_dθ=-5.487995e-05 ||∇||=4.760712e-01 | Tr=0.1833 Te/Cur=0.1852 Te/Exp=0.3175]100%|██████████| 2/2 [00:15<00:00,  6.83s/it, CE=2.253927e+00 H=2.253854e+00 dV_dx=-1.742658e-05 dV_dθ=-5.487995e-05 ||∇||=4.760712e-01 | Tr=0.1833 Te/Cur=0.1852 Te/Exp=0.3175]100%|██████████| 2/2 [00:15<00:00,  7.81s/it, CE=2.253927e+00 H=2.253854e+00 dV_dx=-1.742658e-05 dV_dθ=-5.487995e-05 ||∇||=4.760712e-01 | Tr=0.1833 Te/Cur=0.1852 Te/Exp=0.3175]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.01s/it] 50%|█████     | 1/2 [00:14<00:12, 12.01s/it, CE=2.241035e+00 H=2.240884e+00 dV_dx=-1.515418e-05 dV_dθ=-1.358414e-04 ||∇||=4.900137e-01 | Tr=0.1153 Te/Cur=0.1171 Te/Exp=0.2629]100%|██████████| 2/2 [00:14<00:00,  6.41s/it, CE=2.241035e+00 H=2.240884e+00 dV_dx=-1.515418e-05 dV_dθ=-1.358414e-04 ||∇||=4.900137e-01 | Tr=0.1153 Te/Cur=0.1171 Te/Exp=0.2629]100%|██████████| 2/2 [00:14<00:00,  7.25s/it, CE=2.241035e+00 H=2.240884e+00 dV_dx=-1.515418e-05 dV_dθ=-1.358414e-04 ||∇||=4.900137e-01 | Tr=0.1153 Te/Cur=0.1171 Te/Exp=0.2629]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.83s/it] 50%|█████     | 1/2 [00:15<00:12, 12.83s/it, CE=2.248315e+00 H=2.248268e+00 dV_dx=-4.083744e-07 dV_dθ=-4.686568e-05 ||∇||=4.641348e-01 | Tr=0.1278 Te/Cur=0.1184 Te/Exp=0.3664]100%|██████████| 2/2 [00:15<00:00,  7.01s/it, CE=2.248315e+00 H=2.248268e+00 dV_dx=-4.083744e-07 dV_dθ=-4.686568e-05 ||∇||=4.641348e-01 | Tr=0.1278 Te/Cur=0.1184 Te/Exp=0.3664]100%|██████████| 2/2 [00:15<00:00,  7.89s/it, CE=2.248315e+00 H=2.248268e+00 dV_dx=-4.083744e-07 dV_dθ=-4.686568e-05 ||∇||=4.641348e-01 | Tr=0.1278 Te/Cur=0.1184 Te/Exp=0.3664]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (3, [507, 572, 124, 10]) with loss 2.227097
  Total candidates evaluated: 54
  Original: (3, [507, 512, 64, 10])
  Optimal: (3, [507, 572, 124, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 3→3, feed [507, 512, 64, 10]→[507, 572, 124, 10]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:19<06:10, 19.52s/it]  5%|▌         | 1/20 [00:23<06:10, 19.52s/it, CE=1.462467e+00 H=1.461158e+00 dV_dx=1.691202e-06 dV_dθ=-1.311130e-03 ||∇||=1.285666e+00 | Tr=0.7320] 10%|█         | 2/20 [00:23<03:04, 10.24s/it, CE=1.462467e+00 H=1.461158e+00 dV_dx=1.691202e-06 dV_dθ=-1.311130e-03 ||∇||=1.285666e+00 | Tr=0.7320] 10%|█         | 2/20 [00:27<03:04, 10.24s/it, CE=1.204705e+00 H=1.202941e+00 dV_dx=-1.124474e-05 dV_dθ=-1.753521e-03 ||∇||=1.497440e+00 | Tr=0.7320] 15%|█▌        | 3/20 [00:27<02:08,  7.53s/it, CE=1.204705e+00 H=1.202941e+00 dV_dx=-1.124474e-05 dV_dθ=-1.753521e-03 ||∇||=1.497440e+00 | Tr=0.7320] 15%|█▌        | 3/20 [00:32<02:08,  7.53s/it, CE=1.053210e+00 H=1.050941e+00 dV_dx=6.740788e-07 dV_dθ=-2.269114e-03 ||∇||=1.695568e+00 | Tr=0.7320]  20%|██        | 4/20 [00:32<01:43,  6.44s/it, CE=1.053210e+00 H=1.050941e+00 dV_dx=6.740788e-07 dV_dθ=-2.269114e-03 ||∇||=1.695568e+00 | Tr=0.7320] 20%|██        | 4/20 [00:36<01:43,  6.44s/it, CE=9.610315e-01 H=9.583802e-01 dV_dx=5.288516e-05 dV_dθ=-2.704133e-03 ||∇||=1.846265e+00 | Tr=0.7320] 25%|██▌       | 5/20 [00:36<01:24,  5.64s/it, CE=9.610315e-01 H=9.583802e-01 dV_dx=5.288516e-05 dV_dθ=-2.704133e-03 ||∇||=1.846265e+00 | Tr=0.7320] 25%|██▌       | 5/20 [00:40<01:24,  5.64s/it, CE=8.989227e-01 H=8.966804e-01 dV_dx=1.946512e-05 dV_dθ=-2.261715e-03 ||∇||=1.795132e+00 | Tr=0.7320] 30%|███       | 6/20 [00:40<01:09,  4.96s/it, CE=8.989227e-01 H=8.966804e-01 dV_dx=1.946512e-05 dV_dθ=-2.261715e-03 ||∇||=1.795132e+00 | Tr=0.7320] 30%|███       | 6/20 [00:44<01:09,  4.96s/it, CE=8.523055e-01 H=8.503468e-01 dV_dx=-1.915235e-06 dV_dθ=-1.956811e-03 ||∇||=1.759259e+00 | Tr=0.7320] 35%|███▌      | 7/20 [00:44<01:00,  4.68s/it, CE=8.523055e-01 H=8.503468e-01 dV_dx=-1.915235e-06 dV_dθ=-1.956811e-03 ||∇||=1.759259e+00 | Tr=0.7320] 35%|███▌      | 7/20 [00:49<01:00,  4.68s/it, CE=8.153592e-01 H=8.133742e-01 dV_dx=-4.659328e-05 dV_dθ=-1.938404e-03 ||∇||=1.786657e+00 | Tr=0.7320] 40%|████      | 8/20 [00:49<00:58,  4.88s/it, CE=8.153592e-01 H=8.133742e-01 dV_dx=-4.659328e-05 dV_dθ=-1.938404e-03 ||∇||=1.786657e+00 | Tr=0.7320] 40%|████      | 8/20 [00:53<00:58,  4.88s/it, CE=7.848809e-01 H=7.828513e-01 dV_dx=-5.634008e-06 dV_dθ=-2.023973e-03 ||∇||=1.824057e+00 | Tr=0.7320] 45%|████▌     | 9/20 [00:53<00:51,  4.68s/it, CE=7.848809e-01 H=7.828513e-01 dV_dx=-5.634008e-06 dV_dθ=-2.023973e-03 ||∇||=1.824057e+00 | Tr=0.7320] 45%|████▌     | 9/20 [00:57<00:51,  4.68s/it, CE=7.586018e-01 H=7.565981e-01 dV_dx=3.147269e-05 dV_dθ=-2.035168e-03 ||∇||=1.832638e+00 | Tr=0.7320]  50%|█████     | 10/20 [00:57<00:44,  4.50s/it, CE=7.586018e-01 H=7.565981e-01 dV_dx=3.147269e-05 dV_dθ=-2.035168e-03 ||∇||=1.832638e+00 | Tr=0.7320] 50%|█████     | 10/20 [01:02<00:44,  4.50s/it, CE=7.356392e-01 H=7.336243e-01 dV_dx=-5.722785e-05 dV_dθ=-1.957683e-03 ||∇||=1.817956e+00 | Tr=0.7320] 55%|█████▌    | 11/20 [01:02<00:41,  4.59s/it, CE=7.356392e-01 H=7.336243e-01 dV_dx=-5.722785e-05 dV_dθ=-1.957683e-03 ||∇||=1.817956e+00 | Tr=0.7320] 55%|█████▌    | 11/20 [01:07<00:41,  4.59s/it, CE=7.147090e-01 H=7.130462e-01 dV_dx=8.377836e-05 dV_dθ=-1.746626e-03 ||∇||=1.765930e+00 | Tr=0.7320]  60%|██████    | 12/20 [01:07<00:36,  4.54s/it, CE=7.147090e-01 H=7.130462e-01 dV_dx=8.377836e-05 dV_dθ=-1.746626e-03 ||∇||=1.765930e+00 | Tr=0.7320] 60%|██████    | 12/20 [01:12<00:36,  4.54s/it, CE=6.961895e-01 H=6.944897e-01 dV_dx=-5.954615e-05 dV_dθ=-1.640304e-03 ||∇||=1.754741e+00 | Tr=0.7320] 65%|██████▌   | 13/20 [01:12<00:33,  4.76s/it, CE=6.961895e-01 H=6.944897e-01 dV_dx=-5.954615e-05 dV_dθ=-1.640304e-03 ||∇||=1.754741e+00 | Tr=0.7320] 65%|██████▌   | 13/20 [01:17<00:33,  4.76s/it, CE=6.792646e-01 H=6.777587e-01 dV_dx=2.097588e-05 dV_dθ=-1.526833e-03 ||∇||=1.732959e+00 | Tr=0.7320]  70%|███████   | 14/20 [01:17<00:28,  4.77s/it, CE=6.792646e-01 H=6.777587e-01 dV_dx=2.097588e-05 dV_dθ=-1.526833e-03 ||∇||=1.732959e+00 | Tr=0.7320] 70%|███████   | 14/20 [01:21<00:28,  4.77s/it, CE=6.638532e-01 H=6.624548e-01 dV_dx=-5.206867e-06 dV_dθ=-1.393217e-03 ||∇||=1.707491e+00 | Tr=0.7320] 75%|███████▌  | 15/20 [01:21<00:23,  4.73s/it, CE=6.638532e-01 H=6.624548e-01 dV_dx=-5.206867e-06 dV_dθ=-1.393217e-03 ||∇||=1.707491e+00 | Tr=0.7320] 75%|███████▌  | 15/20 [01:26<00:23,  4.73s/it, CE=6.498745e-01 H=6.486009e-01 dV_dx=1.481559e-05 dV_dθ=-1.288451e-03 ||∇||=1.693941e+00 | Tr=0.7320]  80%|████████  | 16/20 [01:26<00:19,  4.81s/it, CE=6.498745e-01 H=6.486009e-01 dV_dx=1.481559e-05 dV_dθ=-1.288451e-03 ||∇||=1.693941e+00 | Tr=0.7320] 80%|████████  | 16/20 [01:31<00:19,  4.81s/it, CE=6.373116e-01 H=6.360624e-01 dV_dx=2.210100e-06 dV_dθ=-1.251397e-03 ||∇||=1.700779e+00 | Tr=0.7320] 85%|████████▌ | 17/20 [01:31<00:14,  4.72s/it, CE=6.373116e-01 H=6.360624e-01 dV_dx=2.210100e-06 dV_dθ=-1.251397e-03 ||∇||=1.700779e+00 | Tr=0.7320] 85%|████████▌ | 17/20 [01:36<00:14,  4.72s/it, CE=6.256560e-01 H=6.244536e-01 dV_dx=2.109306e-07 dV_dθ=-1.202654e-03 ||∇||=1.707688e+00 | Tr=0.7320] 90%|█████████ | 18/20 [01:36<00:09,  4.79s/it, CE=6.256560e-01 H=6.244536e-01 dV_dx=2.109306e-07 dV_dθ=-1.202654e-03 ||∇||=1.707688e+00 | Tr=0.7320] 90%|█████████ | 18/20 [01:40<00:09,  4.79s/it, CE=6.148793e-01 H=6.138122e-01 dV_dx=6.498777e-05 dV_dθ=-1.132006e-03 ||∇||=1.704124e+00 | Tr=0.7320] 95%|█████████▌| 19/20 [01:40<00:04,  4.65s/it, CE=6.148793e-01 H=6.138122e-01 dV_dx=6.498777e-05 dV_dθ=-1.132006e-03 ||∇||=1.704124e+00 | Tr=0.7320] 95%|█████████▌| 19/20 [01:48<00:04,  4.65s/it, CE=6.050256e-01 H=6.039509e-01 dV_dx=2.665558e-05 dV_dθ=-1.101275e-03 ||∇||=1.709390e+00 | Tr=0.7320 Te/Cur=0.9565 Te/Exp=0.7947]100%|██████████| 20/20 [01:53<00:00,  6.98s/it, CE=6.050256e-01 H=6.039509e-01 dV_dx=2.665558e-05 dV_dθ=-1.101275e-03 ||∇||=1.709390e+00 | Tr=0.7320 Te/Cur=0.9565 Te/Exp=0.7947]100%|██████████| 20/20 [01:53<00:00,  5.65s/it, CE=6.050256e-01 H=6.039509e-01 dV_dx=2.665558e-05 dV_dθ=-1.101275e-03 ||∇||=1.709390e+00 | Tr=0.7320 Te/Cur=0.9565 Te/Exp=0.7947]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.605026

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.37s/it] 50%|█████     | 1/2 [00:17<00:11, 11.37s/it, CE=5.834835e-01 H=5.832632e-01 dV_dx=-3.220786e-05 dV_dθ=-1.881371e-04 ||∇||=5.911528e-01 | Tr=0.9659 Te/Cur=0.9581 Te/Exp=0.7998]100%|██████████| 2/2 [00:17<00:00,  8.48s/it, CE=5.834835e-01 H=5.832632e-01 dV_dx=-3.220786e-05 dV_dθ=-1.881371e-04 ||∇||=5.911528e-01 | Tr=0.9659 Te/Cur=0.9581 Te/Exp=0.7998]100%|██████████| 2/2 [00:17<00:00,  8.92s/it, CE=5.834835e-01 H=5.832632e-01 dV_dx=-3.220786e-05 dV_dθ=-1.881371e-04 ||∇||=5.911528e-01 | Tr=0.9659 Te/Cur=0.9581 Te/Exp=0.7998]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:46,  8.77s/it]  5%|▌         | 1/20 [00:13<02:46,  8.77s/it, CE=5.765601e-01 H=5.764438e-01 dV_dx=-4.157872e-06 dV_dθ=-1.121779e-04 ||∇||=5.365203e-01 | Tr=0.9666] 10%|█         | 2/20 [00:13<01:51,  6.21s/it, CE=5.765601e-01 H=5.764438e-01 dV_dx=-4.157872e-06 dV_dθ=-1.121779e-04 ||∇||=5.365203e-01 | Tr=0.9666] 10%|█         | 2/20 [00:17<01:51,  6.21s/it, CE=5.732219e-01 H=5.731089e-01 dV_dx=5.226886e-06 dV_dθ=-1.182232e-04 ||∇||=5.424184e-01 | Tr=0.9675]  15%|█▌        | 3/20 [00:17<01:33,  5.50s/it, CE=5.732219e-01 H=5.731089e-01 dV_dx=5.226886e-06 dV_dθ=-1.182232e-04 ||∇||=5.424184e-01 | Tr=0.9675] 15%|█▌        | 3/20 [00:22<01:33,  5.50s/it, CE=5.699731e-01 H=5.697494e-01 dV_dx=-1.004718e-04 dV_dθ=-1.232387e-04 ||∇||=5.462507e-01 | Tr=0.9684] 20%|██        | 4/20 [00:22<01:24,  5.30s/it, CE=5.699731e-01 H=5.697494e-01 dV_dx=-1.004718e-04 dV_dθ=-1.232387e-04 ||∇||=5.462507e-01 | Tr=0.9684] 20%|██        | 4/20 [00:27<01:24,  5.30s/it, CE=5.667655e-01 H=5.666790e-01 dV_dx=3.959250e-05 dV_dθ=-1.261326e-04 ||∇||=5.485466e-01 | Tr=0.9690]  25%|██▌       | 5/20 [00:27<01:14,  4.96s/it, CE=5.667655e-01 H=5.666790e-01 dV_dx=3.959250e-05 dV_dθ=-1.261326e-04 ||∇||=5.485466e-01 | Tr=0.9690] 25%|██▌       | 5/20 [00:33<01:14,  4.96s/it, CE=5.636015e-01 H=5.635072e-01 dV_dx=3.228754e-05 dV_dθ=-1.265922e-04 ||∇||=5.493692e-01 | Tr=0.9696 Te/Cur=0.9606 Te/Exp=0.8046] 30%|███       | 6/20 [00:33<01:15,  5.42s/it, CE=5.636015e-01 H=5.635072e-01 dV_dx=3.228754e-05 dV_dθ=-1.265922e-04 ||∇||=5.493692e-01 | Tr=0.9696 Te/Cur=0.9606 Te/Exp=0.8046] 30%|███       | 6/20 [00:37<01:15,  5.42s/it, CE=5.605257e-01 H=5.603920e-01 dV_dx=-5.068772e-06 dV_dθ=-1.286016e-04 ||∇||=5.517029e-01 | Tr=0.9702]                            35%|███▌      | 7/20 [00:37<01:06,  5.08s/it, CE=5.605257e-01 H=5.603920e-01 dV_dx=-5.068772e-06 dV_dθ=-1.286016e-04 ||∇||=5.517029e-01 | Tr=0.9702] 35%|███▌      | 7/20 [00:42<01:06,  5.08s/it, CE=5.575366e-01 H=5.573778e-01 dV_dx=-3.130598e-05 dV_dθ=-1.274609e-04 ||∇||=5.528536e-01 | Tr=0.9709] 40%|████      | 8/20 [00:42<00:58,  4.85s/it, CE=5.575366e-01 H=5.573778e-01 dV_dx=-3.130598e-05 dV_dθ=-1.274609e-04 ||∇||=5.528536e-01 | Tr=0.9709] 40%|████      | 8/20 [00:47<00:58,  4.85s/it, CE=5.546309e-01 H=5.546029e-01 dV_dx=1.015733e-04 dV_dθ=-1.296160e-04 ||∇||=5.546079e-01 | Tr=0.9717]  45%|████▌     | 9/20 [00:47<00:54,  4.94s/it, CE=5.546309e-01 H=5.546029e-01 dV_dx=1.015733e-04 dV_dθ=-1.296160e-04 ||∇||=5.546079e-01 | Tr=0.9717] 45%|████▌     | 9/20 [00:52<00:54,  4.94s/it, CE=5.518276e-01 H=5.518410e-01 dV_dx=1.440969e-04 dV_dθ=-1.306294e-04 ||∇||=5.564401e-01 | Tr=0.9723] 50%|█████     | 10/20 [00:52<00:50,  5.01s/it, CE=5.518276e-01 H=5.518410e-01 dV_dx=1.440969e-04 dV_dθ=-1.306294e-04 ||∇||=5.564401e-01 | Tr=0.9723] 50%|█████     | 10/20 [00:58<00:50,  5.01s/it, CE=5.491234e-01 H=5.489807e-01 dV_dx=-9.370151e-06 dV_dθ=-1.333105e-04 ||∇||=5.594943e-01 | Tr=0.9729 Te/Cur=0.9648 Te/Exp=0.8146] 55%|█████▌    | 11/20 [00:58<00:47,  5.30s/it, CE=5.491234e-01 H=5.489807e-01 dV_dx=-9.370151e-06 dV_dθ=-1.333105e-04 ||∇||=5.594943e-01 | Tr=0.9729 Te/Cur=0.9648 Te/Exp=0.8146] 55%|█████▌    | 11/20 [01:02<00:47,  5.30s/it, CE=5.464272e-01 H=5.462542e-01 dV_dx=-3.911435e-05 dV_dθ=-1.338675e-04 ||∇||=5.622235e-01 | Tr=0.9733]                             60%|██████    | 12/20 [01:02<00:38,  4.76s/it, CE=5.464272e-01 H=5.462542e-01 dV_dx=-3.911435e-05 dV_dθ=-1.338675e-04 ||∇||=5.622235e-01 | Tr=0.9733] 60%|██████    | 12/20 [01:06<00:38,  4.76s/it, CE=5.438153e-01 H=5.436773e-01 dV_dx=-1.174223e-06 dV_dθ=-1.368260e-04 ||∇||=5.644645e-01 | Tr=0.9737] 65%|██████▌   | 13/20 [01:06<00:33,  4.79s/it, CE=5.438153e-01 H=5.436773e-01 dV_dx=-1.174223e-06 dV_dθ=-1.368260e-04 ||∇||=5.644645e-01 | Tr=0.9737] 65%|██████▌   | 13/20 [01:11<00:33,  4.79s/it, CE=5.412562e-01 H=5.411280e-01 dV_dx=7.266671e-06 dV_dθ=-1.353849e-04 ||∇||=5.645920e-01 | Tr=0.9745]  70%|███████   | 14/20 [01:11<00:28,  4.77s/it, CE=5.412562e-01 H=5.411280e-01 dV_dx=7.266671e-06 dV_dθ=-1.353849e-04 ||∇||=5.645920e-01 | Tr=0.9745] 70%|███████   | 14/20 [01:16<00:28,  4.77s/it, CE=5.387472e-01 H=5.387308e-01 dV_dx=1.181196e-04 dV_dθ=-1.344794e-04 ||∇||=5.650732e-01 | Tr=0.9750] 75%|███████▌  | 15/20 [01:16<00:23,  4.73s/it, CE=5.387472e-01 H=5.387308e-01 dV_dx=1.181196e-04 dV_dθ=-1.344794e-04 ||∇||=5.650732e-01 | Tr=0.9750] 75%|███████▌  | 15/20 [01:23<00:23,  4.73s/it, CE=5.363261e-01 H=5.361726e-01 dV_dx=-1.820534e-05 dV_dθ=-1.352823e-04 ||∇||=5.671667e-01 | Tr=0.9754 Te/Cur=0.9671 Te/Exp=0.8151] 80%|████████  | 16/20 [01:23<00:21,  5.38s/it, CE=5.363261e-01 H=5.361726e-01 dV_dx=-1.820534e-05 dV_dθ=-1.352823e-04 ||∇||=5.671667e-01 | Tr=0.9754 Te/Cur=0.9671 Te/Exp=0.8151] 80%|████████  | 16/20 [01:28<00:21,  5.38s/it, CE=5.339305e-01 H=5.338198e-01 dV_dx=2.520683e-05 dV_dθ=-1.359132e-04 ||∇||=5.689250e-01 | Tr=0.9757]                              85%|████████▌ | 17/20 [01:28<00:15,  5.23s/it, CE=5.339305e-01 H=5.338198e-01 dV_dx=2.520683e-05 dV_dθ=-1.359132e-04 ||∇||=5.689250e-01 | Tr=0.9757] 85%|████████▌ | 17/20 [01:32<00:15,  5.23s/it, CE=5.315043e-01 H=5.314066e-01 dV_dx=3.723237e-05 dV_dθ=-1.349232e-04 ||∇||=5.694825e-01 | Tr=0.9761] 90%|█████████ | 18/20 [01:32<00:09,  5.00s/it, CE=5.315043e-01 H=5.314066e-01 dV_dx=3.723237e-05 dV_dθ=-1.349232e-04 ||∇||=5.694825e-01 | Tr=0.9761] 90%|█████████ | 18/20 [01:37<00:09,  5.00s/it, CE=5.291799e-01 H=5.290424e-01 dV_dx=-8.564362e-07 dV_dθ=-1.366712e-04 ||∇||=5.718938e-01 | Tr=0.9767] 95%|█████████▌| 19/20 [01:37<00:04,  4.95s/it, CE=5.291799e-01 H=5.290424e-01 dV_dx=-8.564362e-07 dV_dθ=-1.366712e-04 ||∇||=5.718938e-01 | Tr=0.9767] 95%|█████████▌| 19/20 [01:43<00:04,  4.95s/it, CE=5.268515e-01 H=5.266691e-01 dV_dx=-4.765460e-05 dV_dθ=-1.346733e-04 ||∇||=5.717390e-01 | Tr=0.9771 Te/Cur=0.9697 Te/Exp=0.8164]100%|██████████| 20/20 [01:43<00:00,  5.47s/it, CE=5.268515e-01 H=5.266691e-01 dV_dx=-4.765460e-05 dV_dθ=-1.346733e-04 ||∇||=5.717390e-01 | Tr=0.9771 Te/Cur=0.9697 Te/Exp=0.8164]100%|██████████| 20/20 [01:43<00:00,  5.20s/it, CE=5.268515e-01 H=5.266691e-01 dV_dx=-4.765460e-05 dV_dθ=-1.346733e-04 ||∇||=5.717390e-01 | Tr=0.9771 Te/Cur=0.9697 Te/Exp=0.8164]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 1 final loss: 0.531589
======================================================================


  Evaluating on all tasks 0..1 for CL metrics...
    Task 0: 0.8166
    Task 1: 0.9684

============================================================
Task 2
============================================================
Initial loss on new task: 7.5735, previous: 0.5269, ratio: 14.37
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 2
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:12<?, ?it/s, CE=5.353136e-01 H=5.307736e-01 dV_dx=1.873109e-05 dV_dθ=-4.558736e-03 ||∇||=3.546370e+00 | Tr=0.4365 Te/Cur=0.5958 Te/Exp=0.8510]100%|██████████| 1/1 [00:12<00:00, 12.29s/it, CE=5.353136e-01 H=5.307736e-01 dV_dx=1.873109e-05 dV_dθ=-4.558736e-03 ||∇||=3.546370e+00 | Tr=0.4365 Te/Cur=0.5958 Te/Exp=0.8510]100%|██████████| 1/1 [00:12<00:00, 12.29s/it, CE=5.353136e-01 H=5.307736e-01 dV_dx=1.873109e-05 dV_dθ=-4.558736e-03 ||∇||=3.546370e+00 | Tr=0.4365 Te/Cur=0.5958 Te/Exp=0.8510]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.535314

[STEP 2] Architecture change decision
  Current: 0.535314, Previous: 0.526851
  Decision: KEEP
  No change - standard training
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:10<03:45, 10.72s/it]  5%|▍         | 1/22 [00:15<03:45, 10.72s/it, CE=3.817483e-01 H=3.818380e-01 dV_dx=5.335147e-05 dV_dθ=3.632348e-05 ||∇||=9.228674e-01 | Tr=0.6937]  9%|▉         | 2/22 [00:15<02:25,  7.26s/it, CE=3.817483e-01 H=3.818380e-01 dV_dx=5.335147e-05 dV_dθ=3.632348e-05 ||∇||=9.228674e-01 | Tr=0.6937]  9%|▉         | 2/22 [00:20<02:25,  7.26s/it, CE=3.686157e-01 H=3.680851e-01 dV_dx=-7.386307e-06 dV_dθ=-5.231638e-04 ||∇||=1.000175e+00 | Tr=0.7281] 14%|█▎        | 3/22 [00:20<01:57,  6.17s/it, CE=3.686157e-01 H=3.680851e-01 dV_dx=-7.386307e-06 dV_dθ=-5.231638e-04 ||∇||=1.000175e+00 | Tr=0.7281] 14%|█▎        | 3/22 [00:25<01:57,  6.17s/it, CE=3.595212e-01 H=3.588497e-01 dV_dx=1.577274e-06 dV_dθ=-6.731289e-04 ||∇||=9.886995e-01 | Tr=0.7493]  18%|█▊        | 4/22 [00:25<01:44,  5.82s/it, CE=3.595212e-01 H=3.588497e-01 dV_dx=1.577274e-06 dV_dθ=-6.731289e-04 ||∇||=9.886995e-01 | Tr=0.7493] 18%|█▊        | 4/22 [00:30<01:44,  5.82s/it, CE=3.523690e-01 H=3.516894e-01 dV_dx=2.763687e-05 dV_dθ=-7.072085e-04 ||∇||=9.614777e-01 | Tr=0.7642] 23%|██▎       | 5/22 [00:30<01:33,  5.53s/it, CE=3.523690e-01 H=3.516894e-01 dV_dx=2.763687e-05 dV_dθ=-7.072085e-04 ||∇||=9.614777e-01 | Tr=0.7642] 23%|██▎       | 5/22 [00:37<01:33,  5.53s/it, CE=3.465597e-01 H=3.458602e-01 dV_dx=1.828351e-05 dV_dθ=-7.177832e-04 ||∇||=9.380042e-01 | Tr=0.7762 Te/Cur=0.7738 Te/Exp=0.8764] 27%|██▋       | 6/22 [00:37<01:33,  5.82s/it, CE=3.465597e-01 H=3.458602e-01 dV_dx=1.828351e-05 dV_dθ=-7.177832e-04 ||∇||=9.380042e-01 | Tr=0.7762 Te/Cur=0.7738 Te/Exp=0.8764] 27%|██▋       | 6/22 [00:41<01:33,  5.82s/it, CE=3.418654e-01 H=3.411688e-01 dV_dx=4.654006e-05 dV_dθ=-7.431343e-04 ||∇||=9.258618e-01 | Tr=0.7855]                             32%|███▏      | 7/22 [00:41<01:19,  5.31s/it, CE=3.418654e-01 H=3.411688e-01 dV_dx=4.654006e-05 dV_dθ=-7.431343e-04 ||∇||=9.258618e-01 | Tr=0.7855] 32%|███▏      | 7/22 [00:46<01:19,  5.31s/it, CE=3.377456e-01 H=3.369997e-01 dV_dx=-3.372301e-06 dV_dθ=-7.425622e-04 ||∇||=9.125516e-01 | Tr=0.7946] 36%|███▋      | 8/22 [00:46<01:11,  5.12s/it, CE=3.377456e-01 H=3.369997e-01 dV_dx=-3.372301e-06 dV_dθ=-7.425622e-04 ||∇||=9.125516e-01 | Tr=0.7946] 36%|███▋      | 8/22 [00:50<01:11,  5.12s/it, CE=3.340481e-01 H=3.332751e-01 dV_dx=-1.708489e-05 dV_dθ=-7.558753e-04 ||∇||=9.051173e-01 | Tr=0.8007] 41%|████      | 9/22 [00:50<01:04,  4.95s/it, CE=3.340481e-01 H=3.332751e-01 dV_dx=-1.708489e-05 dV_dθ=-7.558753e-04 ||∇||=9.051173e-01 | Tr=0.8007] 41%|████      | 9/22 [00:55<01:04,  4.95s/it, CE=3.307702e-01 H=3.300568e-01 dV_dx=3.547536e-05 dV_dθ=-7.488261e-04 ||∇||=8.953198e-01 | Tr=0.8065]  45%|████▌     | 10/22 [00:55<00:58,  4.89s/it, CE=3.307702e-01 H=3.300568e-01 dV_dx=3.547536e-05 dV_dθ=-7.488261e-04 ||∇||=8.953198e-01 | Tr=0.8065] 45%|████▌     | 10/22 [01:01<00:58,  4.89s/it, CE=3.278315e-01 H=3.270751e-01 dV_dx=3.963740e-07 dV_dθ=-7.567532e-04 ||∇||=8.903539e-01 | Tr=0.8118 Te/Cur=0.8104 Te/Exp=0.8758] 50%|█████     | 11/22 [01:01<00:59,  5.39s/it, CE=3.278315e-01 H=3.270751e-01 dV_dx=3.963740e-07 dV_dθ=-7.567532e-04 ||∇||=8.903539e-01 | Tr=0.8118 Te/Cur=0.8104 Te/Exp=0.8758] 50%|█████     | 11/22 [01:06<00:59,  5.39s/it, CE=3.250199e-01 H=3.243262e-01 dV_dx=5.791138e-05 dV_dθ=-7.515985e-04 ||∇||=8.827457e-01 | Tr=0.8162]                             55%|█████▍    | 12/22 [01:06<00:50,  5.03s/it, CE=3.250199e-01 H=3.243262e-01 dV_dx=5.791138e-05 dV_dθ=-7.515985e-04 ||∇||=8.827457e-01 | Tr=0.8162] 55%|█████▍    | 12/22 [01:10<00:50,  5.03s/it, CE=3.224684e-01 H=3.217230e-01 dV_dx=2.690145e-05 dV_dθ=-7.723193e-04 ||∇||=8.844617e-01 | Tr=0.8202] 59%|█████▉    | 13/22 [01:10<00:43,  4.85s/it, CE=3.224684e-01 H=3.217230e-01 dV_dx=2.690145e-05 dV_dθ=-7.723193e-04 ||∇||=8.844617e-01 | Tr=0.8202] 59%|█████▉    | 13/22 [01:15<00:43,  4.85s/it, CE=3.200415e-01 H=3.193252e-01 dV_dx=6.037742e-05 dV_dθ=-7.766185e-04 ||∇||=8.810798e-01 | Tr=0.8237] 64%|██████▎   | 14/22 [01:15<00:37,  4.74s/it, CE=3.200415e-01 H=3.193252e-01 dV_dx=6.037742e-05 dV_dθ=-7.766185e-04 ||∇||=8.810798e-01 | Tr=0.8237] 64%|██████▎   | 14/22 [01:19<00:37,  4.74s/it, CE=3.178138e-01 H=3.170047e-01 dV_dx=-1.983786e-05 dV_dθ=-7.891795e-04 ||∇||=8.796622e-01 | Tr=0.8268] 68%|██████▊   | 15/22 [01:19<00:32,  4.68s/it, CE=3.178138e-01 H=3.170047e-01 dV_dx=-1.983786e-05 dV_dθ=-7.891795e-04 ||∇||=8.796622e-01 | Tr=0.8268] 68%|██████▊   | 15/22 [01:25<00:32,  4.68s/it, CE=3.157287e-01 H=3.149889e-01 dV_dx=5.076057e-05 dV_dθ=-7.905451e-04 ||∇||=8.763213e-01 | Tr=0.8294 Te/Cur=0.8264 Te/Exp=0.8865] 73%|███████▎  | 16/22 [01:25<00:30,  5.15s/it, CE=3.157287e-01 H=3.149889e-01 dV_dx=5.076057e-05 dV_dθ=-7.905451e-04 ||∇||=8.763213e-01 | Tr=0.8294 Te/Cur=0.8264 Te/Exp=0.8865] 73%|███████▎  | 16/22 [01:30<00:30,  5.15s/it, CE=3.137384e-01 H=3.129688e-01 dV_dx=2.756201e-05 dV_dθ=-7.971474e-04 ||∇||=8.763801e-01 | Tr=0.8325]                             77%|███████▋  | 17/22 [01:30<00:24,  4.96s/it, CE=3.137384e-01 H=3.129688e-01 dV_dx=2.756201e-05 dV_dθ=-7.971474e-04 ||∇||=8.763801e-01 | Tr=0.8325] 77%|███████▋  | 17/22 [01:35<00:24,  4.96s/it, CE=3.117810e-01 H=3.109797e-01 dV_dx=-1.898364e-06 dV_dθ=-7.994874e-04 ||∇||=8.744020e-01 | Tr=0.8353] 82%|████████▏ | 18/22 [01:35<00:19,  4.87s/it, CE=3.117810e-01 H=3.109797e-01 dV_dx=-1.898364e-06 dV_dθ=-7.994874e-04 ||∇||=8.744020e-01 | Tr=0.8353] 82%|████████▏ | 18/22 [01:39<00:19,  4.87s/it, CE=3.099095e-01 H=3.091270e-01 dV_dx=2.100363e-05 dV_dθ=-8.034829e-04 ||∇||=8.742424e-01 | Tr=0.8379]  86%|████████▋ | 19/22 [01:39<00:14,  4.82s/it, CE=3.099095e-01 H=3.091270e-01 dV_dx=2.100363e-05 dV_dθ=-8.034829e-04 ||∇||=8.742424e-01 | Tr=0.8379] 86%|████████▋ | 19/22 [01:43<00:14,  4.82s/it, CE=3.081274e-01 H=3.073998e-01 dV_dx=8.285912e-05 dV_dθ=-8.105292e-04 ||∇||=8.741936e-01 | Tr=0.8404] 91%|█████████ | 20/22 [01:43<00:09,  4.61s/it, CE=3.081274e-01 H=3.073998e-01 dV_dx=8.285912e-05 dV_dθ=-8.105292e-04 ||∇||=8.741936e-01 | Tr=0.8404] 91%|█████████ | 20/22 [01:50<00:09,  4.61s/it, CE=3.064334e-01 H=3.055879e-01 dV_dx=-2.871238e-05 dV_dθ=-8.167433e-04 ||∇||=8.741946e-01 | Tr=0.8428 Te/Cur=0.8414 Te/Exp=0.8874] 95%|█████████▌| 21/22 [01:50<00:05,  5.19s/it, CE=3.064334e-01 H=3.055879e-01 dV_dx=-2.871238e-05 dV_dθ=-8.167433e-04 ||∇||=8.741946e-01 | Tr=0.8428 Te/Cur=0.8414 Te/Exp=0.8874] 95%|█████████▌| 21/22 [01:57<00:05,  5.19s/it, CE=3.047386e-01 H=3.039267e-01 dV_dx=5.316489e-06 dV_dθ=-8.171829e-04 ||∇||=8.729954e-01 | Tr=0.8451 Te/Cur=0.8407 Te/Exp=0.8832] 100%|██████████| 22/22 [01:57<00:00,  5.69s/it, CE=3.047386e-01 H=3.039267e-01 dV_dx=5.316489e-06 dV_dθ=-8.171829e-04 ||∇||=8.729954e-01 | Tr=0.8451 Te/Cur=0.8407 Te/Exp=0.8832]100%|██████████| 22/22 [01:57<00:00,  5.33s/it, CE=3.047386e-01 H=3.039267e-01 dV_dx=5.316489e-06 dV_dθ=-8.171829e-04 ||∇||=8.729954e-01 | Tr=0.8451 Te/Cur=0.8407 Te/Exp=0.8832]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 2 final loss: 0.315729
======================================================================


  Evaluating on all tasks 0..2 for CL metrics...
    Task 0: 0.8034
    Task 1: 0.9681
    Task 2: 0.8417

============================================================
Task 3
============================================================
Initial loss on new task: 4.4350, previous: 0.3047, ratio: 14.55
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 3
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:13<?, ?it/s, CE=4.465385e-01 H=4.315238e-01 dV_dx=-1.514265e-05 dV_dθ=-1.499959e-02 ||∇||=3.496113e+00 | Tr=0.3630 Te/Cur=0.4475 Te/Exp=0.8617]100%|██████████| 1/1 [00:13<00:00, 13.41s/it, CE=4.465385e-01 H=4.315238e-01 dV_dx=-1.514265e-05 dV_dθ=-1.499959e-02 ||∇||=3.496113e+00 | Tr=0.3630 Te/Cur=0.4475 Te/Exp=0.8617]100%|██████████| 1/1 [00:13<00:00, 13.41s/it, CE=4.465385e-01 H=4.315238e-01 dV_dx=-1.514265e-05 dV_dθ=-1.499959e-02 ||∇||=3.496113e+00 | Tr=0.3630 Te/Cur=0.4475 Te/Exp=0.8617]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.446539

[STEP 2] Architecture change decision
  Current: 0.446539, Previous: 0.304739
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9416 samples from 10 classes
  Created balanced validation set: 28667 samples from 10 classes
  Starting grid architecture search for task 3
  Baseline architecture: (3, [507, 572, 124, 10])
  Baseline loss: 0.446539
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.03s/it] 50%|█████     | 1/2 [00:17<00:14, 14.03s/it, CE=2.337143e+00 H=2.337059e+00 dV_dx=3.090873e-08 dV_dθ=-8.419784e-05 ||∇||=2.917346e-01 | Tr=0.1018 Te/Cur=0.1069 Te/Exp=0.1041]100%|██████████| 2/2 [00:17<00:00,  7.67s/it, CE=2.337143e+00 H=2.337059e+00 dV_dx=3.090873e-08 dV_dθ=-8.419784e-05 ||∇||=2.917346e-01 | Tr=0.1018 Te/Cur=0.1069 Te/Exp=0.1041]100%|██████████| 2/2 [00:17<00:00,  8.63s/it, CE=2.337143e+00 H=2.337059e+00 dV_dx=3.090873e-08 dV_dθ=-8.419784e-05 ||∇||=2.917346e-01 | Tr=0.1018 Te/Cur=0.1069 Te/Exp=0.1041]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.3371428937198195
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.79s/it] 50%|█████     | 1/2 [00:16<00:13, 13.79s/it, CE=2.337334e+00 H=2.337266e+00 dV_dx=-1.374048e-06 dV_dθ=-6.668077e-05 ||∇||=2.722686e-01 | Tr=0.1593 Te/Cur=0.1563 Te/Exp=0.1391]100%|██████████| 2/2 [00:16<00:00,  7.40s/it, CE=2.337334e+00 H=2.337266e+00 dV_dx=-1.374048e-06 dV_dθ=-6.668077e-05 ||∇||=2.722686e-01 | Tr=0.1593 Te/Cur=0.1563 Te/Exp=0.1391]100%|██████████| 2/2 [00:16<00:00,  8.36s/it, CE=2.337334e+00 H=2.337266e+00 dV_dx=-1.374048e-06 dV_dθ=-6.668077e-05 ||∇||=2.722686e-01 | Tr=0.1593 Te/Cur=0.1563 Te/Exp=0.1391]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.32s/it] 50%|█████     | 1/2 [00:18<00:15, 15.32s/it, CE=2.337340e+00 H=2.337268e+00 dV_dx=3.604949e-06 dV_dθ=-7.624269e-05 ||∇||=3.107832e-01 | Tr=0.1010 Te/Cur=0.0949 Te/Exp=0.1002]100%|██████████| 2/2 [00:18<00:00,  8.15s/it, CE=2.337340e+00 H=2.337268e+00 dV_dx=3.604949e-06 dV_dθ=-7.624269e-05 ||∇||=3.107832e-01 | Tr=0.1010 Te/Cur=0.0949 Te/Exp=0.1002]100%|██████████| 2/2 [00:18<00:00,  9.23s/it, CE=2.337340e+00 H=2.337268e+00 dV_dx=3.604949e-06 dV_dθ=-7.624269e-05 ||∇||=3.107832e-01 | Tr=0.1010 Te/Cur=0.0949 Te/Exp=0.1002]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.75s/it] 50%|█████     | 1/2 [00:16<00:13, 13.75s/it, CE=2.335154e+00 H=2.335085e+00 dV_dx=-1.287895e-06 dV_dθ=-6.705939e-05 ||∇||=2.817720e-01 | Tr=0.0962 Te/Cur=0.0963 Te/Exp=0.1786]100%|██████████| 2/2 [00:16<00:00,  7.11s/it, CE=2.335154e+00 H=2.335085e+00 dV_dx=-1.287895e-06 dV_dθ=-6.705939e-05 ||∇||=2.817720e-01 | Tr=0.0962 Te/Cur=0.0963 Te/Exp=0.1786]100%|██████████| 2/2 [00:16<00:00,  8.10s/it, CE=2.335154e+00 H=2.335085e+00 dV_dx=-1.287895e-06 dV_dθ=-6.705939e-05 ||∇||=2.817720e-01 | Tr=0.0962 Te/Cur=0.0963 Te/Exp=0.1786]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 124, 10]) with loss 2.335154
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.93s/it] 50%|█████     | 1/2 [00:08<00:04,  4.93s/it, CE=2.338109e+00 H=2.338040e+00 dV_dx=-3.307613e-06 dV_dθ=-6.518797e-05 ||∇||=2.781966e-01 | Tr=0.0641 Te/Cur=0.0772 Te/Exp=0.1472]100%|██████████| 2/2 [00:08<00:00,  3.96s/it, CE=2.338109e+00 H=2.338040e+00 dV_dx=-3.307613e-06 dV_dθ=-6.518797e-05 ||∇||=2.781966e-01 | Tr=0.0641 Te/Cur=0.0772 Te/Exp=0.1472]100%|██████████| 2/2 [00:08<00:00,  4.11s/it, CE=2.338109e+00 H=2.338040e+00 dV_dx=-3.307613e-06 dV_dθ=-6.518797e-05 ||∇||=2.781966e-01 | Tr=0.0641 Te/Cur=0.0772 Te/Exp=0.1472]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.50s/it] 50%|█████     | 1/2 [00:17<00:14, 14.50s/it, CE=2.342287e+00 H=2.342213e+00 dV_dx=1.596847e-06 dV_dθ=-7.526873e-05 ||∇||=2.903696e-01 | Tr=0.1038 Te/Cur=0.1297 Te/Exp=0.1411]100%|██████████| 2/2 [00:17<00:00,  7.63s/it, CE=2.342287e+00 H=2.342213e+00 dV_dx=1.596847e-06 dV_dθ=-7.526873e-05 ||∇||=2.903696e-01 | Tr=0.1038 Te/Cur=0.1297 Te/Exp=0.1411]100%|██████████| 2/2 [00:17<00:00,  8.66s/it, CE=2.342287e+00 H=2.342213e+00 dV_dx=1.596847e-06 dV_dθ=-7.526873e-05 ||∇||=2.903696e-01 | Tr=0.1038 Te/Cur=0.1297 Te/Exp=0.1411]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.45s/it] 50%|█████     | 1/2 [00:17<00:14, 14.45s/it, CE=2.330167e+00 H=2.330105e+00 dV_dx=1.030095e-06 dV_dθ=-6.265070e-05 ||∇||=2.635096e-01 | Tr=0.0947 Te/Cur=0.0950 Te/Exp=0.1651]100%|██████████| 2/2 [00:17<00:00,  7.79s/it, CE=2.330167e+00 H=2.330105e+00 dV_dx=1.030095e-06 dV_dθ=-6.265070e-05 ||∇||=2.635096e-01 | Tr=0.0947 Te/Cur=0.0950 Te/Exp=0.1651]100%|██████████| 2/2 [00:17<00:00,  8.79s/it, CE=2.330167e+00 H=2.330105e+00 dV_dx=1.030095e-06 dV_dθ=-6.265070e-05 ||∇||=2.635096e-01 | Tr=0.0947 Te/Cur=0.0950 Te/Exp=0.1651]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 144, 10]) with loss 2.330167
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.30s/it] 50%|█████     | 1/2 [00:17<00:13, 13.30s/it, CE=2.322794e+00 H=2.322745e+00 dV_dx=-2.517984e-06 dV_dθ=-4.690932e-05 ||∇||=2.541507e-01 | Tr=0.0950 Te/Cur=0.0953 Te/Exp=0.1500]100%|██████████| 2/2 [00:17<00:00,  7.73s/it, CE=2.322794e+00 H=2.322745e+00 dV_dx=-2.517984e-06 dV_dθ=-4.690932e-05 ||∇||=2.541507e-01 | Tr=0.0950 Te/Cur=0.0953 Te/Exp=0.1500]100%|██████████| 2/2 [00:17<00:00,  8.56s/it, CE=2.322794e+00 H=2.322745e+00 dV_dx=-2.517984e-06 dV_dθ=-4.690932e-05 ||∇||=2.541507e-01 | Tr=0.0950 Te/Cur=0.0953 Te/Exp=0.1500]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 144, 10]) with loss 2.322794
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.73s/it] 50%|█████     | 1/2 [00:16<00:13, 13.73s/it, CE=2.334637e+00 H=2.334574e+00 dV_dx=-8.355287e-07 dV_dθ=-6.193756e-05 ||∇||=2.674707e-01 | Tr=0.0975 Te/Cur=0.0974 Te/Exp=0.1168]100%|██████████| 2/2 [00:16<00:00,  7.36s/it, CE=2.334637e+00 H=2.334574e+00 dV_dx=-8.355287e-07 dV_dθ=-6.193756e-05 ||∇||=2.674707e-01 | Tr=0.0975 Te/Cur=0.0974 Te/Exp=0.1168]100%|██████████| 2/2 [00:16<00:00,  8.31s/it, CE=2.334637e+00 H=2.334574e+00 dV_dx=-8.355287e-07 dV_dθ=-6.193756e-05 ||∇||=2.674707e-01 | Tr=0.0975 Te/Cur=0.0974 Te/Exp=0.1168]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.92s/it] 50%|█████     | 1/2 [00:16<00:13, 13.92s/it, CE=2.341353e+00 H=2.341253e+00 dV_dx=-3.772294e-06 dV_dθ=-9.635307e-05 ||∇||=3.691306e-01 | Tr=0.1014 Te/Cur=0.1041 Te/Exp=0.1299]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.341353e+00 H=2.341253e+00 dV_dx=-3.772294e-06 dV_dθ=-9.635307e-05 ||∇||=3.691306e-01 | Tr=0.1014 Te/Cur=0.1041 Te/Exp=0.1299]100%|██████████| 2/2 [00:16<00:00,  8.29s/it, CE=2.341353e+00 H=2.341253e+00 dV_dx=-3.772294e-06 dV_dθ=-9.635307e-05 ||∇||=3.691306e-01 | Tr=0.1014 Te/Cur=0.1041 Te/Exp=0.1299]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.18s/it] 50%|█████     | 1/2 [00:16<00:13, 13.18s/it, CE=2.322084e+00 H=2.322018e+00 dV_dx=2.845134e-07 dV_dθ=-6.556927e-05 ||∇||=3.403069e-01 | Tr=0.1083 Te/Cur=0.1092 Te/Exp=0.1688]100%|██████████| 2/2 [00:16<00:00,  7.63s/it, CE=2.322084e+00 H=2.322018e+00 dV_dx=2.845134e-07 dV_dθ=-6.556927e-05 ||∇||=3.403069e-01 | Tr=0.1083 Te/Cur=0.1092 Te/Exp=0.1688]100%|██████████| 2/2 [00:16<00:00,  8.46s/it, CE=2.322084e+00 H=2.322018e+00 dV_dx=2.845134e-07 dV_dθ=-6.556927e-05 ||∇||=3.403069e-01 | Tr=0.1083 Te/Cur=0.1092 Te/Exp=0.1688]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 104, 10]) with loss 2.322084
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.64s/it] 50%|█████     | 1/2 [00:15<00:12, 12.64s/it, CE=2.321613e+00 H=2.321546e+00 dV_dx=1.149324e-06 dV_dθ=-6.831711e-05 ||∇||=3.486692e-01 | Tr=0.1006 Te/Cur=0.0937 Te/Exp=0.1141]100%|██████████| 2/2 [00:15<00:00,  6.86s/it, CE=2.321613e+00 H=2.321546e+00 dV_dx=1.149324e-06 dV_dθ=-6.831711e-05 ||∇||=3.486692e-01 | Tr=0.1006 Te/Cur=0.0937 Te/Exp=0.1141]100%|██████████| 2/2 [00:15<00:00,  7.73s/it, CE=2.321613e+00 H=2.321546e+00 dV_dx=1.149324e-06 dV_dθ=-6.831711e-05 ||∇||=3.486692e-01 | Tr=0.1006 Te/Cur=0.0937 Te/Exp=0.1141]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 592, 104, 10]) with loss 2.321613
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 13.00s/it] 50%|█████     | 1/2 [00:15<00:12, 13.00s/it, CE=2.321973e+00 H=2.321899e+00 dV_dx=-1.964649e-06 dV_dθ=-7.195245e-05 ||∇||=3.319285e-01 | Tr=0.0954 Te/Cur=0.0982 Te/Exp=0.1815]100%|██████████| 2/2 [00:15<00:00,  7.09s/it, CE=2.321973e+00 H=2.321899e+00 dV_dx=-1.964649e-06 dV_dθ=-7.195245e-05 ||∇||=3.319285e-01 | Tr=0.0954 Te/Cur=0.0982 Te/Exp=0.1815]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.321973e+00 H=2.321899e+00 dV_dx=-1.964649e-06 dV_dθ=-7.195245e-05 ||∇||=3.319285e-01 | Tr=0.0954 Te/Cur=0.0982 Te/Exp=0.1815]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.69s/it] 50%|█████     | 1/2 [00:07<00:04,  4.69s/it, CE=2.329142e+00 H=2.329070e+00 dV_dx=-3.914797e-06 dV_dθ=-6.817535e-05 ||∇||=3.524803e-01 | Tr=0.0584 Te/Cur=0.0714 Te/Exp=0.2022]100%|██████████| 2/2 [00:07<00:00,  3.48s/it, CE=2.329142e+00 H=2.329070e+00 dV_dx=-3.914797e-06 dV_dθ=-6.817535e-05 ||∇||=3.524803e-01 | Tr=0.0584 Te/Cur=0.0714 Te/Exp=0.2022]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.329142e+00 H=2.329070e+00 dV_dx=-3.914797e-06 dV_dθ=-6.817535e-05 ||∇||=3.524803e-01 | Tr=0.0584 Te/Cur=0.0714 Te/Exp=0.2022]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.26s/it] 50%|█████     | 1/2 [00:17<00:14, 14.26s/it, CE=2.333701e+00 H=2.333629e+00 dV_dx=-4.967353e-07 dV_dθ=-7.174565e-05 ||∇||=3.348155e-01 | Tr=0.0918 Te/Cur=0.0729 Te/Exp=0.1538]100%|██████████| 2/2 [00:17<00:00,  7.55s/it, CE=2.333701e+00 H=2.333629e+00 dV_dx=-4.967353e-07 dV_dθ=-7.174565e-05 ||∇||=3.348155e-01 | Tr=0.0918 Te/Cur=0.0729 Te/Exp=0.1538]100%|██████████| 2/2 [00:17<00:00,  8.56s/it, CE=2.333701e+00 H=2.333629e+00 dV_dx=-4.967353e-07 dV_dθ=-7.174565e-05 ||∇||=3.348155e-01 | Tr=0.0918 Te/Cur=0.0729 Te/Exp=0.1538]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.89s/it] 50%|█████     | 1/2 [00:15<00:12, 12.89s/it, CE=2.314612e+00 H=2.314547e+00 dV_dx=1.951786e-06 dV_dθ=-6.656030e-05 ||∇||=3.177297e-01 | Tr=0.0923 Te/Cur=0.0980 Te/Exp=0.1490]100%|██████████| 2/2 [00:15<00:00,  6.92s/it, CE=2.314612e+00 H=2.314547e+00 dV_dx=1.951786e-06 dV_dθ=-6.656030e-05 ||∇||=3.177297e-01 | Tr=0.0923 Te/Cur=0.0980 Te/Exp=0.1490]100%|██████████| 2/2 [00:15<00:00,  7.81s/it, CE=2.314612e+00 H=2.314547e+00 dV_dx=1.951786e-06 dV_dθ=-6.656030e-05 ||∇||=3.177297e-01 | Tr=0.0923 Te/Cur=0.0980 Te/Exp=0.1490]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 552, 144, 10]) with loss 2.314612
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.80s/it] 50%|█████     | 1/2 [00:15<00:12, 12.80s/it, CE=2.312988e+00 H=2.312936e+00 dV_dx=4.354632e-07 dV_dθ=-5.188681e-05 ||∇||=3.015884e-01 | Tr=0.0966 Te/Cur=0.0975 Te/Exp=0.1422]100%|██████████| 2/2 [00:15<00:00,  6.80s/it, CE=2.312988e+00 H=2.312936e+00 dV_dx=4.354632e-07 dV_dθ=-5.188681e-05 ||∇||=3.015884e-01 | Tr=0.0966 Te/Cur=0.0975 Te/Exp=0.1422]100%|██████████| 2/2 [00:15<00:00,  7.70s/it, CE=2.312988e+00 H=2.312936e+00 dV_dx=4.354632e-07 dV_dθ=-5.188681e-05 ||∇||=3.015884e-01 | Tr=0.0966 Te/Cur=0.0975 Te/Exp=0.1422]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 144, 10]) with loss 2.312988
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.54s/it] 50%|█████     | 1/2 [00:17<00:14, 14.54s/it, CE=2.316523e+00 H=2.316469e+00 dV_dx=2.763537e-06 dV_dθ=-5.665595e-05 ||∇||=3.273297e-01 | Tr=0.1002 Te/Cur=0.0953 Te/Exp=0.1625]100%|██████████| 2/2 [00:17<00:00,  7.98s/it, CE=2.316523e+00 H=2.316469e+00 dV_dx=2.763537e-06 dV_dθ=-5.665595e-05 ||∇||=3.273297e-01 | Tr=0.1002 Te/Cur=0.0953 Te/Exp=0.1625]100%|██████████| 2/2 [00:17<00:00,  8.96s/it, CE=2.316523e+00 H=2.316469e+00 dV_dx=2.763537e-06 dV_dθ=-5.665595e-05 ||∇||=3.273297e-01 | Tr=0.1002 Te/Cur=0.0953 Te/Exp=0.1625]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.52s/it] 50%|█████     | 1/2 [00:16<00:13, 13.52s/it, CE=2.306439e+00 H=2.306337e+00 dV_dx=1.412038e-06 dV_dθ=-1.037618e-04 ||∇||=4.259978e-01 | Tr=0.1030 Te/Cur=0.1064 Te/Exp=0.1687]100%|██████████| 2/2 [00:16<00:00,  7.12s/it, CE=2.306439e+00 H=2.306337e+00 dV_dx=1.412038e-06 dV_dθ=-1.037618e-04 ||∇||=4.259978e-01 | Tr=0.1030 Te/Cur=0.1064 Te/Exp=0.1687]100%|██████████| 2/2 [00:16<00:00,  8.08s/it, CE=2.306439e+00 H=2.306337e+00 dV_dx=1.412038e-06 dV_dθ=-1.037618e-04 ||∇||=4.259978e-01 | Tr=0.1030 Te/Cur=0.1064 Te/Exp=0.1687]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 552, 104, 10]) with loss 2.306439
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.01s/it] 50%|█████     | 1/2 [00:15<00:13, 13.01s/it, CE=2.296689e+00 H=2.296606e+00 dV_dx=-2.786421e-07 dV_dθ=-8.238598e-05 ||∇||=3.976333e-01 | Tr=0.1347 Te/Cur=0.1499 Te/Exp=0.1829]100%|██████████| 2/2 [00:15<00:00,  6.89s/it, CE=2.296689e+00 H=2.296606e+00 dV_dx=-2.786421e-07 dV_dθ=-8.238598e-05 ||∇||=3.976333e-01 | Tr=0.1347 Te/Cur=0.1499 Te/Exp=0.1829]100%|██████████| 2/2 [00:15<00:00,  7.81s/it, CE=2.296689e+00 H=2.296606e+00 dV_dx=-2.786421e-07 dV_dθ=-8.238598e-05 ||∇||=3.976333e-01 | Tr=0.1347 Te/Cur=0.1499 Te/Exp=0.1829]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 572, 104, 10]) with loss 2.296689
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.09s/it] 50%|█████     | 1/2 [00:18<00:14, 14.09s/it, CE=2.306782e+00 H=2.306689e+00 dV_dx=-4.813718e-06 dV_dθ=-8.908952e-05 ||∇||=3.957688e-01 | Tr=0.0970 Te/Cur=0.0938 Te/Exp=0.1337]100%|██████████| 2/2 [00:18<00:00,  8.52s/it, CE=2.306782e+00 H=2.306689e+00 dV_dx=-4.813718e-06 dV_dθ=-8.908952e-05 ||∇||=3.957688e-01 | Tr=0.0970 Te/Cur=0.0938 Te/Exp=0.1337]100%|██████████| 2/2 [00:18<00:00,  9.36s/it, CE=2.306782e+00 H=2.306689e+00 dV_dx=-4.813718e-06 dV_dθ=-8.908952e-05 ||∇||=3.957688e-01 | Tr=0.0970 Te/Cur=0.0938 Te/Exp=0.1337]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.53s/it] 50%|█████     | 1/2 [00:16<00:13, 13.53s/it, CE=2.305282e+00 H=2.305201e+00 dV_dx=-7.823111e-07 dV_dθ=-7.971846e-05 ||∇||=3.930336e-01 | Tr=0.0968 Te/Cur=0.0972 Te/Exp=0.1684]100%|██████████| 2/2 [00:16<00:00,  7.05s/it, CE=2.305282e+00 H=2.305201e+00 dV_dx=-7.823111e-07 dV_dθ=-7.971846e-05 ||∇||=3.930336e-01 | Tr=0.0968 Te/Cur=0.0972 Te/Exp=0.1684]100%|██████████| 2/2 [00:16<00:00,  8.02s/it, CE=2.305282e+00 H=2.305201e+00 dV_dx=-7.823111e-07 dV_dθ=-7.971846e-05 ||∇||=3.930336e-01 | Tr=0.0968 Te/Cur=0.0972 Te/Exp=0.1684]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.95s/it] 50%|█████     | 1/2 [00:06<00:04,  4.95s/it, CE=2.292554e+00 H=2.292466e+00 dV_dx=-2.429049e-06 dV_dθ=-8.563487e-05 ||∇||=4.038960e-01 | Tr=0.1099 Te/Cur=0.1161 Te/Exp=0.1987]100%|██████████| 2/2 [00:06<00:00,  3.10s/it, CE=2.292554e+00 H=2.292466e+00 dV_dx=-2.429049e-06 dV_dθ=-8.563487e-05 ||∇||=4.038960e-01 | Tr=0.1099 Te/Cur=0.1161 Te/Exp=0.1987]100%|██████████| 2/2 [00:06<00:00,  3.37s/it, CE=2.292554e+00 H=2.292466e+00 dV_dx=-2.429049e-06 dV_dθ=-8.563487e-05 ||∇||=4.038960e-01 | Tr=0.1099 Te/Cur=0.1161 Te/Exp=0.1987]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 572, 124, 10]) with loss 2.292554
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.15s/it] 50%|█████     | 1/2 [00:15<00:13, 13.15s/it, CE=2.298869e+00 H=2.298791e+00 dV_dx=4.469423e-06 dV_dθ=-8.308506e-05 ||∇||=4.104947e-01 | Tr=0.1266 Te/Cur=0.1276 Te/Exp=0.1779]100%|██████████| 2/2 [00:15<00:00,  6.88s/it, CE=2.298869e+00 H=2.298791e+00 dV_dx=4.469423e-06 dV_dθ=-8.308506e-05 ||∇||=4.104947e-01 | Tr=0.1266 Te/Cur=0.1276 Te/Exp=0.1779]100%|██████████| 2/2 [00:15<00:00,  7.82s/it, CE=2.298869e+00 H=2.298791e+00 dV_dx=4.469423e-06 dV_dθ=-8.308506e-05 ||∇||=4.104947e-01 | Tr=0.1266 Te/Cur=0.1276 Te/Exp=0.1779]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.84s/it] 50%|█████     | 1/2 [00:16<00:13, 13.84s/it, CE=2.288863e+00 H=2.288786e+00 dV_dx=4.218817e-06 dV_dθ=-8.082059e-05 ||∇||=3.978753e-01 | Tr=0.0954 Te/Cur=0.0924 Te/Exp=0.1526]100%|██████████| 2/2 [00:16<00:00,  7.53s/it, CE=2.288863e+00 H=2.288786e+00 dV_dx=4.218817e-06 dV_dθ=-8.082059e-05 ||∇||=3.978753e-01 | Tr=0.0954 Te/Cur=0.0924 Te/Exp=0.1526]100%|██████████| 2/2 [00:16<00:00,  8.48s/it, CE=2.288863e+00 H=2.288786e+00 dV_dx=4.218817e-06 dV_dθ=-8.082059e-05 ||∇||=3.978753e-01 | Tr=0.0954 Te/Cur=0.0924 Te/Exp=0.1526]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 552, 144, 10]) with loss 2.288863
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.40s/it] 50%|█████     | 1/2 [00:16<00:13, 13.40s/it, CE=2.289533e+00 H=2.289463e+00 dV_dx=-6.271781e-07 dV_dθ=-6.920726e-05 ||∇||=3.766296e-01 | Tr=0.1368 Te/Cur=0.1327 Te/Exp=0.1655]100%|██████████| 2/2 [00:16<00:00,  7.10s/it, CE=2.289533e+00 H=2.289463e+00 dV_dx=-6.271781e-07 dV_dθ=-6.920726e-05 ||∇||=3.766296e-01 | Tr=0.1368 Te/Cur=0.1327 Te/Exp=0.1655]100%|██████████| 2/2 [00:16<00:00,  8.05s/it, CE=2.289533e+00 H=2.289463e+00 dV_dx=-6.271781e-07 dV_dθ=-6.920726e-05 ||∇||=3.766296e-01 | Tr=0.1368 Te/Cur=0.1327 Te/Exp=0.1655]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.07s/it] 50%|█████     | 1/2 [00:15<00:13, 13.07s/it, CE=2.302119e+00 H=2.302052e+00 dV_dx=-5.353270e-06 dV_dθ=-6.210041e-05 ||∇||=3.974429e-01 | Tr=0.0986 Te/Cur=0.0934 Te/Exp=0.1669]100%|██████████| 2/2 [00:15<00:00,  7.06s/it, CE=2.302119e+00 H=2.302052e+00 dV_dx=-5.353270e-06 dV_dθ=-6.210041e-05 ||∇||=3.974429e-01 | Tr=0.0986 Te/Cur=0.0934 Te/Exp=0.1669]100%|██████████| 2/2 [00:15<00:00,  7.97s/it, CE=2.302119e+00 H=2.302052e+00 dV_dx=-5.353270e-06 dV_dθ=-6.210041e-05 ||∇||=3.974429e-01 | Tr=0.0986 Te/Cur=0.0934 Te/Exp=0.1669]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.03s/it] 50%|█████     | 1/2 [00:16<00:13, 13.03s/it, CE=2.215681e+00 H=2.215590e+00 dV_dx=9.287213e-07 dV_dθ=-9.195775e-05 ||∇||=7.056285e-01 | Tr=0.1071 Te/Cur=0.1095 Te/Exp=0.3060]100%|██████████| 2/2 [00:16<00:00,  7.25s/it, CE=2.215681e+00 H=2.215590e+00 dV_dx=9.287213e-07 dV_dθ=-9.195775e-05 ||∇||=7.056285e-01 | Tr=0.1071 Te/Cur=0.1095 Te/Exp=0.3060]100%|██████████| 2/2 [00:16<00:00,  8.12s/it, CE=2.215681e+00 H=2.215590e+00 dV_dx=9.287213e-07 dV_dθ=-9.195775e-05 ||∇||=7.056285e-01 | Tr=0.1071 Te/Cur=0.1095 Te/Exp=0.3060]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.215680683208465
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.64s/it] 50%|█████     | 1/2 [00:08<00:05,  5.64s/it, CE=2.202593e+00 H=2.202520e+00 dV_dx=-8.998948e-07 dV_dθ=-7.240131e-05 ||∇||=7.150081e-01 | Tr=0.1149 Te/Cur=0.1101 Te/Exp=0.2940]100%|██████████| 2/2 [00:08<00:00,  3.82s/it, CE=2.202593e+00 H=2.202520e+00 dV_dx=-8.998948e-07 dV_dθ=-7.240131e-05 ||∇||=7.150081e-01 | Tr=0.1149 Te/Cur=0.1101 Te/Exp=0.2940]100%|██████████| 2/2 [00:08<00:00,  4.10s/it, CE=2.202593e+00 H=2.202520e+00 dV_dx=-8.998948e-07 dV_dθ=-7.240131e-05 ||∇||=7.150081e-01 | Tr=0.1149 Te/Cur=0.1101 Te/Exp=0.2940]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 104, 10]) with loss 2.202593
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.62s/it] 50%|█████     | 1/2 [00:07<00:04,  4.62s/it, CE=2.222755e+00 H=2.222604e+00 dV_dx=4.225362e-06 dV_dθ=-1.551197e-04 ||∇||=7.385380e-01 | Tr=0.1139 Te/Cur=0.1238 Te/Exp=0.3136]100%|██████████| 2/2 [00:07<00:00,  3.31s/it, CE=2.222755e+00 H=2.222604e+00 dV_dx=4.225362e-06 dV_dθ=-1.551197e-04 ||∇||=7.385380e-01 | Tr=0.1139 Te/Cur=0.1238 Te/Exp=0.3136]100%|██████████| 2/2 [00:07<00:00,  3.51s/it, CE=2.222755e+00 H=2.222604e+00 dV_dx=4.225362e-06 dV_dθ=-1.551197e-04 ||∇||=7.385380e-01 | Tr=0.1139 Te/Cur=0.1238 Te/Exp=0.3136]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.14s/it] 50%|█████     | 1/2 [00:15<00:13, 13.14s/it, CE=2.231821e+00 H=2.231681e+00 dV_dx=-1.296168e-05 dV_dθ=-1.268845e-04 ||∇||=6.992595e-01 | Tr=0.1000 Te/Cur=0.1093 Te/Exp=0.2700]100%|██████████| 2/2 [00:15<00:00,  7.05s/it, CE=2.231821e+00 H=2.231681e+00 dV_dx=-1.296168e-05 dV_dθ=-1.268845e-04 ||∇||=6.992595e-01 | Tr=0.1000 Te/Cur=0.1093 Te/Exp=0.2700]100%|██████████| 2/2 [00:15<00:00,  7.97s/it, CE=2.231821e+00 H=2.231681e+00 dV_dx=-1.296168e-05 dV_dθ=-1.268845e-04 ||∇||=6.992595e-01 | Tr=0.1000 Te/Cur=0.1093 Te/Exp=0.2700]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.45s/it] 50%|█████     | 1/2 [00:07<00:04,  4.45s/it, CE=2.203291e+00 H=2.203261e+00 dV_dx=6.396331e-06 dV_dθ=-3.635752e-05 ||∇||=7.014919e-01 | Tr=0.1033 Te/Cur=0.0873 Te/Exp=0.3089]100%|██████████| 2/2 [00:07<00:00,  3.41s/it, CE=2.203291e+00 H=2.203261e+00 dV_dx=6.396331e-06 dV_dθ=-3.635752e-05 ||∇||=7.014919e-01 | Tr=0.1033 Te/Cur=0.0873 Te/Exp=0.3089]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.203291e+00 H=2.203261e+00 dV_dx=6.396331e-06 dV_dθ=-3.635752e-05 ||∇||=7.014919e-01 | Tr=0.1033 Te/Cur=0.0873 Te/Exp=0.3089]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.31s/it] 50%|█████     | 1/2 [00:09<00:06,  6.31s/it, CE=2.213341e+00 H=2.213200e+00 dV_dx=-1.412655e-05 dV_dθ=-1.273738e-04 ||∇||=7.435051e-01 | Tr=0.1214 Te/Cur=0.1090 Te/Exp=0.2707]100%|██████████| 2/2 [00:09<00:00,  4.18s/it, CE=2.213341e+00 H=2.213200e+00 dV_dx=-1.412655e-05 dV_dθ=-1.273738e-04 ||∇||=7.435051e-01 | Tr=0.1214 Te/Cur=0.1090 Te/Exp=0.2707]100%|██████████| 2/2 [00:09<00:00,  4.50s/it, CE=2.213341e+00 H=2.213200e+00 dV_dx=-1.412655e-05 dV_dθ=-1.273738e-04 ||∇||=7.435051e-01 | Tr=0.1214 Te/Cur=0.1090 Te/Exp=0.2707]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.76s/it] 50%|█████     | 1/2 [00:15<00:12, 12.76s/it, CE=2.227468e+00 H=2.227424e+00 dV_dx=6.003501e-06 dV_dθ=-4.939802e-05 ||∇||=7.258117e-01 | Tr=0.0337 Te/Cur=0.0411 Te/Exp=0.3356]100%|██████████| 2/2 [00:15<00:00,  6.87s/it, CE=2.227468e+00 H=2.227424e+00 dV_dx=6.003501e-06 dV_dθ=-4.939802e-05 ||∇||=7.258117e-01 | Tr=0.0337 Te/Cur=0.0411 Te/Exp=0.3356]100%|██████████| 2/2 [00:15<00:00,  7.76s/it, CE=2.227468e+00 H=2.227424e+00 dV_dx=6.003501e-06 dV_dθ=-4.939802e-05 ||∇||=7.258117e-01 | Tr=0.0337 Te/Cur=0.0411 Te/Exp=0.3356]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.62s/it] 50%|█████     | 1/2 [00:16<00:13, 13.62s/it, CE=2.231362e+00 H=2.231263e+00 dV_dx=1.463138e-05 dV_dθ=-1.131564e-04 ||∇||=8.546034e-01 | Tr=0.1123 Te/Cur=0.1095 Te/Exp=0.2814]100%|██████████| 2/2 [00:16<00:00,  7.01s/it, CE=2.231362e+00 H=2.231263e+00 dV_dx=1.463138e-05 dV_dθ=-1.131564e-04 ||∇||=8.546034e-01 | Tr=0.1123 Te/Cur=0.1095 Te/Exp=0.2814]100%|██████████| 2/2 [00:16<00:00,  8.00s/it, CE=2.231362e+00 H=2.231263e+00 dV_dx=1.463138e-05 dV_dθ=-1.131564e-04 ||∇||=8.546034e-01 | Tr=0.1123 Te/Cur=0.1095 Te/Exp=0.2814]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.50s/it] 50%|█████     | 1/2 [00:16<00:13, 13.50s/it, CE=2.217469e+00 H=2.217294e+00 dV_dx=7.875895e-06 dV_dθ=-1.831239e-04 ||∇||=8.156079e-01 | Tr=0.1142 Te/Cur=0.1092 Te/Exp=0.3223]100%|██████████| 2/2 [00:16<00:00,  7.35s/it, CE=2.217469e+00 H=2.217294e+00 dV_dx=7.875895e-06 dV_dθ=-1.831239e-04 ||∇||=8.156079e-01 | Tr=0.1142 Te/Cur=0.1092 Te/Exp=0.3223]100%|██████████| 2/2 [00:16<00:00,  8.28s/it, CE=2.217469e+00 H=2.217294e+00 dV_dx=7.875895e-06 dV_dθ=-1.831239e-04 ||∇||=8.156079e-01 | Tr=0.1142 Te/Cur=0.1092 Te/Exp=0.3223]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.38s/it] 50%|█████     | 1/2 [00:17<00:14, 14.38s/it, CE=2.253155e+00 H=2.253086e+00 dV_dx=-8.278958e-06 dV_dθ=-6.070064e-05 ||∇||=5.368378e-01 | Tr=0.1063 Te/Cur=0.1093 Te/Exp=0.2950]100%|██████████| 2/2 [00:17<00:00,  7.55s/it, CE=2.253155e+00 H=2.253086e+00 dV_dx=-8.278958e-06 dV_dθ=-6.070064e-05 ||∇||=5.368378e-01 | Tr=0.1063 Te/Cur=0.1093 Te/Exp=0.2950]100%|██████████| 2/2 [00:17<00:00,  8.57s/it, CE=2.253155e+00 H=2.253086e+00 dV_dx=-8.278958e-06 dV_dθ=-6.070064e-05 ||∇||=5.368378e-01 | Tr=0.1063 Te/Cur=0.1093 Te/Exp=0.2950]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.38s/it] 50%|█████     | 1/2 [00:07<00:04,  4.38s/it, CE=2.237346e+00 H=2.237307e+00 dV_dx=2.908226e-06 dV_dθ=-4.220570e-05 ||∇||=5.272777e-01 | Tr=0.1143 Te/Cur=0.1095 Te/Exp=0.2793]100%|██████████| 2/2 [00:07<00:00,  3.49s/it, CE=2.237346e+00 H=2.237307e+00 dV_dx=2.908226e-06 dV_dθ=-4.220570e-05 ||∇||=5.272777e-01 | Tr=0.1143 Te/Cur=0.1095 Te/Exp=0.2793]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.237346e+00 H=2.237307e+00 dV_dx=2.908226e-06 dV_dθ=-4.220570e-05 ||∇||=5.272777e-01 | Tr=0.1143 Te/Cur=0.1095 Te/Exp=0.2793]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.92s/it] 50%|█████     | 1/2 [00:07<00:04,  4.92s/it, CE=2.233809e+00 H=2.233744e+00 dV_dx=-5.911312e-06 dV_dθ=-5.986543e-05 ||∇||=5.040860e-01 | Tr=0.1143 Te/Cur=0.1086 Te/Exp=0.2464]100%|██████████| 2/2 [00:07<00:00,  3.51s/it, CE=2.233809e+00 H=2.233744e+00 dV_dx=-5.911312e-06 dV_dθ=-5.986543e-05 ||∇||=5.040860e-01 | Tr=0.1143 Te/Cur=0.1086 Te/Exp=0.2464]100%|██████████| 2/2 [00:07<00:00,  3.72s/it, CE=2.233809e+00 H=2.233744e+00 dV_dx=-5.911312e-06 dV_dθ=-5.986543e-05 ||∇||=5.040860e-01 | Tr=0.1143 Te/Cur=0.1086 Te/Exp=0.2464]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.29s/it] 50%|█████     | 1/2 [00:15<00:13, 13.29s/it, CE=2.242979e+00 H=2.242932e+00 dV_dx=-5.085421e-06 dV_dθ=-4.138720e-05 ||∇||=4.906743e-01 | Tr=0.0993 Te/Cur=0.0589 Te/Exp=0.3115]100%|██████████| 2/2 [00:15<00:00,  6.82s/it, CE=2.242979e+00 H=2.242932e+00 dV_dx=-5.085421e-06 dV_dθ=-4.138720e-05 ||∇||=4.906743e-01 | Tr=0.0993 Te/Cur=0.0589 Te/Exp=0.3115]100%|██████████| 2/2 [00:15<00:00,  7.79s/it, CE=2.242979e+00 H=2.242932e+00 dV_dx=-5.085421e-06 dV_dθ=-4.138720e-05 ||∇||=4.906743e-01 | Tr=0.0993 Te/Cur=0.0589 Te/Exp=0.3115]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.38s/it] 50%|█████     | 1/2 [00:09<00:06,  6.38s/it, CE=2.233143e+00 H=2.233115e+00 dV_dx=-1.145138e-06 dV_dθ=-2.634351e-05 ||∇||=4.887057e-01 | Tr=0.1286 Te/Cur=0.1100 Te/Exp=0.3146]100%|██████████| 2/2 [00:09<00:00,  4.23s/it, CE=2.233143e+00 H=2.233115e+00 dV_dx=-1.145138e-06 dV_dθ=-2.634351e-05 ||∇||=4.887057e-01 | Tr=0.1286 Te/Cur=0.1100 Te/Exp=0.3146]100%|██████████| 2/2 [00:09<00:00,  4.55s/it, CE=2.233143e+00 H=2.233115e+00 dV_dx=-1.145138e-06 dV_dθ=-2.634351e-05 ||∇||=4.887057e-01 | Tr=0.1286 Te/Cur=0.1100 Te/Exp=0.3146]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.09s/it] 50%|█████     | 1/2 [00:07<00:05,  5.09s/it, CE=2.230401e+00 H=2.230354e+00 dV_dx=6.183987e-06 dV_dθ=-5.360261e-05 ||∇||=5.092176e-01 | Tr=0.1028 Te/Cur=0.1086 Te/Exp=0.2766]100%|██████████| 2/2 [00:07<00:00,  3.76s/it, CE=2.230401e+00 H=2.230354e+00 dV_dx=6.183987e-06 dV_dθ=-5.360261e-05 ||∇||=5.092176e-01 | Tr=0.1028 Te/Cur=0.1086 Te/Exp=0.2766]100%|██████████| 2/2 [00:07<00:00,  3.96s/it, CE=2.230401e+00 H=2.230354e+00 dV_dx=6.183987e-06 dV_dθ=-5.360261e-05 ||∇||=5.092176e-01 | Tr=0.1028 Te/Cur=0.1086 Te/Exp=0.2766]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.41s/it] 50%|█████     | 1/2 [00:16<00:13, 13.41s/it, CE=2.238357e+00 H=2.238324e+00 dV_dx=-9.082219e-06 dV_dθ=-2.335381e-05 ||∇||=5.141172e-01 | Tr=0.1144 Te/Cur=0.1089 Te/Exp=0.3348]100%|██████████| 2/2 [00:16<00:00,  7.33s/it, CE=2.238357e+00 H=2.238324e+00 dV_dx=-9.082219e-06 dV_dθ=-2.335381e-05 ||∇||=5.141172e-01 | Tr=0.1144 Te/Cur=0.1089 Te/Exp=0.3348]100%|██████████| 2/2 [00:16<00:00,  8.24s/it, CE=2.238357e+00 H=2.238324e+00 dV_dx=-9.082219e-06 dV_dθ=-2.335381e-05 ||∇||=5.141172e-01 | Tr=0.1144 Te/Cur=0.1089 Te/Exp=0.3348]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.62s/it] 50%|█████     | 1/2 [00:16<00:13, 13.62s/it, CE=2.249407e+00 H=2.249338e+00 dV_dx=-8.565098e-06 dV_dθ=-6.023404e-05 ||∇||=5.386967e-01 | Tr=0.1125 Te/Cur=0.1075 Te/Exp=0.2727]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.249407e+00 H=2.249338e+00 dV_dx=-8.565098e-06 dV_dθ=-6.023404e-05 ||∇||=5.386967e-01 | Tr=0.1125 Te/Cur=0.1075 Te/Exp=0.2727]100%|██████████| 2/2 [00:16<00:00,  8.24s/it, CE=2.249407e+00 H=2.249338e+00 dV_dx=-8.565098e-06 dV_dθ=-6.023404e-05 ||∇||=5.386967e-01 | Tr=0.1125 Te/Cur=0.1075 Te/Exp=0.2727]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.72s/it] 50%|█████     | 1/2 [00:17<00:13, 13.72s/it, CE=2.218901e+00 H=2.218857e+00 dV_dx=-2.268562e-06 dV_dθ=-4.155475e-05 ||∇||=5.590727e-01 | Tr=0.1135 Te/Cur=0.1081 Te/Exp=0.3107]100%|██████████| 2/2 [00:17<00:00,  7.80s/it, CE=2.218901e+00 H=2.218857e+00 dV_dx=-2.268562e-06 dV_dθ=-4.155475e-05 ||∇||=5.590727e-01 | Tr=0.1135 Te/Cur=0.1081 Te/Exp=0.3107]100%|██████████| 2/2 [00:17<00:00,  8.69s/it, CE=2.218901e+00 H=2.218857e+00 dV_dx=-2.268562e-06 dV_dθ=-4.155475e-05 ||∇||=5.590727e-01 | Tr=0.1135 Te/Cur=0.1081 Te/Exp=0.3107]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.82s/it] 50%|█████     | 1/2 [00:15<00:12, 12.82s/it, CE=2.237435e+00 H=2.237386e+00 dV_dx=4.108193e-06 dV_dθ=-5.260790e-05 ||∇||=4.561834e-01 | Tr=0.1394 Te/Cur=0.1366 Te/Exp=0.3256]100%|██████████| 2/2 [00:15<00:00,  6.86s/it, CE=2.237435e+00 H=2.237386e+00 dV_dx=4.108193e-06 dV_dθ=-5.260790e-05 ||∇||=4.561834e-01 | Tr=0.1394 Te/Cur=0.1366 Te/Exp=0.3256]100%|██████████| 2/2 [00:15<00:00,  7.76s/it, CE=2.237435e+00 H=2.237386e+00 dV_dx=4.108193e-06 dV_dθ=-5.260790e-05 ||∇||=4.561834e-01 | Tr=0.1394 Te/Cur=0.1366 Te/Exp=0.3256]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.55s/it] 50%|█████     | 1/2 [00:07<00:04,  4.55s/it, CE=2.250578e+00 H=2.250504e+00 dV_dx=-1.649758e-06 dV_dθ=-7.172484e-05 ||∇||=4.660572e-01 | Tr=0.1238 Te/Cur=0.1699 Te/Exp=0.3046]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.250578e+00 H=2.250504e+00 dV_dx=-1.649758e-06 dV_dθ=-7.172484e-05 ||∇||=4.660572e-01 | Tr=0.1238 Te/Cur=0.1699 Te/Exp=0.3046]100%|██████████| 2/2 [00:07<00:00,  3.79s/it, CE=2.250578e+00 H=2.250504e+00 dV_dx=-1.649758e-06 dV_dθ=-7.172484e-05 ||∇||=4.660572e-01 | Tr=0.1238 Te/Cur=0.1699 Te/Exp=0.3046]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.10s/it] 50%|█████     | 1/2 [00:06<00:04,  4.10s/it, CE=2.241086e+00 H=2.241043e+00 dV_dx=-4.340659e-06 dV_dθ=-3.840646e-05 ||∇||=4.184042e-01 | Tr=0.1188 Te/Cur=0.1097 Te/Exp=0.3135]100%|██████████| 2/2 [00:06<00:00,  3.20s/it, CE=2.241086e+00 H=2.241043e+00 dV_dx=-4.340659e-06 dV_dθ=-3.840646e-05 ||∇||=4.184042e-01 | Tr=0.1188 Te/Cur=0.1097 Te/Exp=0.3135]100%|██████████| 2/2 [00:06<00:00,  3.34s/it, CE=2.241086e+00 H=2.241043e+00 dV_dx=-4.340659e-06 dV_dθ=-3.840646e-05 ||∇||=4.184042e-01 | Tr=0.1188 Te/Cur=0.1097 Te/Exp=0.3135]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.06s/it] 50%|█████     | 1/2 [00:15<00:13, 13.06s/it, CE=2.245250e+00 H=2.245196e+00 dV_dx=5.187784e-06 dV_dθ=-5.914108e-05 ||∇||=4.279343e-01 | Tr=0.1786 Te/Cur=0.1889 Te/Exp=0.3259]100%|██████████| 2/2 [00:15<00:00,  7.08s/it, CE=2.245250e+00 H=2.245196e+00 dV_dx=5.187784e-06 dV_dθ=-5.914108e-05 ||∇||=4.279343e-01 | Tr=0.1786 Te/Cur=0.1889 Te/Exp=0.3259]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.245250e+00 H=2.245196e+00 dV_dx=5.187784e-06 dV_dθ=-5.914108e-05 ||∇||=4.279343e-01 | Tr=0.1786 Te/Cur=0.1889 Te/Exp=0.3259]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.16s/it] 50%|█████     | 1/2 [00:09<00:06,  6.16s/it, CE=2.236005e+00 H=2.235942e+00 dV_dx=-6.797958e-06 dV_dθ=-5.651498e-05 ||∇||=4.470504e-01 | Tr=0.1177 Te/Cur=0.1280 Te/Exp=0.3248]100%|██████████| 2/2 [00:09<00:00,  4.24s/it, CE=2.236005e+00 H=2.235942e+00 dV_dx=-6.797958e-06 dV_dθ=-5.651498e-05 ||∇||=4.470504e-01 | Tr=0.1177 Te/Cur=0.1280 Te/Exp=0.3248]100%|██████████| 2/2 [00:09<00:00,  4.53s/it, CE=2.236005e+00 H=2.235942e+00 dV_dx=-6.797958e-06 dV_dθ=-5.651498e-05 ||∇||=4.470504e-01 | Tr=0.1177 Te/Cur=0.1280 Te/Exp=0.3248]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.41s/it] 50%|█████     | 1/2 [00:07<00:04,  4.41s/it, CE=2.233103e+00 H=2.233057e+00 dV_dx=-1.166795e-05 dV_dθ=-3.473709e-05 ||∇||=4.580696e-01 | Tr=0.1209 Te/Cur=0.1623 Te/Exp=0.2967]100%|██████████| 2/2 [00:07<00:00,  3.53s/it, CE=2.233103e+00 H=2.233057e+00 dV_dx=-1.166795e-05 dV_dθ=-3.473709e-05 ||∇||=4.580696e-01 | Tr=0.1209 Te/Cur=0.1623 Te/Exp=0.2967]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.233103e+00 H=2.233057e+00 dV_dx=-1.166795e-05 dV_dθ=-3.473709e-05 ||∇||=4.580696e-01 | Tr=0.1209 Te/Cur=0.1623 Te/Exp=0.2967]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.16s/it] 50%|█████     | 1/2 [00:15<00:13, 13.16s/it, CE=2.258642e+00 H=2.258574e+00 dV_dx=2.113704e-06 dV_dθ=-6.984392e-05 ||∇||=4.309791e-01 | Tr=0.1011 Te/Cur=0.1082 Te/Exp=0.3326]100%|██████████| 2/2 [00:15<00:00,  7.05s/it, CE=2.258642e+00 H=2.258574e+00 dV_dx=2.113704e-06 dV_dθ=-6.984392e-05 ||∇||=4.309791e-01 | Tr=0.1011 Te/Cur=0.1082 Te/Exp=0.3326]100%|██████████| 2/2 [00:15<00:00,  7.96s/it, CE=2.258642e+00 H=2.258574e+00 dV_dx=2.113704e-06 dV_dθ=-6.984392e-05 ||∇||=4.309791e-01 | Tr=0.1011 Te/Cur=0.1082 Te/Exp=0.3326]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.88s/it] 50%|█████     | 1/2 [00:15<00:12, 12.88s/it, CE=2.241842e+00 H=2.241786e+00 dV_dx=-3.001468e-08 dV_dθ=-5.617103e-05 ||∇||=4.541275e-01 | Tr=0.1162 Te/Cur=0.1387 Te/Exp=0.3480]100%|██████████| 2/2 [00:15<00:00,  7.04s/it, CE=2.241842e+00 H=2.241786e+00 dV_dx=-3.001468e-08 dV_dθ=-5.617103e-05 ||∇||=4.541275e-01 | Tr=0.1162 Te/Cur=0.1387 Te/Exp=0.3480]100%|██████████| 2/2 [00:15<00:00,  7.91s/it, CE=2.241842e+00 H=2.241786e+00 dV_dx=-3.001468e-08 dV_dθ=-5.617103e-05 ||∇||=4.541275e-01 | Tr=0.1162 Te/Cur=0.1387 Te/Exp=0.3480]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.46s/it] 50%|█████     | 1/2 [00:17<00:14, 14.46s/it, CE=2.236571e+00 H=2.236502e+00 dV_dx=3.821808e-06 dV_dθ=-7.286103e-05 ||∇||=4.726015e-01 | Tr=0.1274 Te/Cur=0.1398 Te/Exp=0.3347]100%|██████████| 2/2 [00:17<00:00,  7.86s/it, CE=2.236571e+00 H=2.236502e+00 dV_dx=3.821808e-06 dV_dθ=-7.286103e-05 ||∇||=4.726015e-01 | Tr=0.1274 Te/Cur=0.1398 Te/Exp=0.3347]100%|██████████| 2/2 [00:17<00:00,  8.85s/it, CE=2.236571e+00 H=2.236502e+00 dV_dx=3.821808e-06 dV_dθ=-7.286103e-05 ||∇||=4.726015e-01 | Tr=0.1274 Te/Cur=0.1398 Te/Exp=0.3347]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 552, 104, 10]) with loss 2.202593
  Total candidates evaluated: 54
  Original: (3, [507, 572, 124, 10])
  Optimal: (2, [507, 552, 104, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 3→2, feed [507, 572, 124, 10]→[507, 552, 104, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 3)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:18<05:56, 18.75s/it]  5%|▌         | 1/20 [00:23<05:56, 18.75s/it, CE=1.427043e+00 H=1.419708e+00 dV_dx=-6.838153e-06 dV_dθ=-7.327704e-03 ||∇||=2.815887e+00 | Tr=0.4531] 10%|█         | 2/20 [00:23<03:08, 10.46s/it, CE=1.427043e+00 H=1.419708e+00 dV_dx=-6.838153e-06 dV_dθ=-7.327704e-03 ||∇||=2.815887e+00 | Tr=0.4531] 10%|█         | 2/20 [00:27<03:08, 10.46s/it, CE=1.182230e+00 H=1.172371e+00 dV_dx=1.424333e-06 dV_dθ=-9.860280e-03 ||∇||=3.313808e+00 | Tr=0.4531]  15%|█▌        | 3/20 [00:27<02:11,  7.74s/it, CE=1.182230e+00 H=1.172371e+00 dV_dx=1.424333e-06 dV_dθ=-9.860280e-03 ||∇||=3.313808e+00 | Tr=0.4531] 15%|█▌        | 3/20 [00:31<02:11,  7.74s/it, CE=1.035329e+00 H=1.026115e+00 dV_dx=-3.768138e-05 dV_dθ=-9.176119e-03 ||∇||=3.372582e+00 | Tr=0.4531] 20%|██        | 4/20 [00:31<01:39,  6.19s/it, CE=1.035329e+00 H=1.026115e+00 dV_dx=-3.768138e-05 dV_dθ=-9.176119e-03 ||∇||=3.372582e+00 | Tr=0.4531] 20%|██        | 4/20 [00:35<01:39,  6.19s/it, CE=9.362456e-01 H=9.281457e-01 dV_dx=7.744436e-06 dV_dθ=-8.107635e-03 ||∇||=3.342486e+00 | Tr=0.4531]  25%|██▌       | 5/20 [00:35<01:17,  5.17s/it, CE=9.362456e-01 H=9.281457e-01 dV_dx=7.744436e-06 dV_dθ=-8.107635e-03 ||∇||=3.342486e+00 | Tr=0.4531] 25%|██▌       | 5/20 [00:39<01:17,  5.17s/it, CE=8.627191e-01 H=8.543966e-01 dV_dx=-2.040728e-05 dV_dθ=-8.302058e-03 ||∇||=3.437619e+00 | Tr=0.4531] 30%|███       | 6/20 [00:39<01:09,  4.94s/it, CE=8.627191e-01 H=8.543966e-01 dV_dx=-2.040728e-05 dV_dθ=-8.302058e-03 ||∇||=3.437619e+00 | Tr=0.4531] 30%|███       | 6/20 [00:43<01:09,  4.94s/it, CE=8.038862e-01 H=7.945312e-01 dV_dx=2.283227e-05 dV_dθ=-9.377825e-03 ||∇||=3.570672e+00 | Tr=0.4531]  35%|███▌      | 7/20 [00:43<01:01,  4.75s/it, CE=8.038862e-01 H=7.945312e-01 dV_dx=2.283227e-05 dV_dθ=-9.377825e-03 ||∇||=3.570672e+00 | Tr=0.4531] 35%|███▌      | 7/20 [00:48<01:01,  4.75s/it, CE=7.548631e-01 H=7.451962e-01 dV_dx=1.249140e-05 dV_dθ=-9.679393e-03 ||∇||=3.558904e+00 | Tr=0.4531] 40%|████      | 8/20 [00:48<00:55,  4.64s/it, CE=7.548631e-01 H=7.451962e-01 dV_dx=1.249140e-05 dV_dθ=-9.679393e-03 ||∇||=3.558904e+00 | Tr=0.4531] 40%|████      | 8/20 [00:52<00:55,  4.64s/it, CE=7.130883e-01 H=7.033901e-01 dV_dx=3.429744e-05 dV_dθ=-9.732415e-03 ||∇||=3.535615e+00 | Tr=0.4531] 45%|████▌     | 9/20 [00:52<00:49,  4.49s/it, CE=7.130883e-01 H=7.033901e-01 dV_dx=3.429744e-05 dV_dθ=-9.732415e-03 ||∇||=3.535615e+00 | Tr=0.4531] 45%|████▌     | 9/20 [00:57<00:49,  4.49s/it, CE=6.783724e-01 H=6.686785e-01 dV_dx=-3.619006e-05 dV_dθ=-9.657718e-03 ||∇||=3.550026e+00 | Tr=0.4531] 50%|█████     | 10/20 [00:57<00:45,  4.58s/it, CE=6.783724e-01 H=6.686785e-01 dV_dx=-3.619006e-05 dV_dθ=-9.657718e-03 ||∇||=3.550026e+00 | Tr=0.4531] 50%|█████     | 10/20 [01:01<00:45,  4.58s/it, CE=6.480346e-01 H=6.392932e-01 dV_dx=-4.446023e-05 dV_dθ=-8.696908e-03 ||∇||=3.455784e+00 | Tr=0.4531] 55%|█████▌    | 11/20 [01:01<00:40,  4.48s/it, CE=6.480346e-01 H=6.392932e-01 dV_dx=-4.446023e-05 dV_dθ=-8.696908e-03 ||∇||=3.455784e+00 | Tr=0.4531] 55%|█████▌    | 11/20 [01:05<00:40,  4.48s/it, CE=6.213631e-01 H=6.132152e-01 dV_dx=5.368887e-05 dV_dθ=-8.201554e-03 ||∇||=3.431331e+00 | Tr=0.4531]  60%|██████    | 12/20 [01:05<00:34,  4.37s/it, CE=6.213631e-01 H=6.132152e-01 dV_dx=5.368887e-05 dV_dθ=-8.201554e-03 ||∇||=3.431331e+00 | Tr=0.4531] 60%|██████    | 12/20 [01:10<00:34,  4.37s/it, CE=5.979338e-01 H=5.900362e-01 dV_dx=-2.588126e-05 dV_dθ=-7.871676e-03 ||∇||=3.397760e+00 | Tr=0.4531] 65%|██████▌   | 13/20 [01:10<00:30,  4.39s/it, CE=5.979338e-01 H=5.900362e-01 dV_dx=-2.588126e-05 dV_dθ=-7.871676e-03 ||∇||=3.397760e+00 | Tr=0.4531] 65%|██████▌   | 13/20 [01:14<00:30,  4.39s/it, CE=5.771390e-01 H=5.695918e-01 dV_dx=-1.566827e-05 dV_dθ=-7.531553e-03 ||∇||=3.365097e+00 | Tr=0.4531] 70%|███████   | 14/20 [01:14<00:26,  4.36s/it, CE=5.771390e-01 H=5.695918e-01 dV_dx=-1.566827e-05 dV_dθ=-7.531553e-03 ||∇||=3.365097e+00 | Tr=0.4531] 70%|███████   | 14/20 [01:19<00:26,  4.36s/it, CE=5.589135e-01 H=5.518455e-01 dV_dx=3.677069e-05 dV_dθ=-7.104736e-03 ||∇||=3.337980e+00 | Tr=0.4531]  75%|███████▌  | 15/20 [01:19<00:22,  4.49s/it, CE=5.589135e-01 H=5.518455e-01 dV_dx=3.677069e-05 dV_dθ=-7.104736e-03 ||∇||=3.337980e+00 | Tr=0.4531] 75%|███████▌  | 15/20 [01:23<00:22,  4.49s/it, CE=5.429426e-01 H=5.358990e-01 dV_dx=8.396424e-06 dV_dθ=-7.051974e-03 ||∇||=3.376173e+00 | Tr=0.4531] 80%|████████  | 16/20 [01:23<00:17,  4.49s/it, CE=5.429426e-01 H=5.358990e-01 dV_dx=8.396424e-06 dV_dθ=-7.051974e-03 ||∇||=3.376173e+00 | Tr=0.4531] 80%|████████  | 16/20 [01:28<00:17,  4.49s/it, CE=5.284338e-01 H=5.215649e-01 dV_dx=1.518047e-05 dV_dθ=-6.884047e-03 ||∇||=3.392954e+00 | Tr=0.4531] 85%|████████▌ | 17/20 [01:28<00:13,  4.54s/it, CE=5.284338e-01 H=5.215649e-01 dV_dx=1.518047e-05 dV_dθ=-6.884047e-03 ||∇||=3.392954e+00 | Tr=0.4531] 85%|████████▌ | 17/20 [01:32<00:13,  4.54s/it, CE=5.149673e-01 H=5.080441e-01 dV_dx=3.922778e-05 dV_dθ=-6.962414e-03 ||∇||=3.424300e+00 | Tr=0.4531] 90%|█████████ | 18/20 [01:32<00:08,  4.43s/it, CE=5.149673e-01 H=5.080441e-01 dV_dx=3.922778e-05 dV_dθ=-6.962414e-03 ||∇||=3.424300e+00 | Tr=0.4531] 90%|█████████ | 18/20 [01:36<00:08,  4.43s/it, CE=5.028292e-01 H=4.956912e-01 dV_dx=3.686068e-05 dV_dθ=-7.174764e-03 ||∇||=3.488299e+00 | Tr=0.4531] 95%|█████████▌| 19/20 [01:36<00:04,  4.41s/it, CE=5.028292e-01 H=4.956912e-01 dV_dx=3.686068e-05 dV_dθ=-7.174764e-03 ||∇||=3.488299e+00 | Tr=0.4531] 95%|█████████▌| 19/20 [01:44<00:04,  4.41s/it, CE=4.921787e-01 H=4.842830e-01 dV_dx=2.706376e-05 dV_dθ=-7.922790e-03 ||∇||=3.614178e+00 | Tr=0.4531 Te/Cur=0.5723 Te/Exp=0.8238]100%|██████████| 20/20 [01:48<00:00,  6.69s/it, CE=4.921787e-01 H=4.842830e-01 dV_dx=2.706376e-05 dV_dθ=-7.922790e-03 ||∇||=3.614178e+00 | Tr=0.4531 Te/Cur=0.5723 Te/Exp=0.8238]100%|██████████| 20/20 [01:48<00:00,  5.44s/it, CE=4.921787e-01 H=4.842830e-01 dV_dx=2.706376e-05 dV_dθ=-7.922790e-03 ||∇||=3.614178e+00 | Tr=0.4531 Te/Cur=0.5723 Te/Exp=0.8238]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.492179
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:08<02:48,  8.84s/it]  5%|▌         | 1/20 [00:13<02:48,  8.84s/it, CE=5.128296e-01 H=4.949436e-01 dV_dx=-2.556675e-05 dV_dθ=-1.786046e-02 ||∇||=4.541370e+00 | Tr=0.4534] 10%|█         | 2/20 [00:13<01:49,  6.11s/it, CE=5.128296e-01 H=4.949436e-01 dV_dx=-2.556675e-05 dV_dθ=-1.786046e-02 ||∇||=4.541370e+00 | Tr=0.4534] 10%|█         | 2/20 [00:17<01:49,  6.11s/it, CE=4.952814e-01 H=4.846181e-01 dV_dx=4.975624e-05 dV_dθ=-1.071305e-02 ||∇||=3.870497e+00 | Tr=0.4534]  15%|█▌        | 3/20 [00:17<01:32,  5.42s/it, CE=4.952814e-01 H=4.846181e-01 dV_dx=4.975624e-05 dV_dθ=-1.071305e-02 ||∇||=3.870497e+00 | Tr=0.4534] 15%|█▌        | 3/20 [00:22<01:32,  5.42s/it, CE=4.847405e-01 H=4.727564e-01 dV_dx=1.341244e-05 dV_dθ=-1.199752e-02 ||∇||=4.026616e+00 | Tr=0.4534] 20%|██        | 4/20 [00:22<01:21,  5.11s/it, CE=4.847405e-01 H=4.727564e-01 dV_dx=1.341244e-05 dV_dθ=-1.199752e-02 ||∇||=4.026616e+00 | Tr=0.4534] 20%|██        | 4/20 [00:26<01:21,  5.11s/it, CE=4.744090e-01 H=4.631702e-01 dV_dx=-4.970362e-05 dV_dθ=-1.118913e-02 ||∇||=3.909883e+00 | Tr=0.4534] 25%|██▌       | 5/20 [00:26<01:14,  4.97s/it, CE=4.744090e-01 H=4.631702e-01 dV_dx=-4.970362e-05 dV_dθ=-1.118913e-02 ||∇||=3.909883e+00 | Tr=0.4534] 25%|██▌       | 5/20 [00:31<01:14,  4.97s/it, CE=4.643788e-01 H=4.552333e-01 dV_dx=4.051722e-05 dV_dθ=-9.185975e-03 ||∇||=3.651807e+00 | Tr=0.4534]  30%|███       | 6/20 [00:31<01:06,  4.74s/it, CE=4.643788e-01 H=4.552333e-01 dV_dx=4.051722e-05 dV_dθ=-9.185975e-03 ||∇||=3.651807e+00 | Tr=0.4534] 30%|███       | 6/20 [00:36<01:06,  4.74s/it, CE=4.551274e-01 H=4.476370e-01 dV_dx=3.317507e-05 dV_dθ=-7.523545e-03 ||∇||=3.413390e+00 | Tr=0.4534] 35%|███▌      | 7/20 [00:36<01:02,  4.81s/it, CE=4.551274e-01 H=4.476370e-01 dV_dx=3.317507e-05 dV_dθ=-7.523545e-03 ||∇||=3.413390e+00 | Tr=0.4534] 35%|███▌      | 7/20 [00:40<01:02,  4.81s/it, CE=4.471779e-01 H=4.397782e-01 dV_dx=1.314747e-05 dV_dθ=-7.412778e-03 ||∇||=3.397690e+00 | Tr=0.4534] 40%|████      | 8/20 [00:40<00:55,  4.59s/it, CE=4.471779e-01 H=4.397782e-01 dV_dx=1.314747e-05 dV_dθ=-7.412778e-03 ||∇||=3.397690e+00 | Tr=0.4534] 40%|████      | 8/20 [00:44<00:55,  4.59s/it, CE=4.392612e-01 H=4.322654e-01 dV_dx=-9.599700e-06 dV_dθ=-6.986275e-03 ||∇||=3.332390e+00 | Tr=0.4534] 45%|████▌     | 9/20 [00:44<00:49,  4.50s/it, CE=4.392612e-01 H=4.322654e-01 dV_dx=-9.599700e-06 dV_dθ=-6.986275e-03 ||∇||=3.332390e+00 | Tr=0.4534] 45%|████▌     | 9/20 [00:49<00:49,  4.50s/it, CE=4.321924e-01 H=4.253474e-01 dV_dx=1.160725e-05 dV_dθ=-6.856613e-03 ||∇||=3.315182e+00 | Tr=0.4534]  50%|█████     | 10/20 [00:49<00:45,  4.51s/it, CE=4.321924e-01 H=4.253474e-01 dV_dx=1.160725e-05 dV_dθ=-6.856613e-03 ||∇||=3.315182e+00 | Tr=0.4534] 50%|█████     | 10/20 [00:53<00:45,  4.51s/it, CE=4.255009e-01 H=4.185941e-01 dV_dx=-2.045161e-05 dV_dθ=-6.886308e-03 ||∇||=3.330236e+00 | Tr=0.4534] 55%|█████▌    | 11/20 [00:53<00:40,  4.50s/it, CE=4.255009e-01 H=4.185941e-01 dV_dx=-2.045161e-05 dV_dθ=-6.886308e-03 ||∇||=3.330236e+00 | Tr=0.4534] 55%|█████▌    | 11/20 [00:57<00:40,  4.50s/it, CE=4.186024e-01 H=4.120699e-01 dV_dx=-3.733043e-05 dV_dθ=-6.495138e-03 ||∇||=3.280086e+00 | Tr=0.4534] 60%|██████    | 12/20 [00:57<00:35,  4.45s/it, CE=4.186024e-01 H=4.120699e-01 dV_dx=-3.733043e-05 dV_dθ=-6.495138e-03 ||∇||=3.280086e+00 | Tr=0.4534] 60%|██████    | 12/20 [01:02<00:35,  4.45s/it, CE=4.124559e-01 H=4.061036e-01 dV_dx=-1.612826e-05 dV_dθ=-6.336141e-03 ||∇||=3.262986e+00 | Tr=0.4534] 65%|██████▌   | 13/20 [01:02<00:31,  4.46s/it, CE=4.124559e-01 H=4.061036e-01 dV_dx=-1.612826e-05 dV_dθ=-6.336141e-03 ||∇||=3.262986e+00 | Tr=0.4534] 65%|██████▌   | 13/20 [01:07<00:31,  4.46s/it, CE=4.065092e-01 H=4.002032e-01 dV_dx=2.415878e-05 dV_dθ=-6.330158e-03 ||∇||=3.269228e+00 | Tr=0.4534]  70%|███████   | 14/20 [01:07<00:27,  4.54s/it, CE=4.065092e-01 H=4.002032e-01 dV_dx=2.415878e-05 dV_dθ=-6.330158e-03 ||∇||=3.269228e+00 | Tr=0.4534] 70%|███████   | 14/20 [01:11<00:27,  4.54s/it, CE=4.007867e-01 H=3.944371e-01 dV_dx=-5.726018e-06 dV_dθ=-6.343945e-03 ||∇||=3.278686e+00 | Tr=0.4534] 75%|███████▌  | 15/20 [01:11<00:22,  4.57s/it, CE=4.007867e-01 H=3.944371e-01 dV_dx=-5.726018e-06 dV_dθ=-6.343945e-03 ||∇||=3.278686e+00 | Tr=0.4534] 75%|███████▌  | 15/20 [01:15<00:22,  4.57s/it, CE=3.952972e-01 H=3.888852e-01 dV_dx=-8.189861e-05 dV_dθ=-6.330036e-03 ||∇||=3.275108e+00 | Tr=0.4534] 80%|████████  | 16/20 [01:15<00:17,  4.40s/it, CE=3.952972e-01 H=3.888852e-01 dV_dx=-8.189861e-05 dV_dθ=-6.330036e-03 ||∇||=3.275108e+00 | Tr=0.4534] 80%|████████  | 16/20 [01:20<00:17,  4.40s/it, CE=3.898145e-01 H=3.837738e-01 dV_dx=-7.344396e-05 dV_dθ=-5.967279e-03 ||∇||=3.234055e+00 | Tr=0.4534] 85%|████████▌ | 17/20 [01:20<00:13,  4.48s/it, CE=3.898145e-01 H=3.837738e-01 dV_dx=-7.344396e-05 dV_dθ=-5.967279e-03 ||∇||=3.234055e+00 | Tr=0.4534] 85%|████████▌ | 17/20 [01:24<00:13,  4.48s/it, CE=3.844172e-01 H=3.788859e-01 dV_dx=1.397317e-05 dV_dθ=-5.545246e-03 ||∇||=3.195982e+00 | Tr=0.4534]  90%|█████████ | 18/20 [01:24<00:08,  4.36s/it, CE=3.844172e-01 H=3.788859e-01 dV_dx=1.397317e-05 dV_dθ=-5.545246e-03 ||∇||=3.195982e+00 | Tr=0.4534] 90%|█████████ | 18/20 [01:28<00:08,  4.36s/it, CE=3.794790e-01 H=3.740279e-01 dV_dx=-6.064538e-05 dV_dθ=-5.390450e-03 ||∇||=3.188478e+00 | Tr=0.4534] 95%|█████████▌| 19/20 [01:28<00:04,  4.33s/it, CE=3.794790e-01 H=3.740279e-01 dV_dx=-6.064538e-05 dV_dθ=-5.390450e-03 ||∇||=3.188478e+00 | Tr=0.4534] 95%|█████████▌| 19/20 [01:35<00:04,  4.33s/it, CE=3.745611e-01 H=3.691325e-01 dV_dx=-6.767243e-06 dV_dθ=-5.421801e-03 ||∇||=3.180403e+00 | Tr=0.4534 Te/Cur=0.5883 Te/Exp=0.8517]100%|██████████| 20/20 [01:41<00:00,  6.71s/it, CE=3.745611e-01 H=3.691325e-01 dV_dx=-6.767243e-06 dV_dθ=-5.421801e-03 ||∇||=3.180403e+00 | Tr=0.4534 Te/Cur=0.5883 Te/Exp=0.8517]100%|██████████| 20/20 [01:41<00:00,  5.06s/it, CE=3.745611e-01 H=3.691325e-01 dV_dx=-6.767243e-06 dV_dθ=-5.421801e-03 ||∇||=3.180403e+00 | Tr=0.4534 Te/Cur=0.5883 Te/Exp=0.8517]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.19s/it] 50%|█████     | 1/2 [00:20<00:14, 14.19s/it, CE=3.879225e-01 H=3.870586e-01 dV_dx=4.781003e-05 dV_dθ=-9.117429e-04 ||∇||=1.110462e+00 | Tr=0.6141 Te/Cur=0.6007 Te/Exp=0.8571]100%|██████████| 2/2 [00:20<00:00,  9.51s/it, CE=3.879225e-01 H=3.870586e-01 dV_dx=4.781003e-05 dV_dθ=-9.117429e-04 ||∇||=1.110462e+00 | Tr=0.6141 Te/Cur=0.6007 Te/Exp=0.8571]100%|██████████| 2/2 [00:20<00:00, 10.22s/it, CE=3.879225e-01 H=3.870586e-01 dV_dx=4.781003e-05 dV_dθ=-9.117429e-04 ||∇||=1.110462e+00 | Tr=0.6141 Te/Cur=0.6007 Te/Exp=0.8571]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<03:08,  9.94s/it]  5%|▌         | 1/20 [00:14<03:08,  9.94s/it, CE=3.883962e-01 H=3.877136e-01 dV_dx=-6.715909e-05 dV_dθ=-6.153930e-04 ||∇||=1.003124e+00 | Tr=0.6150] 10%|█         | 2/20 [00:14<02:00,  6.68s/it, CE=3.883962e-01 H=3.877136e-01 dV_dx=-6.715909e-05 dV_dθ=-6.153930e-04 ||∇||=1.003124e+00 | Tr=0.6150] 10%|█         | 2/20 [00:18<02:00,  6.68s/it, CE=3.847353e-01 H=3.841370e-01 dV_dx=3.560300e-05 dV_dθ=-6.339532e-04 ||∇||=1.010489e+00 | Tr=0.6153]  15%|█▌        | 3/20 [00:18<01:37,  5.71s/it, CE=3.847353e-01 H=3.841370e-01 dV_dx=3.560300e-05 dV_dθ=-6.339532e-04 ||∇||=1.010489e+00 | Tr=0.6153] 15%|█▌        | 3/20 [00:23<01:37,  5.71s/it, CE=3.814632e-01 H=3.808264e-01 dV_dx=2.433001e-05 dV_dθ=-6.611047e-04 ||∇||=1.017173e+00 | Tr=0.6157] 20%|██        | 4/20 [00:23<01:21,  5.10s/it, CE=3.814632e-01 H=3.808264e-01 dV_dx=2.433001e-05 dV_dθ=-6.611047e-04 ||∇||=1.017173e+00 | Tr=0.6157] 20%|██        | 4/20 [00:27<01:21,  5.10s/it, CE=3.784802e-01 H=3.778423e-01 dV_dx=7.983830e-06 dV_dθ=-6.459049e-04 ||∇||=1.013401e+00 | Tr=0.6159] 25%|██▌       | 5/20 [00:27<01:11,  4.79s/it, CE=3.784802e-01 H=3.778423e-01 dV_dx=7.983830e-06 dV_dθ=-6.459049e-04 ||∇||=1.013401e+00 | Tr=0.6159] 25%|██▌       | 5/20 [00:33<01:11,  4.79s/it, CE=3.757137e-01 H=3.751324e-01 dV_dx=4.238198e-05 dV_dθ=-6.237352e-04 ||∇||=1.008374e+00 | Tr=0.6160 Te/Cur=0.6126 Te/Exp=0.8596] 30%|███       | 6/20 [00:33<01:13,  5.25s/it, CE=3.757137e-01 H=3.751324e-01 dV_dx=4.238198e-05 dV_dθ=-6.237352e-04 ||∇||=1.008374e+00 | Tr=0.6160 Te/Cur=0.6126 Te/Exp=0.8596] 30%|███       | 6/20 [00:37<01:13,  5.25s/it, CE=3.731125e-01 H=3.724659e-01 dV_dx=-1.209223e-05 dV_dθ=-6.345506e-04 ||∇||=1.012693e+00 | Tr=0.6157]                            35%|███▌      | 7/20 [00:37<01:03,  4.85s/it, CE=3.731125e-01 H=3.724659e-01 dV_dx=-1.209223e-05 dV_dθ=-6.345506e-04 ||∇||=1.012693e+00 | Tr=0.6157] 35%|███▌      | 7/20 [00:41<01:03,  4.85s/it, CE=3.705631e-01 H=3.700490e-01 dV_dx=1.088080e-04 dV_dθ=-6.229207e-04 ||∇||=1.009677e+00 | Tr=0.6163]  40%|████      | 8/20 [00:41<00:56,  4.71s/it, CE=3.705631e-01 H=3.700490e-01 dV_dx=1.088080e-04 dV_dθ=-6.229207e-04 ||∇||=1.009677e+00 | Tr=0.6163] 40%|████      | 8/20 [00:46<00:56,  4.71s/it, CE=3.682735e-01 H=3.676462e-01 dV_dx=9.226773e-06 dV_dθ=-6.364408e-04 ||∇||=1.013762e+00 | Tr=0.6162] 45%|████▌     | 9/20 [00:46<00:50,  4.57s/it, CE=3.682735e-01 H=3.676462e-01 dV_dx=9.226773e-06 dV_dθ=-6.364408e-04 ||∇||=1.013762e+00 | Tr=0.6162] 45%|████▌     | 9/20 [00:50<00:50,  4.57s/it, CE=3.659944e-01 H=3.653898e-01 dV_dx=3.782328e-05 dV_dθ=-6.424553e-04 ||∇||=1.013927e+00 | Tr=0.6167] 50%|█████     | 10/20 [00:50<00:44,  4.47s/it, CE=3.659944e-01 H=3.653898e-01 dV_dx=3.782328e-05 dV_dθ=-6.424553e-04 ||∇||=1.013927e+00 | Tr=0.6167] 50%|█████     | 10/20 [00:56<00:44,  4.47s/it, CE=3.637865e-01 H=3.631138e-01 dV_dx=-2.061545e-05 dV_dθ=-6.520158e-04 ||∇||=1.015542e+00 | Tr=0.6173 Te/Cur=0.6144 Te/Exp=0.8625] 55%|█████▌    | 11/20 [00:56<00:45,  5.11s/it, CE=3.637865e-01 H=3.631138e-01 dV_dx=-2.061545e-05 dV_dθ=-6.520158e-04 ||∇||=1.015542e+00 | Tr=0.6173 Te/Cur=0.6144 Te/Exp=0.8625] 55%|█████▌    | 11/20 [01:01<00:45,  5.11s/it, CE=3.616470e-01 H=3.609444e-01 dV_dx=-5.501395e-05 dV_dθ=-6.476012e-04 ||∇||=1.014325e+00 | Tr=0.6173]                             60%|██████    | 12/20 [01:01<00:39,  4.93s/it, CE=3.616470e-01 H=3.609444e-01 dV_dx=-5.501395e-05 dV_dθ=-6.476012e-04 ||∇||=1.014325e+00 | Tr=0.6173] 60%|██████    | 12/20 [01:05<00:39,  4.93s/it, CE=3.595588e-01 H=3.589385e-01 dV_dx=2.017373e-05 dV_dθ=-6.404647e-04 ||∇||=1.012355e+00 | Tr=0.6179]  65%|██████▌   | 13/20 [01:05<00:33,  4.80s/it, CE=3.595588e-01 H=3.589385e-01 dV_dx=2.017373e-05 dV_dθ=-6.404647e-04 ||∇||=1.012355e+00 | Tr=0.6179] 65%|██████▌   | 13/20 [01:10<00:33,  4.80s/it, CE=3.575936e-01 H=3.569691e-01 dV_dx=1.785514e-05 dV_dθ=-6.424102e-04 ||∇||=1.012651e+00 | Tr=0.6181] 70%|███████   | 14/20 [01:10<00:27,  4.63s/it, CE=3.575936e-01 H=3.569691e-01 dV_dx=1.785514e-05 dV_dθ=-6.424102e-04 ||∇||=1.012651e+00 | Tr=0.6181] 70%|███████   | 14/20 [01:14<00:27,  4.63s/it, CE=3.556620e-01 H=3.549474e-01 dV_dx=-6.355443e-05 dV_dθ=-6.510805e-04 ||∇||=1.015527e+00 | Tr=0.6184] 75%|███████▌  | 15/20 [01:14<00:22,  4.59s/it, CE=3.556620e-01 H=3.549474e-01 dV_dx=-6.355443e-05 dV_dθ=-6.510805e-04 ||∇||=1.015527e+00 | Tr=0.6184] 75%|███████▌  | 15/20 [01:20<00:22,  4.59s/it, CE=3.537859e-01 H=3.531321e-01 dV_dx=3.981747e-06 dV_dθ=-6.578589e-04 ||∇||=1.018186e+00 | Tr=0.6186 Te/Cur=0.6110 Te/Exp=0.8664] 80%|████████  | 16/20 [01:20<00:20,  5.08s/it, CE=3.537859e-01 H=3.531321e-01 dV_dx=3.981747e-06 dV_dθ=-6.578589e-04 ||∇||=1.018186e+00 | Tr=0.6186 Te/Cur=0.6110 Te/Exp=0.8664] 80%|████████  | 16/20 [01:24<00:20,  5.08s/it, CE=3.519549e-01 H=3.513706e-01 dV_dx=5.825810e-05 dV_dθ=-6.425667e-04 ||∇||=1.014415e+00 | Tr=0.6191]                             85%|████████▌ | 17/20 [01:24<00:14,  4.77s/it, CE=3.519549e-01 H=3.513706e-01 dV_dx=5.825810e-05 dV_dθ=-6.425667e-04 ||∇||=1.014415e+00 | Tr=0.6191] 85%|████████▌ | 17/20 [01:29<00:14,  4.77s/it, CE=3.501570e-01 H=3.494871e-01 dV_dx=-2.741206e-05 dV_dθ=-6.425487e-04 ||∇||=1.015487e+00 | Tr=0.6194] 90%|█████████ | 18/20 [01:29<00:09,  4.61s/it, CE=3.501570e-01 H=3.494871e-01 dV_dx=-2.741206e-05 dV_dθ=-6.425487e-04 ||∇||=1.015487e+00 | Tr=0.6194] 90%|█████████ | 18/20 [01:33<00:09,  4.61s/it, CE=3.484443e-01 H=3.478226e-01 dV_dx=1.836602e-05 dV_dθ=-6.401021e-04 ||∇||=1.013440e+00 | Tr=0.6196]  95%|█████████▌| 19/20 [01:33<00:04,  4.38s/it, CE=3.484443e-01 H=3.478226e-01 dV_dx=1.836602e-05 dV_dθ=-6.401021e-04 ||∇||=1.013440e+00 | Tr=0.6196] 95%|█████████▌| 19/20 [01:38<00:04,  4.38s/it, CE=3.467612e-01 H=3.461005e-01 dV_dx=-3.182806e-06 dV_dθ=-6.575344e-04 ||∇||=1.017873e+00 | Tr=0.6196 Te/Cur=0.6133 Te/Exp=0.8602]100%|██████████| 20/20 [01:38<00:00,  4.84s/it, CE=3.467612e-01 H=3.461005e-01 dV_dx=-3.182806e-06 dV_dθ=-6.575344e-04 ||∇||=1.017873e+00 | Tr=0.6196 Te/Cur=0.6133 Te/Exp=0.8602]100%|██████████| 20/20 [01:38<00:00,  4.95s/it, CE=3.467612e-01 H=3.461005e-01 dV_dx=-3.182806e-06 dV_dθ=-6.575344e-04 ||∇||=1.017873e+00 | Tr=0.6196 Te/Cur=0.6133 Te/Exp=0.8602]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 3 final loss: 0.350274
======================================================================


  Evaluating on all tasks 0..3 for CL metrics...
    Task 0: 0.7808
    Task 1: 0.9562
    Task 2: 0.8549
    Task 3: 0.6121

============================================================
Task 4
============================================================
Initial loss on new task: 1.3680, previous: 0.3468, ratio: 3.94
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 4
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:14<?, ?it/s, CE=5.821187e-01 H=5.810109e-01 dV_dx=-5.579322e-06 dV_dθ=-1.102269e-03 ||∇||=1.615299e+00 | Tr=0.8426 Te/Cur=0.8798 Te/Exp=0.7918]100%|██████████| 1/1 [00:14<00:00, 14.89s/it, CE=5.821187e-01 H=5.810109e-01 dV_dx=-5.579322e-06 dV_dθ=-1.102269e-03 ||∇||=1.615299e+00 | Tr=0.8426 Te/Cur=0.8798 Te/Exp=0.7918]100%|██████████| 1/1 [00:14<00:00, 14.89s/it, CE=5.821187e-01 H=5.810109e-01 dV_dx=-5.579322e-06 dV_dθ=-1.102269e-03 ||∇||=1.615299e+00 | Tr=0.8426 Te/Cur=0.8798 Te/Exp=0.7918]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.582119

[STEP 2] Architecture change decision
  Current: 0.582119, Previous: 0.346761
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9416 samples from 10 classes
  Created balanced validation set: 38293 samples from 10 classes
  Starting grid architecture search for task 4
  Baseline architecture: (2, [507, 552, 104, 10])
  Baseline loss: 0.582119
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.66s/it] 50%|█████     | 1/2 [00:07<00:04,  4.66s/it, CE=2.336554e+00 H=2.336424e+00 dV_dx=2.175057e-06 dV_dθ=-1.319106e-04 ||∇||=3.044561e-01 | Tr=0.1624 Te/Cur=0.1769 Te/Exp=0.1343]100%|██████████| 2/2 [00:07<00:00,  3.43s/it, CE=2.336554e+00 H=2.336424e+00 dV_dx=2.175057e-06 dV_dθ=-1.319106e-04 ||∇||=3.044561e-01 | Tr=0.1624 Te/Cur=0.1769 Te/Exp=0.1343]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.336554e+00 H=2.336424e+00 dV_dx=2.175057e-06 dV_dθ=-1.319106e-04 ||∇||=3.044561e-01 | Tr=0.1624 Te/Cur=0.1769 Te/Exp=0.1343]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.3365542134809454
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.21s/it] 50%|█████     | 1/2 [00:18<00:14, 14.21s/it, CE=2.333942e+00 H=2.333810e+00 dV_dx=-3.933080e-09 dV_dθ=-1.310592e-04 ||∇||=2.971489e-01 | Tr=0.1521 Te/Cur=0.1770 Te/Exp=0.1283]100%|██████████| 2/2 [00:18<00:00,  8.54s/it, CE=2.333942e+00 H=2.333810e+00 dV_dx=-3.933080e-09 dV_dθ=-1.310592e-04 ||∇||=2.971489e-01 | Tr=0.1521 Te/Cur=0.1770 Te/Exp=0.1283]100%|██████████| 2/2 [00:18<00:00,  9.39s/it, CE=2.333942e+00 H=2.333810e+00 dV_dx=-3.933080e-09 dV_dθ=-1.310592e-04 ||∇||=2.971489e-01 | Tr=0.1521 Te/Cur=0.1770 Te/Exp=0.1283]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 552, 84, 10]) with loss 2.333942
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.18s/it] 50%|█████     | 1/2 [00:08<00:05,  5.18s/it, CE=2.331246e+00 H=2.331131e+00 dV_dx=1.046187e-07 dV_dθ=-1.143606e-04 ||∇||=2.892406e-01 | Tr=0.1489 Te/Cur=0.1748 Te/Exp=0.1229]100%|██████████| 2/2 [00:08<00:00,  3.84s/it, CE=2.331246e+00 H=2.331131e+00 dV_dx=1.046187e-07 dV_dθ=-1.143606e-04 ||∇||=2.892406e-01 | Tr=0.1489 Te/Cur=0.1748 Te/Exp=0.1229]100%|██████████| 2/2 [00:08<00:00,  4.04s/it, CE=2.331246e+00 H=2.331131e+00 dV_dx=1.046187e-07 dV_dθ=-1.143606e-04 ||∇||=2.892406e-01 | Tr=0.1489 Te/Cur=0.1748 Te/Exp=0.1229]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 84, 10]) with loss 2.331246
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.34s/it] 50%|█████     | 1/2 [00:16<00:13, 13.34s/it, CE=2.341448e+00 H=2.341300e+00 dV_dx=5.302785e-06 dV_dθ=-1.532890e-04 ||∇||=3.046195e-01 | Tr=0.1455 Te/Cur=0.1593 Te/Exp=0.1694]100%|██████████| 2/2 [00:16<00:00,  7.29s/it, CE=2.341448e+00 H=2.341300e+00 dV_dx=5.302785e-06 dV_dθ=-1.532890e-04 ||∇||=3.046195e-01 | Tr=0.1455 Te/Cur=0.1593 Te/Exp=0.1694]100%|██████████| 2/2 [00:16<00:00,  8.19s/it, CE=2.341448e+00 H=2.341300e+00 dV_dx=5.302785e-06 dV_dθ=-1.532890e-04 ||∇||=3.046195e-01 | Tr=0.1455 Te/Cur=0.1593 Te/Exp=0.1694]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.18s/it] 50%|█████     | 1/2 [00:08<00:05,  5.18s/it, CE=2.340714e+00 H=2.340565e+00 dV_dx=-1.963006e-06 dV_dθ=-1.468855e-04 ||∇||=3.245465e-01 | Tr=0.1435 Te/Cur=0.1714 Te/Exp=0.1428]100%|██████████| 2/2 [00:08<00:00,  3.99s/it, CE=2.340714e+00 H=2.340565e+00 dV_dx=-1.963006e-06 dV_dθ=-1.468855e-04 ||∇||=3.245465e-01 | Tr=0.1435 Te/Cur=0.1714 Te/Exp=0.1428]100%|██████████| 2/2 [00:08<00:00,  4.17s/it, CE=2.340714e+00 H=2.340565e+00 dV_dx=-1.963006e-06 dV_dθ=-1.468855e-04 ||∇||=3.245465e-01 | Tr=0.1435 Te/Cur=0.1714 Te/Exp=0.1428]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.26s/it] 50%|█████     | 1/2 [00:06<00:04,  4.26s/it, CE=2.323006e+00 H=2.322853e+00 dV_dx=4.280305e-06 dV_dθ=-1.578032e-04 ||∇||=2.956332e-01 | Tr=0.1578 Te/Cur=0.1562 Te/Exp=0.1326]100%|██████████| 2/2 [00:06<00:00,  3.20s/it, CE=2.323006e+00 H=2.322853e+00 dV_dx=4.280305e-06 dV_dθ=-1.578032e-04 ||∇||=2.956332e-01 | Tr=0.1578 Te/Cur=0.1562 Te/Exp=0.1326]100%|██████████| 2/2 [00:06<00:00,  3.36s/it, CE=2.323006e+00 H=2.322853e+00 dV_dx=4.280305e-06 dV_dθ=-1.578032e-04 ||∇||=2.956332e-01 | Tr=0.1578 Te/Cur=0.1562 Te/Exp=0.1326]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 572, 104, 10]) with loss 2.323006
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.50s/it] 50%|█████     | 1/2 [00:09<00:06,  6.50s/it, CE=2.333944e+00 H=2.333763e+00 dV_dx=2.560312e-06 dV_dθ=-1.837583e-04 ||∇||=3.325934e-01 | Tr=0.1773 Te/Cur=0.1847 Te/Exp=0.1523]100%|██████████| 2/2 [00:09<00:00,  4.39s/it, CE=2.333944e+00 H=2.333763e+00 dV_dx=2.560312e-06 dV_dθ=-1.837583e-04 ||∇||=3.325934e-01 | Tr=0.1773 Te/Cur=0.1847 Te/Exp=0.1523]100%|██████████| 2/2 [00:09<00:00,  4.70s/it, CE=2.333944e+00 H=2.333763e+00 dV_dx=2.560312e-06 dV_dθ=-1.837583e-04 ||∇||=3.325934e-01 | Tr=0.1773 Te/Cur=0.1847 Te/Exp=0.1523]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.73s/it] 50%|█████     | 1/2 [00:07<00:04,  4.73s/it, CE=2.330555e+00 H=2.330434e+00 dV_dx=1.348614e-06 dV_dθ=-1.224864e-04 ||∇||=2.944717e-01 | Tr=0.2056 Te/Cur=0.2044 Te/Exp=0.1468]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.330555e+00 H=2.330434e+00 dV_dx=1.348614e-06 dV_dθ=-1.224864e-04 ||∇||=2.944717e-01 | Tr=0.2056 Te/Cur=0.2044 Te/Exp=0.1468]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.330555e+00 H=2.330434e+00 dV_dx=1.348614e-06 dV_dθ=-1.224864e-04 ||∇||=2.944717e-01 | Tr=0.2056 Te/Cur=0.2044 Te/Exp=0.1468]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.04s/it] 50%|█████     | 1/2 [00:07<00:05,  5.04s/it, CE=2.336547e+00 H=2.336417e+00 dV_dx=-1.937461e-06 dV_dθ=-1.284437e-04 ||∇||=2.842728e-01 | Tr=0.1998 Te/Cur=0.1931 Te/Exp=0.1530]100%|██████████| 2/2 [00:07<00:00,  3.67s/it, CE=2.336547e+00 H=2.336417e+00 dV_dx=-1.937461e-06 dV_dθ=-1.284437e-04 ||∇||=2.842728e-01 | Tr=0.1998 Te/Cur=0.1931 Te/Exp=0.1530]100%|██████████| 2/2 [00:07<00:00,  3.88s/it, CE=2.336547e+00 H=2.336417e+00 dV_dx=-1.937461e-06 dV_dθ=-1.284437e-04 ||∇||=2.842728e-01 | Tr=0.1998 Te/Cur=0.1931 Te/Exp=0.1530]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.49s/it] 50%|█████     | 1/2 [00:07<00:04,  4.49s/it, CE=2.314524e+00 H=2.314335e+00 dV_dx=1.243112e-06 dV_dθ=-1.901677e-04 ||∇||=3.363607e-01 | Tr=0.1569 Te/Cur=0.1812 Te/Exp=0.1511]100%|██████████| 2/2 [00:07<00:00,  3.35s/it, CE=2.314524e+00 H=2.314335e+00 dV_dx=1.243112e-06 dV_dθ=-1.901677e-04 ||∇||=3.363607e-01 | Tr=0.1569 Te/Cur=0.1812 Te/Exp=0.1511]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.314524e+00 H=2.314335e+00 dV_dx=1.243112e-06 dV_dθ=-1.901677e-04 ||∇||=3.363607e-01 | Tr=0.1569 Te/Cur=0.1812 Te/Exp=0.1511]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 532, 84, 10]) with loss 2.314524
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.47s/it] 50%|█████     | 1/2 [00:16<00:13, 13.47s/it, CE=2.318489e+00 H=2.318309e+00 dV_dx=-4.217610e-06 dV_dθ=-1.749670e-04 ||∇||=3.360823e-01 | Tr=0.1485 Te/Cur=0.1656 Te/Exp=0.1310]100%|██████████| 2/2 [00:16<00:00,  7.27s/it, CE=2.318489e+00 H=2.318309e+00 dV_dx=-4.217610e-06 dV_dθ=-1.749670e-04 ||∇||=3.360823e-01 | Tr=0.1485 Te/Cur=0.1656 Te/Exp=0.1310]100%|██████████| 2/2 [00:16<00:00,  8.20s/it, CE=2.318489e+00 H=2.318309e+00 dV_dx=-4.217610e-06 dV_dθ=-1.749670e-04 ||∇||=3.360823e-01 | Tr=0.1485 Te/Cur=0.1656 Te/Exp=0.1310]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.96s/it] 50%|█████     | 1/2 [00:09<00:06,  6.96s/it, CE=2.318530e+00 H=2.318361e+00 dV_dx=-3.868054e-06 dV_dθ=-1.648107e-04 ||∇||=3.481550e-01 | Tr=0.1745 Te/Cur=0.1960 Te/Exp=0.1566]100%|██████████| 2/2 [00:09<00:00,  4.46s/it, CE=2.318530e+00 H=2.318361e+00 dV_dx=-3.868054e-06 dV_dθ=-1.648107e-04 ||∇||=3.481550e-01 | Tr=0.1745 Te/Cur=0.1960 Te/Exp=0.1566]100%|██████████| 2/2 [00:09<00:00,  4.83s/it, CE=2.318530e+00 H=2.318361e+00 dV_dx=-3.868054e-06 dV_dθ=-1.648107e-04 ||∇||=3.481550e-01 | Tr=0.1745 Te/Cur=0.1960 Te/Exp=0.1566]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.39s/it] 50%|█████     | 1/2 [00:16<00:13, 13.39s/it, CE=2.324768e+00 H=2.324534e+00 dV_dx=9.676673e-07 dV_dθ=-2.347576e-04 ||∇||=3.781537e-01 | Tr=0.1678 Te/Cur=0.1820 Te/Exp=0.1591]100%|██████████| 2/2 [00:16<00:00,  7.27s/it, CE=2.324768e+00 H=2.324534e+00 dV_dx=9.676673e-07 dV_dθ=-2.347576e-04 ||∇||=3.781537e-01 | Tr=0.1678 Te/Cur=0.1820 Te/Exp=0.1591]100%|██████████| 2/2 [00:16<00:00,  8.19s/it, CE=2.324768e+00 H=2.324534e+00 dV_dx=9.676673e-07 dV_dθ=-2.347576e-04 ||∇||=3.781537e-01 | Tr=0.1678 Te/Cur=0.1820 Te/Exp=0.1591]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.80s/it] 50%|█████     | 1/2 [00:07<00:04,  4.80s/it, CE=2.317597e+00 H=2.317375e+00 dV_dx=6.860674e-07 dV_dθ=-2.222505e-04 ||∇||=3.682858e-01 | Tr=0.1827 Te/Cur=0.1836 Te/Exp=0.1493]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.317597e+00 H=2.317375e+00 dV_dx=6.860674e-07 dV_dθ=-2.222505e-04 ||∇||=3.682858e-01 | Tr=0.1827 Te/Cur=0.1836 Te/Exp=0.1493]100%|██████████| 2/2 [00:07<00:00,  3.75s/it, CE=2.317597e+00 H=2.317375e+00 dV_dx=6.860674e-07 dV_dθ=-2.222505e-04 ||∇||=3.682858e-01 | Tr=0.1827 Te/Cur=0.1836 Te/Exp=0.1493]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.67s/it] 50%|█████     | 1/2 [00:07<00:04,  4.67s/it, CE=2.310534e+00 H=2.310315e+00 dV_dx=-9.668462e-07 dV_dθ=-2.183702e-04 ||∇||=3.657123e-01 | Tr=0.1999 Te/Cur=0.2180 Te/Exp=0.1733]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.310534e+00 H=2.310315e+00 dV_dx=-9.668462e-07 dV_dθ=-2.183702e-04 ||∇||=3.657123e-01 | Tr=0.1999 Te/Cur=0.2180 Te/Exp=0.1733]100%|██████████| 2/2 [00:07<00:00,  3.83s/it, CE=2.310534e+00 H=2.310315e+00 dV_dx=-9.668462e-07 dV_dθ=-2.183702e-04 ||∇||=3.657123e-01 | Tr=0.1999 Te/Cur=0.2180 Te/Exp=0.1733]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 104, 10]) with loss 2.310534
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.81s/it] 50%|█████     | 1/2 [00:09<00:04,  4.81s/it, CE=2.312874e+00 H=2.312650e+00 dV_dx=3.291221e-06 dV_dθ=-2.272424e-04 ||∇||=3.722788e-01 | Tr=0.2052 Te/Cur=0.2320 Te/Exp=0.1721]100%|██████████| 2/2 [00:09<00:00,  4.49s/it, CE=2.312874e+00 H=2.312650e+00 dV_dx=3.291221e-06 dV_dθ=-2.272424e-04 ||∇||=3.722788e-01 | Tr=0.2052 Te/Cur=0.2320 Te/Exp=0.1721]100%|██████████| 2/2 [00:09<00:00,  4.54s/it, CE=2.312874e+00 H=2.312650e+00 dV_dx=3.291221e-06 dV_dθ=-2.272424e-04 ||∇||=3.722788e-01 | Tr=0.2052 Te/Cur=0.2320 Te/Exp=0.1721]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.65s/it] 50%|█████     | 1/2 [00:07<00:04,  4.65s/it, CE=2.312978e+00 H=2.312836e+00 dV_dx=5.103844e-07 dV_dθ=-1.428558e-04 ||∇||=3.398165e-01 | Tr=0.1740 Te/Cur=0.1771 Te/Exp=0.1678]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.312978e+00 H=2.312836e+00 dV_dx=5.103844e-07 dV_dθ=-1.428558e-04 ||∇||=3.398165e-01 | Tr=0.1740 Te/Cur=0.1771 Te/Exp=0.1678]100%|██████████| 2/2 [00:07<00:00,  3.85s/it, CE=2.312978e+00 H=2.312836e+00 dV_dx=5.103844e-07 dV_dθ=-1.428558e-04 ||∇||=3.398165e-01 | Tr=0.1740 Te/Cur=0.1771 Te/Exp=0.1678]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.92s/it] 50%|█████     | 1/2 [00:07<00:04,  4.92s/it, CE=2.306847e+00 H=2.306615e+00 dV_dx=-1.883151e-08 dV_dθ=-2.319574e-04 ||∇||=3.713298e-01 | Tr=0.1948 Te/Cur=0.2073 Te/Exp=0.1911]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.306847e+00 H=2.306615e+00 dV_dx=-1.883151e-08 dV_dθ=-2.319574e-04 ||∇||=3.713298e-01 | Tr=0.1948 Te/Cur=0.2073 Te/Exp=0.1911]100%|██████████| 2/2 [00:07<00:00,  3.85s/it, CE=2.306847e+00 H=2.306615e+00 dV_dx=-1.883151e-08 dV_dθ=-2.319574e-04 ||∇||=3.713298e-01 | Tr=0.1948 Te/Cur=0.2073 Te/Exp=0.1911]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 124, 10]) with loss 2.306847
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.64s/it] 50%|█████     | 1/2 [00:07<00:04,  4.64s/it, CE=2.319076e+00 H=2.318862e+00 dV_dx=7.231312e-06 dV_dθ=-2.212385e-04 ||∇||=3.546667e-01 | Tr=0.1448 Te/Cur=0.1706 Te/Exp=0.1354]100%|██████████| 2/2 [00:07<00:00,  3.65s/it, CE=2.319076e+00 H=2.318862e+00 dV_dx=7.231312e-06 dV_dθ=-2.212385e-04 ||∇||=3.546667e-01 | Tr=0.1448 Te/Cur=0.1706 Te/Exp=0.1354]100%|██████████| 2/2 [00:07<00:00,  3.80s/it, CE=2.319076e+00 H=2.318862e+00 dV_dx=7.231312e-06 dV_dθ=-2.212385e-04 ||∇||=3.546667e-01 | Tr=0.1448 Te/Cur=0.1706 Te/Exp=0.1354]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.54s/it] 50%|█████     | 1/2 [00:16<00:13, 13.54s/it, CE=2.314240e+00 H=2.314041e+00 dV_dx=4.654575e-06 dV_dθ=-2.036877e-04 ||∇||=3.527859e-01 | Tr=0.1608 Te/Cur=0.1655 Te/Exp=0.1272]100%|██████████| 2/2 [00:16<00:00,  7.23s/it, CE=2.314240e+00 H=2.314041e+00 dV_dx=4.654575e-06 dV_dθ=-2.036877e-04 ||∇||=3.527859e-01 | Tr=0.1608 Te/Cur=0.1655 Te/Exp=0.1272]100%|██████████| 2/2 [00:16<00:00,  8.17s/it, CE=2.314240e+00 H=2.314041e+00 dV_dx=4.654575e-06 dV_dθ=-2.036877e-04 ||∇||=3.527859e-01 | Tr=0.1608 Te/Cur=0.1655 Te/Exp=0.1272]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.81s/it] 50%|█████     | 1/2 [00:09<00:06,  6.81s/it, CE=2.320974e+00 H=2.320793e+00 dV_dx=1.635238e-06 dV_dθ=-1.822331e-04 ||∇||=3.246180e-01 | Tr=0.1538 Te/Cur=0.1662 Te/Exp=0.1324]100%|██████████| 2/2 [00:09<00:00,  4.41s/it, CE=2.320974e+00 H=2.320793e+00 dV_dx=1.635238e-06 dV_dθ=-1.822331e-04 ||∇||=3.246180e-01 | Tr=0.1538 Te/Cur=0.1662 Te/Exp=0.1324]100%|██████████| 2/2 [00:09<00:00,  4.77s/it, CE=2.320974e+00 H=2.320793e+00 dV_dx=1.635238e-06 dV_dθ=-1.822331e-04 ||∇||=3.246180e-01 | Tr=0.1538 Te/Cur=0.1662 Te/Exp=0.1324]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.90s/it] 50%|█████     | 1/2 [00:16<00:12, 12.90s/it, CE=2.315679e+00 H=2.315413e+00 dV_dx=1.053237e-05 dV_dθ=-2.769654e-04 ||∇||=3.981052e-01 | Tr=0.1488 Te/Cur=0.1491 Te/Exp=0.1406]100%|██████████| 2/2 [00:16<00:00,  7.17s/it, CE=2.315679e+00 H=2.315413e+00 dV_dx=1.053237e-05 dV_dθ=-2.769654e-04 ||∇||=3.981052e-01 | Tr=0.1488 Te/Cur=0.1491 Te/Exp=0.1406]100%|██████████| 2/2 [00:16<00:00,  8.03s/it, CE=2.315679e+00 H=2.315413e+00 dV_dx=1.053237e-05 dV_dθ=-2.769654e-04 ||∇||=3.981052e-01 | Tr=0.1488 Te/Cur=0.1491 Te/Exp=0.1406]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.62s/it] 50%|█████     | 1/2 [00:07<00:04,  4.62s/it, CE=2.317504e+00 H=2.317222e+00 dV_dx=7.239832e-06 dV_dθ=-2.886357e-04 ||∇||=3.866176e-01 | Tr=0.1856 Te/Cur=0.1882 Te/Exp=0.1545]100%|██████████| 2/2 [00:07<00:00,  3.61s/it, CE=2.317504e+00 H=2.317222e+00 dV_dx=7.239832e-06 dV_dθ=-2.886357e-04 ||∇||=3.866176e-01 | Tr=0.1856 Te/Cur=0.1882 Te/Exp=0.1545]100%|██████████| 2/2 [00:07<00:00,  3.76s/it, CE=2.317504e+00 H=2.317222e+00 dV_dx=7.239832e-06 dV_dθ=-2.886357e-04 ||∇||=3.866176e-01 | Tr=0.1856 Te/Cur=0.1882 Te/Exp=0.1545]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.85s/it] 50%|█████     | 1/2 [00:07<00:04,  4.85s/it, CE=2.308750e+00 H=2.308564e+00 dV_dx=3.746893e-06 dV_dθ=-1.891599e-04 ||∇||=3.265043e-01 | Tr=0.1771 Te/Cur=0.1718 Te/Exp=0.1326]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.308750e+00 H=2.308564e+00 dV_dx=3.746893e-06 dV_dθ=-1.891599e-04 ||∇||=3.265043e-01 | Tr=0.1771 Te/Cur=0.1718 Te/Exp=0.1326]100%|██████████| 2/2 [00:07<00:00,  3.81s/it, CE=2.308750e+00 H=2.308564e+00 dV_dx=3.746893e-06 dV_dθ=-1.891599e-04 ||∇||=3.265043e-01 | Tr=0.1771 Te/Cur=0.1718 Te/Exp=0.1326]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.56s/it] 50%|█████     | 1/2 [00:07<00:04,  4.56s/it, CE=2.317688e+00 H=2.317456e+00 dV_dx=-1.542222e-06 dV_dθ=-2.307255e-04 ||∇||=3.815802e-01 | Tr=0.2254 Te/Cur=0.2302 Te/Exp=0.1680]100%|██████████| 2/2 [00:07<00:00,  3.65s/it, CE=2.317688e+00 H=2.317456e+00 dV_dx=-1.542222e-06 dV_dθ=-2.307255e-04 ||∇||=3.815802e-01 | Tr=0.2254 Te/Cur=0.2302 Te/Exp=0.1680]100%|██████████| 2/2 [00:07<00:00,  3.78s/it, CE=2.317688e+00 H=2.317456e+00 dV_dx=-1.542222e-06 dV_dθ=-2.307255e-04 ||∇||=3.815802e-01 | Tr=0.2254 Te/Cur=0.2302 Te/Exp=0.1680]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.06s/it] 50%|█████     | 1/2 [00:08<00:06,  6.06s/it, CE=2.314782e+00 H=2.314546e+00 dV_dx=1.265423e-05 dV_dθ=-2.487650e-04 ||∇||=3.687700e-01 | Tr=0.2122 Te/Cur=0.2112 Te/Exp=0.1316]100%|██████████| 2/2 [00:08<00:00,  4.21s/it, CE=2.314782e+00 H=2.314546e+00 dV_dx=1.265423e-05 dV_dθ=-2.487650e-04 ||∇||=3.687700e-01 | Tr=0.2122 Te/Cur=0.2112 Te/Exp=0.1316]100%|██████████| 2/2 [00:08<00:00,  4.49s/it, CE=2.314782e+00 H=2.314546e+00 dV_dx=1.265423e-05 dV_dθ=-2.487650e-04 ||∇||=3.687700e-01 | Tr=0.2122 Te/Cur=0.2112 Te/Exp=0.1316]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.88s/it] 50%|█████     | 1/2 [00:07<00:04,  4.88s/it, CE=2.310991e+00 H=2.310771e+00 dV_dx=-3.693714e-06 dV_dθ=-2.166427e-04 ||∇||=3.587077e-01 | Tr=0.1962 Te/Cur=0.2111 Te/Exp=0.1986]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.310991e+00 H=2.310771e+00 dV_dx=-3.693714e-06 dV_dθ=-2.166427e-04 ||∇||=3.587077e-01 | Tr=0.1962 Te/Cur=0.2111 Te/Exp=0.1986]100%|██████████| 2/2 [00:07<00:00,  3.85s/it, CE=2.310991e+00 H=2.310771e+00 dV_dx=-3.693714e-06 dV_dθ=-2.166427e-04 ||∇||=3.587077e-01 | Tr=0.1962 Te/Cur=0.2111 Te/Exp=0.1986]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.85s/it] 50%|█████     | 1/2 [00:07<00:04,  4.85s/it, CE=2.276740e+00 H=2.276571e+00 dV_dx=-1.570829e-06 dV_dθ=-1.673290e-04 ||∇||=4.000692e-01 | Tr=0.1656 Te/Cur=0.2029 Te/Exp=0.1725]100%|██████████| 2/2 [00:07<00:00,  3.78s/it, CE=2.276740e+00 H=2.276571e+00 dV_dx=-1.570829e-06 dV_dθ=-1.673290e-04 ||∇||=4.000692e-01 | Tr=0.1656 Te/Cur=0.2029 Te/Exp=0.1725]100%|██████████| 2/2 [00:07<00:00,  3.94s/it, CE=2.276740e+00 H=2.276571e+00 dV_dx=-1.570829e-06 dV_dθ=-1.673290e-04 ||∇||=4.000692e-01 | Tr=0.1656 Te/Cur=0.2029 Te/Exp=0.1725]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.276740203813637
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.46s/it] 50%|█████     | 1/2 [00:07<00:05,  5.46s/it, CE=2.278486e+00 H=2.278350e+00 dV_dx=-7.801377e-07 dV_dθ=-1.355498e-04 ||∇||=4.171439e-01 | Tr=0.1937 Te/Cur=0.2515 Te/Exp=0.2047]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.278486e+00 H=2.278350e+00 dV_dx=-7.801377e-07 dV_dθ=-1.355498e-04 ||∇||=4.171439e-01 | Tr=0.1937 Te/Cur=0.2515 Te/Exp=0.2047]100%|██████████| 2/2 [00:07<00:00,  4.00s/it, CE=2.278486e+00 H=2.278350e+00 dV_dx=-7.801377e-07 dV_dθ=-1.355498e-04 ||∇||=4.171439e-01 | Tr=0.1937 Te/Cur=0.2515 Te/Exp=0.2047]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.69s/it] 50%|█████     | 1/2 [00:20<00:14, 14.69s/it, CE=2.266695e+00 H=2.266537e+00 dV_dx=7.846226e-06 dV_dθ=-1.659665e-04 ||∇||=3.850768e-01 | Tr=0.2506 Te/Cur=0.2965 Te/Exp=0.2450]100%|██████████| 2/2 [00:20<00:00,  9.39s/it, CE=2.266695e+00 H=2.266537e+00 dV_dx=7.846226e-06 dV_dθ=-1.659665e-04 ||∇||=3.850768e-01 | Tr=0.2506 Te/Cur=0.2965 Te/Exp=0.2450]100%|██████████| 2/2 [00:20<00:00, 10.19s/it, CE=2.266695e+00 H=2.266537e+00 dV_dx=7.846226e-06 dV_dθ=-1.659665e-04 ||∇||=3.850768e-01 | Tr=0.2506 Te/Cur=0.2965 Te/Exp=0.2450]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 84, 10]) with loss 2.266695
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.79s/it] 50%|█████     | 1/2 [00:07<00:04,  4.79s/it, CE=2.261301e+00 H=2.261134e+00 dV_dx=4.686618e-06 dV_dθ=-1.718018e-04 ||∇||=4.095325e-01 | Tr=0.1941 Te/Cur=0.2665 Te/Exp=0.2579]100%|██████████| 2/2 [00:07<00:00,  3.80s/it, CE=2.261301e+00 H=2.261134e+00 dV_dx=4.686618e-06 dV_dθ=-1.718018e-04 ||∇||=4.095325e-01 | Tr=0.1941 Te/Cur=0.2665 Te/Exp=0.2579]100%|██████████| 2/2 [00:07<00:00,  3.95s/it, CE=2.261301e+00 H=2.261134e+00 dV_dx=4.686618e-06 dV_dθ=-1.718018e-04 ||∇||=4.095325e-01 | Tr=0.1941 Te/Cur=0.2665 Te/Exp=0.2579]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 532, 124, 10]) with loss 2.261301
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.91s/it] 50%|█████     | 1/2 [00:07<00:04,  4.91s/it, CE=2.272156e+00 H=2.272012e+00 dV_dx=-4.043051e-06 dV_dθ=-1.402951e-04 ||∇||=3.663124e-01 | Tr=0.2176 Te/Cur=0.2958 Te/Exp=0.2145]100%|██████████| 2/2 [00:07<00:00,  3.44s/it, CE=2.272156e+00 H=2.272012e+00 dV_dx=-4.043051e-06 dV_dθ=-1.402951e-04 ||∇||=3.663124e-01 | Tr=0.2176 Te/Cur=0.2958 Te/Exp=0.2145]100%|██████████| 2/2 [00:07<00:00,  3.66s/it, CE=2.272156e+00 H=2.272012e+00 dV_dx=-4.043051e-06 dV_dθ=-1.402951e-04 ||∇||=3.663124e-01 | Tr=0.2176 Te/Cur=0.2958 Te/Exp=0.2145]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.11s/it] 50%|█████     | 1/2 [00:16<00:14, 14.11s/it, CE=2.262349e+00 H=2.262179e+00 dV_dx=8.202283e-06 dV_dθ=-1.774119e-04 ||∇||=3.833969e-01 | Tr=0.1539 Te/Cur=0.2109 Te/Exp=0.2439]100%|██████████| 2/2 [00:16<00:00,  7.50s/it, CE=2.262349e+00 H=2.262179e+00 dV_dx=8.202283e-06 dV_dθ=-1.774119e-04 ||∇||=3.833969e-01 | Tr=0.1539 Te/Cur=0.2109 Te/Exp=0.2439]100%|██████████| 2/2 [00:16<00:00,  8.49s/it, CE=2.262349e+00 H=2.262179e+00 dV_dx=8.202283e-06 dV_dθ=-1.774119e-04 ||∇||=3.833969e-01 | Tr=0.1539 Te/Cur=0.2109 Te/Exp=0.2439]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.68s/it] 50%|█████     | 1/2 [00:16<00:13, 13.68s/it, CE=2.261818e+00 H=2.261677e+00 dV_dx=-2.835131e-06 dV_dθ=-1.383982e-04 ||∇||=3.797692e-01 | Tr=0.1874 Te/Cur=0.1802 Te/Exp=0.2108]100%|██████████| 2/2 [00:16<00:00,  7.54s/it, CE=2.261818e+00 H=2.261677e+00 dV_dx=-2.835131e-06 dV_dθ=-1.383982e-04 ||∇||=3.797692e-01 | Tr=0.1874 Te/Cur=0.1802 Te/Exp=0.2108]100%|██████████| 2/2 [00:16<00:00,  8.46s/it, CE=2.261818e+00 H=2.261677e+00 dV_dx=-2.835131e-06 dV_dθ=-1.383982e-04 ||∇||=3.797692e-01 | Tr=0.1874 Te/Cur=0.1802 Te/Exp=0.2108]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.19s/it] 50%|█████     | 1/2 [00:19<00:16, 16.19s/it, CE=2.275755e+00 H=2.275658e+00 dV_dx=1.149886e-05 dV_dθ=-1.088403e-04 ||∇||=3.650005e-01 | Tr=0.2130 Te/Cur=0.2799 Te/Exp=0.2472]100%|██████████| 2/2 [00:19<00:00,  8.57s/it, CE=2.275755e+00 H=2.275658e+00 dV_dx=1.149886e-05 dV_dθ=-1.088403e-04 ||∇||=3.650005e-01 | Tr=0.2130 Te/Cur=0.2799 Te/Exp=0.2472]100%|██████████| 2/2 [00:19<00:00,  9.71s/it, CE=2.275755e+00 H=2.275658e+00 dV_dx=1.149886e-05 dV_dθ=-1.088403e-04 ||∇||=3.650005e-01 | Tr=0.2130 Te/Cur=0.2799 Te/Exp=0.2472]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.41s/it] 50%|█████     | 1/2 [00:16<00:13, 13.41s/it, CE=2.259719e+00 H=2.259590e+00 dV_dx=7.214214e-06 dV_dθ=-1.358510e-04 ||∇||=4.020713e-01 | Tr=0.2482 Te/Cur=0.2996 Te/Exp=0.2850]100%|██████████| 2/2 [00:16<00:00,  7.22s/it, CE=2.259719e+00 H=2.259590e+00 dV_dx=7.214214e-06 dV_dθ=-1.358510e-04 ||∇||=4.020713e-01 | Tr=0.2482 Te/Cur=0.2996 Te/Exp=0.2850]100%|██████████| 2/2 [00:16<00:00,  8.15s/it, CE=2.259719e+00 H=2.259590e+00 dV_dx=7.214214e-06 dV_dθ=-1.358510e-04 ||∇||=4.020713e-01 | Tr=0.2482 Te/Cur=0.2996 Te/Exp=0.2850]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 164, 10]) with loss 2.259719
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.47s/it] 50%|█████     | 1/2 [00:06<00:04,  4.47s/it, CE=2.279091e+00 H=2.278910e+00 dV_dx=1.503339e-05 dV_dθ=-1.962632e-04 ||∇||=4.036294e-01 | Tr=0.2269 Te/Cur=0.2951 Te/Exp=0.1821]100%|██████████| 2/2 [00:06<00:00,  3.26s/it, CE=2.279091e+00 H=2.278910e+00 dV_dx=1.503339e-05 dV_dθ=-1.962632e-04 ||∇||=4.036294e-01 | Tr=0.2269 Te/Cur=0.2951 Te/Exp=0.1821]100%|██████████| 2/2 [00:06<00:00,  3.44s/it, CE=2.279091e+00 H=2.278910e+00 dV_dx=1.503339e-05 dV_dθ=-1.962632e-04 ||∇||=4.036294e-01 | Tr=0.2269 Te/Cur=0.2951 Te/Exp=0.1821]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.78s/it] 50%|█████     | 1/2 [00:07<00:04,  4.78s/it, CE=2.275119e+00 H=2.274924e+00 dV_dx=-6.091005e-06 dV_dθ=-1.884528e-04 ||∇||=4.138631e-01 | Tr=0.1784 Te/Cur=0.2738 Te/Exp=0.2021]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.275119e+00 H=2.274924e+00 dV_dx=-6.091005e-06 dV_dθ=-1.884528e-04 ||∇||=4.138631e-01 | Tr=0.1784 Te/Cur=0.2738 Te/Exp=0.2021]100%|██████████| 2/2 [00:07<00:00,  3.87s/it, CE=2.275119e+00 H=2.274924e+00 dV_dx=-6.091005e-06 dV_dθ=-1.884528e-04 ||∇||=4.138631e-01 | Tr=0.1784 Te/Cur=0.2738 Te/Exp=0.2021]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.84s/it] 50%|█████     | 1/2 [00:19<00:16, 16.84s/it, CE=2.255521e+00 H=2.255363e+00 dV_dx=1.803545e-05 dV_dθ=-1.763724e-04 ||∇||=4.289956e-01 | Tr=0.2634 Te/Cur=0.3375 Te/Exp=0.2489]100%|██████████| 2/2 [00:19<00:00,  8.78s/it, CE=2.255521e+00 H=2.255363e+00 dV_dx=1.803545e-05 dV_dθ=-1.763724e-04 ||∇||=4.289956e-01 | Tr=0.2634 Te/Cur=0.3375 Te/Exp=0.2489]100%|██████████| 2/2 [00:19<00:00,  9.99s/it, CE=2.255521e+00 H=2.255363e+00 dV_dx=1.803545e-05 dV_dθ=-1.763724e-04 ||∇||=4.289956e-01 | Tr=0.2634 Te/Cur=0.3375 Te/Exp=0.2489]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 612, 84, 10]) with loss 2.255521
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.17s/it] 50%|█████     | 1/2 [00:07<00:05,  5.17s/it, CE=2.257109e+00 H=2.256868e+00 dV_dx=1.898549e-07 dV_dθ=-2.410265e-04 ||∇||=4.376799e-01 | Tr=0.2892 Te/Cur=0.3592 Te/Exp=0.2138]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.257109e+00 H=2.256868e+00 dV_dx=1.898549e-07 dV_dθ=-2.410265e-04 ||∇||=4.376799e-01 | Tr=0.2892 Te/Cur=0.3592 Te/Exp=0.2138]100%|██████████| 2/2 [00:07<00:00,  3.96s/it, CE=2.257109e+00 H=2.256868e+00 dV_dx=1.898549e-07 dV_dθ=-2.410265e-04 ||∇||=4.376799e-01 | Tr=0.2892 Te/Cur=0.3592 Te/Exp=0.2138]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  5.00s/it] 50%|█████     | 1/2 [00:08<00:04,  5.00s/it, CE=2.241367e+00 H=2.241175e+00 dV_dx=-2.405779e-06 dV_dθ=-1.896640e-04 ||∇||=4.149690e-01 | Tr=0.2369 Te/Cur=0.2808 Te/Exp=0.2343]100%|██████████| 2/2 [00:08<00:00,  3.91s/it, CE=2.241367e+00 H=2.241175e+00 dV_dx=-2.405779e-06 dV_dθ=-1.896640e-04 ||∇||=4.149690e-01 | Tr=0.2369 Te/Cur=0.2808 Te/Exp=0.2343]100%|██████████| 2/2 [00:08<00:00,  4.07s/it, CE=2.241367e+00 H=2.241175e+00 dV_dx=-2.405779e-06 dV_dθ=-1.896640e-04 ||∇||=4.149690e-01 | Tr=0.2369 Te/Cur=0.2808 Te/Exp=0.2343]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 572, 124, 10]) with loss 2.241367
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.51s/it] 50%|█████     | 1/2 [00:16<00:13, 13.51s/it, CE=2.250387e+00 H=2.250181e+00 dV_dx=-5.403395e-06 dV_dθ=-2.013150e-04 ||∇||=4.213285e-01 | Tr=0.2236 Te/Cur=0.3186 Te/Exp=0.3043]100%|██████████| 2/2 [00:16<00:00,  7.27s/it, CE=2.250387e+00 H=2.250181e+00 dV_dx=-5.403395e-06 dV_dθ=-2.013150e-04 ||∇||=4.213285e-01 | Tr=0.2236 Te/Cur=0.3186 Te/Exp=0.3043]100%|██████████| 2/2 [00:16<00:00,  8.20s/it, CE=2.250387e+00 H=2.250181e+00 dV_dx=-5.403395e-06 dV_dθ=-2.013150e-04 ||∇||=4.213285e-01 | Tr=0.2236 Te/Cur=0.3186 Te/Exp=0.3043]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.71s/it] 50%|█████     | 1/2 [00:16<00:13, 13.71s/it, CE=2.242930e+00 H=2.242751e+00 dV_dx=-1.460752e-05 dV_dθ=-1.644162e-04 ||∇||=4.035638e-01 | Tr=0.3484 Te/Cur=0.4129 Te/Exp=0.2373]100%|██████████| 2/2 [00:16<00:00,  7.21s/it, CE=2.242930e+00 H=2.242751e+00 dV_dx=-1.460752e-05 dV_dθ=-1.644162e-04 ||∇||=4.035638e-01 | Tr=0.3484 Te/Cur=0.4129 Te/Exp=0.2373]100%|██████████| 2/2 [00:16<00:00,  8.18s/it, CE=2.242930e+00 H=2.242751e+00 dV_dx=-1.460752e-05 dV_dθ=-1.644162e-04 ||∇||=4.035638e-01 | Tr=0.3484 Te/Cur=0.4129 Te/Exp=0.2373]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.16s/it] 50%|█████     | 1/2 [00:17<00:15, 15.16s/it, CE=2.250239e+00 H=2.250029e+00 dV_dx=5.010019e-07 dV_dθ=-2.113477e-04 ||∇||=4.237118e-01 | Tr=0.1981 Te/Cur=0.2610 Te/Exp=0.2433]100%|██████████| 2/2 [00:17<00:00,  7.86s/it, CE=2.250239e+00 H=2.250029e+00 dV_dx=5.010019e-07 dV_dθ=-2.113477e-04 ||∇||=4.237118e-01 | Tr=0.1981 Te/Cur=0.2610 Te/Exp=0.2433]100%|██████████| 2/2 [00:17<00:00,  8.95s/it, CE=2.250239e+00 H=2.250029e+00 dV_dx=5.010019e-07 dV_dθ=-2.113477e-04 ||∇||=4.237118e-01 | Tr=0.1981 Te/Cur=0.2610 Te/Exp=0.2433]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.84s/it] 50%|█████     | 1/2 [00:16<00:13, 13.84s/it, CE=2.253623e+00 H=2.253411e+00 dV_dx=7.099240e-06 dV_dθ=-2.189320e-04 ||∇||=4.401928e-01 | Tr=0.2173 Te/Cur=0.2549 Te/Exp=0.2821]100%|██████████| 2/2 [00:16<00:00,  7.48s/it, CE=2.253623e+00 H=2.253411e+00 dV_dx=7.099240e-06 dV_dθ=-2.189320e-04 ||∇||=4.401928e-01 | Tr=0.2173 Te/Cur=0.2549 Te/Exp=0.2821]100%|██████████| 2/2 [00:16<00:00,  8.43s/it, CE=2.253623e+00 H=2.253411e+00 dV_dx=7.099240e-06 dV_dθ=-2.189320e-04 ||∇||=4.401928e-01 | Tr=0.2173 Te/Cur=0.2549 Te/Exp=0.2821]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.62s/it] 50%|█████     | 1/2 [00:07<00:04,  4.62s/it, CE=2.269407e+00 H=2.269201e+00 dV_dx=-2.330780e-06 dV_dθ=-2.044065e-04 ||∇||=4.169735e-01 | Tr=0.1912 Te/Cur=0.2138 Te/Exp=0.1971]100%|██████████| 2/2 [00:07<00:00,  3.42s/it, CE=2.269407e+00 H=2.269201e+00 dV_dx=-2.330780e-06 dV_dθ=-2.044065e-04 ||∇||=4.169735e-01 | Tr=0.1912 Te/Cur=0.2138 Te/Exp=0.1971]100%|██████████| 2/2 [00:07<00:00,  3.60s/it, CE=2.269407e+00 H=2.269201e+00 dV_dx=-2.330780e-06 dV_dθ=-2.044065e-04 ||∇||=4.169735e-01 | Tr=0.1912 Te/Cur=0.2138 Te/Exp=0.1971]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.85s/it] 50%|█████     | 1/2 [00:07<00:04,  4.85s/it, CE=2.269552e+00 H=2.269349e+00 dV_dx=1.560457e-05 dV_dθ=-2.184477e-04 ||∇||=4.183350e-01 | Tr=0.1821 Te/Cur=0.2240 Te/Exp=0.2167]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.269552e+00 H=2.269349e+00 dV_dx=1.560457e-05 dV_dθ=-2.184477e-04 ||∇||=4.183350e-01 | Tr=0.1821 Te/Cur=0.2240 Te/Exp=0.2167]100%|██████████| 2/2 [00:07<00:00,  3.81s/it, CE=2.269552e+00 H=2.269349e+00 dV_dx=1.560457e-05 dV_dθ=-2.184477e-04 ||∇||=4.183350e-01 | Tr=0.1821 Te/Cur=0.2240 Te/Exp=0.2167]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.12s/it] 50%|█████     | 1/2 [00:19<00:16, 16.12s/it, CE=2.246173e+00 H=2.245954e+00 dV_dx=9.802334e-06 dV_dθ=-2.295861e-04 ||∇||=4.414521e-01 | Tr=0.2252 Te/Cur=0.2381 Te/Exp=0.2313]100%|██████████| 2/2 [00:19<00:00,  8.60s/it, CE=2.246173e+00 H=2.245954e+00 dV_dx=9.802334e-06 dV_dθ=-2.295861e-04 ||∇||=4.414521e-01 | Tr=0.2252 Te/Cur=0.2381 Te/Exp=0.2313]100%|██████████| 2/2 [00:19<00:00,  9.73s/it, CE=2.246173e+00 H=2.245954e+00 dV_dx=9.802334e-06 dV_dθ=-2.295861e-04 ||∇||=4.414521e-01 | Tr=0.2252 Te/Cur=0.2381 Te/Exp=0.2313]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.00s/it] 50%|█████     | 1/2 [00:08<00:05,  5.00s/it, CE=2.264375e+00 H=2.264139e+00 dV_dx=-4.834886e-06 dV_dθ=-2.312733e-04 ||∇||=4.073228e-01 | Tr=0.1862 Te/Cur=0.2255 Te/Exp=0.1641]100%|██████████| 2/2 [00:08<00:00,  3.97s/it, CE=2.264375e+00 H=2.264139e+00 dV_dx=-4.834886e-06 dV_dθ=-2.312733e-04 ||∇||=4.073228e-01 | Tr=0.1862 Te/Cur=0.2255 Te/Exp=0.1641]100%|██████████| 2/2 [00:08<00:00,  4.13s/it, CE=2.264375e+00 H=2.264139e+00 dV_dx=-4.834886e-06 dV_dθ=-2.312733e-04 ||∇||=4.073228e-01 | Tr=0.1862 Te/Cur=0.2255 Te/Exp=0.1641]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.77s/it] 50%|█████     | 1/2 [00:07<00:04,  4.77s/it, CE=2.264210e+00 H=2.263996e+00 dV_dx=6.832038e-06 dV_dθ=-2.211415e-04 ||∇||=3.983420e-01 | Tr=0.2539 Te/Cur=0.3022 Te/Exp=0.2289]100%|██████████| 2/2 [00:07<00:00,  3.61s/it, CE=2.264210e+00 H=2.263996e+00 dV_dx=6.832038e-06 dV_dθ=-2.211415e-04 ||∇||=3.983420e-01 | Tr=0.2539 Te/Cur=0.3022 Te/Exp=0.2289]100%|██████████| 2/2 [00:07<00:00,  3.78s/it, CE=2.264210e+00 H=2.263996e+00 dV_dx=6.832038e-06 dV_dθ=-2.211415e-04 ||∇||=3.983420e-01 | Tr=0.2539 Te/Cur=0.3022 Te/Exp=0.2289]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.73s/it] 50%|█████     | 1/2 [00:16<00:13, 13.73s/it, CE=2.245860e+00 H=2.245648e+00 dV_dx=9.440153e-06 dV_dθ=-2.218268e-04 ||∇||=4.060946e-01 | Tr=0.1994 Te/Cur=0.2511 Te/Exp=0.2851]100%|██████████| 2/2 [00:16<00:00,  7.14s/it, CE=2.245860e+00 H=2.245648e+00 dV_dx=9.440153e-06 dV_dθ=-2.218268e-04 ||∇||=4.060946e-01 | Tr=0.1994 Te/Cur=0.2511 Te/Exp=0.2851]100%|██████████| 2/2 [00:16<00:00,  8.13s/it, CE=2.245860e+00 H=2.245648e+00 dV_dx=9.440153e-06 dV_dθ=-2.218268e-04 ||∇||=4.060946e-01 | Tr=0.1994 Te/Cur=0.2511 Te/Exp=0.2851]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.30s/it] 50%|█████     | 1/2 [00:16<00:13, 13.30s/it, CE=2.273459e+00 H=2.273255e+00 dV_dx=1.616311e-05 dV_dθ=-2.204777e-04 ||∇||=4.181101e-01 | Tr=0.1846 Te/Cur=0.2142 Te/Exp=0.1850]100%|██████████| 2/2 [00:16<00:00,  7.10s/it, CE=2.273459e+00 H=2.273255e+00 dV_dx=1.616311e-05 dV_dθ=-2.204777e-04 ||∇||=4.181101e-01 | Tr=0.1846 Te/Cur=0.2142 Te/Exp=0.1850]100%|██████████| 2/2 [00:16<00:00,  8.03s/it, CE=2.273459e+00 H=2.273255e+00 dV_dx=1.616311e-05 dV_dθ=-2.204777e-04 ||∇||=4.181101e-01 | Tr=0.1846 Te/Cur=0.2142 Te/Exp=0.1850]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.61s/it] 50%|█████     | 1/2 [00:18<00:15, 15.61s/it, CE=2.253673e+00 H=2.253420e+00 dV_dx=1.072339e-05 dV_dθ=-2.639525e-04 ||∇||=4.398447e-01 | Tr=0.2014 Te/Cur=0.2794 Te/Exp=0.2575]100%|██████████| 2/2 [00:18<00:00,  7.95s/it, CE=2.253673e+00 H=2.253420e+00 dV_dx=1.072339e-05 dV_dθ=-2.639525e-04 ||∇||=4.398447e-01 | Tr=0.2014 Te/Cur=0.2794 Te/Exp=0.2575]100%|██████████| 2/2 [00:18<00:00,  9.10s/it, CE=2.253673e+00 H=2.253420e+00 dV_dx=1.072339e-05 dV_dθ=-2.639525e-04 ||∇||=4.398447e-01 | Tr=0.2014 Te/Cur=0.2794 Te/Exp=0.2575]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.90s/it] 50%|█████     | 1/2 [00:16<00:13, 13.90s/it, CE=2.237392e+00 H=2.237159e+00 dV_dx=6.030189e-06 dV_dθ=-2.390428e-04 ||∇||=4.255227e-01 | Tr=0.2420 Te/Cur=0.2773 Te/Exp=0.2681]100%|██████████| 2/2 [00:16<00:00,  7.37s/it, CE=2.237392e+00 H=2.237159e+00 dV_dx=6.030189e-06 dV_dθ=-2.390428e-04 ||∇||=4.255227e-01 | Tr=0.2420 Te/Cur=0.2773 Te/Exp=0.2681]100%|██████████| 2/2 [00:16<00:00,  8.35s/it, CE=2.237392e+00 H=2.237159e+00 dV_dx=6.030189e-06 dV_dθ=-2.390428e-04 ||∇||=4.255227e-01 | Tr=0.2420 Te/Cur=0.2773 Te/Exp=0.2681]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 612, 164, 10]) with loss 2.237392
  Grid search complete.
  Best architecture: (4, [432, 612, 164, 10]) with loss 2.237392
  Total candidates evaluated: 54
  Original: (2, [507, 552, 104, 10])
  Optimal: (4, [432, 612, 164, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→4, feed [507, 552, 104, 10]→[432, 612, 164, 10]
  Conv filter changed: A_conv/B_conv shape = (4, 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:20<06:22, 20.14s/it]  5%|▌         | 1/20 [00:24<06:22, 20.14s/it, CE=1.589404e+00 H=1.588515e+00 dV_dx=-3.802515e-05 dV_dθ=-8.508045e-04 ||∇||=2.751139e+00 | Tr=0.8806] 10%|█         | 2/20 [00:24<03:17, 11.00s/it, CE=1.589404e+00 H=1.588515e+00 dV_dx=-3.802515e-05 dV_dθ=-8.508045e-04 ||∇||=2.751139e+00 | Tr=0.8806] 10%|█         | 2/20 [00:29<03:17, 11.00s/it, CE=1.368948e+00 H=1.365048e+00 dV_dx=7.952526e-06 dV_dθ=-3.908390e-03 ||∇||=3.185192e+00 | Tr=0.8806]  15%|█▌        | 3/20 [00:29<02:21,  8.30s/it, CE=1.368948e+00 H=1.365048e+00 dV_dx=7.952526e-06 dV_dθ=-3.908390e-03 ||∇||=3.185192e+00 | Tr=0.8806] 15%|█▌        | 3/20 [00:34<02:21,  8.30s/it, CE=1.227391e+00 H=1.218999e+00 dV_dx=2.233317e-05 dV_dθ=-8.414401e-03 ||∇||=3.741997e+00 | Tr=0.8806] 20%|██        | 4/20 [00:34<01:52,  7.04s/it, CE=1.227391e+00 H=1.218999e+00 dV_dx=2.233317e-05 dV_dθ=-8.414401e-03 ||∇||=3.741997e+00 | Tr=0.8806] 20%|██        | 4/20 [00:38<01:52,  7.04s/it, CE=1.125763e+00 H=1.116813e+00 dV_dx=-3.133578e-05 dV_dθ=-8.918632e-03 ||∇||=3.840254e+00 | Tr=0.8806] 25%|██▌       | 5/20 [00:38<01:28,  5.88s/it, CE=1.125763e+00 H=1.116813e+00 dV_dx=-3.133578e-05 dV_dθ=-8.918632e-03 ||∇||=3.840254e+00 | Tr=0.8806] 25%|██▌       | 5/20 [00:43<01:28,  5.88s/it, CE=1.047333e+00 H=1.036544e+00 dV_dx=8.984028e-06 dV_dθ=-1.079776e-02 ||∇||=4.038283e+00 | Tr=0.8806]  30%|███       | 6/20 [00:43<01:16,  5.48s/it, CE=1.047333e+00 H=1.036544e+00 dV_dx=8.984028e-06 dV_dθ=-1.079776e-02 ||∇||=4.038283e+00 | Tr=0.8806] 30%|███       | 6/20 [00:47<01:16,  5.48s/it, CE=9.855589e-01 H=9.725695e-01 dV_dx=-1.487936e-05 dV_dθ=-1.297452e-02 ||∇||=4.263123e+00 | Tr=0.8806] 35%|███▌      | 7/20 [00:47<01:05,  5.01s/it, CE=9.855589e-01 H=9.725695e-01 dV_dx=-1.487936e-05 dV_dθ=-1.297452e-02 ||∇||=4.263123e+00 | Tr=0.8806] 35%|███▌      | 7/20 [00:51<01:05,  5.01s/it, CE=9.342079e-01 H=9.220468e-01 dV_dx=8.291907e-05 dV_dθ=-1.224398e-02 ||∇||=4.232642e+00 | Tr=0.8806]  40%|████      | 8/20 [00:51<00:57,  4.81s/it, CE=9.342079e-01 H=9.220468e-01 dV_dx=8.291907e-05 dV_dθ=-1.224398e-02 ||∇||=4.232642e+00 | Tr=0.8806] 40%|████      | 8/20 [00:56<00:57,  4.81s/it, CE=8.896731e-01 H=8.790150e-01 dV_dx=-1.319498e-05 dV_dθ=-1.064492e-02 ||∇||=4.005944e+00 | Tr=0.8806] 45%|████▌     | 9/20 [00:56<00:50,  4.61s/it, CE=8.896731e-01 H=8.790150e-01 dV_dx=-1.319498e-05 dV_dθ=-1.064492e-02 ||∇||=4.005944e+00 | Tr=0.8806] 45%|████▌     | 9/20 [01:00<00:50,  4.61s/it, CE=8.548288e-01 H=8.435450e-01 dV_dx=2.145357e-05 dV_dθ=-1.130531e-02 ||∇||=4.086104e+00 | Tr=0.8806]  50%|█████     | 10/20 [01:00<00:44,  4.47s/it, CE=8.548288e-01 H=8.435450e-01 dV_dx=2.145357e-05 dV_dθ=-1.130531e-02 ||∇||=4.086104e+00 | Tr=0.8806] 50%|█████     | 10/20 [01:04<00:44,  4.47s/it, CE=8.252563e-01 H=8.136304e-01 dV_dx=-2.221691e-05 dV_dθ=-1.160365e-02 ||∇||=4.139848e+00 | Tr=0.8806] 55%|█████▌    | 11/20 [01:04<00:39,  4.40s/it, CE=8.252563e-01 H=8.136304e-01 dV_dx=-2.221691e-05 dV_dθ=-1.160365e-02 ||∇||=4.139848e+00 | Tr=0.8806] 55%|█████▌    | 11/20 [01:08<00:39,  4.40s/it, CE=8.008546e-01 H=7.889808e-01 dV_dx=-1.327672e-05 dV_dθ=-1.186059e-02 ||∇||=4.202785e+00 | Tr=0.8806] 60%|██████    | 12/20 [01:08<00:34,  4.25s/it, CE=8.008546e-01 H=7.889808e-01 dV_dx=-1.327672e-05 dV_dθ=-1.186059e-02 ||∇||=4.202785e+00 | Tr=0.8806] 60%|██████    | 12/20 [01:12<00:34,  4.25s/it, CE=7.796241e-01 H=7.678056e-01 dV_dx=-1.479577e-05 dV_dθ=-1.180374e-02 ||∇||=4.237954e+00 | Tr=0.8806] 65%|██████▌   | 13/20 [01:12<00:30,  4.32s/it, CE=7.796241e-01 H=7.678056e-01 dV_dx=-1.479577e-05 dV_dθ=-1.180374e-02 ||∇||=4.237954e+00 | Tr=0.8806] 65%|██████▌   | 13/20 [01:18<00:30,  4.32s/it, CE=7.599715e-01 H=7.481113e-01 dV_dx=1.395133e-05 dV_dθ=-1.187416e-02 ||∇||=4.214433e+00 | Tr=0.8806]  70%|███████   | 14/20 [01:18<00:27,  4.57s/it, CE=7.599715e-01 H=7.481113e-01 dV_dx=1.395133e-05 dV_dθ=-1.187416e-02 ||∇||=4.214433e+00 | Tr=0.8806] 70%|███████   | 14/20 [01:22<00:27,  4.57s/it, CE=7.409064e-01 H=7.305740e-01 dV_dx=4.609644e-05 dV_dθ=-1.037845e-02 ||∇||=3.975904e+00 | Tr=0.8806] 75%|███████▌  | 15/20 [01:22<00:22,  4.55s/it, CE=7.409064e-01 H=7.305740e-01 dV_dx=4.609644e-05 dV_dθ=-1.037845e-02 ||∇||=3.975904e+00 | Tr=0.8806] 75%|███████▌  | 15/20 [01:27<00:22,  4.55s/it, CE=7.254991e-01 H=7.150943e-01 dV_dx=-4.484479e-06 dV_dθ=-1.040024e-02 ||∇||=3.987992e+00 | Tr=0.8806] 80%|████████  | 16/20 [01:27<00:18,  4.59s/it, CE=7.254991e-01 H=7.150943e-01 dV_dx=-4.484479e-06 dV_dθ=-1.040024e-02 ||∇||=3.987992e+00 | Tr=0.8806] 80%|████████  | 16/20 [01:31<00:18,  4.59s/it, CE=7.120176e-01 H=7.011628e-01 dV_dx=5.536549e-05 dV_dθ=-1.091012e-02 ||∇||=4.052037e+00 | Tr=0.8806]  85%|████████▌ | 17/20 [01:31<00:13,  4.60s/it, CE=7.120176e-01 H=7.011628e-01 dV_dx=5.536549e-05 dV_dθ=-1.091012e-02 ||∇||=4.052037e+00 | Tr=0.8806] 85%|████████▌ | 17/20 [01:36<00:13,  4.60s/it, CE=7.004670e-01 H=6.879486e-01 dV_dx=2.882729e-05 dV_dθ=-1.254719e-02 ||∇||=4.226207e+00 | Tr=0.8806] 90%|█████████ | 18/20 [01:36<00:09,  4.59s/it, CE=7.004670e-01 H=6.879486e-01 dV_dx=2.882729e-05 dV_dθ=-1.254719e-02 ||∇||=4.226207e+00 | Tr=0.8806] 90%|█████████ | 18/20 [01:40<00:09,  4.59s/it, CE=6.903861e-01 H=6.761936e-01 dV_dx=5.980318e-05 dV_dθ=-1.425224e-02 ||∇||=4.418585e+00 | Tr=0.8806] 95%|█████████▌| 19/20 [01:40<00:04,  4.51s/it, CE=6.903861e-01 H=6.761936e-01 dV_dx=5.980318e-05 dV_dθ=-1.425224e-02 ||∇||=4.418585e+00 | Tr=0.8806] 95%|█████████▌| 19/20 [01:48<00:04,  4.51s/it, CE=6.833536e-01 H=6.662752e-01 dV_dx=1.238416e-04 dV_dθ=-1.720223e-02 ||∇||=4.787571e+00 | Tr=0.8806 Te/Cur=0.9531 Te/Exp=0.7500]100%|██████████| 20/20 [01:56<00:00,  7.84s/it, CE=6.833536e-01 H=6.662752e-01 dV_dx=1.238416e-04 dV_dθ=-1.720223e-02 ||∇||=4.787571e+00 | Tr=0.8806 Te/Cur=0.9531 Te/Exp=0.7500]100%|██████████| 20/20 [01:56<00:00,  5.82s/it, CE=6.833536e-01 H=6.662752e-01 dV_dx=1.238416e-04 dV_dθ=-1.720223e-02 ||∇||=4.787571e+00 | Tr=0.8806 Te/Cur=0.9531 Te/Exp=0.7500]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.632736
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:15, 13.44s/it]  5%|▌         | 1/20 [00:17<04:15, 13.44s/it, CE=7.006601e-01 H=6.927130e-01 dV_dx=1.143283e-05 dV_dθ=-7.958537e-03 ||∇||=3.845703e+00 | Tr=0.8811] 10%|█         | 2/20 [00:17<02:21,  7.84s/it, CE=7.006601e-01 H=6.927130e-01 dV_dx=1.143283e-05 dV_dθ=-7.958537e-03 ||∇||=3.845703e+00 | Tr=0.8811] 10%|█         | 2/20 [00:21<02:21,  7.84s/it, CE=6.833972e-01 H=6.779532e-01 dV_dx=-3.117510e-05 dV_dθ=-5.412859e-03 ||∇||=3.479166e+00 | Tr=0.8811] 15%|█▌        | 3/20 [00:21<01:45,  6.21s/it, CE=6.833972e-01 H=6.779532e-01 dV_dx=-3.117510e-05 dV_dθ=-5.412859e-03 ||∇||=3.479166e+00 | Tr=0.8811] 15%|█▌        | 3/20 [00:26<01:45,  6.21s/it, CE=6.689793e-01 H=6.651441e-01 dV_dx=-7.800903e-05 dV_dθ=-3.757211e-03 ||∇||=3.208995e+00 | Tr=0.8811] 20%|██        | 4/20 [00:26<01:29,  5.60s/it, CE=6.689793e-01 H=6.651441e-01 dV_dx=-7.800903e-05 dV_dθ=-3.757211e-03 ||∇||=3.208995e+00 | Tr=0.8811] 20%|██        | 4/20 [00:30<01:29,  5.60s/it, CE=6.572899e-01 H=6.537758e-01 dV_dx=-4.204029e-05 dV_dθ=-3.472060e-03 ||∇||=3.160478e+00 | Tr=0.8811] 25%|██▌       | 5/20 [00:30<01:14,  4.97s/it, CE=6.572899e-01 H=6.537758e-01 dV_dx=-4.204029e-05 dV_dθ=-3.472060e-03 ||∇||=3.160478e+00 | Tr=0.8811] 25%|██▌       | 5/20 [00:35<01:14,  4.97s/it, CE=6.474547e-01 H=6.439402e-01 dV_dx=-9.393998e-05 dV_dθ=-3.420639e-03 ||∇||=3.175667e+00 | Tr=0.8811] 30%|███       | 6/20 [00:35<01:12,  5.17s/it, CE=6.474547e-01 H=6.439402e-01 dV_dx=-9.393998e-05 dV_dθ=-3.420639e-03 ||∇||=3.175667e+00 | Tr=0.8811] 30%|███       | 6/20 [00:40<01:12,  5.17s/it, CE=6.382447e-01 H=6.347235e-01 dV_dx=-3.014159e-05 dV_dθ=-3.491027e-03 ||∇||=3.200619e+00 | Tr=0.8811] 35%|███▌      | 7/20 [00:40<01:04,  4.98s/it, CE=6.382447e-01 H=6.347235e-01 dV_dx=-3.014159e-05 dV_dθ=-3.491027e-03 ||∇||=3.200619e+00 | Tr=0.8811] 35%|███▌      | 7/20 [00:44<01:04,  4.98s/it, CE=6.296382e-01 H=6.261660e-01 dV_dx=3.552188e-05 dV_dθ=-3.507635e-03 ||∇||=3.195599e+00 | Tr=0.8811]  40%|████      | 8/20 [00:44<00:56,  4.71s/it, CE=6.296382e-01 H=6.261660e-01 dV_dx=3.552188e-05 dV_dθ=-3.507635e-03 ||∇||=3.195599e+00 | Tr=0.8811] 40%|████      | 8/20 [00:48<00:56,  4.71s/it, CE=6.210252e-01 H=6.179270e-01 dV_dx=5.592727e-05 dV_dθ=-3.154159e-03 ||∇||=3.133867e+00 | Tr=0.8811] 45%|████▌     | 9/20 [00:48<00:49,  4.50s/it, CE=6.210252e-01 H=6.179270e-01 dV_dx=5.592727e-05 dV_dθ=-3.154159e-03 ||∇||=3.133867e+00 | Tr=0.8811] 45%|████▌     | 9/20 [00:53<00:49,  4.50s/it, CE=6.133801e-01 H=6.102832e-01 dV_dx=5.523502e-06 dV_dθ=-3.102462e-03 ||∇||=3.131551e+00 | Tr=0.8811] 50%|█████     | 10/20 [00:53<00:47,  4.71s/it, CE=6.133801e-01 H=6.102832e-01 dV_dx=5.523502e-06 dV_dθ=-3.102462e-03 ||∇||=3.131551e+00 | Tr=0.8811] 50%|█████     | 10/20 [00:58<00:47,  4.71s/it, CE=6.063076e-01 H=6.031212e-01 dV_dx=-4.577918e-06 dV_dθ=-3.181788e-03 ||∇||=3.140941e+00 | Tr=0.8811] 55%|█████▌    | 11/20 [00:58<00:43,  4.84s/it, CE=6.063076e-01 H=6.031212e-01 dV_dx=-4.577918e-06 dV_dθ=-3.181788e-03 ||∇||=3.140941e+00 | Tr=0.8811] 55%|█████▌    | 11/20 [01:03<00:43,  4.84s/it, CE=5.986449e-01 H=5.956611e-01 dV_dx=9.485424e-06 dV_dθ=-2.993279e-03 ||∇||=3.097980e+00 | Tr=0.8811]  60%|██████    | 12/20 [01:03<00:38,  4.77s/it, CE=5.986449e-01 H=5.956611e-01 dV_dx=9.485424e-06 dV_dθ=-2.993279e-03 ||∇||=3.097980e+00 | Tr=0.8811] 60%|██████    | 12/20 [01:07<00:38,  4.77s/it, CE=5.918345e-01 H=5.891360e-01 dV_dx=4.950897e-05 dV_dθ=-2.748012e-03 ||∇||=3.061501e+00 | Tr=0.8811] 65%|██████▌   | 13/20 [01:07<00:32,  4.59s/it, CE=5.918345e-01 H=5.891360e-01 dV_dx=4.950897e-05 dV_dθ=-2.748012e-03 ||∇||=3.061501e+00 | Tr=0.8811] 65%|██████▌   | 13/20 [01:12<00:32,  4.59s/it, CE=5.855250e-01 H=5.826872e-01 dV_dx=-5.620626e-05 dV_dθ=-2.781586e-03 ||∇||=3.068512e+00 | Tr=0.8811] 70%|███████   | 14/20 [01:12<00:27,  4.60s/it, CE=5.855250e-01 H=5.826872e-01 dV_dx=-5.620626e-05 dV_dθ=-2.781586e-03 ||∇||=3.068512e+00 | Tr=0.8811] 70%|███████   | 14/20 [01:16<00:27,  4.60s/it, CE=5.785423e-01 H=5.758467e-01 dV_dx=2.550523e-05 dV_dθ=-2.721148e-03 ||∇||=3.014981e+00 | Tr=0.8811]  75%|███████▌  | 15/20 [01:16<00:22,  4.57s/it, CE=5.785423e-01 H=5.758467e-01 dV_dx=2.550523e-05 dV_dθ=-2.721148e-03 ||∇||=3.014981e+00 | Tr=0.8811] 75%|███████▌  | 15/20 [01:21<00:22,  4.57s/it, CE=5.726062e-01 H=5.700032e-01 dV_dx=6.447192e-05 dV_dθ=-2.667506e-03 ||∇||=2.992850e+00 | Tr=0.8811] 80%|████████  | 16/20 [01:21<00:18,  4.68s/it, CE=5.726062e-01 H=5.700032e-01 dV_dx=6.447192e-05 dV_dθ=-2.667506e-03 ||∇||=2.992850e+00 | Tr=0.8811] 80%|████████  | 16/20 [01:26<00:18,  4.68s/it, CE=5.668786e-01 H=5.644367e-01 dV_dx=7.496950e-05 dV_dθ=-2.516827e-03 ||∇||=2.999783e+00 | Tr=0.8811] 85%|████████▌ | 17/20 [01:26<00:13,  4.60s/it, CE=5.668786e-01 H=5.644367e-01 dV_dx=7.496950e-05 dV_dθ=-2.516827e-03 ||∇||=2.999783e+00 | Tr=0.8811] 85%|████████▌ | 17/20 [01:30<00:13,  4.60s/it, CE=5.608754e-01 H=5.586233e-01 dV_dx=3.061907e-05 dV_dθ=-2.282677e-03 ||∇||=2.948019e+00 | Tr=0.8811] 90%|█████████ | 18/20 [01:30<00:09,  4.65s/it, CE=5.608754e-01 H=5.586233e-01 dV_dx=3.061907e-05 dV_dθ=-2.282677e-03 ||∇||=2.948019e+00 | Tr=0.8811] 90%|█████████ | 18/20 [01:35<00:09,  4.65s/it, CE=5.552256e-01 H=5.529514e-01 dV_dx=1.450707e-04 dV_dθ=-2.419270e-03 ||∇||=2.969595e+00 | Tr=0.8811] 95%|█████████▌| 19/20 [01:35<00:04,  4.54s/it, CE=5.552256e-01 H=5.529514e-01 dV_dx=1.450707e-04 dV_dθ=-2.419270e-03 ||∇||=2.969595e+00 | Tr=0.8811] 95%|█████████▌| 19/20 [01:41<00:04,  4.54s/it, CE=5.506674e-01 H=5.481764e-01 dV_dx=9.773091e-05 dV_dθ=-2.588676e-03 ||∇||=3.035141e+00 | Tr=0.8811 Te/Cur=0.9683 Te/Exp=0.7804]100%|██████████| 20/20 [01:46<00:00,  6.58s/it, CE=5.506674e-01 H=5.481764e-01 dV_dx=9.773091e-05 dV_dθ=-2.588676e-03 ||∇||=3.035141e+00 | Tr=0.8811 Te/Cur=0.9683 Te/Exp=0.7804]100%|██████████| 20/20 [01:46<00:00,  5.32s/it, CE=5.506674e-01 H=5.481764e-01 dV_dx=9.773091e-05 dV_dθ=-2.588676e-03 ||∇||=3.035141e+00 | Tr=0.8811 Te/Cur=0.9683 Te/Exp=0.7804]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.96s/it] 50%|█████     | 1/2 [00:20<00:13, 13.96s/it, CE=5.879963e-01 H=5.876483e-01 dV_dx=-9.764883e-05 dV_dθ=-2.503053e-04 ||∇||=1.033510e+00 | Tr=0.9877 Te/Cur=0.9723 Te/Exp=0.7889]100%|██████████| 2/2 [00:20<00:00,  9.37s/it, CE=5.879963e-01 H=5.876483e-01 dV_dx=-9.764883e-05 dV_dθ=-2.503053e-04 ||∇||=1.033510e+00 | Tr=0.9877 Te/Cur=0.9723 Te/Exp=0.7889]100%|██████████| 2/2 [00:20<00:00, 10.06s/it, CE=5.879963e-01 H=5.876483e-01 dV_dx=-9.764883e-05 dV_dθ=-2.503053e-04 ||∇||=1.033510e+00 | Tr=0.9877 Te/Cur=0.9723 Te/Exp=0.7889]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:07, 13.03s/it]  5%|▌         | 1/20 [00:17<04:07, 13.03s/it, CE=5.826800e-01 H=5.824032e-01 dV_dx=2.328217e-05 dV_dθ=-3.000688e-04 ||∇||=1.072804e+00 | Tr=0.9884] 10%|█         | 2/20 [00:17<02:27,  8.20s/it, CE=5.826800e-01 H=5.824032e-01 dV_dx=2.328217e-05 dV_dθ=-3.000688e-04 ||∇||=1.072804e+00 | Tr=0.9884] 10%|█         | 2/20 [00:21<02:27,  8.20s/it, CE=5.757370e-01 H=5.755182e-01 dV_dx=6.131011e-05 dV_dθ=-2.800820e-04 ||∇||=1.054301e+00 | Tr=0.9889] 15%|█▌        | 3/20 [00:21<01:43,  6.11s/it, CE=5.757370e-01 H=5.755182e-01 dV_dx=6.131011e-05 dV_dθ=-2.800820e-04 ||∇||=1.054301e+00 | Tr=0.9889] 15%|█▌        | 3/20 [00:26<01:43,  6.11s/it, CE=5.700321e-01 H=5.696934e-01 dV_dx=-6.134793e-05 dV_dθ=-2.772619e-04 ||∇||=1.048914e+00 | Tr=0.9891] 20%|██        | 4/20 [00:26<01:27,  5.49s/it, CE=5.700321e-01 H=5.696934e-01 dV_dx=-6.134793e-05 dV_dθ=-2.772619e-04 ||∇||=1.048914e+00 | Tr=0.9891] 20%|██        | 4/20 [00:30<01:27,  5.49s/it, CE=5.650835e-01 H=5.650012e-01 dV_dx=1.906065e-04 dV_dθ=-2.729016e-04 ||∇||=1.042044e+00 | Tr=0.9896]  25%|██▌       | 5/20 [00:30<01:17,  5.15s/it, CE=5.650835e-01 H=5.650012e-01 dV_dx=1.906065e-04 dV_dθ=-2.729016e-04 ||∇||=1.042044e+00 | Tr=0.9896] 25%|██▌       | 5/20 [00:37<01:17,  5.15s/it, CE=5.605123e-01 H=5.601336e-01 dV_dx=-1.239251e-04 dV_dθ=-2.547549e-04 ||∇||=1.029494e+00 | Tr=0.9898 Te/Cur=0.9731 Te/Exp=0.7892] 30%|███       | 6/20 [00:37<01:19,  5.71s/it, CE=5.605123e-01 H=5.601336e-01 dV_dx=-1.239251e-04 dV_dθ=-2.547549e-04 ||∇||=1.029494e+00 | Tr=0.9898 Te/Cur=0.9731 Te/Exp=0.7892] 30%|███       | 6/20 [00:41<01:19,  5.71s/it, CE=5.562475e-01 H=5.560909e-01 dV_dx=9.096205e-05 dV_dθ=-2.475690e-04 ||∇||=1.019765e+00 | Tr=0.9901]                              35%|███▌      | 7/20 [00:41<01:07,  5.22s/it, CE=5.562475e-01 H=5.560909e-01 dV_dx=9.096205e-05 dV_dθ=-2.475690e-04 ||∇||=1.019765e+00 | Tr=0.9901] 35%|███▌      | 7/20 [00:45<01:07,  5.22s/it, CE=5.522257e-01 H=5.519493e-01 dV_dx=-4.651540e-05 dV_dθ=-2.298948e-04 ||∇||=1.007352e+00 | Tr=0.9904] 40%|████      | 8/20 [00:45<00:58,  4.87s/it, CE=5.522257e-01 H=5.519493e-01 dV_dx=-4.651540e-05 dV_dθ=-2.298948e-04 ||∇||=1.007352e+00 | Tr=0.9904] 40%|████      | 8/20 [00:50<00:58,  4.87s/it, CE=5.484630e-01 H=5.480536e-01 dV_dx=-1.823158e-04 dV_dθ=-2.271533e-04 ||∇||=1.007434e+00 | Tr=0.9910] 45%|████▌     | 9/20 [00:50<00:54,  4.94s/it, CE=5.484630e-01 H=5.480536e-01 dV_dx=-1.823158e-04 dV_dθ=-2.271533e-04 ||∇||=1.007434e+00 | Tr=0.9910] 45%|████▌     | 9/20 [00:54<00:54,  4.94s/it, CE=5.449955e-01 H=5.447261e-01 dV_dx=-4.930515e-05 dV_dθ=-2.200894e-04 ||∇||=1.004218e+00 | Tr=0.9913] 50%|█████     | 10/20 [00:54<00:46,  4.63s/it, CE=5.449955e-01 H=5.447261e-01 dV_dx=-4.930515e-05 dV_dθ=-2.200894e-04 ||∇||=1.004218e+00 | Tr=0.9913] 50%|█████     | 10/20 [01:01<00:46,  4.63s/it, CE=5.417356e-01 H=5.417717e-01 dV_dx=2.642170e-04 dV_dθ=-2.281536e-04 ||∇||=1.009811e+00 | Tr=0.9915 Te/Cur=0.9731 Te/Exp=0.7946] 55%|█████▌    | 11/20 [01:01<00:46,  5.15s/it, CE=5.417356e-01 H=5.417717e-01 dV_dx=2.642170e-04 dV_dθ=-2.281536e-04 ||∇||=1.009811e+00 | Tr=0.9915 Te/Cur=0.9731 Te/Exp=0.7946] 55%|█████▌    | 11/20 [01:05<00:46,  5.15s/it, CE=5.385547e-01 H=5.382719e-01 dV_dx=-6.188434e-05 dV_dθ=-2.209502e-04 ||∇||=1.009705e+00 | Tr=0.9917]                            60%|██████    | 12/20 [01:05<00:40,  5.01s/it, CE=5.385547e-01 H=5.382719e-01 dV_dx=-6.188434e-05 dV_dθ=-2.209502e-04 ||∇||=1.009705e+00 | Tr=0.9917] 60%|██████    | 12/20 [01:10<00:40,  5.01s/it, CE=5.355213e-01 H=5.354706e-01 dV_dx=1.663004e-04 dV_dθ=-2.169506e-04 ||∇||=1.007290e+00 | Tr=0.9920]  65%|██████▌   | 13/20 [01:10<00:33,  4.83s/it, CE=5.355213e-01 H=5.354706e-01 dV_dx=1.663004e-04 dV_dθ=-2.169506e-04 ||∇||=1.007290e+00 | Tr=0.9920] 65%|██████▌   | 13/20 [01:14<00:33,  4.83s/it, CE=5.326617e-01 H=5.325380e-01 dV_dx=9.428647e-05 dV_dθ=-2.179825e-04 ||∇||=1.011373e+00 | Tr=0.9923] 70%|███████   | 14/20 [01:14<00:28,  4.83s/it, CE=5.326617e-01 H=5.325380e-01 dV_dx=9.428647e-05 dV_dθ=-2.179825e-04 ||∇||=1.011373e+00 | Tr=0.9923] 70%|███████   | 14/20 [01:19<00:28,  4.83s/it, CE=5.298229e-01 H=5.296549e-01 dV_dx=4.933689e-05 dV_dθ=-2.173299e-04 ||∇||=1.014346e+00 | Tr=0.9924] 75%|███████▌  | 15/20 [01:19<00:24,  4.84s/it, CE=5.298229e-01 H=5.296549e-01 dV_dx=4.933689e-05 dV_dθ=-2.173299e-04 ||∇||=1.014346e+00 | Tr=0.9924] 75%|███████▌  | 15/20 [01:25<00:24,  4.84s/it, CE=5.270844e-01 H=5.268118e-01 dV_dx=-6.378708e-05 dV_dθ=-2.088087e-04 ||∇||=1.012187e+00 | Tr=0.9925 Te/Cur=0.9764 Te/Exp=0.7916] 80%|████████  | 16/20 [01:25<00:20,  5.14s/it, CE=5.270844e-01 H=5.268118e-01 dV_dx=-6.378708e-05 dV_dθ=-2.088087e-04 ||∇||=1.012187e+00 | Tr=0.9925 Te/Cur=0.9764 Te/Exp=0.7916] 80%|████████  | 16/20 [01:29<00:20,  5.14s/it, CE=5.244590e-01 H=5.243054e-01 dV_dx=5.438358e-05 dV_dθ=-2.080244e-04 ||∇||=1.015384e+00 | Tr=0.9926]                              85%|████████▌ | 17/20 [01:29<00:14,  4.88s/it, CE=5.244590e-01 H=5.243054e-01 dV_dx=5.438358e-05 dV_dθ=-2.080244e-04 ||∇||=1.015384e+00 | Tr=0.9926] 85%|████████▌ | 17/20 [01:34<00:14,  4.88s/it, CE=5.219553e-01 H=5.218536e-01 dV_dx=1.153037e-04 dV_dθ=-2.170358e-04 ||∇||=1.019844e+00 | Tr=0.9928] 90%|█████████ | 18/20 [01:34<00:09,  4.75s/it, CE=5.219553e-01 H=5.218536e-01 dV_dx=1.153037e-04 dV_dθ=-2.170358e-04 ||∇||=1.019844e+00 | Tr=0.9928] 90%|█████████ | 18/20 [01:38<00:09,  4.75s/it, CE=5.194670e-01 H=5.192040e-01 dV_dx=-4.381653e-05 dV_dθ=-2.191272e-04 ||∇||=1.022938e+00 | Tr=0.9931] 95%|█████████▌| 19/20 [01:38<00:04,  4.59s/it, CE=5.194670e-01 H=5.192040e-01 dV_dx=-4.381653e-05 dV_dθ=-2.191272e-04 ||∇||=1.022938e+00 | Tr=0.9931] 95%|█████████▌| 19/20 [01:45<00:04,  4.59s/it, CE=5.170832e-01 H=5.168152e-01 dV_dx=-4.670046e-05 dV_dθ=-2.212548e-04 ||∇||=1.027191e+00 | Tr=0.9932 Te/Cur=0.9752 Te/Exp=0.7968]100%|██████████| 20/20 [01:45<00:00,  5.17s/it, CE=5.170832e-01 H=5.168152e-01 dV_dx=-4.670046e-05 dV_dθ=-2.212548e-04 ||∇||=1.027191e+00 | Tr=0.9932 Te/Cur=0.9752 Te/Exp=0.7968]100%|██████████| 20/20 [01:45<00:00,  5.26s/it, CE=5.170832e-01 H=5.168152e-01 dV_dx=-4.670046e-05 dV_dθ=-2.212548e-04 ||∇||=1.027191e+00 | Tr=0.9932 Te/Cur=0.9752 Te/Exp=0.7968]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 4 final loss: 0.522084
======================================================================


  Evaluating on all tasks 0..4 for CL metrics...
    Task 0: 0.7837
    Task 1: 0.9531
    Task 2: 0.8487
    Task 3: 0.5952
    Task 4: 0.9757

============================================================
Task 5
============================================================
Initial loss on new task: 11.5508, previous: 0.5171, ratio: 22.34
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 5
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:15<?, ?it/s, CE=6.881079e-01 H=6.515211e-01 dV_dx=-1.528138e-04 dV_dθ=-3.643397e-02 ||∇||=6.248484e+00 | Tr=0.5751 Te/Cur=0.7690 Te/Exp=0.8157]100%|██████████| 1/1 [00:15<00:00, 15.46s/it, CE=6.881079e-01 H=6.515211e-01 dV_dx=-1.528138e-04 dV_dθ=-3.643397e-02 ||∇||=6.248484e+00 | Tr=0.5751 Te/Cur=0.7690 Te/Exp=0.8157]100%|██████████| 1/1 [00:15<00:00, 15.46s/it, CE=6.881079e-01 H=6.515211e-01 dV_dx=-1.528138e-04 dV_dθ=-3.643397e-02 ||∇||=6.248484e+00 | Tr=0.5751 Te/Cur=0.7690 Te/Exp=0.8157]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.688108

[STEP 2] Architecture change decision
  Current: 0.688108, Previous: 0.517083
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9418 samples from 10 classes
  Created balanced validation set: 39932 samples from 10 classes
  Starting grid architecture search for task 5
  Baseline architecture: (4, [432, 612, 164, 10])
  Baseline loss: 0.688108
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.17s/it] 50%|█████     | 1/2 [00:11<00:09,  9.17s/it, CE=2.276894e+00 H=2.276834e+00 dV_dx=5.540327e-06 dV_dθ=-6.576215e-05 ||∇||=4.365616e-01 | Tr=0.1640 Te/Cur=0.1738 Te/Exp=0.2188]100%|██████████| 2/2 [00:11<00:00,  5.40s/it, CE=2.276894e+00 H=2.276834e+00 dV_dx=5.540327e-06 dV_dθ=-6.576215e-05 ||∇||=4.365616e-01 | Tr=0.1640 Te/Cur=0.1738 Te/Exp=0.2188]100%|██████████| 2/2 [00:11<00:00,  5.96s/it, CE=2.276894e+00 H=2.276834e+00 dV_dx=5.540327e-06 dV_dθ=-6.576215e-05 ||∇||=4.365616e-01 | Tr=0.1640 Te/Cur=0.1738 Te/Exp=0.2188]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.276894123242007
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.73s/it] 50%|█████     | 1/2 [00:19<00:16, 16.73s/it, CE=2.272684e+00 H=2.272662e+00 dV_dx=2.622575e-05 dV_dθ=-4.811036e-05 ||∇||=4.674839e-01 | Tr=0.0996 Te/Cur=0.1199 Te/Exp=0.2207]100%|██████████| 2/2 [00:19<00:00,  8.61s/it, CE=2.272684e+00 H=2.272662e+00 dV_dx=2.622575e-05 dV_dθ=-4.811036e-05 ||∇||=4.674839e-01 | Tr=0.0996 Te/Cur=0.1199 Te/Exp=0.2207]100%|██████████| 2/2 [00:19<00:00,  9.83s/it, CE=2.272684e+00 H=2.272662e+00 dV_dx=2.622575e-05 dV_dθ=-4.811036e-05 ||∇||=4.674839e-01 | Tr=0.0996 Te/Cur=0.1199 Te/Exp=0.2207]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 144, 10]) with loss 2.272684
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.14s/it] 50%|█████     | 1/2 [00:17<00:14, 14.14s/it, CE=2.261785e+00 H=2.261709e+00 dV_dx=-2.134494e-05 dV_dθ=-5.517183e-05 ||∇||=4.169077e-01 | Tr=0.1518 Te/Cur=0.1337 Te/Exp=0.2452]100%|██████████| 2/2 [00:17<00:00,  7.74s/it, CE=2.261785e+00 H=2.261709e+00 dV_dx=-2.134494e-05 dV_dθ=-5.517183e-05 ||∇||=4.169077e-01 | Tr=0.1518 Te/Cur=0.1337 Te/Exp=0.2452]100%|██████████| 2/2 [00:17<00:00,  8.70s/it, CE=2.261785e+00 H=2.261709e+00 dV_dx=-2.134494e-05 dV_dθ=-5.517183e-05 ||∇||=4.169077e-01 | Tr=0.1518 Te/Cur=0.1337 Te/Exp=0.2452]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.261785
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.09s/it] 50%|█████     | 1/2 [00:17<00:14, 14.09s/it, CE=2.276721e+00 H=2.276699e+00 dV_dx=-5.601842e-06 dV_dθ=-1.571501e-05 ||∇||=4.263508e-01 | Tr=0.1346 Te/Cur=0.1371 Te/Exp=0.1698]100%|██████████| 2/2 [00:17<00:00,  7.62s/it, CE=2.276721e+00 H=2.276699e+00 dV_dx=-5.601842e-06 dV_dθ=-1.571501e-05 ||∇||=4.263508e-01 | Tr=0.1346 Te/Cur=0.1371 Te/Exp=0.1698]100%|██████████| 2/2 [00:17<00:00,  8.59s/it, CE=2.276721e+00 H=2.276699e+00 dV_dx=-5.601842e-06 dV_dθ=-1.571501e-05 ||∇||=4.263508e-01 | Tr=0.1346 Te/Cur=0.1371 Te/Exp=0.1698]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.82s/it] 50%|█████     | 1/2 [00:10<00:07,  7.82s/it, CE=2.278165e+00 H=2.277999e+00 dV_dx=9.345701e-06 dV_dθ=-1.753369e-04 ||∇||=5.046744e-01 | Tr=0.1477 Te/Cur=0.1710 Te/Exp=0.2562]100%|██████████| 2/2 [00:10<00:00,  4.93s/it, CE=2.278165e+00 H=2.277999e+00 dV_dx=9.345701e-06 dV_dθ=-1.753369e-04 ||∇||=5.046744e-01 | Tr=0.1477 Te/Cur=0.1710 Te/Exp=0.2562]100%|██████████| 2/2 [00:10<00:00,  5.36s/it, CE=2.278165e+00 H=2.277999e+00 dV_dx=9.345701e-06 dV_dθ=-1.753369e-04 ||∇||=5.046744e-01 | Tr=0.1477 Te/Cur=0.1710 Te/Exp=0.2562]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.74s/it] 50%|█████     | 1/2 [00:16<00:13, 13.74s/it, CE=2.281081e+00 H=2.281007e+00 dV_dx=1.442594e-06 dV_dθ=-7.540114e-05 ||∇||=3.907190e-01 | Tr=0.2026 Te/Cur=0.2042 Te/Exp=0.2053]100%|██████████| 2/2 [00:16<00:00,  7.51s/it, CE=2.281081e+00 H=2.281007e+00 dV_dx=1.442594e-06 dV_dθ=-7.540114e-05 ||∇||=3.907190e-01 | Tr=0.2026 Te/Cur=0.2042 Te/Exp=0.2053]100%|██████████| 2/2 [00:16<00:00,  8.45s/it, CE=2.281081e+00 H=2.281007e+00 dV_dx=1.442594e-06 dV_dθ=-7.540114e-05 ||∇||=3.907190e-01 | Tr=0.2026 Te/Cur=0.2042 Te/Exp=0.2053]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.96s/it] 50%|█████     | 1/2 [00:14<00:10, 10.96s/it, CE=2.285236e+00 H=2.285188e+00 dV_dx=1.837224e-05 dV_dθ=-6.657422e-05 ||∇||=4.450506e-01 | Tr=0.1344 Te/Cur=0.1409 Te/Exp=0.1348]100%|██████████| 2/2 [00:14<00:00,  6.39s/it, CE=2.285236e+00 H=2.285188e+00 dV_dx=1.837224e-05 dV_dθ=-6.657422e-05 ||∇||=4.450506e-01 | Tr=0.1344 Te/Cur=0.1409 Te/Exp=0.1348]100%|██████████| 2/2 [00:14<00:00,  7.08s/it, CE=2.285236e+00 H=2.285188e+00 dV_dx=1.837224e-05 dV_dθ=-6.657422e-05 ||∇||=4.450506e-01 | Tr=0.1344 Te/Cur=0.1409 Te/Exp=0.1348]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.60s/it] 50%|█████     | 1/2 [00:15<00:13, 13.60s/it, CE=2.270518e+00 H=2.270421e+00 dV_dx=-1.200980e-05 dV_dθ=-8.419644e-05 ||∇||=4.567378e-01 | Tr=0.1668 Te/Cur=0.1641 Te/Exp=0.1965]100%|██████████| 2/2 [00:15<00:00,  6.95s/it, CE=2.270518e+00 H=2.270421e+00 dV_dx=-1.200980e-05 dV_dθ=-8.419644e-05 ||∇||=4.567378e-01 | Tr=0.1668 Te/Cur=0.1641 Te/Exp=0.1965]100%|██████████| 2/2 [00:15<00:00,  7.95s/it, CE=2.270518e+00 H=2.270421e+00 dV_dx=-1.200980e-05 dV_dθ=-8.419644e-05 ||∇||=4.567378e-01 | Tr=0.1668 Te/Cur=0.1641 Te/Exp=0.1965]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.28s/it] 50%|█████     | 1/2 [00:16<00:13, 13.28s/it, CE=2.279216e+00 H=2.279127e+00 dV_dx=1.403964e-05 dV_dθ=-1.028407e-04 ||∇||=4.161817e-01 | Tr=0.1248 Te/Cur=0.1226 Te/Exp=0.1895]100%|██████████| 2/2 [00:16<00:00,  7.18s/it, CE=2.279216e+00 H=2.279127e+00 dV_dx=1.403964e-05 dV_dθ=-1.028407e-04 ||∇||=4.161817e-01 | Tr=0.1248 Te/Cur=0.1226 Te/Exp=0.1895]100%|██████████| 2/2 [00:16<00:00,  8.09s/it, CE=2.279216e+00 H=2.279127e+00 dV_dx=1.403964e-05 dV_dθ=-1.028407e-04 ||∇||=4.161817e-01 | Tr=0.1248 Te/Cur=0.1226 Te/Exp=0.1895]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.81s/it] 50%|█████     | 1/2 [00:10<00:07,  7.81s/it, CE=2.280144e+00 H=2.280062e+00 dV_dx=-6.318821e-06 dV_dθ=-7.599856e-05 ||∇||=4.010669e-01 | Tr=0.1066 Te/Cur=0.1149 Te/Exp=0.2373]100%|██████████| 2/2 [00:10<00:00,  4.91s/it, CE=2.280144e+00 H=2.280062e+00 dV_dx=-6.318821e-06 dV_dθ=-7.599856e-05 ||∇||=4.010669e-01 | Tr=0.1066 Te/Cur=0.1149 Te/Exp=0.2373]100%|██████████| 2/2 [00:10<00:00,  5.34s/it, CE=2.280144e+00 H=2.280062e+00 dV_dx=-6.318821e-06 dV_dθ=-7.599856e-05 ||∇||=4.010669e-01 | Tr=0.1066 Te/Cur=0.1149 Te/Exp=0.2373]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.71s/it] 50%|█████     | 1/2 [00:16<00:13, 13.71s/it, CE=2.263680e+00 H=2.263643e+00 dV_dx=-1.230227e-05 dV_dθ=-2.474373e-05 ||∇||=3.401583e-01 | Tr=0.0628 Te/Cur=0.0804 Te/Exp=0.2537]100%|██████████| 2/2 [00:16<00:00,  7.24s/it, CE=2.263680e+00 H=2.263643e+00 dV_dx=-1.230227e-05 dV_dθ=-2.474373e-05 ||∇||=3.401583e-01 | Tr=0.0628 Te/Cur=0.0804 Te/Exp=0.2537]100%|██████████| 2/2 [00:16<00:00,  8.21s/it, CE=2.263680e+00 H=2.263643e+00 dV_dx=-1.230227e-05 dV_dθ=-2.474373e-05 ||∇||=3.401583e-01 | Tr=0.0628 Te/Cur=0.0804 Te/Exp=0.2537]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.67s/it] 50%|█████     | 1/2 [00:18<00:15, 15.67s/it, CE=2.261713e+00 H=2.261697e+00 dV_dx=4.310574e-06 dV_dθ=-2.091177e-05 ||∇||=3.764269e-01 | Tr=0.1527 Te/Cur=0.1332 Te/Exp=0.2510]100%|██████████| 2/2 [00:18<00:00,  8.32s/it, CE=2.261713e+00 H=2.261697e+00 dV_dx=4.310574e-06 dV_dθ=-2.091177e-05 ||∇||=3.764269e-01 | Tr=0.1527 Te/Cur=0.1332 Te/Exp=0.2510]100%|██████████| 2/2 [00:18<00:00,  9.42s/it, CE=2.261713e+00 H=2.261697e+00 dV_dx=4.310574e-06 dV_dθ=-2.091177e-05 ||∇||=3.764269e-01 | Tr=0.1527 Te/Cur=0.1332 Te/Exp=0.2510]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 632, 144, 10]) with loss 2.261713
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.59s/it] 50%|█████     | 1/2 [00:16<00:13, 13.59s/it, CE=2.272633e+00 H=2.272599e+00 dV_dx=1.240578e-05 dV_dθ=-4.665945e-05 ||∇||=3.582869e-01 | Tr=0.1076 Te/Cur=0.1100 Te/Exp=0.2387]100%|██████████| 2/2 [00:16<00:00,  7.56s/it, CE=2.272633e+00 H=2.272599e+00 dV_dx=1.240578e-05 dV_dθ=-4.665945e-05 ||∇||=3.582869e-01 | Tr=0.1076 Te/Cur=0.1100 Te/Exp=0.2387]100%|██████████| 2/2 [00:16<00:00,  8.46s/it, CE=2.272633e+00 H=2.272599e+00 dV_dx=1.240578e-05 dV_dθ=-4.665945e-05 ||∇||=3.582869e-01 | Tr=0.1076 Te/Cur=0.1100 Te/Exp=0.2387]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.50s/it] 50%|█████     | 1/2 [00:10<00:07,  7.50s/it, CE=2.269443e+00 H=2.269385e+00 dV_dx=1.213371e-06 dV_dθ=-5.910002e-05 ||∇||=3.929637e-01 | Tr=0.1390 Te/Cur=0.1310 Te/Exp=0.2435]100%|██████████| 2/2 [00:10<00:00,  4.66s/it, CE=2.269443e+00 H=2.269385e+00 dV_dx=1.213371e-06 dV_dθ=-5.910002e-05 ||∇||=3.929637e-01 | Tr=0.1390 Te/Cur=0.1310 Te/Exp=0.2435]100%|██████████| 2/2 [00:10<00:00,  5.09s/it, CE=2.269443e+00 H=2.269385e+00 dV_dx=1.213371e-06 dV_dθ=-5.910002e-05 ||∇||=3.929637e-01 | Tr=0.1390 Te/Cur=0.1310 Te/Exp=0.2435]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.66s/it] 50%|█████     | 1/2 [00:16<00:13, 13.66s/it, CE=2.274107e+00 H=2.274071e+00 dV_dx=-2.481944e-06 dV_dθ=-3.415092e-05 ||∇||=3.469338e-01 | Tr=0.1813 Te/Cur=0.2042 Te/Exp=0.2524]100%|██████████| 2/2 [00:16<00:00,  7.39s/it, CE=2.274107e+00 H=2.274071e+00 dV_dx=-2.481944e-06 dV_dθ=-3.415092e-05 ||∇||=3.469338e-01 | Tr=0.1813 Te/Cur=0.2042 Te/Exp=0.2524]100%|██████████| 2/2 [00:16<00:00,  8.33s/it, CE=2.274107e+00 H=2.274071e+00 dV_dx=-2.481944e-06 dV_dθ=-3.415092e-05 ||∇||=3.469338e-01 | Tr=0.1813 Te/Cur=0.2042 Te/Exp=0.2524]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.02s/it] 50%|█████     | 1/2 [00:10<00:08,  8.02s/it, CE=2.278222e+00 H=2.278185e+00 dV_dx=-4.216317e-06 dV_dθ=-3.285395e-05 ||∇||=3.666281e-01 | Tr=0.1171 Te/Cur=0.1278 Te/Exp=0.1913]100%|██████████| 2/2 [00:10<00:00,  4.90s/it, CE=2.278222e+00 H=2.278185e+00 dV_dx=-4.216317e-06 dV_dθ=-3.285395e-05 ||∇||=3.666281e-01 | Tr=0.1171 Te/Cur=0.1278 Te/Exp=0.1913]100%|██████████| 2/2 [00:10<00:00,  5.37s/it, CE=2.278222e+00 H=2.278185e+00 dV_dx=-4.216317e-06 dV_dθ=-3.285395e-05 ||∇||=3.666281e-01 | Tr=0.1171 Te/Cur=0.1278 Te/Exp=0.1913]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.96s/it] 50%|█████     | 1/2 [00:18<00:15, 15.96s/it, CE=2.263659e+00 H=2.263624e+00 dV_dx=-5.356343e-07 dV_dθ=-3.428012e-05 ||∇||=3.542713e-01 | Tr=0.1549 Te/Cur=0.1396 Te/Exp=0.2497]100%|██████████| 2/2 [00:18<00:00,  8.13s/it, CE=2.263659e+00 H=2.263624e+00 dV_dx=-5.356343e-07 dV_dθ=-3.428012e-05 ||∇||=3.542713e-01 | Tr=0.1549 Te/Cur=0.1396 Te/Exp=0.2497]100%|██████████| 2/2 [00:18<00:00,  9.30s/it, CE=2.263659e+00 H=2.263624e+00 dV_dx=-5.356343e-07 dV_dθ=-3.428012e-05 ||∇||=3.542713e-01 | Tr=0.1549 Te/Cur=0.1396 Te/Exp=0.2497]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.85s/it] 50%|█████     | 1/2 [00:17<00:13, 13.85s/it, CE=2.270943e+00 H=2.270878e+00 dV_dx=-1.739038e-05 dV_dθ=-4.791703e-05 ||∇||=3.614745e-01 | Tr=0.1861 Te/Cur=0.2156 Te/Exp=0.2179]100%|██████████| 2/2 [00:17<00:00,  7.60s/it, CE=2.270943e+00 H=2.270878e+00 dV_dx=-1.739038e-05 dV_dθ=-4.791703e-05 ||∇||=3.614745e-01 | Tr=0.1861 Te/Cur=0.2156 Te/Exp=0.2179]100%|██████████| 2/2 [00:17<00:00,  8.54s/it, CE=2.270943e+00 H=2.270878e+00 dV_dx=-1.739038e-05 dV_dθ=-4.791703e-05 ||∇||=3.614745e-01 | Tr=0.1861 Te/Cur=0.2156 Te/Exp=0.2179]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.63s/it] 50%|█████     | 1/2 [00:10<00:07,  7.63s/it, CE=2.272342e+00 H=2.272284e+00 dV_dx=-7.041208e-06 dV_dθ=-5.134732e-05 ||∇||=3.658416e-01 | Tr=0.1307 Te/Cur=0.1758 Te/Exp=0.2164]100%|██████████| 2/2 [00:10<00:00,  5.01s/it, CE=2.272342e+00 H=2.272284e+00 dV_dx=-7.041208e-06 dV_dθ=-5.134732e-05 ||∇||=3.658416e-01 | Tr=0.1307 Te/Cur=0.1758 Te/Exp=0.2164]100%|██████████| 2/2 [00:10<00:00,  5.40s/it, CE=2.272342e+00 H=2.272284e+00 dV_dx=-7.041208e-06 dV_dθ=-5.134732e-05 ||∇||=3.658416e-01 | Tr=0.1307 Te/Cur=0.1758 Te/Exp=0.2164]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.01s/it] 50%|█████     | 1/2 [00:17<00:14, 14.01s/it, CE=2.270632e+00 H=2.270582e+00 dV_dx=1.022945e-05 dV_dθ=-6.042973e-05 ||∇||=3.105994e-01 | Tr=0.1292 Te/Cur=0.1388 Te/Exp=0.2711]100%|██████████| 2/2 [00:17<00:00,  7.66s/it, CE=2.270632e+00 H=2.270582e+00 dV_dx=1.022945e-05 dV_dθ=-6.042973e-05 ||∇||=3.105994e-01 | Tr=0.1292 Te/Cur=0.1388 Te/Exp=0.2711]100%|██████████| 2/2 [00:17<00:00,  8.61s/it, CE=2.270632e+00 H=2.270582e+00 dV_dx=1.022945e-05 dV_dθ=-6.042973e-05 ||∇||=3.105994e-01 | Tr=0.1292 Te/Cur=0.1388 Te/Exp=0.2711]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.44s/it] 50%|█████     | 1/2 [00:16<00:13, 13.44s/it, CE=2.268095e+00 H=2.268058e+00 dV_dx=1.069265e-05 dV_dθ=-4.724571e-05 ||∇||=3.356794e-01 | Tr=0.1206 Te/Cur=0.1432 Te/Exp=0.3104]100%|██████████| 2/2 [00:16<00:00,  7.12s/it, CE=2.268095e+00 H=2.268058e+00 dV_dx=1.069265e-05 dV_dθ=-4.724571e-05 ||∇||=3.356794e-01 | Tr=0.1206 Te/Cur=0.1432 Te/Exp=0.3104]100%|██████████| 2/2 [00:16<00:00,  8.06s/it, CE=2.268095e+00 H=2.268058e+00 dV_dx=1.069265e-05 dV_dθ=-4.724571e-05 ||∇||=3.356794e-01 | Tr=0.1206 Te/Cur=0.1432 Te/Exp=0.3104]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.54s/it] 50%|█████     | 1/2 [00:19<00:16, 16.54s/it, CE=2.262080e+00 H=2.262008e+00 dV_dx=-5.821189e-06 dV_dθ=-6.600291e-05 ||∇||=3.461640e-01 | Tr=0.1194 Te/Cur=0.1357 Te/Exp=0.2375]100%|██████████| 2/2 [00:19<00:00,  8.39s/it, CE=2.262080e+00 H=2.262008e+00 dV_dx=-5.821189e-06 dV_dθ=-6.600291e-05 ||∇||=3.461640e-01 | Tr=0.1194 Te/Cur=0.1357 Te/Exp=0.2375]100%|██████████| 2/2 [00:19<00:00,  9.61s/it, CE=2.262080e+00 H=2.262008e+00 dV_dx=-5.821189e-06 dV_dθ=-6.600291e-05 ||∇||=3.461640e-01 | Tr=0.1194 Te/Cur=0.1357 Te/Exp=0.2375]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.50s/it] 50%|█████     | 1/2 [00:10<00:07,  7.50s/it, CE=2.264039e+00 H=2.264017e+00 dV_dx=2.080716e-05 dV_dθ=-4.274099e-05 ||∇||=3.076408e-01 | Tr=0.1185 Te/Cur=0.1202 Te/Exp=0.2714]100%|██████████| 2/2 [00:10<00:00,  4.80s/it, CE=2.264039e+00 H=2.264017e+00 dV_dx=2.080716e-05 dV_dθ=-4.274099e-05 ||∇||=3.076408e-01 | Tr=0.1185 Te/Cur=0.1202 Te/Exp=0.2714]100%|██████████| 2/2 [00:10<00:00,  5.21s/it, CE=2.264039e+00 H=2.264017e+00 dV_dx=2.080716e-05 dV_dθ=-4.274099e-05 ||∇||=3.076408e-01 | Tr=0.1185 Te/Cur=0.1202 Te/Exp=0.2714]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.06s/it] 50%|█████     | 1/2 [00:17<00:14, 14.06s/it, CE=2.280353e+00 H=2.280299e+00 dV_dx=1.547510e-05 dV_dθ=-6.938263e-05 ||∇||=3.477672e-01 | Tr=0.1000 Te/Cur=0.1234 Te/Exp=0.2315]100%|██████████| 2/2 [00:17<00:00,  7.53s/it, CE=2.280353e+00 H=2.280299e+00 dV_dx=1.547510e-05 dV_dθ=-6.938263e-05 ||∇||=3.477672e-01 | Tr=0.1000 Te/Cur=0.1234 Te/Exp=0.2315]100%|██████████| 2/2 [00:17<00:00,  8.51s/it, CE=2.280353e+00 H=2.280299e+00 dV_dx=1.547510e-05 dV_dθ=-6.938263e-05 ||∇||=3.477672e-01 | Tr=0.1000 Te/Cur=0.1234 Te/Exp=0.2315]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.07s/it] 50%|█████     | 1/2 [00:10<00:08,  8.07s/it, CE=2.276768e+00 H=2.276681e+00 dV_dx=3.746463e-06 dV_dθ=-9.030669e-05 ||∇||=3.752884e-01 | Tr=0.1075 Te/Cur=0.1372 Te/Exp=0.2240]100%|██████████| 2/2 [00:10<00:00,  5.02s/it, CE=2.276768e+00 H=2.276681e+00 dV_dx=3.746463e-06 dV_dθ=-9.030669e-05 ||∇||=3.752884e-01 | Tr=0.1075 Te/Cur=0.1372 Te/Exp=0.2240]100%|██████████| 2/2 [00:10<00:00,  5.48s/it, CE=2.276768e+00 H=2.276681e+00 dV_dx=3.746463e-06 dV_dθ=-9.030669e-05 ||∇||=3.752884e-01 | Tr=0.1075 Te/Cur=0.1372 Te/Exp=0.2240]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.57s/it] 50%|█████     | 1/2 [00:16<00:13, 13.57s/it, CE=2.277457e+00 H=2.277414e+00 dV_dx=1.329855e-07 dV_dθ=-4.347561e-05 ||∇||=3.367047e-01 | Tr=0.1674 Te/Cur=0.1845 Te/Exp=0.1880]100%|██████████| 2/2 [00:16<00:00,  7.36s/it, CE=2.277457e+00 H=2.277414e+00 dV_dx=1.329855e-07 dV_dθ=-4.347561e-05 ||∇||=3.367047e-01 | Tr=0.1674 Te/Cur=0.1845 Te/Exp=0.1880]100%|██████████| 2/2 [00:16<00:00,  8.29s/it, CE=2.277457e+00 H=2.277414e+00 dV_dx=1.329855e-07 dV_dθ=-4.347561e-05 ||∇||=3.367047e-01 | Tr=0.1674 Te/Cur=0.1845 Te/Exp=0.1880]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.63s/it] 50%|█████     | 1/2 [00:19<00:13, 13.63s/it, CE=2.275126e+00 H=2.275072e+00 dV_dx=6.583518e-06 dV_dθ=-6.095900e-05 ||∇||=3.502614e-01 | Tr=0.0961 Te/Cur=0.0946 Te/Exp=0.1471]100%|██████████| 2/2 [00:19<00:00,  9.03s/it, CE=2.275126e+00 H=2.275072e+00 dV_dx=6.583518e-06 dV_dθ=-6.095900e-05 ||∇||=3.502614e-01 | Tr=0.0961 Te/Cur=0.0946 Te/Exp=0.1471]100%|██████████| 2/2 [00:19<00:00,  9.72s/it, CE=2.275126e+00 H=2.275072e+00 dV_dx=6.583518e-06 dV_dθ=-6.095900e-05 ||∇||=3.502614e-01 | Tr=0.0961 Te/Cur=0.0946 Te/Exp=0.1471]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.12s/it] 50%|█████     | 1/2 [00:11<00:08,  8.12s/it, CE=2.243970e+00 H=2.243873e+00 dV_dx=-1.455193e-05 dV_dθ=-8.233606e-05 ||∇||=5.339675e-01 | Tr=0.1329 Te/Cur=0.1404 Te/Exp=0.2341]100%|██████████| 2/2 [00:11<00:00,  5.07s/it, CE=2.243970e+00 H=2.243873e+00 dV_dx=-1.455193e-05 dV_dθ=-8.233606e-05 ||∇||=5.339675e-01 | Tr=0.1329 Te/Cur=0.1404 Te/Exp=0.2341]100%|██████████| 2/2 [00:11<00:00,  5.53s/it, CE=2.243970e+00 H=2.243873e+00 dV_dx=-1.455193e-05 dV_dθ=-8.233606e-05 ||∇||=5.339675e-01 | Tr=0.1329 Te/Cur=0.1404 Te/Exp=0.2341]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.243969805897108
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.09s/it] 50%|█████     | 1/2 [00:16<00:14, 14.09s/it, CE=2.236758e+00 H=2.236736e+00 dV_dx=1.707986e-05 dV_dθ=-3.924415e-05 ||∇||=5.007276e-01 | Tr=0.1309 Te/Cur=0.1394 Te/Exp=0.3100]100%|██████████| 2/2 [00:16<00:00,  7.46s/it, CE=2.236758e+00 H=2.236736e+00 dV_dx=1.707986e-05 dV_dθ=-3.924415e-05 ||∇||=5.007276e-01 | Tr=0.1309 Te/Cur=0.1394 Te/Exp=0.3100]100%|██████████| 2/2 [00:16<00:00,  8.45s/it, CE=2.236758e+00 H=2.236736e+00 dV_dx=1.707986e-05 dV_dθ=-3.924415e-05 ||∇||=5.007276e-01 | Tr=0.1309 Te/Cur=0.1394 Te/Exp=0.3100]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 104, 10]) with loss 2.236758
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.15s/it] 50%|█████     | 1/2 [00:17<00:14, 14.15s/it, CE=2.236701e+00 H=2.236669e+00 dV_dx=-3.910612e-06 dV_dθ=-2.867071e-05 ||∇||=4.966382e-01 | Tr=0.0928 Te/Cur=0.0740 Te/Exp=0.2747]100%|██████████| 2/2 [00:17<00:00,  7.74s/it, CE=2.236701e+00 H=2.236669e+00 dV_dx=-3.910612e-06 dV_dθ=-2.867071e-05 ||∇||=4.966382e-01 | Tr=0.0928 Te/Cur=0.0740 Te/Exp=0.2747]100%|██████████| 2/2 [00:17<00:00,  8.70s/it, CE=2.236701e+00 H=2.236669e+00 dV_dx=-3.910612e-06 dV_dθ=-2.867071e-05 ||∇||=4.966382e-01 | Tr=0.0928 Te/Cur=0.0740 Te/Exp=0.2747]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 672, 104, 10]) with loss 2.236701
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.59s/it] 50%|█████     | 1/2 [00:07<00:04,  4.59s/it, CE=2.244261e+00 H=2.244154e+00 dV_dx=3.605168e-06 dV_dθ=-1.106160e-04 ||∇||=5.545421e-01 | Tr=0.1503 Te/Cur=0.1713 Te/Exp=0.2897]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.244261e+00 H=2.244154e+00 dV_dx=3.605168e-06 dV_dθ=-1.106160e-04 ||∇||=5.545421e-01 | Tr=0.1503 Te/Cur=0.1713 Te/Exp=0.2897]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.244261e+00 H=2.244154e+00 dV_dx=3.605168e-06 dV_dθ=-1.106160e-04 ||∇||=5.545421e-01 | Tr=0.1503 Te/Cur=0.1713 Te/Exp=0.2897]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.83s/it] 50%|█████     | 1/2 [00:07<00:04,  4.83s/it, CE=2.215193e+00 H=2.215157e+00 dV_dx=1.646616e-05 dV_dθ=-5.160900e-05 ||∇||=5.021248e-01 | Tr=0.1318 Te/Cur=0.1393 Te/Exp=0.3154]100%|██████████| 2/2 [00:07<00:00,  3.75s/it, CE=2.215193e+00 H=2.215157e+00 dV_dx=1.646616e-05 dV_dθ=-5.160900e-05 ||∇||=5.021248e-01 | Tr=0.1318 Te/Cur=0.1393 Te/Exp=0.3154]100%|██████████| 2/2 [00:07<00:00,  3.91s/it, CE=2.215193e+00 H=2.215157e+00 dV_dx=1.646616e-05 dV_dθ=-5.160900e-05 ||∇||=5.021248e-01 | Tr=0.1318 Te/Cur=0.1393 Te/Exp=0.3154]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.215193
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.71s/it] 50%|█████     | 1/2 [00:19<00:16, 16.71s/it, CE=2.224452e+00 H=2.224371e+00 dV_dx=2.890355e-06 dV_dθ=-8.485238e-05 ||∇||=5.350828e-01 | Tr=0.1096 Te/Cur=0.1148 Te/Exp=0.2795]100%|██████████| 2/2 [00:19<00:00,  8.66s/it, CE=2.224452e+00 H=2.224371e+00 dV_dx=2.890355e-06 dV_dθ=-8.485238e-05 ||∇||=5.350828e-01 | Tr=0.1096 Te/Cur=0.1148 Te/Exp=0.2795]100%|██████████| 2/2 [00:19<00:00,  9.87s/it, CE=2.224452e+00 H=2.224371e+00 dV_dx=2.890355e-06 dV_dθ=-8.485238e-05 ||∇||=5.350828e-01 | Tr=0.1096 Te/Cur=0.1148 Te/Exp=0.2795]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.32s/it] 50%|█████     | 1/2 [00:07<00:05,  5.32s/it, CE=2.252750e+00 H=2.252699e+00 dV_dx=1.517967e-05 dV_dθ=-6.641893e-05 ||∇||=5.326424e-01 | Tr=0.1068 Te/Cur=0.1025 Te/Exp=0.2888]100%|██████████| 2/2 [00:07<00:00,  3.76s/it, CE=2.252750e+00 H=2.252699e+00 dV_dx=1.517967e-05 dV_dθ=-6.641893e-05 ||∇||=5.326424e-01 | Tr=0.1068 Te/Cur=0.1025 Te/Exp=0.2888]100%|██████████| 2/2 [00:07<00:00,  3.99s/it, CE=2.252750e+00 H=2.252699e+00 dV_dx=1.517967e-05 dV_dθ=-6.641893e-05 ||∇||=5.326424e-01 | Tr=0.1068 Te/Cur=0.1025 Te/Exp=0.2888]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.63s/it] 50%|█████     | 1/2 [00:07<00:04,  4.63s/it, CE=2.229191e+00 H=2.229144e+00 dV_dx=-1.866239e-06 dV_dθ=-4.513577e-05 ||∇||=5.214373e-01 | Tr=0.1092 Te/Cur=0.1378 Te/Exp=0.2920]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.229191e+00 H=2.229144e+00 dV_dx=-1.866239e-06 dV_dθ=-4.513577e-05 ||∇||=5.214373e-01 | Tr=0.1092 Te/Cur=0.1378 Te/Exp=0.2920]100%|██████████| 2/2 [00:07<00:00,  3.79s/it, CE=2.229191e+00 H=2.229144e+00 dV_dx=-1.866239e-06 dV_dθ=-4.513577e-05 ||∇||=5.214373e-01 | Tr=0.1092 Te/Cur=0.1378 Te/Exp=0.2920]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.51s/it] 50%|█████     | 1/2 [00:16<00:13, 13.51s/it, CE=2.218164e+00 H=2.218106e+00 dV_dx=9.712848e-06 dV_dθ=-6.850612e-05 ||∇||=5.245234e-01 | Tr=0.1725 Te/Cur=0.1829 Te/Exp=0.3328]100%|██████████| 2/2 [00:16<00:00,  7.12s/it, CE=2.218164e+00 H=2.218106e+00 dV_dx=9.712848e-06 dV_dθ=-6.850612e-05 ||∇||=5.245234e-01 | Tr=0.1725 Te/Cur=0.1829 Te/Exp=0.3328]100%|██████████| 2/2 [00:16<00:00,  8.08s/it, CE=2.218164e+00 H=2.218106e+00 dV_dx=9.712848e-06 dV_dθ=-6.850612e-05 ||∇||=5.245234e-01 | Tr=0.1725 Te/Cur=0.1829 Te/Exp=0.3328]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.03s/it] 50%|█████     | 1/2 [00:10<00:08,  8.03s/it, CE=2.277786e+00 H=2.277738e+00 dV_dx=1.033238e-05 dV_dθ=-5.786665e-05 ||∇||=3.381952e-01 | Tr=0.1076 Te/Cur=0.1148 Te/Exp=0.1862]100%|██████████| 2/2 [00:10<00:00,  5.00s/it, CE=2.277786e+00 H=2.277738e+00 dV_dx=1.033238e-05 dV_dθ=-5.786665e-05 ||∇||=3.381952e-01 | Tr=0.1076 Te/Cur=0.1148 Te/Exp=0.1862]100%|██████████| 2/2 [00:10<00:00,  5.46s/it, CE=2.277786e+00 H=2.277738e+00 dV_dx=1.033238e-05 dV_dθ=-5.786665e-05 ||∇||=3.381952e-01 | Tr=0.1076 Te/Cur=0.1148 Te/Exp=0.1862]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.11s/it] 50%|█████     | 1/2 [00:15<00:13, 13.11s/it, CE=2.278454e+00 H=2.278376e+00 dV_dx=-1.198460e-05 dV_dθ=-6.603570e-05 ||∇||=3.167904e-01 | Tr=0.1395 Te/Cur=0.1415 Te/Exp=0.1736]100%|██████████| 2/2 [00:15<00:00,  7.08s/it, CE=2.278454e+00 H=2.278376e+00 dV_dx=-1.198460e-05 dV_dθ=-6.603570e-05 ||∇||=3.167904e-01 | Tr=0.1395 Te/Cur=0.1415 Te/Exp=0.1736]100%|██████████| 2/2 [00:15<00:00,  7.98s/it, CE=2.278454e+00 H=2.278376e+00 dV_dx=-1.198460e-05 dV_dθ=-6.603570e-05 ||∇||=3.167904e-01 | Tr=0.1395 Te/Cur=0.1415 Te/Exp=0.1736]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.43s/it] 50%|█████     | 1/2 [00:19<00:16, 16.43s/it, CE=2.280100e+00 H=2.280024e+00 dV_dx=-1.397326e-05 dV_dθ=-6.158094e-05 ||∇||=3.270460e-01 | Tr=0.1069 Te/Cur=0.1210 Te/Exp=0.1655]100%|██████████| 2/2 [00:19<00:00,  8.55s/it, CE=2.280100e+00 H=2.280024e+00 dV_dx=-1.397326e-05 dV_dθ=-6.158094e-05 ||∇||=3.270460e-01 | Tr=0.1069 Te/Cur=0.1210 Te/Exp=0.1655]100%|██████████| 2/2 [00:19<00:00,  9.73s/it, CE=2.280100e+00 H=2.280024e+00 dV_dx=-1.397326e-05 dV_dθ=-6.158094e-05 ||∇||=3.270460e-01 | Tr=0.1069 Te/Cur=0.1210 Te/Exp=0.1655]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.06s/it] 50%|█████     | 1/2 [00:07<00:05,  5.06s/it, CE=2.286370e+00 H=2.286310e+00 dV_dx=-2.101583e-06 dV_dθ=-5.740262e-05 ||∇||=3.764022e-01 | Tr=0.0707 Te/Cur=0.0992 Te/Exp=0.1818]100%|██████████| 2/2 [00:07<00:00,  3.79s/it, CE=2.286370e+00 H=2.286310e+00 dV_dx=-2.101583e-06 dV_dθ=-5.740262e-05 ||∇||=3.764022e-01 | Tr=0.0707 Te/Cur=0.0992 Te/Exp=0.1818]100%|██████████| 2/2 [00:07<00:00,  3.98s/it, CE=2.286370e+00 H=2.286310e+00 dV_dx=-2.101583e-06 dV_dθ=-5.740262e-05 ||∇||=3.764022e-01 | Tr=0.0707 Te/Cur=0.0992 Te/Exp=0.1818]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.72s/it] 50%|█████     | 1/2 [00:07<00:04,  4.72s/it, CE=2.271343e+00 H=2.271279e+00 dV_dx=3.497172e-06 dV_dθ=-6.702011e-05 ||∇||=3.577270e-01 | Tr=0.1190 Te/Cur=0.1404 Te/Exp=0.2105]100%|██████████| 2/2 [00:07<00:00,  3.43s/it, CE=2.271343e+00 H=2.271279e+00 dV_dx=3.497172e-06 dV_dθ=-6.702011e-05 ||∇||=3.577270e-01 | Tr=0.1190 Te/Cur=0.1404 Te/Exp=0.2105]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.271343e+00 H=2.271279e+00 dV_dx=3.497172e-06 dV_dθ=-6.702011e-05 ||∇||=3.577270e-01 | Tr=0.1190 Te/Cur=0.1404 Te/Exp=0.2105]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.74s/it] 50%|█████     | 1/2 [00:16<00:13, 13.74s/it, CE=2.272678e+00 H=2.272604e+00 dV_dx=-1.016956e-05 dV_dθ=-6.323871e-05 ||∇||=3.680836e-01 | Tr=0.1213 Te/Cur=0.1411 Te/Exp=0.1939]100%|██████████| 2/2 [00:16<00:00,  7.51s/it, CE=2.272678e+00 H=2.272604e+00 dV_dx=-1.016956e-05 dV_dθ=-6.323871e-05 ||∇||=3.680836e-01 | Tr=0.1213 Te/Cur=0.1411 Te/Exp=0.1939]100%|██████████| 2/2 [00:16<00:00,  8.44s/it, CE=2.272678e+00 H=2.272604e+00 dV_dx=-1.016956e-05 dV_dθ=-6.323871e-05 ||∇||=3.680836e-01 | Tr=0.1213 Te/Cur=0.1411 Te/Exp=0.1939]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.90s/it] 50%|█████     | 1/2 [00:08<00:04,  4.90s/it, CE=2.280059e+00 H=2.280013e+00 dV_dx=1.033503e-05 dV_dθ=-5.652008e-05 ||∇||=3.807984e-01 | Tr=0.1207 Te/Cur=0.1790 Te/Exp=0.1875]100%|██████████| 2/2 [00:08<00:00,  3.84s/it, CE=2.280059e+00 H=2.280013e+00 dV_dx=1.033503e-05 dV_dθ=-5.652008e-05 ||∇||=3.807984e-01 | Tr=0.1207 Te/Cur=0.1790 Te/Exp=0.1875]100%|██████████| 2/2 [00:08<00:00,  4.00s/it, CE=2.280059e+00 H=2.280013e+00 dV_dx=1.033503e-05 dV_dθ=-5.652008e-05 ||∇||=3.807984e-01 | Tr=0.1207 Te/Cur=0.1790 Te/Exp=0.1875]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.84s/it] 50%|█████     | 1/2 [00:07<00:04,  4.84s/it, CE=2.275112e+00 H=2.275045e+00 dV_dx=-8.949904e-06 dV_dθ=-5.752368e-05 ||∇||=3.271103e-01 | Tr=0.1160 Te/Cur=0.1314 Te/Exp=0.2568]100%|██████████| 2/2 [00:07<00:00,  3.34s/it, CE=2.275112e+00 H=2.275045e+00 dV_dx=-8.949904e-06 dV_dθ=-5.752368e-05 ||∇||=3.271103e-01 | Tr=0.1160 Te/Cur=0.1314 Te/Exp=0.2568]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.275112e+00 H=2.275045e+00 dV_dx=-8.949904e-06 dV_dθ=-5.752368e-05 ||∇||=3.271103e-01 | Tr=0.1160 Te/Cur=0.1314 Te/Exp=0.2568]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:15<00:15, 15.77s/it] 50%|█████     | 1/2 [00:18<00:15, 15.77s/it, CE=2.282224e+00 H=2.282141e+00 dV_dx=-1.088961e-05 dV_dθ=-7.293556e-05 ||∇||=3.981487e-01 | Tr=0.1130 Te/Cur=0.1337 Te/Exp=0.2147]100%|██████████| 2/2 [00:18<00:00,  8.09s/it, CE=2.282224e+00 H=2.282141e+00 dV_dx=-1.088961e-05 dV_dθ=-7.293556e-05 ||∇||=3.981487e-01 | Tr=0.1130 Te/Cur=0.1337 Te/Exp=0.2147]100%|██████████| 2/2 [00:18<00:00,  9.24s/it, CE=2.282224e+00 H=2.282141e+00 dV_dx=-1.088961e-05 dV_dθ=-7.293556e-05 ||∇||=3.981487e-01 | Tr=0.1130 Te/Cur=0.1337 Te/Exp=0.2147]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.63s/it] 50%|█████     | 1/2 [00:10<00:07,  7.63s/it, CE=2.271888e+00 H=2.271800e+00 dV_dx=-9.794191e-06 dV_dθ=-7.829308e-05 ||∇||=4.273589e-01 | Tr=0.0988 Te/Cur=0.0942 Te/Exp=0.2251]100%|██████████| 2/2 [00:10<00:00,  4.82s/it, CE=2.271888e+00 H=2.271800e+00 dV_dx=-9.794191e-06 dV_dθ=-7.829308e-05 ||∇||=4.273589e-01 | Tr=0.0988 Te/Cur=0.0942 Te/Exp=0.2251]100%|██████████| 2/2 [00:10<00:00,  5.24s/it, CE=2.271888e+00 H=2.271800e+00 dV_dx=-9.794191e-06 dV_dθ=-7.829308e-05 ||∇||=4.273589e-01 | Tr=0.0988 Te/Cur=0.0942 Te/Exp=0.2251]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.38s/it] 50%|█████     | 1/2 [00:16<00:13, 13.38s/it, CE=2.266021e+00 H=2.265903e+00 dV_dx=-1.412645e-05 dV_dθ=-1.037713e-04 ||∇||=4.176270e-01 | Tr=0.1293 Te/Cur=0.1465 Te/Exp=0.2279]100%|██████████| 2/2 [00:16<00:00,  7.16s/it, CE=2.266021e+00 H=2.265903e+00 dV_dx=-1.412645e-05 dV_dθ=-1.037713e-04 ||∇||=4.176270e-01 | Tr=0.1293 Te/Cur=0.1465 Te/Exp=0.2279]100%|██████████| 2/2 [00:16<00:00,  8.10s/it, CE=2.266021e+00 H=2.265903e+00 dV_dx=-1.412645e-05 dV_dθ=-1.037713e-04 ||∇||=4.176270e-01 | Tr=0.1293 Te/Cur=0.1465 Te/Exp=0.2279]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.68s/it] 50%|█████     | 1/2 [00:16<00:13, 13.68s/it, CE=2.266018e+00 H=2.265977e+00 dV_dx=8.282684e-06 dV_dθ=-4.928592e-05 ||∇||=3.988015e-01 | Tr=0.0630 Te/Cur=0.0541 Te/Exp=0.1900]100%|██████████| 2/2 [00:16<00:00,  7.17s/it, CE=2.266018e+00 H=2.265977e+00 dV_dx=8.282684e-06 dV_dθ=-4.928592e-05 ||∇||=3.988015e-01 | Tr=0.0630 Te/Cur=0.0541 Te/Exp=0.1900]100%|██████████| 2/2 [00:16<00:00,  8.15s/it, CE=2.266018e+00 H=2.265977e+00 dV_dx=8.282684e-06 dV_dθ=-4.928592e-05 ||∇||=3.988015e-01 | Tr=0.0630 Te/Cur=0.0541 Te/Exp=0.1900]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.48s/it] 50%|█████     | 1/2 [00:07<00:04,  4.48s/it, CE=2.262181e+00 H=2.262123e+00 dV_dx=1.070794e-05 dV_dθ=-6.897029e-05 ||∇||=4.007307e-01 | Tr=0.0828 Te/Cur=0.0940 Te/Exp=0.2131]100%|██████████| 2/2 [00:07<00:00,  3.67s/it, CE=2.262181e+00 H=2.262123e+00 dV_dx=1.070794e-05 dV_dθ=-6.897029e-05 ||∇||=4.007307e-01 | Tr=0.0828 Te/Cur=0.0940 Te/Exp=0.2131]100%|██████████| 2/2 [00:07<00:00,  3.79s/it, CE=2.262181e+00 H=2.262123e+00 dV_dx=1.070794e-05 dV_dθ=-6.897029e-05 ||∇||=4.007307e-01 | Tr=0.0828 Te/Cur=0.0940 Te/Exp=0.2131]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.98s/it] 50%|█████     | 1/2 [00:07<00:04,  4.98s/it, CE=2.259657e+00 H=2.259566e+00 dV_dx=6.702598e-06 dV_dθ=-9.777738e-05 ||∇||=4.438956e-01 | Tr=0.0889 Te/Cur=0.0998 Te/Exp=0.2257]100%|██████████| 2/2 [00:07<00:00,  3.72s/it, CE=2.259657e+00 H=2.259566e+00 dV_dx=6.702598e-06 dV_dθ=-9.777738e-05 ||∇||=4.438956e-01 | Tr=0.0889 Te/Cur=0.0998 Te/Exp=0.2257]100%|██████████| 2/2 [00:07<00:00,  3.91s/it, CE=2.259657e+00 H=2.259566e+00 dV_dx=6.702598e-06 dV_dθ=-9.777738e-05 ||∇||=4.438956e-01 | Tr=0.0889 Te/Cur=0.0998 Te/Exp=0.2257]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:16<00:16, 16.27s/it] 50%|█████     | 1/2 [00:19<00:16, 16.27s/it, CE=2.263278e+00 H=2.263218e+00 dV_dx=-2.450678e-06 dV_dθ=-5.756590e-05 ||∇||=4.133996e-01 | Tr=0.0891 Te/Cur=0.0837 Te/Exp=0.2081]100%|██████████| 2/2 [00:19<00:00,  8.47s/it, CE=2.263278e+00 H=2.263218e+00 dV_dx=-2.450678e-06 dV_dθ=-5.756590e-05 ||∇||=4.133996e-01 | Tr=0.0891 Te/Cur=0.0837 Te/Exp=0.2081]100%|██████████| 2/2 [00:19<00:00,  9.64s/it, CE=2.263278e+00 H=2.263218e+00 dV_dx=-2.450678e-06 dV_dθ=-5.756590e-05 ||∇||=4.133996e-01 | Tr=0.0891 Te/Cur=0.0837 Te/Exp=0.2081]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.07s/it] 50%|█████     | 1/2 [00:08<00:05,  5.07s/it, CE=2.266372e+00 H=2.266288e+00 dV_dx=8.406612e-06 dV_dθ=-9.158200e-05 ||∇||=4.249321e-01 | Tr=0.1138 Te/Cur=0.1085 Te/Exp=0.2589]100%|██████████| 2/2 [00:08<00:00,  4.04s/it, CE=2.266372e+00 H=2.266288e+00 dV_dx=8.406612e-06 dV_dθ=-9.158200e-05 ||∇||=4.249321e-01 | Tr=0.1138 Te/Cur=0.1085 Te/Exp=0.2589]100%|██████████| 2/2 [00:08<00:00,  4.19s/it, CE=2.266372e+00 H=2.266288e+00 dV_dx=8.406612e-06 dV_dθ=-9.158200e-05 ||∇||=4.249321e-01 | Tr=0.1138 Te/Cur=0.1085 Te/Exp=0.2589]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.92s/it] 50%|█████     | 1/2 [00:07<00:04,  4.92s/it, CE=2.278304e+00 H=2.278227e+00 dV_dx=-2.752475e-06 dV_dθ=-7.507379e-05 ||∇||=4.226720e-01 | Tr=0.1189 Te/Cur=0.1194 Te/Exp=0.2432]100%|██████████| 2/2 [00:07<00:00,  3.77s/it, CE=2.278304e+00 H=2.278227e+00 dV_dx=-2.752475e-06 dV_dθ=-7.507379e-05 ||∇||=4.226720e-01 | Tr=0.1189 Te/Cur=0.1194 Te/Exp=0.2432]100%|██████████| 2/2 [00:07<00:00,  3.94s/it, CE=2.278304e+00 H=2.278227e+00 dV_dx=-2.752475e-06 dV_dθ=-7.507379e-05 ||∇||=4.226720e-01 | Tr=0.1189 Te/Cur=0.1194 Te/Exp=0.2432]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.72s/it] 50%|█████     | 1/2 [00:16<00:13, 13.72s/it, CE=2.261177e+00 H=2.261100e+00 dV_dx=5.383542e-06 dV_dθ=-8.309087e-05 ||∇||=4.460938e-01 | Tr=0.0602 Te/Cur=0.0744 Te/Exp=0.2726]100%|██████████| 2/2 [00:16<00:00,  7.40s/it, CE=2.261177e+00 H=2.261100e+00 dV_dx=5.383542e-06 dV_dθ=-8.309087e-05 ||∇||=4.460938e-01 | Tr=0.0602 Te/Cur=0.0744 Te/Exp=0.2726]100%|██████████| 2/2 [00:16<00:00,  8.35s/it, CE=2.261177e+00 H=2.261100e+00 dV_dx=5.383542e-06 dV_dθ=-8.309087e-05 ||∇||=4.460938e-01 | Tr=0.0602 Te/Cur=0.0744 Te/Exp=0.2726]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 632, 144, 10]) with loss 2.215193
  Total candidates evaluated: 54
  Original: (4, [432, 612, 164, 10])
  Optimal: (2, [507, 632, 144, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 4→2, feed [432, 612, 164, 10]→[507, 632, 144, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 4)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:21<06:39, 21.03s/it]  5%|▌         | 1/20 [00:25<06:39, 21.03s/it, CE=1.909405e+00 H=1.899945e+00 dV_dx=-1.613949e-05 dV_dθ=-9.444291e-03 ||∇||=5.543290e+00 | Tr=0.7650] 10%|█         | 2/20 [00:25<03:20, 11.15s/it, CE=1.909405e+00 H=1.899945e+00 dV_dx=-1.613949e-05 dV_dθ=-9.444291e-03 ||∇||=5.543290e+00 | Tr=0.7650] 10%|█         | 2/20 [00:29<03:20, 11.15s/it, CE=1.621883e+00 H=1.619175e+00 dV_dx=4.461624e-05 dV_dθ=-2.752327e-03 ||∇||=4.068541e+00 | Tr=0.7650]  15%|█▌        | 3/20 [00:29<02:17,  8.10s/it, CE=1.621883e+00 H=1.619175e+00 dV_dx=4.461624e-05 dV_dθ=-2.752327e-03 ||∇||=4.068541e+00 | Tr=0.7650] 15%|█▌        | 3/20 [00:34<02:17,  8.10s/it, CE=1.419535e+00 H=1.412099e+00 dV_dx=8.121741e-05 dV_dθ=-7.516924e-03 ||∇||=4.598515e+00 | Tr=0.7650] 20%|██        | 4/20 [00:34<01:47,  6.74s/it, CE=1.419535e+00 H=1.412099e+00 dV_dx=8.121741e-05 dV_dθ=-7.516924e-03 ||∇||=4.598515e+00 | Tr=0.7650] 20%|██        | 4/20 [00:38<01:47,  6.74s/it, CE=1.271418e+00 H=1.256734e+00 dV_dx=-2.124616e-05 dV_dθ=-1.466311e-02 ||∇||=5.146469e+00 | Tr=0.7650] 25%|██▌       | 5/20 [00:38<01:28,  5.89s/it, CE=1.271418e+00 H=1.256734e+00 dV_dx=-2.124616e-05 dV_dθ=-1.466311e-02 ||∇||=5.146469e+00 | Tr=0.7650] 25%|██▌       | 5/20 [00:43<01:28,  5.89s/it, CE=1.160037e+00 H=1.142964e+00 dV_dx=-4.981285e-05 dV_dθ=-1.702295e-02 ||∇||=5.293403e+00 | Tr=0.7650] 30%|███       | 6/20 [00:43<01:15,  5.41s/it, CE=1.160037e+00 H=1.142964e+00 dV_dx=-4.981285e-05 dV_dθ=-1.702295e-02 ||∇||=5.293403e+00 | Tr=0.7650] 30%|███       | 6/20 [00:47<01:15,  5.41s/it, CE=1.076617e+00 H=1.058092e+00 dV_dx=4.395923e-05 dV_dθ=-1.856866e-02 ||∇||=5.543639e+00 | Tr=0.7650]  35%|███▌      | 7/20 [00:47<01:06,  5.10s/it, CE=1.076617e+00 H=1.058092e+00 dV_dx=4.395923e-05 dV_dθ=-1.856866e-02 ||∇||=5.543639e+00 | Tr=0.7650] 35%|███▌      | 7/20 [00:52<01:06,  5.10s/it, CE=1.009351e+00 H=9.906097e-01 dV_dx=4.639558e-05 dV_dθ=-1.878774e-02 ||∇||=5.562534e+00 | Tr=0.7650] 40%|████      | 8/20 [00:52<00:59,  4.93s/it, CE=1.009351e+00 H=9.906097e-01 dV_dx=4.639558e-05 dV_dθ=-1.878774e-02 ||∇||=5.562534e+00 | Tr=0.7650] 40%|████      | 8/20 [00:56<00:59,  4.93s/it, CE=9.553413e-01 H=9.369761e-01 dV_dx=-1.016124e-04 dV_dθ=-1.826355e-02 ||∇||=5.550410e+00 | Tr=0.7650] 45%|████▌     | 9/20 [00:56<00:53,  4.84s/it, CE=9.553413e-01 H=9.369761e-01 dV_dx=-1.016124e-04 dV_dθ=-1.826355e-02 ||∇||=5.550410e+00 | Tr=0.7650] 45%|████▌     | 9/20 [01:02<00:53,  4.84s/it, CE=9.111082e-01 H=8.930710e-01 dV_dx=-3.737317e-06 dV_dθ=-1.803351e-02 ||∇||=5.502216e+00 | Tr=0.7650] 50%|█████     | 10/20 [01:02<00:50,  5.02s/it, CE=9.111082e-01 H=8.930710e-01 dV_dx=-3.737317e-06 dV_dθ=-1.803351e-02 ||∇||=5.502216e+00 | Tr=0.7650] 50%|█████     | 10/20 [01:06<00:50,  5.02s/it, CE=8.748347e-01 H=8.574140e-01 dV_dx=1.634623e-05 dV_dθ=-1.743702e-02 ||∇||=5.489993e+00 | Tr=0.7650]  55%|█████▌    | 11/20 [01:06<00:44,  4.90s/it, CE=8.748347e-01 H=8.574140e-01 dV_dx=1.634623e-05 dV_dθ=-1.743702e-02 ||∇||=5.489993e+00 | Tr=0.7650] 55%|█████▌    | 11/20 [01:11<00:44,  4.90s/it, CE=8.445385e-01 H=8.273975e-01 dV_dx=-3.294080e-05 dV_dθ=-1.710806e-02 ||∇||=5.540265e+00 | Tr=0.7650] 60%|██████    | 12/20 [01:11<00:37,  4.70s/it, CE=8.445385e-01 H=8.273975e-01 dV_dx=-3.294080e-05 dV_dθ=-1.710806e-02 ||∇||=5.540265e+00 | Tr=0.7650] 60%|██████    | 12/20 [01:15<00:37,  4.70s/it, CE=8.179963e-01 H=8.004678e-01 dV_dx=1.087391e-04 dV_dθ=-1.763720e-02 ||∇||=5.637883e+00 | Tr=0.7650]  65%|██████▌   | 13/20 [01:15<00:31,  4.54s/it, CE=8.179963e-01 H=8.004678e-01 dV_dx=1.087391e-04 dV_dθ=-1.763720e-02 ||∇||=5.637883e+00 | Tr=0.7650] 65%|██████▌   | 13/20 [01:19<00:31,  4.54s/it, CE=7.948680e-01 H=7.767481e-01 dV_dx=4.862417e-05 dV_dθ=-1.816855e-02 ||∇||=5.721003e+00 | Tr=0.7650] 70%|███████   | 14/20 [01:19<00:26,  4.50s/it, CE=7.948680e-01 H=7.767481e-01 dV_dx=4.862417e-05 dV_dθ=-1.816855e-02 ||∇||=5.721003e+00 | Tr=0.7650] 70%|███████   | 14/20 [01:24<00:26,  4.50s/it, CE=7.744907e-01 H=7.570741e-01 dV_dx=-4.450667e-05 dV_dθ=-1.737209e-02 ||∇||=5.708636e+00 | Tr=0.7650] 75%|███████▌  | 15/20 [01:24<00:22,  4.43s/it, CE=7.744907e-01 H=7.570741e-01 dV_dx=-4.450667e-05 dV_dθ=-1.737209e-02 ||∇||=5.708636e+00 | Tr=0.7650] 75%|███████▌  | 15/20 [01:29<00:22,  4.43s/it, CE=7.545446e-01 H=7.389879e-01 dV_dx=2.539747e-05 dV_dθ=-1.558216e-02 ||∇||=5.543683e+00 | Tr=0.7650]  80%|████████  | 16/20 [01:29<00:18,  4.65s/it, CE=7.545446e-01 H=7.389879e-01 dV_dx=2.539747e-05 dV_dθ=-1.558216e-02 ||∇||=5.543683e+00 | Tr=0.7650] 80%|████████  | 16/20 [01:34<00:18,  4.65s/it, CE=7.366272e-01 H=7.222117e-01 dV_dx=3.776572e-05 dV_dθ=-1.445323e-02 ||∇||=5.419432e+00 | Tr=0.7650] 85%|████████▌ | 17/20 [01:34<00:14,  4.82s/it, CE=7.366272e-01 H=7.222117e-01 dV_dx=3.776572e-05 dV_dθ=-1.445323e-02 ||∇||=5.419432e+00 | Tr=0.7650] 85%|████████▌ | 17/20 [01:39<00:14,  4.82s/it, CE=7.206997e-01 H=7.064183e-01 dV_dx=9.301760e-06 dV_dθ=-1.429073e-02 ||∇||=5.394759e+00 | Tr=0.7650] 90%|█████████ | 18/20 [01:39<00:09,  4.86s/it, CE=7.206997e-01 H=7.064183e-01 dV_dx=9.301760e-06 dV_dθ=-1.429073e-02 ||∇||=5.394759e+00 | Tr=0.7650] 90%|█████████ | 18/20 [01:43<00:09,  4.86s/it, CE=7.062022e-01 H=6.922007e-01 dV_dx=-2.841007e-05 dV_dθ=-1.397313e-02 ||∇||=5.374675e+00 | Tr=0.7650] 95%|█████████▌| 19/20 [01:43<00:04,  4.69s/it, CE=7.062022e-01 H=6.922007e-01 dV_dx=-2.841007e-05 dV_dθ=-1.397313e-02 ||∇||=5.374675e+00 | Tr=0.7650] 95%|█████████▌| 19/20 [01:51<00:04,  4.69s/it, CE=6.930569e-01 H=6.783474e-01 dV_dx=1.007852e-04 dV_dθ=-1.481035e-02 ||∇||=5.463552e+00 | Tr=0.7650 Te/Cur=0.9241 Te/Exp=0.7546]100%|██████████| 20/20 [02:00<00:00,  8.20s/it, CE=6.930569e-01 H=6.783474e-01 dV_dx=1.007852e-04 dV_dθ=-1.481035e-02 ||∇||=5.463552e+00 | Tr=0.7650 Te/Cur=0.9241 Te/Exp=0.7546]100%|██████████| 20/20 [02:00<00:00,  6.00s/it, CE=6.930569e-01 H=6.783474e-01 dV_dx=1.007852e-04 dV_dθ=-1.481035e-02 ||∇||=5.463552e+00 | Tr=0.7650 Te/Cur=0.9241 Te/Exp=0.7546]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.637588
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:13<04:23, 13.87s/it]  5%|▌         | 1/20 [00:19<04:23, 13.87s/it, CE=7.025588e-01 H=6.981534e-01 dV_dx=-6.353877e-05 dV_dθ=-4.341802e-03 ||∇||=3.984611e+00 | Tr=0.7644] 10%|█         | 2/20 [00:19<02:39,  8.85s/it, CE=7.025588e-01 H=6.981534e-01 dV_dx=-6.353877e-05 dV_dθ=-4.341802e-03 ||∇||=3.984611e+00 | Tr=0.7644] 10%|█         | 2/20 [00:23<02:39,  8.85s/it, CE=6.855463e-01 H=6.813191e-01 dV_dx=6.317724e-05 dV_dθ=-4.290381e-03 ||∇||=3.925591e+00 | Tr=0.7644]  15%|█▌        | 3/20 [00:23<01:57,  6.91s/it, CE=6.855463e-01 H=6.813191e-01 dV_dx=6.317724e-05 dV_dθ=-4.290381e-03 ||∇||=3.925591e+00 | Tr=0.7644] 15%|█▌        | 3/20 [00:27<01:57,  6.91s/it, CE=6.719416e-01 H=6.673915e-01 dV_dx=7.306483e-05 dV_dθ=-4.623148e-03 ||∇||=4.024684e+00 | Tr=0.7644] 20%|██        | 4/20 [00:27<01:31,  5.70s/it, CE=6.719416e-01 H=6.673915e-01 dV_dx=7.306483e-05 dV_dθ=-4.623148e-03 ||∇||=4.024684e+00 | Tr=0.7644] 20%|██        | 4/20 [00:29<01:31,  5.70s/it, CE=6.590758e-01 H=6.546072e-01 dV_dx=-3.552109e-05 dV_dθ=-4.433034e-03 ||∇||=4.011518e+00 | Tr=0.7644] 25%|██▌       | 5/20 [00:29<01:07,  4.48s/it, CE=6.590758e-01 H=6.546072e-01 dV_dx=-3.552109e-05 dV_dθ=-4.433034e-03 ||∇||=4.011518e+00 | Tr=0.7644] 25%|██▌       | 5/20 [00:32<01:07,  4.48s/it, CE=6.473879e-01 H=6.431757e-01 dV_dx=9.675527e-06 dV_dθ=-4.221963e-03 ||∇||=4.015825e+00 | Tr=0.7644]  30%|███       | 6/20 [00:32<00:51,  3.70s/it, CE=6.473879e-01 H=6.431757e-01 dV_dx=9.675527e-06 dV_dθ=-4.221963e-03 ||∇||=4.015825e+00 | Tr=0.7644] 30%|███       | 6/20 [00:33<00:51,  3.70s/it, CE=6.368293e-01 H=6.327856e-01 dV_dx=-9.012249e-06 dV_dθ=-4.034702e-03 ||∇||=4.000433e+00 | Tr=0.7644] 35%|███▌      | 7/20 [00:33<00:40,  3.08s/it, CE=6.368293e-01 H=6.327856e-01 dV_dx=-9.012249e-06 dV_dθ=-4.034702e-03 ||∇||=4.000433e+00 | Tr=0.7644] 35%|███▌      | 7/20 [00:35<00:40,  3.08s/it, CE=6.270005e-01 H=6.227023e-01 dV_dx=-6.348302e-05 dV_dθ=-4.234714e-03 ||∇||=4.009505e+00 | Tr=0.7644] 40%|████      | 8/20 [00:35<00:31,  2.65s/it, CE=6.270005e-01 H=6.227023e-01 dV_dx=-6.348302e-05 dV_dθ=-4.234714e-03 ||∇||=4.009505e+00 | Tr=0.7644] 40%|████      | 8/20 [00:37<00:31,  2.65s/it, CE=6.180547e-01 H=6.138356e-01 dV_dx=-1.360193e-05 dV_dθ=-4.205536e-03 ||∇||=4.040863e+00 | Tr=0.7644] 45%|████▌     | 9/20 [00:37<00:25,  2.35s/it, CE=6.180547e-01 H=6.138356e-01 dV_dx=-1.360193e-05 dV_dθ=-4.205536e-03 ||∇||=4.040863e+00 | Tr=0.7644] 45%|████▌     | 9/20 [00:39<00:25,  2.35s/it, CE=6.095280e-01 H=6.051309e-01 dV_dx=-1.009659e-05 dV_dθ=-4.387024e-03 ||∇||=4.063693e+00 | Tr=0.7644] 50%|█████     | 10/20 [00:39<00:22,  2.28s/it, CE=6.095280e-01 H=6.051309e-01 dV_dx=-1.009659e-05 dV_dθ=-4.387024e-03 ||∇||=4.063693e+00 | Tr=0.7644] 50%|█████     | 10/20 [00:41<00:22,  2.28s/it, CE=6.011838e-01 H=5.968305e-01 dV_dx=6.037769e-05 dV_dθ=-4.413703e-03 ||∇||=4.081196e+00 | Tr=0.7644]  55%|█████▌    | 11/20 [00:41<00:19,  2.18s/it, CE=6.011838e-01 H=5.968305e-01 dV_dx=6.037769e-05 dV_dθ=-4.413703e-03 ||∇||=4.081196e+00 | Tr=0.7644] 55%|█████▌    | 11/20 [00:43<00:19,  2.18s/it, CE=5.928882e-01 H=5.888939e-01 dV_dx=-3.030445e-05 dV_dθ=-3.964042e-03 ||∇||=4.028184e+00 | Tr=0.7644] 60%|██████    | 12/20 [00:43<00:17,  2.14s/it, CE=5.928882e-01 H=5.888939e-01 dV_dx=-3.030445e-05 dV_dθ=-3.964042e-03 ||∇||=4.028184e+00 | Tr=0.7644] 60%|██████    | 12/20 [00:45<00:17,  2.14s/it, CE=5.852755e-01 H=5.815694e-01 dV_dx=8.921215e-06 dV_dθ=-3.715042e-03 ||∇||=4.000650e+00 | Tr=0.7644]  65%|██████▌   | 13/20 [00:45<00:15,  2.15s/it, CE=5.852755e-01 H=5.815694e-01 dV_dx=8.921215e-06 dV_dθ=-3.715042e-03 ||∇||=4.000650e+00 | Tr=0.7644] 65%|██████▌   | 13/20 [00:48<00:15,  2.15s/it, CE=5.781002e-01 H=5.746356e-01 dV_dx=2.101890e-05 dV_dθ=-3.485655e-03 ||∇||=3.996156e+00 | Tr=0.7644] 70%|███████   | 14/20 [00:48<00:13,  2.27s/it, CE=5.781002e-01 H=5.746356e-01 dV_dx=2.101890e-05 dV_dθ=-3.485655e-03 ||∇||=3.996156e+00 | Tr=0.7644] 70%|███████   | 14/20 [00:50<00:13,  2.27s/it, CE=5.712371e-01 H=5.680290e-01 dV_dx=-8.028816e-06 dV_dθ=-3.200015e-03 ||∇||=3.970672e+00 | Tr=0.7644] 75%|███████▌  | 15/20 [00:50<00:11,  2.20s/it, CE=5.712371e-01 H=5.680290e-01 dV_dx=-8.028816e-06 dV_dθ=-3.200015e-03 ||∇||=3.970672e+00 | Tr=0.7644] 75%|███████▌  | 15/20 [00:53<00:11,  2.20s/it, CE=5.643433e-01 H=5.610182e-01 dV_dx=3.424223e-05 dV_dθ=-3.359361e-03 ||∇||=3.942177e+00 | Tr=0.7644]  80%|████████  | 16/20 [00:53<00:09,  2.45s/it, CE=5.643433e-01 H=5.610182e-01 dV_dx=3.424223e-05 dV_dθ=-3.359361e-03 ||∇||=3.942177e+00 | Tr=0.7644] 80%|████████  | 16/20 [00:56<00:09,  2.45s/it, CE=5.577462e-01 H=5.546834e-01 dV_dx=5.128226e-05 dV_dθ=-3.114069e-03 ||∇||=3.925296e+00 | Tr=0.7644] 85%|████████▌ | 17/20 [00:56<00:08,  2.69s/it, CE=5.577462e-01 H=5.546834e-01 dV_dx=5.128226e-05 dV_dθ=-3.114069e-03 ||∇||=3.925296e+00 | Tr=0.7644] 85%|████████▌ | 17/20 [00:58<00:08,  2.69s/it, CE=5.512178e-01 H=5.479806e-01 dV_dx=-3.087039e-05 dV_dθ=-3.206339e-03 ||∇||=3.934484e+00 | Tr=0.7644] 90%|█████████ | 18/20 [00:58<00:05,  2.62s/it, CE=5.512178e-01 H=5.479806e-01 dV_dx=-3.087039e-05 dV_dθ=-3.206339e-03 ||∇||=3.934484e+00 | Tr=0.7644] 90%|█████████ | 18/20 [01:01<00:05,  2.62s/it, CE=5.445472e-01 H=5.416190e-01 dV_dx=-7.134553e-05 dV_dθ=-2.856952e-03 ||∇||=3.844568e+00 | Tr=0.7644] 95%|█████████▌| 19/20 [01:01<00:02,  2.48s/it, CE=5.445472e-01 H=5.416190e-01 dV_dx=-7.134553e-05 dV_dθ=-2.856952e-03 ||∇||=3.844568e+00 | Tr=0.7644] 95%|█████████▌| 19/20 [01:04<00:02,  2.48s/it, CE=5.386946e-01 H=5.359018e-01 dV_dx=-7.991609e-05 dV_dθ=-2.712878e-03 ||∇||=3.866396e+00 | Tr=0.7644 Te/Cur=0.9546 Te/Exp=0.7874]100%|██████████| 20/20 [01:07<00:00,  3.68s/it, CE=5.386946e-01 H=5.359018e-01 dV_dx=-7.991609e-05 dV_dθ=-2.712878e-03 ||∇||=3.866396e+00 | Tr=0.7644 Te/Cur=0.9546 Te/Exp=0.7874]100%|██████████| 20/20 [01:07<00:00,  3.38s/it, CE=5.386946e-01 H=5.359018e-01 dV_dx=-7.991609e-05 dV_dθ=-2.712878e-03 ||∇||=3.866396e+00 | Tr=0.7644 Te/Cur=0.9546 Te/Exp=0.7874]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.83s/it] 50%|█████     | 1/2 [00:10<00:07,  7.83s/it, CE=5.694956e-01 H=5.691942e-01 dV_dx=1.290453e-04 dV_dθ=-4.304867e-04 ||∇||=1.134940e+00 | Tr=0.9782 Te/Cur=0.9573 Te/Exp=0.7984]100%|██████████| 2/2 [00:10<00:00,  4.83s/it, CE=5.694956e-01 H=5.691942e-01 dV_dx=1.290453e-04 dV_dθ=-4.304867e-04 ||∇||=1.134940e+00 | Tr=0.9782 Te/Cur=0.9573 Te/Exp=0.7984]100%|██████████| 2/2 [00:10<00:00,  5.28s/it, CE=5.694956e-01 H=5.691942e-01 dV_dx=1.290453e-04 dV_dθ=-4.304867e-04 ||∇||=1.134940e+00 | Tr=0.9782 Te/Cur=0.9573 Te/Exp=0.7984]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:09<02:56,  9.30s/it]  5%|▌         | 1/20 [00:11<02:56,  9.30s/it, CE=5.627754e-01 H=5.624696e-01 dV_dx=-4.375074e-05 dV_dθ=-2.620632e-04 ||∇||=1.012741e+00 | Tr=0.9805] 10%|█         | 2/20 [00:11<01:28,  4.91s/it, CE=5.627754e-01 H=5.624696e-01 dV_dx=-4.375074e-05 dV_dθ=-2.620632e-04 ||∇||=1.012741e+00 | Tr=0.9805] 10%|█         | 2/20 [00:13<01:28,  4.91s/it, CE=5.533745e-01 H=5.531301e-01 dV_dx=1.367659e-05 dV_dθ=-2.581337e-04 ||∇||=9.991769e-01 | Tr=0.9819]  15%|█▌        | 3/20 [00:13<01:00,  3.55s/it, CE=5.533745e-01 H=5.531301e-01 dV_dx=1.367659e-05 dV_dθ=-2.581337e-04 ||∇||=9.991769e-01 | Tr=0.9819] 15%|█▌        | 3/20 [00:15<01:00,  3.55s/it, CE=5.454871e-01 H=5.453669e-01 dV_dx=1.200309e-04 dV_dθ=-2.402158e-04 ||∇||=9.812169e-01 | Tr=0.9826] 20%|██        | 4/20 [00:15<00:47,  2.98s/it, CE=5.454871e-01 H=5.453669e-01 dV_dx=1.200309e-04 dV_dθ=-2.402158e-04 ||∇||=9.812169e-01 | Tr=0.9826] 20%|██        | 4/20 [00:16<00:47,  2.98s/it, CE=5.386375e-01 H=5.384597e-01 dV_dx=7.699323e-05 dV_dθ=-2.547573e-04 ||∇||=9.805040e-01 | Tr=0.9835] 25%|██▌       | 5/20 [00:16<00:37,  2.48s/it, CE=5.386375e-01 H=5.384597e-01 dV_dx=7.699323e-05 dV_dθ=-2.547573e-04 ||∇||=9.805040e-01 | Tr=0.9835] 25%|██▌       | 5/20 [00:19<00:37,  2.48s/it, CE=5.323647e-01 H=5.320695e-01 dV_dx=-2.184945e-05 dV_dθ=-2.732829e-04 ||∇||=9.760497e-01 | Tr=0.9842 Te/Cur=0.9626 Te/Exp=0.8084] 30%|███       | 6/20 [00:19<00:37,  2.70s/it, CE=5.323647e-01 H=5.320695e-01 dV_dx=-2.184945e-05 dV_dθ=-2.732829e-04 ||∇||=9.760497e-01 | Tr=0.9842 Te/Cur=0.9626 Te/Exp=0.8084] 30%|███       | 6/20 [00:21<00:37,  2.70s/it, CE=5.265904e-01 H=5.263596e-01 dV_dx=4.300057e-05 dV_dθ=-2.737679e-04 ||∇||=9.693565e-01 | Tr=0.9851]                              35%|███▌      | 7/20 [00:21<00:30,  2.31s/it, CE=5.265904e-01 H=5.263596e-01 dV_dx=4.300057e-05 dV_dθ=-2.737679e-04 ||∇||=9.693565e-01 | Tr=0.9851] 35%|███▌      | 7/20 [00:23<00:30,  2.31s/it, CE=5.212478e-01 H=5.209344e-01 dV_dx=-2.966510e-05 dV_dθ=-2.837499e-04 ||∇||=9.688634e-01 | Tr=0.9856] 40%|████      | 8/20 [00:23<00:28,  2.35s/it, CE=5.212478e-01 H=5.209344e-01 dV_dx=-2.966510e-05 dV_dθ=-2.837499e-04 ||∇||=9.688634e-01 | Tr=0.9856] 40%|████      | 8/20 [00:25<00:28,  2.35s/it, CE=5.162974e-01 H=5.160599e-01 dV_dx=5.433043e-05 dV_dθ=-2.918713e-04 ||∇||=9.697253e-01 | Tr=0.9862]  45%|████▌     | 9/20 [00:25<00:23,  2.10s/it, CE=5.162974e-01 H=5.160599e-01 dV_dx=5.433043e-05 dV_dθ=-2.918713e-04 ||∇||=9.697253e-01 | Tr=0.9862] 45%|████▌     | 9/20 [00:27<00:23,  2.10s/it, CE=5.114952e-01 H=5.113272e-01 dV_dx=1.165883e-04 dV_dθ=-2.845793e-04 ||∇||=9.623917e-01 | Tr=0.9866] 50%|█████     | 10/20 [00:27<00:20,  2.05s/it, CE=5.114952e-01 H=5.113272e-01 dV_dx=1.165883e-04 dV_dθ=-2.845793e-04 ||∇||=9.623917e-01 | Tr=0.9866] 50%|█████     | 10/20 [00:30<00:20,  2.05s/it, CE=5.068495e-01 H=5.065753e-01 dV_dx=-2.502572e-06 dV_dθ=-2.716868e-04 ||∇||=9.519798e-01 | Tr=0.9874 Te/Cur=0.9659 Te/Exp=0.8160] 55%|█████▌    | 11/20 [00:30<00:21,  2.37s/it, CE=5.068495e-01 H=5.065753e-01 dV_dx=-2.502572e-06 dV_dθ=-2.716868e-04 ||∇||=9.519798e-01 | Tr=0.9874 Te/Cur=0.9659 Te/Exp=0.8160] 55%|█████▌    | 11/20 [00:32<00:21,  2.37s/it, CE=5.025278e-01 H=5.020387e-01 dV_dx=-2.176032e-04 dV_dθ=-2.715119e-04 ||∇||=9.484650e-01 | Tr=0.9879]                             60%|██████    | 12/20 [00:32<00:18,  2.31s/it, CE=5.025278e-01 H=5.020387e-01 dV_dx=-2.176032e-04 dV_dθ=-2.715119e-04 ||∇||=9.484650e-01 | Tr=0.9879] 60%|██████    | 12/20 [00:36<00:18,  2.31s/it, CE=4.982729e-01 H=4.979312e-01 dV_dx=-7.764476e-05 dV_dθ=-2.641150e-04 ||∇||=9.431466e-01 | Tr=0.9885] 65%|██████▌   | 13/20 [00:36<00:18,  2.67s/it, CE=4.982729e-01 H=4.979312e-01 dV_dx=-7.764476e-05 dV_dθ=-2.641150e-04 ||∇||=9.431466e-01 | Tr=0.9885] 65%|██████▌   | 13/20 [00:38<00:18,  2.67s/it, CE=4.941952e-01 H=4.940156e-01 dV_dx=6.332726e-05 dV_dθ=-2.429608e-04 ||∇||=9.321678e-01 | Tr=0.9890]  70%|███████   | 14/20 [00:38<00:14,  2.49s/it, CE=4.941952e-01 H=4.940156e-01 dV_dx=6.332726e-05 dV_dθ=-2.429608e-04 ||∇||=9.321678e-01 | Tr=0.9890] 70%|███████   | 14/20 [00:40<00:14,  2.49s/it, CE=4.903265e-01 H=4.900077e-01 dV_dx=-7.125667e-05 dV_dθ=-2.475021e-04 ||∇||=9.292337e-01 | Tr=0.9895] 75%|███████▌  | 15/20 [00:40<00:11,  2.37s/it, CE=4.903265e-01 H=4.900077e-01 dV_dx=-7.125667e-05 dV_dθ=-2.475021e-04 ||∇||=9.292337e-01 | Tr=0.9895] 75%|███████▌  | 15/20 [00:43<00:11,  2.37s/it, CE=4.867437e-01 H=4.865071e-01 dV_dx=2.219922e-05 dV_dθ=-2.587951e-04 ||∇||=9.383370e-01 | Tr=0.9899 Te/Cur=0.9681 Te/Exp=0.8148] 80%|████████  | 16/20 [00:43<00:10,  2.67s/it, CE=4.867437e-01 H=4.865071e-01 dV_dx=2.219922e-05 dV_dθ=-2.587951e-04 ||∇||=9.383370e-01 | Tr=0.9899 Te/Cur=0.9681 Te/Exp=0.8148] 80%|████████  | 16/20 [00:45<00:10,  2.67s/it, CE=4.830910e-01 H=4.827485e-01 dV_dx=-9.302520e-05 dV_dθ=-2.494598e-04 ||∇||=9.336506e-01 | Tr=0.9903]                            85%|████████▌ | 17/20 [00:45<00:07,  2.46s/it, CE=4.830910e-01 H=4.827485e-01 dV_dx=-9.302520e-05 dV_dθ=-2.494598e-04 ||∇||=9.336506e-01 | Tr=0.9903] 85%|████████▌ | 17/20 [00:47<00:07,  2.46s/it, CE=4.795117e-01 H=4.794043e-01 dV_dx=1.205101e-04 dV_dθ=-2.279013e-04 ||∇||=9.208108e-01 | Tr=0.9907]  90%|█████████ | 18/20 [00:47<00:04,  2.32s/it, CE=4.795117e-01 H=4.794043e-01 dV_dx=1.205101e-04 dV_dθ=-2.279013e-04 ||∇||=9.208108e-01 | Tr=0.9907] 90%|█████████ | 18/20 [00:49<00:04,  2.32s/it, CE=4.760789e-01 H=4.758335e-01 dV_dx=-2.495292e-05 dV_dθ=-2.204714e-04 ||∇||=9.194860e-01 | Tr=0.9911] 95%|█████████▌| 19/20 [00:49<00:02,  2.20s/it, CE=4.760789e-01 H=4.758335e-01 dV_dx=-2.495292e-05 dV_dθ=-2.204714e-04 ||∇||=9.194860e-01 | Tr=0.9911] 95%|█████████▌| 19/20 [00:53<00:02,  2.20s/it, CE=4.728102e-01 H=4.727534e-01 dV_dx=1.640690e-04 dV_dθ=-2.209363e-04 ||∇||=9.212048e-01 | Tr=0.9917 Te/Cur=0.9698 Te/Exp=0.8163]100%|██████████| 20/20 [00:53<00:00,  2.60s/it, CE=4.728102e-01 H=4.727534e-01 dV_dx=1.640690e-04 dV_dθ=-2.209363e-04 ||∇||=9.212048e-01 | Tr=0.9917 Te/Cur=0.9698 Te/Exp=0.8163]100%|██████████| 20/20 [00:53<00:00,  2.65s/it, CE=4.728102e-01 H=4.727534e-01 dV_dx=1.640690e-04 dV_dθ=-2.209363e-04 ||∇||=9.212048e-01 | Tr=0.9917 Te/Cur=0.9698 Te/Exp=0.8163]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 5 final loss: 0.479777
======================================================================


  Evaluating on all tasks 0..5 for CL metrics...
    Task 0: 0.7731
    Task 1: 0.9431
    Task 2: 0.8409
    Task 3: 0.5937
    Task 4: 0.9315
    Task 5: 0.9684

============================================================
Task 6
============================================================
Initial loss on new task: 10.3674, previous: 0.4728, ratio: 21.93
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 6
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:08<?, ?it/s, CE=5.969121e-01 H=5.596833e-01 dV_dx=7.017480e-05 dV_dθ=-3.729901e-02 ||∇||=7.208068e+00 | Tr=0.6104 Te/Cur=0.7802 Te/Exp=0.8283]100%|██████████| 1/1 [00:08<00:00,  8.08s/it, CE=5.969121e-01 H=5.596833e-01 dV_dx=7.017480e-05 dV_dθ=-3.729901e-02 ||∇||=7.208068e+00 | Tr=0.6104 Te/Cur=0.7802 Te/Exp=0.8283]100%|██████████| 1/1 [00:08<00:00,  8.08s/it, CE=5.969121e-01 H=5.596833e-01 dV_dx=7.017480e-05 dV_dθ=-3.729901e-02 ||∇||=7.208068e+00 | Tr=0.6104 Te/Cur=0.7802 Te/Exp=0.8283]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.596912

[STEP 2] Architecture change decision
  Current: 0.596912, Previous: 0.472810
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9417 samples from 10 classes
  Created balanced validation set: 39932 samples from 10 classes
  Starting grid architecture search for task 6
  Baseline architecture: (2, [507, 632, 144, 10])
  Baseline loss: 0.596912
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  6.00s/it] 50%|█████     | 1/2 [00:07<00:05,  6.00s/it, CE=2.250604e+00 H=2.250541e+00 dV_dx=3.938342e-06 dV_dθ=-6.685961e-05 ||∇||=5.223360e-01 | Tr=0.0763 Te/Cur=0.0829 Te/Exp=0.2672]100%|██████████| 2/2 [00:07<00:00,  3.48s/it, CE=2.250604e+00 H=2.250541e+00 dV_dx=3.938342e-06 dV_dθ=-6.685961e-05 ||∇||=5.223360e-01 | Tr=0.0763 Te/Cur=0.0829 Te/Exp=0.2672]100%|██████████| 2/2 [00:07<00:00,  3.86s/it, CE=2.250604e+00 H=2.250541e+00 dV_dx=3.938342e-06 dV_dθ=-6.685961e-05 ||∇||=5.223360e-01 | Tr=0.0763 Te/Cur=0.0829 Te/Exp=0.2672]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.250604226341409
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.09s/it] 50%|█████     | 1/2 [00:11<00:10, 10.09s/it, CE=2.254498e+00 H=2.254497e+00 dV_dx=2.464317e-05 dV_dθ=-2.621254e-05 ||∇||=4.580462e-01 | Tr=0.0705 Te/Cur=0.0724 Te/Exp=0.2396]100%|██████████| 2/2 [00:11<00:00,  5.24s/it, CE=2.254498e+00 H=2.254497e+00 dV_dx=2.464317e-05 dV_dθ=-2.621254e-05 ||∇||=4.580462e-01 | Tr=0.0705 Te/Cur=0.0724 Te/Exp=0.2396]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.254498e+00 H=2.254497e+00 dV_dx=2.464317e-05 dV_dθ=-2.621254e-05 ||∇||=4.580462e-01 | Tr=0.0705 Te/Cur=0.0724 Te/Exp=0.2396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.70s/it] 50%|█████     | 1/2 [00:11<00:09,  9.70s/it, CE=2.252664e+00 H=2.252610e+00 dV_dx=8.157194e-06 dV_dθ=-6.177402e-05 ||∇||=4.498599e-01 | Tr=0.1156 Te/Cur=0.1392 Te/Exp=0.2901]100%|██████████| 2/2 [00:11<00:00,  5.12s/it, CE=2.252664e+00 H=2.252610e+00 dV_dx=8.157194e-06 dV_dθ=-6.177402e-05 ||∇||=4.498599e-01 | Tr=0.1156 Te/Cur=0.1392 Te/Exp=0.2901]100%|██████████| 2/2 [00:11<00:00,  5.81s/it, CE=2.252664e+00 H=2.252610e+00 dV_dx=8.157194e-06 dV_dθ=-6.177402e-05 ||∇||=4.498599e-01 | Tr=0.1156 Te/Cur=0.1392 Te/Exp=0.2901]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.24s/it] 50%|█████     | 1/2 [00:06<00:05,  5.24s/it, CE=2.237760e+00 H=2.237769e+00 dV_dx=1.480491e-05 dV_dθ=-6.066506e-06 ||∇||=5.279199e-01 | Tr=0.1577 Te/Cur=0.1894 Te/Exp=0.3249]100%|██████████| 2/2 [00:06<00:00,  3.16s/it, CE=2.237760e+00 H=2.237769e+00 dV_dx=1.480491e-05 dV_dθ=-6.066506e-06 ||∇||=5.279199e-01 | Tr=0.1577 Te/Cur=0.1894 Te/Exp=0.3249]100%|██████████| 2/2 [00:06<00:00,  3.47s/it, CE=2.237760e+00 H=2.237769e+00 dV_dx=1.480491e-05 dV_dθ=-6.066506e-06 ||∇||=5.279199e-01 | Tr=0.1577 Te/Cur=0.1894 Te/Exp=0.3249]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 144, 10]) with loss 2.237760
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.09s/it] 50%|█████     | 1/2 [00:07<00:05,  5.09s/it, CE=2.235027e+00 H=2.234933e+00 dV_dx=3.970087e-06 dV_dθ=-9.813347e-05 ||∇||=4.796448e-01 | Tr=0.1712 Te/Cur=0.1893 Te/Exp=0.2838]100%|██████████| 2/2 [00:07<00:00,  3.24s/it, CE=2.235027e+00 H=2.234933e+00 dV_dx=3.970087e-06 dV_dθ=-9.813347e-05 ||∇||=4.796448e-01 | Tr=0.1712 Te/Cur=0.1893 Te/Exp=0.2838]100%|██████████| 2/2 [00:07<00:00,  3.52s/it, CE=2.235027e+00 H=2.234933e+00 dV_dx=3.970087e-06 dV_dθ=-9.813347e-05 ||∇||=4.796448e-01 | Tr=0.1712 Te/Cur=0.1893 Te/Exp=0.2838]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.235027
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.13s/it] 50%|█████     | 1/2 [00:12<00:10, 10.13s/it, CE=2.256289e+00 H=2.256254e+00 dV_dx=-2.379039e-06 dV_dθ=-3.255287e-05 ||∇||=4.220851e-01 | Tr=0.1162 Te/Cur=0.1082 Te/Exp=0.2776]100%|██████████| 2/2 [00:12<00:00,  5.48s/it, CE=2.256289e+00 H=2.256254e+00 dV_dx=-2.379039e-06 dV_dθ=-3.255287e-05 ||∇||=4.220851e-01 | Tr=0.1162 Te/Cur=0.1082 Te/Exp=0.2776]100%|██████████| 2/2 [00:12<00:00,  6.18s/it, CE=2.256289e+00 H=2.256254e+00 dV_dx=-2.379039e-06 dV_dθ=-3.255287e-05 ||∇||=4.220851e-01 | Tr=0.1162 Te/Cur=0.1082 Te/Exp=0.2776]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.43s/it] 50%|█████     | 1/2 [00:07<00:05,  5.43s/it, CE=2.246126e+00 H=2.246065e+00 dV_dx=-7.120419e-06 dV_dθ=-5.439121e-05 ||∇||=5.020608e-01 | Tr=0.1312 Te/Cur=0.1322 Te/Exp=0.2864]100%|██████████| 2/2 [00:07<00:00,  3.29s/it, CE=2.246126e+00 H=2.246065e+00 dV_dx=-7.120419e-06 dV_dθ=-5.439121e-05 ||∇||=5.020608e-01 | Tr=0.1312 Te/Cur=0.1322 Te/Exp=0.2864]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.246126e+00 H=2.246065e+00 dV_dx=-7.120419e-06 dV_dθ=-5.439121e-05 ||∇||=5.020608e-01 | Tr=0.1312 Te/Cur=0.1322 Te/Exp=0.2864]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.14s/it] 50%|█████     | 1/2 [00:09<00:08,  8.14s/it, CE=2.255452e+00 H=2.255351e+00 dV_dx=1.009330e-05 dV_dθ=-1.117267e-04 ||∇||=4.580544e-01 | Tr=0.1335 Te/Cur=0.1186 Te/Exp=0.2595]100%|██████████| 2/2 [00:09<00:00,  4.43s/it, CE=2.255452e+00 H=2.255351e+00 dV_dx=1.009330e-05 dV_dθ=-1.117267e-04 ||∇||=4.580544e-01 | Tr=0.1335 Te/Cur=0.1186 Te/Exp=0.2595]100%|██████████| 2/2 [00:09<00:00,  4.98s/it, CE=2.255452e+00 H=2.255351e+00 dV_dx=1.009330e-05 dV_dθ=-1.117267e-04 ||∇||=4.580544e-01 | Tr=0.1335 Te/Cur=0.1186 Te/Exp=0.2595]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.18s/it] 50%|█████     | 1/2 [00:12<00:10, 10.18s/it, CE=2.249413e+00 H=2.249360e+00 dV_dx=1.140573e-05 dV_dθ=-6.446010e-05 ||∇||=5.088629e-01 | Tr=0.1150 Te/Cur=0.1182 Te/Exp=0.2859]100%|██████████| 2/2 [00:12<00:00,  5.32s/it, CE=2.249413e+00 H=2.249360e+00 dV_dx=1.140573e-05 dV_dθ=-6.446010e-05 ||∇||=5.088629e-01 | Tr=0.1150 Te/Cur=0.1182 Te/Exp=0.2859]100%|██████████| 2/2 [00:12<00:00,  6.05s/it, CE=2.249413e+00 H=2.249360e+00 dV_dx=1.140573e-05 dV_dθ=-6.446010e-05 ||∇||=5.088629e-01 | Tr=0.1150 Te/Cur=0.1182 Te/Exp=0.2859]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.27s/it] 50%|█████     | 1/2 [00:08<00:06,  6.27s/it, CE=2.257874e+00 H=2.257854e+00 dV_dx=-1.354240e-05 dV_dθ=-6.276560e-06 ||∇||=4.014470e-01 | Tr=0.0886 Te/Cur=0.0918 Te/Exp=0.2295]100%|██████████| 2/2 [00:08<00:00,  3.76s/it, CE=2.257874e+00 H=2.257854e+00 dV_dx=-1.354240e-05 dV_dθ=-6.276560e-06 ||∇||=4.014470e-01 | Tr=0.0886 Te/Cur=0.0918 Te/Exp=0.2295]100%|██████████| 2/2 [00:08<00:00,  4.13s/it, CE=2.257874e+00 H=2.257854e+00 dV_dx=-1.354240e-05 dV_dθ=-6.276560e-06 ||∇||=4.014470e-01 | Tr=0.0886 Te/Cur=0.0918 Te/Exp=0.2295]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.99s/it] 50%|█████     | 1/2 [00:10<00:08,  8.99s/it, CE=2.258610e+00 H=2.258576e+00 dV_dx=-8.928288e-06 dV_dθ=-2.498697e-05 ||∇||=3.944094e-01 | Tr=0.0885 Te/Cur=0.0815 Te/Exp=0.2492]100%|██████████| 2/2 [00:10<00:00,  4.61s/it, CE=2.258610e+00 H=2.258576e+00 dV_dx=-8.928288e-06 dV_dθ=-2.498697e-05 ||∇||=3.944094e-01 | Tr=0.0885 Te/Cur=0.0815 Te/Exp=0.2492]100%|██████████| 2/2 [00:10<00:00,  5.27s/it, CE=2.258610e+00 H=2.258576e+00 dV_dx=-8.928288e-06 dV_dθ=-2.498697e-05 ||∇||=3.944094e-01 | Tr=0.0885 Te/Cur=0.0815 Te/Exp=0.2492]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.79s/it] 50%|█████     | 1/2 [00:11<00:09,  9.79s/it, CE=2.266513e+00 H=2.266487e+00 dV_dx=7.527625e-06 dV_dθ=-3.382677e-05 ||∇||=3.718528e-01 | Tr=0.1763 Te/Cur=0.1758 Te/Exp=0.2391]100%|██████████| 2/2 [00:11<00:00,  5.06s/it, CE=2.266513e+00 H=2.266487e+00 dV_dx=7.527625e-06 dV_dθ=-3.382677e-05 ||∇||=3.718528e-01 | Tr=0.1763 Te/Cur=0.1758 Te/Exp=0.2391]100%|██████████| 2/2 [00:11<00:00,  5.77s/it, CE=2.266513e+00 H=2.266487e+00 dV_dx=7.527625e-06 dV_dθ=-3.382677e-05 ||∇||=3.718528e-01 | Tr=0.1763 Te/Cur=0.1758 Te/Exp=0.2391]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.17s/it] 50%|█████     | 1/2 [00:07<00:06,  6.17s/it, CE=2.255395e+00 H=2.255381e+00 dV_dx=1.235522e-05 dV_dθ=-2.570446e-05 ||∇||=3.664903e-01 | Tr=0.0909 Te/Cur=0.1018 Te/Exp=0.2421]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.255395e+00 H=2.255381e+00 dV_dx=1.235522e-05 dV_dθ=-2.570446e-05 ||∇||=3.664903e-01 | Tr=0.0909 Te/Cur=0.1018 Te/Exp=0.2421]100%|██████████| 2/2 [00:07<00:00,  3.97s/it, CE=2.255395e+00 H=2.255381e+00 dV_dx=1.235522e-05 dV_dθ=-2.570446e-05 ||∇||=3.664903e-01 | Tr=0.0909 Te/Cur=0.1018 Te/Exp=0.2421]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.27s/it] 50%|█████     | 1/2 [00:10<00:08,  8.27s/it, CE=2.261779e+00 H=2.261729e+00 dV_dx=-3.139093e-05 dV_dθ=-1.803096e-05 ||∇||=3.495380e-01 | Tr=0.1902 Te/Cur=0.1802 Te/Exp=0.2770]100%|██████████| 2/2 [00:10<00:00,  4.52s/it, CE=2.261779e+00 H=2.261729e+00 dV_dx=-3.139093e-05 dV_dθ=-1.803096e-05 ||∇||=3.495380e-01 | Tr=0.1902 Te/Cur=0.1802 Te/Exp=0.2770]100%|██████████| 2/2 [00:10<00:00,  5.08s/it, CE=2.261779e+00 H=2.261729e+00 dV_dx=-3.139093e-05 dV_dθ=-1.803096e-05 ||∇||=3.495380e-01 | Tr=0.1902 Te/Cur=0.1802 Te/Exp=0.2770]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.59s/it] 50%|█████     | 1/2 [00:11<00:09,  9.59s/it, CE=2.255127e+00 H=2.255088e+00 dV_dx=-2.172846e-05 dV_dθ=-1.748164e-05 ||∇||=3.543889e-01 | Tr=0.1155 Te/Cur=0.1007 Te/Exp=0.2809]100%|██████████| 2/2 [00:11<00:00,  4.86s/it, CE=2.255127e+00 H=2.255088e+00 dV_dx=-2.172846e-05 dV_dθ=-1.748164e-05 ||∇||=3.543889e-01 | Tr=0.1155 Te/Cur=0.1007 Te/Exp=0.2809]100%|██████████| 2/2 [00:11<00:00,  5.57s/it, CE=2.255127e+00 H=2.255088e+00 dV_dx=-2.172846e-05 dV_dθ=-1.748164e-05 ||∇||=3.543889e-01 | Tr=0.1155 Te/Cur=0.1007 Te/Exp=0.2809]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.04s/it] 50%|█████     | 1/2 [00:06<00:05,  5.04s/it, CE=2.240184e+00 H=2.240155e+00 dV_dx=-7.131523e-06 dV_dθ=-2.195023e-05 ||∇||=3.888854e-01 | Tr=0.0708 Te/Cur=0.0812 Te/Exp=0.2899]100%|██████████| 2/2 [00:06<00:00,  3.17s/it, CE=2.240184e+00 H=2.240155e+00 dV_dx=-7.131523e-06 dV_dθ=-2.195023e-05 ||∇||=3.888854e-01 | Tr=0.0708 Te/Cur=0.0812 Te/Exp=0.2899]100%|██████████| 2/2 [00:06<00:00,  3.45s/it, CE=2.240184e+00 H=2.240155e+00 dV_dx=-7.131523e-06 dV_dθ=-2.195023e-05 ||∇||=3.888854e-01 | Tr=0.0708 Te/Cur=0.0812 Te/Exp=0.2899]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.72s/it] 50%|█████     | 1/2 [00:07<00:05,  5.72s/it, CE=2.264922e+00 H=2.264871e+00 dV_dx=4.963256e-06 dV_dθ=-5.544286e-05 ||∇||=3.738243e-01 | Tr=0.1269 Te/Cur=0.1310 Te/Exp=0.2331]100%|██████████| 2/2 [00:07<00:00,  3.35s/it, CE=2.264922e+00 H=2.264871e+00 dV_dx=4.963256e-06 dV_dθ=-5.544286e-05 ||∇||=3.738243e-01 | Tr=0.1269 Te/Cur=0.1310 Te/Exp=0.2331]100%|██████████| 2/2 [00:07<00:00,  3.71s/it, CE=2.264922e+00 H=2.264871e+00 dV_dx=4.963256e-06 dV_dθ=-5.544286e-05 ||∇||=3.738243e-01 | Tr=0.1269 Te/Cur=0.1310 Te/Exp=0.2331]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.12s/it] 50%|█████     | 1/2 [00:12<00:10, 10.12s/it, CE=2.261681e+00 H=2.261635e+00 dV_dx=-2.029526e-06 dV_dθ=-4.363173e-05 ||∇||=3.698374e-01 | Tr=0.1240 Te/Cur=0.1243 Te/Exp=0.2167]100%|██████████| 2/2 [00:12<00:00,  5.34s/it, CE=2.261681e+00 H=2.261635e+00 dV_dx=-2.029526e-06 dV_dθ=-4.363173e-05 ||∇||=3.698374e-01 | Tr=0.1240 Te/Cur=0.1243 Te/Exp=0.2167]100%|██████████| 2/2 [00:12<00:00,  6.06s/it, CE=2.261681e+00 H=2.261635e+00 dV_dx=-2.029526e-06 dV_dθ=-4.363173e-05 ||∇||=3.698374e-01 | Tr=0.1240 Te/Cur=0.1243 Te/Exp=0.2167]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.56s/it] 50%|█████     | 1/2 [00:07<00:05,  5.56s/it, CE=2.263799e+00 H=2.263733e+00 dV_dx=1.586789e-05 dV_dθ=-8.206449e-05 ||∇||=3.612298e-01 | Tr=0.1057 Te/Cur=0.1278 Te/Exp=0.2280]100%|██████████| 2/2 [00:07<00:00,  3.40s/it, CE=2.263799e+00 H=2.263733e+00 dV_dx=1.586789e-05 dV_dθ=-8.206449e-05 ||∇||=3.612298e-01 | Tr=0.1057 Te/Cur=0.1278 Te/Exp=0.2280]100%|██████████| 2/2 [00:07<00:00,  3.72s/it, CE=2.263799e+00 H=2.263733e+00 dV_dx=1.586789e-05 dV_dθ=-8.206449e-05 ||∇||=3.612298e-01 | Tr=0.1057 Te/Cur=0.1278 Te/Exp=0.2280]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.45s/it] 50%|█████     | 1/2 [00:11<00:09,  9.45s/it, CE=2.270261e+00 H=2.270220e+00 dV_dx=-2.121739e-06 dV_dθ=-3.943267e-05 ||∇||=3.613168e-01 | Tr=0.1244 Te/Cur=0.1261 Te/Exp=0.2348]100%|██████████| 2/2 [00:11<00:00,  5.08s/it, CE=2.270261e+00 H=2.270220e+00 dV_dx=-2.121739e-06 dV_dθ=-3.943267e-05 ||∇||=3.613168e-01 | Tr=0.1244 Te/Cur=0.1261 Te/Exp=0.2348]100%|██████████| 2/2 [00:11<00:00,  5.74s/it, CE=2.270261e+00 H=2.270220e+00 dV_dx=-2.121739e-06 dV_dθ=-3.943267e-05 ||∇||=3.613168e-01 | Tr=0.1244 Te/Cur=0.1261 Te/Exp=0.2348]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.40s/it] 50%|█████     | 1/2 [00:12<00:11, 11.40s/it, CE=2.270640e+00 H=2.270568e+00 dV_dx=-1.331774e-05 dV_dθ=-5.840885e-05 ||∇||=3.710690e-01 | Tr=0.1162 Te/Cur=0.1409 Te/Exp=0.1958]100%|██████████| 2/2 [00:12<00:00,  5.51s/it, CE=2.270640e+00 H=2.270568e+00 dV_dx=-1.331774e-05 dV_dθ=-5.840885e-05 ||∇||=3.710690e-01 | Tr=0.1162 Te/Cur=0.1409 Te/Exp=0.1958]100%|██████████| 2/2 [00:12<00:00,  6.39s/it, CE=2.270640e+00 H=2.270568e+00 dV_dx=-1.331774e-05 dV_dθ=-5.840885e-05 ||∇||=3.710690e-01 | Tr=0.1162 Te/Cur=0.1409 Te/Exp=0.1958]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.51s/it] 50%|█████     | 1/2 [00:07<00:05,  5.51s/it, CE=2.270328e+00 H=2.270252e+00 dV_dx=-2.080830e-05 dV_dθ=-5.512970e-05 ||∇||=3.443178e-01 | Tr=0.0950 Te/Cur=0.0939 Te/Exp=0.1628]100%|██████████| 2/2 [00:07<00:00,  3.41s/it, CE=2.270328e+00 H=2.270252e+00 dV_dx=-2.080830e-05 dV_dθ=-5.512970e-05 ||∇||=3.443178e-01 | Tr=0.0950 Te/Cur=0.0939 Te/Exp=0.1628]100%|██████████| 2/2 [00:07<00:00,  3.73s/it, CE=2.270328e+00 H=2.270252e+00 dV_dx=-2.080830e-05 dV_dθ=-5.512970e-05 ||∇||=3.443178e-01 | Tr=0.0950 Te/Cur=0.0939 Te/Exp=0.1628]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.24s/it] 50%|█████     | 1/2 [00:07<00:05,  5.24s/it, CE=2.263049e+00 H=2.262987e+00 dV_dx=1.482796e-05 dV_dθ=-7.732384e-05 ||∇||=3.885795e-01 | Tr=0.1098 Te/Cur=0.1024 Te/Exp=0.2345]100%|██████████| 2/2 [00:07<00:00,  3.36s/it, CE=2.263049e+00 H=2.262987e+00 dV_dx=1.482796e-05 dV_dθ=-7.732384e-05 ||∇||=3.885795e-01 | Tr=0.1098 Te/Cur=0.1024 Te/Exp=0.2345]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.263049e+00 H=2.262987e+00 dV_dx=1.482796e-05 dV_dθ=-7.732384e-05 ||∇||=3.885795e-01 | Tr=0.1098 Te/Cur=0.1024 Te/Exp=0.2345]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.92s/it] 50%|█████     | 1/2 [00:11<00:09,  9.92s/it, CE=2.266489e+00 H=2.266441e+00 dV_dx=2.480473e-06 dV_dθ=-4.963531e-05 ||∇||=3.641910e-01 | Tr=0.0966 Te/Cur=0.0863 Te/Exp=0.2329]100%|██████████| 2/2 [00:11<00:00,  5.25s/it, CE=2.266489e+00 H=2.266441e+00 dV_dx=2.480473e-06 dV_dθ=-4.963531e-05 ||∇||=3.641910e-01 | Tr=0.0966 Te/Cur=0.0863 Te/Exp=0.2329]100%|██████████| 2/2 [00:11<00:00,  5.95s/it, CE=2.266489e+00 H=2.266441e+00 dV_dx=2.480473e-06 dV_dθ=-4.963531e-05 ||∇||=3.641910e-01 | Tr=0.0966 Te/Cur=0.0863 Te/Exp=0.2329]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.33s/it] 50%|█████     | 1/2 [00:06<00:05,  5.33s/it, CE=2.257815e+00 H=2.257781e+00 dV_dx=8.937399e-06 dV_dθ=-4.271520e-05 ||∇||=3.701186e-01 | Tr=0.0969 Te/Cur=0.0715 Te/Exp=0.2828]100%|██████████| 2/2 [00:06<00:00,  3.17s/it, CE=2.257815e+00 H=2.257781e+00 dV_dx=8.937399e-06 dV_dθ=-4.271520e-05 ||∇||=3.701186e-01 | Tr=0.0969 Te/Cur=0.0715 Te/Exp=0.2828]100%|██████████| 2/2 [00:06<00:00,  3.49s/it, CE=2.257815e+00 H=2.257781e+00 dV_dx=8.937399e-06 dV_dθ=-4.271520e-05 ||∇||=3.701186e-01 | Tr=0.0969 Te/Cur=0.0715 Te/Exp=0.2828]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.70s/it] 50%|█████     | 1/2 [00:07<00:05,  5.70s/it, CE=2.261092e+00 H=2.261028e+00 dV_dx=-8.323058e-06 dV_dθ=-5.627955e-05 ||∇||=3.797416e-01 | Tr=0.0924 Te/Cur=0.0825 Te/Exp=0.2418]100%|██████████| 2/2 [00:07<00:00,  3.54s/it, CE=2.261092e+00 H=2.261028e+00 dV_dx=-8.323058e-06 dV_dθ=-5.627955e-05 ||∇||=3.797416e-01 | Tr=0.0924 Te/Cur=0.0825 Te/Exp=0.2418]100%|██████████| 2/2 [00:07<00:00,  3.87s/it, CE=2.261092e+00 H=2.261028e+00 dV_dx=-8.323058e-06 dV_dθ=-5.627955e-05 ||∇||=3.797416e-01 | Tr=0.0924 Te/Cur=0.0825 Te/Exp=0.2418]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09, 10.00s/it] 50%|█████     | 1/2 [00:11<00:09, 10.00s/it, CE=2.264286e+00 H=2.264209e+00 dV_dx=-1.216887e-05 dV_dθ=-6.493125e-05 ||∇||=3.732293e-01 | Tr=0.0847 Te/Cur=0.0638 Te/Exp=0.2430]100%|██████████| 2/2 [00:11<00:00,  5.19s/it, CE=2.264286e+00 H=2.264209e+00 dV_dx=-1.216887e-05 dV_dθ=-6.493125e-05 ||∇||=3.732293e-01 | Tr=0.0847 Te/Cur=0.0638 Te/Exp=0.2430]100%|██████████| 2/2 [00:11<00:00,  5.91s/it, CE=2.264286e+00 H=2.264209e+00 dV_dx=-1.216887e-05 dV_dθ=-6.493125e-05 ||∇||=3.732293e-01 | Tr=0.0847 Te/Cur=0.0638 Te/Exp=0.2430]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.56s/it] 50%|█████     | 1/2 [00:09<00:07,  7.56s/it, CE=2.288949e+00 H=2.288891e+00 dV_dx=2.224974e-06 dV_dθ=-6.036920e-05 ||∇||=3.403023e-01 | Tr=0.1914 Te/Cur=0.1794 Te/Exp=0.1457]100%|██████████| 2/2 [00:09<00:00,  4.19s/it, CE=2.288949e+00 H=2.288891e+00 dV_dx=2.224974e-06 dV_dθ=-6.036920e-05 ||∇||=3.403023e-01 | Tr=0.1914 Te/Cur=0.1794 Te/Exp=0.1457]100%|██████████| 2/2 [00:09<00:00,  4.70s/it, CE=2.288949e+00 H=2.288891e+00 dV_dx=2.224974e-06 dV_dθ=-6.036920e-05 ||∇||=3.403023e-01 | Tr=0.1914 Te/Cur=0.1794 Te/Exp=0.1457]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2889493509724668
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.48s/it] 50%|█████     | 1/2 [00:06<00:05,  5.48s/it, CE=2.284992e+00 H=2.284945e+00 dV_dx=-3.460737e-06 dV_dθ=-4.373641e-05 ||∇||=3.495028e-01 | Tr=0.0878 Te/Cur=0.1102 Te/Exp=0.2007]100%|██████████| 2/2 [00:06<00:00,  3.11s/it, CE=2.284992e+00 H=2.284945e+00 dV_dx=-3.460737e-06 dV_dθ=-4.373641e-05 ||∇||=3.495028e-01 | Tr=0.0878 Te/Cur=0.1102 Te/Exp=0.2007]100%|██████████| 2/2 [00:06<00:00,  3.47s/it, CE=2.284992e+00 H=2.284945e+00 dV_dx=-3.460737e-06 dV_dθ=-4.373641e-05 ||∇||=3.495028e-01 | Tr=0.0878 Te/Cur=0.1102 Te/Exp=0.2007]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 104, 10]) with loss 2.284992
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.65s/it] 50%|█████     | 1/2 [00:06<00:05,  5.65s/it, CE=2.284267e+00 H=2.284199e+00 dV_dx=-3.538178e-06 dV_dθ=-6.441995e-05 ||∇||=3.261218e-01 | Tr=0.1424 Te/Cur=0.1765 Te/Exp=0.1976]100%|██████████| 2/2 [00:06<00:00,  3.10s/it, CE=2.284267e+00 H=2.284199e+00 dV_dx=-3.538178e-06 dV_dθ=-6.441995e-05 ||∇||=3.261218e-01 | Tr=0.1424 Te/Cur=0.1765 Te/Exp=0.1976]100%|██████████| 2/2 [00:06<00:00,  3.48s/it, CE=2.284267e+00 H=2.284199e+00 dV_dx=-3.538178e-06 dV_dθ=-6.441995e-05 ||∇||=3.261218e-01 | Tr=0.1424 Te/Cur=0.1765 Te/Exp=0.1976]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 672, 104, 10]) with loss 2.284267
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.23s/it] 50%|█████     | 1/2 [00:06<00:05,  5.23s/it, CE=2.283635e+00 H=2.283570e+00 dV_dx=1.777552e-06 dV_dθ=-6.647408e-05 ||∇||=3.733500e-01 | Tr=0.1186 Te/Cur=0.1463 Te/Exp=0.2273]100%|██████████| 2/2 [00:06<00:00,  3.18s/it, CE=2.283635e+00 H=2.283570e+00 dV_dx=1.777552e-06 dV_dθ=-6.647408e-05 ||∇||=3.733500e-01 | Tr=0.1186 Te/Cur=0.1463 Te/Exp=0.2273]100%|██████████| 2/2 [00:06<00:00,  3.49s/it, CE=2.283635e+00 H=2.283570e+00 dV_dx=1.777552e-06 dV_dθ=-6.647408e-05 ||∇||=3.733500e-01 | Tr=0.1186 Te/Cur=0.1463 Te/Exp=0.2273]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 592, 144, 10]) with loss 2.283635
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.23s/it] 50%|█████     | 1/2 [00:05<00:03,  3.23s/it, CE=2.267237e+00 H=2.267176e+00 dV_dx=-4.103840e-06 dV_dθ=-5.713143e-05 ||∇||=3.527074e-01 | Tr=0.1176 Te/Cur=0.1280 Te/Exp=0.2068]100%|██████████| 2/2 [00:05<00:00,  2.42s/it, CE=2.267237e+00 H=2.267176e+00 dV_dx=-4.103840e-06 dV_dθ=-5.713143e-05 ||∇||=3.527074e-01 | Tr=0.1176 Te/Cur=0.1280 Te/Exp=0.2068]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.267237e+00 H=2.267176e+00 dV_dx=-4.103840e-06 dV_dθ=-5.713143e-05 ||∇||=3.527074e-01 | Tr=0.1176 Te/Cur=0.1280 Te/Exp=0.2068]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.267237
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.08s/it] 50%|█████     | 1/2 [00:07<00:05,  5.08s/it, CE=2.285896e+00 H=2.285852e+00 dV_dx=4.249609e-07 dV_dθ=-4.441746e-05 ||∇||=3.189911e-01 | Tr=0.2055 Te/Cur=0.2459 Te/Exp=0.1965]100%|██████████| 2/2 [00:07<00:00,  3.25s/it, CE=2.285896e+00 H=2.285852e+00 dV_dx=4.249609e-07 dV_dθ=-4.441746e-05 ||∇||=3.189911e-01 | Tr=0.2055 Te/Cur=0.2459 Te/Exp=0.1965]100%|██████████| 2/2 [00:07<00:00,  3.53s/it, CE=2.285896e+00 H=2.285852e+00 dV_dx=4.249609e-07 dV_dθ=-4.441746e-05 ||∇||=3.189911e-01 | Tr=0.2055 Te/Cur=0.2459 Te/Exp=0.1965]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.93s/it] 50%|█████     | 1/2 [00:06<00:04,  4.93s/it, CE=2.275914e+00 H=2.275858e+00 dV_dx=-4.078854e-06 dV_dθ=-5.173596e-05 ||∇||=3.948426e-01 | Tr=0.1089 Te/Cur=0.0618 Te/Exp=0.2112]100%|██████████| 2/2 [00:06<00:00,  3.06s/it, CE=2.275914e+00 H=2.275858e+00 dV_dx=-4.078854e-06 dV_dθ=-5.173596e-05 ||∇||=3.948426e-01 | Tr=0.1089 Te/Cur=0.0618 Te/Exp=0.2112]100%|██████████| 2/2 [00:06<00:00,  3.34s/it, CE=2.275914e+00 H=2.275858e+00 dV_dx=-4.078854e-06 dV_dθ=-5.173596e-05 ||∇||=3.948426e-01 | Tr=0.1089 Te/Cur=0.0618 Te/Exp=0.2112]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.03s/it] 50%|█████     | 1/2 [00:09<00:08,  8.03s/it, CE=2.272047e+00 H=2.272031e+00 dV_dx=-3.563065e-06 dV_dθ=-1.283489e-05 ||∇||=3.506503e-01 | Tr=0.0912 Te/Cur=0.0614 Te/Exp=0.2270]100%|██████████| 2/2 [00:09<00:00,  4.43s/it, CE=2.272047e+00 H=2.272031e+00 dV_dx=-3.563065e-06 dV_dθ=-1.283489e-05 ||∇||=3.506503e-01 | Tr=0.0912 Te/Cur=0.0614 Te/Exp=0.2270]100%|██████████| 2/2 [00:09<00:00,  4.97s/it, CE=2.272047e+00 H=2.272031e+00 dV_dx=-3.563065e-06 dV_dθ=-1.283489e-05 ||∇||=3.506503e-01 | Tr=0.0912 Te/Cur=0.0614 Te/Exp=0.2270]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.29s/it] 50%|█████     | 1/2 [00:07<00:06,  6.29s/it, CE=2.278798e+00 H=2.278758e+00 dV_dx=4.655968e-06 dV_dθ=-4.444929e-05 ||∇||=3.440651e-01 | Tr=0.0871 Te/Cur=0.1108 Te/Exp=0.1907]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.278798e+00 H=2.278758e+00 dV_dx=4.655968e-06 dV_dθ=-4.444929e-05 ||∇||=3.440651e-01 | Tr=0.0871 Te/Cur=0.1108 Te/Exp=0.1907]100%|██████████| 2/2 [00:07<00:00,  3.96s/it, CE=2.278798e+00 H=2.278758e+00 dV_dx=4.655968e-06 dV_dθ=-4.444929e-05 ||∇||=3.440651e-01 | Tr=0.0871 Te/Cur=0.1108 Te/Exp=0.1907]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.49s/it] 50%|█████     | 1/2 [00:07<00:05,  5.49s/it, CE=2.239370e+00 H=2.239278e+00 dV_dx=-6.557353e-06 dV_dθ=-8.581410e-05 ||∇||=4.859141e-01 | Tr=0.1709 Te/Cur=0.1767 Te/Exp=0.2926]100%|██████████| 2/2 [00:07<00:00,  3.38s/it, CE=2.239370e+00 H=2.239278e+00 dV_dx=-6.557353e-06 dV_dθ=-8.581410e-05 ||∇||=4.859141e-01 | Tr=0.1709 Te/Cur=0.1767 Te/Exp=0.2926]100%|██████████| 2/2 [00:07<00:00,  3.69s/it, CE=2.239370e+00 H=2.239278e+00 dV_dx=-6.557353e-06 dV_dθ=-8.581410e-05 ||∇||=4.859141e-01 | Tr=0.1709 Te/Cur=0.1767 Te/Exp=0.2926]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 592, 104, 10]) with loss 2.239370
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.41s/it] 50%|█████     | 1/2 [00:07<00:05,  5.41s/it, CE=2.229308e+00 H=2.229206e+00 dV_dx=-2.581584e-06 dV_dθ=-9.875496e-05 ||∇||=4.838716e-01 | Tr=0.1256 Te/Cur=0.1507 Te/Exp=0.2853]100%|██████████| 2/2 [00:07<00:00,  3.26s/it, CE=2.229308e+00 H=2.229206e+00 dV_dx=-2.581584e-06 dV_dθ=-9.875496e-05 ||∇||=4.838716e-01 | Tr=0.1256 Te/Cur=0.1507 Te/Exp=0.2853]100%|██████████| 2/2 [00:07<00:00,  3.58s/it, CE=2.229308e+00 H=2.229206e+00 dV_dx=-2.581584e-06 dV_dθ=-9.875496e-05 ||∇||=4.838716e-01 | Tr=0.1256 Te/Cur=0.1507 Te/Exp=0.2853]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 632, 104, 10]) with loss 2.229308
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.33s/it] 50%|█████     | 1/2 [00:07<00:05,  5.33s/it, CE=2.210696e+00 H=2.210594e+00 dV_dx=-1.205149e-07 dV_dθ=-1.023837e-04 ||∇||=4.809518e-01 | Tr=0.1584 Te/Cur=0.2027 Te/Exp=0.3346]100%|██████████| 2/2 [00:07<00:00,  3.35s/it, CE=2.210696e+00 H=2.210594e+00 dV_dx=-1.205149e-07 dV_dθ=-1.023837e-04 ||∇||=4.809518e-01 | Tr=0.1584 Te/Cur=0.2027 Te/Exp=0.3346]100%|██████████| 2/2 [00:07<00:00,  3.65s/it, CE=2.210696e+00 H=2.210594e+00 dV_dx=-1.205149e-07 dV_dθ=-1.023837e-04 ||∇||=4.809518e-01 | Tr=0.1584 Te/Cur=0.2027 Te/Exp=0.3346]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 672, 104, 10]) with loss 2.210696
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.38s/it] 50%|█████     | 1/2 [00:06<00:05,  5.38s/it, CE=2.234608e+00 H=2.234508e+00 dV_dx=-2.652072e-06 dV_dθ=-9.749174e-05 ||∇||=5.232290e-01 | Tr=0.1128 Te/Cur=0.1024 Te/Exp=0.3107]100%|██████████| 2/2 [00:06<00:00,  3.07s/it, CE=2.234608e+00 H=2.234508e+00 dV_dx=-2.652072e-06 dV_dθ=-9.749174e-05 ||∇||=5.232290e-01 | Tr=0.1128 Te/Cur=0.1024 Te/Exp=0.3107]100%|██████████| 2/2 [00:06<00:00,  3.42s/it, CE=2.234608e+00 H=2.234508e+00 dV_dx=-2.652072e-06 dV_dθ=-9.749174e-05 ||∇||=5.232290e-01 | Tr=0.1128 Te/Cur=0.1024 Te/Exp=0.3107]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.35s/it] 50%|█████     | 1/2 [00:05<00:03,  3.35s/it, CE=2.207265e+00 H=2.207188e+00 dV_dx=-2.249700e-06 dV_dθ=-7.477958e-05 ||∇||=4.830531e-01 | Tr=0.1058 Te/Cur=0.1234 Te/Exp=0.3098]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.207265e+00 H=2.207188e+00 dV_dx=-2.249700e-06 dV_dθ=-7.477958e-05 ||∇||=4.830531e-01 | Tr=0.1058 Te/Cur=0.1234 Te/Exp=0.3098]100%|██████████| 2/2 [00:05<00:00,  2.69s/it, CE=2.207265e+00 H=2.207188e+00 dV_dx=-2.249700e-06 dV_dθ=-7.477958e-05 ||∇||=4.830531e-01 | Tr=0.1058 Te/Cur=0.1234 Te/Exp=0.3098]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (3, [507, 632, 144, 10]) with loss 2.207265
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.86s/it] 50%|█████     | 1/2 [00:09<00:07,  7.86s/it, CE=2.217643e+00 H=2.217530e+00 dV_dx=-6.191676e-06 dV_dθ=-1.066545e-04 ||∇||=4.652059e-01 | Tr=0.1920 Te/Cur=0.2529 Te/Exp=0.3233]100%|██████████| 2/2 [00:09<00:00,  4.43s/it, CE=2.217643e+00 H=2.217530e+00 dV_dx=-6.191676e-06 dV_dθ=-1.066545e-04 ||∇||=4.652059e-01 | Tr=0.1920 Te/Cur=0.2529 Te/Exp=0.3233]100%|██████████| 2/2 [00:09<00:00,  4.94s/it, CE=2.217643e+00 H=2.217530e+00 dV_dx=-6.191676e-06 dV_dθ=-1.066545e-04 ||∇||=4.652059e-01 | Tr=0.1920 Te/Cur=0.2529 Te/Exp=0.3233]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.69s/it] 50%|█████     | 1/2 [00:07<00:05,  5.69s/it, CE=2.246656e+00 H=2.246566e+00 dV_dx=3.836123e-08 dV_dθ=-9.066583e-05 ||∇||=4.940394e-01 | Tr=0.1676 Te/Cur=0.2502 Te/Exp=0.2867]100%|██████████| 2/2 [00:07<00:00,  3.47s/it, CE=2.246656e+00 H=2.246566e+00 dV_dx=3.836123e-08 dV_dθ=-9.066583e-05 ||∇||=4.940394e-01 | Tr=0.1676 Te/Cur=0.2502 Te/Exp=0.2867]100%|██████████| 2/2 [00:07<00:00,  3.81s/it, CE=2.246656e+00 H=2.246566e+00 dV_dx=3.836123e-08 dV_dθ=-9.066583e-05 ||∇||=4.940394e-01 | Tr=0.1676 Te/Cur=0.2502 Te/Exp=0.2867]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.18s/it] 50%|█████     | 1/2 [00:07<00:06,  6.18s/it, CE=2.210217e+00 H=2.210134e+00 dV_dx=-1.158563e-06 dV_dθ=-8.185633e-05 ||∇||=4.924955e-01 | Tr=0.1461 Te/Cur=0.1870 Te/Exp=0.3322]100%|██████████| 2/2 [00:07<00:00,  3.53s/it, CE=2.210217e+00 H=2.210134e+00 dV_dx=-1.158563e-06 dV_dθ=-8.185633e-05 ||∇||=4.924955e-01 | Tr=0.1461 Te/Cur=0.1870 Te/Exp=0.3322]100%|██████████| 2/2 [00:07<00:00,  3.93s/it, CE=2.210217e+00 H=2.210134e+00 dV_dx=-1.158563e-06 dV_dθ=-8.185633e-05 ||∇||=4.924955e-01 | Tr=0.1461 Te/Cur=0.1870 Te/Exp=0.3322]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.01s/it] 50%|█████     | 1/2 [00:06<00:05,  5.01s/it, CE=2.209050e+00 H=2.208962e+00 dV_dx=-7.328290e-06 dV_dθ=-8.115007e-05 ||∇||=4.908146e-01 | Tr=0.1022 Te/Cur=0.1253 Te/Exp=0.3048]100%|██████████| 2/2 [00:06<00:00,  3.22s/it, CE=2.209050e+00 H=2.208962e+00 dV_dx=-7.328290e-06 dV_dθ=-8.115007e-05 ||∇||=4.908146e-01 | Tr=0.1022 Te/Cur=0.1253 Te/Exp=0.3048]100%|██████████| 2/2 [00:06<00:00,  3.49s/it, CE=2.209050e+00 H=2.208962e+00 dV_dx=-7.328290e-06 dV_dθ=-8.115007e-05 ||∇||=4.908146e-01 | Tr=0.1022 Te/Cur=0.1253 Te/Exp=0.3048]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.64s/it] 50%|█████     | 1/2 [00:07<00:05,  5.64s/it, CE=2.243447e+00 H=2.243337e+00 dV_dx=-1.306850e-05 dV_dθ=-9.768211e-05 ||∇||=4.377797e-01 | Tr=0.1018 Te/Cur=0.0979 Te/Exp=0.2396]100%|██████████| 2/2 [00:07<00:00,  3.33s/it, CE=2.243447e+00 H=2.243337e+00 dV_dx=-1.306850e-05 dV_dθ=-9.768211e-05 ||∇||=4.377797e-01 | Tr=0.1018 Te/Cur=0.0979 Te/Exp=0.2396]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.243447e+00 H=2.243337e+00 dV_dx=-1.306850e-05 dV_dθ=-9.768211e-05 ||∇||=4.377797e-01 | Tr=0.1018 Te/Cur=0.0979 Te/Exp=0.2396]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.33s/it] 50%|█████     | 1/2 [00:06<00:05,  5.33s/it, CE=2.259420e+00 H=2.259311e+00 dV_dx=3.792755e-06 dV_dθ=-1.135678e-04 ||∇||=4.564788e-01 | Tr=0.1514 Te/Cur=0.1812 Te/Exp=0.2502]100%|██████████| 2/2 [00:06<00:00,  3.15s/it, CE=2.259420e+00 H=2.259311e+00 dV_dx=3.792755e-06 dV_dθ=-1.135678e-04 ||∇||=4.564788e-01 | Tr=0.1514 Te/Cur=0.1812 Te/Exp=0.2502]100%|██████████| 2/2 [00:06<00:00,  3.48s/it, CE=2.259420e+00 H=2.259311e+00 dV_dx=3.792755e-06 dV_dθ=-1.135678e-04 ||∇||=4.564788e-01 | Tr=0.1514 Te/Cur=0.1812 Te/Exp=0.2502]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.48s/it] 50%|█████     | 1/2 [00:07<00:05,  5.48s/it, CE=2.247288e+00 H=2.247239e+00 dV_dx=-1.469446e-06 dV_dθ=-4.717017e-05 ||∇||=4.041537e-01 | Tr=0.0989 Te/Cur=0.0977 Te/Exp=0.2632]100%|██████████| 2/2 [00:07<00:00,  3.45s/it, CE=2.247288e+00 H=2.247239e+00 dV_dx=-1.469446e-06 dV_dθ=-4.717017e-05 ||∇||=4.041537e-01 | Tr=0.0989 Te/Cur=0.0977 Te/Exp=0.2632]100%|██████████| 2/2 [00:07<00:00,  3.75s/it, CE=2.247288e+00 H=2.247239e+00 dV_dx=-1.469446e-06 dV_dθ=-4.717017e-05 ||∇||=4.041537e-01 | Tr=0.0989 Te/Cur=0.0977 Te/Exp=0.2632]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.82s/it] 50%|█████     | 1/2 [00:10<00:08,  8.82s/it, CE=2.243721e+00 H=2.243648e+00 dV_dx=6.889741e-06 dV_dθ=-7.977779e-05 ||∇||=4.590598e-01 | Tr=0.1857 Te/Cur=0.2402 Te/Exp=0.2648]100%|██████████| 2/2 [00:10<00:00,  4.58s/it, CE=2.243721e+00 H=2.243648e+00 dV_dx=6.889741e-06 dV_dθ=-7.977779e-05 ||∇||=4.590598e-01 | Tr=0.1857 Te/Cur=0.2402 Te/Exp=0.2648]100%|██████████| 2/2 [00:10<00:00,  5.22s/it, CE=2.243721e+00 H=2.243648e+00 dV_dx=6.889741e-06 dV_dθ=-7.977779e-05 ||∇||=4.590598e-01 | Tr=0.1857 Te/Cur=0.2402 Te/Exp=0.2648]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.22s/it] 50%|█████     | 1/2 [00:06<00:04,  4.22s/it, CE=2.213860e+00 H=2.213704e+00 dV_dx=-2.883060e-05 dV_dθ=-1.275158e-04 ||∇||=4.990267e-01 | Tr=0.1780 Te/Cur=0.2241 Te/Exp=0.3327]100%|██████████| 2/2 [00:06<00:00,  3.13s/it, CE=2.213860e+00 H=2.213704e+00 dV_dx=-2.883060e-05 dV_dθ=-1.275158e-04 ||∇||=4.990267e-01 | Tr=0.1780 Te/Cur=0.2241 Te/Exp=0.3327]100%|██████████| 2/2 [00:06<00:00,  3.29s/it, CE=2.213860e+00 H=2.213704e+00 dV_dx=-2.883060e-05 dV_dθ=-1.275158e-04 ||∇||=4.990267e-01 | Tr=0.1780 Te/Cur=0.2241 Te/Exp=0.3327]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.58s/it] 50%|█████     | 1/2 [00:07<00:05,  5.58s/it, CE=2.245536e+00 H=2.245423e+00 dV_dx=-6.823230e-06 dV_dθ=-1.064437e-04 ||∇||=4.379357e-01 | Tr=0.1450 Te/Cur=0.1471 Te/Exp=0.2649]100%|██████████| 2/2 [00:07<00:00,  3.45s/it, CE=2.245536e+00 H=2.245423e+00 dV_dx=-6.823230e-06 dV_dθ=-1.064437e-04 ||∇||=4.379357e-01 | Tr=0.1450 Te/Cur=0.1471 Te/Exp=0.2649]100%|██████████| 2/2 [00:07<00:00,  3.77s/it, CE=2.245536e+00 H=2.245423e+00 dV_dx=-6.823230e-06 dV_dθ=-1.064437e-04 ||∇||=4.379357e-01 | Tr=0.1450 Te/Cur=0.1471 Te/Exp=0.2649]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.32s/it] 50%|█████     | 1/2 [00:07<00:06,  6.32s/it, CE=2.261927e+00 H=2.261804e+00 dV_dx=-5.737004e-06 dV_dθ=-1.178264e-04 ||∇||=4.658783e-01 | Tr=0.1105 Te/Cur=0.1328 Te/Exp=0.2660]100%|██████████| 2/2 [00:07<00:00,  3.55s/it, CE=2.261927e+00 H=2.261804e+00 dV_dx=-5.737004e-06 dV_dθ=-1.178264e-04 ||∇||=4.658783e-01 | Tr=0.1105 Te/Cur=0.1328 Te/Exp=0.2660]100%|██████████| 2/2 [00:07<00:00,  3.96s/it, CE=2.261927e+00 H=2.261804e+00 dV_dx=-5.737004e-06 dV_dθ=-1.178264e-04 ||∇||=4.658783e-01 | Tr=0.1105 Te/Cur=0.1328 Te/Exp=0.2660]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.41s/it] 50%|█████     | 1/2 [00:06<00:05,  5.41s/it, CE=2.241644e+00 H=2.241552e+00 dV_dx=2.753039e-06 dV_dθ=-9.414608e-05 ||∇||=4.520131e-01 | Tr=0.1826 Te/Cur=0.2057 Te/Exp=0.3005]100%|██████████| 2/2 [00:06<00:00,  3.12s/it, CE=2.241644e+00 H=2.241552e+00 dV_dx=2.753039e-06 dV_dθ=-9.414608e-05 ||∇||=4.520131e-01 | Tr=0.1826 Te/Cur=0.2057 Te/Exp=0.3005]100%|██████████| 2/2 [00:06<00:00,  3.47s/it, CE=2.241644e+00 H=2.241552e+00 dV_dx=2.753039e-06 dV_dθ=-9.414608e-05 ||∇||=4.520131e-01 | Tr=0.1826 Te/Cur=0.2057 Te/Exp=0.3005]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.62s/it] 50%|█████     | 1/2 [00:06<00:04,  4.62s/it, CE=2.241755e+00 H=2.241651e+00 dV_dx=-1.098960e-05 dV_dθ=-9.339136e-05 ||∇||=4.666519e-01 | Tr=0.1198 Te/Cur=0.1306 Te/Exp=0.3201]100%|██████████| 2/2 [00:06<00:00,  2.92s/it, CE=2.241755e+00 H=2.241651e+00 dV_dx=-1.098960e-05 dV_dθ=-9.339136e-05 ||∇||=4.666519e-01 | Tr=0.1198 Te/Cur=0.1306 Te/Exp=0.3201]100%|██████████| 2/2 [00:06<00:00,  3.18s/it, CE=2.241755e+00 H=2.241651e+00 dV_dx=-1.098960e-05 dV_dθ=-9.339136e-05 ||∇||=4.666519e-01 | Tr=0.1198 Te/Cur=0.1306 Te/Exp=0.3201]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (3, [507, 632, 144, 10]) with loss 2.207265
  Total candidates evaluated: 54
  Original: (2, [507, 632, 144, 10])
  Optimal: (3, [507, 632, 144, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→3, feed [507, 632, 144, 10]→[507, 632, 144, 10]
  Conv filter changed: A_conv/B_conv shape = (3, 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:16<05:16, 16.68s/it]  5%|▌         | 1/20 [00:19<05:16, 16.68s/it, CE=2.012379e+00 H=1.949008e+00 dV_dx=9.586714e-05 dV_dθ=-6.346696e-02 ||∇||=1.054114e+01 | Tr=0.7814] 10%|█         | 2/20 [00:19<02:31,  8.40s/it, CE=2.012379e+00 H=1.949008e+00 dV_dx=9.586714e-05 dV_dθ=-6.346696e-02 ||∇||=1.054114e+01 | Tr=0.7814] 10%|█         | 2/20 [00:21<02:31,  8.40s/it, CE=1.712306e+00 H=1.652555e+00 dV_dx=-5.752588e-05 dV_dθ=-5.969354e-02 ||∇||=1.043647e+01 | Tr=0.7814] 15%|█▌        | 3/20 [00:21<01:36,  5.67s/it, CE=1.712306e+00 H=1.652555e+00 dV_dx=-5.752588e-05 dV_dθ=-5.969354e-02 ||∇||=1.043647e+01 | Tr=0.7814] 15%|█▌        | 3/20 [00:24<01:36,  5.67s/it, CE=1.502279e+00 H=1.424415e+00 dV_dx=3.320252e-05 dV_dθ=-7.789770e-02 ||∇||=1.044864e+01 | Tr=0.7814]  20%|██        | 4/20 [00:24<01:09,  4.35s/it, CE=1.502279e+00 H=1.424415e+00 dV_dx=3.320252e-05 dV_dθ=-7.789770e-02 ||∇||=1.044864e+01 | Tr=0.7814] 20%|██        | 4/20 [00:26<01:09,  4.35s/it, CE=1.347251e+00 H=1.143427e+00 dV_dx=-4.486130e-05 dV_dθ=-2.037789e-01 ||∇||=1.397604e+01 | Tr=0.7814] 25%|██▌       | 5/20 [00:26<00:53,  3.59s/it, CE=1.347251e+00 H=1.143427e+00 dV_dx=-4.486130e-05 dV_dθ=-2.037789e-01 ||∇||=1.397604e+01 | Tr=0.7814] 25%|██▌       | 5/20 [00:28<00:53,  3.59s/it, CE=1.228733e+00 H=1.040772e+00 dV_dx=4.487944e-05 dV_dθ=-1.880051e-01 ||∇||=1.324112e+01 | Tr=0.7814]  30%|███       | 6/20 [00:28<00:44,  3.19s/it, CE=1.228733e+00 H=1.040772e+00 dV_dx=4.487944e-05 dV_dθ=-1.880051e-01 ||∇||=1.324112e+01 | Tr=0.7814] 30%|███       | 6/20 [00:31<00:44,  3.19s/it, CE=1.139923e+00 H=9.608387e-01 dV_dx=2.197319e-05 dV_dθ=-1.791062e-01 ||∇||=1.282260e+01 | Tr=0.7814] 35%|███▌      | 7/20 [00:31<00:40,  3.10s/it, CE=1.139923e+00 H=9.608387e-01 dV_dx=2.197319e-05 dV_dθ=-1.791062e-01 ||∇||=1.282260e+01 | Tr=0.7814] 35%|███▌      | 7/20 [00:33<00:40,  3.10s/it, CE=1.069749e+00 H=8.616852e-01 dV_dx=3.389631e-05 dV_dθ=-2.080981e-01 ||∇||=1.350727e+01 | Tr=0.7814] 40%|████      | 8/20 [00:33<00:33,  2.76s/it, CE=1.069749e+00 H=8.616852e-01 dV_dx=3.389631e-05 dV_dθ=-2.080981e-01 ||∇||=1.350727e+01 | Tr=0.7814] 40%|████      | 8/20 [00:36<00:33,  2.76s/it, CE=1.012507e+00 H=7.895582e-01 dV_dx=-7.095057e-06 dV_dθ=-2.229416e-01 ||∇||=1.368532e+01 | Tr=0.7814] 45%|████▌     | 9/20 [00:36<00:30,  2.77s/it, CE=1.012507e+00 H=7.895582e-01 dV_dx=-7.095057e-06 dV_dθ=-2.229416e-01 ||∇||=1.368532e+01 | Tr=0.7814] 45%|████▌     | 9/20 [00:38<00:30,  2.77s/it, CE=9.637445e-01 H=7.255899e-01 dV_dx=4.530506e-05 dV_dθ=-2.381999e-01 ||∇||=1.368455e+01 | Tr=0.7814]  50%|█████     | 10/20 [00:38<00:25,  2.56s/it, CE=9.637445e-01 H=7.255899e-01 dV_dx=4.530506e-05 dV_dθ=-2.381999e-01 ||∇||=1.368455e+01 | Tr=0.7814] 50%|█████     | 10/20 [00:41<00:25,  2.56s/it, CE=9.211578e-01 H=6.874233e-01 dV_dx=1.150014e-04 dV_dθ=-2.338495e-01 ||∇||=1.336888e+01 | Tr=0.7814] 55%|█████▌    | 11/20 [00:41<00:23,  2.64s/it, CE=9.211578e-01 H=6.874233e-01 dV_dx=1.150014e-04 dV_dθ=-2.338495e-01 ||∇||=1.336888e+01 | Tr=0.7814] 55%|█████▌    | 11/20 [00:44<00:23,  2.64s/it, CE=8.829927e-01 H=6.873525e-01 dV_dx=7.016073e-05 dV_dθ=-1.957104e-01 ||∇||=1.255266e+01 | Tr=0.7814] 60%|██████    | 12/20 [00:44<00:21,  2.72s/it, CE=8.829927e-01 H=6.873525e-01 dV_dx=7.016073e-05 dV_dθ=-1.957104e-01 ||∇||=1.255266e+01 | Tr=0.7814] 60%|██████    | 12/20 [00:46<00:21,  2.72s/it, CE=8.513835e-01 H=6.628051e-01 dV_dx=1.923706e-05 dV_dθ=-1.885977e-01 ||∇||=1.294657e+01 | Tr=0.7814] 65%|██████▌   | 13/20 [00:46<00:18,  2.66s/it, CE=8.513835e-01 H=6.628051e-01 dV_dx=1.923706e-05 dV_dθ=-1.885977e-01 ||∇||=1.294657e+01 | Tr=0.7814] 65%|██████▌   | 13/20 [00:49<00:18,  2.66s/it, CE=8.221070e-01 H=6.538088e-01 dV_dx=-2.563716e-07 dV_dθ=-1.682980e-01 ||∇||=1.254501e+01 | Tr=0.7814] 70%|███████   | 14/20 [00:49<00:16,  2.70s/it, CE=8.221070e-01 H=6.538088e-01 dV_dx=-2.563716e-07 dV_dθ=-1.682980e-01 ||∇||=1.254501e+01 | Tr=0.7814] 70%|███████   | 14/20 [00:52<00:16,  2.70s/it, CE=7.963288e-01 H=6.334313e-01 dV_dx=-6.480023e-05 dV_dθ=-1.628327e-01 ||∇||=1.253567e+01 | Tr=0.7814] 75%|███████▌  | 15/20 [00:52<00:13,  2.72s/it, CE=7.963288e-01 H=6.334313e-01 dV_dx=-6.480023e-05 dV_dθ=-1.628327e-01 ||∇||=1.253567e+01 | Tr=0.7814] 75%|███████▌  | 15/20 [00:55<00:13,  2.72s/it, CE=7.731080e-01 H=6.137356e-01 dV_dx=5.656446e-05 dV_dθ=-1.594290e-01 ||∇||=1.244655e+01 | Tr=0.7814]  80%|████████  | 16/20 [00:55<00:11,  2.77s/it, CE=7.731080e-01 H=6.137356e-01 dV_dx=5.656446e-05 dV_dθ=-1.594290e-01 ||∇||=1.244655e+01 | Tr=0.7814] 80%|████████  | 16/20 [00:58<00:11,  2.77s/it, CE=7.516208e-01 H=5.876507e-01 dV_dx=-4.707576e-05 dV_dθ=-1.639230e-01 ||∇||=1.245117e+01 | Tr=0.7814] 85%|████████▌ | 17/20 [00:58<00:08,  2.82s/it, CE=7.516208e-01 H=5.876507e-01 dV_dx=-4.707576e-05 dV_dθ=-1.639230e-01 ||∇||=1.245117e+01 | Tr=0.7814] 85%|████████▌ | 17/20 [01:00<00:08,  2.82s/it, CE=7.321858e-01 H=5.618767e-01 dV_dx=-2.806459e-05 dV_dθ=-1.702810e-01 ||∇||=1.247951e+01 | Tr=0.7814] 90%|█████████ | 18/20 [01:00<00:05,  2.70s/it, CE=7.321858e-01 H=5.618767e-01 dV_dx=-2.806459e-05 dV_dθ=-1.702810e-01 ||∇||=1.247951e+01 | Tr=0.7814] 90%|█████████ | 18/20 [01:02<00:05,  2.70s/it, CE=7.159934e-01 H=4.999646e-01 dV_dx=3.055352e-05 dV_dθ=-2.160593e-01 ||∇||=1.368784e+01 | Tr=0.7814]  95%|█████████▌| 19/20 [01:02<00:02,  2.47s/it, CE=7.159934e-01 H=4.999646e-01 dV_dx=3.055352e-05 dV_dθ=-2.160593e-01 ||∇||=1.368784e+01 | Tr=0.7814] 95%|█████████▌| 19/20 [01:07<00:02,  2.47s/it, CE=7.012367e-01 H=4.295650e-01 dV_dx=-3.960221e-07 dV_dθ=-2.716714e-01 ||∇||=1.551878e+01 | Tr=0.7814 Te/Cur=0.9247 Te/Exp=0.7478]100%|██████████| 20/20 [01:12<00:00,  4.71s/it, CE=7.012367e-01 H=4.295650e-01 dV_dx=-3.960221e-07 dV_dθ=-2.716714e-01 ||∇||=1.551878e+01 | Tr=0.7814 Te/Cur=0.9247 Te/Exp=0.7478]100%|██████████| 20/20 [01:12<00:00,  3.62s/it, CE=7.012367e-01 H=4.295650e-01 dV_dx=-3.960221e-07 dV_dθ=-2.716714e-01 ||∇||=1.551878e+01 | Tr=0.7814 Te/Cur=0.9247 Te/Exp=0.7478]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.641678
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:07<02:19,  7.32s/it]  5%|▌         | 1/20 [00:09<02:19,  7.32s/it, CE=7.077720e-01 H=6.558747e-01 dV_dx=-6.594617e-05 dV_dθ=-5.183141e-02 ||∇||=8.444028e+00 | Tr=0.7818] 10%|█         | 2/20 [00:09<01:19,  4.44s/it, CE=7.077720e-01 H=6.558747e-01 dV_dx=-6.594617e-05 dV_dθ=-5.183141e-02 ||∇||=8.444028e+00 | Tr=0.7818] 10%|█         | 2/20 [00:11<01:19,  4.44s/it, CE=6.868204e-01 H=6.395134e-01 dV_dx=6.707426e-06 dV_dθ=-4.731374e-02 ||∇||=8.285247e+00 | Tr=0.7818]  15%|█▌        | 3/20 [00:11<00:58,  3.44s/it, CE=6.868204e-01 H=6.395134e-01 dV_dx=6.707426e-06 dV_dθ=-4.731374e-02 ||∇||=8.285247e+00 | Tr=0.7818] 15%|█▌        | 3/20 [00:14<00:58,  3.44s/it, CE=6.686379e-01 H=6.186083e-01 dV_dx=1.558635e-05 dV_dθ=-5.004527e-02 ||∇||=8.262954e+00 | Tr=0.7818] 20%|██        | 4/20 [00:14<00:50,  3.13s/it, CE=6.686379e-01 H=6.186083e-01 dV_dx=1.558635e-05 dV_dθ=-5.004527e-02 ||∇||=8.262954e+00 | Tr=0.7818] 20%|██        | 4/20 [00:17<00:50,  3.13s/it, CE=6.524404e-01 H=6.003453e-01 dV_dx=8.415625e-06 dV_dθ=-5.210353e-02 ||∇||=8.268190e+00 | Tr=0.7818] 25%|██▌       | 5/20 [00:17<00:42,  2.86s/it, CE=6.524404e-01 H=6.003453e-01 dV_dx=8.415625e-06 dV_dθ=-5.210353e-02 ||∇||=8.268190e+00 | Tr=0.7818] 25%|██▌       | 5/20 [00:19<00:42,  2.86s/it, CE=6.385402e-01 H=5.794093e-01 dV_dx=-4.588568e-06 dV_dθ=-5.912630e-02 ||∇||=8.518694e+00 | Tr=0.7818] 30%|███       | 6/20 [00:19<00:37,  2.67s/it, CE=6.385402e-01 H=5.794093e-01 dV_dx=-4.588568e-06 dV_dθ=-5.912630e-02 ||∇||=8.518694e+00 | Tr=0.7818] 30%|███       | 6/20 [00:21<00:37,  2.67s/it, CE=6.254877e-01 H=5.670580e-01 dV_dx=2.054177e-05 dV_dθ=-5.845024e-02 ||∇||=8.418883e+00 | Tr=0.7818]  35%|███▌      | 7/20 [00:21<00:34,  2.62s/it, CE=6.254877e-01 H=5.670580e-01 dV_dx=2.054177e-05 dV_dθ=-5.845024e-02 ||∇||=8.418883e+00 | Tr=0.7818] 35%|███▌      | 7/20 [00:24<00:34,  2.62s/it, CE=6.133389e-01 H=5.487428e-01 dV_dx=-6.852662e-05 dV_dθ=-6.452758e-02 ||∇||=8.673115e+00 | Tr=0.7818] 40%|████      | 8/20 [00:24<00:31,  2.59s/it, CE=6.133389e-01 H=5.487428e-01 dV_dx=-6.852662e-05 dV_dθ=-6.452758e-02 ||∇||=8.673115e+00 | Tr=0.7818] 40%|████      | 8/20 [00:27<00:31,  2.59s/it, CE=6.024681e-01 H=5.363919e-01 dV_dx=-5.017344e-05 dV_dθ=-6.602599e-02 ||∇||=8.759420e+00 | Tr=0.7818] 45%|████▌     | 9/20 [00:27<00:29,  2.65s/it, CE=6.024681e-01 H=5.363919e-01 dV_dx=-5.017344e-05 dV_dθ=-6.602599e-02 ||∇||=8.759420e+00 | Tr=0.7818] 45%|████▌     | 9/20 [00:29<00:29,  2.65s/it, CE=5.923399e-01 H=5.187830e-01 dV_dx=-2.741304e-05 dV_dθ=-7.352954e-02 ||∇||=9.009898e+00 | Tr=0.7818] 50%|█████     | 10/20 [00:29<00:26,  2.60s/it, CE=5.923399e-01 H=5.187830e-01 dV_dx=-2.741304e-05 dV_dθ=-7.352954e-02 ||∇||=9.009898e+00 | Tr=0.7818] 50%|█████     | 10/20 [00:32<00:26,  2.60s/it, CE=5.828678e-01 H=5.104884e-01 dV_dx=-4.597910e-05 dV_dθ=-7.233349e-02 ||∇||=8.990428e+00 | Tr=0.7818] 55%|█████▌    | 11/20 [00:32<00:24,  2.70s/it, CE=5.828678e-01 H=5.104884e-01 dV_dx=-4.597910e-05 dV_dθ=-7.233349e-02 ||∇||=8.990428e+00 | Tr=0.7818] 55%|█████▌    | 11/20 [00:35<00:24,  2.70s/it, CE=5.725234e-01 H=5.021285e-01 dV_dx=6.590815e-06 dV_dθ=-7.040153e-02 ||∇||=8.877492e+00 | Tr=0.7818]  60%|██████    | 12/20 [00:35<00:20,  2.62s/it, CE=5.725234e-01 H=5.021285e-01 dV_dx=6.590815e-06 dV_dθ=-7.040153e-02 ||∇||=8.877492e+00 | Tr=0.7818] 60%|██████    | 12/20 [00:37<00:20,  2.62s/it, CE=5.666878e-01 H=4.889804e-01 dV_dx=-6.813488e-06 dV_dθ=-7.770058e-02 ||∇||=9.385526e+00 | Tr=0.7818] 65%|██████▌   | 13/20 [00:37<00:17,  2.50s/it, CE=5.666878e-01 H=4.889804e-01 dV_dx=-6.813488e-06 dV_dθ=-7.770058e-02 ||∇||=9.385526e+00 | Tr=0.7818] 65%|██████▌   | 13/20 [00:39<00:17,  2.50s/it, CE=5.635449e-01 H=4.667900e-01 dV_dx=-4.085980e-05 dV_dθ=-9.671398e-02 ||∇||=1.041287e+01 | Tr=0.7818] 70%|███████   | 14/20 [00:39<00:14,  2.42s/it, CE=5.635449e-01 H=4.667900e-01 dV_dx=-4.085980e-05 dV_dθ=-9.671398e-02 ||∇||=1.041287e+01 | Tr=0.7818] 70%|███████   | 14/20 [00:41<00:14,  2.42s/it, CE=5.575747e-01 H=4.762689e-01 dV_dx=-1.056067e-04 dV_dθ=-8.120019e-02 ||∇||=9.770511e+00 | Tr=0.7818] 75%|███████▌  | 15/20 [00:41<00:11,  2.34s/it, CE=5.575747e-01 H=4.762689e-01 dV_dx=-1.056067e-04 dV_dθ=-8.120019e-02 ||∇||=9.770511e+00 | Tr=0.7818] 75%|███████▌  | 15/20 [00:44<00:11,  2.34s/it, CE=5.440744e-01 H=4.895830e-01 dV_dx=-1.230025e-04 dV_dθ=-5.436849e-02 ||∇||=8.342758e+00 | Tr=0.7818] 80%|████████  | 16/20 [00:44<00:09,  2.41s/it, CE=5.440744e-01 H=4.895830e-01 dV_dx=-1.230025e-04 dV_dθ=-5.436849e-02 ||∇||=8.342758e+00 | Tr=0.7818] 80%|████████  | 16/20 [00:47<00:09,  2.41s/it, CE=5.303405e-01 H=4.998712e-01 dV_dx=-9.846276e-05 dV_dθ=-3.037091e-02 ||∇||=7.075126e+00 | Tr=0.7818] 85%|████████▌ | 17/20 [00:47<00:07,  2.54s/it, CE=5.303405e-01 H=4.998712e-01 dV_dx=-9.846276e-05 dV_dθ=-3.037091e-02 ||∇||=7.075126e+00 | Tr=0.7818] 85%|████████▌ | 17/20 [00:49<00:07,  2.54s/it, CE=5.208924e-01 H=4.959688e-01 dV_dx=5.129806e-06 dV_dθ=-2.492871e-02 ||∇||=6.718303e+00 | Tr=0.7818]  90%|█████████ | 18/20 [00:49<00:05,  2.51s/it, CE=5.208924e-01 H=4.959688e-01 dV_dx=5.129806e-06 dV_dθ=-2.492871e-02 ||∇||=6.718303e+00 | Tr=0.7818] 90%|█████████ | 18/20 [00:52<00:05,  2.51s/it, CE=5.138986e-01 H=4.907328e-01 dV_dx=8.124751e-05 dV_dθ=-2.324699e-02 ||∇||=6.706792e+00 | Tr=0.7818] 95%|█████████▌| 19/20 [00:52<00:02,  2.59s/it, CE=5.138986e-01 H=4.907328e-01 dV_dx=8.124751e-05 dV_dθ=-2.324699e-02 ||∇||=6.706792e+00 | Tr=0.7818] 95%|█████████▌| 19/20 [00:56<00:02,  2.59s/it, CE=5.067244e-01 H=4.829935e-01 dV_dx=-1.134787e-04 dV_dθ=-2.361739e-02 ||∇||=6.717065e+00 | Tr=0.7818 Te/Cur=0.9557 Te/Exp=0.7997]100%|██████████| 20/20 [01:00<00:00,  4.15s/it, CE=5.067244e-01 H=4.829935e-01 dV_dx=-1.134787e-04 dV_dθ=-2.361739e-02 ||∇||=6.717065e+00 | Tr=0.7818 Te/Cur=0.9557 Te/Exp=0.7997]100%|██████████| 20/20 [01:00<00:00,  3.00s/it, CE=5.067244e-01 H=4.829935e-01 dV_dx=-1.134787e-04 dV_dθ=-2.361739e-02 ||∇||=6.717065e+00 | Tr=0.7818 Te/Cur=0.9557 Te/Exp=0.7997]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.98s/it] 50%|█████     | 1/2 [00:13<00:09,  9.98s/it, CE=5.603383e-01 H=5.591939e-01 dV_dx=-8.785517e-06 dV_dθ=-1.135658e-03 ||∇||=1.403315e+00 | Tr=0.9737 Te/Cur=0.9614 Te/Exp=0.8089]100%|██████████| 2/2 [00:13<00:00,  5.96s/it, CE=5.603383e-01 H=5.591939e-01 dV_dx=-8.785517e-06 dV_dθ=-1.135658e-03 ||∇||=1.403315e+00 | Tr=0.9737 Te/Cur=0.9614 Te/Exp=0.8089]100%|██████████| 2/2 [00:13<00:00,  6.56s/it, CE=5.603383e-01 H=5.591939e-01 dV_dx=-8.785517e-06 dV_dθ=-1.135658e-03 ||∇||=1.403315e+00 | Tr=0.9737 Te/Cur=0.9614 Te/Exp=0.8089]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:07<02:21,  7.46s/it]  5%|▌         | 1/20 [00:09<02:21,  7.46s/it, CE=5.434193e-01 H=5.423638e-01 dV_dx=8.239711e-05 dV_dθ=-1.137823e-03 ||∇||=1.380999e+00 | Tr=0.9765] 10%|█         | 2/20 [00:09<01:18,  4.34s/it, CE=5.434193e-01 H=5.423638e-01 dV_dx=8.239711e-05 dV_dθ=-1.137823e-03 ||∇||=1.380999e+00 | Tr=0.9765] 10%|█         | 2/20 [00:11<01:18,  4.34s/it, CE=5.325414e-01 H=5.313427e-01 dV_dx=-6.560145e-05 dV_dθ=-1.133150e-03 ||∇||=1.372887e+00 | Tr=0.9775] 15%|█▌        | 3/20 [00:11<00:55,  3.27s/it, CE=5.325414e-01 H=5.313427e-01 dV_dx=-6.560145e-05 dV_dθ=-1.133150e-03 ||∇||=1.372887e+00 | Tr=0.9775] 15%|█▌        | 3/20 [00:13<00:55,  3.27s/it, CE=5.234529e-01 H=5.221634e-01 dV_dx=-9.166882e-05 dV_dθ=-1.197813e-03 ||∇||=1.377034e+00 | Tr=0.9781] 20%|██        | 4/20 [00:13<00:45,  2.84s/it, CE=5.234529e-01 H=5.221634e-01 dV_dx=-9.166882e-05 dV_dθ=-1.197813e-03 ||∇||=1.377034e+00 | Tr=0.9781] 20%|██        | 4/20 [00:15<00:45,  2.84s/it, CE=5.155400e-01 H=5.143111e-01 dV_dx=3.897694e-05 dV_dθ=-1.267852e-03 ||∇||=1.381834e+00 | Tr=0.9787]  25%|██▌       | 5/20 [00:15<00:36,  2.46s/it, CE=5.155400e-01 H=5.143111e-01 dV_dx=3.897694e-05 dV_dθ=-1.267852e-03 ||∇||=1.381834e+00 | Tr=0.9787] 25%|██▌       | 5/20 [00:18<00:36,  2.46s/it, CE=5.081751e-01 H=5.068467e-01 dV_dx=2.310282e-05 dV_dθ=-1.351504e-03 ||∇||=1.388462e+00 | Tr=0.9796 Te/Cur=0.9664 Te/Exp=0.8176] 30%|███       | 6/20 [00:18<00:38,  2.72s/it, CE=5.081751e-01 H=5.068467e-01 dV_dx=2.310282e-05 dV_dθ=-1.351504e-03 ||∇||=1.388462e+00 | Tr=0.9796 Te/Cur=0.9664 Te/Exp=0.8176] 30%|███       | 6/20 [00:20<00:38,  2.72s/it, CE=5.017923e-01 H=5.004492e-01 dV_dx=2.337637e-04 dV_dθ=-1.576814e-03 ||∇||=1.424675e+00 | Tr=0.9801]                             35%|███▌      | 7/20 [00:20<00:32,  2.48s/it, CE=5.017923e-01 H=5.004492e-01 dV_dx=2.337637e-04 dV_dθ=-1.576814e-03 ||∇||=1.424675e+00 | Tr=0.9801] 35%|███▌      | 7/20 [00:23<00:32,  2.48s/it, CE=4.959056e-01 H=4.939644e-01 dV_dx=-8.137919e-05 dV_dθ=-1.859818e-03 ||∇||=1.476786e+00 | Tr=0.9805] 40%|████      | 8/20 [00:23<00:28,  2.41s/it, CE=4.959056e-01 H=4.939644e-01 dV_dx=-8.137919e-05 dV_dθ=-1.859818e-03 ||∇||=1.476786e+00 | Tr=0.9805] 40%|████      | 8/20 [00:24<00:28,  2.41s/it, CE=4.904259e-01 H=4.883352e-01 dV_dx=1.376267e-04 dV_dθ=-2.228352e-03 ||∇||=1.538513e+00 | Tr=0.9809]  45%|████▌     | 9/20 [00:24<00:24,  2.24s/it, CE=4.904259e-01 H=4.883352e-01 dV_dx=1.376267e-04 dV_dθ=-2.228352e-03 ||∇||=1.538513e+00 | Tr=0.9809] 45%|████▌     | 9/20 [00:27<00:24,  2.24s/it, CE=4.854309e-01 H=4.827909e-01 dV_dx=2.997219e-05 dV_dθ=-2.669941e-03 ||∇||=1.618471e+00 | Tr=0.9813] 50%|█████     | 10/20 [00:27<00:22,  2.21s/it, CE=4.854309e-01 H=4.827909e-01 dV_dx=2.997219e-05 dV_dθ=-2.669941e-03 ||∇||=1.618471e+00 | Tr=0.9813] 50%|█████     | 10/20 [00:30<00:22,  2.21s/it, CE=4.813724e-01 H=4.779886e-01 dV_dx=8.871636e-05 dV_dθ=-3.472506e-03 ||∇||=1.764234e+00 | Tr=0.9816 Te/Cur=0.9653 Te/Exp=0.8128] 55%|█████▌    | 11/20 [00:30<00:23,  2.58s/it, CE=4.813724e-01 H=4.779886e-01 dV_dx=8.871636e-05 dV_dθ=-3.472506e-03 ||∇||=1.764234e+00 | Tr=0.9816 Te/Cur=0.9653 Te/Exp=0.8128] 55%|█████▌    | 11/20 [00:32<00:23,  2.58s/it, CE=4.771107e-01 H=4.729800e-01 dV_dx=-2.098761e-04 dV_dθ=-3.920801e-03 ||∇||=1.841192e+00 | Tr=0.9817]                            60%|██████    | 12/20 [00:32<00:19,  2.38s/it, CE=4.771107e-01 H=4.729800e-01 dV_dx=-2.098761e-04 dV_dθ=-3.920801e-03 ||∇||=1.841192e+00 | Tr=0.9817] 60%|██████    | 12/20 [00:34<00:19,  2.38s/it, CE=4.716748e-01 H=4.679536e-01 dV_dx=2.846488e-05 dV_dθ=-3.749647e-03 ||∇||=1.795361e+00 | Tr=0.9820]  65%|██████▌   | 13/20 [00:34<00:15,  2.18s/it, CE=4.716748e-01 H=4.679536e-01 dV_dx=2.846488e-05 dV_dθ=-3.749647e-03 ||∇||=1.795361e+00 | Tr=0.9820] 65%|██████▌   | 13/20 [00:36<00:15,  2.18s/it, CE=4.652394e-01 H=4.624082e-01 dV_dx=-3.902747e-05 dV_dθ=-2.792177e-03 ||∇||=1.612027e+00 | Tr=0.9832] 70%|███████   | 14/20 [00:36<00:13,  2.20s/it, CE=4.652394e-01 H=4.624082e-01 dV_dx=-3.902747e-05 dV_dθ=-2.792177e-03 ||∇||=1.612027e+00 | Tr=0.9832] 70%|███████   | 14/20 [00:38<00:13,  2.20s/it, CE=4.592298e-01 H=4.573377e-01 dV_dx=-3.962656e-05 dV_dθ=-1.852448e-03 ||∇||=1.427650e+00 | Tr=0.9840] 75%|███████▌  | 15/20 [00:38<00:10,  2.14s/it, CE=4.592298e-01 H=4.573377e-01 dV_dx=-3.962656e-05 dV_dθ=-1.852448e-03 ||∇||=1.427650e+00 | Tr=0.9840] 75%|███████▌  | 15/20 [00:41<00:10,  2.14s/it, CE=4.541647e-01 H=4.527162e-01 dV_dx=-8.639720e-05 dV_dθ=-1.362098e-03 ||∇||=1.315290e+00 | Tr=0.9848 Te/Cur=0.9699 Te/Exp=0.8264] 80%|████████  | 16/20 [00:41<00:09,  2.37s/it, CE=4.541647e-01 H=4.527162e-01 dV_dx=-8.639720e-05 dV_dθ=-1.362098e-03 ||∇||=1.315290e+00 | Tr=0.9848 Te/Cur=0.9699 Te/Exp=0.8264] 80%|████████  | 16/20 [00:43<00:09,  2.37s/it, CE=4.495053e-01 H=4.485678e-01 dV_dx=7.299517e-05 dV_dθ=-1.010510e-03 ||∇||=1.228241e+00 | Tr=0.9854]                              85%|████████▌ | 17/20 [00:43<00:06,  2.21s/it, CE=4.495053e-01 H=4.485678e-01 dV_dx=7.299517e-05 dV_dθ=-1.010510e-03 ||∇||=1.228241e+00 | Tr=0.9854] 85%|████████▌ | 17/20 [00:45<00:06,  2.21s/it, CE=4.452600e-01 H=4.443645e-01 dV_dx=-5.424684e-05 dV_dθ=-8.412982e-04 ||∇||=1.185177e+00 | Tr=0.9860] 90%|█████████ | 18/20 [00:45<00:04,  2.16s/it, CE=4.452600e-01 H=4.443645e-01 dV_dx=-5.424684e-05 dV_dθ=-8.412982e-04 ||∇||=1.185177e+00 | Tr=0.9860] 90%|█████████ | 18/20 [00:49<00:04,  2.16s/it, CE=4.413191e-01 H=4.406915e-01 dV_dx=1.004914e-04 dV_dθ=-7.280963e-04 ||∇||=1.153977e+00 | Tr=0.9866]  95%|█████████▌| 19/20 [00:49<00:02,  2.70s/it, CE=4.413191e-01 H=4.406915e-01 dV_dx=1.004914e-04 dV_dθ=-7.280963e-04 ||∇||=1.153977e+00 | Tr=0.9866] 95%|█████████▌| 19/20 [00:52<00:02,  2.70s/it, CE=4.375217e-01 H=4.368668e-01 dV_dx=-1.908664e-06 dV_dθ=-6.530069e-04 ||∇||=1.133694e+00 | Tr=0.9874 Te/Cur=0.9703 Te/Exp=0.8233]100%|██████████| 20/20 [00:52<00:00,  2.92s/it, CE=4.375217e-01 H=4.368668e-01 dV_dx=-1.908664e-06 dV_dθ=-6.530069e-04 ||∇||=1.133694e+00 | Tr=0.9874 Te/Cur=0.9703 Te/Exp=0.8233]100%|██████████| 20/20 [00:52<00:00,  2.63s/it, CE=4.375217e-01 H=4.368668e-01 dV_dx=-1.908664e-06 dV_dθ=-6.530069e-04 ||∇||=1.133694e+00 | Tr=0.9874 Te/Cur=0.9703 Te/Exp=0.8233]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 6 final loss: 0.445843
======================================================================


  Evaluating on all tasks 0..6 for CL metrics...
    Task 0: 0.7566
    Task 1: 0.9323
    Task 2: 0.8292
    Task 3: 0.5926
    Task 4: 0.9258
    Task 5: 0.9171
    Task 6: 0.9710

============================================================
Task 7
============================================================
Initial loss on new task: 5.7724, previous: 0.4375, ratio: 13.19
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 7
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:08<?, ?it/s, CE=5.580184e-01 H=5.527260e-01 dV_dx=1.476716e-04 dV_dθ=-5.440126e-03 ||∇||=4.279826e+00 | Tr=0.6320 Te/Cur=0.8108 Te/Exp=0.8163]100%|██████████| 1/1 [00:08<00:00,  8.56s/it, CE=5.580184e-01 H=5.527260e-01 dV_dx=1.476716e-04 dV_dθ=-5.440126e-03 ||∇||=4.279826e+00 | Tr=0.6320 Te/Cur=0.8108 Te/Exp=0.8163]100%|██████████| 1/1 [00:08<00:00,  8.56s/it, CE=5.580184e-01 H=5.527260e-01 dV_dx=1.476716e-04 dV_dθ=-5.440126e-03 ||∇||=4.279826e+00 | Tr=0.6320 Te/Cur=0.8108 Te/Exp=0.8163]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.558018

[STEP 2] Architecture change decision
  Current: 0.558018, Previous: 0.437522
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9416 samples from 10 classes
  Created balanced validation set: 39932 samples from 10 classes
  Starting grid architecture search for task 7
  Baseline architecture: (3, [507, 632, 144, 10])
  Baseline loss: 0.558018
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.99s/it] 50%|█████     | 1/2 [00:04<00:02,  2.99s/it, CE=2.246877e+00 H=2.246805e+00 dV_dx=1.983800e-06 dV_dθ=-7.359285e-05 ||∇||=4.859101e-01 | Tr=0.1065 Te/Cur=0.1449 Te/Exp=0.2809]100%|██████████| 2/2 [00:04<00:00,  2.21s/it, CE=2.246877e+00 H=2.246805e+00 dV_dx=1.983800e-06 dV_dθ=-7.359285e-05 ||∇||=4.859101e-01 | Tr=0.1065 Te/Cur=0.1449 Te/Exp=0.2809]100%|██████████| 2/2 [00:04<00:00,  2.32s/it, CE=2.246877e+00 H=2.246805e+00 dV_dx=1.983800e-06 dV_dθ=-7.359285e-05 ||∇||=4.859101e-01 | Tr=0.1065 Te/Cur=0.1449 Te/Exp=0.2809]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2468765042556607
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.50s/it] 50%|█████     | 1/2 [00:06<00:04,  4.50s/it, CE=2.243857e+00 H=2.243785e+00 dV_dx=-5.607243e-06 dV_dθ=-6.614099e-05 ||∇||=4.863102e-01 | Tr=0.1284 Te/Cur=0.1552 Te/Exp=0.2567]100%|██████████| 2/2 [00:06<00:00,  2.93s/it, CE=2.243857e+00 H=2.243785e+00 dV_dx=-5.607243e-06 dV_dθ=-6.614099e-05 ||∇||=4.863102e-01 | Tr=0.1284 Te/Cur=0.1552 Te/Exp=0.2567]100%|██████████| 2/2 [00:06<00:00,  3.17s/it, CE=2.243857e+00 H=2.243785e+00 dV_dx=-5.607243e-06 dV_dθ=-6.614099e-05 ||∇||=4.863102e-01 | Tr=0.1284 Te/Cur=0.1552 Te/Exp=0.2567]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 124, 10]) with loss 2.243857
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.08s/it] 50%|█████     | 1/2 [00:08<00:07,  7.08s/it, CE=2.232090e+00 H=2.232037e+00 dV_dx=5.929513e-06 dV_dθ=-5.871530e-05 ||∇||=5.128865e-01 | Tr=0.1261 Te/Cur=0.1361 Te/Exp=0.2698]100%|██████████| 2/2 [00:08<00:00,  3.80s/it, CE=2.232090e+00 H=2.232037e+00 dV_dx=5.929513e-06 dV_dθ=-5.871530e-05 ||∇||=5.128865e-01 | Tr=0.1261 Te/Cur=0.1361 Te/Exp=0.2698]100%|██████████| 2/2 [00:08<00:00,  4.29s/it, CE=2.232090e+00 H=2.232037e+00 dV_dx=5.929513e-06 dV_dθ=-5.871530e-05 ||∇||=5.128865e-01 | Tr=0.1261 Te/Cur=0.1361 Te/Exp=0.2698]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 124, 10]) with loss 2.232090
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.44s/it] 50%|█████     | 1/2 [00:05<00:04,  4.44s/it, CE=2.228082e+00 H=2.227998e+00 dV_dx=-4.635448e-06 dV_dθ=-7.890443e-05 ||∇||=4.727374e-01 | Tr=0.2127 Te/Cur=0.2127 Te/Exp=0.2975]100%|██████████| 2/2 [00:05<00:00,  2.70s/it, CE=2.228082e+00 H=2.227998e+00 dV_dx=-4.635448e-06 dV_dθ=-7.890443e-05 ||∇||=4.727374e-01 | Tr=0.2127 Te/Cur=0.2127 Te/Exp=0.2975]100%|██████████| 2/2 [00:05<00:00,  2.96s/it, CE=2.228082e+00 H=2.227998e+00 dV_dx=-4.635448e-06 dV_dθ=-7.890443e-05 ||∇||=4.727374e-01 | Tr=0.2127 Te/Cur=0.2127 Te/Exp=0.2975]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 144, 10]) with loss 2.228082
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.36s/it] 50%|█████     | 1/2 [00:06<00:04,  4.36s/it, CE=2.227521e+00 H=2.227468e+00 dV_dx=4.991466e-06 dV_dθ=-5.774870e-05 ||∇||=5.015560e-01 | Tr=0.1561 Te/Cur=0.1746 Te/Exp=0.2493]100%|██████████| 2/2 [00:06<00:00,  2.84s/it, CE=2.227521e+00 H=2.227468e+00 dV_dx=4.991466e-06 dV_dθ=-5.774870e-05 ||∇||=5.015560e-01 | Tr=0.1561 Te/Cur=0.1746 Te/Exp=0.2493]100%|██████████| 2/2 [00:06<00:00,  3.07s/it, CE=2.227521e+00 H=2.227468e+00 dV_dx=4.991466e-06 dV_dθ=-5.774870e-05 ||∇||=5.015560e-01 | Tr=0.1561 Te/Cur=0.1746 Te/Exp=0.2493]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 632, 144, 10]) with loss 2.227521
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.35s/it] 50%|█████     | 1/2 [00:07<00:05,  5.35s/it, CE=2.221180e+00 H=2.221200e+00 dV_dx=-1.192845e-06 dV_dθ=2.097862e-05 ||∇||=4.847659e-01 | Tr=0.1758 Te/Cur=0.1906 Te/Exp=0.2758]100%|██████████| 2/2 [00:07<00:00,  3.34s/it, CE=2.221180e+00 H=2.221200e+00 dV_dx=-1.192845e-06 dV_dθ=2.097862e-05 ||∇||=4.847659e-01 | Tr=0.1758 Te/Cur=0.1906 Te/Exp=0.2758]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.221180e+00 H=2.221200e+00 dV_dx=-1.192845e-06 dV_dθ=2.097862e-05 ||∇||=4.847659e-01 | Tr=0.1758 Te/Cur=0.1906 Te/Exp=0.2758]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 144, 10]) with loss 2.221180
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.11s/it] 50%|█████     | 1/2 [00:06<00:04,  4.11s/it, CE=2.228753e+00 H=2.228650e+00 dV_dx=-2.402035e-07 dV_dθ=-1.028013e-04 ||∇||=5.123209e-01 | Tr=0.1814 Te/Cur=0.1892 Te/Exp=0.2792]100%|██████████| 2/2 [00:06<00:00,  2.96s/it, CE=2.228753e+00 H=2.228650e+00 dV_dx=-2.402035e-07 dV_dθ=-1.028013e-04 ||∇||=5.123209e-01 | Tr=0.1814 Te/Cur=0.1892 Te/Exp=0.2792]100%|██████████| 2/2 [00:06<00:00,  3.13s/it, CE=2.228753e+00 H=2.228650e+00 dV_dx=-2.402035e-07 dV_dθ=-1.028013e-04 ||∇||=5.123209e-01 | Tr=0.1814 Te/Cur=0.1892 Te/Exp=0.2792]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.52s/it] 50%|█████     | 1/2 [00:07<00:05,  5.52s/it, CE=2.251209e+00 H=2.251155e+00 dV_dx=3.527534e-06 dV_dθ=-5.702083e-05 ||∇||=4.783812e-01 | Tr=0.1304 Te/Cur=0.1582 Te/Exp=0.2452]100%|██████████| 2/2 [00:07<00:00,  3.57s/it, CE=2.251209e+00 H=2.251155e+00 dV_dx=3.527534e-06 dV_dθ=-5.702083e-05 ||∇||=4.783812e-01 | Tr=0.1304 Te/Cur=0.1582 Te/Exp=0.2452]100%|██████████| 2/2 [00:07<00:00,  3.87s/it, CE=2.251209e+00 H=2.251155e+00 dV_dx=3.527534e-06 dV_dθ=-5.702083e-05 ||∇||=4.783812e-01 | Tr=0.1304 Te/Cur=0.1582 Te/Exp=0.2452]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.19s/it] 50%|█████     | 1/2 [00:07<00:05,  5.19s/it, CE=2.217448e+00 H=2.217425e+00 dV_dx=9.963127e-06 dV_dθ=-3.290331e-05 ||∇||=5.157939e-01 | Tr=0.2100 Te/Cur=0.2177 Te/Exp=0.2943]100%|██████████| 2/2 [00:07<00:00,  3.20s/it, CE=2.217448e+00 H=2.217425e+00 dV_dx=9.963127e-06 dV_dθ=-3.290331e-05 ||∇||=5.157939e-01 | Tr=0.2100 Te/Cur=0.2177 Te/Exp=0.2943]100%|██████████| 2/2 [00:07<00:00,  3.50s/it, CE=2.217448e+00 H=2.217425e+00 dV_dx=9.963127e-06 dV_dθ=-3.290331e-05 ||∇||=5.157939e-01 | Tr=0.2100 Te/Cur=0.2177 Te/Exp=0.2943]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 164, 10]) with loss 2.217448
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.42s/it] 50%|█████     | 1/2 [00:07<00:05,  5.42s/it, CE=2.261625e+00 H=2.261526e+00 dV_dx=-1.247203e-05 dV_dθ=-8.714815e-05 ||∇||=4.237495e-01 | Tr=0.1167 Te/Cur=0.1426 Te/Exp=0.2302]100%|██████████| 2/2 [00:07<00:00,  3.31s/it, CE=2.261625e+00 H=2.261526e+00 dV_dx=-1.247203e-05 dV_dθ=-8.714815e-05 ||∇||=4.237495e-01 | Tr=0.1167 Te/Cur=0.1426 Te/Exp=0.2302]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.261625e+00 H=2.261526e+00 dV_dx=-1.247203e-05 dV_dθ=-8.714815e-05 ||∇||=4.237495e-01 | Tr=0.1167 Te/Cur=0.1426 Te/Exp=0.2302]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.44s/it] 50%|█████     | 1/2 [00:07<00:05,  5.44s/it, CE=2.267449e+00 H=2.267413e+00 dV_dx=-5.826051e-06 dV_dθ=-3.017385e-05 ||∇||=4.226763e-01 | Tr=0.1053 Te/Cur=0.0825 Te/Exp=0.1986]100%|██████████| 2/2 [00:07<00:00,  3.36s/it, CE=2.267449e+00 H=2.267413e+00 dV_dx=-5.826051e-06 dV_dθ=-3.017385e-05 ||∇||=4.226763e-01 | Tr=0.1053 Te/Cur=0.0825 Te/Exp=0.1986]100%|██████████| 2/2 [00:07<00:00,  3.68s/it, CE=2.267449e+00 H=2.267413e+00 dV_dx=-5.826051e-06 dV_dθ=-3.017385e-05 ||∇||=4.226763e-01 | Tr=0.1053 Te/Cur=0.0825 Te/Exp=0.1986]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.94s/it] 50%|█████     | 1/2 [00:07<00:05,  5.94s/it, CE=2.257802e+00 H=2.257701e+00 dV_dx=-9.500843e-07 dV_dθ=-9.961397e-05 ||∇||=4.586565e-01 | Tr=0.0915 Te/Cur=0.1280 Te/Exp=0.2743]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.257802e+00 H=2.257701e+00 dV_dx=-9.500843e-07 dV_dθ=-9.961397e-05 ||∇||=4.586565e-01 | Tr=0.0915 Te/Cur=0.1280 Te/Exp=0.2743]100%|██████████| 2/2 [00:07<00:00,  3.97s/it, CE=2.257802e+00 H=2.257701e+00 dV_dx=-9.500843e-07 dV_dθ=-9.961397e-05 ||∇||=4.586565e-01 | Tr=0.0915 Te/Cur=0.1280 Te/Exp=0.2743]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.92s/it] 50%|█████     | 1/2 [00:06<00:04,  4.92s/it, CE=2.248084e+00 H=2.248020e+00 dV_dx=4.307477e-06 dV_dθ=-6.882192e-05 ||∇||=4.324455e-01 | Tr=0.1157 Te/Cur=0.1325 Te/Exp=0.2545]100%|██████████| 2/2 [00:06<00:00,  3.04s/it, CE=2.248084e+00 H=2.248020e+00 dV_dx=4.307477e-06 dV_dθ=-6.882192e-05 ||∇||=4.324455e-01 | Tr=0.1157 Te/Cur=0.1325 Te/Exp=0.2545]100%|██████████| 2/2 [00:06<00:00,  3.32s/it, CE=2.248084e+00 H=2.248020e+00 dV_dx=4.307477e-06 dV_dθ=-6.882192e-05 ||∇||=4.324455e-01 | Tr=0.1157 Te/Cur=0.1325 Te/Exp=0.2545]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.36s/it] 50%|█████     | 1/2 [00:07<00:05,  5.36s/it, CE=2.252035e+00 H=2.252002e+00 dV_dx=-2.055960e-06 dV_dθ=-3.108519e-05 ||∇||=4.337151e-01 | Tr=0.1308 Te/Cur=0.1564 Te/Exp=0.2554]100%|██████████| 2/2 [00:07<00:00,  3.22s/it, CE=2.252035e+00 H=2.252002e+00 dV_dx=-2.055960e-06 dV_dθ=-3.108519e-05 ||∇||=4.337151e-01 | Tr=0.1308 Te/Cur=0.1564 Te/Exp=0.2554]100%|██████████| 2/2 [00:07<00:00,  3.54s/it, CE=2.252035e+00 H=2.252002e+00 dV_dx=-2.055960e-06 dV_dθ=-3.108519e-05 ||∇||=4.337151e-01 | Tr=0.1308 Te/Cur=0.1564 Te/Exp=0.2554]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.69s/it] 50%|█████     | 1/2 [00:07<00:05,  5.69s/it, CE=2.246098e+00 H=2.246038e+00 dV_dx=-4.543304e-06 dV_dθ=-5.519403e-05 ||∇||=4.494784e-01 | Tr=0.1174 Te/Cur=0.1180 Te/Exp=0.2727]100%|██████████| 2/2 [00:07<00:00,  3.63s/it, CE=2.246098e+00 H=2.246038e+00 dV_dx=-4.543304e-06 dV_dθ=-5.519403e-05 ||∇||=4.494784e-01 | Tr=0.1174 Te/Cur=0.1180 Te/Exp=0.2727]100%|██████████| 2/2 [00:07<00:00,  3.94s/it, CE=2.246098e+00 H=2.246038e+00 dV_dx=-4.543304e-06 dV_dθ=-5.519403e-05 ||∇||=4.494784e-01 | Tr=0.1174 Te/Cur=0.1180 Te/Exp=0.2727]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.60s/it] 50%|█████     | 1/2 [00:05<00:03,  3.60s/it, CE=2.261948e+00 H=2.261897e+00 dV_dx=7.614090e-06 dV_dθ=-5.875676e-05 ||∇||=4.501401e-01 | Tr=0.1387 Te/Cur=0.1482 Te/Exp=0.2609]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.261948e+00 H=2.261897e+00 dV_dx=7.614090e-06 dV_dθ=-5.875676e-05 ||∇||=4.501401e-01 | Tr=0.1387 Te/Cur=0.1482 Te/Exp=0.2609]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.261948e+00 H=2.261897e+00 dV_dx=7.614090e-06 dV_dθ=-5.875676e-05 ||∇||=4.501401e-01 | Tr=0.1387 Te/Cur=0.1482 Te/Exp=0.2609]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.29s/it] 50%|█████     | 1/2 [00:07<00:06,  6.29s/it, CE=2.271840e+00 H=2.271778e+00 dV_dx=1.745958e-06 dV_dθ=-6.416013e-05 ||∇||=4.288423e-01 | Tr=0.1267 Te/Cur=0.1763 Te/Exp=0.1978]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.271840e+00 H=2.271778e+00 dV_dx=1.745958e-06 dV_dθ=-6.416013e-05 ||∇||=4.288423e-01 | Tr=0.1267 Te/Cur=0.1763 Te/Exp=0.1978]100%|██████████| 2/2 [00:07<00:00,  3.97s/it, CE=2.271840e+00 H=2.271778e+00 dV_dx=1.745958e-06 dV_dθ=-6.416013e-05 ||∇||=4.288423e-01 | Tr=0.1267 Te/Cur=0.1763 Te/Exp=0.1978]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.27s/it] 50%|█████     | 1/2 [00:10<00:08,  8.27s/it, CE=2.247022e+00 H=2.246942e+00 dV_dx=-1.912406e-06 dV_dθ=-7.825291e-05 ||∇||=4.494227e-01 | Tr=0.1196 Te/Cur=0.1158 Te/Exp=0.2913]100%|██████████| 2/2 [00:10<00:00,  4.63s/it, CE=2.247022e+00 H=2.246942e+00 dV_dx=-1.912406e-06 dV_dθ=-7.825291e-05 ||∇||=4.494227e-01 | Tr=0.1196 Te/Cur=0.1158 Te/Exp=0.2913]100%|██████████| 2/2 [00:10<00:00,  5.18s/it, CE=2.247022e+00 H=2.246942e+00 dV_dx=-1.912406e-06 dV_dθ=-7.825291e-05 ||∇||=4.494227e-01 | Tr=0.1196 Te/Cur=0.1158 Te/Exp=0.2913]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.93s/it] 50%|█████     | 1/2 [00:05<00:03,  3.93s/it, CE=2.245765e+00 H=2.245641e+00 dV_dx=-2.285313e-06 dV_dθ=-1.218986e-04 ||∇||=4.852328e-01 | Tr=0.1214 Te/Cur=0.1491 Te/Exp=0.2553]100%|██████████| 2/2 [00:05<00:00,  2.82s/it, CE=2.245765e+00 H=2.245641e+00 dV_dx=-2.285313e-06 dV_dθ=-1.218986e-04 ||∇||=4.852328e-01 | Tr=0.1214 Te/Cur=0.1491 Te/Exp=0.2553]100%|██████████| 2/2 [00:05<00:00,  2.99s/it, CE=2.245765e+00 H=2.245641e+00 dV_dx=-2.285313e-06 dV_dθ=-1.218986e-04 ||∇||=4.852328e-01 | Tr=0.1214 Te/Cur=0.1491 Te/Exp=0.2553]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.91s/it] 50%|█████     | 1/2 [00:07<00:05,  5.91s/it, CE=2.251643e+00 H=2.251506e+00 dV_dx=1.081602e-06 dV_dθ=-1.379214e-04 ||∇||=4.701950e-01 | Tr=0.1531 Te/Cur=0.1768 Te/Exp=0.2148]100%|██████████| 2/2 [00:07<00:00,  3.20s/it, CE=2.251643e+00 H=2.251506e+00 dV_dx=1.081602e-06 dV_dθ=-1.379214e-04 ||∇||=4.701950e-01 | Tr=0.1531 Te/Cur=0.1768 Te/Exp=0.2148]100%|██████████| 2/2 [00:07<00:00,  3.61s/it, CE=2.251643e+00 H=2.251506e+00 dV_dx=1.081602e-06 dV_dθ=-1.379214e-04 ||∇||=4.701950e-01 | Tr=0.1531 Te/Cur=0.1768 Te/Exp=0.2148]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.47s/it] 50%|█████     | 1/2 [00:07<00:05,  5.47s/it, CE=2.255250e+00 H=2.255148e+00 dV_dx=-1.709439e-06 dV_dθ=-9.994736e-05 ||∇||=4.852032e-01 | Tr=0.1973 Te/Cur=0.2195 Te/Exp=0.2379]100%|██████████| 2/2 [00:07<00:00,  3.30s/it, CE=2.255250e+00 H=2.255148e+00 dV_dx=-1.709439e-06 dV_dθ=-9.994736e-05 ||∇||=4.852032e-01 | Tr=0.1973 Te/Cur=0.2195 Te/Exp=0.2379]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.255250e+00 H=2.255148e+00 dV_dx=-1.709439e-06 dV_dθ=-9.994736e-05 ||∇||=4.852032e-01 | Tr=0.1973 Te/Cur=0.2195 Te/Exp=0.2379]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.93s/it] 50%|█████     | 1/2 [00:07<00:05,  5.93s/it, CE=2.249724e+00 H=2.249635e+00 dV_dx=-5.667806e-06 dV_dθ=-8.337978e-05 ||∇||=4.384546e-01 | Tr=0.1476 Te/Cur=0.1646 Te/Exp=0.2291]100%|██████████| 2/2 [00:07<00:00,  3.61s/it, CE=2.249724e+00 H=2.249635e+00 dV_dx=-5.667806e-06 dV_dθ=-8.337978e-05 ||∇||=4.384546e-01 | Tr=0.1476 Te/Cur=0.1646 Te/Exp=0.2291]100%|██████████| 2/2 [00:07<00:00,  3.95s/it, CE=2.249724e+00 H=2.249635e+00 dV_dx=-5.667806e-06 dV_dθ=-8.337978e-05 ||∇||=4.384546e-01 | Tr=0.1476 Te/Cur=0.1646 Te/Exp=0.2291]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.37s/it] 50%|█████     | 1/2 [00:07<00:05,  5.37s/it, CE=2.218961e+00 H=2.218844e+00 dV_dx=-7.611404e-06 dV_dθ=-1.098329e-04 ||∇||=4.820640e-01 | Tr=0.1757 Te/Cur=0.1974 Te/Exp=0.3111]100%|██████████| 2/2 [00:07<00:00,  3.33s/it, CE=2.218961e+00 H=2.218844e+00 dV_dx=-7.611404e-06 dV_dθ=-1.098329e-04 ||∇||=4.820640e-01 | Tr=0.1757 Te/Cur=0.1974 Te/Exp=0.3111]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.218961e+00 H=2.218844e+00 dV_dx=-7.611404e-06 dV_dθ=-1.098329e-04 ||∇||=4.820640e-01 | Tr=0.1757 Te/Cur=0.1974 Te/Exp=0.3111]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.44s/it] 50%|█████     | 1/2 [00:07<00:05,  5.44s/it, CE=2.251416e+00 H=2.251315e+00 dV_dx=-7.056987e-06 dV_dθ=-9.342023e-05 ||∇||=4.580487e-01 | Tr=0.1096 Te/Cur=0.1177 Te/Exp=0.2622]100%|██████████| 2/2 [00:07<00:00,  3.32s/it, CE=2.251416e+00 H=2.251315e+00 dV_dx=-7.056987e-06 dV_dθ=-9.342023e-05 ||∇||=4.580487e-01 | Tr=0.1096 Te/Cur=0.1177 Te/Exp=0.2622]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.251416e+00 H=2.251315e+00 dV_dx=-7.056987e-06 dV_dθ=-9.342023e-05 ||∇||=4.580487e-01 | Tr=0.1096 Te/Cur=0.1177 Te/Exp=0.2622]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.28s/it] 50%|█████     | 1/2 [00:08<00:03,  3.28s/it, CE=2.237031e+00 H=2.236892e+00 dV_dx=-9.698995e-08 dV_dθ=-1.386362e-04 ||∇||=4.849511e-01 | Tr=0.1944 Te/Cur=0.2090 Te/Exp=0.2382]100%|██████████| 2/2 [00:08<00:00,  4.39s/it, CE=2.237031e+00 H=2.236892e+00 dV_dx=-9.698995e-08 dV_dθ=-1.386362e-04 ||∇||=4.849511e-01 | Tr=0.1944 Te/Cur=0.2090 Te/Exp=0.2382]100%|██████████| 2/2 [00:08<00:00,  4.23s/it, CE=2.237031e+00 H=2.236892e+00 dV_dx=-9.698995e-08 dV_dθ=-1.386362e-04 ||∇||=4.849511e-01 | Tr=0.1944 Te/Cur=0.2090 Te/Exp=0.2382]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.56s/it] 50%|█████     | 1/2 [00:07<00:05,  5.56s/it, CE=2.247815e+00 H=2.247725e+00 dV_dx=-3.809759e-07 dV_dθ=-8.898266e-05 ||∇||=4.732220e-01 | Tr=0.1918 Te/Cur=0.2096 Te/Exp=0.2358]100%|██████████| 2/2 [00:07<00:00,  3.24s/it, CE=2.247815e+00 H=2.247725e+00 dV_dx=-3.809759e-07 dV_dθ=-8.898266e-05 ||∇||=4.732220e-01 | Tr=0.1918 Te/Cur=0.2096 Te/Exp=0.2358]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.247815e+00 H=2.247725e+00 dV_dx=-3.809759e-07 dV_dθ=-8.898266e-05 ||∇||=4.732220e-01 | Tr=0.1918 Te/Cur=0.2096 Te/Exp=0.2358]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.09s/it] 50%|█████     | 1/2 [00:06<00:05,  5.09s/it, CE=2.253055e+00 H=2.252975e+00 dV_dx=2.531050e-06 dV_dθ=-8.274797e-05 ||∇||=5.008523e-01 | Tr=0.1488 Te/Cur=0.1496 Te/Exp=0.2337]100%|██████████| 2/2 [00:06<00:00,  3.09s/it, CE=2.253055e+00 H=2.252975e+00 dV_dx=2.531050e-06 dV_dθ=-8.274797e-05 ||∇||=5.008523e-01 | Tr=0.1488 Te/Cur=0.1496 Te/Exp=0.2337]100%|██████████| 2/2 [00:06<00:00,  3.39s/it, CE=2.253055e+00 H=2.252975e+00 dV_dx=2.531050e-06 dV_dθ=-8.274797e-05 ||∇||=5.008523e-01 | Tr=0.1488 Te/Cur=0.1496 Te/Exp=0.2337]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.19s/it] 50%|█████     | 1/2 [00:04<00:03,  3.19s/it, CE=2.253873e+00 H=2.253852e+00 dV_dx=-1.035406e-06 dV_dθ=-1.997344e-05 ||∇||=4.941422e-01 | Tr=0.1048 Te/Cur=0.1310 Te/Exp=0.2255]100%|██████████| 2/2 [00:04<00:00,  2.33s/it, CE=2.253873e+00 H=2.253852e+00 dV_dx=-1.035406e-06 dV_dθ=-1.997344e-05 ||∇||=4.941422e-01 | Tr=0.1048 Te/Cur=0.1310 Te/Exp=0.2255]100%|██████████| 2/2 [00:04<00:00,  2.45s/it, CE=2.253873e+00 H=2.253852e+00 dV_dx=-1.035406e-06 dV_dθ=-1.997344e-05 ||∇||=4.941422e-01 | Tr=0.1048 Te/Cur=0.1310 Te/Exp=0.2255]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2538728906601384
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.89s/it] 50%|█████     | 1/2 [00:04<00:02,  2.89s/it, CE=2.236346e+00 H=2.236302e+00 dV_dx=7.032128e-06 dV_dθ=-5.165144e-05 ||∇||=4.990338e-01 | Tr=0.1317 Te/Cur=0.1426 Te/Exp=0.2948]100%|██████████| 2/2 [00:04<00:00,  2.34s/it, CE=2.236346e+00 H=2.236302e+00 dV_dx=7.032128e-06 dV_dθ=-5.165144e-05 ||∇||=4.990338e-01 | Tr=0.1317 Te/Cur=0.1426 Te/Exp=0.2948]100%|██████████| 2/2 [00:04<00:00,  2.42s/it, CE=2.236346e+00 H=2.236302e+00 dV_dx=7.032128e-06 dV_dθ=-5.165144e-05 ||∇||=4.990338e-01 | Tr=0.1317 Te/Cur=0.1426 Te/Exp=0.2948]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 124, 10]) with loss 2.236346
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.93s/it] 50%|█████     | 1/2 [00:11<00:09,  9.93s/it, CE=2.245514e+00 H=2.245375e+00 dV_dx=-4.688233e-06 dV_dθ=-1.340633e-04 ||∇||=4.827048e-01 | Tr=0.1461 Te/Cur=0.1762 Te/Exp=0.2823]100%|██████████| 2/2 [00:11<00:00,  5.09s/it, CE=2.245514e+00 H=2.245375e+00 dV_dx=-4.688233e-06 dV_dθ=-1.340633e-04 ||∇||=4.827048e-01 | Tr=0.1461 Te/Cur=0.1762 Te/Exp=0.2823]100%|██████████| 2/2 [00:11<00:00,  5.81s/it, CE=2.245514e+00 H=2.245375e+00 dV_dx=-4.688233e-06 dV_dθ=-1.340633e-04 ||∇||=4.827048e-01 | Tr=0.1461 Te/Cur=0.1762 Te/Exp=0.2823]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.73s/it] 50%|█████     | 1/2 [00:05<00:03,  3.73s/it, CE=2.241169e+00 H=2.240980e+00 dV_dx=-3.054520e-06 dV_dθ=-1.855234e-04 ||∇||=5.126643e-01 | Tr=0.1092 Te/Cur=0.1135 Te/Exp=0.2727]100%|██████████| 2/2 [00:05<00:00,  2.69s/it, CE=2.241169e+00 H=2.240980e+00 dV_dx=-3.054520e-06 dV_dθ=-1.855234e-04 ||∇||=5.126643e-01 | Tr=0.1092 Te/Cur=0.1135 Te/Exp=0.2727]100%|██████████| 2/2 [00:05<00:00,  2.84s/it, CE=2.241169e+00 H=2.240980e+00 dV_dx=-3.054520e-06 dV_dθ=-1.855234e-04 ||∇||=5.126643e-01 | Tr=0.1092 Te/Cur=0.1135 Te/Exp=0.2727]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.17s/it] 50%|█████     | 1/2 [00:05<00:03,  3.17s/it, CE=2.227679e+00 H=2.227636e+00 dV_dx=5.619453e-06 dV_dθ=-4.866604e-05 ||∇||=5.301138e-01 | Tr=0.1204 Te/Cur=0.1017 Te/Exp=0.3065]100%|██████████| 2/2 [00:05<00:00,  2.56s/it, CE=2.227679e+00 H=2.227636e+00 dV_dx=5.619453e-06 dV_dθ=-4.866604e-05 ||∇||=5.301138e-01 | Tr=0.1204 Te/Cur=0.1017 Te/Exp=0.3065]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.227679e+00 H=2.227636e+00 dV_dx=5.619453e-06 dV_dθ=-4.866604e-05 ||∇||=5.301138e-01 | Tr=0.1204 Te/Cur=0.1017 Te/Exp=0.3065]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 652, 164, 10]) with loss 2.227679
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:12<00:12, 12.08s/it] 50%|█████     | 1/2 [00:13<00:12, 12.08s/it, CE=2.235986e+00 H=2.235845e+00 dV_dx=-3.674469e-06 dV_dθ=-1.374487e-04 ||∇||=5.114162e-01 | Tr=0.1281 Te/Cur=0.1370 Te/Exp=0.3028]100%|██████████| 2/2 [00:13<00:00,  6.10s/it, CE=2.235986e+00 H=2.235845e+00 dV_dx=-3.674469e-06 dV_dθ=-1.374487e-04 ||∇||=5.114162e-01 | Tr=0.1281 Te/Cur=0.1370 Te/Exp=0.3028]100%|██████████| 2/2 [00:13<00:00,  7.00s/it, CE=2.235986e+00 H=2.235845e+00 dV_dx=-3.674469e-06 dV_dθ=-1.374487e-04 ||∇||=5.114162e-01 | Tr=0.1281 Te/Cur=0.1370 Te/Exp=0.3028]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.48s/it] 50%|█████     | 1/2 [00:12<00:10, 10.48s/it, CE=2.257860e+00 H=2.257717e+00 dV_dx=5.243666e-06 dV_dθ=-1.482968e-04 ||∇||=4.838381e-01 | Tr=0.1864 Te/Cur=0.2062 Te/Exp=0.2896]100%|██████████| 2/2 [00:12<00:00,  5.52s/it, CE=2.257860e+00 H=2.257717e+00 dV_dx=5.243666e-06 dV_dθ=-1.482968e-04 ||∇||=4.838381e-01 | Tr=0.1864 Te/Cur=0.2062 Te/Exp=0.2896]100%|██████████| 2/2 [00:12<00:00,  6.27s/it, CE=2.257860e+00 H=2.257717e+00 dV_dx=5.243666e-06 dV_dθ=-1.482968e-04 ||∇||=4.838381e-01 | Tr=0.1864 Te/Cur=0.2062 Te/Exp=0.2896]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.11s/it] 50%|█████     | 1/2 [00:10<00:09,  9.11s/it, CE=2.239001e+00 H=2.238847e+00 dV_dx=-6.699156e-06 dV_dθ=-1.474268e-04 ||∇||=5.373605e-01 | Tr=0.1394 Te/Cur=0.1603 Te/Exp=0.3140]100%|██████████| 2/2 [00:10<00:00,  4.79s/it, CE=2.239001e+00 H=2.238847e+00 dV_dx=-6.699156e-06 dV_dθ=-1.474268e-04 ||∇||=5.373605e-01 | Tr=0.1394 Te/Cur=0.1603 Te/Exp=0.3140]100%|██████████| 2/2 [00:10<00:00,  5.44s/it, CE=2.239001e+00 H=2.238847e+00 dV_dx=-6.699156e-06 dV_dθ=-1.474268e-04 ||∇||=5.373605e-01 | Tr=0.1394 Te/Cur=0.1603 Te/Exp=0.3140]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.26s/it] 50%|█████     | 1/2 [00:12<00:10, 10.26s/it, CE=2.236765e+00 H=2.236647e+00 dV_dx=1.138471e-06 dV_dθ=-1.192875e-04 ||∇||=5.479190e-01 | Tr=0.1652 Te/Cur=0.1534 Te/Exp=0.2840]100%|██████████| 2/2 [00:12<00:00,  5.27s/it, CE=2.236765e+00 H=2.236647e+00 dV_dx=1.138471e-06 dV_dθ=-1.192875e-04 ||∇||=5.479190e-01 | Tr=0.1652 Te/Cur=0.1534 Te/Exp=0.2840]100%|██████████| 2/2 [00:12<00:00,  6.02s/it, CE=2.236765e+00 H=2.236647e+00 dV_dx=1.138471e-06 dV_dθ=-1.192875e-04 ||∇||=5.479190e-01 | Tr=0.1652 Te/Cur=0.1534 Te/Exp=0.2840]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.71s/it] 50%|█████     | 1/2 [00:05<00:03,  3.71s/it, CE=2.267630e+00 H=2.267602e+00 dV_dx=7.890651e-06 dV_dθ=-3.618264e-05 ||∇||=3.313943e-01 | Tr=0.0907 Te/Cur=0.0879 Te/Exp=0.2253]100%|██████████| 2/2 [00:05<00:00,  2.62s/it, CE=2.267630e+00 H=2.267602e+00 dV_dx=7.890651e-06 dV_dθ=-3.618264e-05 ||∇||=3.313943e-01 | Tr=0.0907 Te/Cur=0.0879 Te/Exp=0.2253]100%|██████████| 2/2 [00:05<00:00,  2.78s/it, CE=2.267630e+00 H=2.267602e+00 dV_dx=7.890651e-06 dV_dθ=-3.618264e-05 ||∇||=3.313943e-01 | Tr=0.0907 Te/Cur=0.0879 Te/Exp=0.2253]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.60s/it] 50%|█████     | 1/2 [00:05<00:03,  3.60s/it, CE=2.269001e+00 H=2.268958e+00 dV_dx=4.599612e-06 dV_dθ=-4.779503e-05 ||∇||=3.576813e-01 | Tr=0.0875 Te/Cur=0.0955 Te/Exp=0.2089]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.269001e+00 H=2.268958e+00 dV_dx=4.599612e-06 dV_dθ=-4.779503e-05 ||∇||=3.576813e-01 | Tr=0.0875 Te/Cur=0.0955 Te/Exp=0.2089]100%|██████████| 2/2 [00:05<00:00,  2.76s/it, CE=2.269001e+00 H=2.268958e+00 dV_dx=4.599612e-06 dV_dθ=-4.779503e-05 ||∇||=3.576813e-01 | Tr=0.0875 Te/Cur=0.0955 Te/Exp=0.2089]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.40s/it] 50%|█████     | 1/2 [00:12<00:10, 10.40s/it, CE=2.273319e+00 H=2.273268e+00 dV_dx=-6.939503e-06 dV_dθ=-4.392215e-05 ||∇||=3.302050e-01 | Tr=0.1135 Te/Cur=0.1202 Te/Exp=0.1668]100%|██████████| 2/2 [00:12<00:00,  5.38s/it, CE=2.273319e+00 H=2.273268e+00 dV_dx=-6.939503e-06 dV_dθ=-4.392215e-05 ||∇||=3.302050e-01 | Tr=0.1135 Te/Cur=0.1202 Te/Exp=0.1668]100%|██████████| 2/2 [00:12<00:00,  6.13s/it, CE=2.273319e+00 H=2.273268e+00 dV_dx=-6.939503e-06 dV_dθ=-4.392215e-05 ||∇||=3.302050e-01 | Tr=0.1135 Te/Cur=0.1202 Te/Exp=0.1668]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.02s/it] 50%|█████     | 1/2 [00:05<00:04,  4.02s/it, CE=2.265432e+00 H=2.265415e+00 dV_dx=2.735027e-06 dV_dθ=-1.976230e-05 ||∇||=3.859580e-01 | Tr=0.1066 Te/Cur=0.1278 Te/Exp=0.2374]100%|██████████| 2/2 [00:05<00:00,  2.66s/it, CE=2.265432e+00 H=2.265415e+00 dV_dx=2.735027e-06 dV_dθ=-1.976230e-05 ||∇||=3.859580e-01 | Tr=0.1066 Te/Cur=0.1278 Te/Exp=0.2374]100%|██████████| 2/2 [00:05<00:00,  2.87s/it, CE=2.265432e+00 H=2.265415e+00 dV_dx=2.735027e-06 dV_dθ=-1.976230e-05 ||∇||=3.859580e-01 | Tr=0.1066 Te/Cur=0.1278 Te/Exp=0.2374]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.53s/it] 50%|█████     | 1/2 [00:08<00:06,  6.53s/it, CE=2.262549e+00 H=2.262532e+00 dV_dx=2.877928e-06 dV_dθ=-1.964233e-05 ||∇||=3.407179e-01 | Tr=0.0857 Te/Cur=0.0910 Te/Exp=0.2233]100%|██████████| 2/2 [00:08<00:00,  3.82s/it, CE=2.262549e+00 H=2.262532e+00 dV_dx=2.877928e-06 dV_dθ=-1.964233e-05 ||∇||=3.407179e-01 | Tr=0.0857 Te/Cur=0.0910 Te/Exp=0.2233]100%|██████████| 2/2 [00:08<00:00,  4.23s/it, CE=2.262549e+00 H=2.262532e+00 dV_dx=2.877928e-06 dV_dθ=-1.964233e-05 ||∇||=3.407179e-01 | Tr=0.0857 Te/Cur=0.0910 Te/Exp=0.2233]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.07s/it] 50%|█████     | 1/2 [00:12<00:10, 10.07s/it, CE=2.274374e+00 H=2.274352e+00 dV_dx=1.292359e-06 dV_dθ=-2.371207e-05 ||∇||=3.700320e-01 | Tr=0.0792 Te/Cur=0.0863 Te/Exp=0.2128]100%|██████████| 2/2 [00:12<00:00,  5.32s/it, CE=2.274374e+00 H=2.274352e+00 dV_dx=1.292359e-06 dV_dθ=-2.371207e-05 ||∇||=3.700320e-01 | Tr=0.0792 Te/Cur=0.0863 Te/Exp=0.2128]100%|██████████| 2/2 [00:12<00:00,  6.04s/it, CE=2.274374e+00 H=2.274352e+00 dV_dx=1.292359e-06 dV_dθ=-2.371207e-05 ||∇||=3.700320e-01 | Tr=0.0792 Te/Cur=0.0863 Te/Exp=0.2128]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.25s/it] 50%|█████     | 1/2 [00:10<00:09,  9.25s/it, CE=2.262676e+00 H=2.262633e+00 dV_dx=8.331773e-06 dV_dθ=-5.045497e-05 ||∇||=3.492460e-01 | Tr=0.1008 Te/Cur=0.1225 Te/Exp=0.2303]100%|██████████| 2/2 [00:10<00:00,  4.78s/it, CE=2.262676e+00 H=2.262633e+00 dV_dx=8.331773e-06 dV_dθ=-5.045497e-05 ||∇||=3.492460e-01 | Tr=0.1008 Te/Cur=0.1225 Te/Exp=0.2303]100%|██████████| 2/2 [00:10<00:00,  5.45s/it, CE=2.262676e+00 H=2.262633e+00 dV_dx=8.331773e-06 dV_dθ=-5.045497e-05 ||∇||=3.492460e-01 | Tr=0.1008 Te/Cur=0.1225 Te/Exp=0.2303]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.57s/it] 50%|█████     | 1/2 [00:12<00:10, 10.57s/it, CE=2.262316e+00 H=2.262289e+00 dV_dx=-2.558035e-06 dV_dθ=-2.441810e-05 ||∇||=3.676834e-01 | Tr=0.0738 Te/Cur=0.0770 Te/Exp=0.2573]100%|██████████| 2/2 [00:12<00:00,  5.49s/it, CE=2.262316e+00 H=2.262289e+00 dV_dx=-2.558035e-06 dV_dθ=-2.441810e-05 ||∇||=3.676834e-01 | Tr=0.0738 Te/Cur=0.0770 Te/Exp=0.2573]100%|██████████| 2/2 [00:12<00:00,  6.25s/it, CE=2.262316e+00 H=2.262289e+00 dV_dx=-2.558035e-06 dV_dθ=-2.441810e-05 ||∇||=3.676834e-01 | Tr=0.0738 Te/Cur=0.0770 Te/Exp=0.2573]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.85s/it] 50%|█████     | 1/2 [00:11<00:09,  9.85s/it, CE=2.264779e+00 H=2.264720e+00 dV_dx=-5.183540e-06 dV_dθ=-5.398941e-05 ||∇||=3.594994e-01 | Tr=0.1211 Te/Cur=0.1122 Te/Exp=0.2437]100%|██████████| 2/2 [00:11<00:00,  5.30s/it, CE=2.264779e+00 H=2.264720e+00 dV_dx=-5.183540e-06 dV_dθ=-5.398941e-05 ||∇||=3.594994e-01 | Tr=0.1211 Te/Cur=0.1122 Te/Exp=0.2437]100%|██████████| 2/2 [00:11<00:00,  5.99s/it, CE=2.264779e+00 H=2.264720e+00 dV_dx=-5.183540e-06 dV_dθ=-5.398941e-05 ||∇||=3.594994e-01 | Tr=0.1211 Te/Cur=0.1122 Te/Exp=0.2437]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.21s/it] 50%|█████     | 1/2 [00:04<00:03,  3.21s/it, CE=2.272046e+00 H=2.271964e+00 dV_dx=-5.496918e-06 dV_dθ=-7.650886e-05 ||∇||=3.514325e-01 | Tr=0.1275 Te/Cur=0.1500 Te/Exp=0.2212]100%|██████████| 2/2 [00:04<00:00,  2.25s/it, CE=2.272046e+00 H=2.271964e+00 dV_dx=-5.496918e-06 dV_dθ=-7.650886e-05 ||∇||=3.514325e-01 | Tr=0.1275 Te/Cur=0.1500 Te/Exp=0.2212]100%|██████████| 2/2 [00:04<00:00,  2.40s/it, CE=2.272046e+00 H=2.271964e+00 dV_dx=-5.496918e-06 dV_dθ=-7.650886e-05 ||∇||=3.514325e-01 | Tr=0.1275 Te/Cur=0.1500 Te/Exp=0.2212]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.08s/it] 50%|█████     | 1/2 [00:06<00:04,  4.08s/it, CE=2.275912e+00 H=2.275839e+00 dV_dx=3.261430e-06 dV_dθ=-7.696779e-05 ||∇||=3.637424e-01 | Tr=0.1603 Te/Cur=0.1996 Te/Exp=0.2035]100%|██████████| 2/2 [00:06<00:00,  2.89s/it, CE=2.275912e+00 H=2.275839e+00 dV_dx=3.261430e-06 dV_dθ=-7.696779e-05 ||∇||=3.637424e-01 | Tr=0.1603 Te/Cur=0.1996 Te/Exp=0.2035]100%|██████████| 2/2 [00:06<00:00,  3.07s/it, CE=2.275912e+00 H=2.275839e+00 dV_dx=3.261430e-06 dV_dθ=-7.696779e-05 ||∇||=3.637424e-01 | Tr=0.1603 Te/Cur=0.1996 Te/Exp=0.2035]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.88s/it] 50%|█████     | 1/2 [00:15<00:10, 10.88s/it, CE=2.273358e+00 H=2.273282e+00 dV_dx=4.293813e-06 dV_dθ=-8.064259e-05 ||∇||=3.291490e-01 | Tr=0.1149 Te/Cur=0.1226 Te/Exp=0.2137]100%|██████████| 2/2 [00:15<00:00,  7.17s/it, CE=2.273358e+00 H=2.273282e+00 dV_dx=4.293813e-06 dV_dθ=-8.064259e-05 ||∇||=3.291490e-01 | Tr=0.1149 Te/Cur=0.1226 Te/Exp=0.2137]100%|██████████| 2/2 [00:15<00:00,  7.73s/it, CE=2.273358e+00 H=2.273282e+00 dV_dx=4.293813e-06 dV_dθ=-8.064259e-05 ||∇||=3.291490e-01 | Tr=0.1149 Te/Cur=0.1226 Te/Exp=0.2137]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.94s/it] 50%|█████     | 1/2 [00:05<00:03,  3.94s/it, CE=2.264591e+00 H=2.264491e+00 dV_dx=-4.555192e-06 dV_dθ=-9.536951e-05 ||∇||=3.733158e-01 | Tr=0.1076 Te/Cur=0.1358 Te/Exp=0.2343]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.264591e+00 H=2.264491e+00 dV_dx=-4.555192e-06 dV_dθ=-9.536951e-05 ||∇||=3.733158e-01 | Tr=0.1076 Te/Cur=0.1358 Te/Exp=0.2343]100%|██████████| 2/2 [00:05<00:00,  2.87s/it, CE=2.264591e+00 H=2.264491e+00 dV_dx=-4.555192e-06 dV_dθ=-9.536951e-05 ||∇||=3.733158e-01 | Tr=0.1076 Te/Cur=0.1358 Te/Exp=0.2343]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.91s/it] 50%|█████     | 1/2 [00:05<00:03,  3.91s/it, CE=2.267087e+00 H=2.266985e+00 dV_dx=-5.502824e-06 dV_dθ=-9.721593e-05 ||∇||=3.752859e-01 | Tr=0.1181 Te/Cur=0.1174 Te/Exp=0.2156]100%|██████████| 2/2 [00:05<00:00,  2.79s/it, CE=2.267087e+00 H=2.266985e+00 dV_dx=-5.502824e-06 dV_dθ=-9.721593e-05 ||∇||=3.752859e-01 | Tr=0.1181 Te/Cur=0.1174 Te/Exp=0.2156]100%|██████████| 2/2 [00:05<00:00,  2.96s/it, CE=2.267087e+00 H=2.266985e+00 dV_dx=-5.502824e-06 dV_dθ=-9.721593e-05 ||∇||=3.752859e-01 | Tr=0.1181 Te/Cur=0.1174 Te/Exp=0.2156]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.73s/it] 50%|█████     | 1/2 [00:11<00:09,  9.73s/it, CE=2.259161e+00 H=2.259088e+00 dV_dx=-8.119679e-06 dV_dθ=-6.492005e-05 ||∇||=3.368446e-01 | Tr=0.1225 Te/Cur=0.1293 Te/Exp=0.2778]100%|██████████| 2/2 [00:11<00:00,  5.19s/it, CE=2.259161e+00 H=2.259088e+00 dV_dx=-8.119679e-06 dV_dθ=-6.492005e-05 ||∇||=3.368446e-01 | Tr=0.1225 Te/Cur=0.1293 Te/Exp=0.2778]100%|██████████| 2/2 [00:11<00:00,  5.87s/it, CE=2.259161e+00 H=2.259088e+00 dV_dx=-8.119679e-06 dV_dθ=-6.492005e-05 ||∇||=3.368446e-01 | Tr=0.1225 Te/Cur=0.1293 Te/Exp=0.2778]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.04s/it] 50%|█████     | 1/2 [00:12<00:10, 10.04s/it, CE=2.268977e+00 H=2.268940e+00 dV_dx=9.187274e-06 dV_dθ=-4.682154e-05 ||∇||=3.203960e-01 | Tr=0.1048 Te/Cur=0.1183 Te/Exp=0.2307]100%|██████████| 2/2 [00:12<00:00,  5.29s/it, CE=2.268977e+00 H=2.268940e+00 dV_dx=9.187274e-06 dV_dθ=-4.682154e-05 ||∇||=3.203960e-01 | Tr=0.1048 Te/Cur=0.1183 Te/Exp=0.2307]100%|██████████| 2/2 [00:12<00:00,  6.00s/it, CE=2.268977e+00 H=2.268940e+00 dV_dx=9.187274e-06 dV_dθ=-4.682154e-05 ||∇||=3.203960e-01 | Tr=0.1048 Te/Cur=0.1183 Te/Exp=0.2307]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.56s/it] 50%|█████     | 1/2 [00:11<00:09,  9.56s/it, CE=2.271558e+00 H=2.271489e+00 dV_dx=3.449227e-06 dV_dθ=-7.293944e-05 ||∇||=3.583467e-01 | Tr=0.1320 Te/Cur=0.1414 Te/Exp=0.2281]100%|██████████| 2/2 [00:11<00:00,  5.20s/it, CE=2.271558e+00 H=2.271489e+00 dV_dx=3.449227e-06 dV_dθ=-7.293944e-05 ||∇||=3.583467e-01 | Tr=0.1320 Te/Cur=0.1414 Te/Exp=0.2281]100%|██████████| 2/2 [00:11<00:00,  5.85s/it, CE=2.271558e+00 H=2.271489e+00 dV_dx=3.449227e-06 dV_dθ=-7.293944e-05 ||∇||=3.583467e-01 | Tr=0.1320 Te/Cur=0.1414 Te/Exp=0.2281]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.37s/it] 50%|█████     | 1/2 [00:12<00:10, 10.37s/it, CE=2.258180e+00 H=2.258132e+00 dV_dx=-5.297181e-06 dV_dθ=-4.185254e-05 ||∇||=3.357797e-01 | Tr=0.1156 Te/Cur=0.1247 Te/Exp=0.2691]100%|██████████| 2/2 [00:12<00:00,  5.37s/it, CE=2.258180e+00 H=2.258132e+00 dV_dx=-5.297181e-06 dV_dθ=-4.185254e-05 ||∇||=3.357797e-01 | Tr=0.1156 Te/Cur=0.1247 Te/Exp=0.2691]100%|██████████| 2/2 [00:12<00:00,  6.12s/it, CE=2.258180e+00 H=2.258132e+00 dV_dx=-5.297181e-06 dV_dθ=-4.185254e-05 ||∇||=3.357797e-01 | Tr=0.1156 Te/Cur=0.1247 Te/Exp=0.2691]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 652, 164, 10]) with loss 2.227679
  Total candidates evaluated: 54
  Original: (3, [507, 632, 144, 10])
  Optimal: (2, [507, 652, 164, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 3→2, feed [507, 632, 144, 10]→[507, 652, 164, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 3)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:16<05:21, 16.90s/it]  5%|▌         | 1/20 [00:19<05:21, 16.90s/it, CE=2.513962e+00 H=2.520525e+00 dV_dx=1.887548e-04 dV_dθ=6.374665e-03 ||∇||=9.382637e+00 | Tr=0.8176] 10%|█         | 2/20 [00:19<02:29,  8.32s/it, CE=2.513962e+00 H=2.520525e+00 dV_dx=1.887548e-04 dV_dθ=6.374665e-03 ||∇||=9.382637e+00 | Tr=0.8176] 10%|█         | 2/20 [00:21<02:29,  8.32s/it, CE=2.016626e+00 H=2.013822e+00 dV_dx=1.604716e-04 dV_dθ=-2.964471e-03 ||∇||=7.796493e+00 | Tr=0.8176] 15%|█▌        | 3/20 [00:21<01:35,  5.61s/it, CE=2.016626e+00 H=2.013822e+00 dV_dx=1.604716e-04 dV_dθ=-2.964471e-03 ||∇||=7.796493e+00 | Tr=0.8176] 15%|█▌        | 3/20 [00:23<01:35,  5.61s/it, CE=1.750390e+00 H=1.746666e+00 dV_dx=1.679811e-05 dV_dθ=-3.740460e-03 ||∇||=6.858498e+00 | Tr=0.8176] 20%|██        | 4/20 [00:23<01:07,  4.25s/it, CE=1.750390e+00 H=1.746666e+00 dV_dx=1.679811e-05 dV_dθ=-3.740460e-03 ||∇||=6.858498e+00 | Tr=0.8176] 20%|██        | 4/20 [00:25<01:07,  4.25s/it, CE=1.561277e+00 H=1.557715e+00 dV_dx=2.427168e-05 dV_dθ=-3.585900e-03 ||∇||=6.607976e+00 | Tr=0.8176] 25%|██▌       | 5/20 [00:25<00:52,  3.49s/it, CE=1.561277e+00 H=1.557715e+00 dV_dx=2.427168e-05 dV_dθ=-3.585900e-03 ||∇||=6.607976e+00 | Tr=0.8176] 25%|██▌       | 5/20 [00:28<00:52,  3.49s/it, CE=1.412219e+00 H=1.403870e+00 dV_dx=-3.149023e-05 dV_dθ=-8.316886e-03 ||∇||=6.592869e+00 | Tr=0.8176] 30%|███       | 6/20 [00:28<00:43,  3.10s/it, CE=1.412219e+00 H=1.403870e+00 dV_dx=-3.149023e-05 dV_dθ=-8.316886e-03 ||∇||=6.592869e+00 | Tr=0.8176] 30%|███       | 6/20 [00:29<00:43,  3.10s/it, CE=1.296714e+00 H=1.285549e+00 dV_dx=-1.608219e-05 dV_dθ=-1.114861e-02 ||∇||=6.611648e+00 | Tr=0.8176] 35%|███▌      | 7/20 [00:29<00:34,  2.65s/it, CE=1.296714e+00 H=1.285549e+00 dV_dx=-1.608219e-05 dV_dθ=-1.114861e-02 ||∇||=6.611648e+00 | Tr=0.8176] 35%|███▌      | 7/20 [00:32<00:34,  2.65s/it, CE=1.206166e+00 H=1.192351e+00 dV_dx=1.437317e-05 dV_dθ=-1.382849e-02 ||∇||=6.599111e+00 | Tr=0.8176]  40%|████      | 8/20 [00:32<00:30,  2.57s/it, CE=1.206166e+00 H=1.192351e+00 dV_dx=1.437317e-05 dV_dθ=-1.382849e-02 ||∇||=6.599111e+00 | Tr=0.8176] 40%|████      | 8/20 [00:34<00:30,  2.57s/it, CE=1.133966e+00 H=1.119230e+00 dV_dx=4.024576e-05 dV_dθ=-1.477674e-02 ||∇||=6.657546e+00 | Tr=0.8176] 45%|████▌     | 9/20 [00:34<00:25,  2.31s/it, CE=1.133966e+00 H=1.119230e+00 dV_dx=4.024576e-05 dV_dθ=-1.477674e-02 ||∇||=6.657546e+00 | Tr=0.8176] 45%|████▌     | 9/20 [00:36<00:25,  2.31s/it, CE=1.074084e+00 H=1.058071e+00 dV_dx=-5.813254e-05 dV_dθ=-1.595452e-02 ||∇||=6.659009e+00 | Tr=0.8176] 50%|█████     | 10/20 [00:36<00:22,  2.29s/it, CE=1.074084e+00 H=1.058071e+00 dV_dx=-5.813254e-05 dV_dθ=-1.595452e-02 ||∇||=6.659009e+00 | Tr=0.8176] 50%|█████     | 10/20 [00:39<00:22,  2.29s/it, CE=1.021355e+00 H=1.007010e+00 dV_dx=-1.413182e-05 dV_dθ=-1.433109e-02 ||∇||=6.389473e+00 | Tr=0.8176] 55%|█████▌    | 11/20 [00:39<00:22,  2.46s/it, CE=1.021355e+00 H=1.007010e+00 dV_dx=-1.413182e-05 dV_dθ=-1.433109e-02 ||∇||=6.389473e+00 | Tr=0.8176] 55%|█████▌    | 11/20 [00:41<00:22,  2.46s/it, CE=9.753775e-01 H=9.632586e-01 dV_dx=-2.187714e-05 dV_dθ=-1.209704e-02 ||∇||=6.122594e+00 | Tr=0.8176] 60%|██████    | 12/20 [00:41<00:19,  2.45s/it, CE=9.753775e-01 H=9.632586e-01 dV_dx=-2.187714e-05 dV_dθ=-1.209704e-02 ||∇||=6.122594e+00 | Tr=0.8176] 60%|██████    | 12/20 [00:43<00:19,  2.45s/it, CE=9.370210e-01 H=9.247586e-01 dV_dx=-7.974366e-06 dV_dθ=-1.225445e-02 ||∇||=6.108661e+00 | Tr=0.8176] 65%|██████▌   | 13/20 [00:43<00:14,  2.14s/it, CE=9.370210e-01 H=9.247586e-01 dV_dx=-7.974366e-06 dV_dθ=-1.225445e-02 ||∇||=6.108661e+00 | Tr=0.8176] 65%|██████▌   | 13/20 [00:45<00:14,  2.14s/it, CE=9.041760e-01 H=8.901683e-01 dV_dx=6.907877e-05 dV_dθ=-1.407679e-02 ||∇||=6.265323e+00 | Tr=0.8176]  70%|███████   | 14/20 [00:45<00:12,  2.14s/it, CE=9.041760e-01 H=8.901683e-01 dV_dx=6.907877e-05 dV_dθ=-1.407679e-02 ||∇||=6.265323e+00 | Tr=0.8176] 70%|███████   | 14/20 [00:47<00:12,  2.14s/it, CE=8.733220e-01 H=8.609224e-01 dV_dx=6.286611e-05 dV_dθ=-1.246246e-02 ||∇||=6.116793e+00 | Tr=0.8176] 75%|███████▌  | 15/20 [00:47<00:11,  2.23s/it, CE=8.733220e-01 H=8.609224e-01 dV_dx=6.286611e-05 dV_dθ=-1.246246e-02 ||∇||=6.116793e+00 | Tr=0.8176] 75%|███████▌  | 15/20 [00:50<00:11,  2.23s/it, CE=8.460445e-01 H=8.306565e-01 dV_dx=-4.141171e-05 dV_dθ=-1.534655e-02 ||∇||=6.257467e+00 | Tr=0.8176] 80%|████████  | 16/20 [00:50<00:09,  2.34s/it, CE=8.460445e-01 H=8.306565e-01 dV_dx=-4.141171e-05 dV_dθ=-1.534655e-02 ||∇||=6.257467e+00 | Tr=0.8176] 80%|████████  | 16/20 [00:52<00:09,  2.34s/it, CE=8.221696e-01 H=8.033504e-01 dV_dx=6.784799e-05 dV_dθ=-1.888711e-02 ||∇||=6.540574e+00 | Tr=0.8176]  85%|████████▌ | 17/20 [00:52<00:06,  2.22s/it, CE=8.221696e-01 H=8.033504e-01 dV_dx=6.784799e-05 dV_dθ=-1.888711e-02 ||∇||=6.540574e+00 | Tr=0.8176] 85%|████████▌ | 17/20 [00:54<00:06,  2.22s/it, CE=7.986770e-01 H=7.820075e-01 dV_dx=3.823881e-05 dV_dθ=-1.670773e-02 ||∇||=6.375076e+00 | Tr=0.8176] 90%|█████████ | 18/20 [00:54<00:04,  2.36s/it, CE=7.986770e-01 H=7.820075e-01 dV_dx=3.823881e-05 dV_dθ=-1.670773e-02 ||∇||=6.375076e+00 | Tr=0.8176] 90%|█████████ | 18/20 [00:57<00:04,  2.36s/it, CE=7.779065e-01 H=7.638424e-01 dV_dx=-6.839216e-05 dV_dθ=-1.399569e-02 ||∇||=6.200697e+00 | Tr=0.8176] 95%|█████████▌| 19/20 [00:57<00:02,  2.30s/it, CE=7.779065e-01 H=7.638424e-01 dV_dx=-6.839216e-05 dV_dθ=-1.399569e-02 ||∇||=6.200697e+00 | Tr=0.8176] 95%|█████████▌| 19/20 [01:01<00:02,  2.30s/it, CE=7.606552e-01 H=7.433004e-01 dV_dx=-9.018954e-06 dV_dθ=-1.734579e-02 ||∇||=6.452067e+00 | Tr=0.8176 Te/Cur=0.9084 Te/Exp=0.7227]100%|██████████| 20/20 [01:05<00:00,  4.15s/it, CE=7.606552e-01 H=7.433004e-01 dV_dx=-9.018954e-06 dV_dθ=-1.734579e-02 ||∇||=6.452067e+00 | Tr=0.8176 Te/Cur=0.9084 Te/Exp=0.7227]100%|██████████| 20/20 [01:05<00:00,  3.27s/it, CE=7.606552e-01 H=7.433004e-01 dV_dx=-9.018954e-06 dV_dθ=-1.734579e-02 ||∇||=6.452067e+00 | Tr=0.8176 Te/Cur=0.9084 Te/Exp=0.7227]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.671387
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:07<02:16,  7.17s/it]  5%|▌         | 1/20 [00:09<02:16,  7.17s/it, CE=7.899453e-01 H=7.774101e-01 dV_dx=-1.537657e-06 dV_dθ=-1.253369e-02 ||∇||=6.049384e+00 | Tr=0.8171] 10%|█         | 2/20 [00:09<01:13,  4.08s/it, CE=7.899453e-01 H=7.774101e-01 dV_dx=-1.537657e-06 dV_dθ=-1.253369e-02 ||∇||=6.049384e+00 | Tr=0.8171] 10%|█         | 2/20 [00:11<01:13,  4.08s/it, CE=7.609056e-01 H=7.462090e-01 dV_dx=-2.092022e-05 dV_dθ=-1.467575e-02 ||∇||=6.179317e+00 | Tr=0.8171] 15%|█▌        | 3/20 [00:11<00:58,  3.43s/it, CE=7.609056e-01 H=7.462090e-01 dV_dx=-2.092022e-05 dV_dθ=-1.467575e-02 ||∇||=6.179317e+00 | Tr=0.8171] 15%|█▌        | 3/20 [00:14<00:58,  3.43s/it, CE=7.362784e-01 H=7.237586e-01 dV_dx=-4.931790e-05 dV_dθ=-1.247047e-02 ||∇||=5.981165e+00 | Tr=0.8171] 20%|██        | 4/20 [00:14<00:49,  3.12s/it, CE=7.362784e-01 H=7.237586e-01 dV_dx=-4.931790e-05 dV_dθ=-1.247047e-02 ||∇||=5.981165e+00 | Tr=0.8171] 20%|██        | 4/20 [00:17<00:49,  3.12s/it, CE=7.149955e-01 H=7.018326e-01 dV_dx=2.957142e-05 dV_dθ=-1.319254e-02 ||∇||=5.982993e+00 | Tr=0.8171]  25%|██▌       | 5/20 [00:17<00:45,  3.01s/it, CE=7.149955e-01 H=7.018326e-01 dV_dx=2.957142e-05 dV_dθ=-1.319254e-02 ||∇||=5.982993e+00 | Tr=0.8171] 25%|██▌       | 5/20 [00:19<00:45,  3.01s/it, CE=6.965598e-01 H=6.814763e-01 dV_dx=6.635880e-06 dV_dθ=-1.509021e-02 ||∇||=6.125725e+00 | Tr=0.8171] 30%|███       | 6/20 [00:19<00:38,  2.72s/it, CE=6.965598e-01 H=6.814763e-01 dV_dx=6.635880e-06 dV_dθ=-1.509021e-02 ||∇||=6.125725e+00 | Tr=0.8171] 30%|███       | 6/20 [00:21<00:38,  2.72s/it, CE=6.830329e-01 H=6.617976e-01 dV_dx=3.645700e-05 dV_dθ=-2.127174e-02 ||∇||=6.689715e+00 | Tr=0.8171] 35%|███▌      | 7/20 [00:21<00:33,  2.61s/it, CE=6.830329e-01 H=6.617976e-01 dV_dx=3.645700e-05 dV_dθ=-2.127174e-02 ||∇||=6.689715e+00 | Tr=0.8171] 35%|███▌      | 7/20 [00:24<00:33,  2.61s/it, CE=6.675155e-01 H=6.453459e-01 dV_dx=4.038425e-06 dV_dθ=-2.217362e-02 ||∇||=6.750737e+00 | Tr=0.8171] 40%|████      | 8/20 [00:24<00:31,  2.58s/it, CE=6.675155e-01 H=6.453459e-01 dV_dx=4.038425e-06 dV_dθ=-2.217362e-02 ||∇||=6.750737e+00 | Tr=0.8171] 40%|████      | 8/20 [00:26<00:31,  2.58s/it, CE=6.550703e-01 H=6.253072e-01 dV_dx=-1.928455e-05 dV_dθ=-2.974387e-02 ||∇||=7.258615e+00 | Tr=0.8171] 45%|████▌     | 9/20 [00:26<00:27,  2.47s/it, CE=6.550703e-01 H=6.253072e-01 dV_dx=-1.928455e-05 dV_dθ=-2.974387e-02 ||∇||=7.258615e+00 | Tr=0.8171] 45%|████▌     | 9/20 [00:28<00:27,  2.47s/it, CE=6.440551e-01 H=6.149331e-01 dV_dx=4.547321e-05 dV_dθ=-2.916751e-02 ||∇||=7.311109e+00 | Tr=0.8171]  50%|█████     | 10/20 [00:28<00:22,  2.28s/it, CE=6.440551e-01 H=6.149331e-01 dV_dx=4.547321e-05 dV_dθ=-2.916751e-02 ||∇||=7.311109e+00 | Tr=0.8171] 50%|█████     | 10/20 [00:30<00:22,  2.28s/it, CE=6.423683e-01 H=6.031698e-01 dV_dx=9.551176e-06 dV_dθ=-3.920803e-02 ||∇||=8.269383e+00 | Tr=0.8171] 55%|█████▌    | 11/20 [00:30<00:19,  2.18s/it, CE=6.423683e-01 H=6.031698e-01 dV_dx=9.551176e-06 dV_dθ=-3.920803e-02 ||∇||=8.269383e+00 | Tr=0.8171] 55%|█████▌    | 11/20 [00:32<00:19,  2.18s/it, CE=6.391714e-01 H=5.931630e-01 dV_dx=6.943451e-05 dV_dθ=-4.607783e-02 ||∇||=8.544451e+00 | Tr=0.8171] 60%|██████    | 12/20 [00:32<00:18,  2.31s/it, CE=6.391714e-01 H=5.931630e-01 dV_dx=6.943451e-05 dV_dθ=-4.607783e-02 ||∇||=8.544451e+00 | Tr=0.8171] 60%|██████    | 12/20 [00:34<00:18,  2.31s/it, CE=6.234755e-01 H=5.837221e-01 dV_dx=1.705786e-05 dV_dθ=-3.977050e-02 ||∇||=8.001269e+00 | Tr=0.8171] 65%|██████▌   | 13/20 [00:34<00:14,  2.13s/it, CE=6.234755e-01 H=5.837221e-01 dV_dx=1.705786e-05 dV_dθ=-3.977050e-02 ||∇||=8.001269e+00 | Tr=0.8171] 65%|██████▌   | 13/20 [00:37<00:14,  2.13s/it, CE=6.021910e-01 H=5.684804e-01 dV_dx=-8.979619e-06 dV_dθ=-3.370159e-02 ||∇||=7.397801e+00 | Tr=0.8171] 70%|███████   | 14/20 [00:37<00:13,  2.23s/it, CE=6.021910e-01 H=5.684804e-01 dV_dx=-8.979619e-06 dV_dθ=-3.370159e-02 ||∇||=7.397801e+00 | Tr=0.8171] 70%|███████   | 14/20 [00:39<00:13,  2.23s/it, CE=5.925643e-01 H=5.569086e-01 dV_dx=-1.148603e-04 dV_dθ=-3.554082e-02 ||∇||=7.666283e+00 | Tr=0.8171] 75%|███████▌  | 15/20 [00:39<00:11,  2.30s/it, CE=5.925643e-01 H=5.569086e-01 dV_dx=-1.148603e-04 dV_dθ=-3.554082e-02 ||∇||=7.666283e+00 | Tr=0.8171] 75%|███████▌  | 15/20 [00:41<00:11,  2.30s/it, CE=5.906531e-01 H=5.436434e-01 dV_dx=-2.422010e-07 dV_dθ=-4.700940e-02 ||∇||=8.520156e+00 | Tr=0.8171] 80%|████████  | 16/20 [00:41<00:08,  2.21s/it, CE=5.906531e-01 H=5.436434e-01 dV_dx=-2.422010e-07 dV_dθ=-4.700940e-02 ||∇||=8.520156e+00 | Tr=0.8171] 80%|████████  | 16/20 [00:43<00:08,  2.21s/it, CE=5.752177e-01 H=5.486520e-01 dV_dx=-1.881916e-06 dV_dθ=-2.656385e-02 ||∇||=6.949713e+00 | Tr=0.8171] 85%|████████▌ | 17/20 [00:43<00:06,  2.25s/it, CE=5.752177e-01 H=5.486520e-01 dV_dx=-1.881916e-06 dV_dθ=-2.656385e-02 ||∇||=6.949713e+00 | Tr=0.8171] 85%|████████▌ | 17/20 [00:46<00:06,  2.25s/it, CE=5.568232e-01 H=5.376016e-01 dV_dx=3.812182e-05 dV_dθ=-1.925972e-02 ||∇||=6.206184e+00 | Tr=0.8171]  90%|█████████ | 18/20 [00:46<00:04,  2.31s/it, CE=5.568232e-01 H=5.376016e-01 dV_dx=3.812182e-05 dV_dθ=-1.925972e-02 ||∇||=6.206184e+00 | Tr=0.8171] 90%|█████████ | 18/20 [00:48<00:04,  2.31s/it, CE=5.422042e-01 H=5.244666e-01 dV_dx=-8.070934e-06 dV_dθ=-1.772955e-02 ||∇||=6.006840e+00 | Tr=0.8171] 95%|█████████▌| 19/20 [00:48<00:02,  2.13s/it, CE=5.422042e-01 H=5.244666e-01 dV_dx=-8.070934e-06 dV_dθ=-1.772955e-02 ||∇||=6.006840e+00 | Tr=0.8171] 95%|█████████▌| 19/20 [00:51<00:02,  2.13s/it, CE=5.305427e-01 H=5.144495e-01 dV_dx=-3.098351e-05 dV_dθ=-1.606223e-02 ||∇||=5.872624e+00 | Tr=0.8171 Te/Cur=0.9448 Te/Exp=0.7896]100%|██████████| 20/20 [00:55<00:00,  3.88s/it, CE=5.305427e-01 H=5.144495e-01 dV_dx=-3.098351e-05 dV_dθ=-1.606223e-02 ||∇||=5.872624e+00 | Tr=0.8171 Te/Cur=0.9448 Te/Exp=0.7896]100%|██████████| 20/20 [00:55<00:00,  2.80s/it, CE=5.305427e-01 H=5.144495e-01 dV_dx=-3.098351e-05 dV_dθ=-1.606223e-02 ||∇||=5.872624e+00 | Tr=0.8171 Te/Cur=0.9448 Te/Exp=0.7896]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.85s/it] 50%|█████     | 1/2 [00:12<00:08,  8.85s/it, CE=5.665866e-01 H=5.659843e-01 dV_dx=7.189012e-05 dV_dθ=-6.742034e-04 ||∇||=1.366346e+00 | Tr=0.9727 Te/Cur=0.9549 Te/Exp=0.8021]100%|██████████| 2/2 [00:12<00:00,  5.95s/it, CE=5.665866e-01 H=5.659843e-01 dV_dx=7.189012e-05 dV_dθ=-6.742034e-04 ||∇||=1.366346e+00 | Tr=0.9727 Te/Cur=0.9549 Te/Exp=0.8021]100%|██████████| 2/2 [00:12<00:00,  6.38s/it, CE=5.665866e-01 H=5.659843e-01 dV_dx=7.189012e-05 dV_dθ=-6.742034e-04 ||∇||=1.366346e+00 | Tr=0.9727 Te/Cur=0.9549 Te/Exp=0.8021]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:13, 10.18s/it]  5%|▌         | 1/20 [00:12<03:13, 10.18s/it, CE=5.541844e-01 H=5.537928e-01 dV_dx=-2.493365e-05 dV_dθ=-3.666038e-04 ||∇||=1.308318e+00 | Tr=0.9754] 10%|█         | 2/20 [00:12<01:37,  5.42s/it, CE=5.541844e-01 H=5.537928e-01 dV_dx=-2.493365e-05 dV_dθ=-3.666038e-04 ||∇||=1.308318e+00 | Tr=0.9754] 10%|█         | 2/20 [00:14<01:37,  5.42s/it, CE=5.364529e-01 H=5.360216e-01 dV_dx=-1.696784e-05 dV_dθ=-4.143306e-04 ||∇||=1.287656e+00 | Tr=0.9764] 15%|█▌        | 3/20 [00:14<01:03,  3.76s/it, CE=5.364529e-01 H=5.360216e-01 dV_dx=-1.696784e-05 dV_dθ=-4.143306e-04 ||∇||=1.287656e+00 | Tr=0.9764] 15%|█▌        | 3/20 [00:15<01:03,  3.76s/it, CE=5.218114e-01 H=5.214126e-01 dV_dx=1.686672e-05 dV_dθ=-4.157028e-04 ||∇||=1.268559e+00 | Tr=0.9778]  20%|██        | 4/20 [00:15<00:48,  3.01s/it, CE=5.218114e-01 H=5.214126e-01 dV_dx=1.686672e-05 dV_dθ=-4.157028e-04 ||∇||=1.268559e+00 | Tr=0.9778] 20%|██        | 4/20 [00:17<00:48,  3.01s/it, CE=5.091030e-01 H=5.087025e-01 dV_dx=3.476010e-05 dV_dθ=-4.352664e-04 ||∇||=1.253438e+00 | Tr=0.9790] 25%|██▌       | 5/20 [00:17<00:37,  2.52s/it, CE=5.091030e-01 H=5.087025e-01 dV_dx=3.476010e-05 dV_dθ=-4.352664e-04 ||∇||=1.253438e+00 | Tr=0.9790] 25%|██▌       | 5/20 [00:20<00:37,  2.52s/it, CE=4.982472e-01 H=4.976681e-01 dV_dx=-8.776912e-05 dV_dθ=-4.913419e-04 ||∇||=1.258737e+00 | Tr=0.9797 Te/Cur=0.9606 Te/Exp=0.8098] 30%|███       | 6/20 [00:20<00:36,  2.62s/it, CE=4.982472e-01 H=4.976681e-01 dV_dx=-8.776912e-05 dV_dθ=-4.913419e-04 ||∇||=1.258737e+00 | Tr=0.9797 Te/Cur=0.9606 Te/Exp=0.8098] 30%|███       | 6/20 [00:22<00:36,  2.62s/it, CE=4.885157e-01 H=4.879777e-01 dV_dx=-3.589734e-05 dV_dθ=-5.020813e-04 ||∇||=1.261748e+00 | Tr=0.9807]                             35%|███▌      | 7/20 [00:22<00:30,  2.37s/it, CE=4.885157e-01 H=4.879777e-01 dV_dx=-3.589734e-05 dV_dθ=-5.020813e-04 ||∇||=1.261748e+00 | Tr=0.9807] 35%|███▌      | 7/20 [00:24<00:30,  2.37s/it, CE=4.796646e-01 H=4.790388e-01 dV_dx=-3.601627e-05 dV_dθ=-5.897659e-04 ||∇||=1.281553e+00 | Tr=0.9815] 40%|████      | 8/20 [00:24<00:26,  2.25s/it, CE=4.796646e-01 H=4.790388e-01 dV_dx=-3.601627e-05 dV_dθ=-5.897659e-04 ||∇||=1.281553e+00 | Tr=0.9815] 40%|████      | 8/20 [00:26<00:26,  2.25s/it, CE=4.715573e-01 H=4.708523e-01 dV_dx=5.092832e-05 dV_dθ=-7.559684e-04 ||∇||=1.321669e+00 | Tr=0.9823]  45%|████▌     | 9/20 [00:26<00:24,  2.27s/it, CE=4.715573e-01 H=4.708523e-01 dV_dx=5.092832e-05 dV_dθ=-7.559684e-04 ||∇||=1.321669e+00 | Tr=0.9823] 45%|████▌     | 9/20 [00:28<00:24,  2.27s/it, CE=4.647698e-01 H=4.636931e-01 dV_dx=1.676875e-06 dV_dθ=-1.078334e-03 ||∇||=1.393668e+00 | Tr=0.9828] 50%|█████     | 10/20 [00:28<00:21,  2.18s/it, CE=4.647698e-01 H=4.636931e-01 dV_dx=1.676875e-06 dV_dθ=-1.078334e-03 ||∇||=1.393668e+00 | Tr=0.9828] 50%|█████     | 10/20 [00:31<00:21,  2.18s/it, CE=4.577903e-01 H=4.567254e-01 dV_dx=1.388236e-04 dV_dθ=-1.203789e-03 ||∇||=1.421268e+00 | Tr=0.9835 Te/Cur=0.9583 Te/Exp=0.8188] 55%|█████▌    | 11/20 [00:31<00:22,  2.46s/it, CE=4.577903e-01 H=4.567254e-01 dV_dx=1.388236e-04 dV_dθ=-1.203789e-03 ||∇||=1.421268e+00 | Tr=0.9835 Te/Cur=0.9583 Te/Exp=0.8188] 55%|█████▌    | 11/20 [00:33<00:22,  2.46s/it, CE=4.518377e-01 H=4.504876e-01 dV_dx=5.907897e-05 dV_dθ=-1.409124e-03 ||∇||=1.478799e+00 | Tr=0.9842]                             60%|██████    | 12/20 [00:33<00:18,  2.28s/it, CE=4.518377e-01 H=4.504876e-01 dV_dx=5.907897e-05 dV_dθ=-1.409124e-03 ||∇||=1.478799e+00 | Tr=0.9842] 60%|██████    | 12/20 [00:35<00:18,  2.28s/it, CE=4.481777e-01 H=4.462589e-01 dV_dx=-5.811279e-05 dV_dθ=-1.860750e-03 ||∇||=1.591803e+00 | Tr=0.9842] 65%|██████▌   | 13/20 [00:35<00:14,  2.06s/it, CE=4.481777e-01 H=4.462589e-01 dV_dx=-5.811279e-05 dV_dθ=-1.860750e-03 ||∇||=1.591803e+00 | Tr=0.9842] 65%|██████▌   | 13/20 [00:36<00:14,  2.06s/it, CE=4.445175e-01 H=4.421694e-01 dV_dx=-2.534241e-05 dV_dθ=-2.322737e-03 ||∇||=1.680442e+00 | Tr=0.9844] 70%|███████   | 14/20 [00:36<00:11,  1.94s/it, CE=4.445175e-01 H=4.421694e-01 dV_dx=-2.534241e-05 dV_dθ=-2.322737e-03 ||∇||=1.680442e+00 | Tr=0.9844] 70%|███████   | 14/20 [00:38<00:11,  1.94s/it, CE=4.380476e-01 H=4.359600e-01 dV_dx=1.636337e-05 dV_dθ=-2.104010e-03 ||∇||=1.633523e+00 | Tr=0.9845]  75%|███████▌  | 15/20 [00:38<00:09,  1.88s/it, CE=4.380476e-01 H=4.359600e-01 dV_dx=1.636337e-05 dV_dθ=-2.104010e-03 ||∇||=1.633523e+00 | Tr=0.9845] 75%|███████▌  | 15/20 [00:41<00:09,  1.88s/it, CE=4.297359e-01 H=4.281732e-01 dV_dx=-5.111670e-05 dV_dθ=-1.511611e-03 ||∇||=1.490229e+00 | Tr=0.9855 Te/Cur=0.9646 Te/Exp=0.8201] 80%|████████  | 16/20 [00:41<00:09,  2.32s/it, CE=4.297359e-01 H=4.281732e-01 dV_dx=-5.111670e-05 dV_dθ=-1.511611e-03 ||∇||=1.490229e+00 | Tr=0.9855 Te/Cur=0.9646 Te/Exp=0.8201] 80%|████████  | 16/20 [00:43<00:09,  2.32s/it, CE=4.209311e-01 H=4.201721e-01 dV_dx=1.041442e-04 dV_dθ=-8.632170e-04 ||∇||=1.318375e+00 | Tr=0.9866]                              85%|████████▌ | 17/20 [00:43<00:06,  2.12s/it, CE=4.209311e-01 H=4.201721e-01 dV_dx=1.041442e-04 dV_dθ=-8.632170e-04 ||∇||=1.318375e+00 | Tr=0.9866] 85%|████████▌ | 17/20 [00:45<00:06,  2.12s/it, CE=4.138077e-01 H=4.132934e-01 dV_dx=1.553691e-05 dV_dθ=-5.298352e-04 ||∇||=1.205383e+00 | Tr=0.9873] 90%|█████████ | 18/20 [00:45<00:04,  2.11s/it, CE=4.138077e-01 H=4.132934e-01 dV_dx=1.553691e-05 dV_dθ=-5.298352e-04 ||∇||=1.205383e+00 | Tr=0.9873] 90%|█████████ | 18/20 [00:47<00:04,  2.11s/it, CE=4.074859e-01 H=4.070982e-01 dV_dx=-2.374680e-05 dV_dθ=-3.639333e-04 ||∇||=1.140447e+00 | Tr=0.9879] 95%|█████████▌| 19/20 [00:47<00:02,  2.05s/it, CE=4.074859e-01 H=4.070982e-01 dV_dx=-2.374680e-05 dV_dθ=-3.639333e-04 ||∇||=1.140447e+00 | Tr=0.9879] 95%|█████████▌| 19/20 [00:51<00:02,  2.05s/it, CE=4.020244e-01 H=4.018212e-01 dV_dx=6.237436e-05 dV_dθ=-2.655751e-04 ||∇||=1.098926e+00 | Tr=0.9885 Te/Cur=0.9675 Te/Exp=0.8210]100%|██████████| 20/20 [00:51<00:00,  2.76s/it, CE=4.020244e-01 H=4.018212e-01 dV_dx=6.237436e-05 dV_dθ=-2.655751e-04 ||∇||=1.098926e+00 | Tr=0.9885 Te/Cur=0.9675 Te/Exp=0.8210]100%|██████████| 20/20 [00:51<00:00,  2.59s/it, CE=4.020244e-01 H=4.018212e-01 dV_dx=6.237436e-05 dV_dθ=-2.655751e-04 ||∇||=1.098926e+00 | Tr=0.9885 Te/Cur=0.9675 Te/Exp=0.8210]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 7 final loss: 0.415880
======================================================================


  Evaluating on all tasks 0..7 for CL metrics...
    Task 0: 0.7390
    Task 1: 0.9193
    Task 2: 0.8028
    Task 3: 0.5784
    Task 4: 0.9106
    Task 5: 0.9028
    Task 6: 0.9045
    Task 7: 0.9676

============================================================
Task 8
============================================================
Initial loss on new task: 5.3390, previous: 0.4020, ratio: 13.28
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 8
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:07<?, ?it/s, CE=5.708231e-01 H=5.635461e-01 dV_dx=-7.061721e-05 dV_dθ=-7.206329e-03 ||∇||=3.825706e+00 | Tr=0.6562 Te/Cur=0.8089 Te/Exp=0.8145]100%|██████████| 1/1 [00:07<00:00,  7.84s/it, CE=5.708231e-01 H=5.635461e-01 dV_dx=-7.061721e-05 dV_dθ=-7.206329e-03 ||∇||=3.825706e+00 | Tr=0.6562 Te/Cur=0.8089 Te/Exp=0.8145]100%|██████████| 1/1 [00:07<00:00,  7.84s/it, CE=5.708231e-01 H=5.635461e-01 dV_dx=-7.061721e-05 dV_dθ=-7.206329e-03 ||∇||=3.825706e+00 | Tr=0.6562 Te/Cur=0.8089 Te/Exp=0.8145]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.570823

[STEP 2] Architecture change decision
  Current: 0.570823, Previous: 0.402024
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9416 samples from 10 classes
  Created balanced validation set: 39933 samples from 10 classes
  Starting grid architecture search for task 8
  Baseline architecture: (2, [507, 652, 164, 10])
  Baseline loss: 0.570823
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.84s/it] 50%|█████     | 1/2 [00:04<00:02,  2.84s/it, CE=2.246285e+00 H=2.246209e+00 dV_dx=-2.118874e-06 dV_dθ=-7.469416e-05 ||∇||=4.860982e-01 | Tr=0.1660 Te/Cur=0.1610 Te/Exp=0.2417]100%|██████████| 2/2 [00:04<00:00,  2.09s/it, CE=2.246285e+00 H=2.246209e+00 dV_dx=-2.118874e-06 dV_dθ=-7.469416e-05 ||∇||=4.860982e-01 | Tr=0.1660 Te/Cur=0.1610 Te/Exp=0.2417]100%|██████████| 2/2 [00:04<00:00,  2.21s/it, CE=2.246285e+00 H=2.246209e+00 dV_dx=-2.118874e-06 dV_dθ=-7.469416e-05 ||∇||=4.860982e-01 | Tr=0.1660 Te/Cur=0.1610 Te/Exp=0.2417]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2462853401923146
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.23s/it] 50%|█████     | 1/2 [00:06<00:05,  5.23s/it, CE=2.256903e+00 H=2.256860e+00 dV_dx=4.030099e-06 dV_dθ=-4.733218e-05 ||∇||=4.298710e-01 | Tr=0.1077 Te/Cur=0.1288 Te/Exp=0.2430]100%|██████████| 2/2 [00:06<00:00,  3.02s/it, CE=2.256903e+00 H=2.256860e+00 dV_dx=4.030099e-06 dV_dθ=-4.733218e-05 ||∇||=4.298710e-01 | Tr=0.1077 Te/Cur=0.1288 Te/Exp=0.2430]100%|██████████| 2/2 [00:06<00:00,  3.35s/it, CE=2.256903e+00 H=2.256860e+00 dV_dx=4.030099e-06 dV_dθ=-4.733218e-05 ||∇||=4.298710e-01 | Tr=0.1077 Te/Cur=0.1288 Te/Exp=0.2430]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.92s/it] 50%|█████     | 1/2 [00:06<00:04,  4.92s/it, CE=2.267360e+00 H=2.267278e+00 dV_dx=1.830824e-06 dV_dθ=-8.476091e-05 ||∇||=4.521183e-01 | Tr=0.1058 Te/Cur=0.1043 Te/Exp=0.2373]100%|██████████| 2/2 [00:06<00:00,  2.86s/it, CE=2.267360e+00 H=2.267278e+00 dV_dx=1.830824e-06 dV_dθ=-8.476091e-05 ||∇||=4.521183e-01 | Tr=0.1058 Te/Cur=0.1043 Te/Exp=0.2373]100%|██████████| 2/2 [00:06<00:00,  3.17s/it, CE=2.267360e+00 H=2.267278e+00 dV_dx=1.830824e-06 dV_dθ=-8.476091e-05 ||∇||=4.521183e-01 | Tr=0.1058 Te/Cur=0.1043 Te/Exp=0.2373]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.98s/it] 50%|█████     | 1/2 [00:04<00:02,  2.98s/it, CE=2.264334e+00 H=2.264233e+00 dV_dx=2.576480e-06 dV_dθ=-1.033741e-04 ||∇||=4.639812e-01 | Tr=0.1404 Te/Cur=0.1359 Te/Exp=0.2504]100%|██████████| 2/2 [00:04<00:00,  2.09s/it, CE=2.264334e+00 H=2.264233e+00 dV_dx=2.576480e-06 dV_dθ=-1.033741e-04 ||∇||=4.639812e-01 | Tr=0.1404 Te/Cur=0.1359 Te/Exp=0.2504]100%|██████████| 2/2 [00:04<00:00,  2.23s/it, CE=2.264334e+00 H=2.264233e+00 dV_dx=2.576480e-06 dV_dθ=-1.033741e-04 ||∇||=4.639812e-01 | Tr=0.1404 Te/Cur=0.1359 Te/Exp=0.2504]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.11s/it] 50%|█████     | 1/2 [00:05<00:03,  3.11s/it, CE=2.248876e+00 H=2.248807e+00 dV_dx=3.540162e-06 dV_dθ=-7.319344e-05 ||∇||=4.644878e-01 | Tr=0.1068 Te/Cur=0.1554 Te/Exp=0.2692]100%|██████████| 2/2 [00:05<00:00,  2.40s/it, CE=2.248876e+00 H=2.248807e+00 dV_dx=3.540162e-06 dV_dθ=-7.319344e-05 ||∇||=4.644878e-01 | Tr=0.1068 Te/Cur=0.1554 Te/Exp=0.2692]100%|██████████| 2/2 [00:05<00:00,  2.51s/it, CE=2.248876e+00 H=2.248807e+00 dV_dx=3.540162e-06 dV_dθ=-7.319344e-05 ||∇||=4.644878e-01 | Tr=0.1068 Te/Cur=0.1554 Te/Exp=0.2692]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.61s/it] 50%|█████     | 1/2 [00:13<00:10, 10.61s/it, CE=2.249330e+00 H=2.249264e+00 dV_dx=-9.418519e-06 dV_dθ=-5.667653e-05 ||∇||=4.720328e-01 | Tr=0.1192 Te/Cur=0.1320 Te/Exp=0.2414]100%|██████████| 2/2 [00:13<00:00,  6.03s/it, CE=2.249330e+00 H=2.249264e+00 dV_dx=-9.418519e-06 dV_dθ=-5.667653e-05 ||∇||=4.720328e-01 | Tr=0.1192 Te/Cur=0.1320 Te/Exp=0.2414]100%|██████████| 2/2 [00:13<00:00,  6.72s/it, CE=2.249330e+00 H=2.249264e+00 dV_dx=-9.418519e-06 dV_dθ=-5.667653e-05 ||∇||=4.720328e-01 | Tr=0.1192 Te/Cur=0.1320 Te/Exp=0.2414]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.62s/it] 50%|█████     | 1/2 [00:07<00:05,  5.62s/it, CE=2.258845e+00 H=2.258779e+00 dV_dx=-1.187118e-06 dV_dθ=-6.562349e-05 ||∇||=4.717630e-01 | Tr=0.1002 Te/Cur=0.1618 Te/Exp=0.2067]100%|██████████| 2/2 [00:07<00:00,  3.26s/it, CE=2.258845e+00 H=2.258779e+00 dV_dx=-1.187118e-06 dV_dθ=-6.562349e-05 ||∇||=4.717630e-01 | Tr=0.1002 Te/Cur=0.1618 Te/Exp=0.2067]100%|██████████| 2/2 [00:07<00:00,  3.62s/it, CE=2.258845e+00 H=2.258779e+00 dV_dx=-1.187118e-06 dV_dθ=-6.562349e-05 ||∇||=4.717630e-01 | Tr=0.1002 Te/Cur=0.1618 Te/Exp=0.2067]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.53s/it] 50%|█████     | 1/2 [00:11<00:09,  9.53s/it, CE=2.277842e+00 H=2.277696e+00 dV_dx=7.757372e-06 dV_dθ=-1.529023e-04 ||∇||=5.177808e-01 | Tr=0.1352 Te/Cur=0.1516 Te/Exp=0.2000]100%|██████████| 2/2 [00:11<00:00,  4.97s/it, CE=2.277842e+00 H=2.277696e+00 dV_dx=7.757372e-06 dV_dθ=-1.529023e-04 ||∇||=5.177808e-01 | Tr=0.1352 Te/Cur=0.1516 Te/Exp=0.2000]100%|██████████| 2/2 [00:11<00:00,  5.65s/it, CE=2.277842e+00 H=2.277696e+00 dV_dx=7.757372e-06 dV_dθ=-1.529023e-04 ||∇||=5.177808e-01 | Tr=0.1352 Te/Cur=0.1516 Te/Exp=0.2000]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.40s/it] 50%|█████     | 1/2 [00:07<00:05,  5.40s/it, CE=2.249667e+00 H=2.249606e+00 dV_dx=3.500313e-06 dV_dθ=-6.413630e-05 ||∇||=4.683863e-01 | Tr=0.0999 Te/Cur=0.1382 Te/Exp=0.2646]100%|██████████| 2/2 [00:07<00:00,  3.20s/it, CE=2.249667e+00 H=2.249606e+00 dV_dx=3.500313e-06 dV_dθ=-6.413630e-05 ||∇||=4.683863e-01 | Tr=0.0999 Te/Cur=0.1382 Te/Exp=0.2646]100%|██████████| 2/2 [00:07<00:00,  3.53s/it, CE=2.249667e+00 H=2.249606e+00 dV_dx=3.500313e-06 dV_dθ=-6.413630e-05 ||∇||=4.683863e-01 | Tr=0.0999 Te/Cur=0.1382 Te/Exp=0.2646]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.96s/it] 50%|█████     | 1/2 [00:04<00:02,  2.96s/it, CE=2.256580e+00 H=2.256520e+00 dV_dx=9.362256e-07 dV_dθ=-6.134473e-05 ||∇||=3.875709e-01 | Tr=0.1364 Te/Cur=0.1427 Te/Exp=0.2471]100%|██████████| 2/2 [00:04<00:00,  2.31s/it, CE=2.256580e+00 H=2.256520e+00 dV_dx=9.362256e-07 dV_dθ=-6.134473e-05 ||∇||=3.875709e-01 | Tr=0.1364 Te/Cur=0.1427 Te/Exp=0.2471]100%|██████████| 2/2 [00:04<00:00,  2.41s/it, CE=2.256580e+00 H=2.256520e+00 dV_dx=9.362256e-07 dV_dθ=-6.134473e-05 ||∇||=3.875709e-01 | Tr=0.1364 Te/Cur=0.1427 Te/Exp=0.2471]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.49s/it] 50%|█████     | 1/2 [00:08<00:06,  6.49s/it, CE=2.261901e+00 H=2.261860e+00 dV_dx=6.031766e-07 dV_dθ=-4.171563e-05 ||∇||=3.741924e-01 | Tr=0.1034 Te/Cur=0.1133 Te/Exp=0.2586]100%|██████████| 2/2 [00:08<00:00,  3.69s/it, CE=2.261901e+00 H=2.261860e+00 dV_dx=6.031766e-07 dV_dθ=-4.171563e-05 ||∇||=3.741924e-01 | Tr=0.1034 Te/Cur=0.1133 Te/Exp=0.2586]100%|██████████| 2/2 [00:08<00:00,  4.11s/it, CE=2.261901e+00 H=2.261860e+00 dV_dx=6.031766e-07 dV_dθ=-4.171563e-05 ||∇||=3.741924e-01 | Tr=0.1034 Te/Cur=0.1133 Te/Exp=0.2586]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.84s/it] 50%|█████     | 1/2 [00:06<00:04,  4.84s/it, CE=2.276790e+00 H=2.276728e+00 dV_dx=-7.906658e-06 dV_dθ=-5.453590e-05 ||∇||=3.612262e-01 | Tr=0.1265 Te/Cur=0.1469 Te/Exp=0.2043]100%|██████████| 2/2 [00:06<00:00,  3.04s/it, CE=2.276790e+00 H=2.276728e+00 dV_dx=-7.906658e-06 dV_dθ=-5.453590e-05 ||∇||=3.612262e-01 | Tr=0.1265 Te/Cur=0.1469 Te/Exp=0.2043]100%|██████████| 2/2 [00:06<00:00,  3.31s/it, CE=2.276790e+00 H=2.276728e+00 dV_dx=-7.906658e-06 dV_dθ=-5.453590e-05 ||∇||=3.612262e-01 | Tr=0.1265 Te/Cur=0.1469 Te/Exp=0.2043]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.22s/it] 50%|█████     | 1/2 [00:04<00:03,  3.22s/it, CE=2.274969e+00 H=2.274901e+00 dV_dx=-4.196509e-06 dV_dθ=-6.293807e-05 ||∇||=4.033429e-01 | Tr=0.1605 Te/Cur=0.1697 Te/Exp=0.1674]100%|██████████| 2/2 [00:04<00:00,  2.21s/it, CE=2.274969e+00 H=2.274901e+00 dV_dx=-4.196509e-06 dV_dθ=-6.293807e-05 ||∇||=4.033429e-01 | Tr=0.1605 Te/Cur=0.1697 Te/Exp=0.1674]100%|██████████| 2/2 [00:04<00:00,  2.37s/it, CE=2.274969e+00 H=2.274901e+00 dV_dx=-4.196509e-06 dV_dθ=-6.293807e-05 ||∇||=4.033429e-01 | Tr=0.1605 Te/Cur=0.1697 Te/Exp=0.1674]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.11s/it] 50%|█████     | 1/2 [00:04<00:03,  3.11s/it, CE=2.266024e+00 H=2.265954e+00 dV_dx=-6.140414e-06 dV_dθ=-6.457999e-05 ||∇||=3.989530e-01 | Tr=0.1332 Te/Cur=0.1585 Te/Exp=0.2595]100%|██████████| 2/2 [00:04<00:00,  2.21s/it, CE=2.266024e+00 H=2.265954e+00 dV_dx=-6.140414e-06 dV_dθ=-6.457999e-05 ||∇||=3.989530e-01 | Tr=0.1332 Te/Cur=0.1585 Te/Exp=0.2595]100%|██████████| 2/2 [00:04<00:00,  2.34s/it, CE=2.266024e+00 H=2.265954e+00 dV_dx=-6.140414e-06 dV_dθ=-6.457999e-05 ||∇||=3.989530e-01 | Tr=0.1332 Te/Cur=0.1585 Te/Exp=0.2595]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.46s/it] 50%|█████     | 1/2 [00:10<00:08,  8.46s/it, CE=2.257082e+00 H=2.257053e+00 dV_dx=-2.192156e-08 dV_dθ=-2.823873e-05 ||∇||=3.584233e-01 | Tr=0.1427 Te/Cur=0.1534 Te/Exp=0.2387]100%|██████████| 2/2 [00:10<00:00,  4.85s/it, CE=2.257082e+00 H=2.257053e+00 dV_dx=-2.192156e-08 dV_dθ=-2.823873e-05 ||∇||=3.584233e-01 | Tr=0.1427 Te/Cur=0.1534 Te/Exp=0.2387]100%|██████████| 2/2 [00:10<00:00,  5.39s/it, CE=2.257082e+00 H=2.257053e+00 dV_dx=-2.192156e-08 dV_dθ=-2.823873e-05 ||∇||=3.584233e-01 | Tr=0.1427 Te/Cur=0.1534 Te/Exp=0.2387]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.31s/it] 50%|█████     | 1/2 [00:08<00:06,  6.31s/it, CE=2.261394e+00 H=2.261322e+00 dV_dx=-9.440555e-06 dV_dθ=-6.233878e-05 ||∇||=3.660258e-01 | Tr=0.1336 Te/Cur=0.1616 Te/Exp=0.2605]100%|██████████| 2/2 [00:08<00:00,  3.95s/it, CE=2.261394e+00 H=2.261322e+00 dV_dx=-9.440555e-06 dV_dθ=-6.233878e-05 ||∇||=3.660258e-01 | Tr=0.1336 Te/Cur=0.1616 Te/Exp=0.2605]100%|██████████| 2/2 [00:08<00:00,  4.30s/it, CE=2.261394e+00 H=2.261322e+00 dV_dx=-9.440555e-06 dV_dθ=-6.233878e-05 ||∇||=3.660258e-01 | Tr=0.1336 Te/Cur=0.1616 Te/Exp=0.2605]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.94s/it] 50%|█████     | 1/2 [00:11<00:09,  9.94s/it, CE=2.274212e+00 H=2.274128e+00 dV_dx=-1.095299e-05 dV_dθ=-7.269880e-05 ||∇||=3.859513e-01 | Tr=0.1303 Te/Cur=0.1501 Te/Exp=0.2341]100%|██████████| 2/2 [00:11<00:00,  5.16s/it, CE=2.274212e+00 H=2.274128e+00 dV_dx=-1.095299e-05 dV_dθ=-7.269880e-05 ||∇||=3.859513e-01 | Tr=0.1303 Te/Cur=0.1501 Te/Exp=0.2341]100%|██████████| 2/2 [00:11<00:00,  5.88s/it, CE=2.274212e+00 H=2.274128e+00 dV_dx=-1.095299e-05 dV_dθ=-7.269880e-05 ||∇||=3.859513e-01 | Tr=0.1303 Te/Cur=0.1501 Te/Exp=0.2341]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.74s/it] 50%|█████     | 1/2 [00:07<00:05,  5.74s/it, CE=2.259616e+00 H=2.259539e+00 dV_dx=3.479885e-06 dV_dθ=-8.014326e-05 ||∇||=4.153624e-01 | Tr=0.1366 Te/Cur=0.1488 Te/Exp=0.2671]100%|██████████| 2/2 [00:07<00:00,  3.43s/it, CE=2.259616e+00 H=2.259539e+00 dV_dx=3.479885e-06 dV_dθ=-8.014326e-05 ||∇||=4.153624e-01 | Tr=0.1366 Te/Cur=0.1488 Te/Exp=0.2671]100%|██████████| 2/2 [00:07<00:00,  3.78s/it, CE=2.259616e+00 H=2.259539e+00 dV_dx=3.479885e-06 dV_dθ=-8.014326e-05 ||∇||=4.153624e-01 | Tr=0.1366 Te/Cur=0.1488 Te/Exp=0.2671]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.85s/it] 50%|█████     | 1/2 [00:08<00:03,  3.85s/it, CE=2.280052e+00 H=2.279969e+00 dV_dx=-1.439351e-06 dV_dθ=-8.184222e-05 ||∇||=3.788087e-01 | Tr=0.1201 Te/Cur=0.1144 Te/Exp=0.1870]100%|██████████| 2/2 [00:08<00:00,  4.33s/it, CE=2.280052e+00 H=2.279969e+00 dV_dx=-1.439351e-06 dV_dθ=-8.184222e-05 ||∇||=3.788087e-01 | Tr=0.1201 Te/Cur=0.1144 Te/Exp=0.1870]100%|██████████| 2/2 [00:08<00:00,  4.26s/it, CE=2.280052e+00 H=2.279969e+00 dV_dx=-1.439351e-06 dV_dθ=-8.184222e-05 ||∇||=3.788087e-01 | Tr=0.1201 Te/Cur=0.1144 Te/Exp=0.1870]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.34s/it] 50%|█████     | 1/2 [00:05<00:03,  3.34s/it, CE=2.278027e+00 H=2.277954e+00 dV_dx=2.740674e-06 dV_dθ=-7.529745e-05 ||∇||=3.486368e-01 | Tr=0.1268 Te/Cur=0.1255 Te/Exp=0.1951]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.278027e+00 H=2.277954e+00 dV_dx=2.740674e-06 dV_dθ=-7.529745e-05 ||∇||=3.486368e-01 | Tr=0.1268 Te/Cur=0.1255 Te/Exp=0.1951]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.278027e+00 H=2.277954e+00 dV_dx=2.740674e-06 dV_dθ=-7.529745e-05 ||∇||=3.486368e-01 | Tr=0.1268 Te/Cur=0.1255 Te/Exp=0.1951]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.11s/it] 50%|█████     | 1/2 [00:07<00:05,  5.11s/it, CE=2.292062e+00 H=2.292000e+00 dV_dx=1.163411e-06 dV_dθ=-6.378729e-05 ||∇||=3.724355e-01 | Tr=0.1062 Te/Cur=0.1194 Te/Exp=0.1719]100%|██████████| 2/2 [00:07<00:00,  3.33s/it, CE=2.292062e+00 H=2.292000e+00 dV_dx=1.163411e-06 dV_dθ=-6.378729e-05 ||∇||=3.724355e-01 | Tr=0.1062 Te/Cur=0.1194 Te/Exp=0.1719]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.292062e+00 H=2.292000e+00 dV_dx=1.163411e-06 dV_dθ=-6.378729e-05 ||∇||=3.724355e-01 | Tr=0.1062 Te/Cur=0.1194 Te/Exp=0.1719]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.34s/it] 50%|█████     | 1/2 [00:05<00:03,  3.34s/it, CE=2.284330e+00 H=2.284244e+00 dV_dx=-1.968382e-06 dV_dθ=-8.374832e-05 ||∇||=3.623850e-01 | Tr=0.0861 Te/Cur=0.1020 Te/Exp=0.1612]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.284330e+00 H=2.284244e+00 dV_dx=-1.968382e-06 dV_dθ=-8.374832e-05 ||∇||=3.623850e-01 | Tr=0.0861 Te/Cur=0.1020 Te/Exp=0.1612]100%|██████████| 2/2 [00:05<00:00,  2.70s/it, CE=2.284330e+00 H=2.284244e+00 dV_dx=-1.968382e-06 dV_dθ=-8.374832e-05 ||∇||=3.623850e-01 | Tr=0.0861 Te/Cur=0.1020 Te/Exp=0.1612]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.48s/it] 50%|█████     | 1/2 [00:05<00:03,  3.48s/it, CE=2.279575e+00 H=2.279477e+00 dV_dx=4.271883e-06 dV_dθ=-1.019885e-04 ||∇||=3.802978e-01 | Tr=0.1374 Te/Cur=0.1354 Te/Exp=0.2116]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.279575e+00 H=2.279477e+00 dV_dx=4.271883e-06 dV_dθ=-1.019885e-04 ||∇||=3.802978e-01 | Tr=0.1374 Te/Cur=0.1354 Te/Exp=0.2116]100%|██████████| 2/2 [00:05<00:00,  2.80s/it, CE=2.279575e+00 H=2.279477e+00 dV_dx=4.271883e-06 dV_dθ=-1.019885e-04 ||∇||=3.802978e-01 | Tr=0.1374 Te/Cur=0.1354 Te/Exp=0.2116]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.77s/it] 50%|█████     | 1/2 [00:11<00:09,  9.77s/it, CE=2.282198e+00 H=2.282120e+00 dV_dx=-8.432296e-06 dV_dθ=-6.957574e-05 ||∇||=3.463027e-01 | Tr=0.1422 Te/Cur=0.1511 Te/Exp=0.1703]100%|██████████| 2/2 [00:11<00:00,  4.92s/it, CE=2.282198e+00 H=2.282120e+00 dV_dx=-8.432296e-06 dV_dθ=-6.957574e-05 ||∇||=3.463027e-01 | Tr=0.1422 Te/Cur=0.1511 Te/Exp=0.1703]100%|██████████| 2/2 [00:11<00:00,  5.65s/it, CE=2.282198e+00 H=2.282120e+00 dV_dx=-8.432296e-06 dV_dθ=-6.957574e-05 ||∇||=3.463027e-01 | Tr=0.1422 Te/Cur=0.1511 Te/Exp=0.1703]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.99s/it] 50%|█████     | 1/2 [00:07<00:04,  4.99s/it, CE=2.285742e+00 H=2.285667e+00 dV_dx=5.236667e-06 dV_dθ=-8.079648e-05 ||∇||=3.536867e-01 | Tr=0.0731 Te/Cur=0.0793 Te/Exp=0.2039]100%|██████████| 2/2 [00:07<00:00,  3.30s/it, CE=2.285742e+00 H=2.285667e+00 dV_dx=5.236667e-06 dV_dθ=-8.079648e-05 ||∇||=3.536867e-01 | Tr=0.0731 Te/Cur=0.0793 Te/Exp=0.2039]100%|██████████| 2/2 [00:07<00:00,  3.56s/it, CE=2.285742e+00 H=2.285667e+00 dV_dx=5.236667e-06 dV_dθ=-8.079648e-05 ||∇||=3.536867e-01 | Tr=0.0731 Te/Cur=0.0793 Te/Exp=0.2039]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.32s/it] 50%|█████     | 1/2 [00:11<00:09,  9.32s/it, CE=2.288837e+00 H=2.288723e+00 dV_dx=1.845946e-06 dV_dθ=-1.156205e-04 ||∇||=3.837963e-01 | Tr=0.1332 Te/Cur=0.1377 Te/Exp=0.1865]100%|██████████| 2/2 [00:11<00:00,  4.93s/it, CE=2.288837e+00 H=2.288723e+00 dV_dx=1.845946e-06 dV_dθ=-1.156205e-04 ||∇||=3.837963e-01 | Tr=0.1332 Te/Cur=0.1377 Te/Exp=0.1865]100%|██████████| 2/2 [00:11<00:00,  5.59s/it, CE=2.288837e+00 H=2.288723e+00 dV_dx=1.845946e-06 dV_dθ=-1.156205e-04 ||∇||=3.837963e-01 | Tr=0.1332 Te/Cur=0.1377 Te/Exp=0.1865]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.67s/it] 50%|█████     | 1/2 [00:07<00:05,  5.67s/it, CE=2.273619e+00 H=2.273545e+00 dV_dx=1.192779e-06 dV_dθ=-7.559337e-05 ||∇||=3.643067e-01 | Tr=0.1358 Te/Cur=0.1375 Te/Exp=0.2365]100%|██████████| 2/2 [00:07<00:00,  3.41s/it, CE=2.273619e+00 H=2.273545e+00 dV_dx=1.192779e-06 dV_dθ=-7.559337e-05 ||∇||=3.643067e-01 | Tr=0.1358 Te/Cur=0.1375 Te/Exp=0.2365]100%|██████████| 2/2 [00:07<00:00,  3.75s/it, CE=2.273619e+00 H=2.273545e+00 dV_dx=1.192779e-06 dV_dθ=-7.559337e-05 ||∇||=3.643067e-01 | Tr=0.1358 Te/Cur=0.1375 Te/Exp=0.2365]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    No improvement found (patience: 1)
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.46s/it] 50%|█████     | 1/2 [00:08<00:06,  6.46s/it, CE=2.276163e+00 H=2.276133e+00 dV_dx=1.344066e-05 dV_dθ=-4.338698e-05 ||∇||=4.165546e-01 | Tr=0.1562 Te/Cur=0.1761 Te/Exp=0.1828]100%|██████████| 2/2 [00:08<00:00,  3.74s/it, CE=2.276163e+00 H=2.276133e+00 dV_dx=1.344066e-05 dV_dθ=-4.338698e-05 ||∇||=4.165546e-01 | Tr=0.1562 Te/Cur=0.1761 Te/Exp=0.1828]100%|██████████| 2/2 [00:08<00:00,  4.15s/it, CE=2.276163e+00 H=2.276133e+00 dV_dx=1.344066e-05 dV_dθ=-4.338698e-05 ||∇||=4.165546e-01 | Tr=0.1562 Te/Cur=0.1761 Te/Exp=0.1828]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2761626090964366
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.44s/it] 50%|█████     | 1/2 [00:05<00:03,  3.44s/it, CE=2.280011e+00 H=2.279978e+00 dV_dx=-3.462063e-06 dV_dθ=-2.970304e-05 ||∇||=4.224581e-01 | Tr=0.1233 Te/Cur=0.1735 Te/Exp=0.2204]100%|██████████| 2/2 [00:05<00:00,  2.46s/it, CE=2.280011e+00 H=2.279978e+00 dV_dx=-3.462063e-06 dV_dθ=-2.970304e-05 ||∇||=4.224581e-01 | Tr=0.1233 Te/Cur=0.1735 Te/Exp=0.2204]100%|██████████| 2/2 [00:05<00:00,  2.61s/it, CE=2.280011e+00 H=2.279978e+00 dV_dx=-3.462063e-06 dV_dθ=-2.970304e-05 ||∇||=4.224581e-01 | Tr=0.1233 Te/Cur=0.1735 Te/Exp=0.2204]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.39s/it] 50%|█████     | 1/2 [00:05<00:03,  3.39s/it, CE=2.271779e+00 H=2.271733e+00 dV_dx=4.503678e-06 dV_dθ=-4.961556e-05 ||∇||=4.003608e-01 | Tr=0.1876 Te/Cur=0.2252 Te/Exp=0.2089]100%|██████████| 2/2 [00:05<00:00,  2.43s/it, CE=2.271779e+00 H=2.271733e+00 dV_dx=4.503678e-06 dV_dθ=-4.961556e-05 ||∇||=4.003608e-01 | Tr=0.1876 Te/Cur=0.2252 Te/Exp=0.2089]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.271779e+00 H=2.271733e+00 dV_dx=4.503678e-06 dV_dθ=-4.961556e-05 ||∇||=4.003608e-01 | Tr=0.1876 Te/Cur=0.2252 Te/Exp=0.2089]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 692, 124, 10]) with loss 2.271779
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.12s/it] 50%|█████     | 1/2 [00:05<00:03,  3.12s/it, CE=2.264897e+00 H=2.264861e+00 dV_dx=7.972858e-07 dV_dθ=-3.604136e-05 ||∇||=4.348314e-01 | Tr=0.1586 Te/Cur=0.2042 Te/Exp=0.2704]100%|██████████| 2/2 [00:05<00:00,  2.49s/it, CE=2.264897e+00 H=2.264861e+00 dV_dx=7.972858e-07 dV_dθ=-3.604136e-05 ||∇||=4.348314e-01 | Tr=0.1586 Te/Cur=0.2042 Te/Exp=0.2704]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.264897e+00 H=2.264861e+00 dV_dx=7.972858e-07 dV_dθ=-3.604136e-05 ||∇||=4.348314e-01 | Tr=0.1586 Te/Cur=0.2042 Te/Exp=0.2704]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 612, 164, 10]) with loss 2.264897
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.17s/it] 50%|█████     | 1/2 [00:05<00:03,  3.17s/it, CE=2.278115e+00 H=2.278064e+00 dV_dx=-8.563437e-06 dV_dθ=-4.241015e-05 ||∇||=4.276249e-01 | Tr=0.1576 Te/Cur=0.1705 Te/Exp=0.1720]100%|██████████| 2/2 [00:05<00:00,  2.55s/it, CE=2.278115e+00 H=2.278064e+00 dV_dx=-8.563437e-06 dV_dθ=-4.241015e-05 ||∇||=4.276249e-01 | Tr=0.1576 Te/Cur=0.1705 Te/Exp=0.1720]100%|██████████| 2/2 [00:05<00:00,  2.64s/it, CE=2.278115e+00 H=2.278064e+00 dV_dx=-8.563437e-06 dV_dθ=-4.241015e-05 ||∇||=4.276249e-01 | Tr=0.1576 Te/Cur=0.1705 Te/Exp=0.1720]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.69s/it] 50%|█████     | 1/2 [00:05<00:03,  3.69s/it, CE=2.265516e+00 H=2.265466e+00 dV_dx=-5.077570e-06 dV_dθ=-4.465884e-05 ||∇||=4.283824e-01 | Tr=0.1460 Te/Cur=0.1536 Te/Exp=0.1869]100%|██████████| 2/2 [00:05<00:00,  2.58s/it, CE=2.265516e+00 H=2.265466e+00 dV_dx=-5.077570e-06 dV_dθ=-4.465884e-05 ||∇||=4.283824e-01 | Tr=0.1460 Te/Cur=0.1536 Te/Exp=0.1869]100%|██████████| 2/2 [00:05<00:00,  2.75s/it, CE=2.265516e+00 H=2.265466e+00 dV_dx=-5.077570e-06 dV_dθ=-4.465884e-05 ||∇||=4.283824e-01 | Tr=0.1460 Te/Cur=0.1536 Te/Exp=0.1869]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.63s/it] 50%|█████     | 1/2 [00:05<00:03,  3.63s/it, CE=2.275267e+00 H=2.275214e+00 dV_dx=9.635197e-06 dV_dθ=-6.346874e-05 ||∇||=4.725645e-01 | Tr=0.1210 Te/Cur=0.1175 Te/Exp=0.2068]100%|██████████| 2/2 [00:05<00:00,  2.78s/it, CE=2.275267e+00 H=2.275214e+00 dV_dx=9.635197e-06 dV_dθ=-6.346874e-05 ||∇||=4.725645e-01 | Tr=0.1210 Te/Cur=0.1175 Te/Exp=0.2068]100%|██████████| 2/2 [00:05<00:00,  2.91s/it, CE=2.275267e+00 H=2.275214e+00 dV_dx=9.635197e-06 dV_dθ=-6.346874e-05 ||∇||=4.725645e-01 | Tr=0.1210 Te/Cur=0.1175 Te/Exp=0.2068]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.44s/it] 50%|█████     | 1/2 [00:05<00:03,  3.44s/it, CE=2.267187e+00 H=2.267121e+00 dV_dx=-1.535948e-05 dV_dθ=-5.013469e-05 ||∇||=4.761657e-01 | Tr=0.1847 Te/Cur=0.1771 Te/Exp=0.2163]100%|██████████| 2/2 [00:05<00:00,  2.50s/it, CE=2.267187e+00 H=2.267121e+00 dV_dx=-1.535948e-05 dV_dθ=-5.013469e-05 ||∇||=4.761657e-01 | Tr=0.1847 Te/Cur=0.1771 Te/Exp=0.2163]100%|██████████| 2/2 [00:05<00:00,  2.64s/it, CE=2.267187e+00 H=2.267121e+00 dV_dx=-1.535948e-05 dV_dθ=-5.013469e-05 ||∇||=4.761657e-01 | Tr=0.1847 Te/Cur=0.1771 Te/Exp=0.2163]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.72s/it] 50%|█████     | 1/2 [00:05<00:03,  3.72s/it, CE=2.277422e+00 H=2.277366e+00 dV_dx=-5.737405e-06 dV_dθ=-5.114280e-05 ||∇||=4.557167e-01 | Tr=0.1548 Te/Cur=0.1868 Te/Exp=0.1892]100%|██████████| 2/2 [00:05<00:00,  2.45s/it, CE=2.277422e+00 H=2.277366e+00 dV_dx=-5.737405e-06 dV_dθ=-5.114280e-05 ||∇||=4.557167e-01 | Tr=0.1548 Te/Cur=0.1868 Te/Exp=0.1892]100%|██████████| 2/2 [00:05<00:00,  2.64s/it, CE=2.277422e+00 H=2.277366e+00 dV_dx=-5.737405e-06 dV_dθ=-5.114280e-05 ||∇||=4.557167e-01 | Tr=0.1548 Te/Cur=0.1868 Te/Exp=0.1892]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.80s/it] 50%|█████     | 1/2 [00:05<00:03,  3.80s/it, CE=2.278682e+00 H=2.278636e+00 dV_dx=-9.979996e-06 dV_dθ=-3.534195e-05 ||∇||=3.461578e-01 | Tr=0.1458 Te/Cur=0.1475 Te/Exp=0.2242]100%|██████████| 2/2 [00:05<00:00,  2.63s/it, CE=2.278682e+00 H=2.278636e+00 dV_dx=-9.979996e-06 dV_dθ=-3.534195e-05 ||∇||=3.461578e-01 | Tr=0.1458 Te/Cur=0.1475 Te/Exp=0.2242]100%|██████████| 2/2 [00:05<00:00,  2.81s/it, CE=2.278682e+00 H=2.278636e+00 dV_dx=-9.979996e-06 dV_dθ=-3.534195e-05 ||∇||=3.461578e-01 | Tr=0.1458 Te/Cur=0.1475 Te/Exp=0.2242]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.72s/it] 50%|█████     | 1/2 [00:08<00:06,  6.72s/it, CE=2.288711e+00 H=2.288625e+00 dV_dx=-8.635584e-06 dV_dθ=-7.736867e-05 ||∇||=3.535588e-01 | Tr=0.1076 Te/Cur=0.0853 Te/Exp=0.1929]100%|██████████| 2/2 [00:08<00:00,  4.01s/it, CE=2.288711e+00 H=2.288625e+00 dV_dx=-8.635584e-06 dV_dθ=-7.736867e-05 ||∇||=3.535588e-01 | Tr=0.1076 Te/Cur=0.0853 Te/Exp=0.1929]100%|██████████| 2/2 [00:08<00:00,  4.42s/it, CE=2.288711e+00 H=2.288625e+00 dV_dx=-8.635584e-06 dV_dθ=-7.736867e-05 ||∇||=3.535588e-01 | Tr=0.1076 Te/Cur=0.0853 Te/Exp=0.1929]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.61s/it] 50%|█████     | 1/2 [00:05<00:03,  3.61s/it, CE=2.285329e+00 H=2.285281e+00 dV_dx=-3.727921e-06 dV_dθ=-4.445922e-05 ||∇||=3.276028e-01 | Tr=0.1209 Te/Cur=0.1295 Te/Exp=0.2020]100%|██████████| 2/2 [00:05<00:00,  2.42s/it, CE=2.285329e+00 H=2.285281e+00 dV_dx=-3.727921e-06 dV_dθ=-4.445922e-05 ||∇||=3.276028e-01 | Tr=0.1209 Te/Cur=0.1295 Te/Exp=0.2020]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.285329e+00 H=2.285281e+00 dV_dx=-3.727921e-06 dV_dθ=-4.445922e-05 ||∇||=3.276028e-01 | Tr=0.1209 Te/Cur=0.1295 Te/Exp=0.2020]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.66s/it] 50%|█████     | 1/2 [00:05<00:03,  3.66s/it, CE=2.281895e+00 H=2.281821e+00 dV_dx=9.316251e-07 dV_dθ=-7.519517e-05 ||∇||=3.720815e-01 | Tr=0.1004 Te/Cur=0.0917 Te/Exp=0.2146]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.281895e+00 H=2.281821e+00 dV_dx=9.316251e-07 dV_dθ=-7.519517e-05 ||∇||=3.720815e-01 | Tr=0.1004 Te/Cur=0.0917 Te/Exp=0.2146]100%|██████████| 2/2 [00:05<00:00,  2.73s/it, CE=2.281895e+00 H=2.281821e+00 dV_dx=9.316251e-07 dV_dθ=-7.519517e-05 ||∇||=3.720815e-01 | Tr=0.1004 Te/Cur=0.0917 Te/Exp=0.2146]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.47s/it] 50%|█████     | 1/2 [00:05<00:03,  3.47s/it, CE=2.275349e+00 H=2.275320e+00 dV_dx=-3.399772e-06 dV_dθ=-2.510798e-05 ||∇||=3.536512e-01 | Tr=0.1435 Te/Cur=0.1579 Te/Exp=0.2094]100%|██████████| 2/2 [00:05<00:00,  2.51s/it, CE=2.275349e+00 H=2.275320e+00 dV_dx=-3.399772e-06 dV_dθ=-2.510798e-05 ||∇||=3.536512e-01 | Tr=0.1435 Te/Cur=0.1579 Te/Exp=0.2094]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.275349e+00 H=2.275320e+00 dV_dx=-3.399772e-06 dV_dθ=-2.510798e-05 ||∇||=3.536512e-01 | Tr=0.1435 Te/Cur=0.1579 Te/Exp=0.2094]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.54s/it] 50%|█████     | 1/2 [00:05<00:03,  3.54s/it, CE=2.280801e+00 H=2.280764e+00 dV_dx=-4.340273e-06 dV_dθ=-3.288894e-05 ||∇||=3.385688e-01 | Tr=0.1151 Te/Cur=0.1645 Te/Exp=0.1746]100%|██████████| 2/2 [00:05<00:00,  2.42s/it, CE=2.280801e+00 H=2.280764e+00 dV_dx=-4.340273e-06 dV_dθ=-3.288894e-05 ||∇||=3.385688e-01 | Tr=0.1151 Te/Cur=0.1645 Te/Exp=0.1746]100%|██████████| 2/2 [00:05<00:00,  2.59s/it, CE=2.280801e+00 H=2.280764e+00 dV_dx=-4.340273e-06 dV_dθ=-3.288894e-05 ||∇||=3.385688e-01 | Tr=0.1151 Te/Cur=0.1645 Te/Exp=0.1746]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.60s/it] 50%|█████     | 1/2 [00:05<00:03,  3.60s/it, CE=2.284301e+00 H=2.284208e+00 dV_dx=-5.897739e-06 dV_dθ=-8.696299e-05 ||∇||=3.991060e-01 | Tr=0.1377 Te/Cur=0.1508 Te/Exp=0.1574]100%|██████████| 2/2 [00:05<00:00,  2.68s/it, CE=2.284301e+00 H=2.284208e+00 dV_dx=-5.897739e-06 dV_dθ=-8.696299e-05 ||∇||=3.991060e-01 | Tr=0.1377 Te/Cur=0.1508 Te/Exp=0.1574]100%|██████████| 2/2 [00:05<00:00,  2.82s/it, CE=2.284301e+00 H=2.284208e+00 dV_dx=-5.897739e-06 dV_dθ=-8.696299e-05 ||∇||=3.991060e-01 | Tr=0.1377 Te/Cur=0.1508 Te/Exp=0.1574]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.66s/it] 50%|█████     | 1/2 [00:05<00:03,  3.66s/it, CE=2.270668e+00 H=2.270618e+00 dV_dx=6.527409e-07 dV_dθ=-5.051943e-05 ||∇||=3.494894e-01 | Tr=0.1380 Te/Cur=0.1497 Te/Exp=0.2087]100%|██████████| 2/2 [00:05<00:00,  2.62s/it, CE=2.270668e+00 H=2.270618e+00 dV_dx=6.527409e-07 dV_dθ=-5.051943e-05 ||∇||=3.494894e-01 | Tr=0.1380 Te/Cur=0.1497 Te/Exp=0.2087]100%|██████████| 2/2 [00:05<00:00,  2.78s/it, CE=2.270668e+00 H=2.270618e+00 dV_dx=6.527409e-07 dV_dθ=-5.051943e-05 ||∇||=3.494894e-01 | Tr=0.1380 Te/Cur=0.1497 Te/Exp=0.2087]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.71s/it] 50%|█████     | 1/2 [00:05<00:03,  3.71s/it, CE=2.278587e+00 H=2.278520e+00 dV_dx=-9.611019e-06 dV_dθ=-5.657940e-05 ||∇||=3.971805e-01 | Tr=0.0846 Te/Cur=0.1090 Te/Exp=0.1988]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.278587e+00 H=2.278520e+00 dV_dx=-9.611019e-06 dV_dθ=-5.657940e-05 ||∇||=3.971805e-01 | Tr=0.0846 Te/Cur=0.1090 Te/Exp=0.1988]100%|██████████| 2/2 [00:05<00:00,  2.81s/it, CE=2.278587e+00 H=2.278520e+00 dV_dx=-9.611019e-06 dV_dθ=-5.657940e-05 ||∇||=3.971805e-01 | Tr=0.0846 Te/Cur=0.1090 Te/Exp=0.1988]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.38s/it] 50%|█████     | 1/2 [00:04<00:03,  3.38s/it, CE=2.284974e+00 H=2.284932e+00 dV_dx=1.372443e-06 dV_dθ=-4.355868e-05 ||∇||=3.421046e-01 | Tr=0.1375 Te/Cur=0.1545 Te/Exp=0.2101]100%|██████████| 2/2 [00:04<00:00,  2.28s/it, CE=2.284974e+00 H=2.284932e+00 dV_dx=1.372443e-06 dV_dθ=-4.355868e-05 ||∇||=3.421046e-01 | Tr=0.1375 Te/Cur=0.1545 Te/Exp=0.2101]100%|██████████| 2/2 [00:04<00:00,  2.44s/it, CE=2.284974e+00 H=2.284932e+00 dV_dx=1.372443e-06 dV_dθ=-4.355868e-05 ||∇||=3.421046e-01 | Tr=0.1375 Te/Cur=0.1545 Te/Exp=0.2101]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.21s/it] 50%|█████     | 1/2 [00:08<00:06,  6.21s/it, CE=2.277966e+00 H=2.277909e+00 dV_dx=-8.286888e-06 dV_dθ=-4.957068e-05 ||∇||=3.769151e-01 | Tr=0.1028 Te/Cur=0.1106 Te/Exp=0.1900]100%|██████████| 2/2 [00:08<00:00,  3.70s/it, CE=2.277966e+00 H=2.277909e+00 dV_dx=-8.286888e-06 dV_dθ=-4.957068e-05 ||∇||=3.769151e-01 | Tr=0.1028 Te/Cur=0.1106 Te/Exp=0.1900]100%|██████████| 2/2 [00:08<00:00,  4.08s/it, CE=2.277966e+00 H=2.277909e+00 dV_dx=-8.286888e-06 dV_dθ=-4.957068e-05 ||∇||=3.769151e-01 | Tr=0.1028 Te/Cur=0.1106 Te/Exp=0.1900]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.67s/it] 50%|█████     | 1/2 [00:05<00:03,  3.67s/it, CE=2.269216e+00 H=2.269172e+00 dV_dx=1.619821e-06 dV_dθ=-4.564314e-05 ||∇||=3.657760e-01 | Tr=0.1136 Te/Cur=0.1427 Te/Exp=0.2115]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.269216e+00 H=2.269172e+00 dV_dx=1.619821e-06 dV_dθ=-4.564314e-05 ||∇||=3.657760e-01 | Tr=0.1136 Te/Cur=0.1427 Te/Exp=0.2115]100%|██████████| 2/2 [00:05<00:00,  2.71s/it, CE=2.269216e+00 H=2.269172e+00 dV_dx=1.619821e-06 dV_dθ=-4.564314e-05 ||∇||=3.657760e-01 | Tr=0.1136 Te/Cur=0.1427 Te/Exp=0.2115]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.05s/it] 50%|█████     | 1/2 [00:05<00:03,  3.05s/it, CE=2.267102e+00 H=2.267073e+00 dV_dx=8.952516e-06 dV_dθ=-3.881735e-05 ||∇||=3.398807e-01 | Tr=0.1681 Te/Cur=0.1735 Te/Exp=0.2251]100%|██████████| 2/2 [00:05<00:00,  2.41s/it, CE=2.267102e+00 H=2.267073e+00 dV_dx=8.952516e-06 dV_dθ=-3.881735e-05 ||∇||=3.398807e-01 | Tr=0.1681 Te/Cur=0.1735 Te/Exp=0.2251]100%|██████████| 2/2 [00:05<00:00,  2.50s/it, CE=2.267102e+00 H=2.267073e+00 dV_dx=8.952516e-06 dV_dθ=-3.881735e-05 ||∇||=3.398807e-01 | Tr=0.1681 Te/Cur=0.1735 Te/Exp=0.2251]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.68s/it] 50%|█████     | 1/2 [00:05<00:03,  3.68s/it, CE=2.265223e+00 H=2.265196e+00 dV_dx=1.115868e-05 dV_dθ=-3.767585e-05 ||∇||=3.506870e-01 | Tr=0.1240 Te/Cur=0.1267 Te/Exp=0.2340]100%|██████████| 2/2 [00:05<00:00,  2.38s/it, CE=2.265223e+00 H=2.265196e+00 dV_dx=1.115868e-05 dV_dθ=-3.767585e-05 ||∇||=3.506870e-01 | Tr=0.1240 Te/Cur=0.1267 Te/Exp=0.2340]100%|██████████| 2/2 [00:05<00:00,  2.57s/it, CE=2.265223e+00 H=2.265196e+00 dV_dx=1.115868e-05 dV_dθ=-3.767585e-05 ||∇||=3.506870e-01 | Tr=0.1240 Te/Cur=0.1267 Te/Exp=0.2340]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.59s/it] 50%|█████     | 1/2 [00:05<00:03,  3.59s/it, CE=2.265102e+00 H=2.265058e+00 dV_dx=6.154036e-06 dV_dθ=-4.998997e-05 ||∇||=3.899047e-01 | Tr=0.0941 Te/Cur=0.0943 Te/Exp=0.2423]100%|██████████| 2/2 [00:05<00:00,  2.54s/it, CE=2.265102e+00 H=2.265058e+00 dV_dx=6.154036e-06 dV_dθ=-4.998997e-05 ||∇||=3.899047e-01 | Tr=0.0941 Te/Cur=0.0943 Te/Exp=0.2423]100%|██████████| 2/2 [00:05<00:00,  2.69s/it, CE=2.265102e+00 H=2.265058e+00 dV_dx=6.154036e-06 dV_dθ=-4.998997e-05 ||∇||=3.899047e-01 | Tr=0.0941 Te/Cur=0.0943 Te/Exp=0.2423]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.42s/it] 50%|█████     | 1/2 [00:05<00:03,  3.42s/it, CE=2.274558e+00 H=2.274502e+00 dV_dx=2.212167e-05 dV_dθ=-7.826362e-05 ||∇||=3.893832e-01 | Tr=0.1022 Te/Cur=0.1244 Te/Exp=0.2099]100%|██████████| 2/2 [00:05<00:00,  2.51s/it, CE=2.274558e+00 H=2.274502e+00 dV_dx=2.212167e-05 dV_dθ=-7.826362e-05 ||∇||=3.893832e-01 | Tr=0.1022 Te/Cur=0.1244 Te/Exp=0.2099]100%|██████████| 2/2 [00:05<00:00,  2.65s/it, CE=2.274558e+00 H=2.274502e+00 dV_dx=2.212167e-05 dV_dθ=-7.826362e-05 ||∇||=3.893832e-01 | Tr=0.1022 Te/Cur=0.1244 Te/Exp=0.2099]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:02<00:02,  2.87s/it] 50%|█████     | 1/2 [00:04<00:02,  2.87s/it, CE=2.272387e+00 H=2.272325e+00 dV_dx=-7.842025e-06 dV_dθ=-5.403013e-05 ||∇||=3.587271e-01 | Tr=0.1308 Te/Cur=0.1555 Te/Exp=0.1959]100%|██████████| 2/2 [00:04<00:00,  2.20s/it, CE=2.272387e+00 H=2.272325e+00 dV_dx=-7.842025e-06 dV_dθ=-5.403013e-05 ||∇||=3.587271e-01 | Tr=0.1308 Te/Cur=0.1555 Te/Exp=0.1959]100%|██████████| 2/2 [00:04<00:00,  2.30s/it, CE=2.272387e+00 H=2.272325e+00 dV_dx=-7.842025e-06 dV_dθ=-5.403013e-05 ||∇||=3.587271e-01 | Tr=0.1308 Te/Cur=0.1555 Te/Exp=0.1959]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.90s/it] 50%|█████     | 1/2 [00:05<00:03,  3.90s/it, CE=2.258918e+00 H=2.258917e+00 dV_dx=2.368839e-06 dV_dθ=-3.117240e-06 ||∇||=3.513299e-01 | Tr=0.1073 Te/Cur=0.1154 Te/Exp=0.2498]100%|██████████| 2/2 [00:05<00:00,  2.60s/it, CE=2.258918e+00 H=2.258917e+00 dV_dx=2.368839e-06 dV_dθ=-3.117240e-06 ||∇||=3.513299e-01 | Tr=0.1073 Te/Cur=0.1154 Te/Exp=0.2498]100%|██████████| 2/2 [00:05<00:00,  2.79s/it, CE=2.258918e+00 H=2.258917e+00 dV_dx=2.368839e-06 dV_dθ=-3.117240e-06 ||∇||=3.513299e-01 | Tr=0.1073 Te/Cur=0.1154 Te/Exp=0.2498]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (4, [432, 692, 204, 10]) with loss 2.258918
  Grid search complete.
  Best architecture: (4, [432, 692, 204, 10]) with loss 2.258918
  Total candidates evaluated: 54
  Original: (2, [507, 652, 164, 10])
  Optimal: (4, [432, 692, 204, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 2→4, feed [507, 652, 164, 10]→[432, 692, 204, 10]
  Conv filter changed: A_conv/B_conv shape = (4, 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:17<05:33, 17.53s/it]  5%|▌         | 1/20 [00:20<05:33, 17.53s/it, CE=2.190890e+00 H=2.061689e+00 dV_dx=-6.850793e-05 dV_dθ=-1.291321e-01 ||∇||=1.417010e+01 | Tr=0.8191] 10%|█         | 2/20 [00:20<02:37,  8.78s/it, CE=2.190890e+00 H=2.061689e+00 dV_dx=-6.850793e-05 dV_dθ=-1.291321e-01 ||∇||=1.417010e+01 | Tr=0.8191] 10%|█         | 2/20 [00:22<02:37,  8.78s/it, CE=1.798318e+00 H=1.426171e+00 dV_dx=3.328552e-05 dV_dθ=-3.721809e-01 ||∇||=1.943248e+01 | Tr=0.8191]  15%|█▌        | 3/20 [00:22<01:40,  5.93s/it, CE=1.798318e+00 H=1.426171e+00 dV_dx=3.328552e-05 dV_dθ=-3.721809e-01 ||∇||=1.943248e+01 | Tr=0.8191] 15%|█▌        | 3/20 [00:25<01:40,  5.93s/it, CE=1.583341e+00 H=8.533367e-01 dV_dx=2.951832e-05 dV_dθ=-7.300338e-01 ||∇||=2.531394e+01 | Tr=0.8191] 20%|██        | 4/20 [00:25<01:16,  4.75s/it, CE=1.583341e+00 H=8.533367e-01 dV_dx=2.951832e-05 dV_dθ=-7.300338e-01 ||∇||=2.531394e+01 | Tr=0.8191] 20%|██        | 4/20 [00:28<01:16,  4.75s/it, CE=1.434798e+00 H=5.400405e-01 dV_dx=-1.953954e-05 dV_dθ=-8.947376e-01 ||∇||=2.712444e+01 | Tr=0.8191] 25%|██▌       | 5/20 [00:28<00:58,  3.91s/it, CE=1.434798e+00 H=5.400405e-01 dV_dx=-1.953954e-05 dV_dθ=-8.947376e-01 ||∇||=2.712444e+01 | Tr=0.8191] 25%|██▌       | 5/20 [00:31<00:58,  3.91s/it, CE=1.317040e+00 H=4.774145e-01 dV_dx=-8.566992e-05 dV_dθ=-8.395402e-01 ||∇||=2.725970e+01 | Tr=0.8191] 30%|███       | 6/20 [00:31<00:51,  3.65s/it, CE=1.317040e+00 H=4.774145e-01 dV_dx=-8.566992e-05 dV_dθ=-8.395402e-01 ||∇||=2.725970e+01 | Tr=0.8191] 30%|███       | 6/20 [00:33<00:51,  3.65s/it, CE=1.222468e+00 H=4.676184e-01 dV_dx=3.559812e-05 dV_dθ=-7.548852e-01 ||∇||=2.585723e+01 | Tr=0.8191]  35%|███▌      | 7/20 [00:33<00:41,  3.17s/it, CE=1.222468e+00 H=4.676184e-01 dV_dx=3.559812e-05 dV_dθ=-7.548852e-01 ||∇||=2.585723e+01 | Tr=0.8191] 35%|███▌      | 7/20 [00:36<00:41,  3.17s/it, CE=1.146231e+00 H=4.201991e-01 dV_dx=3.418071e-05 dV_dθ=-7.260657e-01 ||∇||=2.572914e+01 | Tr=0.8191] 40%|████      | 8/20 [00:36<00:35,  2.99s/it, CE=1.146231e+00 H=4.201991e-01 dV_dx=3.418071e-05 dV_dθ=-7.260657e-01 ||∇||=2.572914e+01 | Tr=0.8191] 40%|████      | 8/20 [00:38<00:35,  2.99s/it, CE=1.079660e+00 H=4.749944e-01 dV_dx=4.629985e-05 dV_dθ=-6.047123e-01 ||∇||=2.380051e+01 | Tr=0.8191] 45%|████▌     | 9/20 [00:38<00:31,  2.87s/it, CE=1.079660e+00 H=4.749944e-01 dV_dx=4.629985e-05 dV_dθ=-6.047123e-01 ||∇||=2.380051e+01 | Tr=0.8191] 45%|████▌     | 9/20 [00:41<00:31,  2.87s/it, CE=1.023549e+00 H=4.805664e-01 dV_dx=-5.523198e-05 dV_dθ=-5.429271e-01 ||∇||=2.283280e+01 | Tr=0.8191] 50%|█████     | 10/20 [00:41<00:28,  2.82s/it, CE=1.023549e+00 H=4.805664e-01 dV_dx=-5.523198e-05 dV_dθ=-5.429271e-01 ||∇||=2.283280e+01 | Tr=0.8191] 50%|█████     | 10/20 [00:43<00:28,  2.82s/it, CE=9.742919e-01 H=5.256659e-01 dV_dx=1.218291e-05 dV_dθ=-4.486382e-01 ||∇||=2.104043e+01 | Tr=0.8191]  55%|█████▌    | 11/20 [00:43<00:24,  2.75s/it, CE=9.742919e-01 H=5.256659e-01 dV_dx=1.218291e-05 dV_dθ=-4.486382e-01 ||∇||=2.104043e+01 | Tr=0.8191] 55%|█████▌    | 11/20 [00:46<00:24,  2.75s/it, CE=9.306049e-01 H=5.349181e-01 dV_dx=-8.154056e-05 dV_dθ=-3.956053e-01 ||∇||=1.999696e+01 | Tr=0.8191] 60%|██████    | 12/20 [00:46<00:22,  2.78s/it, CE=9.306049e-01 H=5.349181e-01 dV_dx=-8.154056e-05 dV_dθ=-3.956053e-01 ||∇||=1.999696e+01 | Tr=0.8191] 60%|██████    | 12/20 [00:49<00:22,  2.78s/it, CE=8.939083e-01 H=5.244695e-01 dV_dx=1.120133e-05 dV_dθ=-3.694499e-01 ||∇||=1.945340e+01 | Tr=0.8191]  65%|██████▌   | 13/20 [00:49<00:18,  2.67s/it, CE=8.939083e-01 H=5.244695e-01 dV_dx=1.120133e-05 dV_dθ=-3.694499e-01 ||∇||=1.945340e+01 | Tr=0.8191] 65%|██████▌   | 13/20 [00:52<00:18,  2.67s/it, CE=8.606108e-01 H=4.981171e-01 dV_dx=6.617780e-05 dV_dθ=-3.625598e-01 ||∇||=1.917565e+01 | Tr=0.8191] 70%|███████   | 14/20 [00:52<00:16,  2.71s/it, CE=8.606108e-01 H=4.981171e-01 dV_dx=6.617780e-05 dV_dθ=-3.625598e-01 ||∇||=1.917565e+01 | Tr=0.8191] 70%|███████   | 14/20 [00:54<00:16,  2.71s/it, CE=8.313382e-01 H=4.581505e-01 dV_dx=2.531828e-05 dV_dθ=-3.732130e-01 ||∇||=1.923747e+01 | Tr=0.8191] 75%|███████▌  | 15/20 [00:54<00:12,  2.60s/it, CE=8.313382e-01 H=4.581505e-01 dV_dx=2.531828e-05 dV_dθ=-3.732130e-01 ||∇||=1.923747e+01 | Tr=0.8191] 75%|███████▌  | 15/20 [00:57<00:12,  2.60s/it, CE=8.048028e-01 H=4.192520e-01 dV_dx=-3.801574e-05 dV_dθ=-3.855127e-01 ||∇||=1.937296e+01 | Tr=0.8191] 80%|████████  | 16/20 [00:57<00:10,  2.63s/it, CE=8.048028e-01 H=4.192520e-01 dV_dx=-3.801574e-05 dV_dθ=-3.855127e-01 ||∇||=1.937296e+01 | Tr=0.8191] 80%|████████  | 16/20 [00:59<00:10,  2.63s/it, CE=7.787932e-01 H=4.112896e-01 dV_dx=6.524402e-05 dV_dθ=-3.675688e-01 ||∇||=1.906774e+01 | Tr=0.8191]  85%|████████▌ | 17/20 [00:59<00:07,  2.44s/it, CE=7.787932e-01 H=4.112896e-01 dV_dx=6.524402e-05 dV_dθ=-3.675688e-01 ||∇||=1.906774e+01 | Tr=0.8191] 85%|████████▌ | 17/20 [01:01<00:07,  2.44s/it, CE=7.562351e-01 H=3.523136e-01 dV_dx=-7.116792e-05 dV_dθ=-4.038503e-01 ||∇||=1.981838e+01 | Tr=0.8191] 90%|█████████ | 18/20 [01:01<00:04,  2.50s/it, CE=7.562351e-01 H=3.523136e-01 dV_dx=-7.116792e-05 dV_dθ=-4.038503e-01 ||∇||=1.981838e+01 | Tr=0.8191] 90%|█████████ | 18/20 [01:04<00:04,  2.50s/it, CE=7.400886e-01 H=1.932581e-01 dV_dx=-3.747366e-06 dV_dθ=-5.468267e-01 ||∇||=2.221761e+01 | Tr=0.8191] 95%|█████████▌| 19/20 [01:04<00:02,  2.46s/it, CE=7.400886e-01 H=1.932581e-01 dV_dx=-3.747366e-06 dV_dθ=-5.468267e-01 ||∇||=2.221761e+01 | Tr=0.8191] 95%|█████████▌| 19/20 [01:09<00:02,  2.46s/it, CE=7.349638e-01 H=-1.036713e-01 dV_dx=8.875688e-06 dV_dθ=-8.386440e-01 ||∇||=2.864817e+01 | Tr=0.8191 Te/Cur=0.9169 Te/Exp=0.7216]100%|██████████| 20/20 [01:12<00:00,  4.34s/it, CE=7.349638e-01 H=-1.036713e-01 dV_dx=8.875688e-06 dV_dθ=-8.386440e-01 ||∇||=2.864817e+01 | Tr=0.8191 Te/Cur=0.9169 Te/Exp=0.7216]100%|██████████| 20/20 [01:12<00:00,  3.64s/it, CE=7.349638e-01 H=-1.036713e-01 dV_dx=8.875688e-06 dV_dθ=-8.386440e-01 ||∇||=2.864817e+01 | Tr=0.8191 Te/Cur=0.9169 Te/Exp=0.7216]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.658541
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<02:12,  6.96s/it]  5%|▌         | 1/20 [00:09<02:12,  6.96s/it, CE=7.331654e-01 H=4.312376e-01 dV_dx=-4.448350e-05 dV_dθ=-3.018833e-01 ||∇||=1.818412e+01 | Tr=0.8196] 10%|█         | 2/20 [00:09<01:20,  4.50s/it, CE=7.331654e-01 H=4.312376e-01 dV_dx=-4.448350e-05 dV_dθ=-3.018833e-01 ||∇||=1.818412e+01 | Tr=0.8196] 10%|█         | 2/20 [00:12<01:20,  4.50s/it, CE=7.056654e-01 H=3.332339e-01 dV_dx=-3.474705e-05 dV_dθ=-3.723968e-01 ||∇||=1.959456e+01 | Tr=0.8196] 15%|█▌        | 3/20 [00:12<01:03,  3.75s/it, CE=7.056654e-01 H=3.332339e-01 dV_dx=-3.474705e-05 dV_dθ=-3.723968e-01 ||∇||=1.959456e+01 | Tr=0.8196] 15%|█▌        | 3/20 [00:14<01:03,  3.75s/it, CE=6.860133e-01 H=2.200711e-01 dV_dx=-5.060972e-05 dV_dθ=-4.658916e-01 ||∇||=2.137092e+01 | Tr=0.8196] 20%|██        | 4/20 [00:14<00:50,  3.17s/it, CE=6.860133e-01 H=2.200711e-01 dV_dx=-5.060972e-05 dV_dθ=-4.658916e-01 ||∇||=2.137092e+01 | Tr=0.8196] 20%|██        | 4/20 [00:17<00:50,  3.17s/it, CE=6.642157e-01 H=2.591339e-01 dV_dx=2.420879e-05 dV_dθ=-4.051061e-01 ||∇||=1.990201e+01 | Tr=0.8196]  25%|██▌       | 5/20 [00:17<00:42,  2.85s/it, CE=6.642157e-01 H=2.591339e-01 dV_dx=2.420879e-05 dV_dθ=-4.051061e-01 ||∇||=1.990201e+01 | Tr=0.8196] 25%|██▌       | 5/20 [00:19<00:42,  2.85s/it, CE=6.487425e-01 H=2.524063e-01 dV_dx=3.691314e-05 dV_dθ=-3.963731e-01 ||∇||=2.018027e+01 | Tr=0.8196] 30%|███       | 6/20 [00:19<00:36,  2.60s/it, CE=6.487425e-01 H=2.524063e-01 dV_dx=3.691314e-05 dV_dθ=-3.963731e-01 ||∇||=2.018027e+01 | Tr=0.8196] 30%|███       | 6/20 [00:21<00:36,  2.60s/it, CE=6.432037e-01 H=9.140605e-02 dV_dx=1.446784e-05 dV_dθ=-5.518121e-01 ||∇||=2.366709e+01 | Tr=0.8196] 35%|███▌      | 7/20 [00:21<00:32,  2.53s/it, CE=6.432037e-01 H=9.140605e-02 dV_dx=1.446784e-05 dV_dθ=-5.518121e-01 ||∇||=2.366709e+01 | Tr=0.8196] 35%|███▌      | 7/20 [00:23<00:32,  2.53s/it, CE=6.346861e-01 H=5.013287e-02 dV_dx=-1.164785e-05 dV_dθ=-5.845416e-01 ||∇||=2.436304e+01 | Tr=0.8196] 40%|████      | 8/20 [00:23<00:29,  2.46s/it, CE=6.346861e-01 H=5.013287e-02 dV_dx=-1.164785e-05 dV_dθ=-5.845416e-01 ||∇||=2.436304e+01 | Tr=0.8196] 40%|████      | 8/20 [00:26<00:29,  2.46s/it, CE=6.252258e-01 H=5.124932e-02 dV_dx=1.254541e-05 dV_dθ=-5.739890e-01 ||∇||=2.357329e+01 | Tr=0.8196]  45%|████▌     | 9/20 [00:26<00:27,  2.52s/it, CE=6.252258e-01 H=5.124932e-02 dV_dx=1.254541e-05 dV_dθ=-5.739890e-01 ||∇||=2.357329e+01 | Tr=0.8196] 45%|████▌     | 9/20 [00:29<00:27,  2.52s/it, CE=6.174186e-01 H=2.762200e-03 dV_dx=-8.460929e-05 dV_dθ=-6.145718e-01 ||∇||=2.433332e+01 | Tr=0.8196] 50%|█████     | 10/20 [00:29<00:25,  2.60s/it, CE=6.174186e-01 H=2.762200e-03 dV_dx=-8.460929e-05 dV_dθ=-6.145718e-01 ||∇||=2.433332e+01 | Tr=0.8196] 50%|█████     | 10/20 [00:31<00:25,  2.60s/it, CE=5.789279e-01 H=3.095335e-01 dV_dx=1.528141e-07 dV_dθ=-2.693945e-01 ||∇||=1.686973e+01 | Tr=0.8196]  55%|█████▌    | 11/20 [00:31<00:22,  2.55s/it, CE=5.789279e-01 H=3.095335e-01 dV_dx=1.528141e-07 dV_dθ=-2.693945e-01 ||∇||=1.686973e+01 | Tr=0.8196] 55%|█████▌    | 11/20 [00:34<00:22,  2.55s/it, CE=5.623910e-01 H=3.658771e-01 dV_dx=-1.922116e-06 dV_dθ=-1.965120e-01 ||∇||=1.471422e+01 | Tr=0.8196] 60%|██████    | 12/20 [00:34<00:21,  2.63s/it, CE=5.623910e-01 H=3.658771e-01 dV_dx=-1.922116e-06 dV_dθ=-1.965120e-01 ||∇||=1.471422e+01 | Tr=0.8196] 60%|██████    | 12/20 [00:36<00:21,  2.63s/it, CE=5.541094e-01 H=3.685517e-01 dV_dx=5.049398e-05 dV_dθ=-1.856082e-01 ||∇||=1.441829e+01 | Tr=0.8196]  65%|██████▌   | 13/20 [00:36<00:16,  2.41s/it, CE=5.541094e-01 H=3.685517e-01 dV_dx=5.049398e-05 dV_dθ=-1.856082e-01 ||∇||=1.441829e+01 | Tr=0.8196] 65%|██████▌   | 13/20 [00:38<00:16,  2.41s/it, CE=5.455538e-01 H=3.712331e-01 dV_dx=2.250457e-06 dV_dθ=-1.743230e-01 ||∇||=1.410276e+01 | Tr=0.8196] 70%|███████   | 14/20 [00:38<00:14,  2.34s/it, CE=5.455538e-01 H=3.712331e-01 dV_dx=2.250457e-06 dV_dθ=-1.743230e-01 ||∇||=1.410276e+01 | Tr=0.8196] 70%|███████   | 14/20 [00:41<00:14,  2.34s/it, CE=5.308067e-01 H=3.694226e-01 dV_dx=1.208291e-05 dV_dθ=-1.613962e-01 ||∇||=1.342181e+01 | Tr=0.8196] 75%|███████▌  | 15/20 [00:41<00:12,  2.42s/it, CE=5.308067e-01 H=3.694226e-01 dV_dx=1.208291e-05 dV_dθ=-1.613962e-01 ||∇||=1.342181e+01 | Tr=0.8196] 75%|███████▌  | 15/20 [00:43<00:12,  2.42s/it, CE=5.172342e-01 H=3.843985e-01 dV_dx=1.881479e-06 dV_dθ=-1.328376e-01 ||∇||=1.250939e+01 | Tr=0.8196] 80%|████████  | 16/20 [00:43<00:09,  2.34s/it, CE=5.172342e-01 H=3.843985e-01 dV_dx=1.881479e-06 dV_dθ=-1.328376e-01 ||∇||=1.250939e+01 | Tr=0.8196] 80%|████████  | 16/20 [00:45<00:09,  2.34s/it, CE=5.090869e-01 H=3.896029e-01 dV_dx=5.876359e-05 dV_dθ=-1.195428e-01 ||∇||=1.210448e+01 | Tr=0.8196] 85%|████████▌ | 17/20 [00:45<00:06,  2.30s/it, CE=5.090869e-01 H=3.896029e-01 dV_dx=5.876359e-05 dV_dθ=-1.195428e-01 ||∇||=1.210448e+01 | Tr=0.8196] 85%|████████▌ | 17/20 [00:48<00:06,  2.30s/it, CE=5.160369e-01 H=3.446182e-01 dV_dx=-1.623151e-05 dV_dθ=-1.714024e-01 ||∇||=1.406512e+01 | Tr=0.8196] 90%|█████████ | 18/20 [00:48<00:04,  2.34s/it, CE=5.160369e-01 H=3.446182e-01 dV_dx=-1.623151e-05 dV_dθ=-1.714024e-01 ||∇||=1.406512e+01 | Tr=0.8196] 90%|█████████ | 18/20 [00:50<00:04,  2.34s/it, CE=5.245535e-01 H=3.356771e-01 dV_dx=-7.932682e-06 dV_dθ=-1.888685e-01 ||∇||=1.532651e+01 | Tr=0.8196] 95%|█████████▌| 19/20 [00:50<00:02,  2.42s/it, CE=5.245535e-01 H=3.356771e-01 dV_dx=-7.932682e-06 dV_dθ=-1.888685e-01 ||∇||=1.532651e+01 | Tr=0.8196] 95%|█████████▌| 19/20 [00:54<00:02,  2.42s/it, CE=5.034368e-01 H=3.645549e-01 dV_dx=7.764266e-06 dV_dθ=-1.388897e-01 ||∇||=1.300895e+01 | Tr=0.8196 Te/Cur=0.9547 Te/Exp=0.7950]100%|██████████| 20/20 [00:58<00:00,  4.01s/it, CE=5.034368e-01 H=3.645549e-01 dV_dx=7.764266e-06 dV_dθ=-1.388897e-01 ||∇||=1.300895e+01 | Tr=0.8196 Te/Cur=0.9547 Te/Exp=0.7950]100%|██████████| 20/20 [00:58<00:00,  2.92s/it, CE=5.034368e-01 H=3.645549e-01 dV_dx=7.764266e-06 dV_dθ=-1.388897e-01 ||∇||=1.300895e+01 | Tr=0.8196 Te/Cur=0.9547 Te/Exp=0.7950]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.94s/it] 50%|█████     | 1/2 [00:11<00:08,  8.94s/it, CE=5.428185e-01 H=5.296867e-01 dV_dx=-4.982491e-05 dV_dθ=-1.308202e-02 ||∇||=3.716964e+00 | Tr=0.9761 Te/Cur=0.9564 Te/Exp=0.8075]100%|██████████| 2/2 [00:11<00:00,  5.48s/it, CE=5.428185e-01 H=5.296867e-01 dV_dx=-4.982491e-05 dV_dθ=-1.308202e-02 ||∇||=3.716964e+00 | Tr=0.9761 Te/Cur=0.9564 Te/Exp=0.8075]100%|██████████| 2/2 [00:11<00:00,  6.00s/it, CE=5.428185e-01 H=5.296867e-01 dV_dx=-4.982491e-05 dV_dθ=-1.308202e-02 ||∇||=3.716964e+00 | Tr=0.9761 Te/Cur=0.9564 Te/Exp=0.8075]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:10<03:11, 10.10s/it]  5%|▌         | 1/20 [00:12<03:11, 10.10s/it, CE=5.271262e-01 H=5.176659e-01 dV_dx=-9.406186e-05 dV_dθ=-9.366308e-03 ||∇||=3.412772e+00 | Tr=0.9783] 10%|█         | 2/20 [00:12<01:38,  5.48s/it, CE=5.271262e-01 H=5.176659e-01 dV_dx=-9.406186e-05 dV_dθ=-9.366308e-03 ||∇||=3.412772e+00 | Tr=0.9783] 10%|█         | 2/20 [00:14<01:38,  5.48s/it, CE=5.116753e-01 H=5.025286e-01 dV_dx=-4.825498e-06 dV_dθ=-9.141881e-03 ||∇||=3.367867e+00 | Tr=0.9792] 15%|█▌        | 3/20 [00:14<01:06,  3.91s/it, CE=5.116753e-01 H=5.025286e-01 dV_dx=-4.825498e-06 dV_dθ=-9.141881e-03 ||∇||=3.367867e+00 | Tr=0.9792] 15%|█▌        | 3/20 [00:16<01:06,  3.91s/it, CE=4.986212e-01 H=4.897219e-01 dV_dx=-1.305219e-04 dV_dθ=-8.768786e-03 ||∇||=3.290227e+00 | Tr=0.9801] 20%|██        | 4/20 [00:16<00:49,  3.09s/it, CE=4.986212e-01 H=4.897219e-01 dV_dx=-1.305219e-04 dV_dθ=-8.768786e-03 ||∇||=3.290227e+00 | Tr=0.9801] 20%|██        | 4/20 [00:18<00:49,  3.09s/it, CE=4.873839e-01 H=4.787580e-01 dV_dx=1.356421e-04 dV_dθ=-8.761503e-03 ||∇||=3.267401e+00 | Tr=0.9811]  25%|██▌       | 5/20 [00:18<00:39,  2.67s/it, CE=4.873839e-01 H=4.787580e-01 dV_dx=1.356421e-04 dV_dθ=-8.761503e-03 ||∇||=3.267401e+00 | Tr=0.9811] 25%|██▌       | 5/20 [00:22<00:39,  2.67s/it, CE=4.771121e-01 H=4.685474e-01 dV_dx=-1.081582e-04 dV_dθ=-8.456572e-03 ||∇||=3.213121e+00 | Tr=0.9818 Te/Cur=0.9586 Te/Exp=0.8190] 30%|███       | 6/20 [00:22<00:44,  3.16s/it, CE=4.771121e-01 H=4.685474e-01 dV_dx=-1.081582e-04 dV_dθ=-8.456572e-03 ||∇||=3.213121e+00 | Tr=0.9818 Te/Cur=0.9586 Te/Exp=0.8190] 30%|███       | 6/20 [00:24<00:44,  3.16s/it, CE=4.677788e-01 H=4.596638e-01 dV_dx=4.611313e-06 dV_dθ=-8.119544e-03 ||∇||=3.154483e+00 | Tr=0.9825]                              35%|███▌      | 7/20 [00:24<00:36,  2.83s/it, CE=4.677788e-01 H=4.596638e-01 dV_dx=4.611313e-06 dV_dθ=-8.119544e-03 ||∇||=3.154483e+00 | Tr=0.9825] 35%|███▌      | 7/20 [00:26<00:36,  2.83s/it, CE=4.591755e-01 H=4.513913e-01 dV_dx=-5.164860e-05 dV_dθ=-7.732554e-03 ||∇||=3.101645e+00 | Tr=0.9833] 40%|████      | 8/20 [00:26<00:30,  2.51s/it, CE=4.591755e-01 H=4.513913e-01 dV_dx=-5.164860e-05 dV_dθ=-7.732554e-03 ||∇||=3.101645e+00 | Tr=0.9833] 40%|████      | 8/20 [00:28<00:30,  2.51s/it, CE=4.509768e-01 H=4.437302e-01 dV_dx=2.123692e-06 dV_dθ=-7.248724e-03 ||∇||=3.032904e+00 | Tr=0.9838]  45%|████▌     | 9/20 [00:28<00:26,  2.39s/it, CE=4.509768e-01 H=4.437302e-01 dV_dx=2.123692e-06 dV_dθ=-7.248724e-03 ||∇||=3.032904e+00 | Tr=0.9838] 45%|████▌     | 9/20 [00:30<00:26,  2.39s/it, CE=4.434412e-01 H=4.363072e-01 dV_dx=-1.307631e-04 dV_dθ=-7.003164e-03 ||∇||=2.988934e+00 | Tr=0.9846] 50%|█████     | 10/20 [00:30<00:23,  2.32s/it, CE=4.434412e-01 H=4.363072e-01 dV_dx=-1.307631e-04 dV_dθ=-7.003164e-03 ||∇||=2.988934e+00 | Tr=0.9846] 50%|█████     | 10/20 [00:33<00:23,  2.32s/it, CE=4.364574e-01 H=4.294940e-01 dV_dx=2.902598e-05 dV_dθ=-6.992445e-03 ||∇||=2.985955e+00 | Tr=0.9849 Te/Cur=0.9603 Te/Exp=0.8174] 55%|█████▌    | 11/20 [00:33<00:23,  2.56s/it, CE=4.364574e-01 H=4.294940e-01 dV_dx=2.902598e-05 dV_dθ=-6.992445e-03 ||∇||=2.985955e+00 | Tr=0.9849 Te/Cur=0.9603 Te/Exp=0.8174] 55%|█████▌    | 11/20 [00:35<00:23,  2.56s/it, CE=4.299450e-01 H=4.230883e-01 dV_dx=-1.032171e-05 dV_dθ=-6.846373e-03 ||∇||=2.981494e+00 | Tr=0.9855]                            60%|██████    | 12/20 [00:35<00:18,  2.37s/it, CE=4.299450e-01 H=4.230883e-01 dV_dx=-1.032171e-05 dV_dθ=-6.846373e-03 ||∇||=2.981494e+00 | Tr=0.9855] 60%|██████    | 12/20 [00:37<00:18,  2.37s/it, CE=4.239959e-01 H=4.170453e-01 dV_dx=2.362134e-05 dV_dθ=-6.974145e-03 ||∇||=2.997501e+00 | Tr=0.9862]  65%|██████▌   | 13/20 [00:37<00:15,  2.23s/it, CE=4.239959e-01 H=4.170453e-01 dV_dx=2.362134e-05 dV_dθ=-6.974145e-03 ||∇||=2.997501e+00 | Tr=0.9862] 65%|██████▌   | 13/20 [00:39<00:15,  2.23s/it, CE=4.179558e-01 H=4.111065e-01 dV_dx=5.084891e-05 dV_dθ=-6.900171e-03 ||∇||=2.984013e+00 | Tr=0.9869] 70%|███████   | 14/20 [00:39<00:13,  2.17s/it, CE=4.179558e-01 H=4.111065e-01 dV_dx=5.084891e-05 dV_dθ=-6.900171e-03 ||∇||=2.984013e+00 | Tr=0.9869] 70%|███████   | 14/20 [00:43<00:13,  2.17s/it, CE=4.121879e-01 H=4.053111e-01 dV_dx=5.940620e-05 dV_dθ=-6.936154e-03 ||∇||=2.976412e+00 | Tr=0.9874] 75%|███████▌  | 15/20 [00:43<00:14,  2.83s/it, CE=4.121879e-01 H=4.053111e-01 dV_dx=5.940620e-05 dV_dθ=-6.936154e-03 ||∇||=2.976412e+00 | Tr=0.9874] 75%|███████▌  | 15/20 [00:47<00:14,  2.83s/it, CE=4.064690e-01 H=3.997403e-01 dV_dx=-6.276935e-05 dV_dθ=-6.665891e-03 ||∇||=2.938838e+00 | Tr=0.9879 Te/Cur=0.9658 Te/Exp=0.8134] 80%|████████  | 16/20 [00:47<00:12,  3.03s/it, CE=4.064690e-01 H=3.997403e-01 dV_dx=-6.276935e-05 dV_dθ=-6.665891e-03 ||∇||=2.938838e+00 | Tr=0.9879 Te/Cur=0.9658 Te/Exp=0.8134] 80%|████████  | 16/20 [00:49<00:12,  3.03s/it, CE=4.008633e-01 H=3.944523e-01 dV_dx=-2.742436e-05 dV_dθ=-6.383515e-03 ||∇||=2.892827e+00 | Tr=0.9883]                             85%|████████▌ | 17/20 [00:49<00:08,  2.69s/it, CE=4.008633e-01 H=3.944523e-01 dV_dx=-2.742436e-05 dV_dθ=-6.383515e-03 ||∇||=2.892827e+00 | Tr=0.9883] 85%|████████▌ | 17/20 [00:51<00:08,  2.69s/it, CE=3.955362e-01 H=3.890406e-01 dV_dx=-1.250958e-04 dV_dθ=-6.370465e-03 ||∇||=2.876452e+00 | Tr=0.9888] 90%|█████████ | 18/20 [00:51<00:04,  2.42s/it, CE=3.955362e-01 H=3.890406e-01 dV_dx=-1.250958e-04 dV_dθ=-6.370465e-03 ||∇||=2.876452e+00 | Tr=0.9888] 90%|█████████ | 18/20 [00:53<00:04,  2.42s/it, CE=3.904323e-01 H=3.841421e-01 dV_dx=5.689755e-05 dV_dθ=-6.347084e-03 ||∇||=2.850412e+00 | Tr=0.9892]  95%|█████████▌| 19/20 [00:53<00:02,  2.35s/it, CE=3.904323e-01 H=3.841421e-01 dV_dx=5.689755e-05 dV_dθ=-6.347084e-03 ||∇||=2.850412e+00 | Tr=0.9892] 95%|█████████▌| 19/20 [00:56<00:02,  2.35s/it, CE=3.854731e-01 H=3.794879e-01 dV_dx=5.515802e-05 dV_dθ=-6.040321e-03 ||∇||=2.795490e+00 | Tr=0.9896 Te/Cur=0.9663 Te/Exp=0.8213]100%|██████████| 20/20 [00:56<00:00,  2.69s/it, CE=3.854731e-01 H=3.794879e-01 dV_dx=5.515802e-05 dV_dθ=-6.040321e-03 ||∇||=2.795490e+00 | Tr=0.9896 Te/Cur=0.9663 Te/Exp=0.8213]100%|██████████| 20/20 [00:56<00:00,  2.84s/it, CE=3.854731e-01 H=3.794879e-01 dV_dx=5.515802e-05 dV_dθ=-6.040321e-03 ||∇||=2.795490e+00 | Tr=0.9896 Te/Cur=0.9663 Te/Exp=0.8213]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 8 final loss: 0.395971
======================================================================


  Evaluating on all tasks 0..8 for CL metrics...
    Task 0: 0.7242
    Task 1: 0.9119
    Task 2: 0.7899
    Task 3: 0.5716
    Task 4: 0.9059
    Task 5: 0.8848
    Task 6: 0.9029
    Task 7: 0.9034
    Task 8: 0.9660

============================================================
Task 9
============================================================
Initial loss on new task: 2.0961, previous: 0.3855, ratio: 5.44
AWB pipeline (lr=0.000100)

======================================================================
AWB PIPELINE - Task 9
======================================================================

[STEP 1] Preliminary training (1 epochs) - Recorded temporarily
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:08<?, ?it/s, CE=4.568824e-01 H=4.153417e-01 dV_dx=3.314535e-05 dV_dθ=-4.157381e-02 ||∇||=6.425786e+00 | Tr=0.7891 Te/Cur=0.8520 Te/Exp=0.8343]100%|██████████| 1/1 [00:08<00:00,  8.05s/it, CE=4.568824e-01 H=4.153417e-01 dV_dx=3.314535e-05 dV_dθ=-4.157381e-02 ||∇||=6.425786e+00 | Tr=0.7891 Te/Cur=0.8520 Te/Exp=0.8343]100%|██████████| 1/1 [00:08<00:00,  8.05s/it, CE=4.568824e-01 H=4.153417e-01 dV_dx=3.314535e-05 dV_dθ=-4.157381e-02 ||∇||=6.425786e+00 | Tr=0.7891 Te/Cur=0.8520 Te/Exp=0.8343]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Preliminary loss: 0.456882

[STEP 2] Architecture change decision
  Current: 0.456882, Previous: 0.385473
  Decision: CHANGE

[STEP 3a] Architecture search - NOT recorded
  Created balanced validation set: 9419 samples from 10 classes
  Created balanced validation set: 39932 samples from 10 classes
  Starting grid architecture search for task 9
  Baseline architecture: (4, [432, 692, 204, 10])
  Baseline loss: 0.456882
  Search iteration 1/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.83s/it] 50%|█████     | 1/2 [00:07<00:05,  5.83s/it, CE=2.239490e+00 H=2.239275e+00 dV_dx=-2.136582e-06 dV_dθ=-2.128159e-04 ||∇||=5.222342e-01 | Tr=0.2196 Te/Cur=0.2382 Te/Exp=0.2459]100%|██████████| 2/2 [00:07<00:00,  3.35s/it, CE=2.239490e+00 H=2.239275e+00 dV_dx=-2.136582e-06 dV_dθ=-2.128159e-04 ||∇||=5.222342e-01 | Tr=0.2196 Te/Cur=0.2382 Te/Exp=0.2459]100%|██████████| 2/2 [00:07<00:00,  3.72s/it, CE=2.239490e+00 H=2.239275e+00 dV_dx=-2.136582e-06 dV_dθ=-2.128159e-04 ||∇||=5.222342e-01 | Tr=0.2196 Te/Cur=0.2382 Te/Exp=0.2459]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.239490436792295
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.74s/it] 50%|█████     | 1/2 [00:15<00:08,  8.74s/it, CE=2.239116e+00 H=2.238891e+00 dV_dx=-6.154549e-06 dV_dθ=-2.190771e-04 ||∇||=6.198280e-01 | Tr=0.2219 Te/Cur=0.2868 Te/Exp=0.2432]100%|██████████| 2/2 [00:15<00:00,  7.52s/it, CE=2.239116e+00 H=2.238891e+00 dV_dx=-6.154549e-06 dV_dθ=-2.190771e-04 ||∇||=6.198280e-01 | Tr=0.2219 Te/Cur=0.2868 Te/Exp=0.2432]100%|██████████| 2/2 [00:15<00:00,  7.70s/it, CE=2.239116e+00 H=2.238891e+00 dV_dx=-6.154549e-06 dV_dθ=-2.190771e-04 ||∇||=6.198280e-01 | Tr=0.2219 Te/Cur=0.2868 Te/Exp=0.2432]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 692, 184, 10]) with loss 2.239116
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.02s/it] 50%|█████     | 1/2 [00:10<00:09,  9.02s/it, CE=2.235535e+00 H=2.235347e+00 dV_dx=2.200908e-06 dV_dθ=-1.901803e-04 ||∇||=5.963962e-01 | Tr=0.1971 Te/Cur=0.2886 Te/Exp=0.2511]100%|██████████| 2/2 [00:10<00:00,  4.80s/it, CE=2.235535e+00 H=2.235347e+00 dV_dx=2.200908e-06 dV_dθ=-1.901803e-04 ||∇||=5.963962e-01 | Tr=0.1971 Te/Cur=0.2886 Te/Exp=0.2511]100%|██████████| 2/2 [00:10<00:00,  5.43s/it, CE=2.235535e+00 H=2.235347e+00 dV_dx=2.200908e-06 dV_dθ=-1.901803e-04 ||∇||=5.963962e-01 | Tr=0.1971 Te/Cur=0.2886 Te/Exp=0.2511]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 712, 184, 10]) with loss 2.235535
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.97s/it] 50%|█████     | 1/2 [00:10<00:08,  8.97s/it, CE=2.249249e+00 H=2.249044e+00 dV_dx=8.855949e-07 dV_dθ=-2.057537e-04 ||∇||=5.434070e-01 | Tr=0.2051 Te/Cur=0.2637 Te/Exp=0.2518]100%|██████████| 2/2 [00:10<00:00,  4.75s/it, CE=2.249249e+00 H=2.249044e+00 dV_dx=8.855949e-07 dV_dθ=-2.057537e-04 ||∇||=5.434070e-01 | Tr=0.2051 Te/Cur=0.2637 Te/Exp=0.2518]100%|██████████| 2/2 [00:10<00:00,  5.38s/it, CE=2.249249e+00 H=2.249044e+00 dV_dx=8.855949e-07 dV_dθ=-2.057537e-04 ||∇||=5.434070e-01 | Tr=0.2051 Te/Cur=0.2637 Te/Exp=0.2518]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.65s/it] 50%|█████     | 1/2 [00:07<00:05,  5.65s/it, CE=2.219907e+00 H=2.219713e+00 dV_dx=3.846152e-06 dV_dθ=-1.982485e-04 ||∇||=6.024833e-01 | Tr=0.1813 Te/Cur=0.2361 Te/Exp=0.2718]100%|██████████| 2/2 [00:07<00:00,  3.40s/it, CE=2.219907e+00 H=2.219713e+00 dV_dx=3.846152e-06 dV_dθ=-1.982485e-04 ||∇||=6.024833e-01 | Tr=0.1813 Te/Cur=0.2361 Te/Exp=0.2718]100%|██████████| 2/2 [00:07<00:00,  3.74s/it, CE=2.219907e+00 H=2.219713e+00 dV_dx=3.846152e-06 dV_dθ=-1.982485e-04 ||∇||=6.024833e-01 | Tr=0.1813 Te/Cur=0.2361 Te/Exp=0.2718]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 692, 204, 10]) with loss 2.219907
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.96s/it] 50%|█████     | 1/2 [00:10<00:08,  8.96s/it, CE=2.225713e+00 H=2.225453e+00 dV_dx=6.014009e-06 dV_dθ=-2.662600e-04 ||∇||=7.293683e-01 | Tr=0.2609 Te/Cur=0.2724 Te/Exp=0.2847]100%|██████████| 2/2 [00:10<00:00,  4.76s/it, CE=2.225713e+00 H=2.225453e+00 dV_dx=6.014009e-06 dV_dθ=-2.662600e-04 ||∇||=7.293683e-01 | Tr=0.2609 Te/Cur=0.2724 Te/Exp=0.2847]100%|██████████| 2/2 [00:10<00:00,  5.39s/it, CE=2.225713e+00 H=2.225453e+00 dV_dx=6.014009e-06 dV_dθ=-2.662600e-04 ||∇||=7.293683e-01 | Tr=0.2609 Te/Cur=0.2724 Te/Exp=0.2847]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.49s/it] 50%|█████     | 1/2 [00:11<00:09,  9.49s/it, CE=2.241296e+00 H=2.241180e+00 dV_dx=1.249311e-05 dV_dθ=-1.283777e-04 ||∇||=5.148166e-01 | Tr=0.2185 Te/Cur=0.2250 Te/Exp=0.2631]100%|██████████| 2/2 [00:11<00:00,  5.31s/it, CE=2.241296e+00 H=2.241180e+00 dV_dx=1.249311e-05 dV_dθ=-1.283777e-04 ||∇||=5.148166e-01 | Tr=0.2185 Te/Cur=0.2250 Te/Exp=0.2631]100%|██████████| 2/2 [00:11<00:00,  5.94s/it, CE=2.241296e+00 H=2.241180e+00 dV_dx=1.249311e-05 dV_dθ=-1.283777e-04 ||∇||=5.148166e-01 | Tr=0.2185 Te/Cur=0.2250 Te/Exp=0.2631]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.05s/it] 50%|█████     | 1/2 [00:12<00:10, 10.05s/it, CE=2.226804e+00 H=2.226499e+00 dV_dx=-4.751951e-06 dV_dθ=-3.002922e-04 ||∇||=6.968684e-01 | Tr=0.1408 Te/Cur=0.1443 Te/Exp=0.2827]100%|██████████| 2/2 [00:12<00:00,  5.41s/it, CE=2.226804e+00 H=2.226499e+00 dV_dx=-4.751951e-06 dV_dθ=-3.002922e-04 ||∇||=6.968684e-01 | Tr=0.1408 Te/Cur=0.1443 Te/Exp=0.2827]100%|██████████| 2/2 [00:12<00:00,  6.11s/it, CE=2.226804e+00 H=2.226499e+00 dV_dx=-4.751951e-06 dV_dθ=-3.002922e-04 ||∇||=6.968684e-01 | Tr=0.1408 Te/Cur=0.1443 Te/Exp=0.2827]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.04s/it] 50%|█████     | 1/2 [00:11<00:10, 10.04s/it, CE=2.227608e+00 H=2.227355e+00 dV_dx=-3.479038e-06 dV_dθ=-2.493681e-04 ||∇||=5.977959e-01 | Tr=0.2419 Te/Cur=0.2778 Te/Exp=0.2723]100%|██████████| 2/2 [00:11<00:00,  5.21s/it, CE=2.227608e+00 H=2.227355e+00 dV_dx=-3.479038e-06 dV_dθ=-2.493681e-04 ||∇||=5.977959e-01 | Tr=0.2419 Te/Cur=0.2778 Te/Exp=0.2723]100%|██████████| 2/2 [00:11<00:00,  5.94s/it, CE=2.227608e+00 H=2.227355e+00 dV_dx=-3.479038e-06 dV_dθ=-2.493681e-04 ||∇||=5.977959e-01 | Tr=0.2419 Te/Cur=0.2778 Te/Exp=0.2723]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.32s/it] 50%|█████     | 1/2 [00:11<00:09,  9.32s/it, CE=2.274902e+00 H=2.274846e+00 dV_dx=5.218109e-06 dV_dθ=-6.092042e-05 ||∇||=3.670016e-01 | Tr=0.1775 Te/Cur=0.2370 Te/Exp=0.2269]100%|██████████| 2/2 [00:11<00:00,  5.02s/it, CE=2.274902e+00 H=2.274846e+00 dV_dx=5.218109e-06 dV_dθ=-6.092042e-05 ||∇||=3.670016e-01 | Tr=0.1775 Te/Cur=0.2370 Te/Exp=0.2269]100%|██████████| 2/2 [00:11<00:00,  5.67s/it, CE=2.274902e+00 H=2.274846e+00 dV_dx=5.218109e-06 dV_dθ=-6.092042e-05 ||∇||=3.670016e-01 | Tr=0.1775 Te/Cur=0.2370 Te/Exp=0.2269]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.23s/it] 50%|█████     | 1/2 [00:11<00:10, 10.23s/it, CE=2.269278e+00 H=2.269172e+00 dV_dx=1.745362e-06 dV_dθ=-1.078405e-04 ||∇||=4.077618e-01 | Tr=0.1204 Te/Cur=0.1571 Te/Exp=0.2011]100%|██████████| 2/2 [00:11<00:00,  5.21s/it, CE=2.269278e+00 H=2.269172e+00 dV_dx=1.745362e-06 dV_dθ=-1.078405e-04 ||∇||=4.077618e-01 | Tr=0.1204 Te/Cur=0.1571 Te/Exp=0.2011]100%|██████████| 2/2 [00:11<00:00,  5.97s/it, CE=2.269278e+00 H=2.269172e+00 dV_dx=1.745362e-06 dV_dθ=-1.078405e-04 ||∇||=4.077618e-01 | Tr=0.1204 Te/Cur=0.1571 Te/Exp=0.2011]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.34s/it] 50%|█████     | 1/2 [00:11<00:10, 10.34s/it, CE=2.274941e+00 H=2.274891e+00 dV_dx=-1.966208e-06 dV_dθ=-4.750595e-05 ||∇||=3.684111e-01 | Tr=0.1663 Te/Cur=0.1802 Te/Exp=0.2210]100%|██████████| 2/2 [00:11<00:00,  5.16s/it, CE=2.274941e+00 H=2.274891e+00 dV_dx=-1.966208e-06 dV_dθ=-4.750595e-05 ||∇||=3.684111e-01 | Tr=0.1663 Te/Cur=0.1802 Te/Exp=0.2210]100%|██████████| 2/2 [00:11<00:00,  5.94s/it, CE=2.274941e+00 H=2.274891e+00 dV_dx=-1.966208e-06 dV_dθ=-4.750595e-05 ||∇||=3.684111e-01 | Tr=0.1663 Te/Cur=0.1802 Te/Exp=0.2210]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.12s/it] 50%|█████     | 1/2 [00:12<00:10, 10.12s/it, CE=2.264986e+00 H=2.264913e+00 dV_dx=-7.209139e-06 dV_dθ=-6.650993e-05 ||∇||=3.392778e-01 | Tr=0.1932 Te/Cur=0.2126 Te/Exp=0.2151]100%|██████████| 2/2 [00:12<00:00,  5.41s/it, CE=2.264986e+00 H=2.264913e+00 dV_dx=-7.209139e-06 dV_dθ=-6.650993e-05 ||∇||=3.392778e-01 | Tr=0.1932 Te/Cur=0.2126 Te/Exp=0.2151]100%|██████████| 2/2 [00:12<00:00,  6.12s/it, CE=2.264986e+00 H=2.264913e+00 dV_dx=-7.209139e-06 dV_dθ=-6.650993e-05 ||∇||=3.392778e-01 | Tr=0.1932 Te/Cur=0.2126 Te/Exp=0.2151]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.44s/it] 50%|█████     | 1/2 [00:07<00:05,  5.44s/it, CE=2.258649e+00 H=2.258518e+00 dV_dx=-8.149305e-06 dV_dθ=-1.223126e-04 ||∇||=4.526996e-01 | Tr=0.1458 Te/Cur=0.1749 Te/Exp=0.2406]100%|██████████| 2/2 [00:07<00:00,  3.16s/it, CE=2.258649e+00 H=2.258518e+00 dV_dx=-8.149305e-06 dV_dθ=-1.223126e-04 ||∇||=4.526996e-01 | Tr=0.1458 Te/Cur=0.1749 Te/Exp=0.2406]100%|██████████| 2/2 [00:07<00:00,  3.50s/it, CE=2.258649e+00 H=2.258518e+00 dV_dx=-8.149305e-06 dV_dθ=-1.223126e-04 ||∇||=4.526996e-01 | Tr=0.1458 Te/Cur=0.1749 Te/Exp=0.2406]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.91s/it] 50%|█████     | 1/2 [00:12<00:09,  9.91s/it, CE=2.267739e+00 H=2.267671e+00 dV_dx=1.115346e-05 dV_dθ=-7.904304e-05 ||∇||=4.303075e-01 | Tr=0.2070 Te/Cur=0.2521 Te/Exp=0.2172]100%|██████████| 2/2 [00:12<00:00,  5.50s/it, CE=2.267739e+00 H=2.267671e+00 dV_dx=1.115346e-05 dV_dθ=-7.904304e-05 ||∇||=4.303075e-01 | Tr=0.2070 Te/Cur=0.2521 Te/Exp=0.2172]100%|██████████| 2/2 [00:12<00:00,  6.16s/it, CE=2.267739e+00 H=2.267671e+00 dV_dx=1.115346e-05 dV_dθ=-7.904304e-05 ||∇||=4.303075e-01 | Tr=0.2070 Te/Cur=0.2521 Te/Exp=0.2172]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:08<00:08,  8.91s/it] 50%|█████     | 1/2 [00:10<00:08,  8.91s/it, CE=2.262258e+00 H=2.262239e+00 dV_dx=1.929391e-05 dV_dθ=-3.865288e-05 ||∇||=3.725438e-01 | Tr=0.1550 Te/Cur=0.1952 Te/Exp=0.2215]100%|██████████| 2/2 [00:10<00:00,  4.81s/it, CE=2.262258e+00 H=2.262239e+00 dV_dx=1.929391e-05 dV_dθ=-3.865288e-05 ||∇||=3.725438e-01 | Tr=0.1550 Te/Cur=0.1952 Te/Exp=0.2215]100%|██████████| 2/2 [00:10<00:00,  5.43s/it, CE=2.262258e+00 H=2.262239e+00 dV_dx=1.929391e-05 dV_dθ=-3.865288e-05 ||∇||=3.725438e-01 | Tr=0.1550 Te/Cur=0.1952 Te/Exp=0.2215]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.45s/it] 50%|█████     | 1/2 [00:11<00:09,  9.45s/it, CE=2.262277e+00 H=2.262154e+00 dV_dx=-6.223393e-06 dV_dθ=-1.173183e-04 ||∇||=4.275458e-01 | Tr=0.1289 Te/Cur=0.1447 Te/Exp=0.2295]100%|██████████| 2/2 [00:11<00:00,  5.03s/it, CE=2.262277e+00 H=2.262154e+00 dV_dx=-6.223393e-06 dV_dθ=-1.173183e-04 ||∇||=4.275458e-01 | Tr=0.1289 Te/Cur=0.1447 Te/Exp=0.2295]100%|██████████| 2/2 [00:11<00:00,  5.69s/it, CE=2.262277e+00 H=2.262154e+00 dV_dx=-6.223393e-06 dV_dθ=-1.173183e-04 ||∇||=4.275458e-01 | Tr=0.1289 Te/Cur=0.1447 Te/Exp=0.2295]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:11<00:11, 11.04s/it] 50%|█████     | 1/2 [00:17<00:11, 11.04s/it, CE=2.268807e+00 H=2.268767e+00 dV_dx=-7.282636e-06 dV_dθ=-3.246299e-05 ||∇||=4.019934e-01 | Tr=0.1176 Te/Cur=0.1515 Te/Exp=0.2406]100%|██████████| 2/2 [00:17<00:00,  8.05s/it, CE=2.268807e+00 H=2.268767e+00 dV_dx=-7.282636e-06 dV_dθ=-3.246299e-05 ||∇||=4.019934e-01 | Tr=0.1176 Te/Cur=0.1515 Te/Exp=0.2406]100%|██████████| 2/2 [00:17<00:00,  8.50s/it, CE=2.268807e+00 H=2.268767e+00 dV_dx=-7.282636e-06 dV_dθ=-3.246299e-05 ||∇||=4.019934e-01 | Tr=0.1176 Te/Cur=0.1515 Te/Exp=0.2406]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.24s/it] 50%|█████     | 1/2 [00:08<00:06,  6.24s/it, CE=2.266592e+00 H=2.266518e+00 dV_dx=7.024686e-06 dV_dθ=-8.136661e-05 ||∇||=3.896476e-01 | Tr=0.1467 Te/Cur=0.1827 Te/Exp=0.2273]100%|██████████| 2/2 [00:08<00:00,  3.71s/it, CE=2.266592e+00 H=2.266518e+00 dV_dx=7.024686e-06 dV_dθ=-8.136661e-05 ||∇||=3.896476e-01 | Tr=0.1467 Te/Cur=0.1827 Te/Exp=0.2273]100%|██████████| 2/2 [00:08<00:00,  4.09s/it, CE=2.266592e+00 H=2.266518e+00 dV_dx=7.024686e-06 dV_dθ=-8.136661e-05 ||∇||=3.896476e-01 | Tr=0.1467 Te/Cur=0.1827 Te/Exp=0.2273]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.78s/it] 50%|█████     | 1/2 [00:12<00:10, 10.78s/it, CE=2.259272e+00 H=2.259187e+00 dV_dx=1.229930e-06 dV_dθ=-8.552589e-05 ||∇||=3.914703e-01 | Tr=0.1223 Te/Cur=0.1419 Te/Exp=0.2177]100%|██████████| 2/2 [00:12<00:00,  5.47s/it, CE=2.259272e+00 H=2.259187e+00 dV_dx=1.229930e-06 dV_dθ=-8.552589e-05 ||∇||=3.914703e-01 | Tr=0.1223 Te/Cur=0.1419 Te/Exp=0.2177]100%|██████████| 2/2 [00:12<00:00,  6.26s/it, CE=2.259272e+00 H=2.259187e+00 dV_dx=1.229930e-06 dV_dθ=-8.552589e-05 ||∇||=3.914703e-01 | Tr=0.1223 Te/Cur=0.1419 Te/Exp=0.2177]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.50s/it] 50%|█████     | 1/2 [00:12<00:10, 10.50s/it, CE=2.264381e+00 H=2.264323e+00 dV_dx=1.196449e-05 dV_dθ=-6.967419e-05 ||∇||=3.848602e-01 | Tr=0.1291 Te/Cur=0.1744 Te/Exp=0.2441]100%|██████████| 2/2 [00:12<00:00,  5.37s/it, CE=2.264381e+00 H=2.264323e+00 dV_dx=1.196449e-05 dV_dθ=-6.967419e-05 ||∇||=3.848602e-01 | Tr=0.1291 Te/Cur=0.1744 Te/Exp=0.2441]100%|██████████| 2/2 [00:12<00:00,  6.14s/it, CE=2.264381e+00 H=2.264323e+00 dV_dx=1.196449e-05 dV_dθ=-6.967419e-05 ||∇||=3.848602e-01 | Tr=0.1291 Te/Cur=0.1744 Te/Exp=0.2441]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.85s/it] 50%|█████     | 1/2 [00:11<00:09,  9.85s/it, CE=2.249585e+00 H=2.249502e+00 dV_dx=4.647352e-06 dV_dθ=-8.757456e-05 ||∇||=3.844221e-01 | Tr=0.2217 Te/Cur=0.2409 Te/Exp=0.2412]100%|██████████| 2/2 [00:11<00:00,  4.97s/it, CE=2.249585e+00 H=2.249502e+00 dV_dx=4.647352e-06 dV_dθ=-8.757456e-05 ||∇||=3.844221e-01 | Tr=0.2217 Te/Cur=0.2409 Te/Exp=0.2412]100%|██████████| 2/2 [00:11<00:00,  5.71s/it, CE=2.249585e+00 H=2.249502e+00 dV_dx=4.647352e-06 dV_dθ=-8.757456e-05 ||∇||=3.844221e-01 | Tr=0.2217 Te/Cur=0.2409 Te/Exp=0.2412]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.71s/it] 50%|█████     | 1/2 [00:07<00:05,  5.71s/it, CE=2.253104e+00 H=2.253013e+00 dV_dx=-5.151980e-06 dV_dθ=-8.623742e-05 ||∇||=3.934013e-01 | Tr=0.1810 Te/Cur=0.1923 Te/Exp=0.2244]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.253104e+00 H=2.253013e+00 dV_dx=-5.151980e-06 dV_dθ=-8.623742e-05 ||∇||=3.934013e-01 | Tr=0.1810 Te/Cur=0.1923 Te/Exp=0.2244]100%|██████████| 2/2 [00:07<00:00,  3.95s/it, CE=2.253104e+00 H=2.253013e+00 dV_dx=-5.151980e-06 dV_dθ=-8.623742e-05 ||∇||=3.934013e-01 | Tr=0.1810 Te/Cur=0.1923 Te/Exp=0.2244]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.64s/it] 50%|█████     | 1/2 [00:12<00:10, 10.64s/it, CE=2.248608e+00 H=2.248512e+00 dV_dx=1.919188e-06 dV_dθ=-9.761448e-05 ||∇||=4.061488e-01 | Tr=0.1427 Te/Cur=0.1862 Te/Exp=0.2203]100%|██████████| 2/2 [00:12<00:00,  5.68s/it, CE=2.248608e+00 H=2.248512e+00 dV_dx=1.919188e-06 dV_dθ=-9.761448e-05 ||∇||=4.061488e-01 | Tr=0.1427 Te/Cur=0.1862 Te/Exp=0.2203]100%|██████████| 2/2 [00:12<00:00,  6.43s/it, CE=2.248608e+00 H=2.248512e+00 dV_dx=1.919188e-06 dV_dθ=-9.761448e-05 ||∇||=4.061488e-01 | Tr=0.1427 Te/Cur=0.1862 Te/Exp=0.2203]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.77s/it] 50%|█████     | 1/2 [00:11<00:09,  9.77s/it, CE=2.265631e+00 H=2.265537e+00 dV_dx=-5.503070e-06 dV_dθ=-8.865443e-05 ||∇||=3.752124e-01 | Tr=0.2176 Te/Cur=0.2479 Te/Exp=0.2152]100%|██████████| 2/2 [00:11<00:00,  5.01s/it, CE=2.265631e+00 H=2.265537e+00 dV_dx=-5.503070e-06 dV_dθ=-8.865443e-05 ||∇||=3.752124e-01 | Tr=0.2176 Te/Cur=0.2479 Te/Exp=0.2152]100%|██████████| 2/2 [00:11<00:00,  5.72s/it, CE=2.265631e+00 H=2.265537e+00 dV_dx=-5.503070e-06 dV_dθ=-8.865443e-05 ||∇||=3.752124e-01 | Tr=0.2176 Te/Cur=0.2479 Te/Exp=0.2152]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.39s/it] 50%|█████     | 1/2 [00:12<00:10, 10.39s/it, CE=2.248943e+00 H=2.248891e+00 dV_dx=1.102469e-05 dV_dθ=-6.272992e-05 ||∇||=4.059210e-01 | Tr=0.1356 Te/Cur=0.1651 Te/Exp=0.2382]100%|██████████| 2/2 [00:12<00:00,  5.42s/it, CE=2.248943e+00 H=2.248891e+00 dV_dx=1.102469e-05 dV_dθ=-6.272992e-05 ||∇||=4.059210e-01 | Tr=0.1356 Te/Cur=0.1651 Te/Exp=0.2382]100%|██████████| 2/2 [00:12<00:00,  6.17s/it, CE=2.248943e+00 H=2.248891e+00 dV_dx=1.102469e-05 dV_dθ=-6.272992e-05 ||∇||=4.059210e-01 | Tr=0.1356 Te/Cur=0.1651 Te/Exp=0.2382]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:13<00:13, 13.75s/it] 50%|█████     | 1/2 [00:15<00:13, 13.75s/it, CE=2.247163e+00 H=2.247054e+00 dV_dx=6.162618e-06 dV_dθ=-1.144715e-04 ||∇||=3.932176e-01 | Tr=0.1408 Te/Cur=0.2007 Te/Exp=0.2634]100%|██████████| 2/2 [00:15<00:00,  6.58s/it, CE=2.247163e+00 H=2.247054e+00 dV_dx=6.162618e-06 dV_dθ=-1.144715e-04 ||∇||=3.932176e-01 | Tr=0.1408 Te/Cur=0.2007 Te/Exp=0.2634]100%|██████████| 2/2 [00:15<00:00,  7.65s/it, CE=2.247163e+00 H=2.247054e+00 dV_dx=6.162618e-06 dV_dθ=-1.144715e-04 ||∇||=3.932176e-01 | Tr=0.1408 Te/Cur=0.2007 Te/Exp=0.2634]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Search iteration 2/2
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.76s/it] 50%|█████     | 1/2 [00:07<00:05,  5.76s/it, CE=2.210329e+00 H=2.209953e+00 dV_dx=-1.020834e-05 dV_dθ=-3.660287e-04 ||∇||=6.238519e-01 | Tr=0.2820 Te/Cur=0.3096 Te/Exp=0.2659]100%|██████████| 2/2 [00:07<00:00,  3.49s/it, CE=2.210329e+00 H=2.209953e+00 dV_dx=-1.020834e-05 dV_dθ=-3.660287e-04 ||∇||=6.238519e-01 | Tr=0.2820 Te/Cur=0.3096 Te/Exp=0.2659]100%|██████████| 2/2 [00:07<00:00,  3.83s/it, CE=2.210329e+00 H=2.209953e+00 dV_dx=-1.020834e-05 dV_dθ=-3.660287e-04 ||∇||=6.238519e-01 | Tr=0.2820 Te/Cur=0.3096 Te/Exp=0.2659]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
I found my baseline 2.2103292909984917
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.75s/it] 50%|█████     | 1/2 [00:07<00:05,  5.75s/it, CE=2.226103e+00 H=2.225860e+00 dV_dx=-1.230638e-06 dV_dθ=-2.424152e-04 ||∇||=6.513773e-01 | Tr=0.1525 Te/Cur=0.1784 Te/Exp=0.2494]100%|██████████| 2/2 [00:07<00:00,  3.43s/it, CE=2.226103e+00 H=2.225860e+00 dV_dx=-1.230638e-06 dV_dθ=-2.424152e-04 ||∇||=6.513773e-01 | Tr=0.1525 Te/Cur=0.1784 Te/Exp=0.2494]100%|██████████| 2/2 [00:07<00:00,  3.77s/it, CE=2.226103e+00 H=2.225860e+00 dV_dx=-1.230638e-06 dV_dθ=-2.424152e-04 ||∇||=6.513773e-01 | Tr=0.1525 Te/Cur=0.1784 Te/Exp=0.2494]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.29s/it] 50%|█████     | 1/2 [00:12<00:10, 10.29s/it, CE=2.228425e+00 H=2.228114e+00 dV_dx=3.024758e-06 dV_dθ=-3.141903e-04 ||∇||=6.708884e-01 | Tr=0.1789 Te/Cur=0.2482 Te/Exp=0.2701]100%|██████████| 2/2 [00:12<00:00,  5.31s/it, CE=2.228425e+00 H=2.228114e+00 dV_dx=3.024758e-06 dV_dθ=-3.141903e-04 ||∇||=6.708884e-01 | Tr=0.1789 Te/Cur=0.2482 Te/Exp=0.2701]100%|██████████| 2/2 [00:12<00:00,  6.06s/it, CE=2.228425e+00 H=2.228114e+00 dV_dx=3.024758e-06 dV_dθ=-3.141903e-04 ||∇||=6.708884e-01 | Tr=0.1789 Te/Cur=0.2482 Te/Exp=0.2701]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.48s/it] 50%|█████     | 1/2 [00:07<00:05,  5.48s/it, CE=2.220686e+00 H=2.220431e+00 dV_dx=5.836437e-07 dV_dθ=-2.548933e-04 ||∇||=6.084185e-01 | Tr=0.1477 Te/Cur=0.2046 Te/Exp=0.3174]100%|██████████| 2/2 [00:07<00:00,  3.39s/it, CE=2.220686e+00 H=2.220431e+00 dV_dx=5.836437e-07 dV_dθ=-2.548933e-04 ||∇||=6.084185e-01 | Tr=0.1477 Te/Cur=0.2046 Te/Exp=0.3174]100%|██████████| 2/2 [00:07<00:00,  3.70s/it, CE=2.220686e+00 H=2.220431e+00 dV_dx=5.836437e-07 dV_dθ=-2.548933e-04 ||∇||=6.084185e-01 | Tr=0.1477 Te/Cur=0.2046 Te/Exp=0.3174]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.58s/it] 50%|█████     | 1/2 [00:05<00:03,  3.58s/it, CE=2.216323e+00 H=2.215994e+00 dV_dx=-4.454156e-07 dV_dθ=-3.282757e-04 ||∇||=6.766020e-01 | Tr=0.1695 Te/Cur=0.2122 Te/Exp=0.3137]100%|██████████| 2/2 [00:05<00:00,  2.72s/it, CE=2.216323e+00 H=2.215994e+00 dV_dx=-4.454156e-07 dV_dθ=-3.282757e-04 ||∇||=6.766020e-01 | Tr=0.1695 Te/Cur=0.2122 Te/Exp=0.3137]100%|██████████| 2/2 [00:05<00:00,  2.85s/it, CE=2.216323e+00 H=2.215994e+00 dV_dx=-4.454156e-07 dV_dθ=-3.282757e-04 ||∇||=6.766020e-01 | Tr=0.1695 Te/Cur=0.2122 Te/Exp=0.3137]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.70s/it] 50%|█████     | 1/2 [00:12<00:10, 10.70s/it, CE=2.207370e+00 H=2.207112e+00 dV_dx=-3.919250e-06 dV_dθ=-2.541452e-04 ||∇||=6.521366e-01 | Tr=0.2318 Te/Cur=0.2602 Te/Exp=0.2927]100%|██████████| 2/2 [00:12<00:00,  5.72s/it, CE=2.207370e+00 H=2.207112e+00 dV_dx=-3.919250e-06 dV_dθ=-2.541452e-04 ||∇||=6.521366e-01 | Tr=0.2318 Te/Cur=0.2602 Te/Exp=0.2927]100%|██████████| 2/2 [00:12<00:00,  6.46s/it, CE=2.207370e+00 H=2.207112e+00 dV_dx=-3.919250e-06 dV_dθ=-2.541452e-04 ||∇||=6.521366e-01 | Tr=0.2318 Te/Cur=0.2602 Te/Exp=0.2927]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 732, 204, 10]) with loss 2.207370
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.30s/it] 50%|█████     | 1/2 [00:12<00:10, 10.30s/it, CE=2.213218e+00 H=2.212935e+00 dV_dx=-8.679365e-06 dV_dθ=-2.740260e-04 ||∇||=6.359787e-01 | Tr=0.2377 Te/Cur=0.2820 Te/Exp=0.2921]100%|██████████| 2/2 [00:12<00:00,  5.64s/it, CE=2.213218e+00 H=2.212935e+00 dV_dx=-8.679365e-06 dV_dθ=-2.740260e-04 ||∇||=6.359787e-01 | Tr=0.2377 Te/Cur=0.2820 Te/Exp=0.2921]100%|██████████| 2/2 [00:12<00:00,  6.34s/it, CE=2.213218e+00 H=2.212935e+00 dV_dx=-8.679365e-06 dV_dθ=-2.740260e-04 ||∇||=6.359787e-01 | Tr=0.2377 Te/Cur=0.2820 Te/Exp=0.2921]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.02s/it] 50%|█████     | 1/2 [00:12<00:10, 10.02s/it, CE=2.203103e+00 H=2.202843e+00 dV_dx=1.563020e-06 dV_dθ=-2.617316e-04 ||∇||=6.552971e-01 | Tr=0.1990 Te/Cur=0.2568 Te/Exp=0.2983]100%|██████████| 2/2 [00:12<00:00,  5.35s/it, CE=2.203103e+00 H=2.202843e+00 dV_dx=1.563020e-06 dV_dθ=-2.617316e-04 ||∇||=6.552971e-01 | Tr=0.1990 Te/Cur=0.2568 Te/Exp=0.2983]100%|██████████| 2/2 [00:12<00:00,  6.05s/it, CE=2.203103e+00 H=2.202843e+00 dV_dx=1.563020e-06 dV_dθ=-2.617316e-04 ||∇||=6.552971e-01 | Tr=0.1990 Te/Cur=0.2568 Te/Exp=0.2983]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 692, 244, 10]) with loss 2.203103
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.27s/it] 50%|█████     | 1/2 [00:15<00:14, 14.27s/it, CE=2.189408e+00 H=2.189150e+00 dV_dx=1.261222e-06 dV_dθ=-2.597732e-04 ||∇||=6.681006e-01 | Tr=0.3019 Te/Cur=0.3611 Te/Exp=0.3098]100%|██████████| 2/2 [00:15<00:00,  6.89s/it, CE=2.189408e+00 H=2.189150e+00 dV_dx=1.261222e-06 dV_dθ=-2.597732e-04 ||∇||=6.681006e-01 | Tr=0.3019 Te/Cur=0.3611 Te/Exp=0.3098]100%|██████████| 2/2 [00:15<00:00,  8.00s/it, CE=2.189408e+00 H=2.189150e+00 dV_dx=1.261222e-06 dV_dθ=-2.597732e-04 ||∇||=6.681006e-01 | Tr=0.3019 Te/Cur=0.3611 Te/Exp=0.3098]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
    Found better architecture: (2, [507, 732, 244, 10]) with loss 2.189408
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.13s/it] 50%|█████     | 1/2 [00:06<00:05,  5.13s/it, CE=2.238250e+00 H=2.238064e+00 dV_dx=2.272911e-06 dV_dθ=-1.884900e-04 ||∇||=5.198854e-01 | Tr=0.2106 Te/Cur=0.2744 Te/Exp=0.2412]100%|██████████| 2/2 [00:06<00:00,  3.11s/it, CE=2.238250e+00 H=2.238064e+00 dV_dx=2.272911e-06 dV_dθ=-1.884900e-04 ||∇||=5.198854e-01 | Tr=0.2106 Te/Cur=0.2744 Te/Exp=0.2412]100%|██████████| 2/2 [00:06<00:00,  3.41s/it, CE=2.238250e+00 H=2.238064e+00 dV_dx=2.272911e-06 dV_dθ=-1.884900e-04 ||∇||=5.198854e-01 | Tr=0.2106 Te/Cur=0.2744 Te/Exp=0.2412]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.06s/it] 50%|█████     | 1/2 [00:07<00:06,  6.06s/it, CE=2.253735e+00 H=2.253548e+00 dV_dx=1.916085e-06 dV_dθ=-1.894195e-04 ||∇||=5.283275e-01 | Tr=0.1393 Te/Cur=0.1374 Te/Exp=0.2119]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.253735e+00 H=2.253548e+00 dV_dx=1.916085e-06 dV_dθ=-1.894195e-04 ||∇||=5.283275e-01 | Tr=0.1393 Te/Cur=0.1374 Te/Exp=0.2119]100%|██████████| 2/2 [00:07<00:00,  3.96s/it, CE=2.253735e+00 H=2.253548e+00 dV_dx=1.916085e-06 dV_dθ=-1.894195e-04 ||∇||=5.283275e-01 | Tr=0.1393 Te/Cur=0.1374 Te/Exp=0.2119]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.02s/it] 50%|█████     | 1/2 [00:11<00:10, 10.02s/it, CE=2.242561e+00 H=2.242339e+00 dV_dx=-4.162202e-06 dV_dθ=-2.172362e-04 ||∇||=5.107905e-01 | Tr=0.1904 Te/Cur=0.2654 Te/Exp=0.2511]100%|██████████| 2/2 [00:11<00:00,  5.02s/it, CE=2.242561e+00 H=2.242339e+00 dV_dx=-4.162202e-06 dV_dθ=-2.172362e-04 ||∇||=5.107905e-01 | Tr=0.1904 Te/Cur=0.2654 Te/Exp=0.2511]100%|██████████| 2/2 [00:11<00:00,  5.77s/it, CE=2.242561e+00 H=2.242339e+00 dV_dx=-4.162202e-06 dV_dθ=-2.172362e-04 ||∇||=5.107905e-01 | Tr=0.1904 Te/Cur=0.2654 Te/Exp=0.2511]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.05s/it] 50%|█████     | 1/2 [00:07<00:06,  6.05s/it, CE=2.238098e+00 H=2.237920e+00 dV_dx=-7.033112e-06 dV_dθ=-1.702183e-04 ||∇||=5.205180e-01 | Tr=0.1906 Te/Cur=0.2342 Te/Exp=0.2612]100%|██████████| 2/2 [00:07<00:00,  3.34s/it, CE=2.238098e+00 H=2.237920e+00 dV_dx=-7.033112e-06 dV_dθ=-1.702183e-04 ||∇||=5.205180e-01 | Tr=0.1906 Te/Cur=0.2342 Te/Exp=0.2612]100%|██████████| 2/2 [00:07<00:00,  3.75s/it, CE=2.238098e+00 H=2.237920e+00 dV_dx=-7.033112e-06 dV_dθ=-1.702183e-04 ||∇||=5.205180e-01 | Tr=0.1906 Te/Cur=0.2342 Te/Exp=0.2612]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:03<00:03,  3.93s/it] 50%|█████     | 1/2 [00:05<00:03,  3.93s/it, CE=2.227177e+00 H=2.227058e+00 dV_dx=-2.755424e-06 dV_dθ=-1.161218e-04 ||∇||=5.320398e-01 | Tr=0.1263 Te/Cur=0.1516 Te/Exp=0.2557]100%|██████████| 2/2 [00:05<00:00,  2.74s/it, CE=2.227177e+00 H=2.227058e+00 dV_dx=-2.755424e-06 dV_dθ=-1.161218e-04 ||∇||=5.320398e-01 | Tr=0.1263 Te/Cur=0.1516 Te/Exp=0.2557]100%|██████████| 2/2 [00:05<00:00,  2.92s/it, CE=2.227177e+00 H=2.227058e+00 dV_dx=-2.755424e-06 dV_dθ=-1.161218e-04 ||∇||=5.320398e-01 | Tr=0.1263 Te/Cur=0.1516 Te/Exp=0.2557]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.58s/it] 50%|█████     | 1/2 [00:12<00:10, 10.58s/it, CE=2.240863e+00 H=2.240713e+00 dV_dx=-7.742809e-06 dV_dθ=-1.423569e-04 ||∇||=5.373388e-01 | Tr=0.1397 Te/Cur=0.1869 Te/Exp=0.2498]100%|██████████| 2/2 [00:12<00:00,  5.44s/it, CE=2.240863e+00 H=2.240713e+00 dV_dx=-7.742809e-06 dV_dθ=-1.423569e-04 ||∇||=5.373388e-01 | Tr=0.1397 Te/Cur=0.1869 Te/Exp=0.2498]100%|██████████| 2/2 [00:12<00:00,  6.21s/it, CE=2.240863e+00 H=2.240713e+00 dV_dx=-7.742809e-06 dV_dθ=-1.423569e-04 ||∇||=5.373388e-01 | Tr=0.1397 Te/Cur=0.1869 Te/Exp=0.2498]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.12s/it] 50%|█████     | 1/2 [00:12<00:10, 10.12s/it, CE=2.248796e+00 H=2.248634e+00 dV_dx=-5.135562e-06 dV_dθ=-1.569038e-04 ||∇||=4.862000e-01 | Tr=0.3143 Te/Cur=0.3568 Te/Exp=0.2700]100%|██████████| 2/2 [00:12<00:00,  5.33s/it, CE=2.248796e+00 H=2.248634e+00 dV_dx=-5.135562e-06 dV_dθ=-1.569038e-04 ||∇||=4.862000e-01 | Tr=0.3143 Te/Cur=0.3568 Te/Exp=0.2700]100%|██████████| 2/2 [00:12<00:00,  6.05s/it, CE=2.248796e+00 H=2.248634e+00 dV_dx=-5.135562e-06 dV_dθ=-1.569038e-04 ||∇||=4.862000e-01 | Tr=0.3143 Te/Cur=0.3568 Te/Exp=0.2700]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.63s/it] 50%|█████     | 1/2 [00:11<00:09,  9.63s/it, CE=2.233148e+00 H=2.232991e+00 dV_dx=7.401760e-06 dV_dθ=-1.638848e-04 ||∇||=5.124486e-01 | Tr=0.1676 Te/Cur=0.2117 Te/Exp=0.2569]100%|██████████| 2/2 [00:11<00:00,  5.23s/it, CE=2.233148e+00 H=2.232991e+00 dV_dx=7.401760e-06 dV_dθ=-1.638848e-04 ||∇||=5.124486e-01 | Tr=0.1676 Te/Cur=0.2117 Te/Exp=0.2569]100%|██████████| 2/2 [00:11<00:00,  5.89s/it, CE=2.233148e+00 H=2.232991e+00 dV_dx=7.401760e-06 dV_dθ=-1.638848e-04 ||∇||=5.124486e-01 | Tr=0.1676 Te/Cur=0.2117 Te/Exp=0.2569]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:14<00:14, 14.26s/it] 50%|█████     | 1/2 [00:16<00:14, 14.26s/it, CE=2.226678e+00 H=2.226513e+00 dV_dx=5.699278e-06 dV_dθ=-1.708449e-04 ||∇||=5.051385e-01 | Tr=0.2483 Te/Cur=0.3024 Te/Exp=0.2786]100%|██████████| 2/2 [00:16<00:00,  7.01s/it, CE=2.226678e+00 H=2.226513e+00 dV_dx=5.699278e-06 dV_dθ=-1.708449e-04 ||∇||=5.051385e-01 | Tr=0.2483 Te/Cur=0.3024 Te/Exp=0.2786]100%|██████████| 2/2 [00:16<00:00,  8.09s/it, CE=2.226678e+00 H=2.226513e+00 dV_dx=5.699278e-06 dV_dθ=-1.708449e-04 ||∇||=5.051385e-01 | Tr=0.2483 Te/Cur=0.3024 Te/Exp=0.2786]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.56s/it] 50%|█████     | 1/2 [00:07<00:05,  5.56s/it, CE=2.260403e+00 H=2.260254e+00 dV_dx=-2.379840e-06 dV_dθ=-1.465889e-04 ||∇||=4.515911e-01 | Tr=0.2253 Te/Cur=0.2067 Te/Exp=0.1921]100%|██████████| 2/2 [00:07<00:00,  3.24s/it, CE=2.260403e+00 H=2.260254e+00 dV_dx=-2.379840e-06 dV_dθ=-1.465889e-04 ||∇||=4.515911e-01 | Tr=0.2253 Te/Cur=0.2067 Te/Exp=0.1921]100%|██████████| 2/2 [00:07<00:00,  3.59s/it, CE=2.260403e+00 H=2.260254e+00 dV_dx=-2.379840e-06 dV_dθ=-1.465889e-04 ||∇||=4.515911e-01 | Tr=0.2253 Te/Cur=0.2067 Te/Exp=0.1921]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:06<00:06,  6.06s/it] 50%|█████     | 1/2 [00:08<00:06,  6.06s/it, CE=2.261174e+00 H=2.261080e+00 dV_dx=-3.914037e-06 dV_dθ=-8.984771e-05 ||∇||=4.074060e-01 | Tr=0.1899 Te/Cur=0.1845 Te/Exp=0.1941]100%|██████████| 2/2 [00:08<00:00,  3.66s/it, CE=2.261174e+00 H=2.261080e+00 dV_dx=-3.914037e-06 dV_dθ=-8.984771e-05 ||∇||=4.074060e-01 | Tr=0.1899 Te/Cur=0.1845 Te/Exp=0.1941]100%|██████████| 2/2 [00:08<00:00,  4.02s/it, CE=2.261174e+00 H=2.261080e+00 dV_dx=-3.914037e-06 dV_dθ=-8.984771e-05 ||∇||=4.074060e-01 | Tr=0.1899 Te/Cur=0.1845 Te/Exp=0.1941]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.80s/it] 50%|█████     | 1/2 [00:11<00:09,  9.80s/it, CE=2.251784e+00 H=2.251673e+00 dV_dx=1.084044e-06 dV_dθ=-1.122693e-04 ||∇||=4.119275e-01 | Tr=0.1537 Te/Cur=0.1631 Te/Exp=0.2199]100%|██████████| 2/2 [00:11<00:00,  5.17s/it, CE=2.251784e+00 H=2.251673e+00 dV_dx=1.084044e-06 dV_dθ=-1.122693e-04 ||∇||=4.119275e-01 | Tr=0.1537 Te/Cur=0.1631 Te/Exp=0.2199]100%|██████████| 2/2 [00:11<00:00,  5.86s/it, CE=2.251784e+00 H=2.251673e+00 dV_dx=1.084044e-06 dV_dθ=-1.122693e-04 ||∇||=4.119275e-01 | Tr=0.1537 Te/Cur=0.1631 Te/Exp=0.2199]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:05<00:05,  5.17s/it] 50%|█████     | 1/2 [00:07<00:05,  5.17s/it, CE=2.265226e+00 H=2.265124e+00 dV_dx=-2.348387e-06 dV_dθ=-9.907672e-05 ||∇||=4.256818e-01 | Tr=0.1563 Te/Cur=0.1905 Te/Exp=0.1904]100%|██████████| 2/2 [00:07<00:00,  3.38s/it, CE=2.265226e+00 H=2.265124e+00 dV_dx=-2.348387e-06 dV_dθ=-9.907672e-05 ||∇||=4.256818e-01 | Tr=0.1563 Te/Cur=0.1905 Te/Exp=0.1904]100%|██████████| 2/2 [00:07<00:00,  3.64s/it, CE=2.265226e+00 H=2.265124e+00 dV_dx=-2.348387e-06 dV_dθ=-9.907672e-05 ||∇||=4.256818e-01 | Tr=0.1563 Te/Cur=0.1905 Te/Exp=0.1904]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:04<00:04,  4.06s/it] 50%|█████     | 1/2 [00:05<00:04,  4.06s/it, CE=2.249232e+00 H=2.249132e+00 dV_dx=-8.245492e-06 dV_dθ=-9.226604e-05 ||∇||=4.371355e-01 | Tr=0.1631 Te/Cur=0.1492 Te/Exp=0.2207]100%|██████████| 2/2 [00:05<00:00,  2.79s/it, CE=2.249232e+00 H=2.249132e+00 dV_dx=-8.245492e-06 dV_dθ=-9.226604e-05 ||∇||=4.371355e-01 | Tr=0.1631 Te/Cur=0.1492 Te/Exp=0.2207]100%|██████████| 2/2 [00:05<00:00,  2.98s/it, CE=2.249232e+00 H=2.249132e+00 dV_dx=-8.245492e-06 dV_dθ=-9.226604e-05 ||∇||=4.371355e-01 | Tr=0.1631 Te/Cur=0.1492 Te/Exp=0.2207]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.11s/it] 50%|█████     | 1/2 [00:12<00:10, 10.11s/it, CE=2.248735e+00 H=2.248611e+00 dV_dx=-1.379900e-06 dV_dθ=-1.219773e-04 ||∇||=4.199042e-01 | Tr=0.1315 Te/Cur=0.1735 Te/Exp=0.2337]100%|██████████| 2/2 [00:12<00:00,  5.44s/it, CE=2.248735e+00 H=2.248611e+00 dV_dx=-1.379900e-06 dV_dθ=-1.219773e-04 ||∇||=4.199042e-01 | Tr=0.1315 Te/Cur=0.1735 Te/Exp=0.2337]100%|██████████| 2/2 [00:12<00:00,  6.14s/it, CE=2.248735e+00 H=2.248611e+00 dV_dx=-1.379900e-06 dV_dθ=-1.219773e-04 ||∇||=4.199042e-01 | Tr=0.1315 Te/Cur=0.1735 Te/Exp=0.2337]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.50s/it] 50%|█████     | 1/2 [00:12<00:10, 10.50s/it, CE=2.253259e+00 H=2.253136e+00 dV_dx=-4.705239e-06 dV_dθ=-1.174352e-04 ||∇||=4.334546e-01 | Tr=0.1872 Te/Cur=0.1973 Te/Exp=0.2293]100%|██████████| 2/2 [00:12<00:00,  5.51s/it, CE=2.253259e+00 H=2.253136e+00 dV_dx=-4.705239e-06 dV_dθ=-1.174352e-04 ||∇||=4.334546e-01 | Tr=0.1872 Te/Cur=0.1973 Te/Exp=0.2293]100%|██████████| 2/2 [00:12<00:00,  6.26s/it, CE=2.253259e+00 H=2.253136e+00 dV_dx=-4.705239e-06 dV_dθ=-1.174352e-04 ||∇||=4.334546e-01 | Tr=0.1872 Te/Cur=0.1973 Te/Exp=0.2293]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.92s/it] 50%|█████     | 1/2 [00:11<00:09,  9.92s/it, CE=2.255577e+00 H=2.255462e+00 dV_dx=-2.230691e-06 dV_dθ=-1.129093e-04 ||∇||=4.427939e-01 | Tr=0.1533 Te/Cur=0.1952 Te/Exp=0.2382]100%|██████████| 2/2 [00:11<00:00,  5.13s/it, CE=2.255577e+00 H=2.255462e+00 dV_dx=-2.230691e-06 dV_dθ=-1.129093e-04 ||∇||=4.427939e-01 | Tr=0.1533 Te/Cur=0.1952 Te/Exp=0.2382]100%|██████████| 2/2 [00:11<00:00,  5.85s/it, CE=2.255577e+00 H=2.255462e+00 dV_dx=-2.230691e-06 dV_dθ=-1.129093e-04 ||∇||=4.427939e-01 | Tr=0.1533 Te/Cur=0.1952 Te/Exp=0.2382]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:10<00:10, 10.28s/it] 50%|█████     | 1/2 [00:12<00:10, 10.28s/it, CE=2.239481e+00 H=2.239377e+00 dV_dx=-8.309699e-07 dV_dθ=-1.031750e-04 ||∇||=4.245883e-01 | Tr=0.2173 Te/Cur=0.2418 Te/Exp=0.2547]100%|██████████| 2/2 [00:12<00:00,  5.47s/it, CE=2.239481e+00 H=2.239377e+00 dV_dx=-8.309699e-07 dV_dθ=-1.031750e-04 ||∇||=4.245883e-01 | Tr=0.2173 Te/Cur=0.2418 Te/Exp=0.2547]100%|██████████| 2/2 [00:12<00:00,  6.19s/it, CE=2.239481e+00 H=2.239377e+00 dV_dx=-8.309699e-07 dV_dθ=-1.031750e-04 ||∇||=4.245883e-01 | Tr=0.2173 Te/Cur=0.2418 Te/Exp=0.2547]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  Grid search complete.
  Best architecture: (2, [507, 732, 244, 10]) with loss 2.189408
  Total candidates evaluated: 54
  Original: (4, [432, 692, 204, 10])
  Optimal: (2, [507, 732, 244, 10])

[STEP 3b] Train A/B matrices (20 epochs) - Recorded separately
  prepABs: filter 4→2, feed [432, 692, 204, 10]→[507, 732, 244, 10]
  Conv filter changed: A_conv/B_conv shape = (2, 4)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:18<05:45, 18.18s/it]  5%|▌         | 1/20 [00:20<05:45, 18.18s/it, CE=2.521969e+00 H=2.415136e+00 dV_dx=4.474651e-05 dV_dθ=-1.068778e-01 ||∇||=1.453400e+01 | Tr=0.8554] 10%|█         | 2/20 [00:20<02:35,  8.66s/it, CE=2.521969e+00 H=2.415136e+00 dV_dx=4.474651e-05 dV_dθ=-1.068778e-01 ||∇||=1.453400e+01 | Tr=0.8554] 10%|█         | 2/20 [00:21<02:35,  8.66s/it, CE=2.016190e+00 H=1.969501e+00 dV_dx=-2.418359e-05 dV_dθ=-4.666533e-02 ||∇||=1.137467e+01 | Tr=0.8554] 15%|█▌        | 3/20 [00:21<01:33,  5.49s/it, CE=2.016190e+00 H=1.969501e+00 dV_dx=-2.418359e-05 dV_dθ=-4.666533e-02 ||∇||=1.137467e+01 | Tr=0.8554] 15%|█▌        | 3/20 [00:23<01:33,  5.49s/it, CE=1.754334e+00 H=1.653386e+00 dV_dx=1.368359e-04 dV_dθ=-1.010849e-01 ||∇||=1.302033e+01 | Tr=0.8554]  20%|██        | 4/20 [00:23<01:05,  4.12s/it, CE=1.754334e+00 H=1.653386e+00 dV_dx=1.368359e-04 dV_dθ=-1.010849e-01 ||∇||=1.302033e+01 | Tr=0.8554] 20%|██        | 4/20 [00:26<01:05,  4.12s/it, CE=1.572036e+00 H=1.385458e+00 dV_dx=8.724620e-06 dV_dθ=-1.865864e-01 ||∇||=1.503318e+01 | Tr=0.8554] 25%|██▌       | 5/20 [00:26<00:53,  3.57s/it, CE=1.572036e+00 H=1.385458e+00 dV_dx=8.724620e-06 dV_dθ=-1.865864e-01 ||∇||=1.503318e+01 | Tr=0.8554] 25%|██▌       | 5/20 [00:28<00:53,  3.57s/it, CE=1.433709e+00 H=1.130325e+00 dV_dx=5.989466e-05 dV_dθ=-3.034437e-01 ||∇||=1.812193e+01 | Tr=0.8554] 30%|███       | 6/20 [00:28<00:44,  3.15s/it, CE=1.433709e+00 H=1.130325e+00 dV_dx=5.989466e-05 dV_dθ=-3.034437e-01 ||∇||=1.812193e+01 | Tr=0.8554] 30%|███       | 6/20 [00:30<00:44,  3.15s/it, CE=1.328581e+00 H=9.603741e-01 dV_dx=5.356057e-05 dV_dθ=-3.682609e-01 ||∇||=1.878577e+01 | Tr=0.8554] 35%|███▌      | 7/20 [00:30<00:35,  2.75s/it, CE=1.328581e+00 H=9.603741e-01 dV_dx=5.356057e-05 dV_dθ=-3.682609e-01 ||∇||=1.878577e+01 | Tr=0.8554] 35%|███▌      | 7/20 [00:32<00:35,  2.75s/it, CE=1.239807e+00 H=8.844657e-01 dV_dx=1.470631e-05 dV_dθ=-3.553556e-01 ||∇||=1.846635e+01 | Tr=0.8554] 40%|████      | 8/20 [00:32<00:30,  2.53s/it, CE=1.239807e+00 H=8.844657e-01 dV_dx=1.470631e-05 dV_dθ=-3.553556e-01 ||∇||=1.846635e+01 | Tr=0.8554] 40%|████      | 8/20 [00:35<00:30,  2.53s/it, CE=1.168333e+00 H=7.158421e-01 dV_dx=2.292232e-05 dV_dθ=-4.525139e-01 ||∇||=2.036014e+01 | Tr=0.8554] 45%|████▌     | 9/20 [00:35<00:27,  2.46s/it, CE=1.168333e+00 H=7.158421e-01 dV_dx=2.292232e-05 dV_dθ=-4.525139e-01 ||∇||=2.036014e+01 | Tr=0.8554] 45%|████▌     | 9/20 [00:37<00:27,  2.46s/it, CE=1.105564e+00 H=6.439673e-01 dV_dx=1.620295e-05 dV_dθ=-4.616127e-01 ||∇||=2.049388e+01 | Tr=0.8554] 50%|█████     | 10/20 [00:37<00:25,  2.53s/it, CE=1.105564e+00 H=6.439673e-01 dV_dx=1.620295e-05 dV_dθ=-4.616127e-01 ||∇||=2.049388e+01 | Tr=0.8554] 50%|█████     | 10/20 [00:40<00:25,  2.53s/it, CE=1.046984e+00 H=6.172913e-01 dV_dx=-5.669222e-05 dV_dθ=-4.296363e-01 ||∇||=1.980387e+01 | Tr=0.8554] 55%|█████▌    | 11/20 [00:40<00:23,  2.56s/it, CE=1.046984e+00 H=6.172913e-01 dV_dx=-5.669222e-05 dV_dθ=-4.296363e-01 ||∇||=1.980387e+01 | Tr=0.8554] 55%|█████▌    | 11/20 [00:42<00:23,  2.56s/it, CE=9.944581e-01 H=6.565181e-01 dV_dx=-3.819196e-05 dV_dθ=-3.379018e-01 ||∇||=1.820683e+01 | Tr=0.8554] 60%|██████    | 12/20 [00:42<00:19,  2.41s/it, CE=9.944581e-01 H=6.565181e-01 dV_dx=-3.819196e-05 dV_dθ=-3.379018e-01 ||∇||=1.820683e+01 | Tr=0.8554] 60%|██████    | 12/20 [00:45<00:19,  2.41s/it, CE=9.499810e-01 H=6.307830e-01 dV_dx=4.362104e-05 dV_dθ=-3.192417e-01 ||∇||=1.817552e+01 | Tr=0.8554]  65%|██████▌   | 13/20 [00:45<00:17,  2.44s/it, CE=9.499810e-01 H=6.307830e-01 dV_dx=4.362104e-05 dV_dθ=-3.192417e-01 ||∇||=1.817552e+01 | Tr=0.8554] 65%|██████▌   | 13/20 [00:47<00:17,  2.44s/it, CE=9.099879e-01 H=5.897456e-01 dV_dx=2.877932e-05 dV_dθ=-3.202711e-01 ||∇||=1.837539e+01 | Tr=0.8554] 70%|███████   | 14/20 [00:47<00:14,  2.47s/it, CE=9.099879e-01 H=5.897456e-01 dV_dx=2.877932e-05 dV_dθ=-3.202711e-01 ||∇||=1.837539e+01 | Tr=0.8554] 70%|███████   | 14/20 [00:49<00:14,  2.47s/it, CE=8.723714e-01 H=5.702013e-01 dV_dx=7.141333e-05 dV_dθ=-3.022415e-01 ||∇||=1.806323e+01 | Tr=0.8554] 75%|███████▌  | 15/20 [00:49<00:12,  2.41s/it, CE=8.723714e-01 H=5.702013e-01 dV_dx=7.141333e-05 dV_dθ=-3.022415e-01 ||∇||=1.806323e+01 | Tr=0.8554] 75%|███████▌  | 15/20 [00:51<00:12,  2.41s/it, CE=8.411699e-01 H=3.757966e-01 dV_dx=-5.438692e-05 dV_dθ=-4.653189e-01 ||∇||=2.179780e+01 | Tr=0.8554] 80%|████████  | 16/20 [00:51<00:08,  2.21s/it, CE=8.411699e-01 H=3.757966e-01 dV_dx=-5.438692e-05 dV_dθ=-4.653189e-01 ||∇||=2.179780e+01 | Tr=0.8554] 80%|████████  | 16/20 [00:53<00:08,  2.21s/it, CE=8.139164e-01 H=2.493145e-01 dV_dx=1.263605e-04 dV_dθ=-5.647282e-01 ||∇||=2.305825e+01 | Tr=0.8554]  85%|████████▌ | 17/20 [00:53<00:06,  2.04s/it, CE=8.139164e-01 H=2.493145e-01 dV_dx=1.263605e-04 dV_dθ=-5.647282e-01 ||∇||=2.305825e+01 | Tr=0.8554] 85%|████████▌ | 17/20 [00:55<00:06,  2.04s/it, CE=7.824445e-01 H=3.695807e-01 dV_dx=9.819681e-06 dV_dθ=-4.128737e-01 ||∇||=2.084783e+01 | Tr=0.8554] 90%|█████████ | 18/20 [00:55<00:04,  2.21s/it, CE=7.824445e-01 H=3.695807e-01 dV_dx=9.819681e-06 dV_dθ=-4.128737e-01 ||∇||=2.084783e+01 | Tr=0.8554] 90%|█████████ | 18/20 [00:58<00:04,  2.21s/it, CE=7.554452e-01 H=4.498579e-01 dV_dx=6.966527e-05 dV_dθ=-3.056570e-01 ||∇||=1.845637e+01 | Tr=0.8554] 95%|█████████▌| 19/20 [00:58<00:02,  2.35s/it, CE=7.554452e-01 H=4.498579e-01 dV_dx=6.966527e-05 dV_dθ=-3.056570e-01 ||∇||=1.845637e+01 | Tr=0.8554] 95%|█████████▌| 19/20 [01:02<00:02,  2.35s/it, CE=7.309796e-01 H=4.947460e-01 dV_dx=2.955214e-05 dV_dθ=-2.362631e-01 ||∇||=1.659891e+01 | Tr=0.8554 Te/Cur=0.8970 Te/Exp=0.7198]100%|██████████| 20/20 [01:07<00:00,  4.44s/it, CE=7.309796e-01 H=4.947460e-01 dV_dx=2.955214e-05 dV_dθ=-2.362631e-01 ||∇||=1.659891e+01 | Tr=0.8554 Te/Cur=0.8970 Te/Exp=0.7198]100%|██████████| 20/20 [01:07<00:00,  3.39s/it, CE=7.309796e-01 H=4.947460e-01 dV_dx=2.955214e-05 dV_dθ=-2.362631e-01 ||∇||=1.659891e+01 | Tr=0.8554 Te/Cur=0.8970 Te/Exp=0.7198]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
  AB loss: 0.656549
  Continuing AB training (iter 2)
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<02:04,  6.54s/it]  5%|▌         | 1/20 [00:08<02:04,  6.54s/it, CE=7.581121e-01 H=6.274300e-01 dV_dx=1.167984e-05 dV_dθ=-1.306938e-01 ||∇||=1.311190e+01 | Tr=0.8550] 10%|█         | 2/20 [00:08<01:08,  3.81s/it, CE=7.581121e-01 H=6.274300e-01 dV_dx=1.167984e-05 dV_dθ=-1.306938e-01 ||∇||=1.311190e+01 | Tr=0.8550] 10%|█         | 2/20 [00:10<01:08,  3.81s/it, CE=7.257513e-01 H=5.560437e-01 dV_dx=6.307438e-05 dV_dθ=-1.697706e-01 ||∇||=1.478934e+01 | Tr=0.8550] 15%|█▌        | 3/20 [00:10<00:52,  3.09s/it, CE=7.257513e-01 H=5.560437e-01 dV_dx=6.307438e-05 dV_dθ=-1.697706e-01 ||∇||=1.478934e+01 | Tr=0.8550] 15%|█▌        | 3/20 [00:12<00:52,  3.09s/it, CE=6.962932e-01 H=5.371783e-01 dV_dx=-3.542316e-05 dV_dθ=-1.590795e-01 ||∇||=1.459778e+01 | Tr=0.8550] 20%|██        | 4/20 [00:12<00:38,  2.41s/it, CE=6.962932e-01 H=5.371783e-01 dV_dx=-3.542316e-05 dV_dθ=-1.590795e-01 ||∇||=1.459778e+01 | Tr=0.8550] 20%|██        | 4/20 [00:14<00:38,  2.41s/it, CE=6.736693e-01 H=4.895670e-01 dV_dx=-1.067497e-06 dV_dθ=-1.841012e-01 ||∇||=1.530228e+01 | Tr=0.8550] 25%|██▌       | 5/20 [00:14<00:33,  2.27s/it, CE=6.736693e-01 H=4.895670e-01 dV_dx=-1.067497e-06 dV_dθ=-1.841012e-01 ||∇||=1.530228e+01 | Tr=0.8550] 25%|██▌       | 5/20 [00:16<00:33,  2.27s/it, CE=6.499570e-01 H=4.539910e-01 dV_dx=1.023489e-05 dV_dθ=-1.959762e-01 ||∇||=1.515069e+01 | Tr=0.8550]  30%|███       | 6/20 [00:16<00:30,  2.20s/it, CE=6.499570e-01 H=4.539910e-01 dV_dx=1.023489e-05 dV_dθ=-1.959762e-01 ||∇||=1.515069e+01 | Tr=0.8550] 30%|███       | 6/20 [00:18<00:30,  2.20s/it, CE=6.349599e-01 H=4.032854e-01 dV_dx=-2.252795e-05 dV_dθ=-2.316520e-01 ||∇||=1.663244e+01 | Tr=0.8550] 35%|███▌      | 7/20 [00:18<00:30,  2.31s/it, CE=6.349599e-01 H=4.032854e-01 dV_dx=-2.252795e-05 dV_dθ=-2.316520e-01 ||∇||=1.663244e+01 | Tr=0.8550] 35%|███▌      | 7/20 [00:20<00:30,  2.31s/it, CE=6.309802e-01 H=2.022992e-01 dV_dx=-3.379781e-05 dV_dθ=-4.286472e-01 ||∇||=2.107999e+01 | Tr=0.8550] 40%|████      | 8/20 [00:20<00:27,  2.27s/it, CE=6.309802e-01 H=2.022992e-01 dV_dx=-3.379781e-05 dV_dθ=-4.286472e-01 ||∇||=2.107999e+01 | Tr=0.8550] 40%|████      | 8/20 [00:23<00:27,  2.27s/it, CE=6.158171e-01 H=1.770596e-01 dV_dx=-1.246959e-05 dV_dθ=-4.387450e-01 ||∇||=2.061888e+01 | Tr=0.8550] 45%|████▌     | 9/20 [00:23<00:25,  2.33s/it, CE=6.158171e-01 H=1.770596e-01 dV_dx=-1.246959e-05 dV_dθ=-4.387450e-01 ||∇||=2.061888e+01 | Tr=0.8550] 45%|████▌     | 9/20 [00:25<00:25,  2.33s/it, CE=5.923123e-01 H=3.224591e-01 dV_dx=9.146488e-06 dV_dθ=-2.698624e-01 ||∇||=1.549147e+01 | Tr=0.8550]  50%|█████     | 10/20 [00:25<00:22,  2.24s/it, CE=5.923123e-01 H=3.224591e-01 dV_dx=9.146488e-06 dV_dθ=-2.698624e-01 ||∇||=1.549147e+01 | Tr=0.8550] 50%|█████     | 10/20 [00:27<00:22,  2.24s/it, CE=5.783772e-01 H=3.518579e-01 dV_dx=1.995532e-05 dV_dθ=-2.265393e-01 ||∇||=1.522554e+01 | Tr=0.8550] 55%|█████▌    | 11/20 [00:27<00:20,  2.27s/it, CE=5.783772e-01 H=3.518579e-01 dV_dx=1.995532e-05 dV_dθ=-2.265393e-01 ||∇||=1.522554e+01 | Tr=0.8550] 55%|█████▌    | 11/20 [00:29<00:20,  2.27s/it, CE=5.762737e-01 H=3.522913e-01 dV_dx=-2.903495e-05 dV_dθ=-2.239534e-01 ||∇||=1.541115e+01 | Tr=0.8550] 60%|██████    | 12/20 [00:29<00:17,  2.23s/it, CE=5.762737e-01 H=3.522913e-01 dV_dx=-2.903495e-05 dV_dθ=-2.239534e-01 ||∇||=1.541115e+01 | Tr=0.8550] 60%|██████    | 12/20 [00:32<00:17,  2.23s/it, CE=5.763726e-01 H=3.348698e-01 dV_dx=-9.154932e-05 dV_dθ=-2.414112e-01 ||∇||=1.621798e+01 | Tr=0.8550] 65%|██████▌   | 13/20 [00:32<00:15,  2.25s/it, CE=5.763726e-01 H=3.348698e-01 dV_dx=-9.154932e-05 dV_dθ=-2.414112e-01 ||∇||=1.621798e+01 | Tr=0.8550] 65%|██████▌   | 13/20 [00:34<00:15,  2.25s/it, CE=5.418047e-01 H=3.874379e-01 dV_dx=-3.844891e-06 dV_dθ=-1.543630e-01 ||∇||=1.380333e+01 | Tr=0.8550] 70%|███████   | 14/20 [00:34<00:13,  2.32s/it, CE=5.418047e-01 H=3.874379e-01 dV_dx=-3.844891e-06 dV_dθ=-1.543630e-01 ||∇||=1.380333e+01 | Tr=0.8550] 70%|███████   | 14/20 [00:36<00:13,  2.32s/it, CE=5.227197e-01 H=3.853928e-01 dV_dx=1.662456e-05 dV_dθ=-1.373436e-01 ||∇||=1.284906e+01 | Tr=0.8550]  75%|███████▌  | 15/20 [00:36<00:11,  2.32s/it, CE=5.227197e-01 H=3.853928e-01 dV_dx=1.662456e-05 dV_dθ=-1.373436e-01 ||∇||=1.284906e+01 | Tr=0.8550] 75%|███████▌  | 15/20 [00:39<00:11,  2.32s/it, CE=5.066711e-01 H=3.839340e-01 dV_dx=-4.510693e-05 dV_dθ=-1.226920e-01 ||∇||=1.214591e+01 | Tr=0.8550] 80%|████████  | 16/20 [00:39<00:09,  2.26s/it, CE=5.066711e-01 H=3.839340e-01 dV_dx=-4.510693e-05 dV_dθ=-1.226920e-01 ||∇||=1.214591e+01 | Tr=0.8550] 80%|████████  | 16/20 [00:41<00:09,  2.26s/it, CE=4.947042e-01 H=3.600649e-01 dV_dx=-1.911188e-05 dV_dθ=-1.346202e-01 ||∇||=1.250590e+01 | Tr=0.8550] 85%|████████▌ | 17/20 [00:41<00:06,  2.24s/it, CE=4.947042e-01 H=3.600649e-01 dV_dx=-1.911188e-05 dV_dθ=-1.346202e-01 ||∇||=1.250590e+01 | Tr=0.8550] 85%|████████▌ | 17/20 [00:43<00:06,  2.24s/it, CE=4.853772e-01 H=3.348922e-01 dV_dx=-2.588612e-05 dV_dθ=-1.504590e-01 ||∇||=1.307424e+01 | Tr=0.8550] 90%|█████████ | 18/20 [00:43<00:04,  2.25s/it, CE=4.853772e-01 H=3.348922e-01 dV_dx=-2.588612e-05 dV_dθ=-1.504590e-01 ||∇||=1.307424e+01 | Tr=0.8550] 90%|█████████ | 18/20 [00:45<00:04,  2.25s/it, CE=4.787740e-01 H=2.971725e-01 dV_dx=-9.445401e-06 dV_dθ=-1.815921e-01 ||∇||=1.404281e+01 | Tr=0.8550] 95%|█████████▌| 19/20 [00:45<00:02,  2.27s/it, CE=4.787740e-01 H=2.971725e-01 dV_dx=-9.445401e-06 dV_dθ=-1.815921e-01 ||∇||=1.404281e+01 | Tr=0.8550] 95%|█████████▌| 19/20 [00:49<00:02,  2.27s/it, CE=4.766043e-01 H=2.283518e-01 dV_dx=2.394813e-06 dV_dθ=-2.482550e-01 ||∇||=1.637738e+01 | Tr=0.8550 Te/Cur=0.9385 Te/Exp=0.7878]100%|██████████| 20/20 [00:52<00:00,  3.66s/it, CE=4.766043e-01 H=2.283518e-01 dV_dx=2.394813e-06 dV_dθ=-2.482550e-01 ||∇||=1.637738e+01 | Tr=0.8550 Te/Cur=0.9385 Te/Exp=0.7878]100%|██████████| 20/20 [00:52<00:00,  2.64s/it, CE=4.766043e-01 H=2.283518e-01 dV_dx=2.394813e-06 dV_dθ=-2.482550e-01 ||∇||=1.637738e+01 | Tr=0.8550 Te/Cur=0.9385 Te/Exp=0.7878]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[STEP 4] Compute V = A @ W @ B^T

[STEP 5] Train V: warmup 2 + main 20
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:09<00:09,  9.32s/it] 50%|█████     | 1/2 [00:12<00:09,  9.32s/it, CE=5.186532e-01 H=5.146200e-01 dV_dx=-2.426739e-04 dV_dθ=-3.790557e-03 ||∇||=2.533240e+00 | Tr=0.9640 Te/Cur=0.9486 Te/Exp=0.8110]100%|██████████| 2/2 [00:12<00:00,  5.84s/it, CE=5.186532e-01 H=5.146200e-01 dV_dx=-2.426739e-04 dV_dθ=-3.790557e-03 ||∇||=2.533240e+00 | Tr=0.9640 Te/Cur=0.9486 Te/Exp=0.8110]100%|██████████| 2/2 [00:12<00:00,  6.36s/it, CE=5.186532e-01 H=5.146200e-01 dV_dx=-2.426739e-04 dV_dθ=-3.790557e-03 ||∇||=2.533240e+00 | Tr=0.9640 Te/Cur=0.9486 Te/Exp=0.8110]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
[DEBUG] PrefetchDataLoader initialized with device: cuda:0
[DEBUG] All available JAX devices: [CudaDevice(id=0)]
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:06<01:57,  6.18s/it]  5%|▌         | 1/20 [00:08<01:57,  6.18s/it, CE=5.005629e-01 H=4.970834e-01 dV_dx=4.999552e-05 dV_dθ=-3.529570e-03 ||∇||=2.562276e+00 | Tr=0.9666] 10%|█         | 2/20 [00:08<01:14,  4.12s/it, CE=5.005629e-01 H=4.970834e-01 dV_dx=4.999552e-05 dV_dθ=-3.529570e-03 ||∇||=2.562276e+00 | Tr=0.9666] 10%|█         | 2/20 [00:11<01:14,  4.12s/it, CE=4.802818e-01 H=4.763373e-01 dV_dx=-2.735624e-05 dV_dθ=-3.917119e-03 ||∇||=2.543459e+00 | Tr=0.9680] 15%|█▌        | 3/20 [00:11<01:02,  3.67s/it, CE=4.802818e-01 H=4.763373e-01 dV_dx=-2.735624e-05 dV_dθ=-3.917119e-03 ||∇||=2.543459e+00 | Tr=0.9680] 15%|█▌        | 3/20 [00:14<01:02,  3.67s/it, CE=4.636794e-01 H=4.591528e-01 dV_dx=-1.692548e-04 dV_dθ=-4.357298e-03 ||∇||=2.555514e+00 | Tr=0.9694] 20%|██        | 4/20 [00:14<00:50,  3.17s/it, CE=4.636794e-01 H=4.591528e-01 dV_dx=-1.692548e-04 dV_dθ=-4.357298e-03 ||∇||=2.555514e+00 | Tr=0.9694] 20%|██        | 4/20 [00:16<00:50,  3.17s/it, CE=4.496398e-01 H=4.449403e-01 dV_dx=-2.012000e-05 dV_dθ=-4.679445e-03 ||∇||=2.575018e+00 | Tr=0.9704] 25%|██▌       | 5/20 [00:16<00:41,  2.78s/it, CE=4.496398e-01 H=4.449403e-01 dV_dx=-2.012000e-05 dV_dθ=-4.679445e-03 ||∇||=2.575018e+00 | Tr=0.9704] 25%|██▌       | 5/20 [00:19<00:41,  2.78s/it, CE=4.372330e-01 H=4.320307e-01 dV_dx=-6.588755e-05 dV_dθ=-5.136444e-03 ||∇||=2.621886e+00 | Tr=0.9717 Te/Cur=0.9539 Te/Exp=0.8311] 30%|███       | 6/20 [00:19<00:41,  2.98s/it, CE=4.372330e-01 H=4.320307e-01 dV_dx=-6.588755e-05 dV_dθ=-5.136444e-03 ||∇||=2.621886e+00 | Tr=0.9717 Te/Cur=0.9539 Te/Exp=0.8311] 30%|███       | 6/20 [00:21<00:41,  2.98s/it, CE=4.261967e-01 H=4.209441e-01 dV_dx=-5.477866e-05 dV_dθ=-5.197794e-03 ||∇||=2.619165e+00 | Tr=0.9726]                             35%|███▌      | 7/20 [00:21<00:35,  2.70s/it, CE=4.261967e-01 H=4.209441e-01 dV_dx=-5.477866e-05 dV_dθ=-5.197794e-03 ||∇||=2.619165e+00 | Tr=0.9726] 35%|███▌      | 7/20 [00:23<00:35,  2.70s/it, CE=4.166084e-01 H=4.109743e-01 dV_dx=1.057775e-04 dV_dθ=-5.739946e-03 ||∇||=2.686839e+00 | Tr=0.9738]  40%|████      | 8/20 [00:23<00:28,  2.42s/it, CE=4.166084e-01 H=4.109743e-01 dV_dx=1.057775e-04 dV_dθ=-5.739946e-03 ||∇||=2.686839e+00 | Tr=0.9738] 40%|████      | 8/20 [00:25<00:28,  2.42s/it, CE=4.073017e-01 H=4.013250e-01 dV_dx=1.449157e-04 dV_dθ=-6.121625e-03 ||∇||=2.719740e+00 | Tr=0.9745] 45%|████▌     | 9/20 [00:25<00:24,  2.26s/it, CE=4.073017e-01 H=4.013250e-01 dV_dx=1.449157e-04 dV_dθ=-6.121625e-03 ||∇||=2.719740e+00 | Tr=0.9745] 45%|████▌     | 9/20 [00:27<00:24,  2.26s/it, CE=3.991278e-01 H=3.917005e-01 dV_dx=6.347051e-05 dV_dθ=-7.490830e-03 ||∇||=2.874388e+00 | Tr=0.9747] 50%|█████     | 10/20 [00:27<00:22,  2.26s/it, CE=3.991278e-01 H=3.917005e-01 dV_dx=6.347051e-05 dV_dθ=-7.490830e-03 ||∇||=2.874388e+00 | Tr=0.9747] 50%|█████     | 10/20 [00:35<00:22,  2.26s/it, CE=3.917089e-01 H=3.839338e-01 dV_dx=1.620079e-04 dV_dθ=-7.937132e-03 ||∇||=2.925971e+00 | Tr=0.9754 Te/Cur=0.9548 Te/Exp=0.8281] 55%|█████▌    | 11/20 [00:35<00:33,  3.76s/it, CE=3.917089e-01 H=3.839338e-01 dV_dx=1.620079e-04 dV_dθ=-7.937132e-03 ||∇||=2.925971e+00 | Tr=0.9754 Te/Cur=0.9548 Te/Exp=0.8281] 55%|█████▌    | 11/20 [00:37<00:33,  3.76s/it, CE=3.861283e-01 H=3.777581e-01 dV_dx=9.180906e-05 dV_dθ=-8.462004e-03 ||∇||=3.028185e+00 | Tr=0.9757]                             60%|██████    | 12/20 [00:37<00:25,  3.19s/it, CE=3.861283e-01 H=3.777581e-01 dV_dx=9.180906e-05 dV_dθ=-8.462004e-03 ||∇||=3.028185e+00 | Tr=0.9757] 60%|██████    | 12/20 [00:38<00:25,  3.19s/it, CE=3.816997e-01 H=3.727498e-01 dV_dx=9.396232e-05 dV_dθ=-9.043894e-03 ||∇||=3.105200e+00 | Tr=0.9762] 65%|██████▌   | 13/20 [00:38<00:19,  2.76s/it, CE=3.816997e-01 H=3.727498e-01 dV_dx=9.396232e-05 dV_dθ=-9.043894e-03 ||∇||=3.105200e+00 | Tr=0.9762] 65%|██████▌   | 13/20 [00:40<00:19,  2.76s/it, CE=3.770300e-01 H=3.685486e-01 dV_dx=-6.697840e-05 dV_dθ=-8.414438e-03 ||∇||=3.010412e+00 | Tr=0.9762] 70%|███████   | 14/20 [00:40<00:15,  2.57s/it, CE=3.770300e-01 H=3.685486e-01 dV_dx=-6.697840e-05 dV_dθ=-8.414438e-03 ||∇||=3.010412e+00 | Tr=0.9762] 70%|███████   | 14/20 [00:42<00:15,  2.57s/it, CE=3.678469e-01 H=3.612556e-01 dV_dx=-7.770374e-05 dV_dθ=-6.513592e-03 ||∇||=2.775807e+00 | Tr=0.9776] 75%|███████▌  | 15/20 [00:42<00:11,  2.37s/it, CE=3.678469e-01 H=3.612556e-01 dV_dx=-7.770374e-05 dV_dθ=-6.513592e-03 ||∇||=2.775807e+00 | Tr=0.9776] 75%|███████▌  | 15/20 [00:45<00:11,  2.37s/it, CE=3.575137e-01 H=3.530073e-01 dV_dx=-2.751750e-05 dV_dθ=-4.478839e-03 ||∇||=2.483751e+00 | Tr=0.9792 Te/Cur=0.9639 Te/Exp=0.8299] 80%|████████  | 16/20 [00:45<00:10,  2.53s/it, CE=3.575137e-01 H=3.530073e-01 dV_dx=-2.751750e-05 dV_dθ=-4.478839e-03 ||∇||=2.483751e+00 | Tr=0.9792 Te/Cur=0.9639 Te/Exp=0.8299] 80%|████████  | 16/20 [00:47<00:10,  2.53s/it, CE=3.481173e-01 H=3.452545e-01 dV_dx=-3.818920e-05 dV_dθ=-2.824603e-03 ||∇||=2.204763e+00 | Tr=0.9804]                             85%|████████▌ | 17/20 [00:47<00:07,  2.35s/it, CE=3.481173e-01 H=3.452545e-01 dV_dx=-3.818920e-05 dV_dθ=-2.824603e-03 ||∇||=2.204763e+00 | Tr=0.9804] 85%|████████▌ | 17/20 [00:51<00:07,  2.35s/it, CE=3.404473e-01 H=3.383845e-01 dV_dx=4.520611e-05 dV_dθ=-2.107978e-03 ||∇||=2.049927e+00 | Tr=0.9814]  90%|█████████ | 18/20 [00:51<00:05,  2.94s/it, CE=3.404473e-01 H=3.383845e-01 dV_dx=4.520611e-05 dV_dθ=-2.107978e-03 ||∇||=2.049927e+00 | Tr=0.9814] 90%|█████████ | 18/20 [00:54<00:05,  2.94s/it, CE=3.336389e-01 H=3.319038e-01 dV_dx=-7.517480e-05 dV_dθ=-1.659998e-03 ||∇||=1.942794e+00 | Tr=0.9827] 95%|█████████▌| 19/20 [00:54<00:02,  2.74s/it, CE=3.336389e-01 H=3.319038e-01 dV_dx=-7.517480e-05 dV_dθ=-1.659998e-03 ||∇||=1.942794e+00 | Tr=0.9827] 95%|█████████▌| 19/20 [00:57<00:02,  2.74s/it, CE=3.276989e-01 H=3.261479e-01 dV_dx=-1.411174e-05 dV_dθ=-1.536915e-03 ||∇||=1.889102e+00 | Tr=0.9831 Te/Cur=0.9655 Te/Exp=0.8311]100%|██████████| 20/20 [00:57<00:00,  2.97s/it, CE=3.276989e-01 H=3.261479e-01 dV_dx=-1.411174e-05 dV_dθ=-1.536915e-03 ||∇||=1.889102e+00 | Tr=0.9831 Te/Cur=0.9655 Te/Exp=0.8311]100%|██████████| 20/20 [00:57<00:00,  2.89s/it, CE=3.276989e-01 H=3.261479e-01 dV_dx=-1.411174e-05 dV_dθ=-1.536915e-03 ||∇||=1.889102e+00 | Tr=0.9831 Te/Cur=0.9655 Te/Exp=0.8311]
[DEBUG] Using PrefetchDataLoader path (use_prefetch=True)
[DEBUG] First train batch device: [CudaDevice(id=0)]

[AWB COMPLETE] Task 9 final loss: 0.342606
======================================================================


  Evaluating on all tasks 0..9 for CL metrics...
    Task 0: 0.7407
    Task 1: 0.9131
    Task 2: 0.8046
    Task 3: 0.5779
    Task 4: 0.9086
    Task 5: 0.8873
    Task 6: 0.8963
    Task 7: 0.8953
    Task 8: 0.8904
    Task 9: 0.9649

======================================================================
ARCHITECTURE EVOLUTION SUMMARY
======================================================================

Task 0:
  Original:       None
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 512, 64, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        False
  Reason:         baseline_task
  Optimal Loss:   0.821045

Task 1:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 512, 64, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 572, 124, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.950970
  Optimal Loss:   0.526851

Task 2:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 572, 124, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 572, 124, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        False
  Reason:         loss_ratio_below_threshold
  Prelim Loss:    0.535314
  Optimal Loss:   0.304739

Task 3:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 572, 124, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 552, 104, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.446539
  Optimal Loss:   0.346761

Task 4:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 552, 104, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [432, 612, 164, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.582119
  Optimal Loss:   0.517083

Task 5:
  Original:       {'model_type': 'CNN', 'feed_sizes': [432, 612, 164, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 632, 144, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.688108
  Optimal Loss:   0.472810

Task 6:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 632, 144, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 632, 144, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.596912
  Optimal Loss:   0.437522

Task 7:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 632, 144, 10], 'filter_size': 3, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 652, 164, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.558018
  Optimal Loss:   0.402024

Task 8:
  Original:       {'model_type': 'CNN', 'feed_sizes': [507, 652, 164, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [432, 692, 204, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.570823
  Optimal Loss:   0.385473

Task 9:
  Original:       {'model_type': 'CNN', 'feed_sizes': [432, 692, 204, 10], 'filter_size': 4, 'channel_out': 3, 'channel_in': 1}
  Final:          {'model_type': 'CNN', 'feed_sizes': [507, 732, 244, 10], 'filter_size': 2, 'channel_out': 3, 'channel_in': 1}
  Changed:        True
  Reason:         loss_ratio_threshold
  Prelim Loss:    0.456882
  Optimal Loss:   0.327699

======================================================================
Records saved to: /home/kraghavan/projects/ContLearn/runs__/experiments/mnist/results/mnist_condition4_awb_full_run2/mnist_condition4_awb_full_run2_run2/classification_mnist_cnn_awb_run2_records.pkl

Training complete!
